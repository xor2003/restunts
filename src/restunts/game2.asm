; ---------------------------------------------------------------------------

Sprite		struc ;	(sizeof=0x1E)
pBitmap		dd ?
field_4		dw ?
field_6		dw ?
field_8		dw ?
pwLineOffsets	dw ?			; offset (0002EA20)
dwLeft		dw ?
dwWidth1	dw ?
dwTop		dw ?
dwHeight	dw ?
dwWidth2	dw ?
field_16	dw ?
dwWidth3	dw ?
dwLeft2		dw ?
dwWidthSum	dw ?
Sprite		ends

; ---------------------------------------------------------------------------

Font		struc ;	(sizeof=0x4)
field_0		dw ?
field_2		dw ?
Font		ends

; ---------------------------------------------------------------------------

Resource	struc ;	(sizeof=0x12)
pcName		db 12 dup(?)
dwSize		dw ?			; in 16	byte blocks
dwOffset	dw ?			; in 16	byte blocks, offset + size = next block
field_10	dw ?
Resource	ends

; ---------------------------------------------------------------------------

CarInfoSimd	struc ;	(sizeof=0x308)
cNumGears	db ?
field_1		db ?
wCarMass	dw ?
wBrakingEff	dw ?
wIdleRpm	dw ?
wDownshiftRpm	dw ?
wUpshiftRpm	dw ?
wMaxRpm		dw ?
dwGearRatios	dw 7 dup(?)
arrPtKnobs	Point2D	7 dup(?)
wAeroResistance	dw ?
cTorqueCurve	db 104 dup(?)
field_A2	dw ?
dwGrip		dw ?
field_A6	dw 7 dup(?)
wSurfaceGrip	dw 5 dup(?)
field_BE	db 10 dup(?)
ptCollide	Point2D	2 dup(?)
dwCarHeight	dw ?
vecWheelCoords	Vector3D 4 dup(?)
ptSteeringDots	db 62 dup(?)
ptSpdCenter	Point2D	?
wSpdNumPoints	dw ?
pSpdPoints	db 208 dup(?)
ptRevCenter	Point2D	?
cRevNumPoints	dw ?
pRevPoints	db 256 dup(?)
pAeroResTable	dd ?
CarInfoSimd	ends

; ---------------------------------------------------------------------------

Point2D		struc ;	(sizeof=0x4)
x		dw ?
y		dw ?
Point2D		ends

; ---------------------------------------------------------------------------

Matrix		struc ;	(sizeof=0x12)
_11		dw ?
_21		dw ?
_31		dw ?
_12		dw ?
_22		dw ?
_32		dw ?
_13		dw ?
_23		dw ?
_33		dw ?
Matrix		ends

; ---------------------------------------------------------------------------

TrackInfo	struc ;	(sizeof=0x70A)
pTrackData	db 900 dup(?)
cSkybox		db ?
cTerrainData	db 900 dup(?)
cUnknown	db ?
TrackInfo	ends

; ---------------------------------------------------------------------------

Shape2D		struc ;	(sizeof=0x10)
dwWidth		dw ?
dwHeight	dw ?
dwUnk1		dw ?
dwUnk2		dw ?
dwPosX		dw ?
dwPosY		dw ?
cUnk3		db ?
cUnk4		db ?
cUnk5		db ?
cUnk6		db ?
Shape2D		ends

; ---------------------------------------------------------------------------

Shape3DHeader	struc ;	(sizeof=0x4)
cNumVerts	db ?
cNumPrimitives	db ?
cNumPaints	db ?
cReserved	db ?
Shape3DHeader	ends

; ---------------------------------------------------------------------------

Vector3D	struc ;	(sizeof=0x6)
wX		dw ?
wY		dw ?
wZ		dw ?
Vector3D	ends

; ---------------------------------------------------------------------------

VectorLong3D	struc ;	(sizeof=0xC)
dwX		dd ?
dwY		dd ?
dwZ		dd ?
VectorLong3D	ends

; ---------------------------------------------------------------------------

Shape3D		struc ;	(sizeof=0x16)
wNumVerts	dw ?
pVertices	dd ?
wNumPrimitives	dw ?
wNumPaints	dw ?
pPrimitives	dd ?
pdwCull1	dd ?
pdwCull2	dd ?
Shape3D		ends

; ---------------------------------------------------------------------------

Rectangle	struc ;	(sizeof=0x8)
dwLeft		dw ?			; the members are possibly switched
dwTop		dw ?
dwRight		dw ?
dwBottom	dw ?
Rectangle	ends

; ---------------------------------------------------------------------------

CarState	struc ;	(sizeof=0xD0)
vecLongUnk	VectorLong3D ?
vecLongUnk2	VectorLong3D ?
vecRotate	Vector3D ?
field_1E	dw ?
field_20	dw ?
wCurRpm		dw ?			; negative acceleration	= forward?
wLastRpm	dw ?
wIdleRpm2	dw ?
wGripDiff	dw ?
wTrackGrip	dw ?
wTrackGrip2	dw ?
wLastTrackGrip	dw ?
wGearRatio	dw ?
wGearRatioShr8	dw ?
wKnobX		dw ?
field_36	dw ?
wKnobY		dw ?
wKnobX2		dw ?
wKnobY2		dw ?
wAngleZ		dw ?
field_40	dw ?
field_42	dw ?
field_44	dw ?
wSurfaceGripSum	dw ?
field_48	dw ?
wTrakdata3Index	dw ?
rc1		Rectangle ?
rc2		Rectangle ?
rc3		Rectangle ?
rc4		Rectangle ?
rc5		Rectangle ?
vecUnk1		Vector3D ?
field_7A	dw ?
field_7C	dw ?
field_7E	dw ?
field_80	dw ?
field_82	dw ?
field_84	dw ?
field_86	dw ?
field_88	dw ?
field_8A	dw ?
arrVecUnk2	Vector3D 4 dup(?)
vecUnk3		Vector3D ?
vecUnk4		Vector3D ?
vecUnk5		Vector3D ?
field_B6	dw ?
field_B8	dw ?
field_BA	dw ?
cIsBraking	db ?
cIsAccelerating	db ?
cCurrentGear	db ?
field_BF	db ?
field_C0	db ?
field_C1	db ?
cSurfaceGripIndex1 db ?
cSurfaceGripIndex2 db ?
cSurfaceGripIndex3 db ?
cSurfaceGripIndex4 db ?
field_C6	db ?
field_C7	db ?
field_C8	db ?
field_C9	db ?
cChangingGear	db ?
cFpsMul2	db ?
cTransmission	db ?
field_CD	db ?
field_CE	db ?
field_CF	db ?
CarState	ends

; ---------------------------------------------------------------------------

Plane		struc ;	(sizeof=0x22)
dwAngleYZ	dw ?
dwAngleXY	dw ?
vecOrigin	Vector3D ?
vecNormal	Vector3D ?
matRotation	Vector3D 3 dup(?)
Plane		ends

; ---------------------------------------------------------------------------

GameState	struc ;	(sizeof=0x460)
vecLong8_1	VectorLong3D 8 dup(?)
vecLong8_2	VectorLong3D 8 dup(?)
vecLong8_3	VectorLong3D 8 dup(?)
vec1		Vector3D ?
vec2		Vector3D ?
vec3		Vector3D ?
vec4		Vector3D ?
wFrameInSec	dw ?
wFramesPerSec	dw ?
field_13C	dw ?
field_13E	dw ?
wGameFrame	dw ?			; current time,	in frames. one frame is	0.05 sec
field_142	dw ?
field_144	dw ?
field_146	dw ?
wGameFrame2	dw ?
wFramesPerSecCounter dw	?
field_14C	dw ?
field_14E	dw ?
field_150	dw ?
carPlayer	CarState ?
carOpponent	CarState ?
field_2F2	dw ?
wCvxFlag3	dw ?
wStartCol	dw ?
wStartCol2	dw ?
wStartRow	dw ?
wStartRow2	dw ?
field_2FE	dw 24 dup(?)
field_32E	dw 24 dup(?)
field_35E	dw 24 dup(?)
field_38E	db 48 dup(?)
field_3BE	db 48 dup(?)
pcKevinSeed	db 6 dup(?)
cCvxFlag1	db ?
cCvxFlag2	db ?
cCvxFlag3	db ?
cCvxFlag4	db ?
cCvxFlag5	db ?
field_3F9	db ?
field_3FA	db 48 dup(?)
field_42A	db ?
field_42B	db 24 dup(?)
field_443	db 24 dup(?)
field_45B	db ?
field_45C	db ?
field_45D	db ?
field_45E	db ?
field_45F	db ?
GameState	ends

; ---------------------------------------------------------------------------

TransformedShape3D struc ; (sizeof=0x14)
vecPos		Vector3D ?
pShape3D	dw ?
pRect		dw ?
vecRot		Vector3D ?
field_10	dw ?
cFlags		db ?			; 1 | 2	| 8
cMaterial	db ?
TransformedShape3D ends

; ---------------------------------------------------------------------------

Unknown46h	struc ;	(sizeof=0x46)
field_0		db 70 dup(?)
Unknown46h	ends

; ---------------------------------------------------------------------------

SceneShape3D	struc ;	(sizeof=0xE)
field_0		dw ?			; offset (0003B770)
dwRotY		dw ?
pShape3D	dw ?			; offset (0003B770)
pLoPolyShape3D	dw ?			; offset (0003B770)
field_8		db ?
cMaterial	db ?
field_A		db ?
cTranslateFlag	db ?
field_C		db ?
field_D		db ?
SceneShape3D	ends

; ---------------------------------------------------------------------------

Primitive3D	struc ;	(sizeof=0x2)
cType		db ?
cFlags		db ?
Primitive3D	ends

; ---------------------------------------------------------------------------

Unknown0Eh	struc ;	(sizeof=0xE)
field_0		dw ?
field_2		dw ?
field_4		dw ?
field_6		dw ?
field_8		dw ?			; offset (0003B770)
field_A		dw ?
field_C		dw ?
Unknown0Eh	ends

; ---------------------------------------------------------------------------

Unknown8	struc ;	(sizeof=0x8)
field_0		dw ?
field_2		dw ?
field_4		dw ?
field_6		dw ?
Unknown8	ends

; ---------------------------------------------------------------------------

GameInfo	struc ;	(sizeof=0x1A)
dwPlayerCarID	dd ?
cPlayerMaterial	db ?
cPlayerTransmission db ?
cOpponentType	db ?
dwOpponentID	dd ?
cOppMaterial	db ?
cOppTransmission db ?
pcTrackName	db 9 dup(?)
wFramesPerSec	dw ?
wRecordedFrames	dw ?
GameInfo	ends


;
; +-------------------------------------------------------------------------+
; |	This file is generated by The Interactive Disassembler (IDA)	    |
; |	Copyright (c) 2007 by DataRescue sa/nv,	<ida@datarescue.com>	    |
; +-------------------------------------------------------------------------+
;
; File Name   :	game.exe
; Format      :	MS-DOS executable (EXE)
; Base Address:	1000h Range: 10000h-483D0h Loaded length: 30D40h
; Entry	Point :	2CC5:12
; OS type	  :  MS	DOS
; Application type:  Executable	16bit


		.686p
		.mmx
		.model large

; ===========================================================================

; Segment type:	Pure code
seg000		segment	byte public 'CODE' use16
		assume cs:seg000
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_main		proc far		; CODE XREF: start+97P

var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
cOptOrMainGame	= byte ptr -0Ah
pTrakdataPtr	= dword	ptr -4
p_argv		= word ptr  6
p_argc		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 12h
		push	di
		push	si
		push	[bp+p_argc]
		push	[bp+p_argv]
		call	SetVideoMode
		add	sp, 4
		call	SetDivZeroHandl
		sub	si, si
; .trk files have track	data stored bottom-top,	but terrain top-bottom iirc
; the following	code seems to set up "precacled" access-tables to each row in the data

loc_0_1D:				; CODE XREF: _main+82j
		mov	ax, si
		shl	ax, 1
		mov	[bp+var_C], ax	; varC = counter << 1
		mov	ax, 1Dh
		sub	ax, si
		mov	[bp+var_E], ax	; varE = 29 - counter
		mov	ax, 1Eh
		imul	[bp+var_E]	; ax = 30 * varE
		mov	bx, [bp+var_C]
		mov	g_wTrackRows[bx], ax ; 30*29,30*28..30*0
		mov	ax, 1Eh
		imul	si		; ax = 30 * counter
		mov	bx, [bp+var_C]
		mov	g_wTerrainRows[bx], ax ; 30*0,30*1..30*29
		mov	ax, [bp+var_E]
		mov	cl, 0Ah
		shl	ax, cl
		mov	[bp+var_10], ax	; var10	= varE << 10
		mov	bx, [bp+var_C]
		mov	g_wTrackPos[bx], ax
		mov	bx, [bp+var_C]
		mov	ax, [bp+var_10]
		add	ah, 2		; ax = var10 + 0x200
		mov	word ptr g_wTrackCenPos[bx], ax
		mov	ax, si
		shl	ax, cl
		mov	[bp+var_12], ax	; var12	= counter << 10
		mov	bx, [bp+var_C]
		mov	word ptr g_wTerrainPos[bx], ax
		mov	bx, [bp+var_C]
		mov	ax, [bp+var_12]
		add	ah, 2		; ax = var12 + 0x200
		mov	word ptr g_wTerrainCenPo[bx], ax
		inc	si
		cmp	si, 1Eh		; loop 30 times
		jl	short loc_0_1D
		sub	si, si

loc_0_86:				; CODE XREF: _main+ABj
		mov	ax, si
		shl	ax, 1
		mov	[bp+var_12], ax	; var12	= counter << 1
		mov	bx, ax

loc_0_8F:
		mov	ax, si
		mov	cl, 0Ah
		shl	ax, cl		; ax = counter << 10
		mov	g_wMoreTrackPos[bx], ax
		mov	bx, [bp+var_12]
		mov	ax, si
		shl	ax, cl
		add	ah, 2		; ax = (counter	<< 10) + 0x200
		mov	g_wMoreTrkCenPo[bx], ax
		inc	si
		cmp	si, 1Eh		; counter goes to 30
		jl	short loc_0_86
; Done setting up stuff	30 times
; Now load main	resource and fonts
		mov	ax, offset aMain ; "main"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	g_wMainRes1, ax
		mov	g_wMainRes2, dx
		mov	ax, offset aFontdef_fnt	; "fontdef.fnt"
		push	ax
		sub	ax, ax
		push	ax
		call	LoadResource	; type 0 = binary file
		add	sp, 4
		mov	word ptr g_dwFontDefRes, ax
		mov	word ptr g_dwFontDefRes+2, dx
		mov	ax, offset aFontn_fnt ;	"fontn.fnt"
		push	ax
		sub	ax, ax
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr g_dwFontnRes, ax
		mov	word ptr g_dwFontnRes+2, dx
		call	SetFontDef
		call	InitPolyInfo
; Done loading fonts and stuff

; The following	code allocates a new resource "trakdata" and sets up
; several global members pointing into this trakdata structure
		mov	si, 6BF3h	; the sum of the numbers added below sum up to 6bf3
		mov	ax, si
		cwd
		push	dx
		push	ax
		mov	ax, offset aTrakdata ; "trakdata"
		push	ax
		call	AllocResBytes	; create or find a new resource	with size 0x6bf3 ?
		add	sp, 6
		mov	word ptr [bp+pTrakdataPtr], ax
		mov	word ptr [bp+pTrakdataPtr+2], dx
; Set up global	pointers into trakdata
		mov	word ptr g_ppTrakdata, ax
		mov	word ptr g_ppTrakdata+2, dx
		add	word ptr [bp+pTrakdataPtr], 70Ah ; 0x70a = 1802	= size of .trk-files
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata2,	ax
		mov	word ptr g_ppTrakdata2+2, dx
		add	word ptr [bp+pTrakdataPtr], 70Ah
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata3,	ax
		mov	word ptr g_ppTrakdata3+2, dx
		add	word ptr [bp+pTrakdataPtr], 70Ah
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata4,	ax
		mov	word ptr g_ppTrakdata4+2, dx
		add	word ptr [bp+pTrakdataPtr], 80h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata5,	ax
		mov	word ptr g_ppTrakdata5+2, dx
		add	word ptr [bp+pTrakdataPtr], 80h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_pTrakdata6, ax
		mov	word ptr g_pTrakdata6+2, dx
		add	word ptr [bp+pTrakdataPtr], 80h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_pTrakdata7, ax
		mov	word ptr g_pTrakdata7+2, dx
		add	word ptr [bp+pTrakdataPtr], 80h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata8,	ax
		mov	word ptr g_ppTrakdata8+2, dx
		add	word ptr [bp+pTrakdataPtr], 60h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_pTrakdata9, ax
		mov	word ptr g_pTrakdata9+2, dx
		add	word ptr [bp+pTrakdataPtr], 180h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata10, ax
		mov	word ptr g_ppTrakdata10+2, dx
		add	word ptr [bp+pTrakdataPtr], 120h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata11, ax
		mov	word ptr g_ppTrakdata11+2, dx
		add	word ptr [bp+pTrakdataPtr], 16Ch
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata12, ax
		mov	word ptr g_ppTrakdata12+2, dx
		add	word ptr [bp+pTrakdataPtr], 0F0h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata13, ax
		mov	word ptr g_ppTrakdata13+2, dx
		add	word ptr [bp+pTrakdataPtr], 1Ah
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata14, ax
		mov	word ptr g_ppTrakdata14+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata15, ax
		mov	word ptr g_ppTrakdata15+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata16, ax
		mov	word ptr g_ppTrakdata16+2, dx
		add	word ptr [bp+pTrakdataPtr], 2EE0h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata17, ax
		mov	word ptr g_ppTrakdata17+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata18, ax
		mov	word ptr g_ppTrakdata18+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata19, ax
		mov	word ptr g_ppTrakdata19+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata20, ax
		mov	word ptr g_ppTrakdata20+2, dx
		add	word ptr [bp+pTrakdataPtr], 7ACh
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_pTrakdata21,	ax
		mov	word ptr g_pTrakdata21+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_ppTrakdata22, ax
		mov	word ptr g_ppTrakdata22+2, dx
		add	word ptr [bp+pTrakdataPtr], 385h
		mov	ax, word ptr [bp+pTrakdataPtr]
		mov	word ptr g_pTrakdata23,	ax
		mov	word ptr g_pTrakdata23+2, dx
		add	word ptr [bp+pTrakdataPtr], 30h
; Done creating	trakdata variables

		call	InitSomeVars
		mov	ax, offset aKevin ; "kevin"
		push	ax
		call	SetKevinRndSeed
		add	sp, 2
		mov	ax, offset aDefault ; "DEFAULT"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		call	_strcpy		; strcpy(g_pcTrackName,	"DEFAULT")
		add	sp, 4
		sub	si, si
		mov	ax, 1
		push	ax
		call	DoInputsCheckin
		add	sp, 2
		mov	ax, 1
		push	ax
		call	DoInputsCheckin
		add	sp, 2
		call	DoRenderMouSpr3
		mov	g_cKbOrMouse, 0
		mov	g_bPassedSecuri, 0 ; Set this to 1 to skip the copy protection / crack the game
		push	cs
		call	near ptr SetDefaultCar
		mov	si, 1
		jmp	_lblDoIntro
; ---------------------------------------------------------------------------
		nop

_lblTraksMenu0:				; CODE XREF: _main+490j
		sub	ax, ax

_lblTraksMenuAX:			; CODE XREF: _main+379j
		push	ax
		push	cs
		call	near ptr RunTracksMenu
		add	sp, 2
		jmp	_lblShowMenu
; ---------------------------------------------------------------------------
		nop

_lblDoOppMenu:				; CODE XREF: _main+488j
		call	CheckForInput
		call	ShowWaiting
		push	cs
		call	near ptr RunOpponentMenu
		jmp	_lblShowMenu
; ---------------------------------------------------------------------------
		nop

_lblDoOptions:				; CODE XREF: _main+498j
		call	CheckForInput
		call	ShowWaiting
		push	cs
		call	near ptr RunOptionMenu
		or	al, al
		jnz	short _lblGotoGame1
		jmp	_lblShowMenu
; ---------------------------------------------------------------------------

_lblGotoGame1:				; CODE XREF: _main+2E8j
		mov	[bp+cOptOrMainGame], 1
		jmp	short _lblDoGame1
; ---------------------------------------------------------------------------
		nop

_lblDoCarMenu:				; CODE XREF: _main+480j
		call	CheckForInput
		call	ShowWaiting
		sub	ax, ax
		push	ax
		mov	ax, offset g_gameInfo.cPlayerTransmission
		push	ax
		mov	ax, offset g_gameInfo.cPlayerMaterial
		push	ax
		mov	ax, offset g_gameInfo
		push	ax
		push	cs
		call	near ptr RunCarMenu
		add	sp, 8
		jmp	_lblShowMenu
; ---------------------------------------------------------------------------
		nop

_lblDoGame0:				; CODE XREF: _main+478j
		mov	[bp+cOptOrMainGame], 0

_lblDoGame1:				; CODE XREF: _main+2F1j
		push	si
		push	di
		mov	di, offset g_pcCarInfoCopy
		mov	si, offset g_gameInfo
		push	ds
		pop	es
		assume es:dseg
		mov	cx, 0Dh
		repne movsw
		pop	di
		pop	si
		sub	si, si
; copy 1802 bytes from trakdata14 to trakdata20

loc_0_32F:				; CODE XREF: _main+342j
		les	bx, g_ppTrakdata14
		assume es:nothing
		mov	al, es:[bx+si]
		les	bx, g_ppTrakdata20
		mov	es:[bx+si], al
		inc	si
		cmp	si, 70Ah
		jl	short loc_0_32F
		sub	si, si
copy some extra	stuff into trakdata20

loc_0_346:				; CODE XREF: _main+364j
		les	bx, g_ppTrakdata20
		mov	al, g_pcData20Trak1[si]
		mov	es:[bx+si+70Ah], al
		les	bx, g_ppTrakdata20
		mov	al, g_pcData20Trak2[si]
		mov	es:[bx+si+75Bh], al
		inc	si
		cmp	si, 51h		; loop 81 times
		jl	short loc_0_346
		cmp	g_cTimerOverrun, 0 ; if	cTimerOverrun is != 0, we're
					; sent into an empty track, and
					; there	is no security check (tested
					; with patch)
		jnz	short _lblFindTedit
		call	SetupTrack
		or	al, al
		jz	short _lblSecCheck1
		mov	ax, 1
		jmp	_lblTraksMenuAX
; ---------------------------------------------------------------------------

_lblSecCheck1:				; CODE XREF: _main+374j
		call	RandomWait

_lblSecCheck2:
		cmp	g_bPassedSecuri, 0
		jnz	short _lblDoCvx
		call	GetSuperRandom
		cwd
		mov	cx, 14h
		idiv	cx
		mov	ax, dx
		cbw
		push	ax
		push	cs
		call	near ptr SecurityCheck
		add	sp, 2

_lblDoCvx:				; CODE XREF: _main+386j _main+3E8j
		call	UnloadAudioReso
		mov	ax, 5780h	; size to allocate, 20*1120
		cwd
		push	dx
		push	ax
		mov	ax, offset aCvx	; "cvx"
		push	ax
		call	AllocResBytes
		add	sp, 6
		mov	word ptr g_dwCvxBytes, ax
		mov	word ptr g_dwCvxBytes+2, dx
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState	; set up 20*1120 elements
		add	sp, 2
		cmp	[bp+cOptOrMainGame], 0
		jnz	short _lblDoGameFlag1
		jmp	_lblDoGameFlag2
; ---------------------------------------------------------------------------

_lblDoGameFlag1:			; CODE XREF: _main+3CCj
		mov	g_wMainFlag, 0
		jmp	loc_0_4AC
; ---------------------------------------------------------------------------
		nop

_lblFindTedit:				; CODE XREF: _main+36Bj
		mov	ax, offset aTedit__0 ; "tedit.*"
		push	ax
		call	FindFileName
		add	sp, 2
		or	ax, ax
		jnz	short _lblDoCvx

_lblPrepareIntr:			; CODE XREF: _main+471j
		call	UnloadAudioReso

loc_0_3EF:				; CODE XREF: _main:loc_0_536j
					; _main+572j
		sub	si, si

_lblDoIntro:				; CODE XREF: _main+2B4j
		mov	ax, 2
		push	ax
		call	EnsureFileExists
		add	sp, 2
		or	si, si
		jz	short loc_0_42D
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_trk ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	CombineFilePath
		add	sp, 8
		push	word ptr g_ppTrakdata14+2
		push	word ptr g_ppTrakdata14
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	LoadBinaryFile
		add	sp, 6

loc_0_42D:				; CODE XREF: _main+3FFj
		mov	g_cTimerOverrun, 0
		push	cs
		call	near ptr RunIntroInLoop
		mov	di, ax
		cmp	di, 1Bh		; 0x1b = 27 = esc
		jnz	short _lblShowMenu
		jmp	_lblAskDos
; ---------------------------------------------------------------------------

_lblShowMenu:				; CODE XREF: _main+2C2j _main+2D4j ...
		mov	ax, 2
		push	ax
		call	EnsureFileExists
		add	sp, 2
		cmp	g_bLoadedAudio,	0
		jnz	short loc_0_467
		mov	ax, offset aSlct ; "SLCT"
		push	ax
		mov	ax, offset aSkidms_0 ; "skidms"
		push	ax
		mov	ax, offset aSkidslct ; "skidslct"
		push	ax
		call	LoadAudioResour
		add	sp, 6

loc_0_467:				; CODE XREF: _main+451j
		push	cs
		call	near ptr RunMenu
		cbw
		cmp	ax, 0FFFFh	; menu choice -1 = exit	to intro
		jnz	short loc_0_474
		jmp	_lblPrepareIntr
; ---------------------------------------------------------------------------

loc_0_474:				; CODE XREF: _main+46Fj
		or	ax, ax		; menu choice 0	= start	game
		jnz	short loc_0_47B
		jmp	_lblDoGame0
; ---------------------------------------------------------------------------

loc_0_47B:				; CODE XREF: _main+476j
		cmp	ax, 1		; menu choice 1	= car menu
		jnz	short loc_0_483
		jmp	_lblDoCarMenu
; ---------------------------------------------------------------------------

loc_0_483:				; CODE XREF: _main+47Ej
		cmp	ax, 2		; menu choice 3	= opponent menu
		jnz	short loc_0_48B
		jmp	_lblDoOppMenu
; ---------------------------------------------------------------------------

loc_0_48B:				; CODE XREF: _main+486j
		cmp	ax, 3		; menu choice 3	= tracks menu
		jnz	short loc_0_493
		jmp	_lblTraksMenu0
; ---------------------------------------------------------------------------

loc_0_493:				; CODE XREF: _main+48Ej
		cmp	ax, 4		; menu choice 4	= options menu
		jnz	short _lblDoShowMenu
		jmp	_lblDoOptions
; ---------------------------------------------------------------------------

_lblDoShowMenu:				; CODE XREF: _main+496j
		jmp	short _lblShowMenu
; ---------------------------------------------------------------------------
		nop

loc_0_49E:				; CODE XREF: _main+4CBj
		mov	g_wMainFlag, 4
		jmp	short loc_0_4AC
; ---------------------------------------------------------------------------
		nop

_lblDoGameFlag2:			; CODE XREF: _main+3CEj _main+4D0j
		mov	g_gameInfo.wRecordedFrames, 0

loc_0_4AC:				; CODE XREF: _main+3D6j _main+4A3j
		call	ShowWaiting
		call	RunGame
		cmp	g_cTimerOverrun, 0
		jnz	short loc_0_4D2
		cmp	g_wMainFlag, 0
		jz	short loc_0_4D2
		push	cs
		call	near ptr EndOfGameScores
		cbw
		or	ax, ax
		jz	short loc_0_49E
		cmp	ax, 1
		jz	short _lblDoGameFlag2

loc_0_4D2:				; CODE XREF: _main+4BBj _main+4C2j
		push	si
		push	di
		mov	di, offset g_gameInfo
		mov	si, offset g_pcCarInfoCopy
		push	ds
		pop	es
		assume es:dseg
		mov	cx, 0Dh
		repne movsw
		pop	di
		pop	si
		sub	si, si

loc_0_4E5:				; CODE XREF: _main+4F8j
		les	bx, g_ppTrakdata20
		assume es:nothing
		mov	al, es:[bx+si]
		les	bx, g_ppTrakdata14
		mov	es:[bx+si], al
		inc	si
		cmp	si, 70Ah
		jl	short loc_0_4E5
		sub	si, si

loc_0_4FC:				; CODE XREF: _main+51Aj
		les	bx, g_ppTrakdata20
		mov	al, es:[bx+si+70Ah]
		mov	g_pcData20Trak1[si], al
		les	bx, g_ppTrakdata20
		mov	al, es:[bx+si+75Bh]
		mov	g_pcData20Trak2[si], al
		inc	si
		cmp	si, 51h	; 'Q'   ; 81 times again
		jl	short loc_0_4FC
		push	word ptr g_dwCvxBytes+2
		push	word ptr g_dwCvxBytes
		call	SetResField10To0
		add	sp, 4
		cmp	g_cTimerOverrun, 0
		jnz	short loc_0_536
		jmp	_lblShowMenu
; ---------------------------------------------------------------------------

loc_0_536:				; CODE XREF: _main+531j
		jmp	loc_0_3EF
; ---------------------------------------------------------------------------
		nop

_lblAskDos:				; CODE XREF: _main+43Dj
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aDos	; "dos"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes	; Exit to dos
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		cmp	ax, 1
		jge	short loc_0_575
		jmp	loc_0_3EF
; ---------------------------------------------------------------------------

loc_0_575:				; CODE XREF: _main+570j
		call	DoRenderMouSpr3
		call	StopSoundMaybe
		call	AudioDrvAtExit
		call	StopIntsModPsp
		call	DoKbChecking
		call	SetBiosMode7
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
_main		endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunIntroInLoop	proc far		; CODE XREF: _main+433p
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		mov	ax, offset aTitl ; "TITL"
		push	ax
		mov	ax, offset aSkidms ; "skidms"
		push	ax
		mov	ax, offset aSkidtitl ; "skidtitl"
		push	ax
		call	LoadAudioResour
		add	sp, 6
		mov	ax, offset aSdtitl ; "sdtitl"
		push	ax
		mov	ax, 2
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr g_dwSdtitlRes,	ax
		mov	word ptr g_dwSdtitlRes+2, dx
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h
		push	ax
		mov	ax, 140h
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		push	cs
		call	near ptr RunIntro
		mov	si, ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		push	word ptr g_dwSdtitlRes+2
		push	word ptr g_dwSdtitlRes
		call	UnloadResource
		add	sp, 4
		or	si, si
		jnz	short loc_0_68E
		call	SetupIntro
		cbw
		mov	si, ax
		or	si, si
		jnz	short loc_0_68E
		mov	ax, offset aSdcred ; "sdcred"
		push	ax
		mov	ax, 2
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr g_dwSdtitlRes,	ax
		mov	word ptr g_dwSdtitlRes+2, dx
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h
		push	ax
		mov	ax, 140h
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		call	SelClrWndSprite
		sub	ax, ax
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		push	cs
		call	near ptr LoadIntroRes
		cbw
		mov	si, ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		push	word ptr g_dwSdtitlRes+2
		push	word ptr g_dwSdtitlRes
		call	UnloadResource
		add	sp, 4

loc_0_68E:				; CODE XREF: RunIntroInLoop+75j
					; RunIntroInLoop+81j
		call	UnloadAudioReso
		mov	ax, si
		pop	si
		mov	sp, bp
		pop	bp
		retf
RunIntroInLoop	endp

; ---------------------------------------------------------------------------
		nop
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunIntro	proc far		; CODE XREF: RunIntroInLoop+4Ep
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		call	DoRenderMouSpr3
		call	SetSprite2Clear
		call	DoUseMousePos
		call	SelClrWndSprite
		mov	ax, offset aProd ; "prod"
		push	ax
		push	word ptr g_dwSdtitlRes+2
		push	word ptr g_dwSdtitlRes
		call	LocateShape
		add	sp, 6
		mov	bx, ax
		mov	es, dx
		cmp	word ptr es:[bx+0Ah], 0
		jz	short loc_0_6DE
		mov	g_wWaitFlag, 0A0h ; ' '
		jmp	short loc_0_6E4
; ---------------------------------------------------------------------------

loc_0_6DE:				; CODE XREF: RunIntro+38j
		mov	g_wWaitFlag, 0B4h ; '´'

loc_0_6E4:				; CODE XREF: RunIntro+40j
		mov	ax, offset aProd_0 ; "prod"
		push	ax
		push	word ptr g_dwSdtitlRes+2
		push	word ptr g_dwSdtitlRes
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_532E
		add	sp, 4
		mov	ax, 0FFFFh
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	si, ax
		or	si, si
		jnz	short loc_0_77F
		mov	ax, 190h
		push	ax
		call	RepeatInputChec
		add	sp, 2
		mov	si, ax
		or	si, si
		jnz	short loc_0_77F
		call	SelClrWndSprite
		mov	g_wWaitFlag, 0B4h ; '´'
		mov	ax, offset aTitl_0 ; "titl"
		push	ax
		push	word ptr g_dwSdtitlRes+2
		push	word ptr g_dwSdtitlRes
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_532E
		add	sp, 4
		mov	ax, 0FFFFh
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	si, ax
		or	si, si
		jnz	short loc_0_77F
		mov	ax, 190h
		push	ax
		call	RepeatInputChec
		add	sp, 2
		mov	si, ax

loc_0_77F:				; CODE XREF: RunIntro+7Ej RunIntro+90j ...
		mov	ax, si
		pop	si
		mov	sp, bp
		pop	bp
		retf
RunIntro	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadIntroRes	proc far		; CODE XREF: RunIntroInLoop+CEp

var_46		= word ptr -46h
var_44		= word ptr -44h
var_40		= word ptr -40h
var_3E		= word ptr -3Eh
pCredRes1	= word ptr -3Ah
pCredRes2	= word ptr -38h
var_36		= word ptr -36h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 46h
		push	di
		push	si
		mov	ax, offset aCred ; "cred"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pCredRes1],	ax
		mov	[bp+pCredRes2],	dx
		lea	ax, [bp+var_34]
		push	ax
		mov	ax, offset aArowarrwarw1ar ; "arowarrwarw1arw2arw3arw4arw5arw6arw7arw"...
		push	ax
		push	word ptr g_dwSdtitlRes+2
		push	word ptr g_dwSdtitlRes
		call	LocateManyResou
		add	sp, 8
		mov	g_wWaitFlag, 96h ; '–'
		call	SelClrWndSprite
		les	bx, [bp+var_30]
		mov	ax, es:[bx+8]
		mov	[bp+var_2], ax
		mov	ax, es:[bx+0Ah]
		mov	[bp+var_4], ax
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		mov	[bp+var_3E], ax
		mov	ax, es:[bx+2]
		mov	[bp+var_44], ax
		mov	ax, offset aCre	; "cre"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	LocateTextRes	; credits string
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_506A
		push	word_2B77_5068
		sub	ax, ax
		push	ax
		mov	ax, 78h	; 'x'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGds0 ; "gds0"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 0Ch
		push	ax
		mov	ax, 3Ch	; '<'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGds1 ; "gds1"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 14h
		push	ax
		mov	ax, 68h	; 'h'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aDes	; "des"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_506E
		push	word_2B77_506C
		mov	ax, 20h	; ' '
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGdon ; "gdon"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 2Ch	; ','
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGkev ; "gkev"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 34h	; '4'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGbra ; "gbra"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 3Ch	; '<'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGrob ; "grob"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 44h	; 'D'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGsta ; "gsta"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 4Ch	; 'L'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aMus	; "mus"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_507A
		push	word_2B77_5078
		mov	ax, 5Ch	; '\'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGmsy ; "gmsy"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 68h	; 'h'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGkri ; "gkri"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 70h	; 'p'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGbri ; "gbri"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 78h	; 'x'
		push	ax
		mov	ax, 14h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aPro	; "pro"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5072
		push	word_2B77_5070
		mov	ax, 20h	; ' '
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGkev_0 ; "gkev"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 2Ch	; ','
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aOpr	; "opr"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5072
		push	word_2B77_5070
		mov	ax, 38h	; '8'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGbra_0 ; "gbra"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGric ; "gric"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 48h	; 'H'
		push	ax
		mov	ax, (offset g_pcData20Trak1+10h)
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aArt	; "art"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5076
		push	word_2B77_5074
		mov	ax, 54h	; 'T'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGmsm ; "gmsm"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 60h	; '`'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGdav ; "gdav"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 68h	; 'h'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGnic ; "gnic"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, 70h	; 'p'
		push	ax
		mov	ax, (offset g_pcData20Trak1+10h)
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGkev_1 ; "gkev"
		push	ax
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		push	word_2B77_5066
		push	word_2B77_5064
		mov	ax, offset aSkidms_0 ; "skidms"
		push	ax
		mov	ax, (offset g_pcData20Trak1+10h)
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	[bp+pCredRes2]
		push	[bp+pCredRes1]
		call	DoUnloadResourc
		add	sp, 4
		mov	ax, 0FFFFh
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		call	SetSprite2As1_2
		call	DoGetTimerDelta
		mov	si, 14Ah

loc_0_D77:				; CODE XREF: LoadIntroRes+661j
		call	DoGetTimerDelta
		mov	[bp+var_40], ax
		shl	ax, 1
		sub	si, ax
		cmp	[bp+var_2], si
		jle	short loc_0_DA0

loc_0_D88:				; CODE XREF: LoadIntroRes+663j
		les	bx, [bp+var_34]
		mov	ax, es:[bx+0Ah]
		mov	[bp+var_4], ax
		mov	[bp+var_36], 0
		sub	si, si
		mov	di, 2
		jmp	loc_0_E83
; ---------------------------------------------------------------------------
		nop

loc_0_DA0:				; CODE XREF: LoadIntroRes+600j
		call	DoRenderMouSpr3
		push	[bp+var_4]
		push	si
		push	word ptr [bp+var_30+2]
		push	word ptr [bp+var_30]
		call	DoMaybePutImage
		add	sp, 8
		sub	ax, ax
		push	ax
		push	[bp+var_44]
		mov	ax, 20h	; ' '
		push	ax
		push	[bp+var_4]
		mov	ax, [bp+var_3E]
		add	ax, si
		push	ax
		call	SpriteSizeOp
		add	sp, 0Ah
		call	DoUseMousePos
		push	[bp+var_40]
		call	DoInputsCheckin
		add	sp, 2
		mov	[bp+var_46], ax
		or	ax, ax
		jz	short loc_0_D77
		jmp	short loc_0_D88
; ---------------------------------------------------------------------------
		nop

loc_0_DEC:				; CODE XREF: LoadIntroRes+708j
		call	SelectWndSprite
		mov	ax, 0C8h ; 'È'
		push	ax
		push	[bp+var_4]
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		mov	bx, di
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		push	word ptr [bx-32h]
		push	word ptr [bx-34h]
		call	sub_1EA2_532E
		add	sp, 4
		call	SetSprite2As1_2
		mov	ax, 0C8h ; 'È'
		push	ax
		push	[bp+var_4]
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		call	DoUseMousePos
		add	[bp+var_36], 5
		jmp	short loc_0_E7D
; ---------------------------------------------------------------------------

loc_0_E66:				; CODE XREF: LoadIntroRes+6FAj
		call	DoGetTimerDelta
		mov	[bp+var_40], ax
		push	ax
		call	DoInputsCheckin
		add	sp, 2
		mov	[bp+var_46], ax
		add	si, [bp+var_40]

loc_0_E7D:				; CODE XREF: LoadIntroRes+6DEj
		cmp	[bp+var_36], si
		jg	short loc_0_E66
		inc	di

loc_0_E83:				; CODE XREF: LoadIntroRes+616j
		cmp	di, 0Ah
		jge	short loc_0_E91
		cmp	[bp+var_46], 0
		jnz	short loc_0_E91
		jmp	loc_0_DEC
; ---------------------------------------------------------------------------

loc_0_E91:				; CODE XREF: LoadIntroRes+700j
					; LoadIntroRes+706j
		mov	ax, 0C8h ; 'È'
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	ClearImageArea
		add	sp, 4
		call	SelectWndSprite
		mov	ax, 0C8h ; 'È'
		push	ax
		push	[bp+var_4]
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		push	word ptr [bp+var_34+2]
		push	word ptr [bp+var_34]
		call	sub_1EA2_532E
		add	sp, 4
		push	[bp+var_A]
		push	[bp+var_C]
		call	sub_1EA2_532E
		add	sp, 4
		sub	ax, ax
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_46], ax
		or	ax, ax
		jnz	short loc_0_F2B
		mov	ax, 1F4h
		push	ax
		call	RepeatInputChec
		add	sp, 2
		or	ax, ax
		jz	short loc_0_F34

loc_0_F2B:				; CODE XREF: LoadIntroRes+793j
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_0_F34:				; CODE XREF: LoadIntroRes+7A3j
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
LoadIntroRes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunMenu		proc far		; CODE XREF: _main+468p

var_10		= byte ptr -10h
var_E		= byte ptr -0Eh
var_C		= byte ptr -0Ch
var_A		= word ptr -0Ah
deTimeDelta	= word ptr -8
var_6		= byte ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 10h
		mov	[bp+var_6], 0FFh
		mov	[bp+var_10], 0
		mov	[bp+var_C], 0FFh
		call	ShowWaiting
		mov	g_wWaitFlag, 0B4h ; '´'
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		mov	ax, offset aSdmsel ; "sdmsel"
		push	ax
		mov	ax, 2
		push	ax
		call	LoadResource
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		call	SelectWndSprite
		mov	ax, offset aScrn ; "scrn"
		push	ax
		push	[bp+var_2]
		push	[bp+var_4]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_532E
		add	sp, 4
		push	[bp+var_2]
		push	[bp+var_4]
		call	UnloadResource
		add	sp, 4

loc_0_FB9:				; CODE XREF: RunMenu+13Cj RunMenu+15Bj ...
		mov	al, [bp+var_C]
		cmp	[bp+var_10], al
		jz	short loc_0_FEF
		mov	al, [bp+var_10]
		mov	[bp+var_C], al
		call	SelectWndSprite
		mov	al, [bp+var_6]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_6], 0FEh ; 'þ'
		call	SetSprite2As1_2
		call	ResetGameTime

loc_0_FEF:				; CODE XREF: RunMenu+83j
		push	word_2B77_5060
		push	word_2B77_505E
		mov	ax, offset unk_2B77_2AA
		push	ax
		mov	ax, offset unk_2B77_2A0
		push	ax
		mov	ax, offset unk_2B77_296
		push	ax
		mov	ax, offset unk_2B77_28C
		push	ax
		mov	al, [bp+var_10]
		cbw
		push	ax
		call	TimeAndMouse
		add	sp, 0Eh
		mov	[bp+deTimeDelta], ax
		push	ax
		call	InputsChecking
		add	sp, 2
		mov	[bp+var_A], ax
		mov	ax, offset unk_2B77_2AA
		push	ax
		mov	ax, offset unk_2B77_2A0
		push	ax
		mov	ax, offset unk_2B77_296
		push	ax
		mov	ax, offset unk_2B77_28C
		push	ax
		mov	ax, 5
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_E], al
		cmp	al, 0FFh
		jz	short loc_0_1049
		mov	[bp+var_10], al

loc_0_1049:				; CODE XREF: RunMenu+108j
		mov	ax, [bp+deTimeDelta]
		add	g_wCurTimeDelta, ax
		cmp	g_wCurTimeDelta, 1770h ; 6000
		jle	short loc_0_1062
		mov	g_wCurTimeDelta, 0
		inc	g_cTimerOverrun

loc_0_1062:				; CODE XREF: RunMenu+11Aj
		cmp	g_cTimerOverrun, 0
		jz	short loc_0_1072
		mov	[bp+var_10], 0
		mov	[bp+var_A], 0Dh

loc_0_1072:				; CODE XREF: RunMenu+12Bj
		cmp	[bp+var_A], 0
		jnz	short loc_0_107B
		jmp	loc_0_FB9
; ---------------------------------------------------------------------------

loc_0_107B:				; CODE XREF: RunMenu+13Aj
		mov	ax, [bp+var_A]
		cmp	ax, 0Dh
		jz	short loc_0_10BA
		cmp	ax, 1Bh
		jz	short loc_0_10B6
		cmp	ax, 20h	; ' '
		jz	short loc_0_10BA
		cmp	ax, 4B00h
		jz	short loc_0_109A
		cmp	ax, 4D00h
		jz	short loc_0_10AA
		jmp	loc_0_FB9
; ---------------------------------------------------------------------------

loc_0_109A:				; CODE XREF: RunMenu+154j
		mov	al, [bp+var_10]
		cbw
		mov	bx, ax
		mov	al, [bx+280h]

loc_0_10A4:				; CODE XREF: RunMenu+178j
		mov	[bp+var_10], al
		jmp	loc_0_FB9
; ---------------------------------------------------------------------------

loc_0_10AA:				; CODE XREF: RunMenu+159j
		mov	al, [bp+var_10]
		cbw
		mov	bx, ax
		mov	al, [bx+286h]
		jmp	short loc_0_10A4
; ---------------------------------------------------------------------------

loc_0_10B6:				; CODE XREF: RunMenu+14Aj
		mov	[bp+var_10], 0FFh

loc_0_10BA:				; CODE XREF: RunMenu+145j RunMenu+14Fj
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		mov	al, [bp+var_10]
		cbw
		mov	sp, bp
		pop	bp
		retf
RunMenu		endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunTracksMenu	proc far		; CODE XREF: _main+2BCp

var_16		= byte ptr -16h
var_14		= byte ptr -14h
var_12		= byte ptr -12h
var_E		= word ptr -0Eh
wTimeDelta	= word ptr -0Ch
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
pTeditRes1	= word ptr -4
pTeditRes2	= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	di
		push	si
		mov	ax, 3
		push	ax
		call	EnsureFileExists
		add	sp, 2
		cmp	[bp+arg_0], 0
		jz	short loc_0_10ED
		jmp	loc_0_156A
; ---------------------------------------------------------------------------

loc_0_10ED:				; CODE XREF: RunTracksMenu+18j
					; RunTracksMenu+47Fj ...
		mov	[bp+var_6], 0FFh
		mov	[bp+var_16], 0
		mov	[bp+var_12], 0FFh
		call	ShowWaiting
		mov	g_wWaitFlag, 9Bh ; '›'
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+TrackInfo.cSkybox]
		sub	ah, ah
		push	ax
		call	LoadSkybox
		add	sp, 2
		call	LoadGame3dShpes
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		mov	ax, 28h	; '('
		push	ax
		push	ax
		call	sub_1EA2_38D3
		add	sp, 8
		mov	ax, 0FFFEh
		push	ax
		call	InitGameState
		add	sp, 2
		call	SelectWndSprite
		push	g_wProbColor
		call	ClearSprite1Col
		add	sp, 2
		mov	ax, 0C8h	; 200
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		call	DoTransformShpTrk
		call	UnloadGameResources
		call	UnloadSkybox
		call	SelectWndSprite
		mov	ax, offset unk_2B77_2B4
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	ax, offset unk_2B77_2B6
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 6
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr DoHighScore
		add	sp, 2
		or	al, al
		jz	short loc_0_11F9
		jmp	loc_0_12E5
; ---------------------------------------------------------------------------

loc_0_11F9:				; CODE XREF: RunTracksMenu+124j
		mov	ax, 34h	; '4'
		imul	word_2B77_AA00
		mov	di, ax
		les	bx, g_ppTrakdata11
		cmp	word ptr es:[bx+di+32h], 0FFFFh
		jnz	short loc_0_1210
		jmp	loc_0_12E5
; ---------------------------------------------------------------------------

loc_0_1210:				; CODE XREF: RunTracksMenu+13Bj
		mov	ax, offset aHs0	; "hs0"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 12h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4
		lea	ax, [bp+var_A]
		push	ax
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr Trakdata11StringOp
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		call	SetTwoFontBytes
		add	sp, 4
		mov	ax, 1Eh
		push	ax
		mov	ax, 10h
		push	ax
		mov	al, [bp+var_A]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 1Eh
		push	ax
		mov	ax, offset aSkidms_0 ; "skidms"
		push	ax
		mov	al, [bp+var_9]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 1Eh
		push	ax
		mov	ax, 0E0h ; 'à'
		push	ax
		mov	al, [bp+var_8]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 1Eh
		push	ax
		mov	ax, (offset g_pcData20Trak2+22h)
		push	ax
		mov	al, [bp+var_7]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		call	SetFontDef

loc_0_12E5:				; CODE XREF: RunTracksMenu+126j
					; RunTracksMenu+13Dj
		mov	ax, offset aTedit ; "tedit"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pTeditRes1], ax
		mov	[bp+pTeditRes2], dx
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 18h
		push	ax
		mov	ax, 5Eh	; '^'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, 11h
		push	ax
		mov	ax, offset aBmt	; "bmt"
		push	ax
		push	dx
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 18h
		push	ax
		mov	ax, 5Eh	; '^'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, 71h	; 'q'
		push	ax
		mov	ax, offset aBet	; "bet"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 18h
		push	ax
		mov	ax, 5Eh	; '^'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, 0D1h ; 'Ñ'
		push	ax
		mov	ax, offset aBmm_0 ; "bmm"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	DoUnloadResourc
		add	sp, 4

loc_0_13B4:				; CODE XREF: RunTracksMenu+39Dj
					; RunTracksMenu+3BCj ...
		mov	al, [bp+var_12]
		cmp	[bp+var_16], al
		jz	short loc_0_13E5
		mov	al, [bp+var_16]
		mov	[bp+var_12], al
		mov	al, [bp+var_6]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_6], 0FEh ; 'þ'
		call	SetSprite2As1_2
		call	ResetGameTime

loc_0_13E5:				; CODE XREF: RunTracksMenu+2EAj
		push	word_2B77_5060
		push	word_2B77_505E
		mov	ax, offset unk_2B77_2EE
		push	ax
		mov	ax, offset unk_2B77_2E8
		push	ax
		mov	ax, offset unk_2B77_2E2
		push	ax
		mov	ax, offset unk_2B77_2DC
		push	ax
		mov	al, [bp+var_16]
		cbw
		push	ax
		call	TimeAndMouse
		add	sp, 0Eh
		mov	[bp+wTimeDelta], ax
		add	g_wCurTimeDelta, ax
		cmp	g_wCurTimeDelta, 1770h
		jle	short loc_0_1423
		mov	g_wCurTimeDelta, 0
		inc	g_cTimerOverrun

loc_0_1423:				; CODE XREF: RunTracksMenu+347j
		push	[bp+wTimeDelta]
		call	InputsChecking
		add	sp, 2
		mov	[bp+var_E], ax
		mov	ax, offset unk_2B77_2EE
		push	ax
		mov	ax, offset unk_2B77_2E8
		push	ax
		mov	ax, offset unk_2B77_2E2
		push	ax
		mov	ax, offset unk_2B77_2DC
		push	ax
		mov	ax, 3
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_14], al
		cmp	al, 0FFh
		jz	short loc_0_1457
		mov	[bp+var_16], al

loc_0_1457:				; CODE XREF: RunTracksMenu+382j
		cmp	g_cTimerOverrun, 0
		jz	short loc_0_1467
		mov	[bp+var_16], 2
		mov	[bp+var_E], 0Dh

loc_0_1467:				; CODE XREF: RunTracksMenu+38Cj
		cmp	[bp+var_E], 0
		jnz	short loc_0_1470
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------

loc_0_1470:				; CODE XREF: RunTracksMenu+39Bj
		mov	ax, [bp+var_E]
		cmp	ax, 0Dh
		jz	short loc_0_14BC
		cmp	ax, 1Bh
		jz	short loc_0_14B8
		cmp	ax, 20h	; ' '
		jz	short loc_0_14BC
		cmp	ax, 4B00h
		jz	short loc_0_1490
		cmp	ax, 4D00h
		jz	short loc_0_14A4
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------
		nop

loc_0_1490:				; CODE XREF: RunTracksMenu+3B5j
		cmp	[bp+var_16], 0
		jz	short loc_0_149C
		dec	[bp+var_16]
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------

loc_0_149C:				; CODE XREF: RunTracksMenu+3C4j
		mov	[bp+var_16], 2
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------
		nop

loc_0_14A4:				; CODE XREF: RunTracksMenu+3BAj
		cmp	[bp+var_16], 2
		jge	short loc_0_14B0
		inc	[bp+var_16]
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------

loc_0_14B0:				; CODE XREF: RunTracksMenu+3D8j
		mov	[bp+var_16], 0
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------
		nop

loc_0_14B8:				; CODE XREF: RunTracksMenu+3ABj
		mov	[bp+var_16], 0FFh

loc_0_14BC:				; CODE XREF: RunTracksMenu+3A6j
					; RunTracksMenu+3B0j
		mov	al, [bp+var_16]
		cbw
		or	ax, ax
		jz	short loc_0_14E2
		cmp	ax, 1
		jnz	short loc_0_14CC
		jmp	loc_0_155A
; ---------------------------------------------------------------------------

loc_0_14CC:				; CODE XREF: RunTracksMenu+3F7j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_0_14E2:				; CODE XREF: RunTracksMenu+3F2j
		mov	ax, offset aTrk	; "trk"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset a_trk_1 ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, 9Ch	; 'œ'
		push	ax
		call	TakesTrackNames
		add	sp, 0Ah
		cbw
		mov	si, ax
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_trk_2 ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, 9Ch	; 'œ'
		push	ax
		call	CombineFilePath
		add	sp, 8
		or	si, si
		jz	short loc_0_1552
		push	word ptr g_ppTrakdata14+2
		push	word ptr g_ppTrakdata14
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	LoadBinaryFile
		add	sp, 6
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		jmp	loc_0_10ED
; ---------------------------------------------------------------------------

loc_0_1552:				; CODE XREF: RunTracksMenu+459j
		mov	[bp+var_12], 0FFh
		jmp	loc_0_13B4
; ---------------------------------------------------------------------------
		nop

loc_0_155A:				; CODE XREF: RunTracksMenu+3F9j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4

loc_0_156A:				; CODE XREF: RunTracksMenu+1Aj
		call	CheckForInput
		call	ShowWaiting
		mov	g_wWaitFlag, 82h ; '‚'
		call	SetupTrack
		call	TrackEditRelate
		jmp	loc_0_10ED
RunTracksMenu	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoHighScore	proc far		; CODE XREF: RunTracksMenu+11Cp
					; EndOfGameScores+84Cp	...

var_3A		= word ptr -3Ah
var_38		= byte ptr -38h
var_27		= byte ptr -27h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 3Ah
		push	di
		push	si
		mov	byte_2B77_925E,	0FFh
		mov	[bp+var_3A], 0

loc_0_159A:				; CODE XREF: DoHighScore+25j
		mov	bx, [bp+var_3A]
		shl	bx, 1
		mov	ax, [bp+var_3A]
		mov	word_2B77_AA00[bx], ax
		inc	[bp+var_3A]
		cmp	[bp+var_3A], 7
		jl	short loc_0_159A
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_hig_0 ; ".hig"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	CombineFilePath
		add	sp, 8
		cmp	[bp+arg_0], 0
		jnz	short loc_0_160A
		mov	g_bSaveDelFlag,	1
		push	word ptr g_ppTrakdata11+2
		push	word ptr g_ppTrakdata11
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, 0Ah
		push	ax
		call	LoadHighScoreMa
		add	sp, 8
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		mov	g_bSaveDelFlag,	0
		or	ax, dx
		jnz	short loc_0_1602

loc_0_15F9:				; CODE XREF: DoHighScore:loc_0_168Bj
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_0_1602:				; CODE XREF: DoHighScore+6Fj
					; DoHighScore+100j
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_0_160A:				; CODE XREF: DoHighScore+43j
		mov	ax, offset a_____________0 ; "...................."
		push	ax
		lea	ax, [bp+var_38]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset a______________ ; "......................."
		push	ax
		lea	ax, [bp+var_27]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	[bp+var_F], 0
		mov	ax, offset a______ ; "../...."
		push	ax
		lea	ax, [bp+var_E]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	[bp+var_6], 0FFFFh
		mov	[bp+var_3A], 0

loc_0_1648:				; CODE XREF: DoHighScore+DDj
		mov	ax, 34h	; '4'
		imul	[bp+var_3A]
		mov	bx, ax
		les	si, g_ppTrakdata11
		lea	di, [bx+si]
		lea	si, [bp+var_38]
		mov	cx, 1Ah
		repne movsw
		inc	[bp+var_3A]
		cmp	[bp+var_3A], 7
		jl	short loc_0_1648
		mov	ax, offset g_pHiScoreRel
		cwd
		push	dx
		push	ax
		push	word ptr g_ppTrakdata11+2
		push	word ptr g_ppTrakdata11
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	SaveAndDelFile
		add	sp, 0Ah
		mov	[bp+var_3A], ax
		or	ax, ax
		jnz	short loc_0_168B
		jmp	loc_0_1602
; ---------------------------------------------------------------------------

loc_0_168B:				; CODE XREF: DoHighScore+FEj
		jmp	loc_0_15F9
DoHighScore	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MainTextResFont	proc far		; CODE XREF: EnterHiscore+F0p
					; EnterHiscore+173p ...

var_A		= byte ptr -0Ah
var_8		= word ptr -8
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= byte ptr -4
var_3		= byte ptr -3
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		call	SelectWndSprite
		mov	ax, offset aHs1	; "hs1"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset asc_2B77_332	; " '"
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	ax, offset unk_2B77_335
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 5
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		mov	ax, offset aHs2	; "hs2"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0Fh
		push	ax
		mov	ax, 10h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		mov	ax, offset aHs3	; "hs3"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0Fh
		push	ax
		mov	ax, offset aSkidms_0 ; "skidms"
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		mov	ax, offset aHs5	; "hs5"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0Fh
		push	ax
		mov	ax, 0E0h ; 'à'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		mov	ax, offset aHs4	; "hs4"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0Fh
		push	ax
		mov	ax, (offset g_pcData20Trak2+22h)
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4
		mov	[bp+var_A], 0
		jmp	loc_0_18A0
; ---------------------------------------------------------------------------

loc_0_181A:				; CODE XREF: MainTextResFont+230j
		mov	[bp+var_2], 0

loc_0_181F:				; CODE XREF: MainTextResFont+239j
		mov	al, [bp+var_A]
		cbw
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, 19h
		mov	[bp+var_8], ax
		sub	ax, ax
		push	ax
		push	[bp+var_2]
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+var_8]
		mov	ax, 10h
		push	ax
		mov	al, [bp+var_6]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		push	[bp+var_8]
		mov	ax, offset aSkidms_0 ; "skidms"
		push	ax
		mov	al, [bp+var_5]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		push	[bp+var_8]
		mov	ax, 0E0h ; 'à'
		push	ax
		mov	al, [bp+var_4]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		push	[bp+var_8]
		mov	ax, 110h
		push	ax
		mov	al, [bp+var_3]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		inc	[bp+var_A]

loc_0_18A0:				; CODE XREF: MainTextResFont+189j
		cmp	[bp+var_A], 7
		jge	short loc_0_18CA
		lea	ax, [bp+var_6]
		push	ax
		mov	al, [bp+var_A]
		cbw
		push	ax
		push	cs
		call	near ptr Trakdata11StringOp
		add	sp, 4
		mov	al, byte_2B77_925E
		cmp	[bp+var_A], al
		jz	short loc_0_18C1
		jmp	loc_0_181A
; ---------------------------------------------------------------------------

loc_0_18C1:				; CODE XREF: MainTextResFont+22Ej
		mov	ax, g_wDialogArg2
		mov	[bp+var_2], ax
		jmp	loc_0_181F
; ---------------------------------------------------------------------------

loc_0_18CA:				; CODE XREF: MainTextResFont+216j
		call	SetFontDef
		mov	sp, bp
		pop	bp
		retf
MainTextResFont	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Trakdata11StringOp proc	far		; CODE XREF: RunTracksMenu+19Ep
					; MainTextResFont+222p

var_4A		= byte ptr -4Ah
var_39		= byte ptr -39h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_18		= word ptr -18h
var_16		= byte ptr -16h
wOldRecChunkSize= word ptr -14h
var_12		= byte ptr -12h
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4Ah
		push	di
		push	si
		mov	bx, [bp+arg_0]
		shl	bx, 1
		mov	ax, 34h	; '4'
		imul	word_2B77_AA00[bx]
		add	ax, word ptr g_ppTrakdata11
		mov	dx, word ptr g_ppTrakdata11+2
		push	si
		lea	di, [bp+var_4A]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		mov	cx, 1Ah
		repne movsw		; copy 30 words
		pop	ds
		pop	si
		mov	bx, [bp+arg_2]
		mov	byte ptr [bx], 0
		lea	ax, [bp+var_4A]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		inc	al
		mov	[bp+var_16], al
		mov	bx, [bp+arg_2]
		mov	[bx+1],	al
		lea	ax, [bp+var_39]
		push	ax
		mov	al, [bp+var_16]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	al, [bp+var_16]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		inc	al
		add	[bp+var_16], al
		mov	bx, [bp+arg_2]
		mov	al, [bp+var_16]
		mov	[bx+2],	al
		mov	al, [bp+var_16]
		cbw
		mov	si, ax
		add	si, offset g_pTempByte
		mov	byte ptr [si], 0
		cmp	[bp+var_21], 1
		jnz	short loc_0_1981
		mov	ax, offset asc_2B77_347	; "("
		push	ax
		push	si
		call	_strcat
		add	sp, 4

loc_0_1981:				; CODE XREF: Trakdata11StringOp+9Ej
		lea	ax, [bp+var_20]
		push	ax
		mov	al, [bp+var_16]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		cmp	[bp+var_21], 1
		jnz	short loc_0_19AF
		mov	ax, offset asc_2B77_349	; ")"
		push	ax
		mov	al, [bp+var_16]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4

loc_0_19AF:				; CODE XREF: Trakdata11StringOp+C5j
		mov	al, [bp+var_16]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		inc	al
		add	[bp+var_16], al
		mov	ax, g_wFramesPerSec
		mov	[bp+wOldRecChunkSize], ax
		mov	g_wFramesPerSec, 14h
		cmp	[bp+var_18], 0FFFFh
		jz	short loc_0_19E0
		mov	ax, 1
		push	ax
		push	[bp+var_18]
		jmp	short loc_0_19E7
; ---------------------------------------------------------------------------
		nop

loc_0_19E0:				; CODE XREF: Trakdata11StringOp+100j
		mov	ax, 1
		push	ax
		sub	ax, ax
		push	ax

loc_0_19E7:				; CODE XREF: Trakdata11StringOp+109j
		lea	ax, [bp+var_12]
		push	ax
		call	FormatString
		add	sp, 6
		mov	bx, [bp+arg_2]
		mov	al, [bp+var_16]
		mov	[bx+3],	al
		lea	ax, [bp+var_12]
		push	ax
		mov	al, [bp+var_16]
		cbw
		add	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, [bp+wOldRecChunkSize]
		mov	g_wFramesPerSec, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
Trakdata11StringOp endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

EnterHiscore	proc far		; CODE XREF: EndOfGameScores+DC7p
					; EndOfGameScores+DFCp

var_3C		= word ptr -3Ch
var_3A		= word ptr -3Ah
var_38		= byte ptr -38h
var_36		= byte ptr -36h
var_25		= byte ptr -25h
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= byte ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 3Ch
		push	di
		push	si
		cmp	g_wFramesPerSec, 0Ah
		jnz	short loc_0_1A2E
		shl	[bp+arg_0], 1

loc_0_1A2E:				; CODE XREF: EnterHiscore+Dj
		les	bx, g_ppTrakdata11
		mov	ax, [bp+arg_0]
		cmp	es:[bx+16Ah], ax
		ja	short loc_0_1A3F
		jmp	loc_0_1BAA
; ---------------------------------------------------------------------------

loc_0_1A3F:				; CODE XREF: EnterHiscore+1Ej
		mov	[bp+var_38], 0
		jmp	short loc_0_1A5D
; ---------------------------------------------------------------------------
		nop

loc_0_1A46:				; CODE XREF: EnterHiscore+53j
		cmp	[bp+var_38], 7
		jge	short loc_0_1A71
		mov	al, [bp+var_38]
		cbw
		mov	si, ax
		mov	bx, si
		shl	bx, 1
		mov	word_2B77_AA00[bx], si
		inc	[bp+var_38]

loc_0_1A5D:				; CODE XREF: EnterHiscore+27j
		mov	al, 34h	; '4'
		imul	[bp+var_38]
		mov	di, ax
		les	bx, g_ppTrakdata11
		mov	ax, [bp+arg_0]
		cmp	es:[bx+di+32h],	ax
		jbe	short loc_0_1A46

loc_0_1A71:				; CODE XREF: EnterHiscore+2Ej
		mov	al, [bp+var_38]
		mov	[bp+var_2], al
		mov	byte_2B77_925E,	al
		jmp	short loc_0_1A8D
; ---------------------------------------------------------------------------

loc_0_1A7C:				; CODE XREF: EnterHiscore+75j
		mov	al, [bp+var_38]
		cbw
		mov	si, ax
		mov	bx, si
		shl	bx, 1
		mov	word_2B77_AA02[bx], si
		inc	[bp+var_38]

loc_0_1A8D:				; CODE XREF: EnterHiscore+5Ej
		cmp	[bp+var_38], 6
		jl	short loc_0_1A7C
		mov	al, [bp+var_2]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	word_2B77_AA00[bx], 6
		mov	ax, [bp+arg_0]
		mov	[bp+var_4], ax
		mov	[bp+var_36], 0
		mov	ax, offset g_pcCarScoreNam
		push	ax
		lea	ax, [bp+var_25]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	al, [bp+arg_6]
		mov	[bp+var_D], al
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_1AE6
		mov	ax, offset unk_2B77_ACF4
		push	ax
		lea	ax, [bp+var_C]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	[bp+var_A], 2Fh	; '/'
		mov	ax, offset g_pcCarShortNam
		push	ax
		lea	ax, [bp+var_9]
		jmp	short loc_0_1AED
; ---------------------------------------------------------------------------
		nop

loc_0_1AE6:				; CODE XREF: EnterHiscore+AAj
		mov	ax, offset asc_2B77_34B	; " "
		push	ax
		lea	ax, [bp+var_C]

loc_0_1AED:				; CODE XREF: EnterHiscore+C7j
		push	ax
		call	_strcpy
		add	sp, 4
		les	bx, g_ppTrakdata11
		lea	di, [bx+138h]
		lea	si, [bp+var_36]
		mov	cx, 1Ah
		repne movsw
		call	SelectWndSprite
		push	cs
		call	near ptr MainTextResFont
		mov	ax, 0FFFFh
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_3C]
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		push	[bp+arg_4]
		push	[bp+arg_2]
		sub	ax, ax
		push	ax
		mov	ax, 3
		push	ax
		call	DoDialog
		add	sp, 12h
		call	CheckForInput
		mov	ax, 7530h
		cwd
		push	dx
		push	ax
		push	[bp+var_3A]
		push	[bp+var_3C]
		mov	ax, 10h
		push	ax
		mov	ax, offset unk_2B77_A270
		push	ax
		call	DoReadline
		add	sp, 0Ch
		mov	ax, offset unk_2B77_A270
		push	ax
		lea	ax, [bp+var_36]
		push	ax
		call	_strcpy
		add	sp, 4
		les	bx, g_ppTrakdata11
		lea	di, [bx+138h]
		lea	si, [bp+var_36]
		mov	cx, 1Ah
		repne movsw
		call	SelectWndSprite
		push	cs
		call	near ptr MainTextResFont
		mov	ax, 0FFFFh
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		push	cs
		call	near ptr HiscoreRelated

loc_0_1BAA:				; CODE XREF: EnterHiscore+20j
		push	cs
		call	near ptr MainTextResFont
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
EnterHiscore	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

HiscoreRelated	proc far		; CODE XREF: EnterHiscore+18Bp

var_16E		= word ptr -16Eh
var_16C		= byte ptr -16Ch

		push	bp
		mov	bp, sp
		sub	sp, 16Eh
		push	di
		push	si
		mov	[bp+var_16E], 0

loc_0_1BC3:				; CODE XREF: HiscoreRelated+4Bj
		mov	bx, [bp+var_16E]
		shl	bx, 1
		mov	ax, 34h	; '4'
		imul	word_2B77_AA00[bx]
		add	ax, word ptr g_ppTrakdata11
		mov	dx, word ptr g_ppTrakdata11+2
		mov	cx, ax
		mov	ax, 34h	; '4'
		mov	bx, dx
		imul	[bp+var_16E]
		mov	si, ax
		lea	di, [bp+si+var_16C]
		mov	si, cx
		push	ss
		pop	es
		push	ds
		mov	ds, bx
		mov	cx, 1Ah
		repne movsw
		pop	ds
		inc	[bp+var_16E]
		cmp	[bp+var_16E], 7
		jl	short loc_0_1BC3
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_hig ; ".hig"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	CombineFilePath
		add	sp, 8
		mov	g_bSaveDelFlag,	1
		mov	ax, offset g_pHiScoreRel
		cwd
		push	dx
		push	ax
		lea	ax, [bp+var_16C]
		push	ss
		push	ax
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	SaveAndDelFile
		add	sp, 0Ah
		mov	g_bSaveDelFlag,	0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
HiscoreRelated	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunCarMenu	proc far		; CODE XREF: _main+30Ep
					; RunOpponentMenu+521p

var_10C		= dword	ptr -10Ch
var_108		= byte ptr -108h
var_106		= byte ptr -106h
var_104		= word ptr -104h
var_102		= word ptr -102h
var_100		= word ptr -100h
var_FE		= word ptr -0FEh
var_FC		= dword	ptr -0FCh
wAngle		= word ptr -0F8h
cCarIndex	= byte ptr -0F6h
pcFoundFile	= word ptr -0F4h
var_F2		= byte ptr -0F2h
cLastCarIndex	= byte ptr -0F0h
pCarIds		= byte ptr -0EEh
var_4C		= word ptr -4Ch
var_4A		= word ptr -4Ah
var_48		= word ptr -48h
cNumCars	= byte ptr -46h
var_44		= word ptr -44h
dwSprite	= dword	ptr -42h
var_3E		= byte ptr -3Eh
var_3C		= word ptr -3Ch
var_3A		= word ptr -3Ah
cLastCarIndexCopy= byte	ptr -38h
pSdcsel		= dword	ptr -36h
transshp	= TransformedShape3D ptr -32h
var_1E		= word ptr -1Eh
var_1C		= byte ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
wRecordChunkSize= word ptr -12h
rect		= Rectangle ptr	-10h
var_8		= word ptr -8
var_6		= byte ptr -6
pCarCounRes1	= word ptr -4
pCarCounRes2	= word ptr -2
p_pCarID	= word ptr  6
p_pcMaterial	= word ptr  8
p_pcTransmission= word ptr  0Ah
p_wOpponentType	= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 10Ch
		push	di
		push	si
		push	si
		lea	di, [bp+transshp]
		mov	si, offset unk_2B77_3EE
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		mov	[bp+transshp.pShape3D],	offset g_pCar0Shape
		mov	[bp+transshp.vecRot.wX], 0
		mov	[bp+transshp.vecRot.wY], 0
		mov	[bp+transshp.field_10],	7530h ;	30000
		mov	ax, g_wTimerFlag1
		mov	g_wTimerFlag5, ax
		or	ax, ax
		jz	short loc_0_1C82
		lea	ax, [bp+rect]
		mov	[bp+transshp.pRect], ax
		mov	[bp+transshp.cFlags], 8
		jmp	short loc_0_1C86
; ---------------------------------------------------------------------------

loc_0_1C82:				; CODE XREF: RunCarMenu+32j
		mov	[bp+transshp.cFlags], 0

loc_0_1C86:				; CODE XREF: RunCarMenu+3Ej
		mov	ax, 2
		push	ax
		call	EnsureFileExists
		add	sp, 2
		mov	ax, offset a_res_0 ; ".res"
		push	ax
		mov	ax, offset aCar	; "car*"
		push	ax
		sub	ax, ax
		push	ax
		call	FindFileFromPat
		add	sp, 6
		mov	[bp+pcFoundFile], ax
		or	ax, ax
		jnz	short _lblFindNext
		call	nullsub_1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

_lblFindNext:				; CODE XREF: RunCarMenu+69j
		mov	bx, [bp+pcFoundFile]
		mov	al, [bx+3]	; fetch	the 4 variable bytes in	car****.res and	place them in the pCarIds array
		mov	[bp+pCarIds], al
		mov	al, [bx+4]
		mov	[bp+pCarIds+1],	al
		mov	al, [bx+5]
		mov	[bp+pCarIds+2],	al
		mov	al, [bx+6]
		mov	[bp+pCarIds+3],	al
		mov	[bp+pCarIds+4],	0
		mov	[bp+cNumCars], 1

loc_0_1CE1:				; CODE XREF: RunCarMenu+100j
		call	DoFindNext
		mov	[bp+pcFoundFile], ax
		or	ax, ax
		jz	short loc_0_1D44
		mov	al, [bp+cNumCars]
		cbw
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		mov	di, ax
		add	di, bp
		mov	bx, [bp+pcFoundFile]
		mov	al, [bx+3]
		mov	[di+pCarIds], al
		mov	bx, [bp+pcFoundFile]
		mov	al, [bx+4]
		mov	[di+pCarIds+1],	al
		mov	bx, [bp+pcFoundFile]
		mov	al, [bx+5]
		mov	[di+pCarIds+2],	al
		mov	bx, [bp+pcFoundFile]
		mov	al, [bx+6]
		mov	[di+pCarIds+3],	al
		mov	al, [bp+cNumCars]
		cbw
		mov	di, ax
		shl	di, 1
		shl	di, 1
		add	di, ax
		mov	[bp+di+pCarIds+4], 0
		inc	[bp+cNumCars]
		cmp	[bp+cNumCars], 20h ; ' ' ; find max 32 cars?
		jnz	short loc_0_1CE1

loc_0_1D44:				; CODE XREF: RunCarMenu+AAj
		call	nullsub_1
		cmp	[bp+cNumCars], 1
		jg	short loc_0_1D52
		jmp	loc_0_1E10
; ---------------------------------------------------------------------------

loc_0_1D52:				; CODE XREF: RunCarMenu+10Bj
		mov	[bp+var_4A], 0
		jmp	loc_0_1DFB
; ---------------------------------------------------------------------------

loc_0_1D5A:				; CODE XREF: RunCarMenu+151j
					; RunCarMenu+1B3j
		inc	[bp+var_44]

loc_0_1D5D:				; CODE XREF: RunCarMenu+1CAj
		mov	al, [bp+cNumCars]
		cbw
		cmp	ax, [bp+var_44]
		ja	short loc_0_1D69
		jmp	loc_0_1DF8
; ---------------------------------------------------------------------------

loc_0_1D69:				; CODE XREF: RunCarMenu+122j
		mov	di, [bp+var_44]
		mov	ax, di
		shl	di, 1
		shl	di, 1
		add	di, ax
		lea	ax, [bp+di+pCarIds]
		push	ax
		mov	di, [bp+var_4A]
		mov	ax, di
		shl	di, 1
		shl	di, 1
		add	di, ax
		lea	ax, [bp+di+pCarIds]
		push	ax
		call	_strcmp
		add	sp, 4
		or	ax, ax
		jle	short loc_0_1D5A
		mov	di, [bp+var_4A]
		mov	ax, di
		shl	di, 1
		shl	di, 1
		add	di, ax
		lea	ax, [bp+di+pCarIds]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	di, [bp+var_44]
		mov	ax, di
		shl	di, 1
		shl	di, 1
		add	di, ax
		lea	ax, [bp+di+pCarIds]
		push	ax
		mov	di, [bp+var_4A]
		mov	ax, di
		shl	di, 1
		shl	di, 1
		add	di, ax
		lea	ax, [bp+di+pCarIds]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset g_pTempByte
		push	ax
		mov	di, [bp+var_44]
		mov	ax, di
		shl	di, 1
		shl	di, 1
		add	di, ax
		lea	ax, [bp+di+pCarIds]
		push	ax
		call	_strcpy
		add	sp, 4
		jmp	loc_0_1D5A
; ---------------------------------------------------------------------------

loc_0_1DF8:				; CODE XREF: RunCarMenu+124j
		inc	[bp+var_4A]

loc_0_1DFB:				; CODE XREF: RunCarMenu+115j
		mov	al, [bp+cNumCars]
		cbw
		dec	ax
		cmp	ax, [bp+var_4A]
		jle	short loc_0_1E10
		mov	ax, [bp+var_4A]
		inc	ax
		mov	[bp+var_44], ax
		jmp	loc_0_1D5D
; ---------------------------------------------------------------------------
		nop

loc_0_1E10:				; CODE XREF: RunCarMenu+10Dj
					; RunCarMenu+1C1j
		mov	[bp+cLastCarIndex], 0
		mov	[bp+cCarIndex],	0
		jmp	short loc_0_1E20
; ---------------------------------------------------------------------------

loc_0_1E1C:				; CODE XREF: RunCarMenu+201j
					; RunCarMenu+20Aj ...
		inc	[bp+cCarIndex]

loc_0_1E20:				; CODE XREF: RunCarMenu+1D8j
		mov	al, [bp+cNumCars]
		cmp	[bp+cCarIndex],	al
		jge	short loc_0_1E68
		mov	al, [bp+cCarIndex]
		cbw
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		mov	di, ax
		add	di, bp
		mov	bx, [bp+p_pCarID] ; here we compare arg0 with the carids -yes?
		mov	al, [di+pCarIds]
		cmp	[bx], al
		jnz	short loc_0_1E1C
		mov	al, [di+pCarIds+1]
		cmp	[bx+1],	al
		jnz	short loc_0_1E1C
		mov	al, [di+pCarIds+2]
		cmp	[bx+2],	al
		jnz	short loc_0_1E1C
		mov	al, [di+pCarIds+3]
		cmp	[bx+3],	al
		jnz	short loc_0_1E1C
		mov	al, [bp+cCarIndex]
		mov	[bp+cLastCarIndex], al
; When we get here, the	carid in arg0 was found	at cCarIndex.
; If it	wasnt found, cCarIndex is cNumCars

loc_0_1E68:				; CODE XREF: RunCarMenu+1E5j
		mov	g_wWaitFlag, 5Ah ; 'Z'
		mov	[bp+var_3E], 0FFh
		mov	byte_2B77_9DA4,	2Dh ; '-'
		mov	ax, offset aSdcsel ; "sdcsel"
		push	ax
		call	far ptr	j__Load2DShape_1
		add	sp, 2
		mov	word ptr [bp+pSdcsel], ax
		mov	word ptr [bp+pSdcsel+2], dx
		cmp	[bp+p_wOpponentType], 0
		jnz	short loc_0_1EA2
		mov	ax, offset aMisc_3 ; "misc"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	g_pMiscRes2, ax
		mov	g_pMiscRes1, dx

loc_0_1EA2:				; CODE XREF: RunCarMenu+24Bj
		cmp	[bp+p_wOpponentType], 0
		jnz	short loc_0_1EAB
		jmp	loc_0_1F4A
; ---------------------------------------------------------------------------

loc_0_1EAB:				; CODE XREF: RunCarMenu+264j
		mov	word_2B77_3E8, 0F0h ; 'ð'
		cmp	g_wVideoFlag4, 0
		jnz	short loc_0_1EBB
		jmp	loc_0_1F50
; ---------------------------------------------------------------------------

loc_0_1EBB:				; CODE XREF: RunCarMenu+274j
		mov	bx, [bp+p_wOpponentType]
		shl	bx, 1
		shl	bx, 1
		mov	ax, word ptr unk_2B77_A5B2[bx]
		mov	dx, word ptr unk_2B77_A5B4[bx]
		mov	word ptr [bp+var_10C], ax
		mov	word ptr [bp+var_10C+2], dx
		mov	ax, 0Fh
		push	ax
		les	bx, [bp+var_10C]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr [bp+dwSprite],	ax
		mov	word ptr [bp+dwSprite+2], dx
		call	SetupMcgaWnd2
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		mov	al, byte ptr [bp+p_wOpponentType]
		add	al, 30h	; '0'
		cbw
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	nullsub_2
		add	sp, 6
		sub	ax, ax
		push	ax
		push	ax
		mov	bx, [bp+p_wOpponentType]
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_A5B4[bx]
		push	word ptr unk_2B77_A5B2[bx]
		call	Sprite1Op2
		add	sp, 8
		sub	ax, ax
		push	ax
		push	ax
		les	bx, [bp+dwSprite]
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	DoClearImageArea
		add	sp, 8
		jmp	short loc_0_1F50
; ---------------------------------------------------------------------------
		nop

loc_0_1F4A:				; CODE XREF: RunCarMenu+266j
		mov	word_2B77_3E8, offset aDefault_0 ; "DEFAULT"

loc_0_1F50:				; CODE XREF: RunCarMenu+276j
					; RunCarMenu+305j
		mov	[bp+cLastCarIndexCopy],	0FFh
		mov	[bp+var_1E], 0
		mov	[bp+var_106], 0
		call	ResetGameTime
		mov	[bp+var_4C], 0
		mov	[bp+var_F2], 0FFh
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		mov	ax, 11h
		push	ax
		mov	ax, 24h	; '$'
		push	ax
		call	sub_1EA2_38D3
		add	sp, 8
		call	DoGetTimerDelta
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h ; 'È'
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx

_lblLoadCar:				; CODE XREF: RunCarMenu+98Bj
					; RunCarMenu:loc_0_25FAj ...
		mov	al, [bp+cLastCarIndexCopy]
		cmp	[bp+cLastCarIndex], al
		jnz	short loc_0_1FB1
		jmp	loc_0_2405
; ---------------------------------------------------------------------------

loc_0_1FB1:				; CODE XREF: RunCarMenu+36Aj
		cmp	al, 0FFh
		jz	short loc_0_1FC8
		push	[bp+pCarCounRes2]
		push	[bp+pCarCounRes1]
		call	DoUnloadResourc
		add	sp, 4
		call	UnloadCurCar

loc_0_1FC8:				; CODE XREF: RunCarMenu+371j
		mov	ax, offset g_gameInfo.dwOpponentID
		push	ax
		mov	al, [bp+cLastCarIndex]
		cbw
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 0EEh ; 'î'
		push	ax
		call	LoadCarShapes
		add	sp, 4
		mov	al, [bp+cLastCarIndex]
		cbw
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		mov	di, ax
		add	di, bp
		mov	al, [di+pCarIds]
		mov	byte ptr aCarcoun+3, al

loc_0_1FFF:
		mov	al, [di+pCarIds+1]
		mov	byte ptr aCarcoun+4, al
		mov	al, [di+pCarIds+2]
		mov	byte ptr aCarcoun+5, al
		mov	al, [di+pCarIds+3]
		mov	byte ptr aCarcoun+6, al
		mov	ax, offset aCarcoun ; "carcoun"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pCarCounRes1], ax
		mov	[bp+pCarCounRes2], dx
		sub	ax, ax
		push	ax
		push	dx
		push	[bp+pCarCounRes1]
		call	SetupAeroTrakdata
		add	sp, 6
		call	SelClrWndSprite
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 61h	; 'a'
		push	ax
		mov	ax, 140h
		push	ax
		mov	ax, 67h	; 'g'
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 55h	; 'U'
		push	ax
		mov	ax, 46h	; 'F'
		push	ax
		mov	ax, 6Dh	; 'm'
		push	ax
		mov	ax, 5
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 55h	; 'U'
		push	ax
		mov	ax, 8Ch	; 'Œ'
		push	ax
		mov	ax, 6Dh	; 'm'
		push	ax
		mov	ax, 52h	; 'R'
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	ax, offset aGrap ; "grap"
		push	ax
		push	word ptr [bp+pSdcsel+2]
		push	word ptr [bp+pSdcsel]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_532E
		add	sp, 4
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4
		push	g_wFontFlag
		sub	ax, ax
		push	ax
		call	SetTwoFontBytes
		add	sp, 4
		mov	ax, 73h	; 's'
		push	ax
		mov	ax, 9
		push	ax
		mov	ax, offset a150	; "150"
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 87h	; '‡'
		push	ax
		mov	ax, 9
		push	ax
		mov	ax, offset a100	; "100"
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 9Bh	; '›'
		push	ax
		mov	ax, 9
		push	ax
		mov	ax, offset a50	; " 50"
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 0AFh ; '¯'
		push	ax
		mov	ax, 9
		push	ax
		mov	ax, offset a0	; "  0"
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, 0B9h ; '¹'
		push	ax
		mov	ax, 1Ah
		push	ax
		mov	ax, offset a02040 ; "0	20  40"
		push	ax
		call	FontTextOp
		add	sp, 6
		call	SetFontDef
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3CC
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		mov	ax, offset aBdo_0 ; "bdo"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3CE
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		mov	ax, offset aBnx_0 ; "bnx"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3D0
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		mov	ax, offset aBla_0 ; "bla"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	bx, [bp+p_pcTransmission]
		cmp	byte ptr [bx], 0
		jz	short loc_0_2226
		mov	ax, offset aBau	; "bau"
		jmp	short loc_0_2229
; ---------------------------------------------------------------------------

loc_0_2226:				; CODE XREF: RunCarMenu+5DDj
		mov	ax, offset aBma	; "bma"

loc_0_2229:				; CODE XREF: RunCarMenu+5E2j
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		mov	[bp+var_3C], ax
		mov	[bp+var_3A], dx
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3D2
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		push	dx
		push	[bp+var_3C]
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3D4
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		mov	ax, offset aBco	; "bco"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	ax, g_wFramesPerSec
		mov	[bp+wRecordChunkSize], ax
		mov	g_wFramesPerSec, 14h
		mov	ax, 0FFFEh
		push	ax
		call	InitGameState
		add	sp, 2
		mov	gameState.carPlayer.cTransmission, 1
		mov	[bp+var_4A], 0

loc_0_22CE:				; CODE XREF: RunCarMenu+700j
		mov	ax, offset g_dwCopyOfSimd
		push	ax
		mov	ax, offset gameState.carPlayer
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 1
		push	ax
		call	UpdateCarState
		add	sp, 8
		mov	ax, gameState.carPlayer.wTrackGrip
		mov	cl, 8
		shr	ax, cl
		mov	[bp+var_8], ax
		mov	ax, 96h	; '–'
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_8]
		cwd
		mov	cl, 6

loc_0_22FB:				; CODE XREF: RunCarMenu+6BFj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_0_22FB
		push	dx
		push	ax
		call	__aFuldiv
		sub	ax, 0B5h ; 'µ'
		neg	ax
		mov	[bp+var_48], ax
		cmp	ax, 75h	; 'u'
		jb	short loc_0_2344
		mov	ax, 26h	; '&'
		imul	[bp+var_4A]
		sub	dx, dx
		mov	cx, 320h
		div	cx
		add	ax, 1Ch
		mov	[bp+var_44], ax
		push	g_wDialogArg1
		push	[bp+var_48]
		push	ax
		call	PutPixel
		add	sp, 6
		inc	[bp+var_4A]
		cmp	[bp+var_4A], 320h
		jl	short loc_0_22CE

loc_0_2344:				; CODE XREF: RunCarMenu+6D3j
		mov	ax, [bp+wRecordChunkSize]
		mov	g_wFramesPerSec, ax
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4
		mov	ax, offset aDes_1 ; "des"
		push	ax
		push	[bp+pCarCounRes2]
		push	[bp+pCarCounRes1]
		call	LocateTextRes
		add	sp, 6
		mov	word ptr [bp+var_FC], ax
		mov	word ptr [bp+var_FC+2],	dx
		mov	[bp+var_44], 0
		mov	[bp+var_48], 74h ; 't'

loc_0_237E:				; CODE XREF: RunCarMenu+791j
		les	bx, [bp+var_FC]
		inc	word ptr [bp+var_FC]
		mov	al, es:[bx]
		mov	[bp+var_1C], al
		cmp	al, 5Dh	; ']'
		jnz	short loc_0_23BE
		cmp	[bp+var_44], 0
		jz	short loc_0_23B1
		mov	bx, [bp+var_44]
		mov	g_pTempByte[bx], 0
		push	[bp+var_48]
		mov	ax, 58h	; 'X'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6

loc_0_23B1:				; CODE XREF: RunCarMenu+752j
		mov	[bp+var_44], 0
		mov	ax, g_wFontDef_0E
		add	[bp+var_48], ax
		jmp	short loc_0_23CB
; ---------------------------------------------------------------------------

loc_0_23BE:				; CODE XREF: RunCarMenu+74Cj
		mov	bx, [bp+var_44]
		inc	[bp+var_44]
		mov	al, [bp+var_1C]
		mov	g_pTempByte[bx], al

loc_0_23CB:				; CODE XREF: RunCarMenu+77Aj
		les	bx, [bp+var_FC]
		cmp	byte ptr es:[bx], 0
		jnz	short loc_0_237E
		call	SetFontDef
		call	DoGetTimerDelta
		mov	[bp+var_F2], 0FFh
		mov	[bp+var_104], 0
		mov	[bp+var_102], 140h
		mov	[bp+var_100], 0
		mov	[bp+var_FE], 0C8h ; 'È'
		mov	[bp+var_108], 0
		mov	[bp+var_6], 3

loc_0_2405:				; CODE XREF: RunCarMenu+36Cj
		mov	ax, [bp+var_4C]
		add	[bp+var_1E], ax
		mov	al, [bp+var_6]
		cbw
		or	ax, ax
		jz	short loc_0_2423
		cmp	ax, 1
		jnz	short loc_0_241B
		jmp	_BeginLoop3
; ---------------------------------------------------------------------------

loc_0_241B:				; CODE XREF: RunCarMenu+7D4j
		cmp	ax, 3
		jz	short loc_0_2423
		jmp	_BeginLoop2
; ---------------------------------------------------------------------------

loc_0_2423:				; CODE XREF: RunCarMenu+7CFj
					; RunCarMenu+7DCj
		push	word_2B77_3F2
		push	word_2B77_3F0
		call	GetAngleFromXZ
		add	sp, 4
		mov	[bp+wAngle], ax
		cmp	g_wTimerFlag5, 0
		jz	short loc_0_2448
		push	si
		lea	di, [bp+rect]
		mov	si, offset g_rc1
		jmp	short loc_0_244F
; ---------------------------------------------------------------------------
		nop

loc_0_2448:				; CODE XREF: RunCarMenu+7FAj
		push	si
		lea	di, [bp+rect]
		mov	si, offset g_pwUnk8_3

loc_0_244F:				; CODE XREF: RunCarMenu+803j
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	si
		sub	ax, ax
		push	ax
		mov	ax, offset g_pwUnk8_3
		push	ax
		sub	ax, ax
		push	ax
		push	[bp+wAngle]
		push	ax
		call	SelectRectRotate
		add	sp, 0Ah
		mov	bx, [bp+p_pcMaterial]
		mov	al, byte ptr g_pCar0Shape.wNumPaints
		cmp	[bx], al
		jl	short loc_0_247A
		mov	byte ptr [bx], 0

loc_0_247A:				; CODE XREF: RunCarMenu+833j
		mov	ax, [bp+var_1E]
		mov	[bp+transshp.vecRot.wZ], ax
		mov	bx, [bp+p_pcMaterial]
		mov	al, [bx]
		mov	[bp+transshp.cMaterial], al
		lea	ax, [bp+transshp]
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		mov	al, [bp+cLastCarIndexCopy]
		cmp	[bp+cLastCarIndex], al
		jnz	short loc_0_24A6
		mov	word_2B77_3EC, 5Fh ; '_'
		jmp	short loc_0_24AC
; ---------------------------------------------------------------------------
		nop

loc_0_24A6:				; CODE XREF: RunCarMenu+859j
		mov	word_2B77_3EC, 0C8h ; 'È'

loc_0_24AC:				; CODE XREF: RunCarMenu+861j
		mov	ax, offset unk_2B77_3E6
		push	ax
		lea	ax, [bp+rect]
		push	ax
		call	MaybeRectOp
		add	sp, 4
		lea	ax, [bp+var_1A]
		push	ax
		lea	ax, [bp+var_104]
		push	ax
		lea	ax, [bp+rect]
		push	ax
		call	MinMaxRect
		add	sp, 6
		cmp	[bp+var_6], 3
		jnz	short _BeginLoop
		jmp	_BeginLoop3
; ---------------------------------------------------------------------------

_BeginLoop:				; CODE XREF: RunCarMenu+893j
		mov	[bp+var_6], 1

_BeginLoop2:				; CODE XREF: RunCarMenu+7DEj
					; RunCarMenu+AEDj
		mov	al, [bp+var_F2]
		cmp	[bp+var_106], al
		jz	short loc_0_2541
		cmp	al, 0FFh
		jz	short loc_0_2534
		call	SetSprite2As1_2
		mov	ax, word_2B77_3DE
		inc	ax
		push	ax
		push	word_2B77_3CC
		mov	ax, word_2B77_3C2
		add	ax, g_wVideoFlag1
		and	ax, g_wVideoFlag2
		push	ax
		push	word_2B77_3B8
		call	SetSprite1Size
		add	sp, 8
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		call	DoUseMousePos
		call	SetSprite2As1_2

loc_0_2534:				; CODE XREF: RunCarMenu+8A8j
		call	ResetGameTime
		mov	al, [bp+var_106]
		mov	[bp+var_F2], al

loc_0_2541:				; CODE XREF: RunCarMenu+8A4j
		call	SetSprite2As1_2
		push	word_2B77_5060
		push	word_2B77_505E
		mov	ax, offset unk_2B77_3D6
		push	ax
		mov	ax, offset word_2B77_3CC
		push	ax
		mov	ax, offset word_2B77_3C2
		push	ax
		mov	ax, offset word_2B77_3B8
		push	ax
		mov	al, [bp+var_106]
		cbw
		push	ax
		call	TimeAndMouse
		add	sp, 0Eh
		mov	[bp+var_4C], ax
		add	g_wCurTimeDelta, ax
		cmp	g_wCurTimeDelta, 2EE0h
		jle	short loc_0_2585
		mov	g_wCurTimeDelta, 0
		inc	g_cTimerOverrun

loc_0_2585:				; CODE XREF: RunCarMenu+937j
		push	[bp+var_4C]
		call	InputsChecking
		add	sp, 2
		mov	si, ax
		mov	ax, offset unk_2B77_3D6
		push	ax
		mov	ax, offset word_2B77_3CC
		push	ax
		mov	ax, offset word_2B77_3C2
		push	ax
		mov	ax, offset word_2B77_3B8
		push	ax
		mov	ax, 5
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+cCarIndex],	al
		cmp	al, 0FFh
		jz	short loc_0_25BA
		mov	[bp+var_106], al

loc_0_25BA:				; CODE XREF: RunCarMenu+972j
		cmp	g_cTimerOverrun, 0
		jz	short loc_0_25C9
		mov	[bp+var_106], 0
		mov	si, 0Dh

loc_0_25C9:				; CODE XREF: RunCarMenu+97Dj
		or	si, si
		jnz	short loc_0_25D0
		jmp	_lblLoadCar	; Jump to loading car resources
; ---------------------------------------------------------------------------

loc_0_25D0:				; CODE XREF: RunCarMenu+989j
		mov	ax, si
		cmp	ax, 0Dh
		jnz	short loc_0_25DA
		jmp	_lblNextCarIf1
; ---------------------------------------------------------------------------

loc_0_25DA:				; CODE XREF: RunCarMenu+993j
		cmp	ax, 1Bh
		jnz	short loc_0_25E2
		jmp	_lblNextCarIf1
; ---------------------------------------------------------------------------

loc_0_25E2:				; CODE XREF: RunCarMenu+99Bj
		cmp	ax, 20h	; ' '
		jnz	short loc_0_25EA
		jmp	_lblNextCarIf1
; ---------------------------------------------------------------------------

loc_0_25EA:				; CODE XREF: RunCarMenu+9A3j
		cmp	ax, 4800h
		jnz	short loc_0_25F2
		jmp	loc_0_2910
; ---------------------------------------------------------------------------

loc_0_25F2:				; CODE XREF: RunCarMenu+9ABj
		cmp	ax, 5000h
		jnz	short loc_0_25FA
		jmp	loc_0_2926
; ---------------------------------------------------------------------------

loc_0_25FA:				; CODE XREF: RunCarMenu+9B3j
		jmp	_lblLoadCar	; Jump to loading car resources
; ---------------------------------------------------------------------------
		nop

_BeginLoop3:				; CODE XREF: RunCarMenu+7D6j
					; RunCarMenu+895j
		mov	[bp+var_6], 0
		mov	[bp+var_108], 1
		call	SelectWndSprite
		push	[bp+var_14]
		push	[bp+var_16]
		push	[bp+var_18]
		push	[bp+var_1A]
		call	SetSprite1Size
		add	sp, 8
		mov	ax, offset aStop_1 ; "stop"
		push	ax
		push	word ptr [bp+pSdcsel+2]
		push	word ptr [bp+pSdcsel]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	PutImageMaybe
		add	sp, 4
		call	sub_14D6_1296
		call	SelectWndSprite
		push	[bp+var_14]
		push	[bp+var_16]
		push	[bp+var_18]
		push	[bp+var_1A]
		call	SetSprite1Size
		add	sp, 8
		push	si
		lea	di, [bp+var_104]
		lea	si, [bp+rect]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	si
		cmp	[bp+p_wOpponentType], 0
		jz	short loc_0_26D1
		mov	al, [bp+cLastCarIndexCopy]
		cmp	[bp+cLastCarIndex], al
		jz	short loc_0_26D1
		call	SelectWndSprite
		cmp	g_wVideoFlag4, 0
		jnz	short loc_0_26B8
		mov	al, byte ptr [bp+p_wOpponentType]
		add	al, 30h	; '0'
		cbw
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	nullsub_2
		add	sp, 6
		sub	ax, ax
		push	ax
		mov	ax, 0F0h ; 'ð'
		push	ax
		mov	bx, [bp+p_wOpponentType]
		shl	bx, 1
		shl	bx, 1
		push	word ptr [bx-5A4Ch]
		push	word ptr [bx-5A4Eh]
		call	Sprite1Op2
		jmp	short loc_0_26CE
; ---------------------------------------------------------------------------

loc_0_26B8:				; CODE XREF: RunCarMenu+A40j
		sub	ax, ax
		push	ax
		mov	ax, 0F0h ; 'ð'
		push	ax
		les	bx, [bp+dwSprite]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	DoMaybePutImage

loc_0_26CE:				; CODE XREF: RunCarMenu+A74j
		add	sp, 8

loc_0_26D1:				; CODE XREF: RunCarMenu+A2Bj
					; RunCarMenu+A34j
		call	SetSprite2As1_2
		push	[bp+var_14]
		push	[bp+var_16]
		push	[bp+var_18]
		push	[bp+var_1A]
		call	SetSprite1Size
		add	sp, 8
		call	DoRenderMouSpr3
		cmp	[bp+var_3E], 0FEh ; 'þ'
		jz	short loc_0_2710
		mov	al, [bp+var_3E]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_3E], 0FEh ; 'þ'
		jmp	short loc_0_2723
; ---------------------------------------------------------------------------

loc_0_2710:				; CODE XREF: RunCarMenu+AB1j
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4

loc_0_2723:				; CODE XREF: RunCarMenu+ACCj
		call	DoUseMousePos
		mov	al, [bp+cLastCarIndex]
		mov	[bp+cLastCarIndexCopy],	al
		jmp	_BeginLoop2	; Maybe	jump to	outer loop?=
; ---------------------------------------------------------------------------

_lblNextCarIf1:				; CODE XREF: RunCarMenu+995j
					; RunCarMenu+99Dj ...
		mov	al, [bp+var_106]
		cbw
		or	ax, ax
		jz	short _lblEndIf108Is0
		cmp	ax, 1
		jnz	short _lblPrevCarIf2
		jmp	_lblNextCar
; ---------------------------------------------------------------------------

_lblPrevCarIf2:				; CODE XREF: RunCarMenu+AFCj
		cmp	ax, 2
		jnz	short _lblUseArg4If3
		jmp	_lblPrevCar
; ---------------------------------------------------------------------------

_lblUseArg4If3:				; CODE XREF: RunCarMenu+B04j
		cmp	ax, 3
		jnz	short _lblIncArg2If4
		jmp	_lblToggleTransmsn
; ---------------------------------------------------------------------------

_lblIncArg2If4:				; CODE XREF: RunCarMenu+B0Cj
		cmp	ax, 4
		jnz	short loc_0_275B
		jmp	_lblIncMaterial
; ---------------------------------------------------------------------------

loc_0_275B:				; CODE XREF: RunCarMenu+B14j
		jmp	_lblLoadCar	; Jump to loading car resources
; ---------------------------------------------------------------------------

_lblEndIf108Is0:			; CODE XREF: RunCarMenu+AF7j
		cmp	[bp+var_108], 0
		jnz	short _lblEnding
		jmp	_lblLoadCar	; Jump to loading car resources
; ---------------------------------------------------------------------------

_lblEnding:				; CODE XREF: RunCarMenu+B21j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		push	[bp+pCarCounRes2]
		push	[bp+pCarCounRes1]
		call	DoUnloadResourc
		add	sp, 4
		call	UnloadCurCar
		cmp	[bp+p_wOpponentType], 0
		jz	short _lblEnding2
		cmp	g_wVideoFlag4, 0
		jz	short _lblEnding2
		push	word ptr [bp+dwSprite+2]
		push	word ptr [bp+dwSprite]
		call	ReleaseWindow
		add	sp, 4

_lblEnding2:				; CODE XREF: RunCarMenu+B4Dj
					; RunCarMenu+B54j
		cmp	[bp+p_wOpponentType], 0
		jnz	short _lblEnding3 ; Doesnt DoMrmMgrFindBlock etc
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	DoUnloadResourc
		add	sp, 4

_lblEnding3:				; CODE XREF: RunCarMenu+B68j
		push	word ptr [bp+pSdcsel+2]
		push	word ptr [bp+pSdcsel]
		call	UnloadResource
		add	sp, 4
		call	DoRenderMouSpr3
		mov	al, [bp+cLastCarIndex]
		cbw
		mov	di, ax
		shl	di, 1
		shl	di, 1
		add	di, ax
		mov	al, [bp+di+pCarIds]
		mov	bx, [bp+p_pCarID]
		mov	[bx], al
		mov	al, [bp+cLastCarIndex]
		cbw
		mov	di, ax
		shl	di, 1
		shl	di, 1
		add	di, ax
		mov	al, [bp+di+pCarIds+1]
		mov	bx, [bp+p_pCarID]
		mov	[bx+1],	al
		mov	al, [bp+cLastCarIndex]
		cbw
		mov	di, ax
		shl	di, 1
		shl	di, 1
		add	di, ax
		mov	al, [bp+di+pCarIds+2]
		mov	bx, [bp+p_pCarID]
		mov	[bx+2],	al
		mov	al, [bp+cLastCarIndex]
		cbw
		mov	di, ax
		shl	di, 1
		shl	di, 1
		add	di, ax
		mov	al, [bp+di+pCarIds+3]
		mov	bx, [bp+p_pCarID]
		mov	[bx+3],	al
		mov	g_cTimerOverrun, 0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

_lblNextCar:				; CODE XREF: RunCarMenu+AFEj
		inc	[bp+cLastCarIndex]
		mov	al, [bp+cNumCars]
		cmp	[bp+cLastCarIndex], al
		jz	short _lblFirstCar
		jmp	_lblLoadCar	; Jump to loading car resources
; ---------------------------------------------------------------------------

_lblFirstCar:				; CODE XREF: RunCarMenu+BFFj
		mov	[bp+cLastCarIndex], 0
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

_lblPrevCar:				; CODE XREF: RunCarMenu+B06j
		dec	[bp+cLastCarIndex]
		js	short _lblLastCar
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

_lblLastCar:				; CODE XREF: RunCarMenu+C10j
		mov	al, [bp+cNumCars]
		dec	al
		mov	[bp+cLastCarIndex], al
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------
		nop

_lblToggleTransmsn:			; CODE XREF: RunCarMenu+B0Ej
		mov	bx, [bp+p_pcTransmission]
		xor	byte ptr [bx], 1
		call	SelectWndSprite
		mov	bx, [bp+p_pcTransmission]
		cmp	byte ptr [bx], 0
		jz	short loc_0_287C
		mov	ax, offset aBau_0 ; "auto"
		jmp	short loc_0_287F
; ---------------------------------------------------------------------------

loc_0_287C:				; CODE XREF: RunCarMenu+C33j
		mov	ax, offset aBma_0 ; manual

loc_0_287F:				; CODE XREF: RunCarMenu+C38j
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		mov	[bp+var_3C], ax
		mov	[bp+var_3A], dx
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3D2
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		push	dx
		push	[bp+var_3C]
		call	ImgResetText
		add	sp, 14h
		call	SetSprite2As1_2
		call	DoRenderMouSpr3
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 10h
		push	ax
		mov	ax, 56h	; 'V'
		push	ax
		mov	ax, word_2B77_3D2
		inc	ax
		push	ax
		mov	ax, word_2B77_3B8
		inc	ax
		push	ax
		push	[bp+var_3A]
		push	[bp+var_3C]
		call	ImgResetText
		add	sp, 14h
		call	DoUseMousePos
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

_lblIncMaterial:			; CODE XREF: RunCarMenu+B16j
		mov	bx, [bp+p_pcMaterial]
		inc	byte ptr [bx]
		mov	[bp+var_6], 3
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

loc_0_2910:				; CODE XREF: RunCarMenu+9ADj
		cmp	[bp+var_106], 0
		jz	short loc_0_291E
		dec	[bp+var_106]
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

loc_0_291E:				; CODE XREF: RunCarMenu+CD3j
		mov	[bp+var_106], 4
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

loc_0_2926:				; CODE XREF: RunCarMenu+9B5j
		cmp	[bp+var_106], 4
		jge	short loc_0_2934
		inc	[bp+var_106]
		jmp	_lblLoadCar
; ---------------------------------------------------------------------------

loc_0_2934:				; CODE XREF: RunCarMenu+CE9j
		mov	[bp+var_106], 0
		jmp	_lblLoadCar
RunCarMenu	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunOpponentMenu	proc far		; CODE XREF: _main+2D1p

var_1E		= byte ptr -1Eh
var_1C		= byte ptr -1Ch
var_1A		= dword	ptr -1Ah
var_16		= byte ptr -16h
var_14		= byte ptr -14h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
pOpp1Res1	= word ptr -0Ch
pOpp1Res2	= word ptr -0Ah
var_8		= word ptr -8
var_6		= byte ptr -6
var_4		= byte ptr -4
var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 1Eh
		push	si
		mov	ax, 4
		push	ax
		call	EnsureFileExists
		add	sp, 2
		mov	ax, offset aMisc ; "misc"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	g_pMiscRes2, ax
		mov	g_pMiscRes1, dx
		mov	ax, offset aSdosel ; "sdosel"
		push	ax
		mov	ax, 8
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word_2B77_9290,	ax
		mov	word_2B77_9292,	dx
		mov	ax, 0A5B2h
		push	ax
		mov	ax, offset aOpp0opp1opp2op ; "opp0opp1opp2opp3opp4opp5opp6"
		push	ax
		push	dx
		push	word_2B77_9290
		call	LocateManyResou
		add	sp, 8
		mov	[bp+var_1C], 0
		mov	[bp+var_6], 0
		mov	[bp+var_1E], 0FFh
		mov	[bp+var_4], 0FFh
		call	ResetGameTime

loc_0_29A3:				; CODE XREF: RunOpponentMenu+52Bj
		call	DoUseMousePos

loc_0_29A8:				; CODE XREF: RunOpponentMenu+45Bj
					; RunOpponentMenu:loc_0_2DBBj ...
		mov	al, g_gameInfo.cOpponentType
		cmp	[bp+var_1E], al
		jnz	short loc_0_29B3
		jmp	loc_0_2CFB
; ---------------------------------------------------------------------------

loc_0_29B3:				; CODE XREF: RunOpponentMenu+72j
		cmp	[bp+var_1E], 0FFh
		jz	short loc_0_29DD
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		cmp	[bp+var_6], 0
		jz	short loc_0_29DD
		push	[bp+pOpp1Res2]
		push	[bp+pOpp1Res1]
		call	DoUnloadResourc
		add	sp, 4

loc_0_29DD:				; CODE XREF: RunOpponentMenu+7Bj
					; RunOpponentMenu+91j
		mov	ax, 4
		push	ax
		call	EnsureFileExists
		add	sp, 2
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_2A10
		mov	al, g_gameInfo.cOpponentType
		add	al, 30h	; '0'
		mov	byte ptr aOpp1+3, al
		mov	ax, offset aOpp1 ; "opp1"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pOpp1Res1],	ax
		mov	[bp+pOpp1Res2],	dx
		mov	[bp+var_6], 1
		jmp	short loc_0_2A14
; ---------------------------------------------------------------------------

loc_0_2A10:				; CODE XREF: RunOpponentMenu+B2j
		mov	[bp+var_6], 0

loc_0_2A14:				; CODE XREF: RunOpponentMenu+D2j
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h ; 'È'
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		mov	al, g_gameInfo.cOpponentType
		mov	[bp+var_1E], al
		mov	[bp+var_14], 0FFh
		cmp	g_wVideoFlag4, 0
		jnz	short loc_0_2A48
		call	SelectWndSprite
		jmp	short loc_0_2A4D
; ---------------------------------------------------------------------------
		nop

loc_0_2A48:				; CODE XREF: RunOpponentMenu+102j
		call	SetupMcgaWnd2

loc_0_2A4D:				; CODE XREF: RunOpponentMenu+109j
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		mov	ax, 37h	; '7'
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	nullsub_2
		add	sp, 6
		mov	ax, offset aScrn_0 ; "scrn"
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	SpriteOp2
		add	sp, 4
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 12h
		push	ax
		mov	ax, 36h	; '6'
		push	ax
		mov	ax, word ptr unk_2B77_458
		inc	ax
		push	ax
		mov	ax, 15h
		push	ax
		mov	ax, offset aBla	; "bla"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 12h
		push	ax
		mov	ax, 36h	; '6'
		push	ax
		mov	ax, word ptr unk_2B77_458
		inc	ax
		push	ax
		mov	ax, 4Dh	; 'M'
		push	ax
		mov	ax, offset aBnx	; "bnx"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 12h
		push	ax
		mov	ax, 36h	; '6'
		push	ax
		mov	ax, word ptr unk_2B77_458
		inc	ax
		push	ax
		mov	ax, 85h	; '…'
		push	ax
		mov	ax, offset aBcl	; "bcl"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 12h
		push	ax
		mov	ax, 36h	; '6'
		push	ax
		mov	ax, word ptr unk_2B77_458
		inc	ax
		push	ax
		mov	ax, 0BDh ; '½'
		push	ax
		mov	ax, offset aBca	; "bca"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 12h
		push	ax
		mov	ax, 36h	; '6'
		push	ax
		mov	ax, word ptr unk_2B77_458
		inc	ax
		push	ax
		mov	ax, 0F5h ; 'õ'
		push	ax
		mov	ax, offset aBdo	; "bdo"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	al, g_gameInfo.cOpponentType
		add	al, 30h	; '0'
		cbw
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	nullsub_2
		add	sp, 6
		mov	al, g_gameInfo.cOpponentType
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_A5B4[bx]
		push	word ptr unk_2B77_A5B2[bx]
		call	SpriteOp2
		add	sp, 4
		mov	ax, 37h	; '7'
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	nullsub_2
		add	sp, 6
		mov	ax, offset aClip ; "clip"
		push	ax
		push	word_2B77_9292
		push	word_2B77_9290
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	SpriteOp2
		add	sp, 4
		cmp	g_wVideoFlag4, 0
		jz	short loc_0_2C46
		sub	ax, ax
		push	ax
		push	ax
		les	bx, g_pWndSprite
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	DoClearImageArea
		add	sp, 8
		call	SelectWndSprite

loc_0_2C46:				; CODE XREF: RunOpponentMenu+2ECj
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_2C5A
		mov	ax, offset aDes_0 ; "des"
		push	ax
		push	[bp+pOpp1Res2]
		push	[bp+pOpp1Res1]
		jmp	short loc_0_2C66
; ---------------------------------------------------------------------------
		nop

loc_0_2C5A:				; CODE XREF: RunOpponentMenu+30Fj
		mov	ax, offset aRac	; "rac"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2

loc_0_2C66:				; CODE XREF: RunOpponentMenu+31Bj
		call	LocateTextRes
		add	sp, 6
		mov	word ptr [bp+var_1A], ax
		mov	word ptr [bp+var_1A+2],	dx
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4
		push	g_wFontFlag
		sub	ax, ax
		push	ax
		call	SetTwoFontBytes
		add	sp, 4
		mov	[bp+var_8], 0
		mov	[bp+var_E], 0

loc_0_2C9D:				; CODE XREF: RunOpponentMenu+3B8j
		les	bx, [bp+var_1A]
		inc	word ptr [bp+var_1A]
		mov	al, es:[bx]
		mov	[bp+var_2], al
		cmp	al, 5Dh	; ']'
		jnz	short loc_0_2CE0
		cmp	[bp+var_8], 0
		jz	short loc_0_2CD2
		mov	bx, [bp+var_8]
		mov	g_pTempByte[bx], 0
		mov	ax, [bp+var_E]
		add	ax, 21h	; '!'
		push	ax
		mov	ax, 0Ch
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6

loc_0_2CD2:				; CODE XREF: RunOpponentMenu+375j
		mov	[bp+var_8], 0
		mov	ax, g_wFontDef_0E
		add	[bp+var_E], ax
		jmp	short loc_0_2CED
; ---------------------------------------------------------------------------
		nop

loc_0_2CE0:				; CODE XREF: RunOpponentMenu+36Fj
		mov	bx, [bp+var_8]
		inc	[bp+var_8]
		mov	al, [bp+var_2]
		mov	g_pTempByte[bx], al

loc_0_2CED:				; CODE XREF: RunOpponentMenu+3A1j
		les	bx, [bp+var_1A]
		cmp	byte ptr es:[bx], 0
		jnz	short loc_0_2C9D
		call	SetFontDef

loc_0_2CFB:				; CODE XREF: RunOpponentMenu+74j
		mov	al, [bp+var_14]
		cmp	[bp+var_1C], al
		jz	short loc_0_2D2C
		mov	al, [bp+var_1C]
		mov	[bp+var_14], al
		mov	al, [bp+var_4]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_4], 0FEh ; 'þ'
		call	DoGetTimerDelta
		call	ResetGameTime

loc_0_2D2C:				; CODE XREF: RunOpponentMenu+3C5j
		push	word_2B77_5060
		push	word_2B77_505E
		mov	ax, 462h
		push	ax
		mov	ax, 458h
		push	ax
		mov	ax, 44Eh
		push	ax
		mov	ax, 444h
		push	ax
		mov	al, [bp+var_1C]
		cbw
		push	ax
		call	TimeAndMouse
		add	sp, 0Eh
		mov	[bp+var_10], ax
		push	ax
		call	InputsChecking
		add	sp, 2
		mov	si, ax
		mov	ax, 462h
		push	ax
		mov	ax, 458h
		push	ax
		mov	ax, 44Eh
		push	ax
		mov	ax, 444h
		push	ax
		mov	ax, 5
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_16], al
		cmp	al, 0FFh
		jz	short loc_0_2D93
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_0_2D8D
		cmp	al, 3
		jz	short loc_0_2D93

loc_0_2D8D:				; CODE XREF: RunOpponentMenu+44Bj
		mov	al, [bp+var_16]
		mov	[bp+var_1C], al

loc_0_2D93:				; CODE XREF: RunOpponentMenu+444j
					; RunOpponentMenu+44Fj
		or	si, si
		jnz	short loc_0_2D9A
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2D9A:				; CODE XREF: RunOpponentMenu+459j
		mov	ax, si
		cmp	ax, 0Dh
		jz	short loc_0_2DBE
		cmp	ax, 1Bh
		jz	short loc_0_2DBE
		cmp	ax, 20h	; ' '
		jz	short loc_0_2DBE
		cmp	ax, 4B00h
		jnz	short loc_0_2DB3
		jmp	loc_0_2EF6
; ---------------------------------------------------------------------------

loc_0_2DB3:				; CODE XREF: RunOpponentMenu+472j
		cmp	ax, 4D00h
		jnz	short loc_0_2DBB
		jmp	loc_0_2F20
; ---------------------------------------------------------------------------

loc_0_2DBB:				; CODE XREF: RunOpponentMenu+47Aj
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2DBE:				; CODE XREF: RunOpponentMenu+463j
					; RunOpponentMenu+468j	...
		mov	al, [bp+var_1C]
		cbw
		or	ax, ax
		jz	short _lblDecOpponent ;	menu item 0
		cmp	ax, 1
		jz	short _lblIncOpponent ;	menu item 1
		cmp	ax, 2
		jz	short _lblClockOpponent	; menu item 2
		cmp	ax, 3
		jz	short _lblOpponentCar ;	menu item 3
		cmp	ax, 4
		jnz	short loc_0_2DDD ; menu	item > 4
		jmp	loc_0_2E6A	; goto menu item 4
; ---------------------------------------------------------------------------

loc_0_2DDD:				; CODE XREF: RunOpponentMenu+49Cj
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

; this is menu item 0

_lblDecOpponent:			; CODE XREF: RunOpponentMenu+488j
		dec	g_gameInfo.cOpponentType
		cmp	g_gameInfo.cOpponentType, 1
		jl	short loc_0_2DEE
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2DEE:				; CODE XREF: RunOpponentMenu+4ADj
		mov	g_gameInfo.cOpponentType, 6
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

; menu item 2

_lblIncOpponent:			; CODE XREF: RunOpponentMenu+48Dj
		inc	g_gameInfo.cOpponentType
		cmp	g_gameInfo.cOpponentType, 7
		jz	short _lblFirstOpponent
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

_lblFirstOpponent:			; CODE XREF: RunOpponentMenu+4C3j
		mov	g_gameInfo.cOpponentType, 1
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

_lblClockOpponent:			; CODE XREF: RunOpponentMenu+492j
		mov	g_gameInfo.cOpponentType, 0
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

; menu item 3

_lblOpponentCar:			; CODE XREF: RunOpponentMenu+497j
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_0_2E1E
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2E1E:				; CODE XREF: RunOpponentMenu+4DDj
		call	CheckForInput
		call	DoRenderMouSpr3
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		push	[bp+pOpp1Res2]
		push	[bp+pOpp1Res1]
		call	DoUnloadResourc
		add	sp, 4
		call	ShowWaiting
		mov	al, g_gameInfo.cOpponentType
		cbw
		push	ax
		mov	ax, offset g_gameInfo.cOppTransmission
		push	ax
		mov	ax, offset g_gameInfo.cOppMaterial
		push	ax
		mov	ax, offset g_gameInfo.dwOpponentID
		push	ax
		push	cs
		call	near ptr RunCarMenu
		add	sp, 8
		mov	[bp+var_1E], 0FFh
		jmp	loc_0_29A3
; ---------------------------------------------------------------------------

; when we get there, menu item 4 was selected

loc_0_2E6A:				; CODE XREF: RunOpponentMenu+49Ej
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_2EA2
		cmp	byte ptr g_gameInfo.dwOpponentID, 0FFh
		jnz	short loc_0_2EA7
		mov	al, byte ptr g_gameInfo.dwPlayerCarID
		mov	byte ptr g_gameInfo.dwOpponentID, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+1
		mov	byte ptr g_gameInfo.dwOpponentID+1, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+2
		mov	byte ptr g_gameInfo.dwOpponentID+2, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+3
		mov	byte ptr g_gameInfo.dwOpponentID+3, al
		mov	al, g_gameInfo.cPlayerMaterial
		and	al, 1
		xor	al, 1
		mov	g_gameInfo.cOppMaterial, al ; opponent car gets	(carcolor&1)xor1 by default
		mov	g_gameInfo.cOppTransmission, 0 ; manual	transmission yes
		jmp	short loc_0_2EA7
; ---------------------------------------------------------------------------
		nop

loc_0_2EA2:				; CODE XREF: RunOpponentMenu+533j
		mov	byte ptr g_gameInfo.dwOpponentID, 0FFh

loc_0_2EA7:				; CODE XREF: RunOpponentMenu+53Aj
					; RunOpponentMenu+563j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		cmp	[bp+var_6], 0
		jz	short loc_0_2ECB
		push	[bp+pOpp1Res2]
		push	[bp+pOpp1Res1]
		call	DoUnloadResourc
		add	sp, 4

loc_0_2ECB:				; CODE XREF: RunOpponentMenu+57Fj
		push	word_2B77_9292
		push	word_2B77_9290
		call	UnloadResource
		add	sp, 4
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	DoUnloadResourc
		add	sp, 4
		call	DoRenderMouSpr3
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_0_2EF6:				; CODE XREF: RunOpponentMenu+474j
		cmp	[bp+var_1C], 0
		jz	short loc_0_2F02
		dec	[bp+var_1C]
		jmp	short loc_0_2F06
; ---------------------------------------------------------------------------
		nop

loc_0_2F02:				; CODE XREF: RunOpponentMenu+5BEj
		mov	[bp+var_1C], 4

loc_0_2F06:				; CODE XREF: RunOpponentMenu+5C3j
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_2F10
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2F10:				; CODE XREF: RunOpponentMenu+5CFj
		cmp	[bp+var_1C], 3
		jz	short loc_0_2F19
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2F19:				; CODE XREF: RunOpponentMenu+5D8j
		dec	[bp+var_1C]
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------
		nop

loc_0_2F20:				; CODE XREF: RunOpponentMenu+47Cj
		cmp	[bp+var_1C], 4
		jge	short loc_0_2F2C
		inc	[bp+var_1C]
		jmp	short loc_0_2F30
; ---------------------------------------------------------------------------
		nop

loc_0_2F2C:				; CODE XREF: RunOpponentMenu+5E8j
		mov	[bp+var_1C], 0

loc_0_2F30:				; CODE XREF: RunOpponentMenu+5EDj
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_2F3A
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2F3A:				; CODE XREF: RunOpponentMenu+5F9j
		cmp	[bp+var_1C], 3
		jz	short loc_0_2F43
		jmp	loc_0_29A8
; ---------------------------------------------------------------------------

loc_0_2F43:				; CODE XREF: RunOpponentMenu+602j
		inc	[bp+var_1C]
		jmp	loc_0_29A8
RunOpponentMenu	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunOptionMenu	proc far		; CODE XREF: _main+2E3p

var_6		= byte ptr -6
var_4		= byte ptr -4
var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 6
		mov	ax, offset aMisc_1 ; "misc"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	g_pMiscRes2, ax
		mov	g_pMiscRes1, dx
		call	SetSprite2As1_2
		push	word_2B77_508A
		call	ClearSprite1Col
		add	sp, 2
		mov	ax, offset aGstu ; "gstu"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 6
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	ax, offset aGver ; "gver"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 10h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		mov	[bp+var_4], 1

loc_0_3004:				; CODE XREF: RunOptionMenu+216j
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMop	; "mop"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_2], al
		cbw
		sub	ax, 0FFFFh
		cmp	ax, 7
		jbe	short loc_0_3046
		jmp	loc_0_315A
; ---------------------------------------------------------------------------

loc_0_3046:				; CODE XREF: RunOptionMenu+F7j
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_0_314A[bx]

loc_0_304E:				; DATA XREF: RunOptionMenu+202o
		cmp	byte_2B77_182, 0
		jz	short loc_0_305C
		mov	[bp+var_6], 2
		jmp	short loc_0_306E
; ---------------------------------------------------------------------------
		nop

loc_0_305C:				; CODE XREF: RunOptionMenu+109j
		cmp	g_bSkipJoystick, 0
		jz	short loc_0_306A
		mov	[bp+var_6], 1
		jmp	short loc_0_306E
; ---------------------------------------------------------------------------
		nop

loc_0_306A:				; CODE XREF: RunOptionMenu+117j
		mov	[bp+var_6], 0

loc_0_306E:				; CODE XREF: RunOptionMenu+10Fj
					; RunOptionMenu+11Dj
		mov	al, [bp+var_6]
		cbw
		push	ax
		sub	ax, ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMid	; "mid"
		push	ax
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_2], al
		cbw
		or	ax, ax
		jz	short loc_0_30BA
		cmp	ax, 1
		jz	short loc_0_30C2
		cmp	ax, 2
		jz	short loc_0_30CA
		jmp	loc_0_315A
; ---------------------------------------------------------------------------

loc_0_30BA:				; CODE XREF: RunOptionMenu+161j
		call	DoKeyResText
		jmp	loc_0_315A
; ---------------------------------------------------------------------------

loc_0_30C2:				; CODE XREF: RunOptionMenu+166j
		call	DoJoyResText
		jmp	loc_0_315A
; ---------------------------------------------------------------------------

loc_0_30CA:				; CODE XREF: RunOptionMenu+16Bj
		call	DoMouResText
		jmp	loc_0_315A
; ---------------------------------------------------------------------------

loc_0_30D2:				; CODE XREF: RunOptionMenu+FFj
					; DATA XREF: RunOptionMenu+204o
		call	DoMofTextRes
		jmp	loc_0_315A
; ---------------------------------------------------------------------------

loc_0_30DA:				; CODE XREF: RunOptionMenu+FFj
					; DATA XREF: RunOptionMenu+206o
		call	DoSonSofTextRes
		jmp	short loc_0_315A
; ---------------------------------------------------------------------------
		nop

loc_0_30E2:				; CODE XREF: RunOptionMenu+FFj
					; DATA XREF: RunOptionMenu+208o
		mov	ax, offset aRep	; "rep"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset a_rpl ; ".rpl"
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		mov	ax, 0EEh ; 'î'
		push	ax
		call	TakesTrackNames
		add	sp, 0Ah
		mov	[bp+var_6], al
		or	al, al
		jz	short loc_0_315A
		mov	g_wWaitFlag, 96h ; '–'
		call	ShowWaiting
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		mov	ax, 0EEh ; 'î'
		push	ax
		call	LoadReplayFile
		add	sp, 4
		mov	[bp+var_4], 1
		jmp	short loc_0_3163
; ---------------------------------------------------------------------------

loc_0_3134:				; CODE XREF: RunOptionMenu+FFj
					; DATA XREF: RunOptionMenu+20Ao
		call	DoMrlTextRes
		jmp	short loc_0_315A
; ---------------------------------------------------------------------------
		nop

loc_0_313C:				; CODE XREF: RunOptionMenu+FFj
					; DATA XREF: RunOptionMenu+20Co
		call	DoDosTextRes
		jmp	short loc_0_315A
; ---------------------------------------------------------------------------
		nop

loc_0_3144:				; CODE XREF: RunOptionMenu+FFj
					; DATA XREF: RunOptionMenu:off_0_314Ao	...
		mov	[bp+var_4], 0
		jmp	short loc_0_315A
; ---------------------------------------------------------------------------
off_0_314A	dw offset loc_0_3144	; DATA XREF: RunOptionMenu+FFr
		dw offset loc_0_304E
		dw offset loc_0_30D2
		dw offset loc_0_30DA
		dw offset loc_0_30E2
		dw offset loc_0_3134
		dw offset loc_0_313C
		dw offset loc_0_3144
; ---------------------------------------------------------------------------

loc_0_315A:				; CODE XREF: RunOptionMenu+F9j
					; RunOptionMenu+16Dj ...
		cmp	[bp+var_4], 0
		jz	short loc_0_3163
		jmp	loc_0_3004
; ---------------------------------------------------------------------------

loc_0_3163:				; CODE XREF: RunOptionMenu+1E8j
					; RunOptionMenu+214j
		push	g_pMiscRes1
		push	g_pMiscRes2
		call	DoUnloadResourc
		mov	al, [bp+var_4]
		cbw
		mov	sp, bp
		pop	bp
		retf
RunOptionMenu	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

EndOfGameScores	proc far		; CODE XREF: _main+4C5p

var_9E		= word ptr -9Eh
var_9C		= word ptr -9Ch
var_9A		= byte ptr -9Ah
var_98		= byte ptr -98h
var_92		= byte ptr -92h
var_90		= word ptr -90h
var_8E		= byte ptr -8Eh
var_8C		= word ptr -8Ch
var_8A		= word ptr -8Ah
var_88		= word ptr -88h
var_86		= dword	ptr -86h
var_82		= byte ptr -82h
var_80		= word ptr -80h
var_7E		= word ptr -7Eh
var_7C		= word ptr -7Ch
var_7A		= word ptr -7Ah
var_78		= byte ptr -78h
var_72		= word ptr -72h
var_70		= word ptr -70h
var_6E		= byte ptr -6Eh
var_6C		= byte ptr -6Ch
var_6A		= byte ptr -6Ah
var_68		= word ptr -68h
var_66		= word ptr -66h
var_64		= byte ptr -64h
var_62		= byte ptr -62h
var_5C		= word ptr -5Ch
var_5A		= word ptr -5Ah
var_58		= word ptr -58h
var_56		= dword	ptr -56h
var_52		= byte ptr -52h
var_50		= word ptr -50h
var_4E		= word ptr -4Eh
var_4C		= word ptr -4Ch
var_4A		= dword	ptr -4Ah
var_46		= dword	ptr -46h
var_42		= word ptr -42h
var_40		= word ptr -40h
var_3E		= byte ptr -3Eh
var_3C		= byte ptr -3Ch
var_1C		= word ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= byte ptr -18h
var_16		= byte ptr -16h
var_14		= byte ptr -14h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h

		push	bp
		mov	bp, sp
		sub	sp, 9Eh
		push	di
		push	si
		mov	ax, 4
		push	ax
		call	EnsureFileExists
		add	sp, 2
		mov	ax, offset aMisc_2 ; "misc"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+var_4E], ax
		mov	[bp+var_4C], dx
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_31C0
		mov	al, g_gameInfo.cOpponentType
		add	al, 30h	; '0'
		mov	byte ptr aOpp1+3, al
		mov	ax, offset aOpp1 ; "opp1"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+var_68], ax
		mov	[bp+var_66], dx

loc_0_31C0:				; CODE XREF: EndOfGameScores+2Cj
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		cmp	g_wVideoFlag4, 0
		jz	short loc_0_31FC
		mov	ax, 0Fh
		push	ax
		mov	ax, 64h		; 100
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr [bp+var_46], ax
		mov	word ptr [bp+var_46+2],	dx

loc_0_31FC:				; CODE XREF: EndOfGameScores+68j
		mov	[bp+var_52], 0FFh
		call	SelClrWndSprite
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 64h		; 100
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 63h	; 'c'
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		mov	ax, 65h	; 'e'
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	[bp+var_70], 6Bh ; 'k'
		mov	ax, offset aElt	; "elt"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		cmp	word_2B77_8BDE,	0
		jnz	short loc_0_3281
		jmp	loc_0_3354
; ---------------------------------------------------------------------------

loc_0_3281:				; CODE XREF: EndOfGameScores+104j
		mov	ax, 1
		push	ax
		mov	ax, word_2B77_8BDE
		sub	ax, word_2B77_8BE6
		push	ax
		lea	ax, [bp+var_12]
		push	ax
		call	FormatString
		add	sp, 6
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		test	g_wMainFlag, 2
		jz	short loc_0_32DC
		mov	ax, offset aCon	; "con"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6

loc_0_32DC:				; CODE XREF: EndOfGameScores+136j
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		add	[bp+var_70], 0Ah
		cmp	word_2B77_8BE6,	0
		jnz	short loc_0_330D
		jmp	loc_0_33A7
; ---------------------------------------------------------------------------

loc_0_330D:				; CODE XREF: EndOfGameScores+190j
		mov	ax, offset aPpt	; "ppt"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, 1
		push	ax
		push	word_2B77_8BE6
		lea	ax, [bp+var_12]
		push	ax
		call	FormatString
		add	sp, 6
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		jmp	short loc_0_3380
; ---------------------------------------------------------------------------
		align 2

loc_0_3354:				; CODE XREF: EndOfGameScores+106j
		mov	ax, offset aDnf	; "dnf"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6

loc_0_3380:				; CODE XREF: EndOfGameScores+1D9j
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		add	[bp+var_70], 0Ah

loc_0_33A7:				; CODE XREF: EndOfGameScores+192j
		mov	[bp+var_18], 2
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_0_33B5
		jmp	loc_0_34DC
; ---------------------------------------------------------------------------

loc_0_33B5:				; CODE XREF: EndOfGameScores+238j
		cmp	word_2B77_8BE0,	0
		jnz	short loc_0_340C
		mov	ax, offset aOlt	; "olt"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset aDnf_0 ; "dnf"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		jmp	loc_0_34AA
; ---------------------------------------------------------------------------
		align 2

loc_0_340C:				; CODE XREF: EndOfGameScores+242j
		cmp	word_2B77_8BDE,	0
		jz	short loc_0_341C
		mov	ax, word_2B77_8BDE
		cmp	word_2B77_8BE0,	ax
		jnb	short loc_0_3466

loc_0_341C:				; CODE XREF: EndOfGameScores+299j
		mov	ax, offset aOwt	; "owt"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, 1
		push	ax
		push	word_2B77_8BE0
		lea	ax, [bp+var_12]
		push	ax
		call	FormatString
		add	sp, 6
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	[bp+var_18], 1
		jmp	short loc_0_34B5
; ---------------------------------------------------------------------------

loc_0_3466:				; CODE XREF: EndOfGameScores+2A2j
		mov	ax, offset aOlt_0 ; "olt"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, 1
		push	ax
		push	word_2B77_8BE0
		lea	ax, [bp+var_12]
		push	ax
		call	FormatString
		add	sp, 6
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4

loc_0_34AA:				; CODE XREF: EndOfGameScores+290j
		cmp	word_2B77_8BDE,	0
		jz	short loc_0_34B5
		mov	[bp+var_18], 0

loc_0_34B5:				; CODE XREF: EndOfGameScores+2ECj
					; EndOfGameScores+337j
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		add	[bp+var_70], 0Ah

loc_0_34DC:				; CODE XREF: EndOfGameScores+23Aj
		cmp	[bp+var_18], 0
		jnz	short loc_0_34F0
		mov	ax, offset aVict ; "VICT"
		push	ax
		mov	ax, offset aSkidms_1 ; "skidms"
		push	ax
		mov	ax, offset aSkidvict ; "skidvict"
		jmp	short loc_0_34FB
; ---------------------------------------------------------------------------
		align 2

loc_0_34F0:				; CODE XREF: EndOfGameScores+368j
		mov	ax, offset aOver ; "OVER"
		push	ax
		mov	ax, offset aSkidms_2 ; "skidms"
		push	ax
		mov	ax, offset aSkidover ; "skidover"

loc_0_34FB:				; CODE XREF: EndOfGameScores+375j
		push	ax
		call	LoadAudioResour
		add	sp, 6
		mov	al, g_gameInfo.cOpponentType
		mov	[bp+var_16], al
		cmp	[bp+var_18], 2
		jnz	short loc_0_351D
		mov	ax, word_2B77_8BE2
		cmp	word_2B77_8BE4,	ax
		jz	short loc_0_351D
		mov	[bp+var_16], 0

loc_0_351D:				; CODE XREF: EndOfGameScores+396j
					; EndOfGameScores+39Fj
		mov	ax, offset aAvs	; "avs"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, word_2B77_8BE2
		add	ax, g_wResetOnCvxTr
		jz	short loc_0_356A
		mov	ax, word_2B77_8BE2
		add	ax, g_wResetOnCvxTr
		sub	cx, cx
		push	cx
		push	ax
		push	word_2B77_8BDA
		push	word_2B77_8BD8
		call	__aFuldiv
		mov	al, ah
		mov	ah, dl
		mov	dl, dh
		sub	dh, dh
		mov	di, ax
		jmp	short loc_0_356C
; ---------------------------------------------------------------------------

loc_0_356A:				; CODE XREF: EndOfGameScores+3CCj
		sub	di, di

loc_0_356C:				; CODE XREF: EndOfGameScores+3F0j
		mov	ax, 3
		push	ax
		sub	ax, ax
		push	ax
		push	di
		lea	ax, [bp+var_12]
		push	ax
		call	DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	ax, offset aMph	; "mph"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		add	[bp+var_70], 0Ah
		cmp	word_2B77_8BE8,	0
		jnz	short loc_0_35ED
		jmp	loc_0_368B
; ---------------------------------------------------------------------------

loc_0_35ED:				; CODE XREF: EndOfGameScores+470j
		mov	ax, offset aImp	; "imp"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, 3
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, word_2B77_8BE8
		mov	cl, 8
		shr	ax, cl
		push	ax
		lea	ax, [bp+var_12]
		push	ax
		call	DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	ax, offset aMph_0 ; "mph"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		add	[bp+var_70], 0Ah

loc_0_368B:				; CODE XREF: EndOfGameScores+472j
		mov	ax, offset aTop	; "top"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, 3
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, word_2B77_8BEA
		mov	cl, 8
		shr	ax, cl
		push	ax
		lea	ax, [bp+var_12]
		push	ax
		call	DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		mov	ax, offset aMph_1 ; "mph"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		add	[bp+var_70], 0Ah
		cmp	word_2B77_8BEC,	0
		jz	short loc_0_379A
		mov	ax, offset aJum	; "jum"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, 3
		push	ax
		sub	ax, ax
		push	ax
		push	word_2B77_8BEC
		lea	ax, [bp+var_12]
		push	ax
		call	DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcat
		add	sp, 4
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		push	[bp+var_70]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah

loc_0_379A:				; CODE XREF: EndOfGameScores+5B6j
		cmp	[bp+var_16], 0
		jnz	short loc_0_37A3
		jmp	loc_0_38FF
; ---------------------------------------------------------------------------

loc_0_37A3:				; CODE XREF: EndOfGameScores+626j
		test	g_wMainFlag, 4
		jz	short loc_0_37AD
		jmp	loc_0_384B
; ---------------------------------------------------------------------------

loc_0_37AD:				; CODE XREF: EndOfGameScores+630j
		mov	ax, word_2B77_55D0
		mov	word_2B77_55CA,	ax
		mov	ax, word_2B77_55D2
		mov	word_2B77_55CC,	ax
		mov	ax, word_2B77_55D4
		mov	word_2B77_55CE,	ax
		call	GetSuperRandom
		cwd
		mov	cx, 3
		idiv	cx
		mov	word_2B77_55D0,	dx
		mov	ax, word_2B77_55CA
		cmp	dx, ax
		jnz	short loc_0_37E0
		mov	bx, dx
		shl	bx, 1
		mov	ax, g_array201[bx]
		mov	word_2B77_55D0,	ax

loc_0_37E0:				; CODE XREF: EndOfGameScores+65Bj
		call	GetSuperRandom
		cwd
		mov	cx, 3
		idiv	cx
		mov	word_2B77_55D4,	dx
		mov	ax, word_2B77_55CE
		cmp	dx, ax
		jnz	short loc_0_3801
		mov	bx, dx
		shl	bx, 1
		mov	ax, g_array201[bx]
		mov	word_2B77_55D4,	ax

loc_0_3801:				; CODE XREF: EndOfGameScores+67Cj
		cmp	[bp+var_18], 1
		jnz	short loc_0_382A
		cmp	word_2B77_8BDE,	0
		jz	short loc_0_381E
		call	GetSuperRandom
		cwd
		mov	cx, 2
		idiv	cx
		add	dx, cx
		jmp	short loc_0_3835
; ---------------------------------------------------------------------------
		align 2

loc_0_381E:				; CODE XREF: EndOfGameScores+694j
		call	GetSuperRandom
		cwd
		mov	cx, 2
		jmp	short loc_0_3833
; ---------------------------------------------------------------------------
		align 2

loc_0_382A:				; CODE XREF: EndOfGameScores+68Dj
		call	GetSuperRandom
		cwd
		mov	cx, 4

loc_0_3833:				; CODE XREF: EndOfGameScores+6AFj
		idiv	cx

loc_0_3835:				; CODE XREF: EndOfGameScores+6A3j
		mov	word_2B77_55D2,	dx
		mov	ax, word_2B77_55CC
		cmp	dx, ax
		jnz	short loc_0_384B
		mov	bx, dx
		shl	bx, 1
		mov	ax, g_array103[bx]
		mov	word_2B77_55D2,	ax

loc_0_384B:				; CODE XREF: EndOfGameScores+632j
					; EndOfGameScores+6C6j
		cmp	[bp+var_18], 1
		jnz	short loc_0_38B6
		mov	al, g_gameInfo.cOpponentType
		add	al, 30h	; '0'
		mov	byte ptr aOpp2win+3, al
		mov	ax, offset aOpp2win ; "opp2win"
		push	ax
		mov	ax, 3
		push	ax
		call	LoadResource	; load oppNwin
		add	sp, 4
		mov	[bp+var_1C], ax
		mov	[bp+var_1A], dx
		mov	ax, offset aWinn ; "winn"
		push	ax
		push	[bp+var_66]
		push	[bp+var_68]
		call	AltLocateShape
		add	sp, 6
		mov	[bp+var_5A], ax
		mov	[bp+var_58], dx
		cmp	word_2B77_8BDE,	0
		jz	short loc_0_38A0
		call	GetRandomKevin
		add	ax, g_wDrvNameTime
		and	ax, 1
		add	ax, 2
		jmp	short loc_0_38AC
; ---------------------------------------------------------------------------
		align 2

loc_0_38A0:				; CODE XREF: EndOfGameScores+714j
		call	GetRandomKevin
		add	ax, g_wDrvNameTime
		and	ax, 1

loc_0_38AC:				; CODE XREF: EndOfGameScores+725j
		mov	word_2B77_55D2,	ax
		mov	[bp+var_6A], 76h ; 'v'
		jmp	short loc_0_38FF
; ---------------------------------------------------------------------------
		align 2

loc_0_38B6:				; CODE XREF: EndOfGameScores+6D7j
		mov	al, g_gameInfo.cOpponentType
		add	al, 30h	; '0'
		mov	byte ptr aOpp2+3, al
		mov	ax, offset aOpp2 ; "opp2"
		push	ax
		mov	ax, 3
		push	ax
		call	LoadResource
		add	sp, 4
		mov	[bp+var_1C], ax
		mov	[bp+var_1A], dx
		mov	ax, offset aLose_0 ; "lose"
		push	ax
		push	[bp+var_66]
		push	[bp+var_68]
		call	AltLocateShape
		add	sp, 6
		mov	[bp+var_5A], ax
		mov	[bp+var_58], dx
		call	GetRandomKevin
		add	ax, g_wDrvNameTime
		and	ax, 3
		mov	word_2B77_55D2,	ax
		mov	[bp+var_6A], 64h ; 'd'

loc_0_38FF:				; CODE XREF: EndOfGameScores+628j
					; EndOfGameScores+73Bj
		mov	[bp+var_6E], 0
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_trk_0 ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	CombineFilePath
		add	sp, 8
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, 1
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr [bp+var_4A], ax
		mov	word ptr [bp+var_4A+2],	dx
		or	ax, dx
		jnz	short loc_0_397F
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aIhd	; "ihd"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		call	DoDialog
		add	sp, 12h
		or	ax, ax
		jz	short loc_0_397F
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, 1
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr [bp+var_4A], ax
		mov	word ptr [bp+var_4A+2],	dx

loc_0_397F:				; CODE XREF: EndOfGameScores+7BBj
					; EndOfGameScores+7EFj
		mov	ax, word ptr [bp+var_4A]
		or	ax, word ptr [bp+var_4A+2]
		jz	short loc_0_39B6
		sub	di, di
		jmp	short loc_0_398D
; ---------------------------------------------------------------------------
		align 2

loc_0_398C:				; CODE XREF: EndOfGameScores+828j
		inc	di

loc_0_398D:				; CODE XREF: EndOfGameScores+811j
		cmp	di, 385h
		jge	short loc_0_39A6
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+di+TrackInfo.pTrackData]
		les	bx, [bp+var_4A]
		cmp	es:[bx+di], al
		jz	short loc_0_398C
		mov	[bp+var_6E], 0FFh

loc_0_39A6:				; CODE XREF: EndOfGameScores+819j
		push	word ptr [bp+var_4A+2]
		push	word ptr [bp+var_4A]
		call	SetResField10To0
		add	sp, 4
		jmp	short loc_0_39BA
; ---------------------------------------------------------------------------

loc_0_39B6:				; CODE XREF: EndOfGameScores+80Dj
		mov	[bp+var_6E], 0FFh

loc_0_39BA:				; CODE XREF: EndOfGameScores+83Cj
		cmp	[bp+var_6E], 0FFh
		jz	short loc_0_39E1
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr DoHighScore
		add	sp, 2
		or	al, al
		jz	short loc_0_39E1
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr DoHighScore
		add	sp, 2
		or	al, al
		jz	short loc_0_39E1
		mov	[bp+var_6E], 0FFh

loc_0_39E1:				; CODE XREF: EndOfGameScores+846j
					; EndOfGameScores+854j	...
		cmp	[bp+var_6E], 0
		jnz	short loc_0_3A0F
		cmp	word_2B77_8BDE,	0
		jz	short loc_0_3A0F
		mov	ax, word_2B77_8BDE
		mov	[bp+var_88], ax
		test	g_wMainFlag, 6
		jnz	short loc_0_3A0F
		or	ax, ax
		jz	short loc_0_3A0F
		les	bx, g_ppTrakdata11
		cmp	es:[bx+16Ah], ax
		jbe	short loc_0_3A0F
		mov	[bp+var_6E], 1

loc_0_3A0F:				; CODE XREF: EndOfGameScores+86Dj
					; EndOfGameScores+874j	...
		mov	[bp+var_8E], 0
		mov	[bp+var_42], 1Eh
		mov	[bp+var_14], 1

loc_0_3A1D:				; CODE XREF: EndOfGameScores+1289j
					; EndOfGameScores+1290j
		cmp	[bp+var_16], 0
		jz	short loc_0_3A42
		cmp	[bp+var_6E], 2
		jnz	short loc_0_3A42
		mov	[bp+var_6E], 0
		call	SelectWndSprite
		push	cs
		call	near ptr MainTextResFont
		mov	[bp+var_92], 1
		mov	[bp+var_14], 1
		jmp	loc_0_3FDA
; ---------------------------------------------------------------------------

loc_0_3A42:				; CODE XREF: EndOfGameScores+8A9j
					; EndOfGameScores+8AFj
		cmp	[bp+var_16], 0
		jnz	short loc_0_3A4B
		jmp	loc_0_3F48
; ---------------------------------------------------------------------------

loc_0_3A4B:				; CODE XREF: EndOfGameScores+8CEj
		mov	byte ptr aOp01+3, 31h ;	'1'
		mov	ax, offset aOp01 ; "op01"
		push	ax
		push	[bp+var_1A]
		push	[bp+var_1C]
		call	LocateShape
		add	sp, 6
		mov	word ptr [bp+var_56], ax
		mov	word ptr [bp+var_56+2],	dx
		les	bx, [bp+var_56]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		mov	[bp+var_70], ax
		mov	ax, (offset g_pcData20Trak2+4Ah)
		sub	ax, [bp+var_70]
		mov	[bp+var_8C], ax
		mov	ax, 63h	; 'c'
		sub	ax, es:[bx+2]
		sar	ax, 1
		mov	[bp+var_90], ax
		push	word_2B77_5062
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, es:[bx+2]
		add	ax, 5
		push	ax
		mov	ax, [bp+var_70]
		add	ax, 5
		push	ax
		mov	ax, [bp+var_90]
		sub	ax, 3
		push	ax
		mov	ax, [bp+var_8C]
		sub	ax, 3
		push	ax
		call	DoImgResetRende
		add	sp, 0Eh
		mov	al, [bp+var_8E]
		cbw
		mov	bx, ax
		add	bx, [bp+var_5A]
		mov	es, [bp+var_58]
		mov	al, es:[bx]
		add	al, 30h	; '0'
		mov	byte ptr aOp01+3, al
		push	[bp+var_90]
		push	[bp+var_8C]
		mov	ax, offset aOp01 ; "op01"
		push	ax
		push	[bp+var_1A]
		push	[bp+var_1C]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_53C2
		add	sp, 8
		mov	al, [bp+var_8E]
		mov	[bp+var_6C], al
		sub	ax, ax
		push	ax
		push	ax
		call	SetTwoFontBytes
		add	sp, 4
		mov	[bp+var_70], 8
		mov	[bp+var_40], 0
		mov	[bp+var_50], 0
		mov	[bp+var_80], 0
		cmp	[bp+var_18], 2
		jnz	short loc_0_3B2C
		mov	[bp+var_7A], 1
		jmp	short loc_0_3B31
; ---------------------------------------------------------------------------
		align 2

loc_0_3B2C:				; CODE XREF: EndOfGameScores+9AAj
		mov	[bp+var_7A], 3

loc_0_3B31:				; CODE XREF: EndOfGameScores+9B1j
		sub	di, di
		jmp	loc_0_3CAF
; ---------------------------------------------------------------------------

loc_0_3B36:				; CODE XREF: EndOfGameScores+B42j
		cmp	[bp+var_18], 2
		jnz	short loc_0_3B42
		mov	ax, offset aD4a	; "d4a"
		jmp	short loc_0_3B57
; ---------------------------------------------------------------------------
		align 2

loc_0_3B42:				; CODE XREF: EndOfGameScores+9C2j
		mov	al, [bp+var_6A]
		mov	[bp+var_12], al
		mov	[bp+var_11], 31h ; '1'
		mov	al, byte ptr word_2B77_55D0

loc_0_3B4F:				; CODE XREF: EndOfGameScores+A65j
					; EndOfGameScores+A75j
		add	al, 61h	; 'a'
		mov	[bp+var_10], al
		lea	ax, [bp+var_12]

loc_0_3B57:				; CODE XREF: EndOfGameScores+9C7j
		push	ax
		push	[bp+var_66]
		push	[bp+var_68]
		call	LocateTextRes
		add	sp, 6
		mov	word ptr [bp+var_86], ax
		mov	word ptr [bp+var_86+2],	dx

loc_0_3B6E:				; CODE XREF: EndOfGameScores:loc_0_3CCDj
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4

loc_0_3B7E:				; CODE XREF: EndOfGameScores+B2Ej
		les	bx, [bp+var_86]
		inc	word ptr [bp+var_86]
		mov	al, es:[bx]
		mov	[bp+var_3E], al
		cmp	al, 20h	; ' '
		jz	short loc_0_3B97
		or	al, al
		jz	short loc_0_3B97
		jmp	loc_0_3C92
; ---------------------------------------------------------------------------

loc_0_3B97:				; CODE XREF: EndOfGameScores+A16j
					; EndOfGameScores+A1Aj
		mov	bx, [bp+var_80]
		add	bx, bp
		mov	byte ptr [bx-3Ch], 0
		lea	ax, [bp+var_3C]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_8A], ax
		add	ax, [bp+var_50]
		mov	cx, [bp+var_8C]
		sub	cx, 10h
		cmp	ax, cx
		jge	short loc_0_3C1A
		mov	ax, [bp+var_40]
		add	ax, [bp+var_80]
		cmp	ax, 50h	; 'P'
		jge	short loc_0_3C1A
		mov	[bp+var_5C], 0
		jmp	short loc_0_3BF3
; ---------------------------------------------------------------------------

loc_0_3BD0:				; CODE XREF: EndOfGameScores+B4Aj
		mov	al, [bp+var_6A]
		mov	[bp+var_12], al
		mov	[bp+var_11], 32h ; '2'
		mov	al, byte ptr word_2B77_55D2
		jmp	loc_0_3B4F
; ---------------------------------------------------------------------------

loc_0_3BE0:				; CODE XREF: EndOfGameScores+B52j
		mov	al, [bp+var_6A]
		mov	[bp+var_12], al
		mov	[bp+var_11], 33h ; '3'
		mov	al, byte ptr word_2B77_55D4
		jmp	loc_0_3B4F
; ---------------------------------------------------------------------------

loc_0_3BF0:				; CODE XREF: EndOfGameScores+A95j
		inc	[bp+var_5C]

loc_0_3BF3:				; CODE XREF: EndOfGameScores+A56j
		mov	ax, [bp+var_80]
		cmp	[bp+var_5C], ax
		jge	short loc_0_3C10
		mov	bx, [bp+var_5C]
		add	bx, bp
		mov	al, [bx-3Ch]
		mov	bx, [bp+var_40]
		inc	[bp+var_40]
		mov	[bx-538Ch], al
		jmp	short loc_0_3BF0
; ---------------------------------------------------------------------------
		align 2

loc_0_3C10:				; CODE XREF: EndOfGameScores+A81j
		mov	ax, [bp+var_8A]
		add	[bp+var_50], ax
		jmp	short loc_0_3C86
; ---------------------------------------------------------------------------
		align 2

loc_0_3C1A:				; CODE XREF: EndOfGameScores+A44j
					; EndOfGameScores+A4Fj
		mov	bx, [bp+var_40]
		mov	byte ptr [bx-538Ch], 0
		push	[bp+var_70]
		mov	ax, 8
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		add	[bp+var_70], 8
		cmp	[bp+var_3C], 20h ; ' '
		jnz	short loc_0_3C46
		mov	[bp+var_5C], 1
		jmp	short loc_0_3C4B
; ---------------------------------------------------------------------------

loc_0_3C46:				; CODE XREF: EndOfGameScores+AC5j
		mov	[bp+var_5C], 0

loc_0_3C4B:				; CODE XREF: EndOfGameScores+ACCj
		mov	[bp+var_40], 0
		jmp	short loc_0_3C67
; ---------------------------------------------------------------------------

loc_0_3C52:				; CODE XREF: EndOfGameScores+AF5j
		mov	bx, [bp+var_5C]
		add	bx, bp
		mov	al, [bx-3Ch]
		mov	bx, [bp+var_40]
		inc	[bp+var_40]
		mov	[bx-538Ch], al
		inc	[bp+var_5C]

loc_0_3C67:				; CODE XREF: EndOfGameScores+AD8j
		mov	ax, [bp+var_80]
		cmp	[bp+var_5C], ax
		jl	short loc_0_3C52
		mov	bx, [bp+var_40]
		mov	byte ptr [bx-538Ch], 0
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_50], ax

loc_0_3C86:				; CODE XREF: EndOfGameScores+A9Fj
		mov	[bp+var_80], 1
		mov	[bp+var_3C], 20h ; ' '
		jmp	short loc_0_3CA0
; ---------------------------------------------------------------------------
		align 2

loc_0_3C92:				; CODE XREF: EndOfGameScores+A1Cj
		mov	bx, [bp+var_80]
		inc	[bp+var_80]
		add	bx, bp
		mov	al, [bp+var_3E]
		mov	[bx-3Ch], al

loc_0_3CA0:				; CODE XREF: EndOfGameScores+B17j
		cmp	[bp+var_3E], 0
		jz	short loc_0_3CA9
		jmp	loc_0_3B7E
; ---------------------------------------------------------------------------

loc_0_3CA9:				; CODE XREF: EndOfGameScores+B2Cj
		call	SetFontDef
		inc	di

loc_0_3CAF:				; CODE XREF: EndOfGameScores+9BBj
		cmp	[bp+var_7A], di
		jle	short loc_0_3CD0
		mov	ax, di
		or	ax, ax
		jnz	short loc_0_3CBD
		jmp	loc_0_3B36
; ---------------------------------------------------------------------------

loc_0_3CBD:				; CODE XREF: EndOfGameScores+B40j
		cmp	ax, 1
		jnz	short loc_0_3CC5
		jmp	loc_0_3BD0
; ---------------------------------------------------------------------------

loc_0_3CC5:				; CODE XREF: EndOfGameScores+B48j
		cmp	ax, 2
		jnz	short loc_0_3CCD
		jmp	loc_0_3BE0
; ---------------------------------------------------------------------------

loc_0_3CCD:				; CODE XREF: EndOfGameScores+B50j
		jmp	loc_0_3B6E
; ---------------------------------------------------------------------------

loc_0_3CD0:				; CODE XREF: EndOfGameScores+B3Aj
		cmp	[bp+var_40], 0
		jz	short loc_0_3D06
		push	word ptr g_dwFontnRes+2
		push	word ptr g_dwFontnRes
		call	SetFontDefImpl
		add	sp, 4
		mov	bx, [bp+var_40]
		mov	byte ptr [bx-538Ch], 0
		push	[bp+var_70]
		mov	ax, 8
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		call	SetFontDef

loc_0_3D06:				; CODE XREF: EndOfGameScores+B5Cj
		mov	[bp+var_14], 0
		cmp	[bp+var_6E], 0
		jg	short loc_0_3D13
		jmp	loc_0_3FDA
; ---------------------------------------------------------------------------

loc_0_3D13:				; CODE XREF: EndOfGameScores+B96j
		mov	[bp+var_6E], 0
		mov	[bp+var_14], 1
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 15h
		push	ax
		mov	ax, 46h	; 'F'
		push	ax
		mov	ax, 0AFh ; '¯'
		push	ax
		mov	ax, 81h	; ''
		push	ax
		mov	ax, offset aBct	; "bct"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	al, [bp+var_52]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_52], 0FEh ; 'þ'
		call	ResetGameTime
		call	CheckForInput
		mov	[bp+var_70], 1
		call	SetSprite2As1_2

loc_0_3D83:				; CODE XREF: EndOfGameScores+D52j
		push	word_2B77_5060
		push	word_2B77_505E
		mov	ax, offset word_2B77_59A
		push	ax
		mov	ax, offset word_2B77_590
		push	ax
		mov	ax, offset unk_2B77_586
		push	ax
		mov	ax, offset unk_2B77_57C
		push	ax
		mov	ax, 4
		push	ax
		call	TimeAndMouse
		add	sp, 0Eh
		mov	[bp+var_72], ax
		add	[bp+var_42], ax
		cmp	[bp+var_42], 1Eh
		jl	short loc_0_3DD3
		sub	[bp+var_42], 1Eh
		inc	[bp+var_8E]
		mov	al, [bp+var_8E]
		cbw
		mov	bx, ax
		add	bx, [bp+var_5A]
		mov	es, [bp+var_58]
		cmp	byte ptr es:[bx], 0
		jnz	short loc_0_3DD3
		mov	[bp+var_8E], 0

loc_0_3DD3:				; CODE XREF: EndOfGameScores+C39j
					; EndOfGameScores+C54j
		mov	al, [bp+var_6C]
		cmp	[bp+var_8E], al
		jnz	short loc_0_3DDF
		jmp	loc_0_3EA5
; ---------------------------------------------------------------------------

loc_0_3DDF:				; CODE XREF: EndOfGameScores+C62j
		mov	al, [bp+var_8E]
		mov	[bp+var_6C], al
		cbw
		mov	bx, ax
		add	bx, [bp+var_5A]
		mov	es, [bp+var_58]
		mov	al, es:[bx]
		add	al, 30h	; '0'
		mov	byte ptr aOp01+3, al
		call	DoRenderMouSpr3
		mov	ax, offset aOp01 ; "op01"
		push	ax
		push	[bp+var_1A]
		push	[bp+var_1C]
		call	LocateShape
		add	sp, 6
		mov	word ptr [bp+var_56], ax
		mov	word ptr [bp+var_56+2],	dx
		cmp	g_wVideoFlag4, 0
		jz	short loc_0_3E8A
		push	word ptr [bp+var_46+2]
		push	word ptr [bp+var_46]
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		push	word ptr [bp+var_56+2]
		push	word ptr [bp+var_56]
		call	sub_1EA2_53C2
		add	sp, 8
		call	SetSprite2As1_2
		les	bx, [bp+var_56]
		mov	ax, es:[bx+2]
		add	ax, [bp+var_90]
		push	ax
		push	[bp+var_90]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		add	ax, [bp+var_8C]
		push	ax
		push	[bp+var_8C]
		call	SetSprite1Size
		add	sp, 8
		push	[bp+var_90]
		push	[bp+var_8C]
		les	bx, [bp+var_46]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	DoMaybePutImage
		add	sp, 8
		call	SetSprite2As1_2
		jmp	short loc_0_3EA0
; ---------------------------------------------------------------------------
		align 2

loc_0_3E8A:				; CODE XREF: EndOfGameScores+CA1j
		push	[bp+var_90]
		push	[bp+var_8C]
		push	word ptr [bp+var_56+2]
		push	word ptr [bp+var_56]
		call	sub_1EA2_53C2
		add	sp, 8

loc_0_3EA0:				; CODE XREF: EndOfGameScores+D0Fj
		call	DoUseMousePos

loc_0_3EA5:				; CODE XREF: EndOfGameScores+C64j
		push	di
		call	InputsChecking
		add	sp, 2
		mov	si, ax
		cmp	si, 0Dh
		jz	short loc_0_3EBF
		cmp	si, 20h	; ' '
		jz	short loc_0_3EBF
		cmp	si, 1Bh
		jnz	short loc_0_3EC4

loc_0_3EBF:				; CODE XREF: EndOfGameScores+D3Bj
					; EndOfGameScores+D40j
		mov	[bp+var_70], 0

loc_0_3EC4:				; CODE XREF: EndOfGameScores+D45j
		cmp	[bp+var_70], 0
		jz	short loc_0_3ECD
		jmp	loc_0_3D83
; ---------------------------------------------------------------------------

loc_0_3ECD:				; CODE XREF: EndOfGameScores+D50j
		call	SelectWndSprite
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		mov	ax, word_2B77_59A
		inc	ax
		push	ax
		push	word_2B77_590
		mov	ax, (offset g_pcData20Trak2+4Ah)
		push	ax
		mov	ax, 8
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	word_2B77_5088
		call	ClearSprite1Col
		add	sp, 2
		call	DoRenderMouSpr3
		mov	al, [bp+var_18]
		cbw
		push	ax
		mov	ax, offset aInh	; "inh"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		push	[bp+var_88]
		push	cs
		call	near ptr EnterHiscore
		add	sp, 8
		jmp	loc_0_3FDA
; ---------------------------------------------------------------------------

loc_0_3F48:				; CODE XREF: EndOfGameScores+8D0j
		cmp	[bp+var_6E], 0
		jle	short loc_0_3F84
		call	CheckForInput
		call	DoRenderMouSpr3
		sub	ax, ax
		push	ax
		mov	ax, offset aInh_0 ; "inh"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		push	[bp+var_88]
		push	cs
		call	near ptr EnterHiscore
		add	sp, 8
		mov	[bp+var_6E], 0
		mov	[bp+var_52], 0FEh ; 'þ'
		jmp	short loc_0_3FDA
; ---------------------------------------------------------------------------

loc_0_3F84:				; CODE XREF: EndOfGameScores+DD4j
		call	DoRenderMouSpr3
		cmp	[bp+var_6E], 0FFh
		jnz	short loc_0_3FD6
		mov	ax, offset aHna	; "hna"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 32h	; '2'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp
		add	sp, 0Ah
		jmp	short loc_0_3FDA
; ---------------------------------------------------------------------------
		align 2

loc_0_3FD6:				; CODE XREF: EndOfGameScores+E15j
		push	cs
		call	near ptr MainTextResFont

loc_0_3FDA:				; CODE XREF: EndOfGameScores+8C7j
					; EndOfGameScores+B98j	...
		mov	[bp+var_92], 1
		mov	[bp+var_78], 1
		call	ResetGameTime
		call	SelectWndSprite
		cmp	[bp+var_16], 0
		jz	short loc_0_3FF9
		cmp	[bp+var_6E], 0FFh
		jnz	short loc_0_4002

loc_0_3FF9:				; CODE XREF: EndOfGameScores+E79j
		mov	[bp+var_9C], 0FFDCh
		jmp	short loc_0_4058
; ---------------------------------------------------------------------------
		align 2

loc_0_4002:				; CODE XREF: EndOfGameScores+E7Fj
		mov	[bp+var_9C], 0
		cmp	[bp+var_14], 0
		jz	short loc_0_4014
		mov	ax, offset aBev	; "bev"
		jmp	short loc_0_4017
; ---------------------------------------------------------------------------
		align 2

loc_0_4014:				; CODE XREF: EndOfGameScores+E94j
		mov	ax, offset aBhi	; "bhi"

loc_0_4017:				; CODE XREF: EndOfGameScores+E99j
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		mov	[bp+var_7E], ax
		mov	[bp+var_7C], dx
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 15h
		push	ax
		mov	ax, 46h	; 'F'
		push	ax
		mov	ax, 0AFh ; '¯'
		push	ax
		mov	ax, word ptr unk_2B77_57C
		inc	ax
		push	ax
		push	dx
		push	[bp+var_7E]
		call	ImgResetText
		add	sp, 14h

loc_0_4058:				; CODE XREF: EndOfGameScores+E87j
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 15h
		push	ax
		mov	ax, 46h	; 'F'
		push	ax
		mov	ax, 0AFh ; '¯'
		push	ax
		mov	ax, [bp+var_9C]
		add	ax, word ptr unk_2B77_57E
		inc	ax
		push	ax
		mov	ax, offset aBrp	; "brp"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		cmp	[bp+var_16], 0
		jz	short loc_0_40A4
		mov	ax, offset aBra	; "bra"
		jmp	short loc_0_40A7
; ---------------------------------------------------------------------------

loc_0_40A4:				; CODE XREF: EndOfGameScores+F25j
		mov	ax, offset aBdr	; "bdr"

loc_0_40A7:				; CODE XREF: EndOfGameScores+F2Aj
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		mov	[bp+var_7E], ax
		mov	[bp+var_7C], dx
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 15h
		push	ax
		mov	ax, 46h	; 'F'
		push	ax
		mov	ax, 0AFh ; '¯'
		push	ax
		mov	ax, [bp+var_9C]
		add	ax, word ptr unk_2B77_580
		inc	ax
		push	ax
		push	dx
		push	[bp+var_7E]
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 15h
		push	ax
		mov	ax, 46h	; 'F'
		push	ax
		mov	ax, 0AFh ; '¯'
		push	ax
		mov	ax, [bp+var_9C]
		add	ax, word ptr unk_2B77_582
		inc	ax
		push	ax
		mov	ax, offset aBmm	; "bmm"
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	di, di

loc_0_4130:				; CODE XREF: EndOfGameScores+FEBj
		mov	ax, di
		shl	ax, 1
		mov	[bp+var_9E], ax
		mov	bx, ax
		mov	ax, [bx+57Ch]
		add	ax, [bp+var_9C]
		add	bx, bp
		mov	[bx-64h], ax
		mov	ax, di
		shl	ax, 1
		mov	[bp+var_9E], ax
		mov	bx, ax
		mov	ax, [bx+586h]
		add	ax, [bp+var_9C]
		add	bx, bp
		mov	[bx-9Ah], ax
		inc	di
		cmp	di, 4
		jl	short loc_0_4130
		call	CheckForInput
		mov	al, [bp+var_52]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_52], 0FEh ; 'þ'
		call	SetSprite2As1_2

loc_0_4188:				; CODE XREF: EndOfGameScores+122Ej
					; EndOfGameScores:loc_0_43C3j ...
		mov	al, [bp+var_78]
		cmp	[bp+var_92], al
		jz	short loc_0_41DC
		mov	al, [bp+var_92]
		mov	[bp+var_78], al
		call	SetSprite2As1_2
		mov	ax, word_2B77_59A
		inc	ax
		push	ax
		push	word_2B77_590
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		call	DoUseMousePos
		call	DoGetTimerDelta
		call	ResetGameTime

loc_0_41DC:				; CODE XREF: EndOfGameScores+1017j
		push	word_2B77_5060
		push	word_2B77_505E
		mov	ax, offset word_2B77_59A
		push	ax
		mov	ax, offset word_2B77_590
		push	ax
		lea	ax, [bp+var_9A]
		push	ax
		lea	ax, [bp+var_64]
		push	ax
		mov	al, [bp+var_92]
		cbw
		push	ax
		call	TimeAndMouse
		add	sp, 0Eh
		mov	[bp+var_72], ax
		cmp	[bp+var_14], 0
		jz	short loc_0_420F
		jmp	loc_0_4337
; ---------------------------------------------------------------------------

loc_0_420F:				; CODE XREF: EndOfGameScores+1092j
		cmp	[bp+var_18], 2
		jnz	short loc_0_4218
		jmp	loc_0_4337
; ---------------------------------------------------------------------------

loc_0_4218:				; CODE XREF: EndOfGameScores+109Bj
		add	[bp+var_42], ax
		cmp	[bp+var_42], 1Eh
		jl	short loc_0_4241
		sub	[bp+var_42], 1Eh
		inc	[bp+var_8E]
		mov	al, [bp+var_8E]
		cbw
		mov	bx, ax
		add	bx, [bp+var_5A]
		mov	es, [bp+var_58]
		cmp	byte ptr es:[bx], 0
		jnz	short loc_0_4241
		mov	[bp+var_8E], 0

loc_0_4241:				; CODE XREF: EndOfGameScores+10A7j
					; EndOfGameScores+10C2j
		mov	al, [bp+var_6C]
		cmp	[bp+var_8E], al
		jnz	short loc_0_424D
		jmp	loc_0_4337
; ---------------------------------------------------------------------------

loc_0_424D:				; CODE XREF: EndOfGameScores+10D0j
		mov	al, [bp+var_8E]
		mov	[bp+var_6C], al
		cbw
		mov	bx, ax
		add	bx, [bp+var_5A]
		mov	es, [bp+var_58]
		mov	al, es:[bx]
		add	al, 30h	; '0'
		mov	byte ptr aOp01+3, al
		call	DoRenderMouSpr3
		mov	ax, offset aOp01 ; "op01"
		push	ax
		push	[bp+var_1A]
		push	[bp+var_1C]
		call	LocateShape
		add	sp, 6
		mov	word ptr [bp+var_56], ax
		mov	word ptr [bp+var_56+2],	dx
		cmp	g_wVideoFlag4, 0
		jz	short loc_0_42F8
		push	word ptr [bp+var_46+2]
		push	word ptr [bp+var_46]
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		push	word ptr [bp+var_56+2]
		push	word ptr [bp+var_56]
		call	sub_1EA2_53C2
		add	sp, 8
		call	SetSprite2As1_2
		les	bx, [bp+var_56]
		mov	ax, es:[bx+2]
		add	ax, [bp+var_90]
		push	ax
		push	[bp+var_90]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		add	ax, [bp+var_8C]
		push	ax
		push	[bp+var_8C]
		call	SetSprite1Size
		add	sp, 8
		push	[bp+var_90]
		push	[bp+var_8C]
		les	bx, [bp+var_46]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	DoMaybePutImage
		add	sp, 8
		call	SetSprite2As1_2
		jmp	short loc_0_430E
; ---------------------------------------------------------------------------
		align 2

loc_0_42F8:				; CODE XREF: EndOfGameScores+110Fj
		push	[bp+var_90]
		push	[bp+var_8C]
		push	word ptr [bp+var_56+2]
		push	word ptr [bp+var_56]
		call	sub_1EA2_53C2
		add	sp, 8

loc_0_430E:				; CODE XREF: EndOfGameScores+117Dj
		push	[bp+var_90]
		push	[bp+var_8C]
		mov	ax, offset aOp01 ; "op01"
		push	ax
		push	[bp+var_1A]
		push	[bp+var_1C]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_53C2
		add	sp, 8
		call	DoUseMousePos

loc_0_4337:				; CODE XREF: EndOfGameScores+1094j
					; EndOfGameScores+109Dj ...
		cmp	[bp+var_16], 0
		jz	short loc_0_4343
		cmp	[bp+var_6E], 0FFh
		jnz	short loc_0_436C

loc_0_4343:				; CODE XREF: EndOfGameScores+11C3j
		mov	ax, offset unk_2B77_59C
		push	ax
		mov	ax, offset unk_2B77_592
		push	ax
		lea	ax, [bp+var_98]
		push	ax
		lea	ax, [bp+var_62]
		push	ax
		mov	ax, 3
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_82], al
		cmp	al, 0FFh
		jz	short loc_0_4395
		inc	al
		jmp	short loc_0_4391
; ---------------------------------------------------------------------------

loc_0_436C:				; CODE XREF: EndOfGameScores+11C9j
		mov	ax, offset word_2B77_59A
		push	ax
		mov	ax, offset word_2B77_590
		push	ax
		lea	ax, [bp+var_9A]
		push	ax
		lea	ax, [bp+var_64]
		push	ax
		mov	ax, 4
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_82], al
		cmp	al, 0FFh
		jz	short loc_0_4395

loc_0_4391:				; CODE XREF: EndOfGameScores+11F2j
		mov	[bp+var_92], al

loc_0_4395:				; CODE XREF: EndOfGameScores+11EEj
					; EndOfGameScores+1217j
		push	[bp+var_72]
		call	InputsChecking
		add	sp, 2
		mov	si, ax
		or	si, si
		jnz	short loc_0_43A9
		jmp	loc_0_4188
; ---------------------------------------------------------------------------

loc_0_43A9:				; CODE XREF: EndOfGameScores+122Cj
		cmp	ax, 0Dh
		jz	short loc_0_43C6
		cmp	ax, 20h	; ' '
		jz	short loc_0_43C6
		cmp	ax, 4B00h
		jnz	short loc_0_43BB
		jmp	loc_0_447A
; ---------------------------------------------------------------------------

loc_0_43BB:				; CODE XREF: EndOfGameScores+123Ej
		cmp	ax, 4D00h
		jnz	short loc_0_43C3
		jmp	loc_0_44A4
; ---------------------------------------------------------------------------

loc_0_43C3:				; CODE XREF: EndOfGameScores+1246j
		jmp	loc_0_4188
; ---------------------------------------------------------------------------

loc_0_43C6:				; CODE XREF: EndOfGameScores+1234j
					; EndOfGameScores+1239j
		cmp	[bp+var_92], 0
		jnz	short loc_0_440C
		call	SelectWndSprite
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	ax
		call	ImgResetText
		add	sp, 14h
		cmp	[bp+var_14], 0
		jz	short loc_0_4404
		mov	[bp+var_6E], 0
		jmp	loc_0_3A1D
; ---------------------------------------------------------------------------

loc_0_4404:				; CODE XREF: EndOfGameScores+1283j
		mov	[bp+var_6E], 2
		jmp	loc_0_3A1D
; ---------------------------------------------------------------------------
		align 2

loc_0_440C:				; CODE XREF: EndOfGameScores+1253j
		call	UnloadAudioReso
		cmp	[bp+var_16], 0
		jz	short loc_0_4425
		push	[bp+var_1A]
		push	[bp+var_1C]
		call	SetResField10To0
		add	sp, 4

loc_0_4425:				; CODE XREF: EndOfGameScores+129Dj
		cmp	g_wVideoFlag4, 0
		jz	short loc_0_443A
		push	word ptr [bp+var_46+2]
		push	word ptr [bp+var_46]
		call	ReleaseWindow
		add	sp, 4

loc_0_443A:				; CODE XREF: EndOfGameScores+12B2j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_0_445F
		push	[bp+var_66]
		push	[bp+var_68]
		call	DoUnloadResourc
		add	sp, 4

loc_0_445F:				; CODE XREF: EndOfGameScores+12D7j
		push	[bp+var_4C]
		push	[bp+var_4E]
		call	DoUnloadResourc
		add	sp, 4
		mov	al, [bp+var_92]
		cbw
		dec	ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_0_447A:				; CODE XREF: EndOfGameScores+1240j
		cmp	[bp+var_16], 0
		jz	short loc_0_4486
		cmp	[bp+var_6E], 0FFh
		jnz	short loc_0_4496

loc_0_4486:				; CODE XREF: EndOfGameScores+1306j
		cmp	[bp+var_92], 1
		jg	short loc_0_449D

loc_0_448D:				; CODE XREF: EndOfGameScores+1323j
		mov	[bp+var_92], 3
		jmp	loc_0_4188
; ---------------------------------------------------------------------------
		align 2

loc_0_4496:				; CODE XREF: EndOfGameScores+130Cj
		cmp	[bp+var_92], 0
		jz	short loc_0_448D

loc_0_449D:				; CODE XREF: EndOfGameScores+1313j
		dec	[bp+var_92]
		jmp	loc_0_4188
; ---------------------------------------------------------------------------

loc_0_44A4:				; CODE XREF: EndOfGameScores+1248j
		cmp	[bp+var_92], 3
		jge	short loc_0_44B2
		inc	[bp+var_92]
		jmp	loc_0_4188
; ---------------------------------------------------------------------------

loc_0_44B2:				; CODE XREF: EndOfGameScores+1331j
		cmp	[bp+var_16], 0
		jz	short loc_0_44BE
		cmp	[bp+var_6E], 0FFh
		jnz	short loc_0_44C6

loc_0_44BE:				; CODE XREF: EndOfGameScores+133Ej
		mov	[bp+var_92], 1
		jmp	loc_0_4188
; ---------------------------------------------------------------------------

loc_0_44C6:				; CODE XREF: EndOfGameScores+1344j
		mov	[bp+var_92], 0
		jmp	loc_0_4188
EndOfGameScores	endp

; ---------------------------------------------------------------------------
		pop	si

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SecurityCheck	proc far		; CODE XREF: _main+398p

var_440		= byte ptr -440h
var_43E		= byte ptr -43Eh
var_428		= word ptr -428h
var_426		= word ptr -426h
var_424		= word ptr -424h
var_422		= word ptr -422h
var_420		= word ptr -420h
var_41E		= word ptr -41Eh
var_41C		= word ptr -41Ch
var_41A		= word ptr -41Ah
var_40E		= word ptr -40Eh
wMiscHandle1	= word ptr -40Ch
wMiscHandle2	= word ptr -40Ah
var_408		= word ptr -408h
var_406		= byte ptr -406h
var_405		= byte ptr -405h
var_404		= byte ptr -404h
var_403		= byte ptr -403h
var_402		= byte ptr -402h
var_401		= byte ptr -401h
var_400		= byte ptr -400h
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 440h
		push	si
fetch text resource q00x and A00x from misc.pre. x is from arg0.
q00x is	the incomplete sentence	from the manual, A00x is the answer?
		mov	bx, [bp+arg_0]
		mov	al, byte ptr a0123456789abcd[bx] ; "0123456789abcdefghij"
		mov	byte ptr aQ00+2, al
		mov	al, byte ptr a0123456789abcd[bx] ; "0123456789abcdefghij"
		mov	byte ptr aA00+2, al
		mov	ax, offset aMisc_0 ; "misc"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+wMiscHandle1], ax
		mov	[bp+wMiscHandle2], dx
		mov	ax, offset aCop	; "cop"
		push	ax
		push	dx
		push	[bp+wMiscHandle1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		lea	ax, [bp+var_400]
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset aQ00	; "q00"
		push	ax
		push	[bp+wMiscHandle2]
		push	[bp+wMiscHandle1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset unk_2B77_AC7A
		push	ax
		lea	ax, [bp+var_400]
		push	ax
		call	_strcat
		add	sp, 4
		sub	si, si

loc_0_4551:				; CODE XREF: SecurityCheck+8Ej
		mov	al, [si-538Ch]
		mov	[bp+si+var_406], al
		inc	si
		cmp	si, 6
		jl	short loc_0_4551
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_428]
		push	ax
		push	g_wDialogArg1
		mov	ax, 78h	; 'x'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		lea	ax, [bp+var_400]
		push	ss
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 3
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	byte_2B77_AC76,	0
		mov	al, [bp+var_406]
		mov	g_pTempByte, al
		mov	al, [bp+var_405]
		mov	byte_2B77_AC75,	al
		push	[bp+var_426]
		push	[bp+var_428]
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	al, [bp+var_404]
		mov	g_pTempByte, al
		mov	al, [bp+var_403]
		mov	byte_2B77_AC75,	al
		push	[bp+var_422]
		push	[bp+var_424]
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	al, [bp+var_402]
		mov	g_pTempByte, al
		mov	al, [bp+var_401]
		mov	byte_2B77_AC75,	al
		push	[bp+var_41E]
		push	[bp+var_420]
		mov	ax, offset g_pTempByte
		push	ax
		call	FontTextOp
		add	sp, 6
		mov	ax, offset aA00	; "a00"
		push	ax
		push	[bp+wMiscHandle2]
		push	[bp+wMiscHandle1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, [bp+var_41C]
		mov	dx, [bp+var_41A]
		mov	[bp+var_428], ax
		mov	[bp+var_426], dx
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		mov	[bp+var_408], ax
		mov	[bp+var_43E], 0
		mov	[bp+var_40E], 0

loc_0_4641:				; CODE XREF: SecurityCheck+1F3j
		mov	ax, 7530h
		cwd
		push	dx
		push	ax
		push	[bp+var_426]
		push	[bp+var_428]
		push	[bp+var_408]
		lea	ax, [bp+var_43E]
		push	ax
		call	DoReadline
		add	sp, 0Ch
		sub	si, si
		jmp	short loc_0_468D
; ---------------------------------------------------------------------------

loc_0_4664:				; CODE XREF: SecurityCheck+1C3j
		mov	al, [bp+si+var_43E]
		cbw
		mov	bx, ax
		mov	al, [bx+382Fh]
		and	al, 1
		mov	[bp+var_440], al
		or	al, al
		jz	short loc_0_468C
		jz	short loc_0_4684
		mov	al, [bp+si+var_43E]
		add	al, 20h	; ' '
		jmp	short loc_0_4688
; ---------------------------------------------------------------------------
		nop

loc_0_4684:				; CODE XREF: SecurityCheck+1AAj
		mov	al, [bp+si+var_43E]

loc_0_4688:				; CODE XREF: SecurityCheck+1B2j
		mov	[bp+si+var_43E], al

loc_0_468C:				; CODE XREF: SecurityCheck+1A8j
		inc	si

loc_0_468D:				; CODE XREF: SecurityCheck+193j
		cmp	[bp+si+var_43E], 0
		jnz	short loc_0_4664
		mov	ax, offset g_pTempByte
		push	ax
		lea	ax, [bp+var_43E]
		push	ax
		call	_strcmp
		add	sp, 4
		or	ax, ax
		jnz	short loc_0_46B0
		mov	g_bPassedSecuri, 1
		jmp	short loc_0_46B4
; ---------------------------------------------------------------------------

loc_0_46B0:				; CODE XREF: SecurityCheck+1D8j
		inc	[bp+var_40E]

loc_0_46B4:				; CODE XREF: SecurityCheck+1DFj
		cmp	g_bPassedSecuri, 0
		jnz	short loc_0_46C5
		cmp	[bp+var_40E], 3
		jz	short loc_0_46C5
		jmp	loc_0_4641
; ---------------------------------------------------------------------------

loc_0_46C5:				; CODE XREF: SecurityCheck+1EAj
					; SecurityCheck+1F1j
		call	DoTrakdata12
		call	DoUseMousePos
		push	[bp+wMiscHandle2]
		push	[bp+wMiscHandle1]
		call	DoUnloadResourc
		add	sp, 4
		pop	si
		mov	sp, bp
		pop	bp
		retf
SecurityCheck	endp


; =============== S U B	R O U T	I N E =======================================


SetDefaultCar	proc far		; CODE XREF: _main+2AEp
		mov	byte ptr g_gameInfo.dwPlayerCarID, 'C'
		mov	byte ptr g_gameInfo.dwPlayerCarID+1, 'O'
		mov	byte ptr g_gameInfo.dwPlayerCarID+2, 'U'
		mov	byte ptr g_gameInfo.dwPlayerCarID+3, 'N'
		mov	g_gameInfo.cPlayerMaterial, 0
		mov	g_gameInfo.cOpponentType, 0
		mov	g_gameInfo.cOppMaterial, 0
		mov	g_gameInfo.cPlayerTransmission,	1
		mov	byte ptr g_gameInfo.dwOpponentID, 0FFh
		retf
SetDefaultCar	endp

seg000		ends

; ===========================================================================

; Segment type:	Pure code
seg001		segment	byte public 'CODE' use16
		assume cs:seg001
		;org 2
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

OpponentOp	proc far		; CODE XREF: UpdateGameState+D1p
					; DoOpponentOp+1p

wCar1Z		= word ptr -40h
wCar1Y		= word ptr -3Eh
vec2		= Vector3D ptr -3Ch
wCar2Z		= word ptr -36h
wCar1X		= word ptr -34h
var_32		= word ptr -32h
var_30		= word ptr -30h
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
wCar2Y		= word ptr -2Ah
wCar2X		= word ptr -28h
vecRot		= Vector3D ptr -26h
var_20		= byte ptr -20h
vec1		= Vector3D ptr -1Ch
matCar2Rot	= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= byte ptr -0Eh
vec3		= Vector3D ptr -0Ch
vec4		= Vector3D ptr -6

		push	bp
		mov	bp, sp
		sub	sp, 40h
		push	di
		push	si
		cmp	g_wFramesPerSec, 14h
		jnz	short loc_471_1E
		mov	[bp+var_14], 8
		mov	[bp+var_10], 1
		jmp	short loc_471_28
; ---------------------------------------------------------------------------
		nop

loc_471_1E:				; CODE XREF: OpponentOp+Dj
		mov	[bp+var_14], 10h
		mov	[bp+var_10], 2

loc_471_28:				; CODE XREF: OpponentOp+19j
		cmp	gameState.carOpponent.field_36,	0
		jnz	short loc_471_36
		cmp	gameState.cCvxFlag2, 2
		jnz	short loc_471_3C

loc_471_36:				; CODE XREF: OpponentOp+2Bj
		mov	[bp+var_20], 1
		jmp	short loc_471_40
; ---------------------------------------------------------------------------

loc_471_3C:				; CODE XREF: OpponentOp+32j
		mov	[bp+var_20], 0

loc_471_40:				; CODE XREF: OpponentOp+38j
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_49:				; CODE XREF: OpponentOp+4Dj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_49
		mov	[bp+wCar2X], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_5D:				; CODE XREF: OpponentOp+61j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_5D
		mov	[bp+wCar2Y], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_71:				; CODE XREF: OpponentOp+75j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_71
		mov	[bp+wCar2Z], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_85:				; CODE XREF: OpponentOp+89j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_85
		mov	[bp+wCar1X], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_99:				; CODE XREF: OpponentOp+9Dj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_99
		mov	[bp+wCar1Y], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_AD:				; CODE XREF: OpponentOp+B1j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_AD
		mov	[bp+wCar1Z], ax
		mov	gameState.carOpponent.field_CF,	0
		mov	gameState.field_45E, 0
		mov	ax, 1
		push	ax
		push	gameState.carOpponent.vecRotate.wX
		push	gameState.carOpponent.vecRotate.wY
		push	gameState.carOpponent.vecRotate.wZ
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+matCar2Rot], ax
		mov	gameState.carOpponent.field_CF,	1
		cmp	gameState.carOpponent.field_C9,	0
		jz	short loc_471_FC
		cmp	gameState.carOpponent.wTrackGrip2, 0
		jz	short loc_471_F3
		jmp	loc_471_462
; ---------------------------------------------------------------------------

loc_471_F3:				; CODE XREF: OpponentOp+ECj
		mov	gameState.carOpponent.field_CF,	0
		jmp	loc_471_462
; ---------------------------------------------------------------------------
		nop

loc_471_FC:				; CODE XREF: OpponentOp+E5j
		push	si
		lea	di, [bp+vec2]
		mov	si, offset gameState.carOpponent.vecUnk3
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		cmp	[bp+vec2.wY], 0FFFFh
		jz	short loc_471_138
		mov	ax, [bp+vec2.wX]
		sub	ax, [bp+wCar2X]
		mov	[bp+var_32], ax
		mov	ax, [bp+vec2.wY]
		sub	ax, [bp+wCar2Y]
		mov	[bp+var_30], ax
		mov	ax, [bp+vec2.wZ]
		sub	ax, [bp+wCar2Z]
		mov	[bp+var_2E], ax
		lea	ax, [bp+var_32]
		push	ax
		call	ZXCosSinX2
		add	sp, 2
		jmp	short loc_471_14E
; ---------------------------------------------------------------------------

loc_471_138:				; CODE XREF: OpponentOp+10Bj
		mov	ax, [bp+vec2.wZ]
		sub	ax, [bp+wCar2Z]
		push	ax
		mov	ax, [bp+vec2.wX]
		sub	ax, [bp+wCar2X]
		push	ax
		call	XZCosOrSin
		add	sp, 4

loc_471_14E:				; CODE XREF: OpponentOp+134j
		mov	si, ax
		cmp	si, 0C8h ; 'È'
		jge	short loc_471_1A3

loc_471_156:				; CODE XREF: OpponentOp+401j
		mov	ax, offset gameState.field_3F9
		push	ax
		mov	al, gameState.carOpponent.field_CE
		inc	gameState.carOpponent.field_CE
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carOpponent.vecUnk3
		push	ax
		mov	bx, gameState.carOpponent.wTrakdata3Index
		shl	bx, 1
		les	di, g_ppTrakdata3
		push	word ptr es:[bx+di]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		or	al, al
		jz	short loc_471_1A3
		inc	gameState.carOpponent.wTrakdata3Index
		mov	bx, gameState.carOpponent.wTrakdata3Index
		shl	bx, 1
		les	di, g_ppTrakdata3
		cmp	word ptr es:[bx+di], 0
		jnz	short loc_471_19E
		inc	gameState.carOpponent.field_CD
		mov	gameState.carOpponent.wTrakdata3Index, 0

loc_471_19E:				; CODE XREF: OpponentOp+190j
		mov	gameState.carOpponent.field_CE,	0

loc_471_1A3:				; CODE XREF: OpponentOp+152j
					; OpponentOp+17Cj
		cmp	gameState.cCvxFlag2, 2
		jnz	short loc_471_1DC

loc_471_1AA:				; CODE XREF: OpponentOp+20Cj
					; OpponentOp+222j ...
		push	si
		lea	di, [bp+vec3]
		mov	si, offset gameState.carOpponent.vecUnk3
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si

loc_471_1B7:				; CODE XREF: OpponentOp+2D6j
					; OpponentOp+2E0j ...
		push	si
		lea	di, [bp+vecRot]
		lea	si, [bp+vec3]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		mov	ax, [bp+wCar2X]
		sub	[bp+vecRot.wX],	ax
		cmp	[bp+vec3.wY], 0FFFFh
		jz	short loc_471_1D3
		jmp	loc_471_35E
; ---------------------------------------------------------------------------

loc_471_1D3:				; CODE XREF: OpponentOp+1CCj
		mov	[bp+vecRot.wY],	0
		jmp	loc_471_364
; ---------------------------------------------------------------------------
		nop

loc_471_1DC:				; CODE XREF: OpponentOp+1A6j
		mov	ax, [bp+wCar1X]
		sub	ax, [bp+wCar2X]
		mov	[bp+vecRot.wX],	ax
		mov	ax, [bp+wCar1Y]
		sub	ax, [bp+wCar2Y]
		mov	[bp+vecRot.wY],	ax
		mov	ax, [bp+wCar1Z]
		sub	ax, [bp+wCar2Z]
		mov	[bp+vecRot.wZ],	ax
		lea	ax, [bp+vec1]
		push	ax
		push	[bp+matCar2Rot]
		lea	ax, [bp+vecRot]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec1.wY], 5Ah ; 'Z'
		jg	short loc_471_1AA
		cmp	[bp+vec1.wX], 0
		jge	short loc_471_21E
		mov	ax, [bp+vec1.wX]
		neg	ax
		jmp	short loc_471_221
; ---------------------------------------------------------------------------
		nop

loc_471_21E:				; CODE XREF: OpponentOp+212j
		mov	ax, [bp+vec1.wX]

loc_471_221:				; CODE XREF: OpponentOp+219j
		cmp	ax, 0B4h ; '´'
		jg	short loc_471_1AA
		cmp	[bp+vec1.wZ], 258h
		jle	short loc_471_230
		jmp	loc_471_1AA
; ---------------------------------------------------------------------------

loc_471_230:				; CODE XREF: OpponentOp+229j
		cmp	[bp+vec1.wZ], 0FF4Ch
		jge	short loc_471_23A
		jmp	loc_471_1AA
; ---------------------------------------------------------------------------

loc_471_23A:				; CODE XREF: OpponentOp+233j
		mov	ax, [bp+wCar1X]
		sub	ax, gameState.carOpponent.vecUnk3.wX
		mov	[bp+vecRot.wX],	ax
		cmp	gameState.carOpponent.vecUnk3.wY, 0FFFFh
		jnz	short loc_471_252
		mov	[bp+vecRot.wY],	0
		jmp	short loc_471_25C
; ---------------------------------------------------------------------------

loc_471_252:				; CODE XREF: OpponentOp+247j
		mov	ax, [bp+wCar1Y]
		sub	ax, gameState.carOpponent.vecUnk3.wY
		mov	[bp+vecRot.wY],	ax

loc_471_25C:				; CODE XREF: OpponentOp+24Ej
		mov	ax, [bp+wCar1Z]
		sub	ax, gameState.carOpponent.vecUnk3.wZ
		mov	[bp+vecRot.wZ],	ax
		lea	ax, [bp+vec4]
		push	ax
		push	[bp+matCar2Rot]
		lea	ax, [bp+vecRot]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec4.wX], 0
		jge	short loc_471_2EE
		mov	ax, gameState.carOpponent.vecUnk5.wX
		cwd
		mov	cx, ax
		mov	ax, gameState.carOpponent.vecUnk3.wX
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	[bp+vec3.wX], ax
		cmp	gameState.carOpponent.vecUnk3.wY, 0FFFFh
		jnz	short loc_471_2A4
		mov	[bp+vec3.wY], 0FFFFh
		jmp	short loc_471_2BB
; ---------------------------------------------------------------------------

loc_471_2A4:				; CODE XREF: OpponentOp+299j
		mov	ax, gameState.carOpponent.vecUnk5.wY
		cwd
		mov	cx, ax
		mov	ax, gameState.carOpponent.vecUnk3.wY
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	[bp+vec3.wY], ax

loc_471_2BB:				; CODE XREF: OpponentOp+2A0j
		mov	ax, gameState.carOpponent.vecUnk5.wZ
		cwd
		mov	cx, ax
		mov	ax, gameState.carOpponent.vecUnk3.wZ
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	[bp+vec3.wZ], ax
		cmp	[bp+vec1.wZ], 0FFB2h
		jg	short loc_471_2DB
		jmp	loc_471_1B7
; ---------------------------------------------------------------------------

loc_471_2DB:				; CODE XREF: OpponentOp+2D4j
		cmp	gameState.carPlayer.field_C9, 0
		jz	short loc_471_2E5
		jmp	loc_471_1B7
; ---------------------------------------------------------------------------

loc_471_2E5:				; CODE XREF: OpponentOp+2DEj
		mov	gameState.field_45E, 2
		jmp	loc_471_1B7
; ---------------------------------------------------------------------------
		nop

loc_471_2EE:				; CODE XREF: OpponentOp+27Bj
		mov	ax, gameState.carOpponent.vecUnk4.wX
		cwd
		mov	cx, ax
		mov	ax, gameState.carOpponent.vecUnk3.wX
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	[bp+vec3.wX], ax
		cmp	gameState.carOpponent.vecUnk3.wY, 0FFFFh
		jnz	short loc_471_314
		mov	[bp+vec3.wY], 0FFFFh
		jmp	short loc_471_32B
; ---------------------------------------------------------------------------
		nop

loc_471_314:				; CODE XREF: OpponentOp+308j
		mov	ax, gameState.carOpponent.vecUnk4.wY
		cwd
		mov	cx, ax
		mov	ax, gameState.carOpponent.vecUnk3.wY
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	[bp+vec3.wY], ax

loc_471_32B:				; CODE XREF: OpponentOp+30Fj
		mov	ax, gameState.carOpponent.vecUnk4.wZ
		cwd
		mov	cx, ax
		mov	ax, gameState.carOpponent.vecUnk3.wZ
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	[bp+vec3.wZ], ax
		cmp	[bp+vec1.wZ], 0FFB2h
		jg	short loc_471_34B
		jmp	loc_471_1B7
; ---------------------------------------------------------------------------

loc_471_34B:				; CODE XREF: OpponentOp+344j
		cmp	gameState.carPlayer.field_C9, 0
		jz	short loc_471_355
		jmp	loc_471_1B7
; ---------------------------------------------------------------------------

loc_471_355:				; CODE XREF: OpponentOp+34Ej
		mov	gameState.field_45E, 1
		jmp	loc_471_1B7
; ---------------------------------------------------------------------------
		nop

loc_471_35E:				; CODE XREF: OpponentOp+1CEj
		mov	ax, [bp+wCar2Y]
		sub	[bp+vecRot.wY],	ax

loc_471_364:				; CODE XREF: OpponentOp+1D6j
		mov	ax, [bp+wCar2Z]
		sub	[bp+vecRot.wZ],	ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+matCar2Rot]
		lea	ax, [bp+vecRot]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	[bp+vec2.wZ]
		push	[bp+vec2.wX]
		call	GetAngleFromXZ
		add	sp, 4
		mov	[bp+var_2C], ax
		cmp	gameState.carOpponent.field_C7,	0
		jnz	short loc_471_3F3
		or	ax, ax
		jge	short loc_471_39E
		neg	ax
		jmp	short loc_471_3A1
; ---------------------------------------------------------------------------
		nop

loc_471_39E:				; CODE XREF: OpponentOp+395j
		mov	ax, [bp+var_2C]

loc_471_3A1:				; CODE XREF: OpponentOp+399j
		cmp	ax, 100h
		jle	short loc_471_3F3
		mov	ax, offset gameState.field_3F9
		push	ax
		mov	al, gameState.carOpponent.field_CE
		inc	gameState.carOpponent.field_CE
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carOpponent.vecUnk3
		push	ax
		mov	bx, gameState.carOpponent.wTrakdata3Index
		shl	bx, 1
		les	di, g_ppTrakdata3
		push	word ptr es:[bx+di]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		or	al, al
		jz	short loc_471_3F3
		inc	gameState.carOpponent.wTrakdata3Index
		mov	bx, gameState.carOpponent.wTrakdata3Index
		shl	bx, 1
		les	di, g_ppTrakdata3
		cmp	word ptr es:[bx+di], 0
		jnz	short loc_471_3EE
		inc	gameState.carOpponent.field_CD
		mov	gameState.carOpponent.wTrakdata3Index, 0

loc_471_3EE:				; CODE XREF: OpponentOp+3E0j
		mov	gameState.carOpponent.field_CE,	0

loc_471_3F3:				; CODE XREF: OpponentOp+391j
					; OpponentOp+3A2j ...
		cmp	[bp+var_2C], 41h ; 'A'
		jle	short loc_471_40E
		cmp	[bp+var_20], 0
		jnz	short loc_471_406

loc_471_3FF:				; CODE XREF: OpponentOp+416j
		mov	[bp+var_20], 1
		jmp	loc_471_156
; ---------------------------------------------------------------------------

loc_471_406:				; CODE XREF: OpponentOp+3FBj
		mov	[bp+var_2C], 41h ; 'A'
		jmp	short loc_471_41F
; ---------------------------------------------------------------------------
		nop

loc_471_40E:				; CODE XREF: OpponentOp+3F5j
		cmp	[bp+var_2C], 0FFBFh
		jge	short loc_471_41F
		cmp	[bp+var_20], 0
		jz	short loc_471_3FF
		mov	[bp+var_2C], 0FFBFh

loc_471_41F:				; CODE XREF: OpponentOp+409j
					; OpponentOp+410j
		cmp	gameState.carOpponent.field_BF,	0
		jnz	short loc_471_42B
		mov	[bp+var_2C], 0

loc_471_42B:				; CODE XREF: OpponentOp+422j
		mov	si, [bp+var_2C]
		sub	si, gameState.carOpponent.field_20
		jns	short loc_471_43A
		mov	ax, si
		neg	ax
		jmp	short loc_471_43C
; ---------------------------------------------------------------------------

loc_471_43A:				; CODE XREF: OpponentOp+430j
		mov	ax, si

loc_471_43C:				; CODE XREF: OpponentOp+436j
		cmp	ax, [bp+var_14]
		jle	short loc_471_45C
		mov	ax, gameState.carOpponent.field_20
		cmp	[bp+var_2C], ax
		jge	short loc_471_452
		mov	ax, [bp+var_14]
		sub	gameState.carOpponent.field_20,	ax
		jmp	short loc_471_462
; ---------------------------------------------------------------------------

loc_471_452:				; CODE XREF: OpponentOp+445j
		mov	ax, [bp+var_14]
		add	gameState.carOpponent.field_20,	ax
		jmp	short loc_471_462
; ---------------------------------------------------------------------------
		nop

loc_471_45C:				; CODE XREF: OpponentOp+43Dj
		mov	ax, [bp+var_2C]
		mov	gameState.carOpponent.field_20,	ax

loc_471_462:				; CODE XREF: OpponentOp+EEj
					; OpponentOp+F6j ...
		mov	[bp+var_E], 0
		cmp	gameState.carOpponent.field_C0,	0
		jz	short loc_471_4EA
		cmp	gameState.carOpponent.field_C9,	0
		jnz	short loc_471_4E6
		cmp	gameState.carOpponent.field_36,	0
		jz	short loc_471_4A6
		mov	ax, [bp+var_10]
		mov	cl, 9
		shl	ax, cl
		cmp	ax, gameState.carOpponent.wTrackGrip2
		jbe	short loc_471_498
		mov	gameState.carOpponent.wTrackGrip2, 0
		mov	gameState.carOpponent.field_36,	0
		jmp	short loc_471_4EA
; ---------------------------------------------------------------------------
		nop
		nop

loc_471_498:				; CODE XREF: OpponentOp+484j
		mov	ax, [bp+var_10]
		mov	cl, 9
		shl	ax, cl
		sub	gameState.carOpponent.wTrackGrip2, ax
		jmp	short loc_471_4EA
; ---------------------------------------------------------------------------
		nop

loc_471_4A6:				; CODE XREF: OpponentOp+477j
		mov	ax, gameState.carOpponent.wSurfaceGripSum
		cmp	gameState.carOpponent.field_44,	ax
		jg	short loc_471_4E6
		cmp	gameState.cCvxFlag2, 2
		jnz	short loc_471_4BE
		mov	[bp+var_12], 4000h
		jmp	short loc_471_4C7
; ---------------------------------------------------------------------------
		nop

loc_471_4BE:				; CODE XREF: OpponentOp+4B2j
		mov	ah, gameState.field_3F9
		sub	al, al
		mov	[bp+var_12], ax

loc_471_4C7:				; CODE XREF: OpponentOp+4B9j
		mov	ax, [bp+var_12]
		sub	ax, 100h
		cmp	ax, gameState.carOpponent.wTrackGrip
		jbe	short loc_471_4DA
		mov	[bp+var_E], 1
		jmp	short loc_471_4EA
; ---------------------------------------------------------------------------
		nop

loc_471_4DA:				; CODE XREF: OpponentOp+4CFj
		mov	ax, [bp+var_12]
		add	ah, 3
		cmp	ax, gameState.carOpponent.wTrackGrip
		jnb	short loc_471_4EA

loc_471_4E6:				; CODE XREF: OpponentOp+470j
					; OpponentOp+4ABj
		mov	[bp+var_E], 2

loc_471_4EA:				; CODE XREF: OpponentOp+469j
					; OpponentOp+492j ...
		mov	ax, offset g_pCarInfoSimd2
		push	ax
		mov	ax, offset gameState.carOpponent
		push	ax
		mov	ax, 1
		push	ax
		mov	al, [bp+var_E]
		cbw
		push	ax
		push	cs
		call	near ptr UpdateCarState
		add	sp, 8
		sub	ax, ax
		push	ax
		mov	ax, offset g_pCarInfoSimd2
		push	ax
		mov	ax, offset gameState.carOpponent
		push	ax
		push	cs
		call	near ptr CvxOpSimdTrack
		add	sp, 6
		mov	ax, 1
		push	ax
		mov	ax, offset g_dwCopyOfSimd
		push	ax
		mov	ax, offset gameState.carPlayer
		push	ax
		mov	ax, offset g_pCarInfoSimd2
		push	ax
		mov	ax, offset gameState.carOpponent
		push	ax
		push	cs
		call	near ptr TrkPlanSimd
		add	sp, 0Ah
		cmp	gameState.carOpponent.field_C9,	0
		jz	short loc_471_539
		jmp	loc_471_5C7
; ---------------------------------------------------------------------------

loc_471_539:				; CODE XREF: OpponentOp+532j
		push	si
		lea	di, [bp+vecRot]
		mov	si, offset gameState.carOpponent.vecUnk3
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_54F:				; CODE XREF: OpponentOp+553j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_54F
		sub	[bp+vecRot.wX],	ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_563:				; CODE XREF: OpponentOp+567j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_563
		sub	[bp+vecRot.wY],	ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_577:				; CODE XREF: OpponentOp+57Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_577
		sub	[bp+vecRot.wZ],	ax
		mov	ax, 1
		push	ax
		push	gameState.carOpponent.vecRotate.wX
		push	gameState.carOpponent.vecRotate.wY
		push	gameState.carOpponent.vecRotate.wZ
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+matCar2Rot], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+matCar2Rot]
		lea	ax, [bp+vecRot]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	[bp+vec2.wZ]
		mov	ax, [bp+vec2.wX]
		neg	ax
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		and	ah, 3
		mov	gameState.carOpponent.field_48,	ax

loc_471_5C7:				; CODE XREF: OpponentOp+534j
		cmp	gameState.carOpponent.field_CD,	0
		jnz	short loc_471_5D1
		jmp	loc_471_656
; ---------------------------------------------------------------------------

loc_471_5D1:				; CODE XREF: OpponentOp+5CAj
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		mov	cx, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	bx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	dx, cx
		mov	cl, 6

loc_471_5E9:				; CODE XREF: OpponentOp+5EDj
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_5E9
		sub	ax, dx
		push	ax
		push	g_wUseTrkInRpl
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	si, ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		mov	cx, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	bx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	dx, cx
		mov	cl, 6

loc_471_623:				; CODE XREF: OpponentOp+627j
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_623
		sub	ax, dx
		push	ax
		push	g_wUseTrkInRpl
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	si, ax
		jns	short loc_471_656
		mov	ax, 1
		push	ax
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_656:				; CODE XREF: OpponentOp+5CCj
					; OpponentOp+643j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
OpponentOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatMultiplyVector2 proc	far		; CODE XREF: TrkPlanSimd+F0Bp
					; PlaneRotateOp+103p

pMatrix		= Matrix ptr -12h
p_pOutVec	= word ptr  6
p_pMatrix	= dword	ptr  8
p_pInVec	= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 12h
		push	di
		push	si
		mov	ax, word ptr [bp+p_pMatrix]
		mov	dx, word ptr [bp+p_pMatrix+2]
		lea	di, [bp+pMatrix]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		mov	cx, 9
		repne movsw		; dx:ax	-> matrix on the stack
		pop	ds
		push	[bp+p_pInVec]
		lea	ax, [bp+pMatrix]
		push	ax
		push	[bp+p_pOutVec]
		call	MatMultiplyVector
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
MatMultiplyVector2 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TrkPlanSimd	proc far		; CODE XREF: OpponentOp+527p
					; PlayerOp+ABp

vec3		= Vector3D ptr -1E4h
var_1DE		= Vector3D ptr -1DEh
vec4		= Vector3D ptr -1C6h
vecLong		= VectorLong3D ptr -1C0h
var_1B4		= word ptr -1B4h
var_1B2		= word ptr -1B2h
var_1B0		= word ptr -1B0h
var_1AE		= word ptr -1AEh
var_1AC		= word ptr -1ACh
var_1AA		= word ptr -1AAh
var_1A8		= word ptr -1A8h
var_1A6		= word ptr -1A6h
var_1A4		= word ptr -1A4h
var_1A2		= word ptr -1A2h
var_1A0		= word ptr -1A0h
var_19E		= word ptr -19Eh
var_19C		= word ptr -19Ch
var_19A		= word ptr -19Ah
var_198		= word ptr -198h
var_196		= word ptr -196h
var_194		= word ptr -194h
var_192		= word ptr -192h
var_190		= word ptr -190h
vec7		= Vector3D ptr -18Eh
vec8		= Vector3D ptr -188h
vec2		= Vector3D ptr -182h
vec6		= Vector3D ptr -17Ch
vecLong2	= VectorLong3D ptr -176h
wCurVecLong2	= word ptr -146h
var_144		= word ptr -144h
var_142		= word ptr -142h
wAngleOrCode	= word ptr -140h
wPlaneOrignOpResult= word ptr -138h
var_136		= byte ptr -136h
mat		= Matrix ptr -134h
vec		= Vector3D ptr -122h
var_11C		= byte ptr -11Ch
vec9		= Vector3D ptr -11Ah
vecAngles	= Vector3D ptr -114h
mat2		= Matrix ptr -10Eh
vec1		= Vector3D ptr -0FCh
wAngleZ		= word ptr -0F4h
wAngleX		= word ptr -0F2h
var_F0		= word ptr -0F0h
wAngle		= word ptr -0EEh
var_EC		= byte ptr -0ECh
pMatrix3	= word ptr -0EAh
cCounter	= byte ptr -0E8h
wZ		= word ptr -0E6h
vec5		= Vector3D ptr -0E4h
pCurVecLong	= word ptr -0DEh
vecs		= Vector3D ptr -0DCh
vecCopy		= Vector3D ptr -1Ch
var_16		= word ptr -16h
wCurPlanIndex	= word ptr -0Eh
vecCopy2	= Vector3D ptr -0Ch
pPlane		= dword	ptr -6
var_2		= byte ptr -2
p_pCvx2		= word ptr  6
p_pSimd2	= word ptr  8		; a simd
p_pCvx		= word ptr  0Ah
p_pSimd		= word ptr  0Ch		; a simd
arg_8		= byte ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 1E4h
		push	di
		push	si
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwX]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwX+2)]
		mov	word ptr g_dwXCounter, ax
		mov	word ptr g_dwXCounter+2, dx
		mov	word ptr [bx+CarState.vecLongUnk2.dwX],	ax
		mov	word ptr [bx+(CarState.vecLongUnk2.dwX+2)], dx
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwY]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwY+2)]
		mov	word ptr g_dwYCounter, ax
		mov	word ptr g_dwYCounter+2, dx
		mov	word ptr [bx+CarState.vecLongUnk2.dwY],	ax
		mov	word ptr [bx+(CarState.vecLongUnk2.dwY+2)], dx
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwZ]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwZ+2)]
		mov	word ptr g_dwZCounter, ax
		mov	word ptr g_dwZCounter+2, dx
		mov	word ptr [bx+CarState.vecLongUnk2.dwZ],	ax
		mov	word ptr [bx+(CarState.vecLongUnk2.dwZ+2)], dx
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.vecRotate.wZ]
		mov	g_wSomeAngle, ax
		mov	g_wSomeAngleYZ,	ax
		mov	ax, [bx+CarState.vecRotate.wY]
		mov	g_wTrkPlanAngle, ax
		mov	g_wSomeAngleXY,	ax
		mov	ax, [bx+CarState.vecRotate.wX]
		mov	g_wPoly2Code, ax
		mov	word_2B77_97D6,	ax
		cmp	[bx+CarState.field_C1],	0
		jz	short loc_471_70E
		mov	ax, [bx+CarState.field_40]
		sar	ax, 1
		sar	ax, 1
		mov	[bp+var_142], ax
		jmp	short loc_471_714
; ---------------------------------------------------------------------------

loc_471_70E:				; CODE XREF: TrkPlanSimd+6Dj
		mov	[bp+var_142], 0

loc_471_714:				; CODE XREF: TrkPlanSimd+7Aj
		cmp	g_wFramesPerSec, 0Ah
		jnz	short loc_471_720
		mov	ax, 1E00h
		jmp	short loc_471_723
; ---------------------------------------------------------------------------

loc_471_720:				; CODE XREF: TrkPlanSimd+87j
		mov	ax, 3C00h

loc_471_723:				; CODE XREF: TrkPlanSimd+8Cj
		sub	dx, dx
		push	dx
		push	ax
		mov	ax, 580h
		cwd
		push	dx
		push	ax
		mov	bx, [bp+p_pCvx2]
		sub	ax, ax
		push	ax
		push	[bx+CarState.wTrackGrip2]
		call	__aFlmul
		push	dx
		push	ax
		call	__aFuldiv
		mov	[bp+wZ], ax
		sub	ax, ax
		push	ax
		mov	ax, g_wPoly2Code
		neg	ax
		push	ax
		mov	ax, g_wTrkPlanAngle
		neg	ax
		push	ax
		mov	ax, g_wSomeAngle
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		push	si
		mov	di, offset g_mat3
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		mov	cx, 9
		repne movsw
		pop	si
		cmp	g_wTrkPlanAngle, 0
		jnz	short loc_471_77F
		cmp	g_wSomeAngle, 0
		jz	short loc_471_7B6

loc_471_77F:				; CODE XREF: TrkPlanSimd+E4j
		mov	[bp+vec4.wX], 0
		mov	[bp+vec4.wY], 0
		mov	[bp+vec4.wZ], 82h ; '‚'
		lea	ax, [bp+vec1]
		push	ax
		mov	ax, offset g_mat3
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bp+vec1.wY]
		neg	ax
		mov	[bx+CarState.field_1E],	ax
		jmp	short loc_471_7BE
; ---------------------------------------------------------------------------
		nop

loc_471_7B6:				; CODE XREF: TrkPlanSimd+EBj
		mov	bx, [bp+p_pCvx2]
		mov	[bx+CarState.field_1E],	0

loc_471_7BE:				; CODE XREF: TrkPlanSimd+121j
		mov	bx, [bp+p_pCvx2]
		test	[bx+CarState.wAngleZ], 3FFh
		jz	short loc_471_7F4
		mov	[bp+var_EC], 1
		sub	ax, ax
		push	ax
		mov	ax, [bx+CarState.wAngleZ]
		neg	ax
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		push	si
		lea	di, [bp+mat2]
		mov	si, ax
		push	ss
		pop	es
		assume es:nothing
		mov	cx, 9
		repne movsw
		pop	si
		jmp	short loc_471_7F9
; ---------------------------------------------------------------------------
		nop

loc_471_7F4:				; CODE XREF: TrkPlanSimd+134j
		mov	[bp+var_EC], 0

loc_471_7F9:				; CODE XREF: TrkPlanSimd+15Fj
		mov	[bp+vec4.wX], 0
		mov	[bp+vec4.wY], 7530h
		mov	[bp+vec4.wZ], 0
		lea	ax, [bp+vec1]
		push	ax
		mov	ax, offset g_mat3
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+CarState.field_C1],	0
		jz	short loc_471_866
		cmp	[bp+vec1.wY], 0
		jge	short loc_471_866
		cmp	[bx+CarState.wTrackGrip2], 1E00h
		jbe	short loc_471_85E
		mov	[bp+var_F0], 0C0h ; 'À'
		mov	[bp+vec4.wY], 0FF40h
		lea	ax, [bp+vec5]
		push	ax
		mov	ax, offset g_mat3
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		jmp	short loc_471_86C
; ---------------------------------------------------------------------------
		nop

loc_471_85E:				; CODE XREF: TrkPlanSimd+1A5j
		mov	[bp+var_F0], 0FF40h
		jmp	short loc_471_86C
; ---------------------------------------------------------------------------

loc_471_866:				; CODE XREF: TrkPlanSimd+197j
					; TrkPlanSimd+19Ej
		mov	[bp+var_F0], 0

loc_471_86C:				; CODE XREF: TrkPlanSimd+1C9j
					; TrkPlanSimd+1D2j
		mov	vec_2B77_97C6.wX, 0
		mov	vec_2B77_97C6.wY, 0
		mov	g_wSomePlanIndex, 0FFFFh
		lea	ax, [bp+vecLong] ; what	is var_1c0, maybe a longword-vector?
		mov	[bp+pCurVecLong], ax ; var_de points to	it
		lea	ax, [bp+vecLong2]
		mov	[bp+wCurVecLong2], ax
		mov	[bp+cCounter], 0
		jmp	short loc_471_8EA
; ---------------------------------------------------------------------------
		nop

loc_471_896:				; CODE XREF: TrkPlanSimd+381j
					; TrkPlanSimd+38Bj
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.field_36]

loc_471_89C:				; CODE XREF: TrkPlanSimd+398j
		mov	g_wSomePi3Code,	ax
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	ax, g_wSomePi3Code
		mov	[bp+di+wAngleOrCode], ax
		push	cs
		call	near ptr PlaneRotateOp
		mov	ax, g_vecPlaneRotOpResul.wX
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwX],	ax
		adc	word ptr [bx+(VectorLong3D.dwX+2)], dx ; write z as 32-bit
		mov	ax, g_vecPlaneRotOpResul.wY
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwY],	ax
		adc	word ptr [bx+(VectorLong3D.dwY+2)], dx ; write y as 32-bit
		mov	ax, g_vecPlaneRotOpResul.wZ
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwZ],	ax
		adc	word ptr [bx+(VectorLong3D.dwZ+2)], dx ; write z as 32 bit

loc_471_8DC:				; CODE XREF: TrkPlanSimd+370j
		add	[bp+pCurVecLong], 0Ch ;	var_de points to var_1c0, each unit is 0xc long	(12 bytes) (the	loop goes to 4 .. = 48 bytes?)
		add	[bp+wCurVecLong2], 0Ch
		inc	[bp+cCounter]

loc_471_8EA:				; CODE XREF: TrkPlanSimd+201j
		cmp	[bp+cCounter], 4
		jl	short loc_471_8F4
		jmp	loc_471_A2E
; ---------------------------------------------------------------------------

loc_471_8F4:				; CODE XREF: TrkPlanSimd+25Dj
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, ax
		shl	di, 1
		mov	bx, [bp+p_pSimd2]
		push	si
		lea	si, [bx+di+CarInfoSimd.vecWheelCoords]
		lea	di, [bp+vec4]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+di+CarState.rc2.dwLeft]
		add	ax, 180h
		neg	ax
		mov	[bp+vec4.wY], ax
		cmp	[bp+var_F0], 0
		jge	short loc_471_93A
		mov	ax, [bp+var_F0]
		sub	[bp+vec4.wY], ax

loc_471_93A:				; CODE XREF: TrkPlanSimd+29Ej
		cmp	[bp+var_EC], 0
		jz	short loc_471_967
		lea	ax, [bp+vec1]
		push	ax
		lea	ax, [bp+mat2]
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	si
		lea	di, [bp+vec4]
		lea	si, [bp+vec1]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si

loc_471_967:				; CODE XREF: TrkPlanSimd+2ADj
		lea	ax, [bp+vec1]
		push	ax
		mov	ax, offset g_mat3
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec1.wX]
		cwd
		add	ax, word ptr g_dwXCounter
		adc	dx, word ptr g_dwXCounter+2
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwX],	ax
		mov	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	ax, [bp+vec1.wY]
		cwd
		add	ax, word ptr g_dwYCounter
		adc	dx, word ptr g_dwYCounter+2
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwY],	ax
		mov	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	ax, [bp+vec1.wZ]
		cwd
		add	ax, word ptr g_dwZCounter
		adc	dx, word ptr g_dwZCounter+2
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwZ],	ax
		mov	word ptr [bx+(VectorLong3D.dwZ+2)], dx
		mov	bx, [bp+wCurVecLong2]
		mov	di, [bp+pCurVecLong]
		mov	ax, word ptr [di+VectorLong3D.dwX]
		mov	dx, word ptr [di+(VectorLong3D.dwX+2)]
		mov	word ptr [bx+VectorLong3D.dwX],	ax
		mov	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	bx, [bp+wCurVecLong2]
		mov	di, [bp+pCurVecLong]
		mov	ax, word ptr [di+VectorLong3D.dwY]
		mov	dx, word ptr [di+(VectorLong3D.dwY+2)]
		mov	word ptr [bx+VectorLong3D.dwY],	ax
		mov	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	bx, [bp+wCurVecLong2]
		mov	di, [bp+pCurVecLong]
		mov	ax, word ptr [di+VectorLong3D.dwZ]
		mov	dx, word ptr [di+(VectorLong3D.dwZ+2)]
		mov	word ptr [bx+VectorLong3D.dwZ],	ax
		mov	word ptr [bx+(VectorLong3D.dwZ+2)], dx
		cmp	[bp+wZ], 0
		jnz	short loc_471_A05
		jmp	loc_471_8DC
; ---------------------------------------------------------------------------

loc_471_A05:				; CODE XREF: TrkPlanSimd+36Ej
		mov	ax, [bp+wZ]
		mov	vec_2B77_97C6.wZ, ax
		cmp	[bp+var_142], 0
		jnz	short loc_471_A16
		jmp	loc_471_896
; ---------------------------------------------------------------------------

loc_471_A16:				; CODE XREF: TrkPlanSimd+37Fj
		cmp	[bp+cCounter], 2
		jl	short loc_471_A20
		jmp	loc_471_896
; ---------------------------------------------------------------------------

loc_471_A20:				; CODE XREF: TrkPlanSimd+389j
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.field_36]
		sub	ax, [bp+var_142]
		jmp	loc_471_89C
; ---------------------------------------------------------------------------
		nop

loc_471_A2E:				; CODE XREF: TrkPlanSimd+25Fj
		mov	[bp+var_2], 0

loc_471_A32:				; CODE XREF: TrkPlanSimd+7FCj
		inc	[bp+var_2]
		cmp	[bp+var_2], 5
		jnz	short loc_471_A92
		mov	bx, [bp+p_pCvx2]
		mov	[bx+CarState.field_36],	200h
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_A53:				; CODE XREF: TrkPlanSimd+F9Ej
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+CarState.cSurfaceGripIndex1], 5
		jnz	short loc_471_A82
		cmp	[bx+CarState.cSurfaceGripIndex2], 5
		jnz	short loc_471_A82
		cmp	[bx+CarState.cSurfaceGripIndex3], 5
		jnz	short loc_471_A82
		cmp	[bx+CarState.cSurfaceGripIndex4], 5
		jnz	short loc_471_A82
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_A82:				; CODE XREF: TrkPlanSimd+3C9j
					; TrkPlanSimd+3D0j ...
		lea	ax, [bp+vecLong]
		mov	[bp+pCurVecLong], ax
		mov	[bp+cCounter], 0
		jmp	loc_471_16C1
; ---------------------------------------------------------------------------

loc_471_A92:				; CODE XREF: TrkPlanSimd+3A7j
		lea	ax, [bp+vecLong]
		mov	[bp+pCurVecLong], ax
		lea	ax, [bp+vecLong2]
		mov	[bp+wCurVecLong2], ax
		mov	[bp+cCounter], 0
		jmp	loc_471_1629
; ---------------------------------------------------------------------------

loc_471_AAA:				; CODE XREF: TrkPlanSimd+FEFj
		mov	al, [bp+cCounter]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+p_pCvx2]
		add	ax, CarState.vecUnk1
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	TrkTerrainWall
		add	sp, 4

loc_471_ACB:				; CODE XREF: TrkPlanSimd+1011j
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		mov	bx, [bp+p_pCvx2]
		mov	al, byte_2B77_95D7
		mov	[bx+di+CarState.cSurfaceGripIndex1], al
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_AE7:				; CODE XREF: TrkPlanSimd+45Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_AE7
		mov	[bp+vec4.wX], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_AFF:				; CODE XREF: TrkPlanSimd+473j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_AFF
		mov	[bp+vec4.wY], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_B17:				; CODE XREF: TrkPlanSimd+48Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_B17
		mov	[bp+vec4.wZ], ax
		cmp	gameState.cCvxFlag2, 2
		jnz	short loc_471_B30
		mov	ax, [bp+vec4.wY]
		jmp	short loc_471_B47
; ---------------------------------------------------------------------------

loc_471_B30:				; CODE XREF: TrkPlanSimd+496j
		push	[bp+vec4.wZ]
		push	[bp+vec4.wY]
		push	[bp+vec4.wX]
		push	g_wPlanIndex
		push	cs
		call	near ptr PlaneOriginOp
		add	sp, 8

loc_471_B47:				; CODE XREF: TrkPlanSimd+49Cj
		mov	word_2B77_A28E,	ax
		cmp	g_wTrkTerrSomeCode, 0FFFFh
		jnz	short loc_471_B54
		jmp	loc_471_1240
; ---------------------------------------------------------------------------

loc_471_B54:				; CODE XREF: TrkPlanSimd+4BDj
		mov	ax, word_2B77_9218
		cmp	word_2B77_A28E,	ax
		jg	short loc_471_B60
		jmp	loc_471_1240
; ---------------------------------------------------------------------------

loc_471_B60:				; CODE XREF: TrkPlanSimd+4C9j
		mov	ax, g_wTrkTerrnSomeCode2
		cmp	word_2B77_A28E,	ax
		jl	short loc_471_B6C
		jmp	loc_471_1240
; ---------------------------------------------------------------------------

loc_471_B6C:				; CODE XREF: TrkPlanSimd+4D5j
		mov	al, [bp+cCounter]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, [bp+p_pCvx2]
		mov	ax, [di+CarState.vecUnk1.wX]
		sub	ax, g_dwCopySomeX
		mov	[bp+vec2.wX], ax
		mov	[bp+vec2.wY], 0
		mov	ax, [di+CarState.vecUnk1.wZ]
		sub	ax, g_dwCopySomeZ
		mov	[bp+vec2.wZ], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, [bx]
		mov	dx, [bx+2]
		mov	cl, 6

loc_471_BA5:				; CODE XREF: TrkPlanSimd+519j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_BA5
		sub	ax, g_dwCopySomeX
		mov	[bp+vec3.wX], ax
		mov	[bp+vec3.wY], 0
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_BC7:				; CODE XREF: TrkPlanSimd+53Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_BC7
		sub	ax, g_dwCopySomeZ
		mov	[bp+vec3.wZ], ax
		mov	ax, word_2B77_A626
		neg	ax
		sub	ax, 100h
		push	ax
		lea	ax, [bp+mat]
		push	ax
		call	MatRotateY
		add	sp, 4
		lea	ax, [bp+vecCopy2]
		push	ax
		lea	ax, [bp+mat]
		push	ax
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		lea	ax, [bp+vecCopy]
		push	ax
		lea	ax, [bp+mat]
		push	ax
		lea	ax, [bp+vec3]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vecCopy.wZ], 0
		jle	short loc_471_C28
		cmp	[bp+vecCopy2.wZ], 0
		jle	short loc_471_C28
		jmp	loc_471_1240
; ---------------------------------------------------------------------------

loc_471_C28:				; CODE XREF: TrkPlanSimd+58Bj
					; TrkPlanSimd+591j
		cmp	[bp+vecCopy.wZ], 0
		jge	short loc_471_C37
		cmp	[bp+vecCopy2.wZ], 0
		jge	short loc_471_C37
		jmp	loc_471_1240
; ---------------------------------------------------------------------------

loc_471_C37:				; CODE XREF: TrkPlanSimd+59Aj
					; TrkPlanSimd+5A0j
		mov	ax, [bp+vecCopy2.wZ]
		cmp	[bp+vecCopy.wZ], ax
		jle	short loc_471_C6C
		mov	[bp+var_136], 1
		push	si
		lea	di, [bp+vec1]
		lea	si, [bp+vecCopy]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		push	si
		lea	di, [bp+vecCopy]
		lea	si, [bp+vecCopy2]
		movsw
		movsw
		movsw
		pop	si
		push	si
		lea	di, [bp+vecCopy2]
		lea	si, [bp+vec1]
		movsw
		movsw
		movsw
		pop	si
		jmp	short loc_471_C71
; ---------------------------------------------------------------------------
		nop

loc_471_C6C:				; CODE XREF: TrkPlanSimd+5ABj
		mov	[bp+var_136], 0

loc_471_C71:				; CODE XREF: TrkPlanSimd+5D7j
		cmp	[bp+vecCopy.wZ], 0
		jnz	short loc_471_C88
		mov	ax, [bp+wZ]
		mov	[bp+wAngleZ], ax
		mov	[bp+wAngleX], 0
		jmp	short loc_471_CFC
; ---------------------------------------------------------------------------
		nop

loc_471_C88:				; CODE XREF: TrkPlanSimd+5E3j
		cmp	[bp+vecCopy2.wZ], 0
		jnz	short loc_471_C9E
		mov	[bp+wAngleZ], 0
		mov	ax, [bp+wZ]
		mov	[bp+wAngleX], ax
		jmp	short loc_471_CFC
; ---------------------------------------------------------------------------

loc_471_C9E:				; CODE XREF: TrkPlanSimd+5FAj
		sub	ax, ax
		push	ax
		lea	ax, [bp+vec1]
		push	ax
		lea	ax, [bp+vecCopy2]
		push	ax
		lea	ax, [bp+vecCopy]
		push	ax
		call	VectorOp3
		add	sp, 8
		mov	ax, [bp+vecCopy.wX]
		sub	ax, [bp+vec1.wX]
		mov	cl, 6
		shl	ax, cl
		mov	[bp+vec6.wX], ax
		mov	ax, [bp+vecCopy.wY]
		sub	ax, [bp+vec1.wY]
		shl	ax, cl
		mov	[bp+vec6.wY], ax
		mov	ax, [bp+vecCopy.wZ]
		sub	ax, [bp+vec1.wZ]
		shl	ax, cl
		mov	[bp+vec6.wZ], ax
		lea	ax, [bp+vec6]
		push	ax
		call	ZXCosSinX2
		add	sp, 2
		mov	[bp+wAngleX], ax
		mov	ax, [bp+wZ]
		sub	ax, [bp+wAngleX]
		mov	[bp+wAngleZ], ax

loc_471_CFC:				; CODE XREF: TrkPlanSimd+5F3j
					; TrkPlanSimd+60Aj
		mov	ax, g_wPoly2Code
		neg	ax
		sub	ax, word_2B77_A626
		and	ah, 3
		mov	[bp+wAngle], ax
		mov	ax, [bp+wAngleX]
		mov	[bp+vec1.wZ], ax
		mov	[bp+vec1.wY], 0
		cmp	[bp+wAngle], 100h
		jl	short loc_471_D2A
		cmp	[bp+wAngle], 300h
		jle	short loc_471_D3A

loc_471_D2A:				; CODE XREF: TrkPlanSimd+68Ej
		mov	ax, word_2B77_A626
		mov	[bp+wAngle], ax
		mov	[bp+vec1.wX], 300h
		jmp	short loc_471_D4D
; ---------------------------------------------------------------------------
		nop

loc_471_D3A:				; CODE XREF: TrkPlanSimd+696j
		mov	ax, word_2B77_A626
		add	ah, 2
		and	ah, 3
		mov	[bp+wAngle], ax
		mov	[bp+vec1.wX], 0FD00h

loc_471_D4D:				; CODE XREF: TrkPlanSimd+6A5j
		cmp	[bp+var_136], 0
		jz	short loc_471_D5E
		mov	ax, [bp+vec1.wX]
		neg	ax
		mov	[bp+vec1.wX], ax

loc_471_D5E:				; CODE XREF: TrkPlanSimd+6C0j
		sub	ax, ax
		push	ax
		push	[bp+wAngle]
		mov	ax, g_wTrkPlanAngle
		neg	ax
		push	ax
		mov	ax, g_wSomeAngle
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix3], ax
		lea	ax, [bp+vecCopy]
		push	ax
		push	[bp+pMatrix3]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, g_wPoly2Code
		neg	ax
		mov	si, ax
		sub	si, [bp+wAngle]
		and	si, 3FFh
		mov	[bp+wPlaneOrignOpResult], 0
		cmp	si, 100h
		jle	short loc_471_DBA
		mov	ax, 400h
		sub	ax, si
		mov	si, ax
		mov	[bp+wPlaneOrignOpResult], 1

loc_471_DBA:				; CODE XREF: TrkPlanSimd+719j
		mov	ax, 46h	; 'F'
		imul	si
		mov	cl, 8
		sar	ax, cl
		sub	ax, 64h	; 'd'
		neg	ax
		mov	ch, al
		sub	cl, cl
		mov	[bp+var_190], cx
		mov	bx, [bp+p_pCvx2]
		mov	ax, cx
		cmp	[bx+CarState.wTrackGrip2], ax
		jbe	short loc_471_E03
		cmp	[bp+wPlaneOrignOpResult], 0
		jz	short loc_471_DE8
		mov	ax, si
		neg	ax
		jmp	short loc_471_DEA
; ---------------------------------------------------------------------------
		nop

loc_471_DE8:				; CODE XREF: TrkPlanSimd+74Dj
		mov	ax, si

loc_471_DEA:				; CODE XREF: TrkPlanSimd+753j
		shl	ax, 1
		mov	[bp+wPlaneOrignOpResult], ax
		mov	[bx+CarState.field_36],	ax
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_E03:				; CODE XREF: TrkPlanSimd+746j
		mov	bx, [bp+p_pCvx2]
		or	[bx+CarState.field_CF],	10h
		lea	ax, [bp+vecLong]
		mov	[bp+pCurVecLong], ax
		lea	ax, [bp+vecLong2]
		mov	[bp+wCurVecLong2], ax
		sub	si, si
		jmp	short loc_471_E89
; ---------------------------------------------------------------------------
		nop

loc_471_E20:				; CODE XREF: TrkPlanSimd+804j
		mov	[bp+vecCopy2.wX], 0
		mov	[bp+vecCopy2.wY], 0
		mov	[bp+vecCopy2.wZ], 0

loc_471_E2F:				; CODE XREF: TrkPlanSimd+89Dj
		mov	ax, [bp+vecCopy2.wX]
		add	ax, [bp+vecCopy.wX]
		cwd
		mov	bx, [bp+wCurVecLong2]
		add	ax, word ptr [bx+VectorLong3D.dwX]
		adc	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwX],	ax
		mov	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	ax, [bp+vecCopy2.wY]
		add	ax, [bp+vecCopy.wY]
		cwd
		mov	bx, [bp+wCurVecLong2]
		add	ax, word ptr [bx+VectorLong3D.dwY]
		adc	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwY],	ax
		mov	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	ax, [bp+vecCopy2.wZ]
		add	ax, [bp+vecCopy.wZ]
		cwd
		mov	bx, [bp+wCurVecLong2]
		add	ax, word ptr [bx+VectorLong3D.dwZ]
		adc	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwZ],	ax
		mov	word ptr [bx+(VectorLong3D.dwZ+2)], dx
		add	[bp+pCurVecLong], 0Ch
		add	[bp+wCurVecLong2], 0Ch
		inc	si

loc_471_E89:				; CODE XREF: TrkPlanSimd+78Bj
		cmp	si, 4
		jl	short loc_471_E91
		jmp	loc_471_A32
; ---------------------------------------------------------------------------

loc_471_E91:				; CODE XREF: TrkPlanSimd+7FAj
		cmp	[bp+wAngleZ], 0
		jz	short loc_471_E20
		mov	ax, [bp+wZ]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wAngleZ]
		cwd
		push	dx
		push	ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	bx, [bp+wCurVecLong2]
		sub	ax, word ptr [bx+VectorLong3D.dwX]
		sbb	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+vecCopy2.wX], ax
		mov	ax, [bp+wZ]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wAngleZ]
		cwd
		push	dx
		push	ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	bx, [bp+wCurVecLong2]
		sub	ax, word ptr [bx+VectorLong3D.dwY]
		sbb	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+vecCopy2.wY], ax
		mov	ax, [bp+wZ]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wAngleZ]
		cwd
		push	dx
		push	ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	bx, [bp+wCurVecLong2]
		sub	ax, word ptr [bx+VectorLong3D.dwZ]
		sbb	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+vecCopy2.wZ], ax
		jmp	loc_471_E2F
; ---------------------------------------------------------------------------

loc_471_F32:				; CODE XREF: TrkPlanSimd+BBFj
					; TrkPlanSimd+BC9j
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr unk_2B77_602[di]
		add	[bx+di+CarState.rc1.dwLeft], ax
		mov	al, [bp+cCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.rc1.dwLeft]
		cwd
		mov	bx, [bp+pCurVecLong]
		sub	word ptr [bx+VectorLong3D.dwY],	ax
		sbb	word ptr [bx+(VectorLong3D.dwY+2)], dx
		cmp	g_wFramesPerSec, 0Ah
		jnz	short loc_471_F93
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr unk_2B77_602[di]
		add	[bx+di+CarState.rc1.dwLeft], ax
		mov	al, [bp+cCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.rc1.dwLeft]
		cwd
		mov	bx, [bp+pCurVecLong]
		sub	word ptr [bx+VectorLong3D.dwY],	ax
		sbb	word ptr [bx+(VectorLong3D.dwY+2)], dx

loc_471_F93:				; CODE XREF: TrkPlanSimd+8D2j
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_F9F:				; CODE XREF: TrkPlanSimd+913j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_F9F
		mov	[bp+vec4.wY], ax
		cmp	gameState.cCvxFlag2, 2
		jz	short loc_471_FC6
		push	[bp+vec4.wZ]
		push	ax
		push	[bp+vec4.wX]
		push	g_wPlanIndex
		push	cs
		call	near ptr PlaneOriginOp
		add	sp, 8

loc_471_FC6:				; CODE XREF: TrkPlanSimd+91Ej
		mov	word_2B77_A28E,	ax
		cmp	ax, 0Ch
		jle	short loc_471_FDD
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		mov	bx, [bp+p_pCvx2]
		mov	[bx+di+CarState.cSurfaceGripIndex1], 0

loc_471_FDD:				; CODE XREF: TrkPlanSimd+93Aj
					; TrkPlanSimd+BB5j ...
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	ax, word_2B77_A28E
		mov	[bp+di+var_16],	ax
		or	ax, ax
		jnz	short loc_471_FF3
		jmp	loc_471_15D8
; ---------------------------------------------------------------------------

loc_471_FF3:				; CODE XREF: TrkPlanSimd+95Cj
		or	ax, ax
		jl	short loc_471_FFA
		jmp	loc_471_161B
; ---------------------------------------------------------------------------

loc_471_FFA:				; CODE XREF: TrkPlanSimd+963j
		mov	ax, 22h		; size of plane!
		imul	g_wPlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		mov	word ptr [bp+pPlane], ax
		mov	word ptr [bp+pPlane+2],	dx
		les	bx, [bp+pPlane]
		mov	ax, es:[bx+Plane.vecOrigin.wX]
		add	ax, g_dwSomeX
		mov	[bp+vec.wX], ax
		mov	ax, es:[bx+Plane.vecOrigin.wY]
		add	ax, g_dwSomeY
		mov	[bp+vec.wY], ax
		mov	ax, es:[bx+Plane.vecOrigin.wZ]
		add	ax, g_dwSomeZ
		mov	[bp+vec.wZ], ax
		mov	bx, [bp+wCurVecLong2]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_1041:				; CODE XREF: TrkPlanSimd+9B5j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1041
		sub	ax, [bp+vec.wX]
		mov	[bp+vec2.wX], ax
		mov	bx, [bp+wCurVecLong2]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_105D:				; CODE XREF: TrkPlanSimd+9D1j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_105D
		sub	ax, [bp+vec.wY]
		mov	[bp+vec2.wY], ax
		mov	bx, [bp+wCurVecLong2]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_1079:				; CODE XREF: TrkPlanSimd+9EDj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1079
		sub	ax, [bp+vec.wZ]
		mov	[bp+vec2.wZ], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_1094:				; CODE XREF: TrkPlanSimd+A08j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1094
		sub	ax, [bp+vec.wX]
		mov	[bp+vec3.wX], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_10B0:				; CODE XREF: TrkPlanSimd+A24j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_10B0
		sub	ax, [bp+vec.wY]
		mov	[bp+vec3.wY], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_10CC:				; CODE XREF: TrkPlanSimd+A40j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_10CC
		sub	ax, [bp+vec.wZ]
		mov	[bp+vec3.wZ], ax
		mov	ax, word ptr [bp+pPlane]
		mov	dx, word ptr [bp+pPlane+2]
		add	ax, Plane.matRotation
		push	si
		lea	di, [bp+mat]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		mov	cx, 9
		repne movsw
		pop	ds
		pop	si
		lea	ax, [bp+mat2]
		push	ax
		lea	ax, [bp+mat]
		push	ax
		call	MatCopy
		add	sp, 4
		lea	ax, [bp+vecCopy2]
		push	ax
		lea	ax, [bp+mat2]
		push	ax
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		lea	ax, [bp+vecCopy]
		push	ax
		lea	ax, [bp+mat2]
		push	ax
		lea	ax, [bp+vec3]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	[bp+var_136], 0
		cmp	byte_2B77_81BC,	0
		jnz	short loc_471_1169
		cmp	[bp+vecCopy2.wY], 0FFF4h
		jge	short loc_471_1169
		cmp	[bp+vecCopy.wY], 0FFF4h
		jge	short loc_471_1169
		cmp	[bp+vecCopy.wY], 0FFE8h
		jle	short loc_471_11CA
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 5
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4
		mov	[bp+var_136], 1

loc_471_1169:				; CODE XREF: TrkPlanSimd+AAEj
					; TrkPlanSimd+AB4j ...
		cmp	[bp+vecCopy.wY], 0
		jz	short loc_471_1172
		jmp	loc_471_128E
; ---------------------------------------------------------------------------

loc_471_1172:				; CODE XREF: TrkPlanSimd+ADBj
		mov	vec_2B77_97C6.wX, 0
		mov	vec_2B77_97C6.wY, 0
		mov	vec_2B77_97C6.wZ, 40h ;	'@'
		mov	ax, g_wPlanIndex
		mov	g_wSomePlanIndex, ax
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	ax, [bp+di+wAngleOrCode]
		mov	g_wSomePi3Code,	ax
		push	cs
		call	near ptr PlaneRotateOp
		mov	ax, g_vecPlaneRotOpResul.wX
		cwd
		mov	bx, [bp+pCurVecLong]
		sub	word ptr [bx+VectorLong3D.dwX],	ax
		sbb	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	ax, g_vecPlaneRotOpResul.wY
		cwd
		mov	bx, [bp+pCurVecLong]
		sub	word ptr [bx+VectorLong3D.dwY],	ax
		sbb	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	ax, g_vecPlaneRotOpResul.wZ
		cwd
		mov	bx, [bp+pCurVecLong]
		sub	word ptr [bx+VectorLong3D.dwZ],	ax
		sbb	word ptr [bx+(VectorLong3D.dwZ+2)], dx
		jmp	loc_471_15CF
; ---------------------------------------------------------------------------

loc_471_11CA:				; CODE XREF: TrkPlanSimd+AC0j
		mov	g_wPlanIndex, 0
		mov	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		mov	word ptr g_pTrkWallTerrainPla, ax
		mov	word ptr g_pTrkWallTerrainPla+2, dx
		mov	byte_2B77_81BC,	1
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_11EE:				; CODE XREF: TrkPlanSimd+B62j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_11EE
		mov	[bp+vec4.wX], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_1206:				; CODE XREF: TrkPlanSimd+B7Aj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1206
		mov	[bp+vec4.wY], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_121E:				; CODE XREF: TrkPlanSimd+B92j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_121E
		mov	[bp+vec4.wZ], ax
		push	ax
		push	[bp+vec4.wY]
		push	[bp+vec4.wX]
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr PlaneOriginOp
		add	sp, 8
		mov	word_2B77_A28E,	ax

loc_471_1240:				; CODE XREF: TrkPlanSimd+4BFj
					; TrkPlanSimd+4CBj ...
		cmp	word_2B77_A28E,	0
		jg	short loc_471_124A
		jmp	loc_471_FDD
; ---------------------------------------------------------------------------

loc_471_124A:				; CODE XREF: TrkPlanSimd+BB3j
		cmp	[bp+var_F0], 0
		jg	short loc_471_1254
		jmp	loc_471_F32
; ---------------------------------------------------------------------------

loc_471_1254:				; CODE XREF: TrkPlanSimd+BBDj
		cmp	word_2B77_A28E,	18h
		jl	short loc_471_125E
		jmp	loc_471_F32
; ---------------------------------------------------------------------------

loc_471_125E:				; CODE XREF: TrkPlanSimd+BC7j
		mov	ax, [bp+vec5.wX]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwX],	ax
		adc	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	ax, [bp+vec5.wY]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwY],	ax
		adc	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	ax, [bp+vec5.wZ]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwZ],	ax
		adc	word ptr [bx+(VectorLong3D.dwZ+2)], dx
		jmp	loc_471_FDD
; ---------------------------------------------------------------------------
		nop

loc_471_128E:				; CODE XREF: TrkPlanSimd+ADDj
		cmp	[bp+vecCopy2.wY], 0
		jle	short loc_471_129D
		cmp	[bp+vecCopy.wY], 0
		jge	short loc_471_129D
		jmp	loc_471_1320
; ---------------------------------------------------------------------------

loc_471_129D:				; CODE XREF: TrkPlanSimd+C00j
					; TrkPlanSimd+C06j
		mov	vec_2B77_97C6.wX, 0
		mov	vec_2B77_97C6.wY, 0
		mov	ax, [bp+wZ]
		mov	vec_2B77_97C6.wZ, ax
		mov	ax, g_wPlanIndex
		mov	g_wSomePlanIndex, ax
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	ax, [bp+di+wAngleOrCode]
		mov	g_wSomePi3Code,	ax
		push	cs
		call	near ptr PlaneRotateOp
		mov	ax, g_vecPlaneRotOpResul.wX
		cwd
		mov	bx, [bp+wCurVecLong2]
		mov	cx, word ptr [bx+VectorLong3D.dwX]
		mov	di, word ptr [bx+(VectorLong3D.dwX+2)]
		add	cx, ax
		adc	di, dx
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwX],	cx
		mov	word ptr [bx+(VectorLong3D.dwX+2)], di
		mov	ax, g_vecPlaneRotOpResul.wY
		cwd
		mov	bx, [bp+wCurVecLong2]
		mov	cx, word ptr [bx+VectorLong3D.dwY]
		mov	di, word ptr [bx+(VectorLong3D.dwY+2)]
		add	cx, ax
		adc	di, dx
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwY],	cx
		mov	word ptr [bx+(VectorLong3D.dwY+2)], di
		mov	ax, g_vecPlaneRotOpResul.wZ
		cwd
		mov	bx, [bp+wCurVecLong2]
		mov	cx, word ptr [bx+VectorLong3D.dwZ]
		mov	di, word ptr [bx+(VectorLong3D.dwZ+2)]
		add	cx, ax
		adc	di, dx
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwZ],	cx
		mov	word ptr [bx+(VectorLong3D.dwZ+2)], di
		jmp	loc_471_14F4
; ---------------------------------------------------------------------------
		nop

loc_471_1320:				; CODE XREF: TrkPlanSimd+C08j
		mov	ax, [bp+vecCopy2.wZ]
		mov	[bp+wAngle], ax
		mov	ax, [bp+vecCopy2.wY]
		neg	ax
		mov	[bp+vecCopy2.wZ], ax
		mov	ax, [bp+wAngle]
		mov	[bp+vecCopy2.wY], ax
		mov	ax, [bp+vecCopy.wZ]
		mov	[bp+wAngle], ax
		mov	ax, [bp+vecCopy.wY]
		neg	ax
		mov	[bp+vecCopy.wZ], ax
		mov	ax, [bp+wAngle]
		mov	[bp+vecCopy.wY], ax
		sub	ax, ax
		push	ax
		lea	ax, [bp+vec1]
		push	ax
		lea	ax, [bp+vecCopy2]
		push	ax
		lea	ax, [bp+vecCopy]
		push	ax
		call	VectorOp3
		add	sp, 8
		mov	ax, [bp+vecCopy.wX]
		sub	ax, [bp+vec1.wX]
		mov	cl, 6
		shl	ax, cl
		mov	[bp+vec6.wX], ax
		mov	ax, [bp+vecCopy.wY]
		sub	ax, [bp+vec1.wY]
		shl	ax, cl
		mov	[bp+vec6.wY], ax
		mov	ax, [bp+vecCopy.wZ]
		sub	ax, [bp+vec1.wZ]
		shl	ax, cl
		mov	[bp+vec6.wZ], ax
		lea	ax, [bp+vec6]
		push	ax
		call	ZXCosSinX2
		add	sp, 2
		mov	[bp+wAngle], ax
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+di+CarState.rc1.dwLeft]
		add	ax, [bp+wZ]
		mov	[bp+wAngleZ], ax
		sub	ax, [bp+wAngle]
		mov	[bp+wAngleX], ax
		mov	ax, [bp+wAngleZ]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wAngleX]
		cwd
		push	dx
		push	ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	bx, [bp+wCurVecLong2]
		sub	ax, word ptr [bx+VectorLong3D.dwX]
		sbb	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+vecCopy2.wX], ax
		mov	ax, [bp+wAngleZ]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wAngleX]
		cwd
		push	dx
		push	ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	bx, [bp+wCurVecLong2]
		sub	ax, word ptr [bx+VectorLong3D.dwY]
		sbb	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+vecCopy2.wY], ax
		mov	ax, [bp+wAngleZ]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wAngleX]
		cwd
		push	dx
		push	ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	bx, [bp+wCurVecLong2]
		sub	ax, word ptr [bx+VectorLong3D.dwZ]
		sbb	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+vecCopy2.wZ], ax
		mov	vec_2B77_97C6.wX, 0
		mov	vec_2B77_97C6.wY, 0
		mov	ax, [bp+wAngle]
		mov	vec_2B77_97C6.wZ, ax
		mov	ax, g_wPlanIndex
		mov	g_wSomePlanIndex, ax
		mov	ax, [bp+di+wAngleOrCode]
		mov	g_wSomePi3Code,	ax
		push	cs
		call	near ptr PlaneRotateOp
		mov	bx, [bp+wCurVecLong2]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cx, ax
		mov	ax, [bp+vecCopy2.wX]
		mov	bx, dx
		cwd
		add	cx, ax
		adc	bx, dx
		mov	ax, g_vecPlaneRotOpResul.wX
		cwd
		add	cx, ax
		adc	bx, dx
		mov	ax, bx
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwX],	cx
		mov	word ptr [bx+(VectorLong3D.dwX+2)], ax
		mov	bx, [bp+wCurVecLong2]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cx, ax
		mov	ax, [bp+vecCopy2.wY]
		mov	bx, dx
		cwd
		add	cx, ax
		adc	bx, dx
		mov	ax, g_vecPlaneRotOpResul.wY
		cwd
		add	cx, ax
		adc	bx, dx
		mov	ax, bx
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwY],	cx
		mov	word ptr [bx+(VectorLong3D.dwY+2)], ax
		mov	bx, [bp+wCurVecLong2]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cx, ax
		mov	ax, [bp+vecCopy2.wZ]
		mov	bx, dx
		cwd
		add	cx, ax
		adc	bx, dx
		mov	ax, g_vecPlaneRotOpResul.wZ
		cwd
		add	cx, ax
		adc	bx, dx
		mov	ax, bx
		mov	bx, [bp+pCurVecLong]
		mov	word ptr [bx+VectorLong3D.dwZ],	cx
		mov	word ptr [bx+(VectorLong3D.dwZ+2)], ax

loc_471_14F4:				; CODE XREF: TrkPlanSimd+C8Aj
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_14FF:				; CODE XREF: TrkPlanSimd+E73j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_14FF
		mov	[bp+vec4.wX], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_1517:				; CODE XREF: TrkPlanSimd+E8Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1517
		mov	[bp+vec4.wY], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_152F:				; CODE XREF: TrkPlanSimd+EA3j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_152F
		mov	[bp+vec4.wZ], ax
		push	ax
		push	[bp+vec4.wY]
		push	[bp+vec4.wX]
		push	g_wPlanIndex
		push	cs
		call	near ptr PlaneOriginOp
		add	sp, 8
		mov	word_2B77_A28E,	ax
		or	ax, ax
		jge	short loc_471_15CF
		cmp	[bp+var_136], 0
		jz	short loc_471_1565
		neg	ax
		add	ax, 6
		mov	word_2B77_A28E,	ax

loc_471_1565:				; CODE XREF: TrkPlanSimd+EC9j
		mov	[bp+vec4.wZ], 0
		mov	[bp+vec4.wX], 0
		mov	ax, word_2B77_A28E
		neg	ax
		mov	cl, 6
		shl	ax, cl
		mov	[bp+vec4.wY], ax
		lea	ax, [bp+vec1]
		push	ax
		mov	ax, 22h		; sizeof plane
		imul	g_wPlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		add	ax, Plane.matRotation
		push	dx
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		push	cs
		call	near ptr MatMultiplyVector2
		add	sp, 8
		mov	ax, [bp+vec1.wX]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwX],	ax
		adc	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	ax, [bp+vec1.wY]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwY],	ax
		adc	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	ax, [bp+vec1.wZ]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwZ],	ax
		adc	word ptr [bx+(VectorLong3D.dwZ+2)], dx

loc_471_15CF:				; CODE XREF: TrkPlanSimd+B35j
					; TrkPlanSimd+EC2j
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1

loc_471_15D8:				; CODE XREF: TrkPlanSimd+95Ej
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+di+CarState.rc1.dwLeft], 0FAh ; 'ú'
		jle	short loc_471_15E7
		or	[bx+CarState.field_CF],	20h

loc_471_15E7:				; CODE XREF: TrkPlanSimd+F4Ej
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+di+CarState.rc1.dwLeft], 5AEBh
		jle	short loc_471_160A
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_160A:				; CODE XREF: TrkPlanSimd+F66j
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		mov	[bx+di+CarState.rc1.dwLeft], 0

loc_471_161B:				; CODE XREF: TrkPlanSimd+965j
		add	[bp+pCurVecLong], 0Ch
		add	[bp+wCurVecLong2], 0Ch
		inc	[bp+cCounter]

loc_471_1629:				; CODE XREF: TrkPlanSimd+415j
		cmp	[bp+cCounter], 4
		jl	short loc_471_1633
		jmp	loc_471_A53
; ---------------------------------------------------------------------------

loc_471_1633:				; CODE XREF: TrkPlanSimd+F9Cj
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_163E:				; CODE XREF: TrkPlanSimd+FB2j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_163E
		mov	[bp+vec4.wX], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_1656:				; CODE XREF: TrkPlanSimd+FCAj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1656
		mov	[bp+vec4.wY], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_166E:				; CODE XREF: TrkPlanSimd+FE2j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_166E
		mov	[bp+vec4.wZ], ax
		cmp	gameState.cCvxFlag2, 2
		jz	short loc_471_1684
		jmp	loc_471_AAA
; ---------------------------------------------------------------------------

loc_471_1684:				; CODE XREF: TrkPlanSimd+FEDj
		mov	g_wTrkTerrSomeCode, 0FFFFh
		mov	byte_2B77_95D7,	1
		mov	g_wPlanIndex, 0
		mov	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		mov	word ptr g_pTrkWallTerrainPla, ax
		mov	word ptr g_pTrkWallTerrainPla+2, dx
		jmp	loc_471_ACB
; ---------------------------------------------------------------------------

loc_471_16A6:				; CODE XREF: TrkPlanSimd+10E0j
		mov	ax, [bp+wAngle]
		add	ax, 180h
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwY],	ax
		adc	word ptr [bx+(VectorLong3D.dwY+2)], dx

loc_471_16B8:				; CODE XREF: TrkPlanSimd+113Cj
		add	[bp+pCurVecLong], 0Ch
		inc	[bp+cCounter]

loc_471_16C1:				; CODE XREF: TrkPlanSimd+3FDj
		cmp	[bp+cCounter], 4
		jl	short loc_471_16CB
		jmp	loc_471_17D2
; ---------------------------------------------------------------------------

loc_471_16CB:				; CODE XREF: TrkPlanSimd+1034j
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwX]
		mov	dx, word ptr [bx+(VectorLong3D.dwX+2)]
		mov	cl, 6

loc_471_16D6:				; CODE XREF: TrkPlanSimd+104Aj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_16D6
		mov	cx, ax
		mov	al, [bp+cCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, [bp+p_pCvx2]
		mov	[bx+CarState.vecUnk1.wX], cx
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwY]
		mov	dx, word ptr [bx+(VectorLong3D.dwY+2)]
		mov	cl, 6

loc_471_16FF:				; CODE XREF: TrkPlanSimd+1073j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_16FF
		mov	cx, ax
		mov	al, [bp+cCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, [bp+p_pCvx2]
		mov	[bx+CarState.vecUnk1.wY], cx
		mov	bx, [bp+pCurVecLong]
		mov	ax, word ptr [bx+VectorLong3D.dwZ]
		mov	dx, word ptr [bx+(VectorLong3D.dwZ+2)]
		mov	cl, 6

loc_471_1728:				; CODE XREF: TrkPlanSimd+109Cj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1728
		mov	cx, ax
		mov	al, [bp+cCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, [bp+p_pCvx2]
		mov	[bx+CarState.vecUnk1.wZ], cx
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		push	di
		mov	bx, di
		shl	bx, 1
		add	bx, bp
		push	[bx+var_16]
		push	[bp+p_pCvx2]
		push	cs
		call	near ptr InitCarCvx64_64
		add	sp, 6
		mov	[bp+wAngle], ax
		cmp	g_wSomeAngle, 0
		jnz	short loc_471_1775
		cmp	g_wTrkPlanAngle, 0
		jnz	short loc_471_1775
		jmp	loc_471_16A6
; ---------------------------------------------------------------------------

loc_471_1775:				; CODE XREF: TrkPlanSimd+10D7j
					; TrkPlanSimd+10DEj
		mov	[bp+vec4.wZ], 0
		mov	[bp+vec4.wX], 0
		mov	ax, [bp+wAngle]
		add	ax, 180h
		mov	[bp+vec4.wY], ax
		lea	ax, [bp+vec2]
		push	ax
		mov	ax, offset g_mat3
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec2.wX]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwX],	ax
		adc	word ptr [bx+(VectorLong3D.dwX+2)], dx
		mov	ax, [bp+vec2.wY]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwY],	ax
		adc	word ptr [bx+(VectorLong3D.dwY+2)], dx
		mov	ax, [bp+vec2.wZ]
		cwd
		mov	bx, [bp+pCurVecLong]
		add	word ptr [bx+VectorLong3D.dwZ],	ax
		adc	word ptr [bx+(VectorLong3D.dwZ+2)], dx
		jmp	loc_471_16B8
; ---------------------------------------------------------------------------
		nop

loc_471_17D2:				; CODE XREF: TrkPlanSimd+1036j
		mov	ax, word ptr [bp+vecLong.dwX]
		mov	dx, word ptr [bp+vecLong.dwX+2]
		add	ax, [bp+var_1B4]
		adc	dx, [bp+var_1B2]
		add	ax, [bp+var_1A8]
		adc	dx, [bp+var_1A6]
		add	ax, [bp+var_19C]
		adc	dx, [bp+var_19A]
		mov	cl, 2

loc_471_17F4:				; CODE XREF: TrkPlanSimd+1168j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_17F4
		mov	word ptr g_dwXCounter, ax
		mov	word ptr g_dwXCounter+2, dx
		mov	ax, word ptr [bp+vecLong.dwY]
		mov	dx, word ptr [bp+vecLong.dwY+2]
		add	ax, [bp+var_1B0]
		adc	dx, [bp+var_1AE]
		add	ax, [bp+var_1A4]
		adc	dx, [bp+var_1A2]
		add	ax, [bp+var_198]
		adc	dx, [bp+var_196]
		mov	cl, 2

loc_471_1825:				; CODE XREF: TrkPlanSimd+1199j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1825
		mov	word ptr g_dwYCounter, ax
		mov	word ptr g_dwYCounter+2, dx
		mov	ax, word ptr [bp+vecLong.dwZ]
		mov	dx, word ptr [bp+vecLong.dwZ+2]
		add	ax, [bp+var_1AC]
		adc	dx, [bp+var_1AA]
		add	ax, [bp+var_1A0]
		adc	dx, [bp+var_19E]
		add	ax, [bp+var_194]
		adc	dx, [bp+var_192]
		mov	cl, 2

loc_471_1856:				; CODE XREF: TrkPlanSimd+11CAj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1856
		mov	word ptr g_dwZCounter, ax
		mov	word ptr g_dwZCounter+2, dx
		lea	ax, [bp+vecLong]
		mov	[bp+pCurVecLong], ax
		mov	[bp+cCounter], 0

loc_471_1872:				; CODE XREF: TrkPlanSimd+122Bj
		mov	al, [bp+cCounter]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, bp
		mov	bx, [bp+pCurVecLong]
		mov	ax, [bx]
		sub	ax, word ptr g_dwXCounter
		mov	[di+var_1DE.wX], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, [bx+4]
		sub	ax, word ptr g_dwYCounter
		mov	[di+var_1DE.wY], ax
		mov	bx, [bp+pCurVecLong]
		mov	ax, [bx+8]
		sub	ax, word ptr g_dwZCounter
		mov	[di+var_1DE.wZ], ax
		add	[bp+pCurVecLong], 0Ch
		inc	[bp+cCounter]
		cmp	[bp+cCounter], 4
		jl	short loc_471_1872
		cmp	word ptr g_dwYCounter+2, 0
		jge	short loc_471_18CE
		sub	ax, ax
		mov	word ptr g_dwYCounter+2, ax
		mov	word ptr g_dwYCounter, ax

loc_471_18CE:				; CODE XREF: TrkPlanSimd+1232j
		cmp	word ptr g_dwXCounter+2, 1Dh
		jl	short loc_471_18EE
		jg	short loc_471_18DF
		cmp	word ptr g_dwXCounter, 0F100h
		jbe	short loc_471_18EE

loc_471_18DF:				; CODE XREF: TrkPlanSimd+1243j
		mov	word ptr g_dwXCounter, 0F0FFh
		mov	word ptr g_dwXCounter+2, 1Dh
		jmp	short loc_471_190B
; ---------------------------------------------------------------------------
		nop

loc_471_18EE:				; CODE XREF: TrkPlanSimd+1241j
					; TrkPlanSimd+124Bj
		cmp	word ptr g_dwXCounter+2, 0
		jg	short loc_471_190B
		jl	short loc_471_18FF
		cmp	word ptr g_dwXCounter, 0F00h
		jnb	short loc_471_190B

loc_471_18FF:				; CODE XREF: TrkPlanSimd+1263j
		mov	word ptr g_dwXCounter, 0F00h
		mov	word ptr g_dwXCounter+2, 0

loc_471_190B:				; CODE XREF: TrkPlanSimd+1259j
					; TrkPlanSimd+1261j ...
		cmp	word ptr g_dwZCounter+2, 1Dh
		jl	short loc_471_192A
		jg	short loc_471_191C
		cmp	word ptr g_dwZCounter, 0F100h
		jbe	short loc_471_192A

loc_471_191C:				; CODE XREF: TrkPlanSimd+1280j
		mov	word ptr g_dwZCounter, 0F0FFh
		mov	word ptr g_dwZCounter+2, 1Dh
		jmp	short loc_471_1947
; ---------------------------------------------------------------------------

loc_471_192A:				; CODE XREF: TrkPlanSimd+127Ej
					; TrkPlanSimd+1288j
		cmp	word ptr g_dwZCounter+2, 0
		jg	short loc_471_1947
		jl	short loc_471_193B
		cmp	word ptr g_dwZCounter, 0F00h
		jnb	short loc_471_1947

loc_471_193B:				; CODE XREF: TrkPlanSimd+129Fj
		mov	word ptr g_dwZCounter, 0F00h
		mov	word ptr g_dwZCounter+2, 0

loc_471_1947:				; CODE XREF: TrkPlanSimd+1296j
					; TrkPlanSimd+129Dj ...
		mov	ax, [bp+var_1DE.wX+12h]
		add	ax, [bp+var_1DE.wX+0Ch]
		sub	ax, [bp+var_1DE.wX]
		sub	ax, [bp+var_1DE.wX+6]
		mov	[bp+wAngle], ax
		mov	ax, [bp+var_1DE.wZ+12h]
		add	ax, [bp+var_1DE.wZ+0Ch]
		sub	ax, [bp+var_1DE.wZ]
		sub	ax, [bp+var_1DE.wZ+6]
		mov	[bp+wAngleX], ax
		neg	ax
		push	ax
		push	[bp+wAngle]
		call	GetAngleFromXZ
		add	sp, 4
		and	ah, 3
		mov	g_wPoly2Code, ax
		push	ax
		lea	ax, [bp+mat2]
		push	ax
		call	MatRotateY
		add	sp, 4
		mov	[bp+cCounter], 0

loc_471_1997:				; CODE XREF: TrkPlanSimd+1345j
		mov	al, [bp+cCounter]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, bp
		sub	di, 1DEh
		push	si
		push	di
		mov	si, di
		lea	di, [bp+vec1]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		push	di
		lea	ax, [bp+mat2]
		push	ax
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		inc	[bp+cCounter]
		cmp	[bp+cCounter], 4
		jl	short loc_471_1997
		mov	ax, [bp+var_1DE.wZ+12h]
		add	ax, [bp+var_1DE.wZ+0Ch]
		sub	ax, [bp+var_1DE.wZ]
		sub	ax, [bp+var_1DE.wZ+6]
		mov	[bp+wAngleX], ax
		mov	ax, [bp+var_1DE.wY+12h]
		add	ax, [bp+var_1DE.wY+0Ch]
		sub	ax, [bp+var_1DE.wY]
		sub	ax, [bp+var_1DE.wY+6]
		mov	[bp+wAngleZ], ax
		or	ax, ax
		jnz	short loc_471_1A0C
		cmp	[bp+wAngleX], 0
		jl	short loc_471_1A36

loc_471_1A0C:				; CODE XREF: TrkPlanSimd+1371j
		push	[bp+wAngleZ]
		mov	ax, [bp+wAngleX]
		neg	ax
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		sub	ax, 100h
		mov	g_wTrkPlanAngle, ax
		or	ax, ax
		jge	short loc_471_1A2E
		neg	ax
		jmp	short loc_471_1A31
; ---------------------------------------------------------------------------
		nop

loc_471_1A2E:				; CODE XREF: TrkPlanSimd+1395j
		mov	ax, g_wTrkPlanAngle

loc_471_1A31:				; CODE XREF: TrkPlanSimd+1399j
		cmp	ax, 2
		jge	short loc_471_1A3C

loc_471_1A36:				; CODE XREF: TrkPlanSimd+1378j
		mov	g_wTrkPlanAngle, 0

loc_471_1A3C:				; CODE XREF: TrkPlanSimd+13A2j
		cmp	g_wTrkPlanAngle, 0
		jz	short loc_471_1A9B
		push	g_wTrkPlanAngle
		lea	ax, [bp+mat2]
		push	ax
		call	MatRotateX
		add	sp, 4
		mov	[bp+cCounter], 0

loc_471_1A59:				; CODE XREF: TrkPlanSimd+1407j
		mov	al, [bp+cCounter]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, bp
		sub	di, 1DEh
		push	si
		push	di
		mov	si, di
		lea	di, [bp+vec1]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		push	di
		lea	ax, [bp+mat2]
		push	ax
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		inc	[bp+cCounter]
		cmp	[bp+cCounter], 4
		jl	short loc_471_1A59

loc_471_1A9B:				; CODE XREF: TrkPlanSimd+13AFj
		mov	ax, [bp+var_1DE.wX+6]
		add	ax, [bp+var_1DE.wX+0Ch]
		sub	ax, [bp+var_1DE.wX]
		sub	ax, [bp+var_1DE.wX+12h]
		mov	[bp+wAngleX], ax
		mov	ax, [bp+var_1DE.wY+6]
		add	ax, [bp+var_1DE.wY+0Ch]
		sub	ax, [bp+var_1DE.wY]
		sub	ax, [bp+var_1DE.wY+12h]
		mov	[bp+wAngleZ], ax
		or	ax, ax
		jnz	short loc_471_1ACE
		cmp	[bp+wAngleX], 0
		jg	short loc_471_1AF4

loc_471_1ACE:				; CODE XREF: TrkPlanSimd+1433j
		push	[bp+wAngleZ]
		push	[bp+wAngleX]
		call	GetAngleFromXZ
		add	sp, 4
		sub	ax, 100h
		mov	g_wSomeAngle, ax
		or	ax, ax
		jge	short loc_471_1AEC
		neg	ax
		jmp	short loc_471_1AEF
; ---------------------------------------------------------------------------

loc_471_1AEC:				; CODE XREF: TrkPlanSimd+1454j
		mov	ax, g_wSomeAngle

loc_471_1AEF:				; CODE XREF: TrkPlanSimd+1458j
		cmp	ax, 2
		jge	short loc_471_1AFA

loc_471_1AF4:				; CODE XREF: TrkPlanSimd+143Aj
		mov	g_wSomeAngle, 0

loc_471_1AFA:				; CODE XREF: TrkPlanSimd+1460j
		mov	bx, [bp+p_pCvx2]
		mov	di, bx
		mov	al, [di+CarState.cSurfaceGripIndex1]
		add	al, [di+CarState.cSurfaceGripIndex2]
		mov	[bx+CarState.field_BF],	al
		mov	bx, [bp+p_pCvx2]
		mov	di, bx
		mov	al, [di+CarState.cSurfaceGripIndex3]
		add	al, [di+CarState.cSurfaceGripIndex4]
		mov	[bx+CarState.field_C0],	al
		cmp	gameState.cCvxFlag2, 2
		jnz	short loc_471_1B26
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_1B26:				; CODE XREF: TrkPlanSimd+148Fj
		cmp	g_cGameFlag2, 0
		jnz	short loc_471_1B4F
		cmp	[bp+arg_8], 0
		jz	short loc_471_1B3A
		push	g_wSfxOppEngResul
		jmp	short loc_471_1B3E
; ---------------------------------------------------------------------------
		nop

loc_471_1B3A:				; CODE XREF: TrkPlanSimd+149Fj
		push	g_wSfxEng1Resul

loc_471_1B3E:				; CODE XREF: TrkPlanSimd+14A5j
		mov	bx, [bp+p_pCvx2]
		mov	al, [bx+CarState.field_CF]
		sub	ah, ah
		push	ax
		push	cs
		call	near ptr DoAudioOp1_2
		add	sp, 4

loc_471_1B4F:				; CODE XREF: TrkPlanSimd+1499j
		sub	ax, ax
		push	ax
		mov	ax, g_wPoly2Code
		neg	ax
		push	ax
		mov	ax, g_wTrkPlanAngle
		neg	ax
		push	ax
		mov	ax, g_wSomeAngle
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix3], ax
		mov	[bp+cCounter], 0
		jmp	loc_471_1C1C
; ---------------------------------------------------------------------------

loc_471_1B78:				; CODE XREF: TrkPlanSimd+1679j
		mov	ax, g_wPlanIndex
		mov	[bp+wCurPlanIndex], ax
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		push	si
		lea	si, [bx+di+CarState.arrVecUnk2]
		lea	di, [bp+vec4]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		lea	ax, [bp+vec6]
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	TrkTerrainWall
		add	sp, 4
		mov	ax, g_wPlanIndex
		cmp	[bp+wCurPlanIndex], ax
		jnz	short loc_471_1BF9
		push	[bp+vec4.wZ]
		push	[bp+vec4.wY]
		push	[bp+vec4.wX]
		push	ax
		push	cs
		call	near ptr PlaneOriginOp
		add	sp, 8
		mov	[bp+wPlaneOrignOpResult], ax
		cmp	g_cGameMode2, 1
		jz	short loc_471_1BF9
		or	si, si
		jge	short loc_471_1BDE
		or	ax, ax
		jg	short loc_471_1BE9

loc_471_1BDE:				; CODE XREF: TrkPlanSimd+1546j
		or	si, si
		jle	short loc_471_1BF9
		cmp	[bp+wPlaneOrignOpResult], 0
		jge	short loc_471_1BF9

loc_471_1BE9:				; CODE XREF: TrkPlanSimd+154Aj
					; TrkPlanSimd:loc_471_1D15j
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 5
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_1BF9:				; CODE XREF: TrkPlanSimd+1523j
					; TrkPlanSimd+1542j ...
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, ax
		shl	di, 1
		mov	bx, [bp+p_pCvx2]
		push	si
		lea	di, [bx+di+CarState.arrVecUnk2]
		lea	si, [bp+vec6]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		pop	si
		inc	[bp+cCounter]

loc_471_1C1C:				; CODE XREF: TrkPlanSimd+14E3j
		cmp	[bp+cCounter], 4
		jl	short loc_471_1C26
		jmp	loc_471_1D18
; ---------------------------------------------------------------------------

loc_471_1C26:				; CODE XREF: TrkPlanSimd+158Fj
		mov	al, [bp+cCounter]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, ax
		shl	di, 1
		mov	bx, [bp+p_pSimd2]
		push	si
		lea	si, [bx+di+CarInfoSimd.vecWheelCoords]
		lea	di, [bp+vec4]
		push	ss
		pop	es
		assume es:nothing
		movsw
		movsw
		movsw
		pop	si
		mov	bx, [bp+p_pSimd2]
		mov	ax, [bx+CarInfoSimd.ptCollide.y]
		mov	cl, 6
		shl	ax, cl
		mov	[bp+vec4.wY], ax
		lea	ax, [bp+vec1]
		push	ax
		push	[bp+pMatrix3]
		lea	ax, [bp+vec4]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec1.wX]
		cwd
		add	ax, word ptr g_dwXCounter
		adc	dx, word ptr g_dwXCounter+2
		mov	cl, 6

loc_471_1C79:				; CODE XREF: TrkPlanSimd+15EDj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1C79
		mov	[bp+vec4.wX], ax
		mov	ax, [bp+vec1.wY]
		cwd
		add	ax, word ptr g_dwYCounter
		adc	dx, word ptr g_dwYCounter+2
		mov	cl, 6

loc_471_1C94:				; CODE XREF: TrkPlanSimd+1608j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1C94
		mov	[bp+vec4.wY], ax
		mov	ax, [bp+vec1.wZ]
		cwd
		add	ax, word ptr g_dwZCounter
		adc	dx, word ptr g_dwZCounter+2
		mov	cl, 6

loc_471_1CAF:				; CODE XREF: TrkPlanSimd+1623j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1CAF
		mov	[bp+vec4.wZ], ax
		push	si
		lea	di, [bp+vec6]
		lea	si, [bp+vec4]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		mov	al, [bp+cCounter]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+p_pCvx2]
		add	ax, CarState.arrVecUnk2
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	TrkTerrainWall	; updates g_dwSomeX, g_dwSomeZ,	g_dwCopysomeX and g_dwCopySomeZ
		add	sp, 4
		push	[bp+vec4.wZ]
		push	[bp+vec4.wY]
		push	[bp+vec4.wX]
		push	g_wPlanIndex
		push	cs
		call	near ptr PlaneOriginOp ; uses g_dwSomeX, g_dwSomeZ, g_dwSomeY
		add	sp, 8
		mov	si, ax
		cmp	g_wPlanIndex, 4
		jl	short loc_471_1D0E
		jmp	loc_471_1B78
; ---------------------------------------------------------------------------

loc_471_1D0E:				; CODE XREF: TrkPlanSimd+1677j
		or	si, si
		jle	short loc_471_1D15
		jmp	loc_471_1BF9
; ---------------------------------------------------------------------------

loc_471_1D15:				; CODE XREF: TrkPlanSimd+167Ej
		jmp	loc_471_1BE9
; ---------------------------------------------------------------------------

loc_471_1D18:				; CODE XREF: TrkPlanSimd+1591j
		mov	bx, [bp+p_pCvx2]
		mov	al, [bx+CarState.field_BF]
		add	al, [bx+CarState.field_C0]
		mov	[bp+var_11C], al
		cmp	[bp+arg_8], 0
		jnz	short loc_471_1D3C
		or	al, al
		jnz	short loc_471_1D3C
		cmp	[bx+CarState.field_C1],	0
		jz	short loc_471_1D3C
		inc	gameState.field_150

loc_471_1D3C:				; CODE XREF: TrkPlanSimd+1699j
					; TrkPlanSimd+169Dj ...
		mov	al, [bp+var_11C]
		mov	[bx+CarState.field_C1],	al
		mov	ax, word ptr g_dwXCounter
		mov	dx, word ptr g_dwXCounter+2
		mov	cl, 6

loc_471_1D4D:				; CODE XREF: TrkPlanSimd+16C1j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1D4D
		mov	[bp+vec9.wX], ax
		mov	ax, word ptr g_dwYCounter
		mov	dx, word ptr g_dwYCounter+2
		mov	cl, 6

loc_471_1D62:				; CODE XREF: TrkPlanSimd+16D6j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1D62
		mov	[bp+vec9.wY], ax
		mov	ax, word ptr g_dwZCounter
		mov	dx, word ptr g_dwZCounter+2
		mov	cl, 6

loc_471_1D77:				; CODE XREF: TrkPlanSimd+16EBj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1D77
		mov	[bp+vec9.wZ], ax
		mov	ax, g_wSomeAngle
		mov	[bp+vecAngles.wX], ax
		mov	ax, g_wTrkPlanAngle
		mov	[bp+vecAngles.wY], ax
		mov	ax, g_wPoly2Code
		mov	[bp+vecAngles.wZ], ax
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_471_1DA2
		jmp	loc_471_1E68
; ---------------------------------------------------------------------------

loc_471_1DA2:				; CODE XREF: TrkPlanSimd+170Bj
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwX]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwX+2)]
		mov	cl, 6

loc_471_1DAC:				; CODE XREF: TrkPlanSimd+1720j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1DAC
		mov	[bp+vec7.wX], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwY]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwY+2)]
		mov	cl, 6

loc_471_1DC3:				; CODE XREF: TrkPlanSimd+1737j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1DC3
		mov	[bp+vec7.wY], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwZ]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwZ+2)]
		mov	cl, 6

loc_471_1DDA:				; CODE XREF: TrkPlanSimd+174Ej
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_1DDA
		mov	[bp+vec7.wZ], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.vecRotate.wZ]
		mov	[bp+vec8.wX], ax
		mov	ax, [bx+CarState.vecRotate.wY]
		mov	[bp+vec8.wY], ax
		mov	ax, [bx+CarState.vecRotate.wX]
		mov	[bp+vec8.wZ], ax
		lea	ax, [bp+vec7]
		push	ax
		mov	ax, [bp+p_pSimd]
		add	ax, CarInfoSimd.ptCollide
		push	ax
		lea	ax, [bp+vec9]
		push	ax
		mov	ax, [bp+p_pSimd2]
		add	ax, CarInfoSimd.ptCollide
		push	ax
		push	cs
		call	near ptr CheckCarCollider
		add	sp, 8
		or	al, al
		jz	short loc_471_1E68
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+CarState.field_C8],	0
		jz	short loc_471_1E2E
		jmp	loc_471_2182
; ---------------------------------------------------------------------------

loc_471_1E2E:				; CODE XREF: TrkPlanSimd+1797j
		push	[bp+p_pCvx]
		push	bx
		push	cs
		call	near ptr CompareUpdate2Cvx
		add	sp, 4
		or	al, al
		jnz	short loc_471_1E40
		jmp	loc_471_2182
; ---------------------------------------------------------------------------

loc_471_1E40:				; CODE XREF: TrkPlanSimd+17A9j
		mov	al, [bp+arg_8]
		cbw
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4
		mov	al, [bp+arg_8]
		cbw
		xor	al, 1

loc_471_1E56:				; CODE XREF: TrkPlanSimd+18AAj
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_471_1E68:				; CODE XREF: TrkPlanSimd+170Dj
					; TrkPlanSimd+178Dj
		mov	ax, [bp+vec9.wX]
		mov	cl, 0Ah
		sar	ax, cl
		mov	[bp+vec1.wX], ax
		mov	ax, [bp+vec9.wZ]
		sar	ax, cl
		sub	ax, 1Dh
		neg	ax
		mov	[bp+vec1.wZ], ax
		mov	[bp+vec8.wX], 0
		mov	[bp+vec8.wY], 0
		mov	[bp+vec8.wZ], 0
		cmp	[bp+vec1.wX], 0
		jge	short loc_471_1E9F
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_1E9F:				; CODE XREF: TrkPlanSimd+1808j
		cmp	[bp+vec1.wX], 1Eh
		jl	short loc_471_1EA9
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_1EA9:				; CODE XREF: TrkPlanSimd+1812j
		or	ax, ax
		jge	short loc_471_1EB0
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_1EB0:				; CODE XREF: TrkPlanSimd+1819j
		cmp	ax, 1Eh
		jl	short loc_471_1EB8
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_1EB8:				; CODE XREF: TrkPlanSimd+1821j
		lea	ax, [bp+vecs]
		push	ax
		push	[bp+vec1.wZ]
		push	[bp+vec1.wX]
		call	ZXTrakdata14Shape
		add	sp, 6
		mov	[bp+var_EC], al
		or	al, al
		jz	short loc_471_1F40
		sub	si, si
		jmp	short loc_471_1EE0
; ---------------------------------------------------------------------------
		nop

loc_471_1EDA:				; CODE XREF: TrkPlanSimd+189Cj
		add	[bp+var_144], 6
		inc	si

loc_471_1EE0:				; CODE XREF: TrkPlanSimd+1845j
		mov	al, [bp+var_EC]
		sub	ah, ah
		cmp	ax, si
		jbe	short loc_471_1F40
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, bp
		mov	ax, [di+vecs.wX]
		mov	[bp+vec7.wX], ax
		mov	ax, [di+vecs.wY]
		mov	[bp+vec7.wY], ax
		mov	ax, [di+vecs.wZ]
		mov	[bp+vec7.wZ], ax
		lea	ax, [bp+vec7]
		push	ax
		mov	ax, offset g_ptCollide1
		push	ax
		lea	ax, [bp+vec9]
		push	ax
		mov	ax, [bp+p_pSimd2]
		add	ax, CarInfoSimd.ptCollide
		push	ax
		push	cs
		call	near ptr CheckCarCollider
		add	sp, 8
		or	al, al
		jz	short loc_471_1EDA
		mov	bx, [bp+p_pCvx2]
		sub	[bx+CarState.field_36],	200h

loc_471_1F38:				; CODE XREF: TrkPlanSimd+1A9Bj
		mov	al, [bp+arg_8]
		cbw
		jmp	loc_471_1E56
; ---------------------------------------------------------------------------
		nop

loc_471_1F40:				; CODE XREF: TrkPlanSimd+1841j
					; TrkPlanSimd+1856j
		mov	bx, [bp+vec1.wZ]
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		add	bx, [bp+vec1.wX]
		les	di, g_ppTrakdata19
		mov	al, es:[bx+di]
		cbw
		mov	si, ax
		cmp	si, 0FFFFh
		jnz	short loc_471_1F60
		jmp	loc_471_2000
; ---------------------------------------------------------------------------

loc_471_1F60:				; CODE XREF: TrkPlanSimd+18C9j
		cmp	gameState.field_3FA[si], 0
		jz	short loc_471_1F6A
		jmp	loc_471_2000
; ---------------------------------------------------------------------------

loc_471_1F6A:				; CODE XREF: TrkPlanSimd+18D3j
		mov	bx, si
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		les	di, g_ppTrakdata10
		mov	ax, es:[bx+di]
		mov	[bp+vec7.wX], ax
		mov	di, si
		mov	ax, di
		shl	di, 1
		add	di, ax
		shl	di, 1
		mov	bx, word ptr g_ppTrakdata10
		mov	ax, es:[bx+di+2]
		mov	[bp+vec7.wY], ax
		mov	di, si
		mov	ax, di
		shl	di, 1
		add	di, ax
		shl	di, 1
		mov	ax, es:[bx+di+4]
		mov	[bp+vec7.wZ], ax
		lea	ax, [bp+vec7]	; two vectors accessed from this
		push	ax
		mov	ax, offset g_ptCollide2
		push	ax
		lea	ax, [bp+vec9]	; two vectors are accessed from	this
		push	ax
		mov	ax, [bp+p_pSimd2]
		add	ax, CarInfoSimd.ptCollide
		push	ax
		push	cs
		call	near ptr CheckCarCollider ; accesses two vectors in each of the	vector arguments
		add	sp, 8
		or	al, al
		jz	short loc_471_2000
		mov	gameState.field_3FA[si], 1
		mov	ax, 3C00h
		cwd
		push	dx
		push	ax
		mov	ax, 580h
		cwd
		push	dx
		push	ax
		mov	bx, [bp+p_pCvx2]
		sub	ax, ax
		push	ax
		push	[bx+CarState.wTrackGrip2]
		call	__aFlmul
		push	dx
		push	ax
		call	__aFuldiv
		push	ax
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.vecRotate.wX]
		neg	ax
		push	ax
		lea	ax, [si+2]
		push	ax
		push	cs
		call	near ptr SetMegaTemplVecLong
		add	sp, 6

loc_471_2000:				; CODE XREF: TrkPlanSimd+18CBj
					; TrkPlanSimd+18D5j ...
		mov	al, g_cStartCol2
		cbw
		mov	di, ax
		cmp	[bp+vec1.wX], di
		jz	short loc_471_200F
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_200F:				; CODE XREF: TrkPlanSimd+1978j
		mov	al, g_cStartRow2
		cbw
		cmp	[bp+vec1.wZ], ax
		jz	short loc_471_201C
		jmp	loc_471_2130
; ---------------------------------------------------------------------------

loc_471_201C:				; CODE XREF: TrkPlanSimd+1985j
		mov	ax, 7Eh	; '~'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 1
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, di
		shl	bx, 1
		mov	cx, g_wMoreTrkCenPo[bx]
		add	cx, ax
		mov	[bp+vec7.wX], cx
		mov	al, byte_2B77_922B
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word_2B77_178[bx]
		mov	[bp+vec7.wY], ax
		mov	ax, 7Eh	; '~'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 1
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, ax
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		add	cx, word ptr g_wTrackCenPos[bx]
		mov	[bp+vec7.wZ], cx
		lea	ax, [bp+vec7]
		push	ax
		mov	ax, offset g_ptCollide3
		push	ax
		lea	ax, [bp+vec9]
		push	ax
		mov	ax, [bp+p_pSimd2]
		add	ax, CarInfoSimd.ptCollide
		push	ax
		push	cs
		call	near ptr CheckCarCollider
		add	sp, 8
		cbw
		mov	[bp+wPlaneOrignOpResult], ax
		or	ax, ax
		jnz	short loc_471_2126
		mov	ax, 7Eh	; '~'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 3
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		add	cx, g_wMoreTrkCenPo[bx]
		mov	[bp+vec7.wX], cx
		mov	ax, 7Eh	; '~'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 3
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, ax
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		add	cx, word ptr g_wTrackCenPos[bx]
		mov	[bp+vec7.wZ], cx
		lea	ax, [bp+vec7]
		push	ax
		mov	ax, offset g_ptCollide3
		push	ax
		lea	ax, [bp+vec9]
		push	ax
		mov	ax, [bp+p_pSimd2]
		add	ax, CarInfoSimd.ptCollide
		push	ax
		push	cs
		call	near ptr CheckCarCollider
		add	sp, 8
		cbw
		mov	[bp+wPlaneOrignOpResult], ax

loc_471_2126:				; CODE XREF: TrkPlanSimd+1A15j
		cmp	[bp+wPlaneOrignOpResult], 0
		jz	short loc_471_2130
		jmp	loc_471_1F38
; ---------------------------------------------------------------------------

loc_471_2130:				; CODE XREF: TrkPlanSimd+1491j
					; TrkPlanSimd+180Aj ...
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr g_dwXCounter
		mov	dx, word ptr g_dwXCounter+2
		mov	word ptr [bx+CarState.vecLongUnk.dwX], ax
		mov	word ptr [bx+(CarState.vecLongUnk.dwX+2)], dx
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr g_dwYCounter
		mov	dx, word ptr g_dwYCounter+2
		mov	word ptr [bx+CarState.vecLongUnk.dwY], ax
		mov	word ptr [bx+(CarState.vecLongUnk.dwY+2)], dx
		mov	bx, [bp+p_pCvx2]
		mov	ax, word ptr g_dwZCounter
		mov	dx, word ptr g_dwZCounter+2
		mov	word ptr [bx+CarState.vecLongUnk.dwZ], ax
		mov	word ptr [bx+(CarState.vecLongUnk.dwZ+2)], dx
		mov	bx, [bp+p_pCvx2]
		mov	ax, g_wSomeAngle
		mov	[bx+CarState.vecRotate.wZ], ax
		mov	bx, [bp+p_pCvx2]
		mov	ax, g_wTrkPlanAngle
		mov	[bx+CarState.vecRotate.wY], ax
		mov	bx, [bp+p_pCvx2]
		mov	ax, g_wPoly2Code
		mov	[bx+CarState.vecRotate.wX], ax
		mov	bx, [bp+p_pCvx2]
		mov	[bx+CarState.field_C8],	0

loc_471_2182:				; CODE XREF: TrkPlanSimd+1799j
					; TrkPlanSimd+17ABj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TrkPlanSimd	endp


; InitSomethingFromSimd	initi8alizes a struct of size 0xD0 passed in arg0


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitCvxWithSimd	proc far		; CODE XREF: InitGameState+2BAp
					; InitGameState+3F0p ...

var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
vec		= Vector3D ptr -0Ah
p_pCvx		= word ptr  6
p_pSimd		= word ptr  8
p_cTransmission	= byte ptr  0Ah
p_pVecLong	= VectorLong3D ptr  0Ch
p_wRotX		= word ptr  18h

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		sub	si, si
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bp+p_pVecLong.dwX]
		mov	dx, word ptr [bp+p_pVecLong.dwX+2]
		mov	word ptr [bx+CarState.vecLongUnk.dwX], ax
		mov	word ptr [bx+(CarState.vecLongUnk.dwX+2)], dx
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bp+p_pVecLong.dwX]
		mov	dx, word ptr [bp+p_pVecLong.dwX+2]
		mov	word ptr [bx+CarState.vecLongUnk2.dwX],	ax
		mov	word ptr [bx+(CarState.vecLongUnk2.dwX+2)], dx
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bp+p_pVecLong.dwY]
		mov	dx, word ptr [bp+p_pVecLong.dwY+2]
		add	ax, 200h
		adc	dx, si
		mov	word ptr [bx+CarState.vecLongUnk.dwY], ax
		mov	word ptr [bx+(CarState.vecLongUnk.dwY+2)], dx
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bp+p_pVecLong.dwY]
		mov	dx, word ptr [bp+p_pVecLong.dwY+2]
		mov	word ptr [bx+CarState.vecLongUnk2.dwY],	ax
		mov	word ptr [bx+(CarState.vecLongUnk2.dwY+2)], dx
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bp+p_pVecLong.dwZ]
		mov	dx, word ptr [bp+p_pVecLong.dwZ+2]
		mov	word ptr [bx+CarState.vecLongUnk.dwZ], ax
		mov	word ptr [bx+(CarState.vecLongUnk.dwZ+2)], dx
		mov	bx, [bp+p_pCvx]
		mov	ax, word ptr [bp+p_pVecLong.dwZ]
		mov	dx, word ptr [bp+p_pVecLong.dwZ+2]
		mov	word ptr [bx+CarState.vecLongUnk2.dwZ],	ax
		mov	word ptr [bx+(CarState.vecLongUnk2.dwZ+2)], dx
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+p_wRotX]
		mov	[bx+CarState.vecRotate.wX], ax
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.vecRotate.wY], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.vecRotate.wZ], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_36],	si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_1E],	si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_20],	si
		mov	bx, [bp+p_pCvx]
		sub	al, al
		mov	[bx+CarState.cIsBraking], al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.cIsAccelerating], al
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+CarInfoSimd.wIdleRpm]
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wCurRpm], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.wCurRpm]
		mov	[bx+CarState.wLastRpm],	ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.wCurRpm]
		mov	[bx+CarState.wIdleRpm2], ax
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.cCurrentGear], 1
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wGripDiff], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip2], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wLastTrackGrip], si
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+(CarInfoSimd.dwGearRatios+2)]
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wGearRatio], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.wGearRatio]
		mov	cl, 8
		shr	ax, cl
		mov	[bx+CarState.wGearRatioShr8], ax
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+(CarInfoSimd.arrPtKnobs.x+4)]
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wKnobX], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.wKnobX]
		mov	[bx+CarState.wKnobX2], ax
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+(CarInfoSimd.arrPtKnobs.y+4)]
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wKnobY], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.wKnobY]
		mov	[bx+CarState.wKnobY2], ax
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wAngleZ], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_40],	si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_42],	si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_48],	si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrakdata3Index], si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_BF],	2
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C0],	2
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C1],	4
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_44],	si
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wSurfaceGripSum], 3E8h ; 1000
		mov	ax, word ptr [bp+p_pVecLong.dwX]
		mov	dx, word ptr [bp+p_pVecLong.dwX+2]
		mov	cl, 6

loc_471_22F4:				; CODE XREF: InitCvxWithSimd+172j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_22F4


		mov	[bp+vec.wX], ax
		mov	ax, word ptr [bp+p_pVecLong.dwY]
		mov	dx, word ptr [bp+p_pVecLong.dwY+2]
		mov	cl, 6

loc_471_2307:				; CODE XREF: InitCvxWithSimd+185j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2307
		mov	[bp+vec.wY], ax
		mov	ax, word ptr [bp+p_pVecLong.dwZ]
		mov	dx, word ptr [bp+p_pVecLong.dwZ+2]
		mov	cl, 6

loc_471_231A:				; CODE XREF: InitCvxWithSimd+198j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_231A
		mov	[bp+vec.wZ], ax
		sub	di, di

; di is	< 4
; 4c, 54, 5c etc are 8 bytes each, and accessed	at di *	2

loc_471_2327:				; CODE XREF: InitCvxWithSimd+213j
		mov	bx, [bp+p_pCvx]
		mov	[bx+di+CarState.cSurfaceGripIndex1], 1
		mov	ax, di
		shl	ax, 1
		mov	[bp+var_C], ax
		mov	bx, [bp+p_pCvx]
		add	bx, ax		; make relative	to pCvx+var_c
		mov	[bx+CarState.rc1.dwLeft], si
		mov	bx, [bp+p_pCvx]
		add	bx, [bp+var_C]
		mov	[bx+CarState.rc2.dwLeft], si
		mov	bx, [bp+p_pCvx]
		add	bx, [bp+var_C]
		mov	[bx+CarState.rc3.dwLeft], si
		mov	bx, [bp+p_pCvx]
		add	bx, [bp+var_C]
		mov	[bx+CarState.rc4.dwLeft], si
		mov	bx, [bp+p_pCvx]
		add	bx, [bp+var_C]
		mov	[bx+CarState.rc5.dwLeft], si
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_E], ax
		mov	bx, [bp+p_pCvx]
		add	bx, ax
		push	si
		push	di
		lea	di, [bx+CarState.vecUnk1]
		lea	si, [bp+vec]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, [bp+p_pCvx]
		add	bx, [bp+var_E]	; var_e	is divisable by	6 - = sizeof (vector), so .. var2 is an	array of vectors?
		push	si
		push	di
		lea	di, [bx+CarState.arrVecUnk2] ; vecUnk2 = 4 vectors
		lea	si, [bp+vec]
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	di
		cmp	di, 4
		jl	short loc_471_2327


		mov	bx, [bp+p_pCvx]
		mov	ax, si
		mov	[bx+CarState.field_C6],	al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C7],	al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C8],	al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C9],	al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.cChangingGear], al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.cFpsMul2],	al
		mov	bx, [bp+p_pCvx]
		mov	al, [bp+p_cTransmission]
		mov	[bx+CarState.cTransmission], al
		mov	bx, [bp+p_pCvx]
		mov	ax, si
		mov	[bx+CarState.field_CD],	al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_CE],	al
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_CF],	1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InitCvxWithSimd	endp

; ---------------------------------------------------------------------------
		nop
arg_0 =
    0xFFFF - reset 30-sec megastruct replay state buffer
    0xFFFE - does not call DoSomeTrakData()
    0xFFFD - only reset	fps-dependant variables


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitGameState	proc far		; CODE XREF: _main+3C0P
					; RunTracksMenu+81P ...

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		sub	si, si
		cmp	[bp+arg_0], 0FFFFh
		jnz	short loc_471_243D
		mov	g_wResetOnCvxTr, si
		sub	di, di

; this loops writes a zero-byte	to 20 megacvxtemplate structs
; only if the passed argument is 0xFFFF

loc_471_2408:				; CODE XREF: InitGameState+49j
		mov	ax, 460h
		cwd
		push	dx
		push	ax
		mov	ax, di
		cwd
		push	dx
		push	ax
		call	__aFlmul	; counter * 460h (1120)
		add	ax, GameState.cCvxFlag1	; 1012
		adc	dx, 0
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl		; shl 12 ?? segment thingy?
		add	dx, word ptr g_dwCvxBytes+2
		mov	es, dx
		assume es:nothing
		mov	bx, ax
		mov	ax, si
		mov	es:[bx], al	; write	0 to somewhere,	maybe at offset	1012 of	each chunk
		inc	di
		cmp	di, 14h		; di = counter,	goes to	20
		jl	short loc_471_2408

loc_471_243D:				; CODE XREF: InitGameState+Ej
		cmp	g_wFramesPerSec, 0Ah
		jnz	short loc_471_244C
		mov	g_wCvxTimerFlag, offset	unk_2B77_64A
		jmp	short loc_471_2452
; ---------------------------------------------------------------------------

loc_471_244C:				; CODE XREF: InitGameState+50j
		mov	g_wCvxTimerFlag, offset	unk_2B77_60A

loc_471_2452:				; CODE XREF: InitGameState+58j
		mov	ax, 1Eh
		imul	g_wFramesPerSec
		mov	g_wFpsMul1Eh, ax
		mov	ax, 64h
		cwd
		mov	cx, g_wFramesPerSec
		idiv	cx
		mov	g_w64hDivFps, ax
		cmp	[bp+arg_0], 0FFFDh
		jnz	short loc_471_2472
		jmp	_lblEndFuncLast	; if arg0 is 0xfffd then end now
; ---------------------------------------------------------------------------

loc_471_2472:				; CODE XREF: InitGameState+7Bj
		call	InitSomeVars
		mov	gameState.cCvxFlag1, 1
		mov	gameState.wFramesPerSec, 1
		mov	ax, si
		mov	gameState.cCvxFlag2, al
		mov	gameState.cCvxFlag3, al
		mov	gameState.wFrameInSec, si
		mov	gameState.wCvxFlag3, si
		mov	gameState.cCvxFlag4, al
		mov	gameState.cCvxFlag5, al
		mov	di, si
		jmp	short loc_471_24A3
; ---------------------------------------------------------------------------

; this loop sets field_3fa[counter] to 0 (si)

loc_471_249C:				; CODE XREF: InitGameState+B4j
		mov	ax, si
		mov	gameState.field_3FA[di], al
		inc	di

loc_471_24A3:				; CODE XREF: InitGameState+A8j
		cmp	di, 30h		; loop goes to 30h
		jl	short loc_471_249C


		mov	di, si
		jmp	short loc_471_24B5
; ---------------------------------------------------------------------------

; this loop sets field_38e[counter] to 0

loc_471_24AC:				; CODE XREF: InitGameState+C6j
		mov	bx, di
		shl	bx, 1
		mov	word ptr gameState.field_38E[bx], si
		inc	di

loc_471_24B5:				; CODE XREF: InitGameState+B8j
		cmp	di, 18h		; loop goes to 18h
		jl	short loc_471_24AC


		mov	ax, 200h
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 3
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 1000h
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 2
		push	cx
		mov	[bp+var_A], ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, [bp+var_A]
		mov	cx, ax
		mov	al, g_cStartCol2
		cbw
		mov	dx, cx
		mov	cl, 0Ah
		shl	ax, cl
		add	dx, ax
		mov	gameState.vec1.wX, dx
		mov	al, byte_2B77_922B
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word_2B77_178[bx]
		add	ax, 3C0h
		mov	gameState.vec1.wY, ax
		mov	ax, 200h
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 3
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 1000h
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 2
		push	cx
		mov	[bp+var_A], ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, ax
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		add	cx, g_wTrackPos[bx]
		add	cx, [bp+var_A]
		mov	gameState.vec1.wZ, cx
		push	si
		push	di
		mov	di, offset gameState.vec2
		mov	si, offset gameState.vec1
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		pop	di
		pop	si
		push	si
		push	di
		mov	di, offset gameState.vec3
		mov	si, offset gameState.vec1
		movsw
		movsw
		movsw
		pop	di
		pop	si
		push	si
		push	di
		mov	di, offset gameState.vec4
		mov	si, offset gameState.vec1
		movsw
		movsw
		movsw
		pop	di
		pop	si
		sub	ax, ax
		mov	gameState.field_13E, ax
		mov	gameState.field_13C, ax
		mov	gameState.wGameFrame, si
		mov	gameState.field_142, si
		mov	gameState.field_144, si
		mov	gameState.field_146, si
		mov	gameState.wGameFrame2, si
		mov	gameState.wFramesPerSecCounter,	si
		mov	gameState.field_14C, si
		mov	gameState.field_14E, si
		mov	gameState.field_150, si
		mov	ax, 0D2h ; 'Ò'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 2
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 24h	; '$'
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 1
		push	cx
		mov	[bp+var_A], ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, [bp+var_A]
		mov	[bp+var_8], ax
		mov	ax, 0D2h ; 'Ò'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 2
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 24h	; '$'
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 1
		push	cx
		mov	[bp+var_A], ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, [bp+var_A]
		mov	[bp+var_2], ax
		mov	ax, g_wUseTrkInRpl
		neg	ax
		push	ax
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		add	ax, [bp+var_2]
		cwd
		mov	cl, 6

loc_471_265F:				; CODE XREF: InitGameState+273j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_265F ; loop 6 times


		push	dx
		push	ax
		mov	al, byte_2B77_922B
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, [bx+178h]
		cwd
		mov	cl, 6

loc_471_2678:				; CODE XREF: InitGameState+28Cj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_2678 ; loop 6 times


		push	dx
		push	ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		add	ax, [bp+var_8]
		cwd
		mov	cl, 6

loc_471_2694:				; CODE XREF: InitGameState+2A8j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_2694 ; loop 6 times


		push	dx
		push	ax
		mov	al, g_gameInfo.cPlayerTransmission
		cbw
		push	ax
		mov	ax, offset g_dwCopyOfSimd
		push	ax
		mov	ax, offset gameState.carPlayer
		push	ax
		push	cs
		call	near ptr InitCvxWithSimd
		add	sp, 14h
		mov	gameState.field_2F2, si
		mov	ax, si
		mov	gameState.field_45D, al
		mov	gameState.field_45E, al
		mov	gameState.field_45B, al
		mov	gameState.field_45C, al
		mov	al, g_cStartCol2
		cbw
		mov	gameState.wStartCol, ax
		mov	gameState.wStartCol2, ax
		mov	al, g_cStartRow2
		cbw
		mov	gameState.wStartRow, ax
		mov	gameState.wStartRow2, ax
		cmp	[bp+arg_0], 0FFFEh
		jz	short loc_471_26FA ; dont do the next if arg0 is 0xfffe


		sub	ax, ax
		push	ax
		mov	al, gameState.carPlayer.field_CE
		inc	gameState.carPlayer.field_CE
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carPlayer.vecUnk3
		push	ax
		push	gameState.carPlayer.wTrakdata3Index
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8

loc_471_26FA:				; CODE XREF: InitGameState+2EAj
		mov	ax, 0D2h ; 'Ò'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 2
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 24h	; '$'
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 3
		push	cx
		mov	[bp+var_A], ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, [bp+var_A]
		mov	[bp+var_8], ax
		mov	ax, 0D2h ; 'Ò'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 2
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 24h	; '$'
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 3
		push	cx
		mov	[bp+var_A], ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, [bp+var_A]
		mov	[bp+var_2], ax
		mov	ax, g_wUseTrkInRpl
		neg	ax
		push	ax
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		add	ax, [bp+var_2]
		cwd
		mov	cl, 6

loc_471_2796:				; CODE XREF: InitGameState+3AAj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_2796 ; loop 6 times


		push	dx
		push	ax
		mov	al, byte_2B77_922B
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word_2B77_178[bx]
		cwd
		mov	cl, 6

loc_471_27AF:				; CODE XREF: InitGameState+3C3j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_27AF ; loop 6 times


		push	dx
		push	ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		add	ax, [bp+var_8]
		cwd
		mov	cl, 6

loc_471_27CB:				; CODE XREF: InitGameState+3DFj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_27CB ; loop 6 times


		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, offset g_pCarInfoSimd2
		push	ax
		mov	ax, offset gameState.carOpponent
		push	ax
		push	cs
		call	near ptr InitCvxWithSimd
		add	sp, 14h
		cmp	g_gameInfo.cOpponentType, 0
		jz	short _lblEndFunc
		cmp	[bp+arg_0], 0FFFEh
		jz	short _lblEndFunc ; stop here if arg0 is 0xfffe	(at init-time)


		mov	ax, offset gameState.field_3F9
		push	ax
		mov	al, gameState.carOpponent.field_CE
		inc	gameState.carOpponent.field_CE
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carOpponent.vecUnk3
		push	ax
		mov	bx, gameState.carOpponent.wTrakdata3Index
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata3
		mov	es, word ptr g_ppTrakdata3+2
		assume es:nothing
		push	word ptr es:[bx]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8

_lblEndFunc:				; CODE XREF: InitGameState+3FBj
					; InitGameState+401j
		mov	ax, si
		mov	gameState.field_42A, al

_lblEndFuncLast:			; CODE XREF: InitGameState+7Dj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InitGameState	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RestoreGameState proc far		; CODE XREF: RunGame+1CCP RunGame+1D8P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		cmp	[bp+arg_0], 0
		jnz	short loc_471_2849
		cmp	g_wResetOnCvxTr, 0
		jnz	short loc_471_2849
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr InitGameState
		add	sp, 2

loc_471_2849:				; CODE XREF: RestoreGameState+Cj
					; RestoreGameState+13j
		mov	ax, [bp+arg_0]
		cwd
		mov	cx, g_wFpsMul1Eh
		idiv	cx
		mov	si, ax
		cmp	si, 14h
		jnz	short loc_471_285B
		dec	si

loc_471_285B:				; CODE XREF: RestoreGameState+2Ej
		mov	ax, gameState.wGameFrame
		cmp	[bp+arg_0], ax
		jb	short loc_471_28A1

loc_471_2863:				; CODE XREF: RestoreGameState+C5j
		mov	ax, g_wFpsMul1Eh
		imul	si
		cmp	ax, gameState.wGameFrame
		ja	short loc_471_2871
		jmp	loc_471_28F2
; ---------------------------------------------------------------------------

loc_471_2871:				; CODE XREF: RestoreGameState+42j
		mov	ax, 460h	; = sizeof chunk in teh	cvx bytes
		cwd
		push	dx
		push	ax
		mov	ax, si
		cwd
		push	dx
		push	ax
		call	__aFlmul
		add	ax, 3F4h	; we're checking offset 3f4 in the vcxbytes chunk
		adc	dx, 0
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, word ptr g_dwCvxBytes+2
		mov	es, dx
		mov	bx, ax
		cmp	byte ptr es:[bx], 0
		jz	short loc_471_28EE

loc_471_28A1:				; CODE XREF: RestoreGameState+37j
		mov	ax, 460h	; sizeof cvxchunk
		cwd
		push	dx
		push	ax
		mov	ax, si
		cwd
		push	dx
		push	ax
		call	__aFlmul
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, word ptr g_dwCvxBytes+2
		push	si
		mov	di, offset gameState
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		push	ds
		mov	ds, dx
		mov	cx, 230h	; 230 words = sizeof megastruc
		repne movsw		; so this copies FROM the cvxbytes to the gamestate right?
		pop	ds
		pop	si
		mov	ax, offset gameState.pcKevinSeed
		push	ax
		call	SetKevinRndSeed
		add	sp, 2
		mov	ax, gameState.wGameFrame
		mov	g_wMainFlgCp, ax ; field_140 is	used for lookup	in the cvxbytes	struct
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		db 3 dup(90h)
; ---------------------------------------------------------------------------

loc_471_28EE:				; CODE XREF: RestoreGameState+75j
		dec	si
		jmp	loc_471_2863
; ---------------------------------------------------------------------------

loc_471_28F2:				; CODE XREF: RestoreGameState+44j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
RestoreGameState endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UpdateGameState	proc far		; CODE XREF: RunGame+1F3P
					; RunGame:loc_11B7_22DP ...

var_4		= byte ptr -4

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	bx, gameState.wGameFrame
		les	di, g_ppTrakdata16
		assume es:nothing
		mov	al, es:[bx+di]
		mov	[bp+var_4], al
		or	al, al
		jz	short loc_471_2917
		mov	gameState.cCvxFlag2, 1

loc_471_2917:				; CODE XREF: UpdateGameState+18j
		mov	ax, bx
		sub	dx, dx
		div	g_wFpsMul1Eh
		or	dx, dx
		jnz	short loc_471_2969 ; if	the remainder of the div is non-zero, skip the copying


		mov	ax, bx		; we get here right at start, after first keypress and then every 30 seconds
					; because, 20 *	30 seconds = 10	minutter = length of replaybuffer
		sub	dx, dx
		div	g_wFpsMul1Eh
		mov	si, ax
		mov	ax, offset gameState.pcKevinSeed
		push	ax
		call	GetKevinRndSeed
		add	sp, 2
		mov	ax, 460h
		cwd
		push	dx
		push	ax
		mov	ax, si		; s†, index i cvxbytes = x/g_fpsMul1Eh
		cwd
		push	dx
		push	ax
		call	__aFlmul
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, word ptr g_dwCvxBytes+2
		mov	bx, ax
		mov	es, dx
		push	si
		mov	di, bx
		mov	si, offset gameState
		mov	cx, 230h
		repne movsw		; cop 230h words into the cvx (560 words = 1120	bytes =	sizeof cvxstruct yes?)
		pop	si

loc_471_2969:				; CODE XREF: UpdateGameState+29j
		inc	gameState.wGameFrame
		cmp	gameState.cCvxFlag3, 0
		jz	short loc_471_29AE
		mov	ax, gameState.wFramesPerSec
		cmp	gameState.wFrameInSec, ax
		jge	short loc_471_29AE
		inc	gameState.wFrameInSec
		cmp	gameState.wFrameInSec, ax
		jnz	short loc_471_29AE
		cmp	byte ptr word_2B77_926A, 0
		jnz	short loc_471_29AE
		cmp	gameState.carPlayer.field_C9, 1
		jnz	short loc_471_29A2
		cmp	gameState.carPlayer.wTrackGrip2, 0
		jz	short loc_471_29A2
		inc	gameState.wFramesPerSec	; orly??
		jmp	short loc_471_29AE
; ---------------------------------------------------------------------------

loc_471_29A2:				; CODE XREF: UpdateGameState+9Bj
					; UpdateGameState+A2j
		cmp	g_cGameMode2, 0
		jnz	short loc_471_29AE
		mov	byte ptr word_2B77_926A, 1

loc_471_29AE:				; CODE XREF: UpdateGameState+7Aj
					; UpdateGameState+83j ...
		cmp	gameState.cCvxFlag2, 0
		jz	short loc_471_29E6
		mov	al, [bp+var_4]
		cbw
		push	ax		; parameter is input code, passed to UdpateCarState
		push	cs
		call	near ptr PlayerOp ; PlayerOp is	similar	to OpponentOp, but also	called right below
		add	sp, 2
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_471_29CC
		push	cs
		call	near ptr OpponentOp ; this is the only call, and its bypassed if there is no opponent

loc_471_29CC:				; CODE XREF: UpdateGameState+CEj
		call	sub_11B7_E1C
		cmp	gameState.field_42A, 0
		jz	short loc_471_29DC
		push	cs
		call	near ptr sub_471_5490

loc_471_29DC:				; CODE XREF: UpdateGameState+DEj
		push	cs
		call	near ptr DoAudioCvx
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_471_29E6:				; CODE XREF: UpdateGameState+BBj
		cmp	g_cGameMode2, 1
		jz	short loc_471_29F0
		jmp	loc_471_2AD1
; ---------------------------------------------------------------------------

loc_471_29F0:				; CODE XREF: UpdateGameState+F3j
		push	cs
		call	near ptr DoAudioCvx
		cmp	byte_2B77_81CC,	0
		jnz	short loc_471_29FE
		jmp	loc_471_2AD1
; ---------------------------------------------------------------------------

loc_471_29FE:				; CODE XREF: UpdateGameState+101j
		cmp	word_2B77_965A,	1C2h
		jge	short loc_471_2A0B
		add	word_2B77_965A,	8

loc_471_2A0B:				; CODE XREF: UpdateGameState+10Cj
		cmp	byte_2B77_81CC,	1
		jnz	short loc_471_2A1E
		cmp	word_2B77_965A,	180h
		jle	short loc_471_2A1E
		inc	byte_2B77_81CC

loc_471_2A1E:				; CODE XREF: UpdateGameState+118j
					; UpdateGameState+120j
		cmp	byte_2B77_81CC,	2
		jz	short loc_471_2A28
		jmp	loc_471_2AD1
; ---------------------------------------------------------------------------

loc_471_2A28:				; CODE XREF: UpdateGameState+12Bj
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	dx, cx
		mov	cl, 6

loc_471_2A40:				; CODE XREF: UpdateGameState+14Ej
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_2A40
		sub	ax, dx
		push	ax
		push	g_wUseTrkInRpl
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	si, ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	dx, cx
		mov	cl, 6

loc_471_2A7A:				; CODE XREF: UpdateGameState+188j
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_2A7A
		sub	ax, dx
		push	ax
		push	g_wUseTrkInRpl
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	si, ax
		cmp	si, 0E4h ; 'ä'
		jle	short loc_471_2AC0
		cmp	gameState.carPlayer.wTrackGrip,	500h
		jnb	short loc_471_2ABC
		mov	ax, 1

loc_471_2AAD:				; CODE XREF: UpdateGameState+1C6j
					; UpdateGameState+1D2j
		push	ax
		push	cs
		call	near ptr PlayerOp
		add	sp, 2
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_2ABC:				; CODE XREF: UpdateGameState+1B0j
		sub	ax, ax
		jmp	short loc_471_2AAD
; ---------------------------------------------------------------------------

loc_471_2AC0:				; CODE XREF: UpdateGameState+1A8j
		cmp	gameState.carPlayer.wTrackGrip,	0
		jz	short loc_471_2ACC
		mov	ax, 2
		jmp	short loc_471_2AAD
; ---------------------------------------------------------------------------

loc_471_2ACC:				; CODE XREF: UpdateGameState+1CDj
		mov	byte_2B77_81CC,	0

loc_471_2AD1:				; CODE XREF: UpdateGameState+F5j
					; UpdateGameState+103j	...
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
UpdateGameState	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PlayerOp	proc far		; CODE XREF: UpdateGameState+C3p
					; UpdateGameState+1B7p

var_52		= word ptr -52h
var_4E		= word ptr -4Eh
var_3A		= byte ptr -3Ah
vec2		= Vector3D ptr -38h
vec1		= Vector3D ptr -32h
var_2C		= byte ptr -2Ch
var_2A		= byte ptr -2Ah
vec3		= Vector3D ptr -28h
pMatrix		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= byte ptr -1Ch
var_1A		= word ptr -1Ah
var_16		= word ptr -16h
var_2		= word ptr -2
arg_0		= byte ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 52h
		push	di
		push	si
		cmp	g_wFpsMul4, 0
		jz	short loc_471_2AEB
		dec	g_wFpsMul4

loc_471_2AEB:				; CODE XREF: PlayerOp+Dj
		mov	gameState.carPlayer.field_CF, 1
		cmp	gameState.carPlayer.field_C9, 0
		jz	short loc_471_2B32
		mov	gameState.field_45D, 0
		mov	[bp+arg_0], 2
		cmp	gameState.carPlayer.wTrackGrip2, 0
		jnz	short loc_471_2B32
		mov	gameState.carPlayer.field_CF, 0
		cmp	gameState.carPlayer.wTrackGrip,	0
		jnz	short loc_471_2B32
		cmp	gameState.carPlayer.rc1.dwLeft,	0
		jnz	short loc_471_2B32
		cmp	gameState.carPlayer.rc1.dwTop, 0
		jnz	short loc_471_2B32
		cmp	gameState.carPlayer.rc1.dwRight, 0
		jnz	short loc_471_2B32
		cmp	gameState.carPlayer.rc1.dwBottom, 0
		jnz	short loc_471_2B32
		jmp	loc_471_3100
; ---------------------------------------------------------------------------

loc_471_2B32:				; CODE XREF: PlayerOp+1Dj PlayerOp+2Dj ...
		mov	ax, offset g_dwCopyOfSimd
		push	ax
		mov	ax, offset gameState.carPlayer
		push	ax
		sub	ax, ax
		push	ax
		mov	al, [bp+arg_0]
		cbw
		push	ax
		push	cs
		call	near ptr UpdateCarState
		add	sp, 8
		mov	al, [bp+arg_0]
		cbw
		sar	ax, 1
		sar	ax, 1
		and	ax, 3
		push	ax
		push	cs
		call	near ptr sub_471_40A2
		add	sp, 2
		mov	ax, 1
		push	ax
		mov	ax, offset g_dwCopyOfSimd
		push	ax
		mov	ax, offset gameState.carPlayer
		push	ax
		push	cs
		call	near ptr CvxOpSimdTrack
		add	sp, 6
		sub	ax, ax
		push	ax
		mov	ax, offset g_pCarInfoSimd2
		push	ax
		mov	ax, offset gameState.carOpponent
		push	ax
		mov	ax, offset g_dwCopyOfSimd
		push	ax
		mov	ax, offset gameState.carPlayer
		push	ax
		push	cs
		call	near ptr TrkPlanSimd
		add	sp, 0Ah
		mov	ax, gameState.carPlayer.wTrackGrip2
		sub	dx, dx
		add	gameState.field_13C, ax
		adc	gameState.field_13E, dx
		mov	al, gameState.field_45B
		mov	[bp+var_1C], al
		mov	ax, gameState.field_2F2
		mov	[bp+var_2], ax
		lea	ax, [bp+var_1E]
		push	ax
		lea	ax, [bp+var_2]
		push	ax
		push	cs
		call	near ptr Trakdata1_2_17_21_22 ;	this returns something based on	the position
		add	sp, 4
		cbw
		mov	si, ax
		or	si, si
		jnz	short loc_471_2BBB
		jmp	loc_471_2CA3
; ---------------------------------------------------------------------------

loc_471_2BBB:				; CODE XREF: PlayerOp+DEj
		cmp	[bp+var_1E], 0FFFEh
		jnz	short loc_471_2BC8
		mov	gameState.field_45B, 1
		jmp	short loc_471_2BD4
; ---------------------------------------------------------------------------

loc_471_2BC8:				; CODE XREF: PlayerOp+E7j
		cmp	gameState.field_45B, 1
		jnz	short loc_471_2BD9
		mov	gameState.field_45B, 0

loc_471_2BD4:				; CODE XREF: PlayerOp+EEj
		mov	gameState.field_45C, 0

loc_471_2BD9:				; CODE XREF: PlayerOp+F5j
		cmp	gameState.field_45B, 0
		jz	short loc_471_2BE3
		jmp	loc_471_2C9D
; ---------------------------------------------------------------------------

loc_471_2BE3:				; CODE XREF: PlayerOp+106j
		cmp	[bp+var_2], 0
		jnz	short loc_471_2BF8
		cmp	gameState.wCvxFlag3, 0
		jz	short loc_471_2BF8
		inc	gameState.carPlayer.field_CD
		jmp	short loc_471_2C6B
; ---------------------------------------------------------------------------
		nop
		nop

loc_471_2BF8:				; CODE XREF: PlayerOp+10Fj
					; PlayerOp+116j
		cmp	[bp+var_1E], 0
		jl	short loc_471_2C12
		cmp	[bp+var_1E], 3
		jge	short loc_471_2C12
		mov	gameState.field_45C, 0
		mov	ax, [bp+var_2]
		mov	gameState.field_2F2, ax
		jmp	loc_471_2C9D
; ---------------------------------------------------------------------------

loc_471_2C12:				; CODE XREF: PlayerOp+124j
					; PlayerOp+12Aj
		cmp	[bp+var_1E], 0FFFFh
		jz	short loc_471_2C1E
		cmp	[bp+var_1E], 3
		jle	short loc_471_2C9D

loc_471_2C1E:				; CODE XREF: PlayerOp+13Ej
		mov	di, gameState.wCvxFlag3
		shl	di, 1
		les	bx, g_ppTrakdata
		mov	ax, [bp+var_2]
		cmp	es:[bx+di], ax
		jz	short loc_471_2C39
		les	bx, g_ppTrakdata2
		cmp	es:[bx+di], ax
		jnz	short loc_471_2C40

loc_471_2C39:				; CODE XREF: PlayerOp+156j
		inc	gameState.field_45C
		jmp	short loc_471_2C64
; ---------------------------------------------------------------------------
		nop

loc_471_2C40:				; CODE XREF: PlayerOp+15Fj
		mov	di, [bp+var_2]
		shl	di, 1
		les	bx, g_ppTrakdata
		mov	ax, gameState.wCvxFlag3
		cmp	es:[bx+di], ax
		jz	short loc_471_2C5A
		les	bx, g_ppTrakdata2
		cmp	es:[bx+di], ax
		jnz	short loc_471_2C5F

loc_471_2C5A:				; CODE XREF: PlayerOp+177j
		mov	gameState.field_45B, 2

loc_471_2C5F:				; CODE XREF: PlayerOp+180j
		mov	gameState.field_45C, 1

loc_471_2C64:				; CODE XREF: PlayerOp+165j
		cmp	gameState.field_45C, 3
		jl	short loc_471_2C9D

loc_471_2C6B:				; CODE XREF: PlayerOp+11Cj
		mov	ax, [bp+var_2]
		mov	gameState.field_2F2, ax
		mov	gameState.field_45C, 0
		cmp	[bp+var_1E], 0
		jle	short loc_471_2C9D
		mov	ax, [bp+var_1E]
		imul	g_wFramesPerSec
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		mov	g_wFpsMul2, ax
		mov	al, byte ptr g_wFramesPerSec
		shl	al, 1
		shl	al, 1
		mov	g_wFpsMul4, al
		mov	ax, g_wFpsMul2
		add	gameState.wFramesPerSecCounter,	ax

loc_471_2C9D:				; CODE XREF: PlayerOp+108j
					; PlayerOp+137j ...
		mov	ax, [bp+var_2]
		mov	gameState.wCvxFlag3, ax

loc_471_2CA3:				; CODE XREF: PlayerOp+E0j
		mov	gameState.field_45D, 0
		cmp	gameState.field_45B, 1
		jnz	short loc_471_2CB2
		jmp	loc_471_3100
; ---------------------------------------------------------------------------

loc_471_2CB2:				; CODE XREF: PlayerOp+1D5j
		mov	ax, 1
		push	ax
		push	gameState.carPlayer.vecRotate.wX
		push	gameState.carPlayer.vecRotate.wY
		push	gameState.carPlayer.vecRotate.wZ
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		cmp	gameState.field_45B, 2
		jnz	short loc_471_2CE6
		cmp	gameState.carPlayer.field_C9, 0
		jnz	short loc_471_2CE0
		mov	gameState.field_45D, 3

loc_471_2CE0:				; CODE XREF: PlayerOp+201j
		mov	ax, gameState.wCvxFlag3
		jmp	loc_471_2DB9
; ---------------------------------------------------------------------------

loc_471_2CE6:				; CODE XREF: PlayerOp+1FAj
		cmp	gameState.carPlayer.wTrakdata3Index, 0FFFFh
		jnz	short loc_471_2CF2

loc_471_2CED:				; CODE XREF: PlayerOp+24Fj
		sub	si, si
		jmp	loc_471_2DA3
; ---------------------------------------------------------------------------

loc_471_2CF2:				; CODE XREF: PlayerOp+213j
		cmp	[bp+var_1C], 0
		jz	short loc_471_2CFF
		cmp	gameState.field_45B, 0
		jz	short loc_471_2D21

loc_471_2CFF:				; CODE XREF: PlayerOp+21Ej
		mov	ax, gameState.field_2F2
		cmp	gameState.carPlayer.wTrakdata3Index, ax
		jz	short loc_471_2D2A
		mov	di, ax
		shl	di, 1
		les	bx, g_ppTrakdata
		mov	ax, gameState.carPlayer.wTrakdata3Index
		cmp	es:[bx+di], ax
		jz	short loc_471_2D2A
		les	bx, g_ppTrakdata2
		cmp	es:[bx+di], ax
		jz	short loc_471_2D2A

loc_471_2D21:				; CODE XREF: PlayerOp+225j
		mov	gameState.carPlayer.wTrakdata3Index, 0FFFFh
		jmp	short loc_471_2CED
; ---------------------------------------------------------------------------
		nop

loc_471_2D2A:				; CODE XREF: PlayerOp+22Ej
					; PlayerOp+23Ej ...
		mov	ax, gameState.carPlayer.vecUnk3.wX
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	dx, cx
		mov	cl, 6

loc_471_2D39:				; CODE XREF: PlayerOp+267j
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_2D39
		sub	ax, dx
		mov	[bp+vec1.wX], ax
		cmp	gameState.carPlayer.vecUnk3.wY,	0FFFFh
		jz	short loc_471_2D6C
		mov	ax, gameState.carPlayer.vecUnk3.wY
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	dx, cx
		mov	cl, 6

loc_471_2D5C:				; CODE XREF: PlayerOp+28Aj
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_2D5C
		sub	ax, dx
		mov	[bp+vec1.wY], ax
		jmp	short loc_471_2D71
; ---------------------------------------------------------------------------
		nop

loc_471_2D6C:				; CODE XREF: PlayerOp+273j
		mov	[bp+vec1.wY], 0

loc_471_2D71:				; CODE XREF: PlayerOp+291j
		mov	ax, gameState.carPlayer.vecUnk3.wZ
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	dx, cx
		mov	cl, 6

loc_471_2D80:				; CODE XREF: PlayerOp+2AEj
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_2D80
		sub	ax, dx
		mov	[bp+vec1.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	si, [bp+vec2.wZ]

loc_471_2DA3:				; CODE XREF: PlayerOp+217j
		cmp	si, 113h
		jl	short loc_471_2DAC
		jmp	loc_471_2F89
; ---------------------------------------------------------------------------

loc_471_2DAC:				; CODE XREF: PlayerOp+2CFj
		cmp	gameState.carPlayer.wTrakdata3Index, 0FFFFh
		jz	short loc_471_2DB6
		jmp	loc_471_2F3C
; ---------------------------------------------------------------------------

loc_471_2DB6:				; CODE XREF: PlayerOp+2D9j
		mov	ax, gameState.field_2F2

loc_471_2DB9:				; CODE XREF: PlayerOp+20Bj
		mov	[bp+var_2], ax
		mov	bx, ax
		shl	bx, 1
		les	di, g_ppTrakdata2
		cmp	word ptr es:[bx+di], 0FFFFh
		jz	short loc_471_2DCD
		jmp	loc_471_3061
; ---------------------------------------------------------------------------

loc_471_2DCD:				; CODE XREF: PlayerOp+2F0j
		mov	[bp+var_2A], 0
		mov	[bp+var_2C], 0

loc_471_2DD5:				; CODE XREF: PlayerOp+3BAj
		sub	ax, ax
		push	ax
		mov	al, [bp+var_2C]
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carPlayer.vecUnk3
		push	ax
		push	[bp+var_2]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		mov	[bp+var_2A], al
		push	si
		lea	di, [bp+vec3]
		mov	si, offset gameState.carPlayer.vecUnk3
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_2E05:				; CODE XREF: PlayerOp+333j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2E05
		sub	[bp+vec3.wX], ax
		cmp	[bp+vec3.wY], 0FFFFh
		jnz	short loc_471_2E2E
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_2E1F:				; CODE XREF: PlayerOp+34Dj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2E1F
		neg	ax
		mov	[bp+vec3.wY], ax
		jmp	short loc_471_2E42
; ---------------------------------------------------------------------------

loc_471_2E2E:				; CODE XREF: PlayerOp+33Cj
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_2E37:				; CODE XREF: PlayerOp+365j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2E37
		sub	[bp+vec3.wY], ax

loc_471_2E42:				; CODE XREF: PlayerOp+354j
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_2E4B:				; CODE XREF: PlayerOp+379j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2E4B
		sub	[bp+vec3.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec3]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+var_2C], 0
		jz	short loc_471_2E7D
		mov	ax, [bp+vec1.wZ]
		cmp	[bp+vec2.wZ], ax
		jge	short loc_471_2E89
		cmp	[bp+vec2.wZ], 0
		jle	short loc_471_2E89

loc_471_2E7D:				; CODE XREF: PlayerOp+395j
		mov	al, [bp+var_2C]
		mov	[bp+var_3A], al
		mov	ax, [bp+vec2.wZ]
		mov	[bp+vec1.wZ], ax

loc_471_2E89:				; CODE XREF: PlayerOp+39Dj
					; PlayerOp+3A3j
		inc	[bp+var_2C]
		cmp	[bp+var_2A], 0
		jnz	short loc_471_2E95
		jmp	loc_471_2DD5
; ---------------------------------------------------------------------------

loc_471_2E95:				; CODE XREF: PlayerOp+3B8j
		cmp	gameState.field_45B, 2
		jz	short loc_471_2E9F
		jmp	loc_471_2F30
; ---------------------------------------------------------------------------

loc_471_2E9F:				; CODE XREF: PlayerOp+3C2j
		cmp	[bp+var_3A], 0
		jnz	short loc_471_2EC0
		sub	ax, ax
		push	ax
		push	ax
		lea	ax, [bp+var_52]
		push	ax
		push	[bp+var_2]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		sub	ax, ax
		push	ax
		mov	ax, 1
		jmp	short loc_471_2EE0
; ---------------------------------------------------------------------------
		nop

loc_471_2EC0:				; CODE XREF: PlayerOp+3CBj
		sub	ax, ax
		push	ax
		mov	al, [bp+var_3A]
		dec	al
		cbw
		push	ax
		lea	ax, [bp+var_52]
		push	ax
		push	[bp+var_2]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		sub	ax, ax
		push	ax
		mov	al, [bp+var_3A]
		sub	ah, ah

loc_471_2EE0:				; CODE XREF: PlayerOp+3E5j
		push	ax
		lea	ax, [bp+var_1A]
		push	ax
		push	[bp+var_2]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		mov	ax, [bp+var_16]
		sub	ax, [bp+var_4E]
		push	ax
		mov	ax, [bp+var_52]
		sub	ax, [bp+var_1A]
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		mov	si, ax
		and	si, 3FFh
		mov	ax, gameState.carPlayer.vecRotate.wX
		sub	ax, si
		and	ah, 3
		mov	si, ax
		cmp	si, 380h
		jg	short loc_471_2F21
		cmp	si, 80h	; '€'
		jge	short loc_471_2F3C

loc_471_2F21:				; CODE XREF: PlayerOp+441j
		mov	gameState.field_45B, 0
		mov	gameState.field_45C, 1
		mov	ax, [bp+var_2]
		jmp	short loc_471_2F33
; ---------------------------------------------------------------------------

loc_471_2F30:				; CODE XREF: PlayerOp+3C4j
		mov	ax, gameState.field_2F2

loc_471_2F33:				; CODE XREF: PlayerOp+456j
		mov	gameState.carPlayer.wTrakdata3Index, ax
		mov	al, [bp+var_3A]
		mov	gameState.carPlayer.field_CE, al

loc_471_2F3C:				; CODE XREF: PlayerOp+2DBj
					; PlayerOp+447j
		sub	ax, ax
		push	ax
		mov	al, gameState.carPlayer.field_CE
		inc	gameState.carPlayer.field_CE
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carPlayer.vecUnk3
		push	ax
		push	gameState.carPlayer.wTrakdata3Index
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		or	al, al
		jz	short loc_471_2F89
		mov	bx, gameState.field_2F2
		shl	bx, 1
		les	di, g_ppTrakdata2
		cmp	word ptr es:[bx+di], 0FFFFh
		jz	short loc_471_2F74
		mov	gameState.carPlayer.wTrakdata3Index, 0FFFFh
		jmp	short loc_471_2F84
; ---------------------------------------------------------------------------

loc_471_2F74:				; CODE XREF: PlayerOp+492j
		mov	bx, gameState.field_2F2
		shl	bx, 1
		les	di, g_ppTrakdata
		mov	ax, es:[bx+di]
		mov	gameState.carPlayer.wTrakdata3Index, ax

loc_471_2F84:				; CODE XREF: PlayerOp+49Aj
		mov	gameState.carPlayer.field_CE, 0

loc_471_2F89:				; CODE XREF: PlayerOp+2D1j
					; PlayerOp+482j
		push	si
		lea	di, [bp+vec3]
		mov	si, offset gameState.carPlayer.vecUnk3
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		cmp	gameState.carPlayer.wTrakdata3Index, 0FFFFh
		jnz	short loc_471_2FA0
		jmp	loc_471_3061
; ---------------------------------------------------------------------------

loc_471_2FA0:				; CODE XREF: PlayerOp+4C3j
		cmp	gameState.field_45B, 0
		jz	short loc_471_2FAA
		jmp	loc_471_3061
; ---------------------------------------------------------------------------

loc_471_2FAA:				; CODE XREF: PlayerOp+4CDj
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_2FB3:				; CODE XREF: PlayerOp+4E1j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2FB3
		sub	[bp+vec3.wX], ax
		cmp	[bp+vec3.wY], 0FFFFh
		jnz	short loc_471_2FCC
		mov	[bp+vec3.wY], 0
		jmp	short loc_471_2FE0
; ---------------------------------------------------------------------------
		nop

loc_471_2FCC:				; CODE XREF: PlayerOp+4EAj
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_2FD5:				; CODE XREF: PlayerOp+503j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2FD5
		sub	[bp+vec3.wY], ax

loc_471_2FE0:				; CODE XREF: PlayerOp+4F1j
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_2FE9:				; CODE XREF: PlayerOp+517j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_2FE9
		sub	[bp+vec3.wZ], ax
		mov	ax, 1
		push	ax
		push	gameState.carPlayer.vecRotate.wX
		push	gameState.carPlayer.vecRotate.wY
		push	gameState.carPlayer.vecRotate.wZ
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec3]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	[bp+vec2.wZ]
		mov	ax, [bp+vec2.wX]
		neg	ax
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		and	ah, 3
		mov	gameState.carPlayer.field_48, ax
		cmp	gameState.carPlayer.field_C9, 0
		jnz	short loc_471_3061
		add	ax, 80h	; '€'
		and	ah, 3
		mov	cl, 8
		shr	ax, cl
		cmp	ax, 1
		jz	short loc_471_305C
		cmp	ax, 3
		jz	short loc_471_308E

loc_471_3054:				; CODE XREF: PlayerOp+5BBj
		mov	gameState.field_45D, 0
		jmp	short loc_471_3061
; ---------------------------------------------------------------------------
		nop

loc_471_305C:				; CODE XREF: PlayerOp+575j
		mov	gameState.field_45D, 1

loc_471_3061:				; CODE XREF: PlayerOp+2F2j
					; PlayerOp+4C5j ...
		cmp	gameState.carPlayer.field_CD, 0
		jnz	short loc_471_306B
		jmp	loc_471_3100
; ---------------------------------------------------------------------------

loc_471_306B:				; CODE XREF: PlayerOp+58Ej
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	dx, cx
		mov	cl, 6

loc_471_3083:				; CODE XREF: PlayerOp+5B3j
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jz	short loc_471_309C
		jmp	short loc_471_3083
; ---------------------------------------------------------------------------
		nop

loc_471_308E:				; CODE XREF: PlayerOp+57Aj
		cmp	gameState.carPlayer.field_B6, 0
		jnz	short loc_471_3054
		mov	gameState.field_45D, 2
		jmp	short loc_471_3061
; ---------------------------------------------------------------------------

loc_471_309C:				; CODE XREF: PlayerOp+5B1j
		sub	ax, dx
		push	ax
		push	g_wUseTrkInRpl
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	si, ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		mov	cx, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	bx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	dx, cx
		mov	cl, 6

loc_471_30CE:				; CODE XREF: PlayerOp+5FCj
		sar	bx, 1
		rcr	dx, 1
		dec	cl
		jnz	short loc_471_30CE
		sub	ax, dx
		push	ax
		push	g_wUseTrkInRpl
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	si, ax
		jns	short loc_471_3100
		sub	ax, ax
		push	ax
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr CvxSfxOp
		add	sp, 4

loc_471_3100:				; CODE XREF: PlayerOp+57j
					; PlayerOp+1D7j ...
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
PlayerOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Trakdata1_2_17_21_22 proc far		; CODE XREF: PlayerOp+D3p

wValue		= word ptr -5A4h
var_5A2		= byte ptr -5A2h
var_21A		= word ptr -21Ah
var_218		= byte ptr -218h
var_216		= word ptr -216h
cShapeTransFlag	= byte ptr -116h
var_114		= byte ptr -114h
var_110		= word ptr -110h
var_10E		= word ptr -10Eh
var_E		= byte ptr -0Eh
var_C		= byte ptr -0Ch
cZval		= byte ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
cXval		= byte ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 5A4h
		push	di
		push	si
		mov	al, byte ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	[bp+cXval], al
		mov	al, 1Dh
		sub	al, byte ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	[bp+cZval], al
		mov	al, [bp+cXval]
		cbw
		mov	[bp+wValue], ax	; wValue is X
		mov	ax, gameState.wStartCol
		cmp	[bp+wValue], ax
		jz	short loc_471_3138
		mov	ax, gameState.wStartCol2
		cmp	[bp+wValue], ax
		jnz	short loc_471_3162

loc_471_3138:				; CODE XREF: Trakdata1_2_17_21_22+27j
		mov	al, [bp+cZval]
		cbw
		mov	[bp+wValue], ax	; wValue is Z
		mov	ax, gameState.wStartRow
		cmp	[bp+wValue], ax
		jz	short loc_471_3152
		mov	ax, gameState.wStartRow2
		cmp	[bp+wValue], ax
		jnz	short loc_471_3162

loc_471_3152:				; CODE XREF: Trakdata1_2_17_21_22+41j
		mov	bx, [bp+arg_2]
		mov	word ptr [bx], 0
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_3162:				; CODE XREF: Trakdata1_2_17_21_22+30j
					; Trakdata1_2_17_21_22+4Aj
		cmp	[bp+cXval], 0
		jge	short loc_471_316B
		jmp	loc_471_321E
; ---------------------------------------------------------------------------

loc_471_316B:				; CODE XREF: Trakdata1_2_17_21_22+60j
		cmp	[bp+cXval], 1Dh
		jle	short loc_471_3174
		jmp	loc_471_321E
; ---------------------------------------------------------------------------

loc_471_3174:				; CODE XREF: Trakdata1_2_17_21_22+69j
		cmp	[bp+cZval], 0
		jge	short loc_471_317D
		jmp	loc_471_321E
; ---------------------------------------------------------------------------

loc_471_317D:				; CODE XREF: Trakdata1_2_17_21_22+72j
		cmp	[bp+cZval], 1Dh
		jle	short loc_471_3186
		jmp	loc_471_321E
; ---------------------------------------------------------------------------

loc_471_3186:				; CODE XREF: Trakdata1_2_17_21_22+7Bj
		mov	[bp+var_6], 0
		mov	[bp+var_21A], 0
		sub	di, di
		sub	si, si
		jmp	short loc_471_319E
; ---------------------------------------------------------------------------
		nop

loc_471_3198:				; CODE XREF: Trakdata1_2_17_21_22+9Cj
		mov	[bp+si+var_5A2], 0
		inc	si

loc_471_319E:				; CODE XREF: Trakdata1_2_17_21_22+8Fj
		cmp	word_2B77_A660,	si
		jg	short loc_471_3198
		mov	bx, [bp+arg_0]
		mov	si, [bx]

loc_471_31A9:				; CODE XREF: Trakdata1_2_17_21_22+E1j
					; Trakdata1_2_17_21_22+25Ej
		mov	bx, si
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata
		mov	es, word ptr g_ppTrakdata+2
		mov	ax, es:[bx]
		mov	[bp+var_2], ax
		mov	bx, ax
		add	bx, bp
		cmp	[bx+var_5A2], 0
		jz	short loc_471_3228
		cmp	[bp+var_21A], 0
		jz	short loc_471_31EA
		dec	[bp+var_21A]
		mov	ax, [bp+var_21A]
		shl	ax, 1
		add	ax, bp
		mov	[bp+wValue], ax
		mov	bx, ax
		mov	si, [bx+var_216]
		mov	di, [bx+var_10E]
		jmp	short loc_471_31A9
; ---------------------------------------------------------------------------
		nop

loc_471_31EA:				; CODE XREF: Trakdata1_2_17_21_22+C5j
		cmp	[bp+var_6], 0
		jz	short loc_471_320A
		mov	bx, [bp+arg_0]
		mov	ax, [bp+var_110]
		mov	[bx], ax
		mov	bx, [bp+arg_2]
		mov	ax, [bp+var_6]
		mov	[bx], ax

loc_471_3201:				; CODE XREF: Trakdata1_2_17_21_22+11Fj
					; Trakdata1_2_17_21_22+255j
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_471_320A:				; CODE XREF: Trakdata1_2_17_21_22+E8j
		mov	al, [bp+cXval]
		cbw
		mov	gameState.wStartCol, ax
		mov	gameState.wStartCol2, ax
		mov	al, [bp+cZval]
		cbw
		mov	gameState.wStartRow, ax
		mov	gameState.wStartRow2, ax

loc_471_321E:				; CODE XREF: Trakdata1_2_17_21_22+62j
					; Trakdata1_2_17_21_22+6Bj ...
		mov	bx, [bp+arg_2]
		mov	word ptr [bx], 0FFFEh
		jmp	short loc_471_3201
; ---------------------------------------------------------------------------
		nop

loc_471_3228:				; CODE XREF: Trakdata1_2_17_21_22+BEj
		mov	bx, [bp+var_2]
		add	bx, bp
		mov	[bx+var_5A2], 1
		mov	bx, [bp+var_2]
		add	bx, word ptr g_ppTrakdata22
		mov	es, word ptr g_ppTrakdata22+2
		mov	al, es:[bx]
		mov	[bp+var_E], al
		mov	bx, [bp+var_2]
		add	bx, word ptr g_ppTrakdata17
		mov	es, word ptr g_ppTrakdata17+2
		mov	al, es:[bx]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		mov	[bp+cShapeTransFlag], al
		test	[bp+cShapeTransFlag], 1
		jz	short loc_471_3276
		mov	al, [bp+var_E]
		inc	al
		jmp	short loc_471_3279
; ---------------------------------------------------------------------------
		nop

loc_471_3276:				; CODE XREF: Trakdata1_2_17_21_22+166j
		mov	al, [bp+var_E]

loc_471_3279:				; CODE XREF: Trakdata1_2_17_21_22+16Dj
		mov	[bp+var_218], al
		mov	bx, [bp+var_2]
		add	bx, word ptr g_pTrakdata21
		mov	es, word ptr g_pTrakdata21+2
		mov	al, es:[bx]
		mov	[bp+var_C], al
		test	[bp+cShapeTransFlag], 2
		jz	short loc_471_329A
		inc	al
		jmp	short loc_471_329D
; ---------------------------------------------------------------------------
		nop

loc_471_329A:				; CODE XREF: Trakdata1_2_17_21_22+18Dj
		mov	al, [bp+var_C]

loc_471_329D:				; CODE XREF: Trakdata1_2_17_21_22+191j
		mov	[bp+var_114], al
		mov	al, [bp+cXval]
		cmp	[bp+var_C], al
		jz	short loc_471_32AF
		cmp	[bp+var_114], al
		jnz	short loc_471_3309

loc_471_32AF:				; CODE XREF: Trakdata1_2_17_21_22+1A1j
		mov	al, [bp+cZval]
		cmp	[bp+var_E], al
		jz	short loc_471_32BD
		cmp	[bp+var_218], al
		jnz	short loc_471_3309

loc_471_32BD:				; CODE XREF: Trakdata1_2_17_21_22+1AFj
		mov	bx, si
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata2
		mov	es, word ptr g_ppTrakdata2+2
		cmp	word ptr es:[bx], 0FFFFh
		jz	short loc_471_32D2
		mov	[bp+var_2], si

loc_471_32D2:				; CODE XREF: Trakdata1_2_17_21_22+1C7j
		mov	al, [bp+var_C]
		cbw
		mov	gameState.wStartCol, ax
		mov	al, [bp+var_114]
		cbw
		mov	gameState.wStartCol2, ax
		mov	al, [bp+var_E]
		cbw
		mov	gameState.wStartRow, ax
		mov	al, [bp+var_218]
		cbw
		mov	gameState.wStartRow2, ax
		or	di, di
		jle	short loc_471_334E
		cmp	[bp+var_6], 0
		jz	short loc_471_32FF
		cmp	[bp+var_6], di
		jle	short loc_471_3309

loc_471_32FF:				; CODE XREF: Trakdata1_2_17_21_22+1F2j
		mov	ax, [bp+var_2]
		mov	[bp+var_110], ax
		mov	[bp+var_6], di

loc_471_3309:				; CODE XREF: Trakdata1_2_17_21_22+1A7j
					; Trakdata1_2_17_21_22+1B5j ...
		mov	bx, si
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata2
		mov	es, word ptr g_ppTrakdata2+2
		mov	ax, es:[bx]
		mov	[bp+var_8], ax
		cmp	ax, 0FFFFh
		jz	short loc_471_333F
		mov	bx, [bp+var_21A]
		shl	bx, 1
		add	bx, bp
		mov	[bx+var_10E], di
		mov	bx, [bp+var_21A]
		inc	[bp+var_21A]
		shl	bx, 1
		add	bx, bp
		mov	ax, [bp+var_8]
		mov	[bx+var_216], ax

loc_471_333F:				; CODE XREF: Trakdata1_2_17_21_22+218j
		cmp	[bp+var_2], 0
		jz	short loc_471_335E
		cmp	di, 0FFFFh
		jz	short loc_471_3361
		inc	di
		jmp	short loc_471_3361
; ---------------------------------------------------------------------------
		nop

loc_471_334E:				; CODE XREF: Trakdata1_2_17_21_22+1ECj
		mov	bx, [bp+arg_0]
		mov	ax, [bp+var_2]
		mov	[bx], ax
		mov	bx, [bp+arg_2]
		mov	[bx], di
		jmp	loc_471_3201
; ---------------------------------------------------------------------------

loc_471_335E:				; CODE XREF: Trakdata1_2_17_21_22+23Dj
		mov	di, 0FFFFh

loc_471_3361:				; CODE XREF: Trakdata1_2_17_21_22+242j
					; Trakdata1_2_17_21_22+245j
		mov	si, [bp+var_2]
		jmp	loc_471_31A9
Trakdata1_2_17_21_22 endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UpdateCarState	proc far		; CODE XREF: RunCarMenu+69BP
					; OpponentOp+4FAp ...

var_A		= byte ptr -0Ah
wBrakeValue	= word ptr -8
wTrackGrip	= word ptr -6
wGripDelta	= word ptr -4
wFpsScale	= word ptr -2
arg_0		= byte ptr  6
arg_2		= byte ptr  8
p_pCarState	= word ptr  0Ah
p_pSimdInfo	= word ptr  0Ch
arg_1C		= word ptr  22h

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		cmp	g_wFramesPerSec, 14h
		jnz	short loc_471_337E
		mov	[bp+wFpsScale],	6
		jmp	short loc_471_3383
; ---------------------------------------------------------------------------

loc_471_337E:				; CODE XREF: UpdateCarState+Dj
		mov	[bp+wFpsScale],	0Ch

loc_471_3383:				; CODE XREF: UpdateCarState+14j
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.field_C6],	0
		jz	short loc_471_3391
		dec	[bx+CarState.field_C6]

loc_471_3391:				; CODE XREF: UpdateCarState+23j
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip2]
		sub	ax, [si+CarState.wLastTrackGrip]
		mov	[bx+CarState.wGripDiff], ax
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip2]
		mov	[bx+CarState.wLastTrackGrip], ax
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wCurRpm]
		mov	[bx+CarState.wLastRpm],	ax
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.cTransmission], 0 ; 0 = manual, 1 = auto
		jnz	short _lblAutoGear
		cmp	[bx+CarState.cChangingGear], 0
		jnz	short _lblAutoGear
		test	[bp+arg_0], 10h	; test for manual shift
		jnz	short _lblIncGear
		test	[bp+arg_0], 20h	; test manual shift here too
		jnz	short _lblDecGear
		jmp	_lblCheckChangingGea
; ---------------------------------------------------------------------------
		nop

_lblAutoGear:				; CODE XREF: UpdateCarState+55j
					; UpdateCarState+5Cj
		cmp	[bx+CarState.cCurrentGear], 0
		jnz	short loc_471_33E0
		jmp	_lblCheckChangingGea
; ---------------------------------------------------------------------------

loc_471_33E0:				; CODE XREF: UpdateCarState+73j
		cmp	[bx+CarState.cChangingGear], 0
		jz	short loc_471_33EA
		jmp	_lblCheckChangingGea
; ---------------------------------------------------------------------------

loc_471_33EA:				; CODE XREF: UpdateCarState+7Dj
		cmp	[bx+CarState.field_C0],	0
		jnz	short _lblCheckGearChange
		jmp	_lblCheckChangingGea
; ---------------------------------------------------------------------------

_lblCheckGearChange:			; CODE XREF: UpdateCarState+87j
		mov	si, [bp+p_pSimdInfo]
		mov	ax, [si+CarInfoSimd.wUpshiftRpm]
		cmp	[bx+CarState.wCurRpm], ax
		jbe	short loc_471_3410 ; rpm is below upshift rpm, jump

_lblIncGear:				; CODE XREF: UpdateCarState+62j
		mov	si, [bp+p_pSimdInfo]
		mov	al, [si+CarInfoSimd.cNumGears]
		cmp	[bx+CarState.cCurrentGear], al
		jz	short _lblCheckChangingGea ; jump if at	max gear
		inc	[bx+CarState.cCurrentGear] ; hit upshift rpm, so increase gear
		jmp	short _lblGearChanged
; ---------------------------------------------------------------------------

loc_471_3410:				; CODE XREF: UpdateCarState+95j
		mov	bx, [bp+p_pCarState]
		mov	si, [bp+p_pSimdInfo]
		mov	ax, [si+CarInfoSimd.wDownshiftRpm]
		cmp	[bx+CarState.wCurRpm], ax
		jnb	short _lblCheckChangingGea ; continue if we hit	the downshift rpm

_lblDecGear:				; CODE XREF: UpdateCarState+68j
		cmp	[bx+CarState.cCurrentGear], 1
		jle	short _lblCheckChangingGea
		dec	[bx+CarState.cCurrentGear]

_lblGearChanged:			; CODE XREF: UpdateCarState+A6j
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cChangingGear], 1
		mov	al, byte ptr g_wFramesPerSec
		cbw
		sar	ax, 1
		add	al, byte ptr g_wFramesPerSec
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cFpsMul2],	al
		mov	bx, [bp+p_pCarState]
		mov	al, [bx+CarState.cCurrentGear]
		cbw
		mov	si, ax
		shl	si, 1
		shl	si, 1
		mov	bx, [bp+p_pSimdInfo]
		mov	ax, [bx+si+CarInfoSimd.arrPtKnobs.x]
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.wKnobX2], ax
		mov	bx, [bp+p_pCarState]
		mov	al, [bx+CarState.cCurrentGear]
		cbw
		mov	si, ax
		shl	si, 1
		shl	si, 1
		mov	bx, [bp+p_pSimdInfo]
		mov	ax, [bx+si+CarInfoSimd.arrPtKnobs.y]
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.wKnobY2], ax

_lblCheckChangingGea:			; CODE XREF: UpdateCarState+6Aj
					; UpdateCarState+75j ...
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.cChangingGear], 0
		jnz	short _lblCheckKnobX
		jmp	_lblEndGearChanging
; ---------------------------------------------------------------------------
; the following	section	is skipped unless we are changing gears

_lblCheckKnobX:				; CODE XREF: UpdateCarState+116j
		mov	si, bx
		mov	ax, [si+CarState.wKnobX2]
		cmp	[bx+CarState.wKnobX], ax
		jnz	short _lblCheckKnobY
		mov	ax, [bx+CarState.wKnobY2]
		sub	ax, [bx+CarState.wKnobY]
		mov	[bp+wGripDelta], ax
		or	ax, ax
		jnz	short loc_471_34CA
		mov	[bx+CarState.cChangingGear], 0
		mov	bx, [bp+p_pCarState]
		mov	al, [bx+CarState.cCurrentGear]
		cbw
		mov	si, ax
		shl	si, 1
		mov	bx, [bp+p_pSimdInfo]
		mov	ax, [bx+si+CarInfoSimd.dwGearRatios]
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.wGearRatio], ax
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wGearRatio]
		mov	cl, 8
		shr	ax, cl
		mov	[bx+CarState.wGearRatioShr8], ax
		jmp	_lblEndGearChanging2
; ---------------------------------------------------------------------------
		nop

loc_471_34CA:				; CODE XREF: UpdateCarState+130j
		push	[bp+wGripDelta]
		call	_abs
		add	sp, 2
		cmp	ax, [bp+wFpsScale]
		jg	short loc_471_34E6
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wKnobY2]
		jmp	loc_471_3574
; ---------------------------------------------------------------------------
		nop

loc_471_34E6:				; CODE XREF: UpdateCarState+170j
		cmp	[bp+wGripDelta], 0
		jle	short loc_471_34EF
		jmp	loc_471_3583
; ---------------------------------------------------------------------------

loc_471_34EF:				; CODE XREF: UpdateCarState+182j
					; UpdateCarState+218j
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wFpsScale]
		sub	[bx+CarState.wKnobY], ax
		jmp	_lblEndGearChanging2
; ---------------------------------------------------------------------------
		nop

_lblCheckKnobY:				; CODE XREF: UpdateCarState+123j
		mov	bx, [bp+p_pSimdInfo]
		mov	si, [bp+p_pCarState]
		mov	ax, [si+CarState.wKnobY]
		cmp	[bx+CarInfoSimd.arrPtKnobs.y], ax
		jnz	short _lblNoXYKnob
		mov	bx, si
		mov	ax, [bx+CarState.wKnobX2]
		sub	ax, [bx+CarState.wKnobX]
		mov	[bp+wGripDelta], ax
		push	ax
		call	_abs
		add	sp, 2
		cmp	ax, [bp+wFpsScale]
		jg	short loc_471_3530
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wKnobX2]
		mov	[bx+CarState.wKnobX], ax
		jmp	short _lblEndGearChanging2
; ---------------------------------------------------------------------------

loc_471_3530:				; CODE XREF: UpdateCarState+1B9j
		cmp	[bp+wGripDelta], 0
		jle	short loc_471_3542
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wFpsScale]
		add	[bx+CarState.wKnobX], ax
		jmp	short _lblEndGearChanging2
; ---------------------------------------------------------------------------
		nop

loc_471_3542:				; CODE XREF: UpdateCarState+1CCj
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wFpsScale]
		sub	[bx+CarState.wKnobX], ax
		jmp	short _lblEndGearChanging2
; ---------------------------------------------------------------------------
		nop

_lblNoXYKnob:				; CODE XREF: UpdateCarState+1A0j
		mov	bx, [bp+p_pSimdInfo]
		mov	ax, [bx+CarInfoSimd.arrPtKnobs.y]
		mov	bx, [bp+p_pCarState]
		sub	ax, [bx+CarState.wKnobY]
		mov	[bp+wGripDelta], ax
		push	ax
		call	_abs
		add	sp, 2
		cmp	ax, [bp+wFpsScale]
		jg	short loc_471_357A
		mov	bx, [bp+p_pCarState]
		mov	si, [bp+p_pSimdInfo]
		mov	ax, [si+CarInfoSimd.arrPtKnobs.y]

loc_471_3574:				; CODE XREF: UpdateCarState+17Aj
		mov	[bx+CarState.wKnobY], ax
		jmp	short _lblEndGearChanging2
; ---------------------------------------------------------------------------
		nop

loc_471_357A:				; CODE XREF: UpdateCarState+201j
		cmp	[bp+wGripDelta], 0
		jg	short loc_471_3583
		jmp	loc_471_34EF
; ---------------------------------------------------------------------------

loc_471_3583:				; CODE XREF: UpdateCarState+184j
					; UpdateCarState+216j
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wFpsScale]
		add	[bx+CarState.wKnobY], ax
		jmp	short _lblEndGearChanging2
; ---------------------------------------------------------------------------

_lblEndGearChanging:			; CODE XREF: UpdateCarState+118j
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.cFpsMul2],	0
		jz	short _lblEndGearChanging2
		dec	[bx+CarState.cFpsMul2]

_lblEndGearChanging2:			; CODE XREF: UpdateCarState+15Ej
					; UpdateCarState+190j ...
		mov	bx, [bp+p_pCarState]
		mov	ax, [bx+CarState.wTrackGrip] ; field_2a	is used	for lookup in aerorestable
		mov	[bp+wTrackGrip], ax
		mov	si, ax
		mov	cl, 0Ah
		shr	si, cl
		shl	si, 1
		mov	bx, [bp+p_pSimdInfo]
		les	bx, [bx+CarInfoSimd.pAeroResTable]
		mov	di, [bp+p_pCarState]
		mov	ax, [di+CarState.field_1E] ; field_1e is the result of some MatMultVector op
		sub	ax, es:[bx+si]	; pAeroResTable	has 64 words
		mov	[bp+wBrakeValue], ax
		mov	bx, di
		mov	si, [bp+p_pSimdInfo]
		mov	ax, [si+CarInfoSimd.wMaxRpm]
		cmp	[bx+CarState.wCurRpm], ax
		jbe	short loc_471_35DA
		dec	ax
		mov	[bx+CarState.wCurRpm], ax

_lblSingleBraking:			; CODE XREF: UpdateCarState+2B4j
		mov	bx, [bp+p_pSimdInfo]
		mov	ax, [bx+CarInfoSimd.wBrakingEff]
		jmp	short loc_471_3626
; ---------------------------------------------------------------------------
		nop

loc_471_35DA:				; CODE XREF: UpdateCarState+263j
		mov	al, [bp+arg_0]
		and	ax, 3
		cmp	ax, 1		; 1 == accelerate pressed
		jnz	short loc_471_35E8
		jmp	_lblAccelerate
; ---------------------------------------------------------------------------

loc_471_35E8:				; CODE XREF: UpdateCarState+27Bj
		cmp	ax, 2		; 2 == brake key pressed
		jz	short _lblDoBraking
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cIsAccelerating], 0
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cIsBraking], 0
		jmp	short _lblAccelBrakeDone
; ---------------------------------------------------------------------------
		nop

_lblDoBraking:				; CODE XREF: UpdateCarState+283j
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cIsAccelerating], 0
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.field_C6],	0
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cIsBraking], 1
		cmp	[bp+arg_2], 0
		jz	short _lblSingleBraking
		mov	bx, [bp+p_pSimdInfo]
		mov	ax, [bx+CarInfoSimd.wBrakingEff]
		shl	ax, 1		; double brake effictiency here

loc_471_3626:				; CODE XREF: UpdateCarState+26Fj
		sub	[bp+wBrakeValue], ax ; subtract	braking	from aerovalue

_lblAccelBrakeDone:			; CODE XREF: UpdateCarState+295j
					; UpdateCarState+337j ...
		cmp	g_wFramesPerSec, 0Ah
		jnz	short _lblCheckBrakeValue ; double aerovalue if	framespersec = 10 (normal 20)
		mov	ax, [bp+wBrakeValue]
		add	[bp+wBrakeValue], ax

_lblCheckBrakeValue:			; CODE XREF: UpdateCarState+2C6j
		cmp	[bp+wBrakeValue], 0
		jge	short _lblPosAeroValue
		jmp	_lblNegAeroValue
; ---------------------------------------------------------------------------

_lblPosAeroValue:			; CODE XREF: UpdateCarState+2D2j
		cmp	[bp+wTrackGrip], 8000h
		jb	short _lblAddAeroToVar6
		jmp	loc_471_37B2
; ---------------------------------------------------------------------------

_lblAddAeroToVar6:			; CODE XREF: UpdateCarState+2DCj
					; UpdateCarState+474j
		mov	ax, [bp+wBrakeValue]
		add	[bp+wTrackGrip], ax

loc_471_364F:				; CODE XREF: UpdateCarState+45Ej
					; UpdateCarState+466j ...
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.field_C0],	0
		jnz	short loc_471_365C
		jmp	_lblBeginEnding4
; ---------------------------------------------------------------------------

loc_471_365C:				; CODE XREF: UpdateCarState+2EFj
		mov	ax, [bx+CarState.wTrackGrip2]
		sub	ax, [bp+wTrackGrip]
		mov	[bp+wGripDelta], ax
		or	ax, ax
		jl	short loc_471_366C
		jmp	_lblBeginEnding
; ---------------------------------------------------------------------------

loc_471_366C:				; CODE XREF: UpdateCarState+2FFj
		neg	ax
		jmp	_lblBeginEnding2
; ---------------------------------------------------------------------------
		nop

_lblAccelerate:				; CODE XREF: UpdateCarState+27Dj
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cIsBraking], 0
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.cIsAccelerating], 1
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.cChangingGear], 0
		jz	short loc_471_36AC
		mov	[bx+CarState.field_C6],	0
		cmp	g_wFramesPerSec, 0Ah
		jnz	short _lblAccelerateLess
		mov	bx, [bp+p_pCarState]
		sub	[bx+CarState.wCurRpm], 50h ; accelerate	= subtract?
		jmp	short _lblAccelBrakeDone
; ---------------------------------------------------------------------------
		nop

_lblAccelerateLess:			; CODE XREF: UpdateCarState+32Ej
		mov	bx, [bp+p_pCarState]
		sub	[bx+CarState.wCurRpm], 28h ; accelerate	= subtract?
		jmp	_lblAccelBrakeDone
; ---------------------------------------------------------------------------

loc_471_36AC:				; CODE XREF: UpdateCarState+322j
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.field_C0],	0
		jnz	short loc_471_36D6
		mov	si, [bp+p_pSimdInfo]
		mov	ax, [si+CarInfoSimd.wMaxRpm]
		cmp	[bx+CarState.wCurRpm], ax
		jb	short loc_471_36C4
		jmp	_lblAccelBrakeDone
; ---------------------------------------------------------------------------

loc_471_36C4:				; CODE XREF: UpdateCarState+357j
		cmp	[bp+wTrackGrip], 0FA00h
		jb	short loc_471_36CE
		jmp	_lblAccelBrakeDone
; ---------------------------------------------------------------------------

loc_471_36CE:				; CODE XREF: UpdateCarState+361j
		add	byte ptr [bp+wBrakeValue+1], 3
		jmp	_lblAccelBrakeDone
; ---------------------------------------------------------------------------
		nop

loc_471_36D6:				; CODE XREF: UpdateCarState+34Cj
		cmp	[bx+CarState.cCurrentGear], 1
		jg	short loc_471_36EC
		cmp	[bx+CarState.wCurRpm], 0A28h
		jge	short loc_471_36EC
		mov	bx, [bp+p_pSimdInfo]
		mov	al, [bx+CarInfoSimd.cTorqueCurve]
		jmp	short loc_471_36FC
; ---------------------------------------------------------------------------

loc_471_36EC:				; CODE XREF: UpdateCarState+373j
					; UpdateCarState+37Aj
		mov	bx, [bp+p_pCarState]
		mov	si, [bx+CarState.wCurRpm]
		mov	cl, 7
		shr	si, cl
		mov	bx, [bp+p_pSimdInfo]
		mov	al, [bx+si+(CarInfoSimd.cTorqueCurve+1)]

loc_471_36FC:				; CODE XREF: UpdateCarState+382j
		mov	[bp+var_A], al
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.field_C6],	0
		jz	short loc_471_3724
		cmp	[bx+CarState.wCurRpm], 1388h
		jge	short loc_471_3724
		mov	bx, [bp+p_pSimdInfo]
		mov	al, [bx+CarInfoSimd.cTorqueCurve]
		sub	ah, ah
		mov	cl, [bp+var_A]
		sub	ch, ch
		add	ax, cx
		shr	ax, 1
		mov	[bp+var_A], al

loc_471_3724:				; CODE XREF: UpdateCarState+39Fj
					; UpdateCarState+3A6j
		mov	al, [bp+var_A]
		sub	ah, ah
		mov	cx, ax
		mov	bx, [bp+p_pCarState]
		mov	ax, [bx+CarState.wGearRatioShr8]
		mul	cx
		mov	cl, 4
		shr	ax, cl
		add	[bp+wBrakeValue], ax
		mov	bx, [bp+p_pSimdInfo]
		sub	ax, ax
		push	ax
		push	[bx+CarInfoSimd.wCarMass]
		mov	ax, 19h
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wBrakeValue]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFuldiv
		sar	ax, 1
		mov	[bp+wBrakeValue], ax
		cmp	[bp+arg_2], 0
		jz	short loc_471_379D
		mov	al, byte_2B77_95E0
		sub	ah, ah
		sub	ax, 0C8h
		neg	ax
		shr	ax, 1
		mov	[bp+var_A], al
		or	al, al
		jz	short loc_471_379D
		mov	ax, 0C8h
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wBrakeValue]
		cwd
		push	dx
		push	ax
		mov	al, [bp+var_A]
		sub	ah, ah
		sub	cx, cx
		push	cx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		sub	[bp+wBrakeValue], ax

loc_471_379D:				; CODE XREF: UpdateCarState+3FCj
					; UpdateCarState+40Fj
		cmp	[bp+wBrakeValue], 128h
		jg	short loc_471_37A7
		jmp	_lblAccelBrakeDone
; ---------------------------------------------------------------------------

loc_471_37A7:				; CODE XREF: UpdateCarState+43Aj
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.field_C6],	5
		jmp	_lblAccelBrakeDone
; ---------------------------------------------------------------------------

loc_471_37B2:				; CODE XREF: UpdateCarState+2DEj
		mov	ax, [bp+wBrakeValue]
		add	[bp+wTrackGrip], ax
		cmp	[bp+wTrackGrip], 8000h
		jb	short loc_471_37C9
		cmp	[bp+wTrackGrip], 0F500h
		ja	short loc_471_37C9
		jmp	loc_471_364F
; ---------------------------------------------------------------------------

loc_471_37C9:				; CODE XREF: UpdateCarState+455j
					; UpdateCarState+45Cj
		mov	[bp+wTrackGrip], 0F500h
		jmp	loc_471_364F
; ---------------------------------------------------------------------------
		nop

_lblNegAeroValue:			; CODE XREF: UpdateCarState+2D4j
		mov	ax, [bp+wBrakeValue]
		neg	ax
		cmp	ax, [bp+wTrackGrip]
		ja	short _lblZeroVar6
		jmp	_lblAddAeroToVar6
; ---------------------------------------------------------------------------

_lblZeroVar6:				; CODE XREF: UpdateCarState+472j
		mov	[bp+wTrackGrip], 0
		jmp	loc_471_364F
; ---------------------------------------------------------------------------
		nop

; evenerthing from here	just flows to the end

_lblBeginEnding:			; CODE XREF: UpdateCarState+301j
		mov	ax, [bp+wGripDelta]

_lblBeginEnding2:			; CODE XREF: UpdateCarState+306j
		cmp	ax, 1400h
		jle	short _lblBeginEnding3
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip]
		sub	dx, dx
		add	ax, [si+CarState.wTrackGrip2]
		adc	dx, dx
		shr	dx, 1
		rcr	ax, 1
		mov	[bx+CarState.wTrackGrip], ax
		mov	bx, [bp+p_pCarState]
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip]
		mov	[bx+CarState.wTrackGrip2], ax
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.field_C6],	5
		jmp	short loc_471_3835
; ---------------------------------------------------------------------------

_lblBeginEnding3:			; CODE XREF: UpdateCarState+486j
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wTrackGrip]
		mov	[bx+CarState.wTrackGrip], ax
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wTrackGrip]
		mov	[bx+CarState.wTrackGrip2], ax
		jmp	short loc_471_3835
; ---------------------------------------------------------------------------

_lblBeginEnding4:			; CODE XREF: UpdateCarState+2F1j
		mov	bx, [bp+p_pCarState]
		mov	ax, [bp+wTrackGrip]
		mov	[bx+CarState.wTrackGrip], ax

loc_471_3835:				; CODE XREF: UpdateCarState+4AEj
					; UpdateCarState+4C2j
		mov	bx, [bp+p_pSimdInfo]
		push	[bx+CarInfoSimd.wIdleRpm]
		mov	bx, [bp+p_pCarState]
		mov	al, [bx+CarState.cChangingGear]
		cbw
		push	ax
		push	[bx+CarState.wGearRatio]
		push	[bx+CarState.wTrackGrip]
		push	[bx+CarState.wCurRpm]
		call	GearRpmCalculation
		add	sp, 0Ah
		mov	bx, [bp+p_pCarState]
		mov	[bx+CarState.wCurRpm], ax
		mov	bx, [bp+p_pCarState]
		cmp	[bx+CarState.field_C1],	0
		jz	short loc_471_38AF
		mov	si, bx
		mov	ax, [si+CarState.wCurRpm]
		cmp	[bx+CarState.wLastRpm],	ax
		jle	short loc_471_38AF
		mov	ax, [bx+CarState.wLastRpm]
		sub	ax, [bx+CarState.wCurRpm]
		cmp	ax, 7D0h	; 2000
		jle	short loc_471_3894
		mov	bx, [bp+p_pSimdInfo]
		mov	al, [bx+CarInfoSimd.cTorqueCurve]
		sub	ah, ah
		mov	bx, si
		mul	[bx+CarState.wGearRatioShr8]
		cmp	ax, 2EE0h	; 12000
		jle	short loc_471_38AF
		mov	[bx+CarState.field_C6],	1Eh
		jmp	short loc_471_38AF
; ---------------------------------------------------------------------------
		nop

loc_471_3894:				; CODE XREF: UpdateCarState+510j
		mov	bx, [bp+p_pCarState]
		mov	ax, [bx+CarState.wCurRpm]
		sub	ax, [bx+CarState.wLastRpm]
		cmp	ax, 7D0h	; 2000
		jle	short loc_471_38AF
		mov	[bx+CarState.field_C6],	0Ah
		mov	bx, [bp+p_pCarState]
		sub	[bx+CarState.wTrackGrip2], 500h

loc_471_38AF:				; CODE XREF: UpdateCarState+4FBj
					; UpdateCarState+505j ...
		mov	bx, [bp+p_pCarState]
		mov	ax, gameState.field_14E
		cmp	[bx+CarState.wTrackGrip2], ax
		jbe	short loc_471_38C0
		mov	ax, [bx+CarState.wTrackGrip2]
		mov	gameState.field_14E, ax

loc_471_38C0:				; CODE XREF: UpdateCarState+550j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
UpdateCarState	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CvxOpSimdTrack	proc far		; CODE XREF: OpponentOp+50Cp
					; PlayerOp+91p

var_10		= word ptr -10h
var_E		= byte ptr -0Eh
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah
wNumGripIdx4	= word ptr -8
wSurfaceGripSum	= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pCvx		= word ptr  6
p_pSimd		= word ptr  8		; is a simd
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	di
		push	si
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_C1],	0
		jnz	short loc_471_38EC
		mov	[bx+CarState.field_40],	0
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C7],	0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_38EC:				; CODE XREF: CvxOpSimdTrack+10j
		mov	[bp+wNumGripIdx4], 0
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.cSurfaceGripIndex1], 4
		jnz	short loc_471_38FE
		inc	[bp+wNumGripIdx4]

loc_471_38FE:				; CODE XREF: CvxOpSimdTrack+33j
		cmp	[bx+CarState.cSurfaceGripIndex2], 4
		jnz	short loc_471_3908
		inc	[bp+wNumGripIdx4]

loc_471_3908:				; CODE XREF: CvxOpSimdTrack+3Dj
		cmp	[bx+CarState.cSurfaceGripIndex3], 4
		jnz	short loc_471_3912
		inc	[bp+wNumGripIdx4]

loc_471_3912:				; CODE XREF: CvxOpSimdTrack+47j
		cmp	[bx+CarState.cSurfaceGripIndex4], 4
		jnz	short loc_471_391C
		inc	[bp+wNumGripIdx4]

loc_471_391C:				; CODE XREF: CvxOpSimdTrack+51j
		cmp	[bp+wNumGripIdx4], 0
		jz	short loc_471_3941 ; skip this if no surfacegripindexes	were 4
		mov	ax, [bx+CarState.wTrackGrip2]
		sub	dx, dx
		mov	bx, [bp+wNumGripIdx4]
		shl	bx, 1
		div	g_pwBrakeDivTab[bx]
		mov	bx, [bp+p_pCvx]
		sub	[bx+CarState.wTrackGrip2], ax
		mov	bx, [bp+p_pCvx]
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip2]
		mov	[bx+CarState.wTrackGrip], ax

loc_471_3941:				; CODE XREF: CvxOpSimdTrack+5Aj
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.field_20]
		add	ax, [bx+CarState.field_36]
		mov	[bp+var_10], ax
		mov	[bp+var_C], ax
		mov	ax, [bx+CarState.wTrackGrip]
		mov	cl, 8
		shr	ax, cl
		mov	[bp+var_2], ax
		cmp	[bp+var_C], 0
		jge	short loc_471_3968
		mov	ax, [bp+var_C]
		neg	ax
		jmp	short loc_471_396B
; ---------------------------------------------------------------------------
		nop

loc_471_3968:				; CODE XREF: CvxOpSimdTrack+98j
		mov	ax, [bp+var_C]

loc_471_396B:				; CODE XREF: CvxOpSimdTrack+9Fj
		mov	cl, 3
		sar	ax, cl
		mov	[bp+wNumGripIdx4], ax
		mov	ax, [bp+var_2]
		mul	ax
		mov	cl, 6
		shr	ax, cl
		mul	[bp+wNumGripIdx4]
		mov	[bp+var_4], ax
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+CarInfoSimd.dwGrip]
		shl	ax, 1
		mov	[bp+wSurfaceGripSum], ax
		cwd
		push	dx
		push	ax
		mov	bx, [bp+p_pCvx]
		mov	al, [bx+CarState.cSurfaceGripIndex4]
		cbw
		mov	si, ax
		shl	si, 1
		mov	bx, [bp+p_pSimd]
		mov	di, [bp+p_pCvx]
		mov	al, [di+CarState.cSurfaceGripIndex3]
		cbw
		mov	di, ax
		shl	di, 1
		mov	ax, [bx+si+CarInfoSimd.wSurfaceGrip]
		mov	bx, [bp+p_pCvx]
		mov	cx, ax
		mov	al, [bx+CarState.cSurfaceGripIndex2]
		cbw
		mov	si, ax
		shl	si, 1
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+si+CarInfoSimd.wSurfaceGrip]
		mov	bx, [bp+p_pCvx]
		mov	dx, ax
		mov	al, [bx+CarState.cSurfaceGripIndex1]
		cbw
		mov	si, ax
		shl	si, 1
		mov	bx, [bp+p_pSimd]
		mov	ax, [bx+si+CarInfoSimd.wSurfaceGrip]
		add	ax, dx
		add	ax, [bx+di+CarInfoSimd.wSurfaceGrip]
		add	ax, cx
		cwd
		push	dx
		push	ax
		call	__aFlmul


		mov	cl, 0Ah

loc_471_39EB:				; CODE XREF: CvxOpSimdTrack+12Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_39EB ; loop 0a times


		mov	[bp+wSurfaceGripSum], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+var_4]
		mov	[bx+CarState.field_44],	ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+wSurfaceGripSum]
		mov	[bx+CarState.wSurfaceGripSum], ax
		cmp	[bp+arg_4], 0
		jnz	short loc_471_3A11
		jmp	loc_471_3C4E
; ---------------------------------------------------------------------------

loc_471_3A11:				; CODE XREF: CvxOpSimdTrack+146j
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_20],	0
		jnz	short loc_471_3A58
		mov	al, byte ptr [bx+CarState.vecRotate.wX]
		sub	ah, ah
		mov	[bp+wNumGripIdx4], ax
		cmp	ax, 7Fh	; ''
		jle	short loc_471_3A2C
		sub	[bp+wNumGripIdx4], 100h

loc_471_3A2C:				; CODE XREF: CvxOpSimdTrack+15Fj
		cmp	[bp+wNumGripIdx4], 0
		jz	short loc_471_3A58
		jge	short loc_471_3A3C
		mov	ax, [bp+wNumGripIdx4]
		neg	ax
		jmp	short loc_471_3A3F
; ---------------------------------------------------------------------------
		nop

loc_471_3A3C:				; CODE XREF: CvxOpSimdTrack+16Cj
		mov	ax, [bp+wNumGripIdx4]

loc_471_3A3F:				; CODE XREF: CvxOpSimdTrack+173j
		cmp	ax, 8
		jge	short loc_471_3A58
		cmp	[bp+wNumGripIdx4], 0
		jle	short loc_471_3A52
		mov	bx, [bp+p_pCvx]
		dec	[bx+CarState.vecRotate.wX]
		jmp	short loc_471_3A58
; ---------------------------------------------------------------------------

loc_471_3A52:				; CODE XREF: CvxOpSimdTrack+182j
		mov	bx, [bp+p_pCvx]
		inc	[bx+CarState.vecRotate.wX]

loc_471_3A58:				; CODE XREF: CvxOpSimdTrack+152j
					; CvxOpSimdTrack+16Aj ...
		mov	ax, [bp+wSurfaceGripSum]
		cmp	[bp+var_4], ax
		jle	short loc_471_3ABE
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C7],	1
		mov	ax, [bp+var_2]
		cwd
		push	dx
		push	ax
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		mov	ax, [bp+wSurfaceGripSum]
		cwd
		mov	dh, dl
		mov	dl, ah
		mov	ah, al
		sub	al, al
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+var_C], ax
		cmp	[bp+var_10], 0
		jge	short loc_471_3A9D
		mov	ax, 0FFFFh
		imul	[bp+var_C]
		mov	[bp+var_C], ax

loc_471_3A9D:				; CODE XREF: CvxOpSimdTrack+1CCj
		mov	ax, [bp+var_C]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	ax, [bp+var_10]
		sar	ax, 1
		sar	ax, 1
		mov	[bp+var_C], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+var_10]
		sub	ax, [bp+var_C]
		mov	[bx+CarState.field_42],	ax
		jmp	short loc_471_3AF7
; ---------------------------------------------------------------------------

loc_471_3ABE:				; CODE XREF: CvxOpSimdTrack+198j
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C7],	0
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_42],	0
		jz	short loc_471_3AF7
		mov	si, bx
		mov	ax, [si+CarState.field_42]
		mov	cl, 4
		sar	ax, cl
		sub	[bx+CarState.field_42],	ax
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_42],	0
		jge	short loc_471_3AEC
		mov	ax, [bx+CarState.field_42]
		neg	ax
		jmp	short loc_471_3AEF
; ---------------------------------------------------------------------------
		nop

loc_471_3AEC:				; CODE XREF: CvxOpSimdTrack+21Cj
		mov	ax, [bx+CarState.field_42]

loc_471_3AEF:				; CODE XREF: CvxOpSimdTrack+223j
		cmp	ax, 10h
		jge	short loc_471_3AF7
		sar	[bx+CarState.field_42],	1

loc_471_3AF7:				; CODE XREF: CvxOpSimdTrack+1F6j
					; CvxOpSimdTrack+207j ...
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.wAngleZ], 0
		jnz	short loc_471_3B10
		cmp	[bx+CarState.field_C9],	1
		jz	short loc_471_3B10
		mov	ax, [bp+var_C]
		mov	[bx+CarState.field_40],	ax
		jmp	short loc_471_3B18
; ---------------------------------------------------------------------------
		nop

loc_471_3B10:				; CODE XREF: CvxOpSimdTrack+238j
					; CvxOpSimdTrack+23Fj
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_40],	0

loc_471_3B18:				; CODE XREF: CvxOpSimdTrack+247j
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.vecRotate.wZ], 0
		jnz	short loc_471_3B24
		jmp	loc_471_3BAD
; ---------------------------------------------------------------------------

loc_471_3B24:				; CODE XREF: CvxOpSimdTrack+259j
		jge	short loc_471_3B2E
		mov	ax, [bx+CarState.vecRotate.wZ]
		neg	ax
		jmp	short loc_471_3B31
; ---------------------------------------------------------------------------
		nop

loc_471_3B2E:				; CODE XREF: CvxOpSimdTrack:loc_471_3B24j
		mov	ax, [bx+CarState.vecRotate.wZ]

loc_471_3B31:				; CODE XREF: CvxOpSimdTrack+265j
		cmp	ax, 4
		jle	short loc_471_3BAD
		mov	al, byte ptr [bx+(CarState.vecLongUnk.dwX+2)]
		mov	[bp+var_A], al
		mov	al, byte ptr [bx+(CarState.vecLongUnk.dwZ+2)]
		mov	[bp+var_E], al
		mov	bl, al
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+var_A]
		sub	ah, ah
		add	bx, ax
		les	si, g_ppTrakdata14
		mov	al, es:[bx+si+TrackInfo.pTrackData]
		cmp	ax, 0FDh ; 'ý'
		jz	short loc_471_3B6C
		cmp	ax, 0FEh ; 'þ'
		jz	short loc_471_3B6F
		cmp	ax, 0FFh
		jz	short loc_471_3B98
		jmp	short loc_471_3B72
; ---------------------------------------------------------------------------
		nop

loc_471_3B6C:				; CODE XREF: CvxOpSimdTrack+297j
		dec	[bp+var_A]

loc_471_3B6F:				; CODE XREF: CvxOpSimdTrack+29Cj
		inc	[bp+var_E]

loc_471_3B72:				; CODE XREF: CvxOpSimdTrack+2A3j
					; CvxOpSimdTrack+2D5j
		mov	bl, [bp+var_E]
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+var_A]
		sub	ah, ah
		add	bx, ax
		les	si, g_ppTrakdata14
		mov	al, es:[bx+si+TrackInfo.pTrackData]
		cmp	ax, 34h	; '4'
		jb	short loc_471_3BAD
		cmp	ax, 37h	; '7'
		jbe	short loc_471_3B9E
		jmp	short loc_471_3BAD
; ---------------------------------------------------------------------------
		nop

loc_471_3B98:				; CODE XREF: CvxOpSimdTrack+2A1j
		dec	[bp+var_A]
		jmp	short loc_471_3B72
; ---------------------------------------------------------------------------
		nop

loc_471_3B9E:				; CODE XREF: CvxOpSimdTrack+2CDj
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.vecRotate.wZ]
		cwd
		mov	cx, 5
		idiv	cx
		add	[bx+CarState.field_40],	ax

loc_471_3BAD:				; CODE XREF: CvxOpSimdTrack+25Bj
					; CvxOpSimdTrack+26Ej ...
		mov	ax, [bp+wSurfaceGripSum]
		add	ax, 3E8h
		cmp	ax, [bp+var_4]
		jge	short loc_471_3BDA
		mov	ax, [bp+var_C]
		sub	ax, [bp+var_10]
		cwd
		mov	cx, 0Eh
		idiv	cx
		mov	bx, [bp+p_pCvx]
		add	[bx+CarState.wAngleZ], ax
		mov	bx, [bp+p_pCvx]
		mov	cx, 2
		mov	ax, [bx+CarState.wAngleZ]
		cwd
		idiv	cx
		jmp	loc_471_3C7B
; ---------------------------------------------------------------------------
		nop

loc_471_3BDA:				; CODE XREF: CvxOpSimdTrack+2F0j
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.wAngleZ], 0
		jnz	short loc_471_3BE6
		jmp	loc_471_3C7E
; ---------------------------------------------------------------------------

loc_471_3BE6:				; CODE XREF: CvxOpSimdTrack+31Bj
		mov	ax, [bp+var_C]
		sub	ax, [bp+var_10]
		cwd
		mov	cx, 0Eh
		idiv	cx
		add	[bx+CarState.wAngleZ], ax
		mov	bx, [bp+p_pCvx]
		mov	cx, 2
		mov	ax, [bx+CarState.wAngleZ]
		cwd
		idiv	cx
		mov	[bx+CarState.wAngleZ], ax
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.wAngleZ], 0
		jnz	short loc_471_3C7E
		push	[bx+CarState.wTrackGrip2]
		push	[bx+CarState.field_36]
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip2], ax
		mov	bx, [bp+p_pCvx]
		push	[bx+CarState.field_36]
		call	LookupCos
		add	sp, 2
		or	ax, ax
		jge	short loc_471_3C44
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip2], 0

loc_471_3C44:				; CODE XREF: CvxOpSimdTrack+374j
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_36],	0
		jmp	short loc_471_3C7E
; ---------------------------------------------------------------------------

loc_471_3C4E:				; CODE XREF: CvxOpSimdTrack+148j
		mov	bx, [bp+p_pCvx]
		mov	si, bx
		mov	ax, [si+CarState.field_20]
		shl	ax, 1
		shl	ax, 1
		mov	[bx+CarState.field_40],	ax
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.wAngleZ], 0
		jz	short loc_471_3C7E
		mov	si, bx
		mov	ax, [si+CarState.wAngleZ]
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		sub	ax, cx
		mov	cl, 4
		sar	ax, cl

loc_471_3C7B:				; CODE XREF: CvxOpSimdTrack+310j
		mov	[bx+CarState.wAngleZ], ax

loc_471_3C7E:				; CODE XREF: CvxOpSimdTrack+31Dj
					; CvxOpSimdTrack+345j ...
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_36],	0
		jz	short loc_471_3CA5
		cmp	[bx+CarState.wAngleZ], 0
		jnz	short loc_471_3CA5
		mov	si, bx
		mov	ax, [si+CarState.field_36]
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		sub	ax, cx
		mov	cl, 4
		sar	ax, cl
		mov	[bx+CarState.field_36],	ax

loc_471_3CA5:				; CODE XREF: CvxOpSimdTrack+3BFj
					; CvxOpSimdTrack+3C5j
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.wAngleZ], 0
		jz	short loc_471_3CB6
		mov	si, bx
		mov	ax, [si+CarState.wAngleZ]
		sub	[bx+CarState.field_36],	ax

loc_471_3CB6:				; CODE XREF: CvxOpSimdTrack+3E6j
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_C7],	0
		jnz	short loc_471_3CC3
		jmp	loc_471_3D48
; ---------------------------------------------------------------------------

loc_471_3CC3:				; CODE XREF: CvxOpSimdTrack+3F8j
		cmp	[bx+CarState.field_42],	0
		jge	short loc_471_3CD0
		mov	ax, [bx+CarState.field_42]
		neg	ax
		jmp	short loc_471_3CD3
; ---------------------------------------------------------------------------

loc_471_3CD0:				; CODE XREF: CvxOpSimdTrack+401j
		mov	ax, [bx+CarState.field_42]

loc_471_3CD3:				; CODE XREF: CvxOpSimdTrack+408j
		shl	ax, 1
		mov	[bp+wNumGripIdx4], ax
		cmp	[bx+CarState.wTrackGrip], ax
		jbe	short loc_471_3D38
		cmp	[bx+CarState.wTrackGrip2], ax
		jbe	short loc_471_3CF0
		sub	[bx+CarState.wTrackGrip], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+wNumGripIdx4]
		sub	[bx+CarState.wTrackGrip2], ax
		jmp	short loc_471_3D00
; ---------------------------------------------------------------------------

loc_471_3CF0:				; CODE XREF: CvxOpSimdTrack+41Aj
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip], 0
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip2], 0

loc_471_3D00:				; CODE XREF: CvxOpSimdTrack+428j
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_C9],	0
		jnz	short loc_471_3D48
		cmp	[bx+CarState.cSurfaceGripIndex1], 1
		jz	short loc_471_3D26
		cmp	[bx+CarState.cSurfaceGripIndex2], 1
		jz	short loc_471_3D26
		cmp	[bx+CarState.cSurfaceGripIndex3], 1
		jz	short loc_471_3D26
		cmp	[bx+CarState.cSurfaceGripIndex4], 1
		jnz	short loc_471_3D2E

loc_471_3D26:				; CODE XREF: CvxOpSimdTrack+449j
					; CvxOpSimdTrack+450j ...
		or	[bx+CarState.field_CF],	2
		jmp	short loc_471_3D48
; ---------------------------------------------------------------------------
		nop

loc_471_3D2E:				; CODE XREF: CvxOpSimdTrack+45Ej
		mov	bx, [bp+p_pCvx]
		or	[bx+CarState.field_CF],	4
		jmp	short loc_471_3D48
; ---------------------------------------------------------------------------

loc_471_3D38:				; CODE XREF: CvxOpSimdTrack+415j
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip], 0
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.wTrackGrip2], 0

loc_471_3D48:				; CODE XREF: CvxOpSimdTrack+3FAj
					; CvxOpSimdTrack+442j ...
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_42],	0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
CvxOpSimdTrack	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CompareUpdate2Cvx proc far		; CODE XREF: TrkPlanSimd+17A1p

var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pCvx2		= word ptr  6
p_pCvx		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 18h
		push	si
		mov	bx, [bp+p_pCvx2]
		mov	[bx+CarState.field_C8],	1
		mov	bx, [bp+p_pCvx]
		mov	[bx+CarState.field_C8],	1
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.wTrackGrip2]
		mov	[bp+var_6], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.wTrackGrip2]
		mov	[bp+var_C], ax
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bx+CarState.vecRotate.wX]
		mov	[bp+var_2], ax
		mov	bx, [bp+p_pCvx]
		mov	ax, [bx+CarState.vecRotate.wX]
		mov	[bp+var_4], ax
		push	[bp+var_2]
		call	LookupSine
		add	sp, 2
		push	ax
		mov	ax, [bp+var_6]
		mov	cl, 8
		shr	ax, cl
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	[bp+var_10], ax
		push	[bp+var_4]
		call	LookupSine
		add	sp, 2
		push	ax
		mov	ax, [bp+var_C]
		mov	cl, 8
		shr	ax, cl
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	[bp+var_14], ax
		push	[bp+var_2]
		call	LookupCos
		add	sp, 2
		push	ax
		mov	ax, [bp+var_6]
		mov	cl, 8
		shr	ax, cl
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	[bp+var_12], ax
		push	[bp+var_4]
		call	LookupCos
		add	sp, 2
		push	ax
		mov	ax, [bp+var_C]
		mov	cl, 8
		shr	ax, cl
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	[bp+var_16], ax
		sub	ax, [bp+var_12]
		push	ax
		mov	ax, [bp+var_14]
		sub	ax, [bp+var_10]
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_A], ax	; var_a	goes to	10
		cmp	ax, 0Ah
		jge	short loc_471_3E2D
		mov	[bp+var_A], 0Ah

loc_471_3E2D:				; CODE XREF: CompareUpdate2Cvx+D0j
		mov	ax, [bp+var_2]
		sub	ax, [bp+var_4]
		and	ah, 3
		mov	[bp+var_8], ax
		mov	ah, byte ptr [bp+var_A]
		sub	al, al
		mov	[bp+var_E], ax
		mov	ax, 300h
		imul	[bp+var_A]
		sar	ax, 1
		sar	ax, 1
		mov	[bp+var_18], ax
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+CarState.wTrackGrip2], ax
		jnb	short loc_471_3E5E
		mov	[bx+CarState.wTrackGrip2], 0
		jmp	short loc_471_3E67
; ---------------------------------------------------------------------------
		nop

loc_471_3E5E:				; CODE XREF: CompareUpdate2Cvx+FEj
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bp+var_18]
		sub	[bx+CarState.wTrackGrip2], ax

loc_471_3E67:				; CODE XREF: CompareUpdate2Cvx+105j
		mov	bx, [bp+p_pCvx2]
		mov	ax, [bp+var_4]
		sub	ax, [bp+var_2]
		mov	[bx+CarState.field_36],	ax
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+CarState.field_36],	200h
		jl	short loc_471_3E82
		sub	[bx+CarState.field_36],	400h

loc_471_3E82:				; CODE XREF: CompareUpdate2Cvx+125j
		mov	bx, [bp+p_pCvx2]
		cmp	[bx+CarState.field_36],	0FE00h
		jg	short loc_471_3E90
		add	byte ptr [bx+(CarState.field_36+1)], 4

loc_471_3E90:				; CODE XREF: CompareUpdate2Cvx+134j
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+var_2]
		sub	ax, [bp+var_4]
		mov	[bx+CarState.field_36],	ax
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_36],	200h
		jl	short loc_471_3EAB
		sub	[bx+CarState.field_36],	400h

loc_471_3EAB:				; CODE XREF: CompareUpdate2Cvx+14Ej
		mov	bx, [bp+p_pCvx]
		cmp	[bx+CarState.field_36],	0FE00h
		jg	short loc_471_3EB9
		add	byte ptr [bx+(CarState.field_36+1)], 4

loc_471_3EB9:				; CODE XREF: CompareUpdate2Cvx+15Dj
		mov	bx, [bp+p_pCvx2]
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip2]
		mov	[bx+CarState.wTrackGrip], ax
		mov	bx, [bp+p_pCvx]
		mov	si, bx
		mov	ax, [si+CarState.wTrackGrip2]
		mov	[bx+CarState.wTrackGrip], ax
		cmp	[bp+var_A], 1Eh
		jle	short loc_471_3EDE
		mov	ax, 1
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_3EDE:				; CODE XREF: CompareUpdate2Cvx+17Dj
		sub	ax, ax
		pop	si
		mov	sp, bp
		pop	bp
		retf
CompareUpdate2Cvx endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitCarCvx64_64	proc far		; CODE XREF: TrkPlanSimd+10C8p

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pCvx		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		mov	ax, [si+CarState.rc2.dwLeft]
		mov	[bp+var_2], ax
		mov	[bp+var_4], 0
		mov	[bp+var_6], 0
		cmp	[si+CarState.rc5.dwLeft], 0
		jz	short loc_471_3F49
		jge	short loc_471_3F26
		add	[si+CarState.rc5.dwLeft], 4
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		add	si, CarState.rc5
		mov	ax, [si]
		cmp	[bp+var_6], ax
		jge	short loc_471_3F49
		jmp	short loc_471_3F44
; ---------------------------------------------------------------------------

loc_471_3F26:				; CODE XREF: InitCarCvx64_64+26j
		mov	di, [bp+arg_4]
		shl	di, 1
		mov	bx, [bp+p_pCvx]
		sub	[bx+di+CarState.rc5.dwLeft], 4
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		add	si, CarState.rc5
		mov	ax, [si+Rectangle.dwLeft]
		cmp	[bp+var_6], ax
		jle	short loc_471_3F49

loc_471_3F44:				; CODE XREF: InitCarCvx64_64+3Ej
		mov	ax, [bp+var_6]
		mov	word ptr [si+CarState.vecLongUnk.dwX], ax

loc_471_3F49:				; CODE XREF: InitCarCvx64_64+24j
					; InitCarCvx64_64+3Cj ...
		mov	di, [bp+arg_4]
		shl	di, 1
		mov	bx, [bp+p_pCvx]
		mov	si, [bx+di+CarState.rc5.dwLeft]
		mov	di, [bp+arg_4]
		shl	di, 1
		mov	[bx+di+CarState.rc5.dwLeft], si
		cmp	[bp+arg_2], 0
		jge	short loc_471_3F79
		mov	di, [bp+arg_4]
		shl	di, 1
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+arg_2]
		neg	ax
		cmp	[bx+di+CarState.rc2.dwLeft], ax
		jle	short loc_471_3F79
		mov	[bp+arg_2], 0

loc_471_3F79:				; CODE XREF: InitCarCvx64_64+7Aj
					; InitCarCvx64_64+8Cj
		cmp	[bp+arg_2], 0
		jnz	short loc_471_3FEA
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		mov	ax, [si+CarState.rc5.dwLeft]
		cmp	[si+CarState.rc2.dwLeft], ax
		jle	short loc_471_3FB8
		sub	[si+CarState.rc2.dwLeft], 80h ;	'€'
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		mov	ax, [si+CarState.rc5.dwLeft]
		cmp	[si+CarState.rc2.dwLeft], ax
		jge	short loc_471_3FA7
		mov	[si+CarState.rc2.dwLeft], ax

loc_471_3FA7:				; CODE XREF: InitCarCvx64_64+BCj
		mov	ax, [bp+var_2]
		mov	si, [bp+arg_4]
		shl	si, 1
		mov	bx, [bp+p_pCvx]
		sub	ax, [bx+si+CarState.rc2.dwLeft]
		jmp	loc_471_4092
; ---------------------------------------------------------------------------

loc_471_3FB8:				; CODE XREF: InitCarCvx64_64+A7j
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		mov	ax, [si+CarState.rc5.dwLeft]
		cmp	[si+CarState.rc2.dwLeft], ax
		jl	short loc_471_3FCB
		jmp	loc_471_4095
; ---------------------------------------------------------------------------

loc_471_3FCB:				; CODE XREF: InitCarCvx64_64+E0j
		add	[si+CarState.rc2.dwLeft], 80h ;	'€'
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		mov	ax, [si+CarState.rc5.dwLeft]
		cmp	[si+CarState.rc2.dwLeft], ax
		jg	short loc_471_3FE3
		jmp	loc_471_4095
; ---------------------------------------------------------------------------

loc_471_3FE3:				; CODE XREF: InitCarCvx64_64+F8j
		mov	[si+CarState.rc2.dwLeft], ax
		jmp	loc_471_4095
; ---------------------------------------------------------------------------
		nop

loc_471_3FEA:				; CODE XREF: InitCarCvx64_64+97j
		cmp	[bp+arg_2], 0
		jle	short loc_471_4038
		cmp	[bp+arg_2], 0C0h ; 'À'
		jle	short loc_471_4006
		mov	si, [bp+arg_4]
		shl	si, 1
		mov	bx, [bp+p_pCvx]
		add	[bx+si+CarState.rc2.dwLeft], 0C0h ; 'À'
		jmp	short loc_471_4014
; ---------------------------------------------------------------------------

loc_471_4006:				; CODE XREF: InitCarCvx64_64+10Fj
		mov	si, [bp+arg_4]
		shl	si, 1
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+arg_2]
		add	[bx+si+CarState.rc2.dwLeft], ax

loc_471_4014:				; CODE XREF: InitCarCvx64_64+11Ej
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		add	si, CarState.rc2
		cmp	word ptr [si], 180h
		jle	short loc_471_4029
		mov	word ptr [si], 180h

loc_471_4029:				; CODE XREF: InitCarCvx64_64+13Dj
		mov	si, [bp+arg_4]
		shl	si, 1
		mov	bx, [bp+p_pCvx]
		mov	[bx+si+CarState.rc4.dwLeft], 0
		jmp	short loc_471_4095
; ---------------------------------------------------------------------------

loc_471_4038:				; CODE XREF: InitCarCvx64_64+108j
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		add	si, CarState.rc2
		mov	ax, [bp+arg_2]
		add	ax, [si]
		cmp	ax, 0FEE0h
		jle	short loc_471_4054
		mov	ax, [bp+arg_2]
		add	[si], ax
		jmp	short loc_471_4081
; ---------------------------------------------------------------------------

loc_471_4054:				; CODE XREF: InitCarCvx64_64+165j
		mov	di, [bp+arg_4]
		shl	di, 1
		mov	bx, [bp+p_pCvx]
		mov	ax, [bp+arg_2]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		sar	ax, 1
		sar	ax, 1
		add	[bx+di+CarState.rc2.dwLeft], ax
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, [bp+p_pCvx]
		add	si, CarState.rc2
		cmp	word ptr [si], 0FE80h
		jge	short loc_471_4081
		mov	word ptr [si], 0FE80h

loc_471_4081:				; CODE XREF: InitCarCvx64_64+16Cj
					; InitCarCvx64_64+195j
		mov	ax, [bp+var_2]
		mov	si, [bp+arg_4]
		shl	si, 1
		mov	bx, [bp+p_pCvx]
		sub	ax, [bx+si+CarState.rc2.dwLeft]
		add	ax, [bp+arg_2]

loc_471_4092:				; CODE XREF: InitCarCvx64_64+CFj
		mov	[bp+var_4], ax

loc_471_4095:				; CODE XREF: InitCarCvx64_64+E2j
					; InitCarCvx64_64+FAj ...
		mov	ax, [bp+var_2]
		add	ax, [bp+var_4]
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InitCarCvx64_64	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_471_40A2	proc far		; CODE XREF: PlayerOp+7Ep

var_4		= byte ptr -4
arg_0		= byte ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		mov	di, gameState.carPlayer.field_20
		mov	ax, gameState.carPlayer.wTrackGrip2
		mov	cl, 0Ah
		shr	ax, cl
		and	al, 0FCh
		mov	[bp+var_4], al
		cbw
		mov	bx, ax
		mov	al, [bp+arg_0]
		cbw
		add	bx, ax
		add	bx, g_wCvxTimerFlag
		mov	al, [bx]
		cbw
		mov	si, ax
		or	si, si
		jle	short loc_471_40D8
		cmp	di, 0FFFFh
		jge	short loc_471_40E5
		jmp	short loc_471_40E1
; ---------------------------------------------------------------------------
		nop

loc_471_40D8:				; CODE XREF: sub_471_40A2+2Cj
		or	si, si
		jz	short loc_471_40E5
		cmp	di, 1
		jle	short loc_471_40E5

loc_471_40E1:				; CODE XREF: sub_471_40A2+33j
		mov	cl, 2
		shl	si, cl

loc_471_40E5:				; CODE XREF: sub_471_40A2+31j
					; sub_471_40A2+38j ...
		or	si, si
		jnz	short loc_471_4125
		cmp	gameState.carPlayer.wTrackGrip2, 0
		jz	short loc_471_4125
		or	di, di
		jz	short loc_471_4125
		mov	al, [bp+var_4]
		cbw
		mov	bx, ax
		add	bx, g_wCvxTimerFlag
		mov	al, [bx+1]
		cbw
		mov	si, ax
		shl	si, 1
		or	di, di
		jge	short loc_471_4110
		mov	ax, di
		neg	ax
		jmp	short loc_471_4112
; ---------------------------------------------------------------------------

loc_471_4110:				; CODE XREF: sub_471_40A2+66j
		mov	ax, di

loc_471_4112:				; CODE XREF: sub_471_40A2+6Cj
		cmp	ax, si
		jle	short loc_471_411E
		or	di, di
		jle	short loc_471_4125
		mov	ax, si
		jmp	short loc_471_4121
; ---------------------------------------------------------------------------

loc_471_411E:				; CODE XREF: sub_471_40A2+72j
		mov	ax, gameState.carPlayer.field_20

loc_471_4121:				; CODE XREF: sub_471_40A2+7Aj
		neg	ax
		mov	si, ax

loc_471_4125:				; CODE XREF: sub_471_40A2+45j
					; sub_471_40A2+4Cj ...
		cmp	g_wFramesPerSec, 0Ah
		jnz	short loc_471_4140
		cmp	si, 0A0h ; ' '
		jle	short loc_471_4135
		mov	si, 0A0h ; ' '

loc_471_4135:				; CODE XREF: sub_471_40A2+8Ej
		cmp	si, 0FF60h
		jge	short loc_471_4150
		mov	si, 0FF60h
		jmp	short loc_471_4150
; ---------------------------------------------------------------------------

loc_471_4140:				; CODE XREF: sub_471_40A2+88j
		cmp	si, 50h	; 'P'
		jle	short loc_471_4148
		mov	si, 50h	; 'P'

loc_471_4148:				; CODE XREF: sub_471_40A2+A1j
		cmp	si, 0FFB0h
		jge	short loc_471_4150
		mov	si, 0FFB0h

loc_471_4150:				; CODE XREF: sub_471_40A2+97j
					; sub_471_40A2+9Cj ...
		add	di, si
		cmp	di, 0F0h ; 'ð'
		jle	short loc_471_415B
		mov	di, 0F0h ; 'ð'

loc_471_415B:				; CODE XREF: sub_471_40A2+B4j
		cmp	di, 0FF10h
		jge	short loc_471_4164
		mov	di, 0FF10h

loc_471_4164:				; CODE XREF: sub_471_40A2+BDj
		mov	al, [bp+var_4]
		cbw
		mov	bx, ax
		mov	al, [bp+arg_0]
		cbw
		add	bx, ax
		add	bx, g_wCvxTimerFlag
		cmp	byte ptr [bx], 0
		jnz	short loc_471_4189
		push	di
		call	_abs
		add	sp, 2
		cmp	ax, 8
		jge	short loc_471_4189
		sub	di, di

loc_471_4189:				; CODE XREF: sub_471_40A2+D5j
					; sub_471_40A2+E3j
		mov	gameState.carPlayer.field_20, di
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_471_40A2	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoAudioCvx	proc far		; CODE XREF: UpdateGameState+E5p
					; UpdateGameState+F9p ...

var_34		= dword	ptr -34h
var_30		= word ptr -30h
var_2E		= word ptr -2Eh
pCvxStruct2	= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= word ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= byte ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 34h
		push	di
		push	si
		cmp	g_cGameFlag2, 0
		jnz	short loc_471_41A6
		jmp	loc_471_422A
; ---------------------------------------------------------------------------

loc_471_41A6:				; CODE XREF: DoAudioCvx+Dj
		cmp	g_cIniEng1Flag1, 0
		jz	short loc_471_4215
		mov	ax, g_wIniEng2Flag2
		mov	g_wIniEng2Flag1, ax
		test	g_cIniEng1Flag2, 6
		jz	short loc_471_41C6
		push	g_wSfxEng1Resul
		call	InitAudioTimer
		add	sp, 2

loc_471_41C6:				; CODE XREF: DoAudioCvx+24j
		test	g_cIniEng1Flag2, 1
		jz	short loc_471_41D9
		push	g_wSfxEng1Resul
		call	AudioFunction2
		add	sp, 2

loc_471_41D9:				; CODE XREF: DoAudioCvx+37j
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_471_4206
		test	g_cIniEng1Flag3, 6
		jz	short loc_471_41F3
		push	g_wSfxOppEngResul
		call	InitAudioTimer
		add	sp, 2

loc_471_41F3:				; CODE XREF: DoAudioCvx+51j
		test	g_cIniEng1Flag3, 1
		jz	short loc_471_4206
		push	g_wSfxOppEngResul
		call	AudioFunction2
		add	sp, 2

loc_471_4206:				; CODE XREF: DoAudioCvx+4Aj
					; DoAudioCvx+64j
		mov	g_cIniEng1Flag1, 0
		mov	g_cIniEng1Flag2, 0
		mov	g_cIniEng1Flag3, 0

loc_471_4215:				; CODE XREF: DoAudioCvx+17j
		mov	al, byte ptr unk_2B77_692
		cmp	g_cGameFlag2, al
		jnz	short loc_471_4221
		jmp	loc_471_45BC
; ---------------------------------------------------------------------------

loc_471_4221:				; CODE XREF: DoAudioCvx+88j
		call	DoSkidslctDrv
		jmp	loc_471_45BC
; ---------------------------------------------------------------------------
		nop

loc_471_422A:				; CODE XREF: DoAudioCvx+Fj
		mov	ax, word ptr gameState.carPlayer.vecLongUnk2.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk2.dwX+2
		mov	cl, 6

loc_471_4233:				; CODE XREF: DoAudioCvx+A5j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_4233
		mov	[bp+var_1C], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk2.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk2.dwY+2
		mov	cl, 6

loc_471_4247:				; CODE XREF: DoAudioCvx+B9j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_4247
		mov	[bp+var_1A], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk2.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk2.dwZ+2
		mov	cl, 6

loc_471_425B:				; CODE XREF: DoAudioCvx+CDj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_425B
		mov	[bp+var_18], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_426F:				; CODE XREF: DoAudioCvx+E1j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_426F
		mov	[bp+var_8], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_4283:				; CODE XREF: DoAudioCvx+F5j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_4283
		mov	[bp+var_6], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_4297:				; CODE XREF: DoAudioCvx+109j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_4297
		mov	[bp+var_4], ax
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_471_4321
		mov	ax, word ptr gameState.carOpponent.vecLongUnk2.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk2.dwX+2
		mov	cl, 6

loc_471_42B2:				; CODE XREF: DoAudioCvx+124j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_42B2
		mov	[bp+var_24], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk2.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk2.dwY+2
		mov	cl, 6

loc_471_42C6:				; CODE XREF: DoAudioCvx+138j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_42C6
		mov	[bp+var_22], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk2.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk2.dwZ+2
		mov	cl, 6

loc_471_42DA:				; CODE XREF: DoAudioCvx+14Cj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_42DA
		mov	[bp+var_20], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_471_42EE:				; CODE XREF: DoAudioCvx+160j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_42EE
		mov	[bp+var_E], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_471_4302:				; CODE XREF: DoAudioCvx+174j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_4302
		mov	[bp+var_C], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_471_4316:				; CODE XREF: DoAudioCvx+188j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_4316
		mov	[bp+var_A], ax

loc_471_4321:				; CODE XREF: DoAudioCvx+113j
		mov	al, g_cCameraMode
		cbw
		or	ax, ax
		jz	short loc_471_4342
		cmp	ax, 1
		jnz	short loc_471_4331
		jmp	loc_471_4432
; ---------------------------------------------------------------------------

loc_471_4331:				; CODE XREF: DoAudioCvx+198j
		cmp	ax, 2
		jz	short loc_471_4342
		cmp	ax, 3
		jnz	short loc_471_433E
		jmp	loc_471_445E
; ---------------------------------------------------------------------------

loc_471_433E:				; CODE XREF: DoAudioCvx+1A5j
		jmp	short loc_471_4372
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_471_4342:				; CODE XREF: DoAudioCvx+193j
					; DoAudioCvx+1A0j
		cmp	byte_2B77_AC70,	0
		jz	short loc_471_435E
		lea	di, [bp+var_14]
		lea	si, [bp+var_E]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		lea	di, [bp+var_2A]
		lea	si, [bp+var_24]

loc_471_435A:				; CODE XREF: DoAudioCvx+30Fj
		push	ss
		pop	es
		jmp	short loc_471_436F
; ---------------------------------------------------------------------------

loc_471_435E:				; CODE XREF: DoAudioCvx+1B3j
		lea	di, [bp+var_14]
		lea	si, [bp+var_8]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		lea	di, [bp+var_2A]
		lea	si, [bp+var_1C]

loc_471_436F:				; CODE XREF: DoAudioCvx+1C8j
		movsw
		movsw
		movsw

loc_471_4372:				; CODE XREF: DoAudioCvx:loc_471_433Ej
					; DoAudioCvx+2C6j
		mov	ax, 22h	; '"'
		imul	g_wIniEng2Flag2
		add	ax, offset unk_2B77_97DC ; 97dc	has a unit size	of 22h,	but what is it?
		mov	[bp+var_2], ax
		mov	bx, ax
		mov	ax, [bp+var_2A]
		sub	ax, [bp+var_1C]
		mov	[bx+6],	ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_28]
		sub	ax, [bp+var_1A]
		mov	[bx+8],	ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_26]
		sub	ax, [bp+var_18]
		mov	[bx+0Ah], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_14]
		sub	ax, [bp+var_8]
		mov	[bx+0Ch], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_12]
		sub	ax, [bp+var_6]
		mov	[bx+0Eh], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_10]
		sub	ax, [bp+var_4]
		mov	[bx+10h], ax
		mov	bx, [bp+var_2]
		mov	ax, gameState.carPlayer.wCurRpm
		mov	[bx+1Eh], ax
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_471_43D9
		jmp	loc_471_44A6
; ---------------------------------------------------------------------------

loc_471_43D9:				; CODE XREF: DoAudioCvx+240j
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_2A]
		sub	ax, [bp+var_24]
		mov	[bx+12h], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_28]
		sub	ax, [bp+var_22]
		mov	[bx+14h], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_26]
		sub	ax, [bp+var_20]
		mov	[bx+16h], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_14]
		sub	ax, [bp+var_E]
		mov	[bx+18h], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_12]
		sub	ax, [bp+var_C]
		mov	[bx+1Ah], ax
		mov	bx, [bp+var_2]
		mov	ax, [bp+var_10]
		sub	ax, [bp+var_A]
		mov	[bx+1Ch], ax
		mov	bx, [bp+var_2]
		mov	ax, gameState.carOpponent.wCurRpm
		mov	[bx+20h], ax
		mov	[bp+var_30], 2
		jmp	short loc_471_44AB
; ---------------------------------------------------------------------------
		nop

loc_471_4432:				; CODE XREF: DoAudioCvx+19Aj
		mov	al, byte_2B77_AC70
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	si, ax
		push	si
		lea	di, [bp+var_14]
		lea	si, gameState.vec1.wX[si]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		push	si
		lea	di, [bp+var_2A]
		lea	si, gameState.vec3.wX[si]
		movsw
		movsw
		movsw
		pop	si
		jmp	loc_471_4372
; ---------------------------------------------------------------------------
		nop

loc_471_445E:				; CODE XREF: DoAudioCvx+1A7j
		mov	al, byte_2B77_AC70
		cbw
		mov	bx, ax
		mov	al, gameState.cCvxFlag4[bx]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_pTrakdata9
		mov	dx, word ptr g_pTrakdata9+2
		mov	word ptr [bp+var_34], ax
		mov	word ptr [bp+var_34+2],	dx
		les	bx, [bp+var_34]
		mov	ax, es:[bx]
		mov	[bp+var_14], ax
		mov	ax, es:[bx+2]
		add	ax, word_2B77_95B0
		add	ax, 5Ah	; 'Z'
		mov	[bp+var_12], ax
		mov	ax, es:[bx+4]
		mov	[bp+var_10], ax
		lea	di, [bp+var_2A]
		lea	si, [bp+var_14]
		jmp	loc_471_435A
; ---------------------------------------------------------------------------

loc_471_44A6:				; CODE XREF: DoAudioCvx+242j
		mov	[bp+var_30], 1

loc_471_44AB:				; CODE XREF: DoAudioCvx+29Bj
		mov	[bp+var_1E], 0
		jmp	loc_471_4583
; ---------------------------------------------------------------------------
		nop

loc_471_44B4:				; CODE XREF: DoAudioCvx+3FDj
		mov	[bp+pCvxStruct2], offset gameState.carPlayer
		mov	ax, g_wSfxEng1Resul
		mov	[bp+var_2E], ax
		mov	al, g_cIniEng1Flag2

loc_471_44C2:				; CODE XREF: DoAudioCvx+40Ej
		mov	[bp+var_16], al
		mov	bx, [bp+pCvxStruct2]
		test	[bx+CarState.field_CF],	1
		jz	short loc_471_44E4
		test	[bp+var_16], 1
		jnz	short loc_471_44F8
		or	[bp+var_16], 1
		push	[bp+var_2E]
		call	AudioFunction
		jmp	short loc_471_44F5
; ---------------------------------------------------------------------------
		nop

loc_471_44E4:				; CODE XREF: DoAudioCvx+339j
		test	[bp+var_16], 1
		jz	short loc_471_44F8
		dec	[bp+var_16]
		push	[bp+var_2E]
		call	AudioFunction2

loc_471_44F5:				; CODE XREF: DoAudioCvx+34Dj
		add	sp, 2

loc_471_44F8:				; CODE XREF: DoAudioCvx+33Fj
					; DoAudioCvx+354j
		mov	bx, [bp+pCvxStruct2]
		test	[bx+CarState.field_CF],	6
		jz	short loc_471_4546
		mov	al, [bp+var_16]
		and	al, 6
		mov	byte ptr [bp+var_34], al
		mov	al, [bx+CarState.field_CF]
		and	al, 6
		cmp	al, byte ptr [bp+var_34]
		jz	short loc_471_456B
		test	[bp+var_16], 6
		jnz	short loc_471_454C
		test	[bx+CarState.field_CF],	2
		jz	short loc_471_4534
		push	[bp+var_2E]
		call	AudioOp
		add	sp, 2
		add	[bp+var_16], 2
		jmp	short loc_471_456B
; ---------------------------------------------------------------------------
		nop

loc_471_4534:				; CODE XREF: DoAudioCvx+38Cj
		push	[bp+var_2E]
		call	InitAudioTimer2
		add	sp, 2
		add	[bp+var_16], 4
		jmp	short loc_471_456B
; ---------------------------------------------------------------------------
		nop

loc_471_4546:				; CODE XREF: DoAudioCvx+36Cj
		test	[bp+var_16], 6
		jz	short loc_471_456B

loc_471_454C:				; CODE XREF: DoAudioCvx+385j
		test	[bp+var_16], 2
		jz	short loc_471_4556
		sub	[bp+var_16], 2

loc_471_4556:				; CODE XREF: DoAudioCvx+3BCj
		test	[bp+var_16], 4
		jz	short loc_471_4560
		sub	[bp+var_16], 4

loc_471_4560:				; CODE XREF: DoAudioCvx+3C6j
		push	[bp+var_2E]
		call	InitAudioTimer
		add	sp, 2

loc_471_456B:				; CODE XREF: DoAudioCvx+37Fj
					; DoAudioCvx+39Dj ...
		cmp	[bp+var_1E], 0
		jz	short loc_471_457A
		mov	al, [bp+var_16]
		mov	g_cIniEng1Flag3, al
		jmp	short loc_471_4580
; ---------------------------------------------------------------------------
		nop

loc_471_457A:				; CODE XREF: DoAudioCvx+3DBj
		mov	al, [bp+var_16]
		mov	g_cIniEng1Flag2, al

loc_471_4580:				; CODE XREF: DoAudioCvx+3E3j
		inc	[bp+var_1E]

loc_471_4583:				; CODE XREF: DoAudioCvx+31Cj
		mov	ax, [bp+var_30]
		cmp	[bp+var_1E], ax
		jge	short loc_471_45A6
		cmp	[bp+var_1E], 0
		jnz	short loc_471_4594
		jmp	loc_471_44B4
; ---------------------------------------------------------------------------

loc_471_4594:				; CODE XREF: DoAudioCvx+3FBj
		mov	[bp+pCvxStruct2], offset gameState.carOpponent
		mov	ax, g_wSfxOppEngResul
		mov	[bp+var_2E], ax
		mov	al, g_cIniEng1Flag3
		jmp	loc_471_44C2
; ---------------------------------------------------------------------------
		nop

loc_471_45A6:				; CODE XREF: DoAudioCvx+3F5j
		mov	g_cIniEng1Flag1, 1
		inc	g_wIniEng2Flag2
		cmp	g_wIniEng2Flag2, 28h ; '('
		jnz	short loc_471_45BC
		mov	g_wIniEng2Flag2, 0

loc_471_45BC:				; CODE XREF: DoAudioCvx+8Aj
					; DoAudioCvx+92j ...
		mov	al, g_cGameFlag2
		mov	byte ptr unk_2B77_692, al
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoAudioCvx	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoAudioOp1_2	proc far		; CODE XREF: TrkPlanSimd+14B7p

arg_0		= byte ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		cmp	g_cIniEng1Flag1, 0
		jz	short loc_471_45F4
		test	[bp+arg_0], 10h
		jz	short loc_471_45E3
		push	[bp+arg_2]
		call	AudioTimerOp
		add	sp, 2

loc_471_45E3:				; CODE XREF: DoAudioOp1_2+Ej
		test	[bp+arg_0], 20h
		jz	short loc_471_45F4
		push	[bp+arg_2]
		call	AudioTimerOp2
		add	sp, 2

loc_471_45F4:				; CODE XREF: DoAudioOp1_2+8j
					; DoAudioOp1_2+1Fj
		pop	bp
		retf
DoAudioOp1_2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_471_45F6	proc far		; CODE XREF: TimerFunc+49P

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	[bp+arg_2]
		mov	bx, [bp+arg_0]
		push	word ptr [bx+10h]
		push	word ptr [bx+0Eh]
		push	word ptr [bx+0Ch]
		push	word ptr [bx+0Ah]
		push	word ptr [bx+8]
		push	word ptr [bx+6]
		push	word ptr [bx+1Eh]
		push	g_wSfxEng1Resul
		call	XZAudioTimer
		add	sp, 12h
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_471_464E
		push	[bp+arg_2]
		mov	bx, [bp+arg_0]
		push	word ptr [bx+1Ch]
		push	word ptr [bx+1Ah]
		push	word ptr [bx+18h]
		push	word ptr [bx+16h]
		push	word ptr [bx+14h]
		push	word ptr [bx+12h]
		push	word ptr [bx+20h]
		push	g_wSfxOppEngResul
		call	XZAudioTimer
		add	sp, 12h

loc_471_464E:				; CODE XREF: sub_471_45F6+2Fj
		pop	bp
		retf
sub_471_45F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoSomeTrakData	proc far		; CODE XREF: OpponentOp+174p
					; OpponentOp+3C4p ...

var_30		= word ptr -30h
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
cTrak18ByteAnd10= byte ptr -28h
pSceneShape	= word ptr -26h
var_24		= word ptr -24h
vec2		= Vector3D ptr -22h
cTrak18ByteAnd0F= byte ptr -1Ch
cTrak22Byte	= word ptr -1Ah
var_18		= byte ptr -18h
cTrak21Byte	= byte ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= byte ptr -10h
var_E		= word ptr -0Eh
vec		= Vector3D ptr -0Ch
var_6		= dword	ptr -6
cTrak17Byte	= byte ptr -2
p_wTrakdata3Index= word	ptr  6
p_pVec		= word ptr  8
arg_4		= byte ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 30h
		push	di
		push	si
		mov	bx, [bp+p_wTrakdata3Index]
		les	si, g_ppTrakdata17
		mov	al, es:[bx+si]
		mov	[bp+cTrak17Byte], al
		les	si, g_ppTrakdata18
		mov	al, es:[bx+si]
		and	al, 0Fh
		mov	[bp+cTrak18ByteAnd0F], al
		mov	al, es:[bx+si]
		and	al, 10h
		mov	[bp+cTrak18ByteAnd10], al
		mov	al, [bp+cTrak17Byte]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneShape], ax
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.field_0]
		mov	[bp+var_14], ax
		mov	[bp+var_12], ds
		mov	al, [bp+cTrak18ByteAnd0F]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_14]
		mov	dx, ds
		mov	word ptr [bp+var_6], ax	; her setter vi	den rare tabellen inni sceneshapen
		mov	word ptr [bp+var_6+2], dx
		mov	[bp+var_24], 0
		les	bx, [bp+var_6]
		mov	al, es:[bx+5]
		mov	[bp+var_18], al
		cmp	[bp+cTrak18ByteAnd10], 0
		jnz	short loc_471_46D2
		mov	al, [bp+arg_4]
		shl	al, 1
		jmp	short loc_471_46DC
; ---------------------------------------------------------------------------

loc_471_46D2:				; CODE XREF: DoSomeTrakData+79j
		mov	al, [bp+var_18]
		sub	al, [bp+arg_4]
		shl	al, 1
		sub	al, 2

loc_471_46DC:				; CODE XREF: DoSomeTrakData+80j
		mov	[bp+var_10], al
		cmp	[bp+arg_6], 0
		jz	short loc_471_470A
		mov	al, es:[bx+0Dh]
		mov	[bp+cTrak21Byte], al
		mov	bx, [bp+pSceneShape]
		mov	al, [bx+SceneShape3D.cMaterial]
		mov	byte ptr [bp+cTrak22Byte], al
		mov	si, [bp+cTrak22Byte]
		and	si, 0FFh
		mov	bl, [bp+cTrak21Byte]
		sub	bh, bh
		mov	al, byte_2B77_95E0[bx+si]
		mov	bx, [bp+arg_6]
		mov	[bx], al

loc_471_470A:				; CODE XREF: DoSomeTrakData+93j
		les	bx, [bp+var_6]
		cmp	word ptr es:[bx+0Ah], 0
		jz	short loc_471_4719
		mov	[bp+var_24], 1

loc_471_4719:				; CODE XREF: DoSomeTrakData+C2j
		cmp	[bp+cTrak18ByteAnd10], 0
		jz	short loc_471_4766
		cmp	[bp+var_24], 0
		jz	short loc_471_472C
		mov	ax, es:[bx+0Ah]
		jmp	short loc_471_476D
; ---------------------------------------------------------------------------
		nop

loc_471_472C:				; CODE XREF: DoSomeTrakData+D3j
		les	bx, [bp+var_6]
		mov	ax, es:[bx+8]
		mov	[bp+var_2C], ax
		mov	[bp+var_2A], ds
		mov	al, [bp+var_10]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_2C]
		mov	dx, ds
		mov	[bp+var_30], ax
		mov	[bp+var_2E], dx
		add	ax, 6
		lea	di, [bp+vec]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		movsw
		movsw
		movsw
		pop	ds
		mov	ax, [bp+var_30]
		jmp	short loc_471_479A
; ---------------------------------------------------------------------------
		nop

loc_471_4766:				; CODE XREF: DoSomeTrakData+CDj
		les	bx, [bp+var_6]
		mov	ax, es:[bx+8]

loc_471_476D:				; CODE XREF: DoSomeTrakData+D9j
		mov	[bp+var_2C], ax
		mov	[bp+var_2A], ds
		mov	al, [bp+var_10]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_2C]
		mov	dx, ds
		mov	[bp+var_30], ax
		mov	[bp+var_2E], dx
		lea	di, [bp+vec]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		movsw
		movsw
		movsw
		pop	ds
		add	ax, 6

loc_471_479A:				; CODE XREF: DoSomeTrakData+113j
		lea	di, [bp+vec2]
		mov	si, ax
		push	ds
		mov	ds, dx
		movsw
		movsw
		movsw
		pop	ds
		les	bx, [bp+var_6]
		mov	ax, es:[bx+6]
		cmp	ax, 100h
		jnz	short loc_471_47B5
		jmp	loc_471_4864
; ---------------------------------------------------------------------------

loc_471_47B5:				; CODE XREF: DoSomeTrakData+160j
		cmp	ax, 200h
		jnz	short loc_471_47BD
		jmp	loc_471_4842
; ---------------------------------------------------------------------------

loc_471_47BD:				; CODE XREF: DoSomeTrakData+168j
		cmp	ax, 300h
		jnz	short loc_471_47EA
		mov	ax, [bp+vec.wX]
		mov	[bp+var_E], ax
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wX], ax
		mov	ax, [bp+var_E]
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec2.wX]
		mov	[bp+var_E], ax
		mov	ax, [bp+vec2.wZ]
		neg	ax
		mov	[bp+vec2.wX], ax
		mov	ax, [bp+var_E]

loc_471_47E7:				; CODE XREF: DoSomeTrakData+239j
		mov	[bp+vec2.wZ], ax

loc_471_47EA:				; CODE XREF: DoSomeTrakData+170j
					; DoSomeTrakData+212j
		mov	bx, [bp+p_wTrakdata3Index]
		les	si, g_pTrakdata21
		mov	al, es:[bx+si]
		mov	[bp+cTrak21Byte], al
		les	si, g_ppTrakdata22
		mov	al, es:[bx+si]
		mov	byte ptr [bp+cTrak22Byte], al
		cmp	[bp+vec.wY], 0FFFFh
		jz	short loc_471_482B
		mov	bl, al
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cTrak21Byte]
		sub	ah, ah
		add	bx, ax
		les	si, g_ppTrakdata15
		cmp	byte ptr es:[bx+si], 6
		jnz	short loc_471_482B
		mov	ax, word_2B77_17A
		add	[bp+vec.wY], ax
		add	[bp+vec2.wY], ax

loc_471_482B:				; CODE XREF: DoSomeTrakData+1B5j
					; DoSomeTrakData+1D0j
		mov	bx, [bp+pSceneShape]
		test	[bx+SceneShape3D.cTranslateFlag], 1
		jz	short loc_471_488C
		mov	bl, byte ptr [bp+cTrak22Byte]
		sub	bh, bh
		shl	bx, 1
		mov	si, g_wTrackPos[bx]
		jmp	short loc_471_4897
; ---------------------------------------------------------------------------
		nop

loc_471_4842:				; CODE XREF: DoSomeTrakData+16Aj
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+vec.wX], ax
		mov	ax, [bp+vec2.wZ]
		neg	ax
		mov	[bp+vec2.wZ], ax
		mov	ax, [bp+vec2.wX]
		neg	ax
		mov	[bp+vec2.wX], ax
		jmp	short loc_471_47EA
; ---------------------------------------------------------------------------

loc_471_4864:				; CODE XREF: DoSomeTrakData+162j
		mov	ax, [bp+vec.wX]
		mov	[bp+var_E], ax
		mov	ax, [bp+vec.wZ]
		mov	[bp+vec.wX], ax
		mov	ax, [bp+var_E]
		neg	ax
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec2.wX]
		mov	[bp+var_E], ax
		mov	ax, [bp+vec2.wZ]
		mov	[bp+vec2.wX], ax
		mov	ax, [bp+var_E]
		neg	ax
		jmp	loc_471_47E7
; ---------------------------------------------------------------------------

loc_471_488C:				; CODE XREF: DoSomeTrakData+1E2j
		mov	bl, byte ptr [bp+cTrak22Byte]
		sub	bh, bh
		shl	bx, 1
		mov	si, word ptr g_wTrackCenPos[bx]

loc_471_4897:				; CODE XREF: DoSomeTrakData+1EFj
		add	[bp+vec.wZ], si
		add	[bp+vec2.wZ], si
		mov	bx, [bp+pSceneShape]
		test	[bx+SceneShape3D.cTranslateFlag], 2
		jz	short loc_471_48B4
		mov	bl, [bp+cTrak21Byte]
		sub	bh, bh
		shl	bx, 1
		mov	si, (g_wMoreTrackPos+2)[bx]
		jmp	short loc_471_48BF
; ---------------------------------------------------------------------------
		nop

loc_471_48B4:				; CODE XREF: DoSomeTrakData+254j
		mov	bl, [bp+cTrak21Byte]
		sub	bh, bh
		shl	bx, 1
		mov	si, g_wMoreTrkCenPo[bx]

loc_471_48BF:				; CODE XREF: DoSomeTrakData+261j
		add	[bp+vec.wX], si
		add	[bp+vec2.wX], si
		mov	ax, [bp+vec2.wX]
		cwd
		mov	cx, ax
		mov	ax, [bp+vec.wX]
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	bx, [bp+p_pVec]
		mov	[bx+Vector3D.wX], ax
		cmp	[bp+vec.wY], 0FFFFh
		jnz	short loc_471_48EE
		mov	bx, [bp+p_pVec]
		mov	[bx+Vector3D.wY], 0FFFFh
		jmp	short loc_471_4908
; ---------------------------------------------------------------------------

loc_471_48EE:				; CODE XREF: DoSomeTrakData+292j
		mov	ax, [bp+vec2.wY]
		cwd
		mov	cx, ax
		mov	ax, [bp+vec.wY]
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	bx, [bp+p_pVec]
		mov	[bx+Vector3D.wY], ax

loc_471_4908:				; CODE XREF: DoSomeTrakData+29Cj
		mov	ax, [bp+vec2.wZ]
		cwd
		mov	cx, ax
		mov	ax, [bp+vec.wZ]
		mov	bx, dx
		cwd
		add	ax, cx
		adc	dx, bx
		sar	dx, 1
		rcr	ax, 1
		mov	bx, [bp+p_pVec]
		mov	[bx+Vector3D.wZ], ax
		mov	bx, [bp+p_pVec]
		lea	di, [bx+(Vector3D.wX+6)]
		lea	si, [bp+vec]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		mov	bx, [bp+p_pVec]
		lea	di, [bx+(Vector3D.wX+0Ch)]
		lea	si, [bp+vec2]
		movsw
		movsw
		movsw
		mov	bx, [bp+p_pVec]
		mov	ax, [bp+var_24]
		mov	[bx+(Vector3D.wX+12h)],	ax
		mov	al, [bp+arg_4]
		cbw
		mov	cl, [bp+var_18]
		sub	ch, ch
		dec	cx
		cmp	cx, ax
		jnz	short loc_471_495C
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_471_495C:				; CODE XREF: DoSomeTrakData+301j
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoSomeTrakData	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CheckCarCollider proc far		; CODE XREF: TrkPlanSimd+1785p
					; TrkPlanSimd+1894p ...

vec2		= Vector3D ptr -2Ah
vec3		= Vector3D ptr -24h
vec1		= Vector3D ptr -0Ch
var_6		= byte ptr -6
pMatrix		= word ptr -4
p_pptCollide1	= word ptr  6
p_pVec1		= word ptr  8
p_pptCollide2	= word ptr  0Ah
p_pVec2		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 2Ah
		push	di
		push	si
		mov	bx, [bp+p_pptCollide1]
		mov	si, [bx+(Point2D.y+4)]
		mov	bx, [bp+p_pptCollide2]
		add	si, [bx+(Point2D.y+4)]
		mov	bx, [bp+p_pVec1]
		mov	di, [bp+p_pVec2]
		mov	ax, [di+Vector3D.wX]
		cmp	[bx+Vector3D.wX], ax
		jl	short loc_471_4988
		mov	ax, [bx+Vector3D.wX]
		mov	bx, di

loc_471_4988:				; CODE XREF: CheckCarCollider+1Ej
		sub	ax, [bx+Vector3D.wX]
		cmp	ax, si
		jg	short loc_471_49C2
		mov	bx, [bp+p_pVec1]
		mov	di, [bp+p_pVec2]
		mov	ax, [di+Vector3D.wZ]
		cmp	[bx+Vector3D.wZ], ax
		jl	short loc_471_49A1
		mov	ax, [bx+Vector3D.wZ]
		mov	bx, di

loc_471_49A1:				; CODE XREF: CheckCarCollider+36j
		sub	ax, [bx+Vector3D.wZ]
		cmp	ax, si
		jg	short loc_471_49C2
		mov	bx, [bp+p_pVec1]
		mov	di, [bp+p_pVec2]
		mov	ax, [di+Vector3D.wY]
		cmp	[bx+Vector3D.wY], ax
		jl	short loc_471_49BB
		mov	ax, [bx+Vector3D.wY]
		mov	bx, di

loc_471_49BB:				; CODE XREF: CheckCarCollider+50j
		sub	ax, [bx+Vector3D.wY]
		cmp	ax, si
		jle	short loc_471_49CA

loc_471_49C2:				; CODE XREF: CheckCarCollider+28j
					; CheckCarCollider+42j	...
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_471_49CA:				; CODE XREF: CheckCarCollider+5Cj
		mov	bx, [bp+p_pVec1]
		mov	ax, [bx]
		mov	bx, [bp+p_pVec2]
		sub	ax, [bx]
		mov	[bp+vec2.wX], ax
		mov	bx, [bp+p_pVec1]
		mov	ax, [bx+Vector3D.wY]
		mov	bx, [bp+p_pVec2]
		sub	ax, [bx+Vector3D.wY]
		mov	[bp+vec2.wY], ax
		mov	bx, [bp+p_pVec1]
		mov	ax, [bx+Vector3D.wZ]
		mov	bx, [bp+p_pVec2]
		sub	ax, [bx+Vector3D.wZ]
		mov	[bp+vec2.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		call	ZXCosSinX2
		add	sp, 2
		cmp	ax, si
		ja	short loc_471_49C2
		sub	ax, ax
		push	ax
		mov	bx, [bp+p_pVec1]
		mov	ax, [bx+(Vector3D.wZ+6)]
		neg	ax
		push	ax
		mov	ax, [bx+(Vector3D.wY+6)]
		neg	ax
		push	ax
		mov	ax, [bx+(Vector3D.wX+6)]
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		mov	[bp+var_6], 0
		jmp	short loc_471_4AA2
; ---------------------------------------------------------------------------

loc_471_4A2E:				; CODE XREF: CheckCarCollider+153j
		mov	bx, [bp+p_pptCollide1]
		mov	ax, [bx]
		neg	ax

loc_471_4A35:				; CODE XREF: CheckCarCollider+15Bj
		mov	[bp+vec1.wX], ax
		mov	[bp+vec1.wY], 0
		mov	al, [bp+var_6]
		cbw
		mov	bx, ax
		shl	bx, 1
		cmp	word ptr [bx+69Ch], 0
		jnz	short loc_471_4A54
		mov	bx, [bp+p_pptCollide1]
		mov	ax, [bx+4]
		jmp	short loc_471_4A5C
; ---------------------------------------------------------------------------

loc_471_4A54:				; CODE XREF: CheckCarCollider+E6j
		mov	bx, [bp+p_pptCollide1]
		mov	ax, [bx+4]
		neg	ax

loc_471_4A5C:				; CODE XREF: CheckCarCollider+EEj
		mov	[bp+vec1.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	bx, [bp+p_pVec1]
		mov	ax, [bx+Vector3D.wX]
		add	[bp+vec2.wX], ax
		mov	ax, [bx+Vector3D.wY]
		add	[bp+vec2.wY], ax
		mov	ax, [bx+Vector3D.wZ]
		add	[bp+vec2.wZ], ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, ax
		shl	di, 1
		push	si
		lea	di, [bp+di+vec3]
		lea	si, [bp+vec2]
		push	ss
		pop	es
		assume es:nothing
		movsw
		movsw
		movsw
		pop	si
		inc	[bp+var_6]

loc_471_4AA2:				; CODE XREF: CheckCarCollider+C8j
		cmp	[bp+var_6], 4
		jge	short loc_471_4AC2
		mov	al, [bp+var_6]
		cbw
		mov	bx, ax
		shl	bx, 1
		cmp	word ptr [bx+694h], 0
		jz	short loc_471_4ABA
		jmp	loc_471_4A2E
; ---------------------------------------------------------------------------

loc_471_4ABA:				; CODE XREF: CheckCarCollider+151j
		mov	bx, [bp+p_pptCollide1]
		mov	ax, [bx]
		jmp	loc_471_4A35
; ---------------------------------------------------------------------------

loc_471_4AC2:				; CODE XREF: CheckCarCollider+142j
		mov	ax, 1
		push	ax
		mov	bx, [bp+p_pVec2]
		push	[bx+(Vector3D.wZ+6)]
		push	[bx+(Vector3D.wY+6)]
		push	[bx+(Vector3D.wX+6)]
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		mov	[bp+var_6], 0
		jmp	short loc_471_4AE7
; ---------------------------------------------------------------------------
		nop

loc_471_4AE4:				; CODE XREF: CheckCarCollider+1CDj
					; CheckCarCollider+1D8j ...
		inc	[bp+var_6]

loc_471_4AE7:				; CODE XREF: CheckCarCollider+17Dj
		cmp	[bp+var_6], 4
		jge	short loc_471_4B6A
		mov	al, [bp+var_6]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, bp
		mov	bx, [bp+p_pVec2]
		mov	ax, [bx+Vector3D.wX]
		sub	ax, [di+vec3.wX]
		mov	[bp+vec1.wX], ax
		mov	ax, [bx+Vector3D.wY]
		sub	ax, [di+vec3.wY]
		mov	[bp+vec1.wY], ax
		mov	ax, [bx+Vector3D.wZ]
		sub	ax, [di+vec3.wZ]
		mov	[bp+vec1.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec2.wY], 0
		jl	short loc_471_4AE4
		mov	bx, [bp+p_pptCollide2]
		mov	ax, [bp+vec2.wY]
		cmp	[bx+2],	ax
		jl	short loc_471_4AE4
		mov	di, [bx]
		mov	ax, di
		neg	ax
		cmp	[bp+vec2.wX], ax
		jl	short loc_471_4AE4
		cmp	[bp+vec2.wX], di
		jg	short loc_471_4AE4
		mov	ax, [bx+4]
		neg	ax
		cmp	ax, [bp+vec2.wZ]
		jg	short loc_471_4AE4
		mov	ax, [bp+vec2.wZ]
		cmp	[bx+4],	ax
		jl	short loc_471_4AE4

loc_471_4B60:				; CODE XREF: CheckCarCollider+365j
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_4B6A:				; CODE XREF: CheckCarCollider+187j
		sub	ax, ax
		push	ax
		mov	bx, [bp+p_pVec2]
		mov	ax, [bx+(Vector3D.wZ+6)]
		neg	ax
		push	ax
		mov	ax, [bx+(Vector3D.wY+6)]
		neg	ax
		push	ax
		mov	ax, [bx+(Vector3D.wX+6)]
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		mov	[bp+var_6], 0
		jmp	short loc_471_4C08
; ---------------------------------------------------------------------------
		nop

loc_471_4B94:				; CODE XREF: CheckCarCollider+2B9j
		mov	bx, [bp+p_pptCollide2]
		mov	ax, [bx]
		neg	ax

loc_471_4B9B:				; CODE XREF: CheckCarCollider+2C1j
		mov	[bp+vec1.wX], ax
		mov	[bp+vec1.wY], 0
		mov	al, [bp+var_6]
		cbw
		mov	bx, ax
		shl	bx, 1
		cmp	word ptr [bx+69Ch], 0
		jnz	short loc_471_4BBA
		mov	bx, [bp+p_pptCollide2]
		mov	ax, [bx+4]
		jmp	short loc_471_4BC2
; ---------------------------------------------------------------------------

loc_471_4BBA:				; CODE XREF: CheckCarCollider+24Cj
		mov	bx, [bp+p_pptCollide2]
		mov	ax, [bx+4]
		neg	ax

loc_471_4BC2:				; CODE XREF: CheckCarCollider+254j
		mov	[bp+vec1.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	bx, [bp+p_pVec2]
		mov	ax, [bx+Vector3D.wX]
		add	[bp+vec2.wX], ax
		mov	ax, [bx+Vector3D.wY]
		add	[bp+vec2.wY], ax
		mov	ax, [bx+Vector3D.wZ]
		add	[bp+vec2.wZ], ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, ax
		shl	di, 1
		push	si
		lea	di, [bp+di+vec3]
		lea	si, [bp+vec2]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	si
		inc	[bp+var_6]

loc_471_4C08:				; CODE XREF: CheckCarCollider+22Dj
		cmp	[bp+var_6], 4
		jge	short loc_471_4C28
		mov	al, [bp+var_6]
		cbw
		mov	bx, ax
		shl	bx, 1
		cmp	word ptr [bx+694h], 0
		jz	short loc_471_4C20
		jmp	loc_471_4B94
; ---------------------------------------------------------------------------

loc_471_4C20:				; CODE XREF: CheckCarCollider+2B7j
		mov	bx, [bp+p_pptCollide2]
		mov	ax, [bx]
		jmp	loc_471_4B9B
; ---------------------------------------------------------------------------

loc_471_4C28:				; CODE XREF: CheckCarCollider+2A8j
		mov	ax, 1
		push	ax
		mov	bx, [bp+p_pVec1]
		push	[bx+(Vector3D.wZ+6)]
		push	[bx+(Vector3D.wY+6)]
		push	[bx+(Vector3D.wX+6)]
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		mov	[bp+var_6], 0
		jmp	short loc_471_4C4D
; ---------------------------------------------------------------------------
		nop

loc_471_4C4A:				; CODE XREF: CheckCarCollider+336j
					; CheckCarCollider+341j ...
		inc	[bp+var_6]

loc_471_4C4D:				; CODE XREF: CheckCarCollider+2E3j
		cmp	[bp+var_6], 4
		jl	short loc_471_4C56
		jmp	loc_471_49C2
; ---------------------------------------------------------------------------

loc_471_4C56:				; CODE XREF: CheckCarCollider+2EDj
		mov	al, [bp+var_6]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		add	di, bp
		mov	bx, [bp+p_pVec1]
		mov	ax, [bx+Vector3D.wX]
		sub	ax, [di+vec3.wX]
		mov	[bp+vec1.wX], ax
		mov	ax, [bx+Vector3D.wY]
		sub	ax, [di+vec3.wY]
		mov	[bp+vec1.wY], ax
		mov	ax, [bx+Vector3D.wZ]
		sub	ax, [di+vec3.wZ]
		mov	[bp+vec1.wZ], ax
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec2.wY], 0
		jl	short loc_471_4C4A
		mov	bx, [bp+p_pptCollide1]
		mov	ax, [bp+vec2.wY]
		cmp	[bx+2],	ax
		jl	short loc_471_4C4A
		mov	di, [bx]
		mov	ax, di
		neg	ax
		cmp	[bp+vec2.wX], ax
		jl	short loc_471_4C4A
		cmp	[bp+vec2.wX], di
		jg	short loc_471_4C4A
		mov	ax, [bx+4]
		neg	ax
		cmp	ax, [bp+vec2.wZ]
		jg	short loc_471_4C4A
		mov	ax, [bp+vec2.wZ]
		cmp	[bx+4],	ax
		jl	short loc_471_4CCC
		jmp	loc_471_4B60
; ---------------------------------------------------------------------------

loc_471_4CCC:				; CODE XREF: CheckCarCollider+363j
		jmp	loc_471_4C4A
CheckCarCollider endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitPlanTrak	proc far		; CODE XREF: SetupIntro+14EP
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		mov	ax, 0FFFDh
		push	ax
		push	cs
		call	near ptr InitGameState
		add	sp, 2
		sub	si, si
		mov	gameState.cCvxFlag2, 2
		mov	word ptr g_dwPlanRes, offset g_pPlanMemRes
		mov	word ptr g_dwPlanRes+2,	seg seg038
		mov	g_cStartCol2, 1
		mov	g_cStartRow2, 1Ch
		les	bx, g_ppTrakdata17
		mov	byte ptr es:[bx], 7
		les	bx, g_pTrakdata21
		mov	byte ptr es:[bx], 1
		les	bx, g_ppTrakdata22
		mov	al, g_cStartRow2
		mov	es:[bx], al
		les	bx, g_ppTrakdata18
		mov	byte ptr es:[bx], 0
		les	bx, g_ppTrakdata17
		mov	byte ptr es:[bx+1], 6
		les	bx, g_pTrakdata21
		mov	byte ptr es:[bx+1], 0
		les	bx, g_ppTrakdata22
		mov	al, g_cStartRow2
		mov	es:[bx+1], al
		les	bx, g_ppTrakdata18
		mov	byte ptr es:[bx+1], 0
		les	bx, g_ppTrakdata17
		mov	byte ptr es:[bx+2], 8
		les	bx, g_pTrakdata21
		mov	byte ptr es:[bx+2], 0
		les	bx, g_ppTrakdata22
		mov	al, g_cStartRow2
		inc	al
		mov	es:[bx+2], al
		les	bx, g_ppTrakdata18
		mov	byte ptr es:[bx+2], 0
		les	bx, g_ppTrakdata17
		mov	byte ptr es:[bx+3], 9
		les	bx, g_pTrakdata21
		mov	byte ptr es:[bx+3], 1
		les	bx, g_ppTrakdata22
		mov	al, g_cStartRow2
		inc	al
		mov	es:[bx+3], al
		les	bx, g_ppTrakdata18
		mov	byte ptr es:[bx+3], 0
		les	bx, g_ppTrakdata17
		mov	byte ptr es:[bx+4], 7
		les	bx, g_pTrakdata21
		mov	byte ptr es:[bx+4], 1
		les	bx, g_ppTrakdata22
		mov	al, g_cStartRow2
		mov	es:[bx+4], al
		les	bx, g_ppTrakdata18
		mov	byte ptr es:[bx+4], 0
		les	bx, g_ppTrakdata3
		mov	es:[bx], si
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+2], 1
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+4], 2
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+6], 3
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+8], 4
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+0Ah], 1
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+0Ch], 2
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+0Eh], 3
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+10h], 4
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+12h], 1
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+14h], 2
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+16h], 3
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+18h], 4
		les	bx, g_ppTrakdata3
		mov	es:[bx+1Ah], si
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+1Ch], 1
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+1Eh], 2
		les	bx, g_ppTrakdata3
		mov	word ptr es:[bx+20h], 3
		les	bx, g_ppTrakdata3
		mov	es:[bx+22h], si
		mov	byte_2B77_95E0,	0C8h ; 'È'
		sub	ax, ax
		push	ax
		mov	ax, g_wTrackPos+38h
		add	ax, 12Eh
		cwd
		mov	cl, 6

loc_471_4E7C:				; CODE XREF: InitPlanTrak+1B2j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_471_4E7C
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		mov	ax, 7700h
		mov	dx, 1
		push	dx
		push	ax
		mov	ax, dx
		push	ax
		mov	ax, offset g_pCarInfoSimd2
		push	ax
		mov	ax, offset gameState.carOpponent
		push	ax
		push	cs
		call	near ptr InitCvxWithSimd
		add	sp, 14h
		mov	ax, offset gameState.field_3F9
		push	ax
		mov	al, gameState.carOpponent.field_CE
		inc	gameState.carOpponent.field_CE
		sub	ah, ah
		push	ax
		mov	ax, offset gameState.carOpponent.vecUnk3
		push	ax
		mov	bx, gameState.carOpponent.wTrakdata3Index
		shl	bx, 1
		les	di, g_ppTrakdata3
		push	word ptr es:[bx+di]
		push	cs
		call	near ptr DoSomeTrakData
		add	sp, 8
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InitPlanTrak	endp


; =============== S U B	R O U T	I N E =======================================


DoOpponentOp	proc far		; CODE XREF: SetupIntro+1B9P
		push	cs
		call	near ptr OpponentOp
		retf
DoOpponentOp	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CvxSfxOp	proc far		; CODE XREF: OpponentOp+64Ep
					; TrkPlanSimd+3BBp ...

var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	ax, [bp+arg_2]
		or	ax, ax
		jz	short loc_471_4EEC
		cmp	ax, 1
		jz	short loc_471_4F02
		jmp	short loc_471_4EF1
; ---------------------------------------------------------------------------

loc_471_4EEC:				; CODE XREF: CvxSfxOp+Dj
		mov	[bp+var_4], offset gameState.carPlayer

loc_471_4EF1:				; CODE XREF: CvxSfxOp+14j CvxSfxOp+31j
		mov	bx, [bp+var_4]
		cmp	[bx+CarState.field_C9],	0
		jz	short loc_471_4F0A
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_4F02:				; CODE XREF: CvxSfxOp+12j
		mov	[bp+var_4], offset gameState.carOpponent
		jmp	short loc_471_4EF1
; ---------------------------------------------------------------------------
		nop

loc_471_4F0A:				; CODE XREF: CvxSfxOp+23j
		mov	[bp+var_2], 0
		mov	ax, [bp+arg_0]
		cmp	ax, 1
		jz	short loc_471_4F6F
		cmp	ax, 2
		jnz	short loc_471_4F1E
		jmp	loc_471_4FCE
; ---------------------------------------------------------------------------

loc_471_4F1E:				; CODE XREF: CvxSfxOp+43j
		cmp	ax, 3
		jnz	short loc_471_4F26
		jmp	loc_471_5020
; ---------------------------------------------------------------------------

loc_471_4F26:				; CODE XREF: CvxSfxOp+4Bj
		cmp	ax, 4
		jz	short loc_471_4F32
		cmp	ax, 5
		jz	short loc_471_4F66
		jmp	short loc_471_4F3E
; ---------------------------------------------------------------------------

loc_471_4F32:				; CODE XREF: CvxSfxOp+53j
		mov	gameState.wFrameInSec, 1
		mov	gameState.wFramesPerSec, 1

loc_471_4F3E:				; CODE XREF: CvxSfxOp+5Aj CvxSfxOp+D2j ...
		cmp	[bp+var_2], 0
		jz	short loc_471_4F54
		mov	bx, [bp+var_4]
		mov	[bx+CarState.wTrackGrip2], 0
		mov	bx, [bp+var_4]
		mov	[bx+CarState.wTrackGrip], 0

loc_471_4F54:				; CODE XREF: CvxSfxOp+6Cj
		cmp	[bp+arg_2], 0
		jnz	short loc_471_4F5D
		jmp	loc_471_5050
; ---------------------------------------------------------------------------

loc_471_4F5D:				; CODE XREF: CvxSfxOp+82j
		mov	ax, gameState.wGameFrame
		mov	gameState.wGameFrame2, ax
		jmp	loc_471_5056
; ---------------------------------------------------------------------------

loc_471_4F66:				; CODE XREF: CvxSfxOp+58j
		mov	[bp+arg_0], 1
		mov	[bp+var_2], 1

loc_471_4F6F:				; CODE XREF: CvxSfxOp+3Ej
		mov	bx, [bp+var_4]
		mov	[bx+CarState.field_C9],	1
		sub	ax, ax
		push	ax
		mov	bx, [bp+var_4]
		push	[bx+CarState.vecRotate.wX]
		push	[bp+arg_2]
		push	cs
		call	near ptr SetMegaTemplVecLong
		add	sp, 6
		cmp	[bp+arg_2], 0
		jnz	short loc_471_4FA3
		mov	bx, [bp+var_4]
		mov	ax, [bx+CarState.wTrackGrip2]
		mov	gameState.field_14C, ax
		mov	ax, g_wFramesPerSec
		shl	ax, 1
		shl	ax, 1
		mov	gameState.wFramesPerSec, ax

loc_471_4FA3:				; CODE XREF: CvxSfxOp+B8j
		cmp	g_cGameFlag2, 0
		jnz	short loc_471_4F3E
		cmp	g_cIniEng1Flag1, 0
		jz	short loc_471_4F3E
		cmp	[bp+arg_2], 0
		jnz	short loc_471_4FBE
		push	g_wSfxEng1Resul
		jmp	short loc_471_4FC2
; ---------------------------------------------------------------------------
		nop

loc_471_4FBE:				; CODE XREF: CvxSfxOp+DFj
		push	g_wSfxOppEngResul

loc_471_4FC2:				; CODE XREF: CvxSfxOp+E5j
		call	WrapAudFunc2_2
		add	sp, 2
		jmp	loc_471_4F3E
; ---------------------------------------------------------------------------
		nop

loc_471_4FCE:				; CODE XREF: CvxSfxOp+45j
		cmp	g_cGameFlag2, 0
		jnz	short loc_471_4FF4
		cmp	g_cIniEng1Flag1, 0
		jz	short loc_471_4FF4
		cmp	[bp+arg_2], 0
		jnz	short loc_471_4FE8
		push	g_wSfxEng1Resul
		jmp	short loc_471_4FEC
; ---------------------------------------------------------------------------

loc_471_4FE8:				; CODE XREF: CvxSfxOp+10Aj
		push	g_wSfxOppEngResul

loc_471_4FEC:				; CODE XREF: CvxSfxOp+110j
		call	WrapAudFunc2_2
		add	sp, 2

loc_471_4FF4:				; CODE XREF: CvxSfxOp+FDj
					; CvxSfxOp+104j
		mov	bx, [bp+var_4]
		mov	[bx+CarState.field_C9],	2
		mov	[bp+var_2], 1
		cmp	[bp+arg_2], 0
		jz	short loc_471_5009
		jmp	loc_471_4F3E
; ---------------------------------------------------------------------------

loc_471_5009:				; CODE XREF: CvxSfxOp+12Ej
		mov	bx, [bp+var_4]
		mov	ax, [bx+CarState.wTrackGrip2]
		mov	gameState.field_14C, ax
		mov	ax, g_wFramesPerSec
		shl	ax, 1
		shl	ax, 1

loc_471_5019:				; CODE XREF: CvxSfxOp+169j
		mov	gameState.wFramesPerSec, ax
		jmp	loc_471_4F3E
; ---------------------------------------------------------------------------
		nop

loc_471_5020:				; CODE XREF: CvxSfxOp+4Dj
		mov	bx, [bp+var_4]
		mov	[bx+CarState.field_C9],	3
		cmp	[bp+arg_2], 0
		jnz	short loc_471_5042
		mov	ax, gameState.wGameFrame
		add	ax, gameState.wFramesPerSecCounter
		add	ax, g_wResetOnCvxTr
		mov	gameState.field_142, ax
		mov	ax, g_wFramesPerSec
		jmp	short loc_471_5019
; ---------------------------------------------------------------------------
		nop

loc_471_5042:				; CODE XREF: CvxSfxOp+156j
		mov	ax, gameState.wGameFrame
		add	ax, g_wResetOnCvxTr
		mov	gameState.field_144, ax
		jmp	loc_471_4F3E
; ---------------------------------------------------------------------------
		nop

loc_471_5050:				; CODE XREF: CvxSfxOp+84j
		mov	ax, gameState.wGameFrame
		mov	gameState.field_146, ax

loc_471_5056:				; CODE XREF: CvxSfxOp+8Dj
		cmp	gameState.cCvxFlag3, 0
		jnz	short loc_471_5069
		cmp	[bp+arg_2], 0
		jnz	short loc_471_5069
		mov	al, byte ptr [bp+arg_0]
		mov	gameState.cCvxFlag3, al

loc_471_5069:				; CODE XREF: CvxSfxOp+185j
					; CvxSfxOp+18Bj
		test	g_wMainFlag, 4
		jnz	short loc_471_507D
		mov	di, offset word_2B77_8BD8
		mov	si, offset gameState.field_13C
		push	ds
		pop	es
		assume es:dseg
		mov	cx, 0Bh
		repne movsw

loc_471_507D:				; CODE XREF: CvxSfxOp+198j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
CvxSfxOp	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PlaneRotateOp	proc far		; CODE XREF: TrkPlanSimd+21Ep
					; TrkPlanSimd+B09p ...

pPlane		= dword	ptr -36h
vec2		= Vector3D ptr -32h
matPlanRotCopy	= Matrix ptr -2Ch
matPlanRot	= Matrix ptr -1Ah
vec		= Vector3D ptr -8

		push	bp
		mov	bp, sp
		sub	sp, 36h
		push	di
		push	si
		cmp	g_wSomePlanIndex, 0FFFFh
		jnz	short loc_471_5096
		jmp	loc_471_51B2
; ---------------------------------------------------------------------------

loc_471_5096:				; CODE XREF: PlaneRotateOp+Dj
		mov	ax, 22h		; sizeof plane
		imul	g_wSomePlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		mov	word ptr [bp+pPlane], ax
		mov	word ptr [bp+pPlane+2],	dx
		les	bx, [bp+pPlane]
		assume es:nothing
		mov	ax, g_wSomeAngleXY
		cmp	es:[bx+Plane.dwAngleXY], ax
		jnz	short loc_471_50C6
		mov	ax, g_wSomeAngleYZ
		cmp	es:[bx+Plane.dwAngleYZ], ax
		jnz	short loc_471_50C6
		mov	si, word_2B77_97D6
		jmp	short loc_471_5135
; ---------------------------------------------------------------------------
		nop

loc_471_50C6:				; CODE XREF: PlaneRotateOp+31j
					; PlaneRotateOp+39j
		lea	ax, [bp+vec]
		push	ax
		mov	ax, offset g_mat3
		push	ax
		mov	ax, offset vec_2B77_97C6
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, 22h		; sizeof plane
		imul	g_wSomePlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		add	ax, Plane.matRotation
		push	si
		lea	di, [bp+matPlanRot]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		mov	cx, 9
		repne movsw
		pop	ds
		pop	si
		lea	ax, [bp+matPlanRotCopy]
		push	ax
		lea	ax, [bp+matPlanRot]
		push	ax
		call	MatCopy
		add	sp, 4
		lea	ax, [bp+vec2]
		push	ax
		lea	ax, [bp+matPlanRotCopy]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	[bp+vec2.wZ]
		mov	ax, [bp+vec2.wX]
		neg	ax
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		mov	si, ax

loc_471_5135:				; CODE XREF: PlaneRotateOp+3Fj
		add	si, g_wSomePi3Code
		jz	short loc_471_5194
		cmp	word ptr unk_2B77_6A6, si
		jz	short loc_471_5156
		mov	ax, si
		neg	ax
		push	ax
		mov	ax, offset g_mat1
		push	ax
		call	MatRotateY
		add	sp, 4
		mov	word ptr unk_2B77_6A6, si

loc_471_5156:				; CODE XREF: PlaneRotateOp+BBj
		lea	ax, [bp+vec2]
		push	ax
		mov	ax, offset g_mat1
		push	ax
		mov	ax, offset vec_2B77_97C6
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, offset g_vecPlaneRotOpResul
		push	ax
		mov	ax, 22h		; sizeof plane
		imul	g_wSomePlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		add	ax, Plane.matRotation
		push	dx
		push	ax
		lea	ax, [bp+vec2]

loc_471_5185:				; CODE XREF: PlaneRotateOp+12Bj
		push	ax
		push	cs
		call	near ptr MatMultiplyVector2
		add	sp, 8
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_471_5194:				; CODE XREF: PlaneRotateOp+B5j
		mov	ax, offset g_vecPlaneRotOpResul
		push	ax
		mov	ax, 22h		; sizeof plane
		imul	g_wSomePlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		add	ax, Plane.matRotation
		push	dx
		push	ax
		mov	ax, offset vec_2B77_97C6
		jmp	short loc_471_5185
; ---------------------------------------------------------------------------
		nop

loc_471_51B2:				; CODE XREF: PlaneRotateOp+Fj
		cmp	g_wSomePi3Code,	0
		jz	short loc_471_51FC
		mov	ax, word_2B77_6A4
		cmp	g_wSomePi3Code,	ax
		jz	short loc_471_51DA
		mov	ax, g_wSomePi3Code
		neg	ax
		push	ax
		mov	ax, offset g_mat2
		push	ax
		call	MatRotateY
		add	sp, 4
		mov	ax, g_wSomePi3Code
		mov	word_2B77_6A4, ax

loc_471_51DA:				; CODE XREF: PlaneRotateOp+13Cj
		lea	ax, [bp+vec2]
		push	ax
		mov	ax, offset g_mat2
		push	ax
		mov	ax, offset vec_2B77_97C6
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, offset g_vecPlaneRotOpResul
		push	ax
		mov	ax, offset g_mat3
		push	ax
		lea	ax, [bp+vec2]
		jmp	short loc_471_5207
; ---------------------------------------------------------------------------
		nop

loc_471_51FC:				; CODE XREF: PlaneRotateOp+133j
		mov	ax, offset g_vecPlaneRotOpResul
		push	ax
		mov	ax, offset g_mat3
		push	ax
		mov	ax, offset vec_2B77_97C6

loc_471_5207:				; CODE XREF: PlaneRotateOp+175j
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
PlaneRotateOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PlaneOriginOp	proc far		; CODE XREF: TrkPlanSimd+4AFp
					; TrkPlanSimd+92Ep ...

vec2		= Vector3D ptr -10h
vec		= Vector3D ptr -0Ah
pPlane		= dword	ptr -4
p_wPlanIndex	= word ptr  6
p_wX		= word ptr  8
p_wY		= word ptr  0Ah
p_wZ		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 10h
		mov	ax, g_wPlanIndex
		cmp	[bp+p_wPlanIndex], ax
		jnz	short loc_471_522E
		mov	ax, word ptr g_pTrkWallTerrainPla
		mov	dx, word ptr g_pTrkWallTerrainPla+2
		jmp	short loc_471_523C
; ---------------------------------------------------------------------------
		nop

loc_471_522E:				; CODE XREF: PlaneOriginOp+Cj
		mov	ax, 22h		; sizeof plane
		imul	[bp+p_wPlanIndex]
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2

loc_471_523C:				; CODE XREF: PlaneOriginOp+15j
		mov	word ptr [bp+pPlane], ax
		mov	word ptr [bp+pPlane+2],	dx
		les	bx, [bp+pPlane]
		mov	ax, es:[bx+Plane.vecOrigin.wY]
		add	ax, g_dwSomeY
		mov	[bp+vec2.wY], ax
		mov	ax, [bp+p_wY]
		sub	ax, [bp+vec2.wY]
		mov	[bp+vec.wY], ax
		cmp	[bp+p_wPlanIndex], 4
		jl	short loc_471_529E
		mov	ax, es:[bx+Plane.vecOrigin.wX]
		add	ax, g_dwSomeX
		mov	[bp+vec2.wX], ax
		mov	ax, es:[bx+Plane.vecOrigin.wZ]
		add	ax, g_dwSomeZ
		mov	[bp+vec2.wZ], ax
		mov	ax, [bp+p_wX]
		sub	ax, [bp+vec2.wX]
		mov	[bp+vec.wX], ax
		mov	ax, [bp+p_wZ]
		sub	ax, [bp+vec2.wZ]
		mov	[bp+vec.wZ], ax
		mov	ax, bx
		add	ax, Plane.vecNormal
		push	dx
		push	ax
		push	[bp+vec.wZ]
		push	[bp+vec.wY]
		push	[bp+vec.wX]
		push	cs
		call	near ptr VectorNormalOp
		add	sp, 0Ah

loc_471_529E:				; CODE XREF: PlaneOriginOp+47j
		mov	sp, bp
		pop	bp
		retf
PlaneOriginOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

VectorNormalOp	proc far		; CODE XREF: PlaneOriginOp+82p

var_4		= word ptr -4
var_2		= word ptr -2
p_wX		= word ptr  6
p_wY		= word ptr  8
p_wZ		= word ptr  0Ah
p_pVecNormal	= dword	ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	ax, 2000h
		cwd
		push	dx
		push	ax
		mov	ax, [bp+p_wX]
		cwd
		push	dx
		push	ax
		les	bx, [bp+p_pVecNormal]
		mov	ax, es:[bx+Vector3D.wX]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		mov	cx, ax
		mov	ax, [bp+p_wZ]
		mov	bx, dx
		cwd
		push	dx
		push	ax
		les	si, [bp+p_pVecNormal]
		mov	ax, es:[si+Vector3D.wZ]
		cwd
		push	dx
		push	ax
		mov	si, cx
		mov	di, bx
		call	__aFlmul
		mov	cx, ax
		mov	ax, [bp+p_wY]
		mov	bx, dx
		cwd
		push	dx
		push	ax
		mov	ax, bx
		les	bx, [bp+p_pVecNormal]
		mov	dx, ax
		mov	ax, es:[bx+Vector3D.wY]
		mov	[bp+var_4], cx
		mov	[bp+var_2], dx
		cwd
		push	dx
		push	ax
		call	__aFlmul
		add	ax, [bp+var_4]
		adc	dx, [bp+var_2]
		add	ax, si
		adc	dx, di
		push	dx
		push	ax
		call	__aFldiv
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
VectorNormalOp	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetMegaTemplVecLong proc far		; CODE XREF: TrkPlanSimd+1968p
					; CvxSfxOp+AEp

var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_8		= word ptr -8
var_6		= word ptr -6
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 18h
		push	di
		push	si
		cmp	[bp+arg_0], 2
		jge	short loc_471_534E
		mov	ax, [bp+arg_2]
		mov	[bp+var_6], ax
		mov	[bp+var_2], 400h
		mov	[bp+var_E], 12h
		mov	ax, [bp+arg_0]
		shl	ax, 1
		shl	ax, 1
		add	ax, 4
		mov	[bp+var_10], ax
		mov	[bp+var_8], 6
		jmp	short loc_471_536B
; ---------------------------------------------------------------------------

loc_471_534E:				; CODE XREF: SetMegaTemplVecLong+Cj
		mov	ax, [bp+arg_2]
		sub	ax, 60h	; '`'
		mov	[bp+var_6], ax
		mov	[bp+var_2], 0C0h ; 'À'
		mov	[bp+var_E], 8
		mov	[bp+var_10], 0
		mov	[bp+var_8], 1

loc_471_536B:				; CODE XREF: SetMegaTemplVecLong+30j
		mov	gameState.field_42A, 1
		mov	[bp+var_12], 0
		sub	si, si

loc_471_5377:				; CODE XREF: SetMegaTemplVecLong+6Dj
		mov	bx, si
		shl	bx, 1
		cmp	word ptr gameState.field_38E[bx], 0
		jnz	short loc_471_5385
		inc	[bp+var_12]

loc_471_5385:				; CODE XREF: SetMegaTemplVecLong+64j
		inc	si
		cmp	si, 18h
		jl	short loc_471_5377
		mov	ax, [bp+var_E]
		cmp	[bp+var_12], ax
		jle	short loc_471_5396
		mov	[bp+var_12], ax

loc_471_5396:				; CODE XREF: SetMegaTemplVecLong+75j
		mov	[bp+var_C], 0
		sub	si, si
		jmp	short loc_471_53A1
; ---------------------------------------------------------------------------
		nop

loc_471_53A0:				; CODE XREF: SetMegaTemplVecLong+9Bj
					; SetMegaTemplVecLong+16Aj
		inc	si

loc_471_53A1:				; CODE XREF: SetMegaTemplVecLong+81j
		cmp	si, 18h
		jl	short loc_471_53A9
		jmp	loc_471_5489
; ---------------------------------------------------------------------------

loc_471_53A9:				; CODE XREF: SetMegaTemplVecLong+88j
		mov	ax, si
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, ax
		cmp	word ptr gameState.field_38E[bx], 0
		jnz	short loc_471_53A0
		mov	al, byte ptr [bp+arg_0]
		mov	gameState.field_443[si], al
		mov	al, byte ptr [bp+var_C]
		and	al, 3
		add	al, byte ptr [bp+var_10]
		mov	gameState.field_42B[si], al
		mov	ax, si
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_16], ax
		mov	bx, ax
		sub	ax, ax
		mov	word ptr (gameState.vecLong8_1.dwX+2)[bx], ax
		mov	word ptr gameState.vecLong8_1.dwX[bx], ax
		mov	bx, [bp+var_16]
		mov	word ptr (gameState.vecLong8_2.dwX+2)[bx], ax
		mov	word ptr gameState.vecLong8_2.dwX[bx], ax
		mov	bx, [bp+var_16]
		mov	word ptr (gameState.vecLong8_3.dwX+2)[bx], ax
		mov	word ptr gameState.vecLong8_3.dwX[bx], ax
		call	GetRandomKevin
		shl	ax, 1
		shl	ax, 1
		mov	bx, [bp+var_14]
		mov	gameState.field_2FE[bx], ax
		call	GetRandomKevin
		shl	ax, 1
		shl	ax, 1
		mov	bx, si
		shl	bx, 1
		mov	gameState.field_32E[bx], ax
		mov	ax, [bp+var_12]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_C]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_2]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, [bp+var_6]
		and	ah, 3
		mov	bx, si
		shl	bx, 1
		mov	gameState.field_35E[bx], ax
		call	GetRandomKevin
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		mov	cl, 2
		sar	di, cl
		add	di, [bp+arg_4]
		add	di, 180h
		mov	ax, si
		shl	ax, 1
		mov	[bp+var_18], ax
		mov	bx, ax
		mov	word ptr gameState.field_38E[bx], di
		mov	ax, [bp+var_8]
		imul	di
		sar	ax, 1
		sar	ax, 1
		mov	bx, [bp+var_18]
		mov	word ptr gameState.field_3BE[bx], ax
		inc	[bp+var_C]
		mov	ax, [bp+var_12]
		cmp	[bp+var_C], ax
		jz	short loc_471_5489
		jmp	loc_471_53A0
; ---------------------------------------------------------------------------

loc_471_5489:				; CODE XREF: SetMegaTemplVecLong+8Aj
					; SetMegaTemplVecLong+168j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetMegaTemplVecLong endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_471_5490	proc far		; CODE XREF: UpdateGameState+E1p

var_14		= word ptr -14h
var_12		= word ptr -12h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
pMatrix		= word ptr -4
var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 14h
		push	di
		push	si
		mov	[bp+var_2], 0
		sub	si, si
		jmp	short loc_471_54B3
; ---------------------------------------------------------------------------

loc_471_54A0:				; CODE XREF: sub_471_5490+E5j
		mov	[bp+var_2], 1
		mov	di, si
		shl	di, 1
		add	gameState.field_2FE[di], 10h
		add	gameState.field_32E[di], 10h

loc_471_54B2:				; CODE XREF: sub_471_5490+34j
					; sub_471_5490+F2j
		inc	si

loc_471_54B3:				; CODE XREF: sub_471_5490+Ej
		cmp	si, 18h
		jl	short loc_471_54BB
		jmp	loc_471_5586
; ---------------------------------------------------------------------------

loc_471_54BB:				; CODE XREF: sub_471_5490+26j
		mov	di, si
		shl	di, 1
		cmp	word ptr gameState.field_38E[di], 0
		jz	short loc_471_54B2
		mov	ax, 1
		push	ax
		push	gameState.field_35E[di]
		sub	ax, ax
		push	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		mov	[bp+var_C], 0
		mov	[bp+var_A], 0
		mov	bx, si
		shl	bx, 1
		mov	ax, word ptr gameState.field_38E[bx]
		mov	[bp+var_8], ax
		lea	ax, [bp+var_12]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+var_C]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	di, si
		mov	cl, 2
		shl	di, cl
		mov	ax, [bp+var_12]
		cwd
		add	word ptr gameState.vecLong8_1.dwX[di], ax
		adc	word ptr (gameState.vecLong8_1.dwX+2)[di], dx
		mov	ax, [bp+var_E]
		cwd
		add	word ptr gameState.vecLong8_3.dwX[di], ax
		adc	word ptr (gameState.vecLong8_3.dwX+2)[di], dx
		mov	ax, si
		shl	ax, 1
		add	ax, offset gameState.field_3BE
		mov	[bp+var_14], ax
		mov	bx, ax
		sub	word ptr [bx], 13h
		mov	bx, [bp+var_14]
		mov	ax, [bx]
		cwd
		add	word ptr gameState.vecLong8_2.dwX[di], ax
		adc	word ptr (gameState.vecLong8_2.dwX+2)[di], dx
		cmp	g_wFramesPerSec, 0Ah
		jnz	short loc_471_555B
		mov	bx, [bp+var_14]
		sub	word ptr [bx], 13h
		mov	bx, [bp+var_14]
		mov	ax, [bx]
		cwd
		add	word ptr gameState.vecLong8_2.dwX[di], ax
		adc	word ptr (gameState.vecLong8_2.dwX+2)[di], dx

loc_471_555B:				; CODE XREF: sub_471_5490+B5j
		mov	bx, si
		shl	bx, 1
		shl	bx, 1
		mov	ax, word ptr gameState.vecLong8_2.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_2.dwX+2)[bx]
		add	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		adc	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		or	dx, dx
		jl	short loc_471_5578
		jmp	loc_471_54A0
; ---------------------------------------------------------------------------

loc_471_5578:				; CODE XREF: sub_471_5490+E3j
		mov	bx, si
		shl	bx, 1
		mov	word ptr gameState.field_38E[bx], 0
		jmp	loc_471_54B2
; ---------------------------------------------------------------------------
		nop

loc_471_5586:				; CODE XREF: sub_471_5490+28j
		mov	al, [bp+var_2]
		mov	gameState.field_42A, al
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_471_5490	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupAeroTrakdata proc far		; CODE XREF: RunCarMenu+3EBP
					; SetupIntro+138P ...

p_pCarRes	= word ptr  6
p_pCarResSeg	= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		cmp	[bp+arg_4], 0
		jz	short loc_471_55A3
		jmp	loc_471_5626
; ---------------------------------------------------------------------------

loc_471_55A3:				; CODE XREF: SetupAeroTrakdata+Cj
		mov	ax, offset aSimd ; "simd"
		push	ax
		push	[bp+p_pCarResSeg]
		push	[bp+p_pCarRes]
		call	AltLocateShape
		add	sp, 6
		push	si
		mov	di, offset g_dwCopyOfSimd
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		push	ds
		mov	ds, dx
		mov	cx, 184h	; 0x184	= 388 words at 776 bytes, which	is the correct size of car*.res	simd parameters
		repne movsw
		pop	ds
		pop	si
		mov	ax, word ptr g_ppTrakdata4
		mov	dx, word ptr g_ppTrakdata4+2
		mov	word ptr g_dwCopyOfSimd.pAeroResTable, ax
		mov	word ptr g_dwCopyOfSimd.pAeroResTable+2, dx
		sub	si, si

loc_471_55D7:				; CODE XREF: SetupAeroTrakdata+78j
		mov	ax, si
		cwd
		push	dx
		push	ax
		cwd
		push	dx
		push	ax
		mov	ax, g_dwCopyOfSimd.wAeroResistance
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFlmul
		mov	cl, 9

loc_471_55F3:				; CODE XREF: SetupAeroTrakdata+67j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_55F3
		mov	bx, si
		shl	bx, 1
		les	di, g_ppTrakdata4
		assume es:nothing
		mov	es:[bx+di], ax	; write	to trakdata4
		inc	si
		cmp	si, 40h	; '@'
		jl	short loc_471_55D7
		mov	ax, offset aGnam ; "gnam"
		push	ax
		push	[bp+p_pCarResSeg]
		push	[bp+p_pCarRes]
		call	AltLocateShape	; gnam = Scoreboard car	name from car*.res
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pcCarScoreNam
		jmp	loc_471_56A6
; ---------------------------------------------------------------------------

loc_471_5626:				; CODE XREF: SetupAeroTrakdata+Ej
		mov	ax, offset aSimd_0 ; "simd"
		push	ax
		push	[bp+p_pCarResSeg]
		push	[bp+p_pCarRes]
		call	AltLocateShape
		add	sp, 6
		push	si
		mov	di, offset g_pCarInfoSimd2
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		push	ds
		mov	ds, dx
		mov	cx, 184h	; simd is 338 words
		repne movsw
		pop	ds
		pop	si
		mov	ax, word ptr g_ppTrakdata5 ; dx:ax = pointer to	the trakdata-memory
		mov	dx, word ptr g_ppTrakdata5+2
		mov	word ptr g_pCarInfoSimd2.pAeroResTable,	ax
		mov	word ptr g_pCarInfoSimd2.pAeroResTable+2, dx ; the trakdataseg is stored outside the simd??
		sub	si, si

loc_471_565A:				; CODE XREF: SetupAeroTrakdata+FBj
		mov	ax, si
		cwd
		push	dx
		push	ax
		cwd
		push	dx
		push	ax
		mov	ax, g_pCarInfoSimd2.wAeroResistance
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFlmul
		mov	cl, 9

loc_471_5676:				; CODE XREF: SetupAeroTrakdata+EAj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_471_5676
		mov	bx, si
		shl	bx, 1
		les	di, g_ppTrakdata5
		assume es:nothing
		mov	es:[bx+di], ax	; write	to trakdata5[counter*2]
		inc	si
		cmp	si, 40h	; '@'   ; si goes to 64
		jl	short loc_471_565A
		mov	ax, offset aGsna ; "gsna"
		push	ax
		push	[bp+p_pCarResSeg]
		push	[bp+p_pCarRes]
		call	AltLocateShape
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pcCarShortNam

loc_471_56A6:				; CODE XREF: SetupAeroTrakdata+91j
		push	ax
		call	CopyString
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetupAeroTrakdata endp

seg001		ends

; ---------------------------------------------------------------------------
; ===========================================================================

; Segment type:	Pure code
seg002		segment	byte public 'CODE' use16
		assume cs:seg002
		;org 5
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GearRpmCalculation proc	far		; CODE XREF: UpdateCarState+4E5P

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		push	bp
		mov	cx, [bp+arg_0]
		mov	ax, [bp+arg_2]
		cmp	[bp+arg_6], 0
		jnz	short loc_9DC_1B
		mul	[bp+arg_4]
		mov	cx, dx

loc_9DC_1B:				; CODE XREF: GearRpmCalculation+Ej
		cmp	cx, [bp+arg_8]
		jnb	short loc_9DC_23
		mov	cx, [bp+arg_8]

loc_9DC_23:				; CODE XREF: GearRpmCalculation+18j
		mov	ax, cx
		pop	bp
		pop	bp
		retf
GearRpmCalculation endp

; [00000017 BYTES: COLLAPSED FUNCTION nopsub_9DC_28. PRESS KEYPAD "+" TO EXPAND]
; [0000000A BYTES: COLLAPSED FUNCTION nopsub_9DC_3F. PRESS KEYPAD "+" TO EXPAND]
; [0000000A BYTES: COLLAPSED FUNCTION nopsub_9DC_49. PRESS KEYPAD "+" TO EXPAND]
; [0000000E BYTES: COLLAPSED FUNCTION nopsub_9DC_53. PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetKevinRndSeed	proc far		; CODE XREF: _main+26CP
					; RestoreGameState+ADP

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	bp
		mov	bx, [bp+arg_0]
		mov	al, [bx]
		mov	g_pcKevinSeed, al
		mov	al, [bx+1]
		mov	g_pcKevinSeed+1, al
		mov	al, [bx+2]
		mov	g_pcKevinSeed+2, al
		mov	al, [bx+3]
		mov	g_pcKevinSeed+3, al
		mov	al, [bx+4]
		mov	g_pcKevinSeed+4, al
		mov	al, [bx+5]
		mov	g_pcKevinSeed+5, al
		pop	bp
		pop	bp
		retf
SetKevinRndSeed	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetKevinRndSeed	proc far		; CODE XREF: UpdateGameState+39P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	bp
		mov	bx, [bp+arg_0]
		mov	al, g_pcKevinSeed
		mov	[bx], al
		mov	al, g_pcKevinSeed+1
		mov	[bx+1],	al
		mov	al, g_pcKevinSeed+2
		mov	[bx+2],	al
		mov	al, g_pcKevinSeed+3
		mov	[bx+3],	al
		mov	al, g_pcKevinSeed+4
		mov	[bx+4],	al
		mov	al, g_pcKevinSeed+5
		mov	[bx+5],	al
		pop	bp
		pop	bp
		retf
GetKevinRndSeed	endp


; =============== S U B	R O U T	I N E =======================================


GetRandomKevin	proc far		; CODE XREF: EndOfGameScores+716P
					; EndOfGameScores:loc_0_38A0P ...
		mov	al, g_pcKevinSeed+5
		add	al, g_pcKevinSeed+4
		mov	g_pcKevinSeed+4, al
		add	al, g_pcKevinSeed+3
		mov	g_pcKevinSeed+3, al
		add	al, g_pcKevinSeed+2
		mov	g_pcKevinSeed+2, al
		add	al, g_pcKevinSeed+1
		mov	g_pcKevinSeed+1, al
		add	al, g_pcKevinSeed
		mov	g_pcKevinSeed, al
		inc	g_pcKevinSeed+5
		jnz	short loc_9DC_103
		inc	g_pcKevinSeed+4
		jnz	short loc_9DC_103
		inc	g_pcKevinSeed+3
		jnz	short loc_9DC_103
		inc	g_pcKevinSeed+2
		jnz	short loc_9DC_103
		inc	g_pcKevinSeed+1
		jnz	short loc_9DC_103
		inc	g_pcKevinSeed

loc_9DC_103:				; CODE XREF: GetRandomKevin+2Aj
					; GetRandomKevin+30j ...
		mov	al, g_pcKevinSeed
		xor	ah, ah
		retf
GetRandomKevin	endp

; ---------------------------------------------------------------------------

loc_9DC_109:				; DATA XREF: SetDivZeroHandl+14o
		push	bp
		mov	bp, sp
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, [bp+4]
		mov	word_2B77_6C0, ax
		mov	ax, [bp+2]
		mov	word_2B77_6C2, ax
		inc	ax
		inc	ax
		mov	[bp+2],	ax
		xor	ax, ax
		pop	ds
		pop	bp
		iret

; =============== S U B	R O U T	I N E =======================================


SetDivZeroHandl	proc far		; CODE XREF: _main+16P
		push	ds
		mov	ah, 35h
		mov	al, 0
		int	21h		; DOS -	2+ - GET INTERRUPT VECTOR
					; AL = interrupt number
					; Return: ES:BX	= value	of interrupt vector
		mov	word ptr g_pOldInt0+2, es
		mov	word ptr g_pOldInt0, bx
		mov	dx, seg	seg002
		mov	ds, dx
		assume ds:seg002
		mov	dx, offset loc_9DC_109
		mov	ah, 25h
		mov	al, 0
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		assume ds:dseg
		retf
SetDivZeroHandl	endp

; ---------------------------------------------------------------------------
		db 1Eh,	0C5h, 16h, 0BCh, 6, 0B4h, 25h, 0B0h, 0,	0CDh, 21h
seg002		ends

; ---------------------------------------------------------------------------
; ===========================================================================

; Segment type:	Pure code
seg003		segment	byte public 'CODE' use16
		assume cs:seg003
		;org 2
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		pop	ds
		retf

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_9F1_4	proc far		; CODE XREF: RunGame+565P

var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		cmp	g_wVideoFlag4, 0
		jz	short loc_9F1_16
		jmp	loc_9F1_180
; ---------------------------------------------------------------------------

loc_9F1_16:				; CODE XREF: sub_9F1_4+Dj
		call	SetSprite2As1_2
		cmp	byte_2B77_9D34,	0
		jz	short loc_9F1_25
		jmp	loc_9F1_136
; ---------------------------------------------------------------------------

loc_9F1_25:				; CODE XREF: sub_9F1_4+1Cj
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_2F
		jmp	loc_9F1_120
; ---------------------------------------------------------------------------

loc_9F1_2F:				; CODE XREF: sub_9F1_4+26j
		sub	si, si

loc_9F1_31:				; CODE XREF: sub_9F1_4+36j
		mov	byte ptr unk_2B77_9DB0[si], 3
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_31
		cmp	g_wTimerFlag3, 4
		jnz	short loc_9F1_49
		mov	ax, word_2B77_AC66
		mov	word_2B77_928E,	ax

loc_9F1_49:				; CODE XREF: sub_9F1_4+3Dj
		mov	ax, word_2B77_AC66
		cmp	word_2B77_928E,	ax
		jnz	short loc_9F1_7B
		mov	ax, g_arrRcMegapol2.dwLeft+28h
		cmp	g_arrRcMegapoly.dwLeft+28h, ax
		jnz	short loc_9F1_7B
		mov	ax, g_arrRcMegapol2.dwTop+28h
		cmp	g_arrRcMegapoly.dwTop+28h, ax
		jnz	short loc_9F1_7B
		mov	ax, g_arrRcMegapol2.dwRight+28h
		cmp	g_arrRcMegapoly.dwRight+28h, ax
		jnz	short loc_9F1_7B
		mov	ax, g_arrRcMegapol2.dwBottom+28h
		cmp	g_arrRcMegapoly.dwBottom+28h, ax
		jnz	short loc_9F1_7B
		mov	g_cRectCmpFlag,	0

loc_9F1_7B:				; CODE XREF: sub_9F1_4+4Cj
					; sub_9F1_4+55j ...
		mov	byte_2B77_A9F6,	0
		mov	ax, offset unk_2B77_965E
		push	ax
		mov	ax, offset byte_2B77_A9F6
		push	ax
		push	[bp+arg_0]
		mov	ax, offset g_arrRcMegapol2
		push	ax
		mov	ax, offset g_arrRcMegapoly
		push	ax
		mov	ax, offset unk_2B77_9DB0
		push	ax
		mov	ax, 0Fh
		push	ax
		call	MaybeSetupRects
		add	sp, 0Eh
		cmp	byte_2B77_A9F6,	0
		jz	short loc_9F1_10E
		mov	ax, offset unk_2B77_9E64
		push	ax
		mov	ax, offset unk_2B77_965E
		push	ax
		mov	al, byte_2B77_A9F6
		cbw
		push	ax
		call	sub_14D6_1DEA
		add	sp, 6
		call	DoRenderMouSpr3
		sub	si, si
		jmp	short loc_9F1_103
; ---------------------------------------------------------------------------

loc_9F1_C8:				; CODE XREF: sub_9F1_4+105j
		mov	bx, si
		shl	bx, 1
		mov	ax, word ptr unk_2B77_9E64[bx]
		mov	cl, 3
		shl	ax, cl
		add	ax, offset unk_2B77_965E
		mov	[bp+var_2], ax
		mov	bx, ax
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	SetSprite1Size
		add	sp, 8
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		inc	si

loc_9F1_103:				; CODE XREF: sub_9F1_4+C2j
		mov	al, byte_2B77_A9F6
		cbw
		cmp	ax, si
		jg	short loc_9F1_C8
		jmp	short loc_9F1_14E
; ---------------------------------------------------------------------------
		nop

loc_9F1_10E:				; CODE XREF: sub_9F1_4+A4j
		mov	bx, [bp+arg_0]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		jmp	short loc_9F1_12E
; ---------------------------------------------------------------------------

loc_9F1_120:				; CODE XREF: sub_9F1_4+28j
		mov	bx, [bp+arg_0]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]

loc_9F1_12E:				; CODE XREF: sub_9F1_4+11Aj
		call	SetSprite1Size
		add	sp, 8

loc_9F1_136:				; CODE XREF: sub_9F1_4+1Ej
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4

loc_9F1_14E:				; CODE XREF: sub_9F1_4+107j
		call	DoUseMousePos
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_180
		mov	ax, word_2B77_AC66
		mov	word_2B77_928E,	ax
		sub	si, si

loc_9F1_162:				; CODE XREF: sub_9F1_4+17Aj
		mov	di, si
		mov	cl, 3
		shl	di, cl
		push	si
		push	di
		lea	si, g_arrRcMegapoly.dwLeft[di]
		lea	di, g_arrRcMegapol2.dwLeft[di]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_162

loc_9F1_180:				; CODE XREF: sub_9F1_4+Fj
					; sub_9F1_4+154j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_9F1_4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_9F1_186	proc far		; CODE XREF: RunGame+27DP
					; SetupCarGameEtc+19CP
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_1DE
		push	si
		mov	di, offset g_arrRcMegapoly
		mov	si, offset g_rc
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	si
		push	si
		mov	di, offset g_arrRcMegapol2
		mov	si, offset g_rc
		movsw
		movsw
		movsw
		movsw
		pop	si
		mov	si, 1

loc_9F1_1B2:				; CODE XREF: sub_9F1_186+56j
		mov	di, si
		mov	cl, 3
		shl	di, cl
		push	si
		push	di
		lea	di, g_arrRcMegapoly.dwLeft[di]
		mov	si, offset g_rc1
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		push	si
		push	di
		lea	di, g_arrRcMegapol2.dwLeft[di]
		mov	si, offset g_rc1
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_1B2

loc_9F1_1DE:				; CODE XREF: sub_9F1_186+Dj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_9F1_186	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UpdateFrame	proc far		; CODE XREF: RunGame+4F3P

pVec		= dword	ptr -154h
var_150		= word ptr -150h
var_14E		= word ptr -14Eh
var_14C		= byte ptr -14Ch
var_134		= byte ptr -134h
var_132		= word ptr -132h
var_130		= byte ptr -130h
pSceneItem	= word ptr -12Eh
var_12C		= byte ptr -12Ch
var_12A		= word ptr -12Ah
vec3		= Vector3D ptr -128h
var_122		= byte ptr -122h
pMatrix3	= byte ptr -120h
var_10E		= word ptr -10Eh
cTerrainTile	= byte ptr -10Ch
var_10A		= byte ptr -10Ah
var_108		= dword	ptr -108h
pCvx		= word ptr -104h
var_102		= byte ptr -102h
var_100		= byte ptr -100h
wAngle1		= word ptr -0FEh
var_FC		= byte ptr -0FCh
wAngle2		= word ptr -0FAh
var_F6		= byte ptr -0F6h
wAngleX		= word ptr -0F4h
vec2		= Vector3D ptr -0F2h
vec1		= Vector3D ptr -0ECh
cMaterial	= byte ptr -0E4h
var_E2		= byte ptr -0E2h
var_E0		= word ptr -0E0h
wCounter	= word ptr -0DEh
var_DC		= byte ptr -0DCh
var_DB		= byte ptr -0DBh
var_DA		= word ptr -0DAh
var_D8		= byte ptr -0D8h
pMatrix2	= word ptr -0D6h
var_D4		= byte ptr -0D4h
var_BC		= byte ptr -0BCh
var_A4		= word ptr -0A4h
var_A2		= word ptr -0A2h
pMatrix		= byte ptr -0A0h
var_8E		= byte ptr -8Eh
var_86		= byte ptr -86h
var_6E		= byte ptr -6Eh
var_6C		= word ptr -6Ch
rc1		= Rectangle ptr	-6Ah
cTrackTile	= byte ptr -62h
var_60		= byte ptr -60h
var_5E		= word ptr -5Eh
wAngle3		= word ptr -5Ch
wAngleZ		= word ptr -5Ah
vec4		= Vector3D ptr -58h
var_52		= word ptr -52h
pUnk46		= word ptr -50h
var_4E		= byte ptr -4Eh
var_4C		= byte ptr -4Ch
var_4A		= byte ptr -4Ah
var_48		= word ptr -48h
wAngleY		= word ptr -46h
vec5		= Vector3D ptr -44h
pRects		= word ptr -3Eh
var_3C		= byte ptr -3Ch
var_3A		= word ptr -3Ah
var_38		= word ptr -38h
var_36		= word ptr -36h
pSceneItem2	= word ptr -34h
var_32		= byte ptr -32h
var_1A		= byte ptr -1Ah
var_2		= word ptr -2
arg_0		= byte ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 154h
		push	di
		push	si
		mov	[bp+var_DC], 0
		mov	[bp+var_DB], 0
		cmp	g_wVideoFlag4, 0
		jz	short loc_9F1_212
		cmp	[bp+arg_0], 0
		jz	short loc_9F1_212
		mov	g_prcMegaPoly2,	offset g_arrRcMegapoly
		mov	g_prcMegaPoly1,	offset g_arrRcMegapol2
		jmp	short loc_9F1_21E
; ---------------------------------------------------------------------------

loc_9F1_212:				; CODE XREF: UpdateFrame+18j
					; UpdateFrame+1Ej
		mov	g_prcMegaPoly1,	offset g_arrRcMegapoly
		mov	g_prcMegaPoly2,	offset g_arrRcMegapol2

loc_9F1_21E:				; CODE XREF: UpdateFrame+2Cj
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_252
		mov	[bp+var_122], 8
		mov	[bp+pRects], offset g_rcIntro

loc_9F1_22F:
		sub	si, si
		jmp	short loc_9F1_235
; ---------------------------------------------------------------------------
		nop

loc_9F1_234:				; CODE XREF: UpdateFrame+6Cj
		inc	si

loc_9F1_235:				; CODE XREF: UpdateFrame+4Dj
		cmp	si, 0Fh
		jge	short loc_9F1_257
		mov	ax, [bp+pRects]
		add	[bp+pRects], 8
		push	si
		push	di
		mov	di, ax
		mov	si, offset g_rc1
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		jmp	short loc_9F1_234
; ---------------------------------------------------------------------------

loc_9F1_252:				; CODE XREF: UpdateFrame+3Fj
		mov	[bp+var_122], 0

loc_9F1_257:				; CODE XREF: UpdateFrame+54j
		cmp	byte_2B77_AC70,	0
		jnz	short loc_9F1_2AE
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_267:				; CODE XREF: UpdateFrame+89j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_267 ; loop 6 times


		mov	[bp+vec1.wX], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_27C:				; CODE XREF: UpdateFrame+9Ej
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_27C ; loop 6 times


		mov	[bp+vec1.wY], ax
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_291:				; CODE XREF: UpdateFrame+B3j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_291 ; loop 6 times


		mov	[bp+vec1.wZ], ax
		mov	ax, gameState.carPlayer.vecRotate.wY
		mov	[bp+wAngleY], ax
		mov	ax, gameState.carPlayer.vecRotate.wZ
		mov	[bp+wAngleZ], ax
		mov	ax, gameState.carPlayer.vecRotate.wX
		jmp	short loc_9F1_2FC
; ---------------------------------------------------------------------------

loc_9F1_2AE:				; CODE XREF: UpdateFrame+78j
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_2B7:				; CODE XREF: UpdateFrame+D9j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_2B7 ; loop 6 times


		mov	[bp+vec1.wX], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_2CC:				; CODE XREF: UpdateFrame+EEj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_2CC ; loop 6 times


		mov	[bp+vec1.wY], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_2E1:				; CODE XREF: UpdateFrame+103j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_2E1 ; loop 6 times


		mov	[bp+vec1.wZ], ax
		mov	ax, gameState.carOpponent.vecRotate.wY
		mov	[bp+wAngleY], ax
		mov	ax, gameState.carOpponent.vecRotate.wZ
		mov	[bp+wAngleZ], ax
		mov	ax, gameState.carOpponent.vecRotate.wX

loc_9F1_2FC:				; CODE XREF: UpdateFrame+C8j
		mov	[bp+wAngleX], ax
		mov	[bp+wAngle3], 0FFFFh
		mov	[bp+var_E0], 0
		mov	al, g_cCameraMode
		cbw
		or	ax, ax
		jnz	short loc_9F1_316
		jmp	_lblCamera0
; ---------------------------------------------------------------------------

loc_9F1_316:				; CODE XREF: UpdateFrame+12Dj
		cmp	ax, 1
		jnz	short loc_9F1_31E
		jmp	_lblCamera1
; ---------------------------------------------------------------------------

loc_9F1_31E:				; CODE XREF: UpdateFrame+135j
		cmp	ax, 2
		jz	short _lblCamera2
		cmp	ax, 3
		jnz	short loc_9F1_32B
		jmp	_lblCamera3
; ---------------------------------------------------------------------------

loc_9F1_32B:				; CODE XREF: UpdateFrame+142j
		jmp	loc_9F1_3F3
; ---------------------------------------------------------------------------

_lblCamera2:				; CODE XREF: UpdateFrame+13Dj
		mov	[bp+vec2.wX], 0
		mov	[bp+vec2.wY], 0
		mov	[bp+vec2.wZ], 4000h
		sub	ax, ax
		push	ax
		mov	ax, [bp+wAngleX]
		neg	ax
		push	ax
		mov	ax, [bp+wAngleY]
		neg	ax
		push	ax
		mov	ax, [bp+wAngleZ]
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix2], ax
		lea	ax, [bp+vec3]
		push	ax
		push	[bp+pMatrix2]
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	[bp+vec3.wZ]
		push	[bp+vec3.wX]
		call	GetAngleFromXZ
		add	sp, 4
		mov	si, ax
		mov	[bp+vec2.wX], 0
		mov	[bp+vec2.wY], 0
		mov	ax, word_2B77_17C
		mov	[bp+vec2.wZ], ax
		sub	ax, ax
		push	ax
		mov	ax, si
		sub	ax, word_2B77_17E
		push	ax
		mov	ax, word_2B77_180
		neg	ax
		push	ax
		sub	ax, ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix2], ax

loc_9F1_3BC:				; CODE XREF: UpdateFrame+396j
		lea	ax, [bp+vec3]
		push	ax
		push	[bp+pMatrix2]
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec1.wX]
		add	ax, [bp+vec3.wX]
		mov	[bp+vec4.wX], ax
		mov	ax, [bp+vec1.wY]
		add	ax, [bp+vec3.wY]
		mov	[bp+vec4.wY], ax
		mov	ax, [bp+vec1.wZ]
		add	ax, [bp+vec3.wZ]

loc_9F1_3F0:				; CODE XREF: UpdateFrame+3D9j
		mov	[bp+vec4.wZ], ax

loc_9F1_3F3:				; CODE XREF: UpdateFrame:loc_9F1_32Bj
					; UpdateFrame+33Dj
		cmp	[bp+wAngle3], 0FFFFh
		jz	short loc_9F1_3FC
		jmp	loc_9F1_4D9
; ---------------------------------------------------------------------------

loc_9F1_3FC:				; CODE XREF: UpdateFrame+213j
		lea	ax, [bp+vec4]
		push	ax
		lea	ax, [bp+vec4]
		push	ax
		call	TrkTerrainWall	; updates g_wSomeXXX, and g_wPlanIndex?
		add	sp, 4
		mov	ax, g_dwSomeY
		cmp	[bp+vec4.wY], ax
		jge	short loc_9F1_417
		mov	[bp+vec4.wY], ax

loc_9F1_417:				; CODE XREF: UpdateFrame+22Ej
		cmp	byte_2B77_81BC,	0
		jz	short loc_9F1_483
		push	[bp+vec4.wZ]
		push	[bp+vec4.wY]
		push	[bp+vec4.wX]
		push	g_wPlanIndex
		call	PlaneOriginOp	; uses g_wSomeXXX
		add	sp, 8
		mov	si, ax
		cmp	si, 0Ch
		jge	short loc_9F1_483
		mov	vec_2B77_97C6.wX, 0
		mov	ax, 0Ch
		sub	ax, si
		mov	vec_2B77_97C6.wY, ax
		mov	vec_2B77_97C6.wZ, 0
		mov	ax, g_wPlanIndex
		mov	g_wSomePlanIndex, ax
		mov	g_wSomePi3Code,	0
		mov	g_wSomeAngleXY,	0
		mov	g_wSomeAngleYZ,	0
		mov	word_2B77_97D6,	0
		call	PlaneRotateOp
		mov	ax, g_vecPlaneRotOpResul.wX
		add	[bp+vec4.wX], ax
		mov	ax, g_vecPlaneRotOpResul.wY
		add	[bp+vec4.wY], ax
		mov	ax, g_vecPlaneRotOpResul.wZ
		add	[bp+vec4.wZ], ax

loc_9F1_483:				; CODE XREF: UpdateFrame+238j
					; UpdateFrame+254j
		mov	ax, [bp+vec1.wZ]
		sub	ax, [bp+vec4.wZ]
		push	ax
		mov	ax, [bp+vec1.wX]
		sub	ax, [bp+vec4.wX]
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		neg	ax
		and	ah, 3
		mov	[bp+wAngle3], ax
		mov	ax, [bp+vec1.wZ]
		sub	ax, [bp+vec4.wZ]
		push	ax
		mov	ax, [bp+vec1.wX]
		sub	ax, [bp+vec4.wX]
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_38], ax
		push	ax
		mov	ax, [bp+vec1.wY]
		sub	ax, [bp+vec4.wY]
		add	ax, 32h	; '2'
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		and	ah, 3
		mov	[bp+wAngle2], ax

loc_9F1_4D9:				; CODE XREF: UpdateFrame+215j
		cmp	[bp+var_E0], 1
		jg	short loc_9F1_4E3
		jmp	loc_9F1_5C0
; ---------------------------------------------------------------------------

loc_9F1_4E3:				; CODE XREF: UpdateFrame+2FAj
		cmp	[bp+var_E0], 3FFh
		jl	short loc_9F1_4EE
		jmp	loc_9F1_5C0
; ---------------------------------------------------------------------------

loc_9F1_4EE:				; CODE XREF: UpdateFrame+305j
		mov	ax, [bp+var_E0]
		mov	[bp+wAngle1], ax
		jmp	loc_9F1_5C6
; ---------------------------------------------------------------------------
		nop

_lblCamera1:				; CODE XREF: UpdateFrame+137j
		mov	al, byte_2B77_AC70
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	ax, gameState.vec1.wX[bx]
		mov	[bp+vec4.wX], ax
		mov	ax, gameState.vec1.wZ[bx]
		mov	[bp+vec4.wZ], ax
		mov	ax, gameState.vec1.wY[bx]
		mov	[bp+vec4.wY], ax
		jmp	loc_9F1_3F3
; ---------------------------------------------------------------------------

_lblCamera0:				; CODE XREF: UpdateFrame+12Fj
		mov	ax, [bp+wAngleX]
		and	ah, 3
		mov	[bp+wAngle3], ax
		mov	ax, [bp+wAngleY]
		and	ah, 3
		mov	[bp+wAngle2], ax
		mov	ax, [bp+wAngleZ]
		and	ah, 3
		mov	[bp+var_E0], ax
		sub	ax, ax
		push	ax
		mov	ax, [bp+wAngleX]
		neg	ax
		push	ax
		mov	ax, [bp+wAngleY]
		neg	ax
		push	ax
		mov	ax, [bp+wAngleZ]
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix2], ax
		mov	[bp+vec2.wX], 0
		mov	[bp+vec2.wZ], 0
		mov	ax, g_dwCopyOfSimd.dwCarHeight
		sub	ax, 6
		mov	[bp+vec2.wY], ax
		jmp	loc_9F1_3BC
; ---------------------------------------------------------------------------
		nop

_lblCamera3:				; CODE XREF: UpdateFrame+144j
		mov	al, byte_2B77_AC70
		cbw
		mov	bx, ax
		mov	al, gameState.cCvxFlag4[bx]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_pTrakdata9
		mov	dx, word ptr g_pTrakdata9+2
		mov	word ptr [bp+pVec], ax ; ptr? .. ->
		mov	word ptr [bp+pVec+2], dx
		les	bx, [bp+pVec]	; ptr?
		assume es:nothing
		mov	ax, es:[bx+Vector3D.wX]
		mov	[bp+vec4.wX], ax
		mov	ax, es:[bx+Vector3D.wY]
		add	ax, word_2B77_95B0
		add	ax, 5Ah		; 90
		mov	[bp+vec4.wY], ax
		mov	ax, es:[bx+Vector3D.wZ]
		jmp	loc_9F1_3F0
; ---------------------------------------------------------------------------

loc_9F1_5C0:				; CODE XREF: UpdateFrame+2FCj
					; UpdateFrame+307j
		mov	[bp+wAngle1], 0

loc_9F1_5C6:				; CODE XREF: UpdateFrame+312j
		cmp	gameState.wGameFrame, 0
		jnz	short loc_9F1_5D4
		mov	bx, word_2B77_ACF8 ; hvis field_140 er null, brukes acf8 istedet
		jmp	short loc_9F1_5D8
; ---------------------------------------------------------------------------
		nop

loc_9F1_5D4:				; CODE XREF: UpdateFrame+3E7j
		mov	bx, gameState.wGameFrame

loc_9F1_5D8:				; CODE XREF: UpdateFrame+3EDj
		and	bx, 0Fh
		mov	al, byte_2B77_956[bx] ;	lookup of field_140 and	f
		mov	[bp+cMaterial],	al
		sub	ax, ax
		push	ax
		push	[bp+arg_2]
		push	[bp+wAngle3]
		push	[bp+wAngle2]
		push	[bp+wAngle1]
		call	SelectRectRotate
		add	sp, 0Ah
		mov	[bp+var_52], ax
		and	ah, 3
		mov	cl, 7
		shr	ax, cl
		mov	si, ax
		mov	bx, si
		shl	bx, 1
		mov	ax, g_pUnk46Table[bx]
		mov	[bp+pUnk46], ax
		mov	ax, 1
		push	ax
		sub	ax, ax
		push	ax
		push	[bp+wAngle2]
		push	[bp+wAngle1]
		call	MatRotateZXY
		add	sp, 8
		push	si
		push	di
		lea	di, [bp+pMatrix3]
		mov	si, ax
		push	ss
		pop	es
		mov	cx, 9
		repne movsw		; copy matrix
		pop	di
		pop	si
		mov	[bp+vec2.wX], 0
		mov	[bp+vec2.wY], 0
		mov	[bp+vec2.wZ], 3E8h ; 1000
		lea	ax, [bp+vec5]
		push	ax
		lea	ax, [bp+pMatrix3]
		push	ax
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec5.wZ], 0
		jle	short loc_9F1_670
		mov	[bp+var_2], 1
		jmp	short loc_9F1_675
; ---------------------------------------------------------------------------

loc_9F1_670:				; CODE XREF: UpdateFrame+483j
		mov	[bp+var_2], 0FFFFh

loc_9F1_675:				; CODE XREF: UpdateFrame+48Aj
		cmp	g_wTimerFlag3, 0
		jz	short loc_9F1_67F
		jmp	loc_9F1_75D
; ---------------------------------------------------------------------------

loc_9F1_67F:				; CODE XREF: UpdateFrame+496j
		mov	g_transshp1.pRect, offset stru_2B77_92CC
		mov	al, [bp+var_122]
		or	al, 7
		mov	g_transshp1.cFlags, al
		mov	g_transshp1.vecRot.wX, 0
		mov	g_transshp1.vecRot.wY, 0
		mov	g_transshp1.field_10, 400h
		mov	g_transshp1.cMaterial, 0
		mov	[bp+var_36], 0

loc_9F1_6AA:				; CODE XREF: UpdateFrame+576j
		mov	bx, [bp+var_36]
		shl	bx, 1
		mov	si, word_2B77_6C4[bx]
		add	si, [bp+wAngle3]
		add	si, g_wKevinRandom
		and	si, 3FFh
		cmp	si, 87h	; '‡'
		jl	short loc_9F1_6CD
		cmp	si, 379h
		jg	short loc_9F1_6CD
		jmp	loc_9F1_751
; ---------------------------------------------------------------------------

loc_9F1_6CD:				; CODE XREF: UpdateFrame+4DEj
					; UpdateFrame+4E4j
		push	si
		lea	ax, [bp+pMatrix]
		push	ax
		call	MatRotateY
		add	sp, 4
		mov	[bp+vec2.wX], 0
		mov	ax, 0AE6h	; 2790 .. ?
		sub	ax, [bp+vec4.wY]
		mov	[bp+vec2.wY], ax
		mov	[bp+vec2.wZ], 3A98h ; 15000
		lea	ax, [bp+vec3]
		push	ax
		lea	ax, [bp+pMatrix]
		push	ax
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	[bp+vec3.wZ], 3A98h ; 15000
		mov	ax, offset g_transshp1
		push	ax
		lea	ax, [bp+pMatrix3]
		push	ax
		lea	ax, [bp+vec3]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	g_transshp1.vecPos.wZ, 0C8h
		jle	short loc_9F1_751
		mov	bx, [bp+var_36]
		shl	bx, 1
		mov	ax, g_arr8GameShapes[bx]
		mov	g_transshp1.pShape3D, ax
		mov	ax, [bp+wAngle3]
		neg	ax
		mov	g_transshp1.vecRot.wZ, ax
		mov	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax

loc_9F1_751:				; CODE XREF: UpdateFrame+4E6j
					; UpdateFrame+546j
		inc	[bp+var_36]
		cmp	[bp+var_36], 8
		jge	short loc_9F1_75D
		jmp	loc_9F1_6AA
; ---------------------------------------------------------------------------

loc_9F1_75D:				; CODE XREF: UpdateFrame+498j
					; UpdateFrame+574j
		mov	ax, [bp+vec4.wX]
		mov	cl, 0Ah
		sar	ax, cl
		mov	[bp+var_10A], al
		mov	ax, [bp+vec4.wZ]
		sar	ax, cl
		sub	al, 1Dh
		neg	al
		mov	[bp+var_134], al
		cmp	g_wTimerFlag3, 0
		jz	short loc_9F1_78D
		mov	al, byte ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	[bp+var_D8], al
		mov	al, 1Dh
		sub	al, byte ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	[bp+var_E2], al

loc_9F1_78D:				; CODE XREF: UpdateFrame+596j
		sub	si, si

loc_9F1_78F:				; CODE XREF: UpdateFrame+5B3j
		mov	[bp+si+var_32],	0
		inc	si
		cmp	si, 17h
		jl	short loc_9F1_78F
		mov	bl, g_wTimerFlag3
		sub	bh, bh
		mov	al, byte ptr unk_2B77_92C[bx]
		mov	[bp+var_130], al
		mov	si, 16h
		jmp	short loc_9F1_7EF
; ---------------------------------------------------------------------------

loc_9F1_7AC:				; CODE XREF: UpdateFrame+62Cj
		mov	ax, [bp+pUnk46]
		mov	cx, si
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		add	ax, cx
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		mov	al, [bx]
		add	al, [bp+var_10A]
		mov	[bp+var_F6], al
		mov	al, [bx+1]
		add	al, [bp+var_134]
		mov	[bp+var_102], al
		cmp	[bp+var_F6], 0
		jl	short loc_9F1_7EA
		cmp	[bp+var_F6], 1Dh
		jg	short loc_9F1_7EA
		or	al, al
		jl	short loc_9F1_7EA
		cmp	al, 1Dh
		jle	short loc_9F1_814

loc_9F1_7EA:				; CODE XREF: UpdateFrame+5F5j
					; UpdateFrame+5FCj ...
		mov	[bp+si+var_32],	2

loc_9F1_7EE:				; CODE XREF: UpdateFrame+616j
					; UpdateFrame+780j ...
		dec	si

loc_9F1_7EF:				; CODE XREF: UpdateFrame+5C6j
		or	si, si
		jge	short loc_9F1_7F6
		jmp	loc_9F1_AB8
; ---------------------------------------------------------------------------

loc_9F1_7F6:				; CODE XREF: UpdateFrame+60Dj
		cmp	[bp+si+var_32],	0
		jnz	short loc_9F1_7EE
		mov	bx, [bp+pUnk46]
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	bx, ax
		mov	al, [bp+var_130]
		cmp	[bx+2],	al
		jle	short loc_9F1_7AC
		jmp	short loc_9F1_7EA
; ---------------------------------------------------------------------------

loc_9F1_814:				; CODE XREF: UpdateFrame+604j
		mov	al, [bp+var_F6]
		cbw
		mov	word ptr [bp+pVec], ax
		mov	al, [bp+var_102]
		cbw
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, word ptr [bp+pVec]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+cTrackTile], al
		mov	bx, [bp+var_150]
		mov	bx, g_wTerrainRows[bx]
		add	bx, word ptr [bp+pVec]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+cTerrainTile], al
		cmp	[bp+cTrackTile], 0
		jnz	short loc_9F1_864
		jmp	loc_9F1_8EF
; ---------------------------------------------------------------------------

loc_9F1_864:				; CODE XREF: UpdateFrame+67Bj
		cmp	al, 7
		jb	short loc_9F1_887
		cmp	al, 0Bh
		jnb	short loc_9F1_887
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		push	ax
		mov	al, [bp+cTerrainTile]
		push	ax
		call	MapTerrainTrack
		add	sp, 4
		mov	[bp+cTrackTile], al
		mov	[bp+cTerrainTile], 0

loc_9F1_887:				; CODE XREF: UpdateFrame+682j
					; UpdateFrame+686j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 0FDh ; 'ý'
		jz	short loc_9F1_8A0
		cmp	ax, 0FEh ; 'þ'
		jz	short loc_9F1_8A4
		cmp	ax, 0FFh
		jnz	short loc_9F1_89E
		jmp	loc_9F1_9BA
; ---------------------------------------------------------------------------

loc_9F1_89E:				; CODE XREF: UpdateFrame+6B5j
		jmp	short loc_9F1_8EF
; ---------------------------------------------------------------------------

loc_9F1_8A0:				; CODE XREF: UpdateFrame+6ABj
		dec	[bp+var_F6]

loc_9F1_8A4:				; CODE XREF: UpdateFrame+6B0j
		dec	[bp+var_102]

loc_9F1_8A8:				; CODE XREF: UpdateFrame+7DAj
		mov	al, [bp+var_F6]
		cbw
		mov	word ptr [bp+pVec], ax
		mov	al, [bp+var_102]
		cbw
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, word ptr [bp+pVec]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+cTrackTile], al
		mov	bx, [bp+var_150]
		mov	bx, g_wTerrainRows[bx]
		add	bx, word ptr [bp+pVec]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+cTerrainTile], al

loc_9F1_8EF:				; CODE XREF: UpdateFrame+67Dj
					; UpdateFrame:loc_9F1_89Ej
		mov	al, [bp+cTerrainTile]
		mov	[bp+si+var_1A],	al
		mov	bx, [bp+pUnk46]
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	bx, ax
		mov	al, [bx+2]
		mov	[bp+si+var_BC],	al
		cmp	[bp+cTrackTile], 0
		jz	short loc_9F1_947
		cmp	g_wTimerFlag3, 0
		jz	short loc_9F1_947
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		cmp	g_sceneShapes.field_C[bx], 40h ; '@'
		jl	short loc_9F1_947
		mov	al, [bp+var_D8]
		cmp	[bp+var_F6], al
		jnz	short loc_9F1_943
		mov	al, [bp+var_E2]
		cmp	[bp+var_102], al
		jz	short loc_9F1_947

loc_9F1_943:				; CODE XREF: UpdateFrame+753j
		mov	[bp+cTrackTile], 0

loc_9F1_947:				; CODE XREF: UpdateFrame+72Aj
					; UpdateFrame+731j ...
		mov	al, [bp+var_F6]
		mov	[bp+si+var_86],	al
		mov	al, [bp+var_102]
		mov	[bp+si+var_D4],	al
		mov	al, [bp+cTrackTile]
		mov	[bp+si+var_14C], al
		cmp	[bp+cTrackTile], 0
		jnz	short loc_9F1_967
		jmp	loc_9F1_7EE
; ---------------------------------------------------------------------------

loc_9F1_967:				; CODE XREF: UpdateFrame+77Ej
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1		; this shl'ing is to multiply by 14, so we get to the desired sceneshape
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		cbw
		mov	[bp+wCounter], ax
		or	ax, ax
		jnz	short loc_9F1_988
		jmp	loc_9F1_7EE
; ---------------------------------------------------------------------------

loc_9F1_988:				; CODE XREF: UpdateFrame+79Fj
		mov	al, [bp+var_F6]
		sub	al, [bp+var_10A]
		mov	[bp+var_100], al
		mov	al, [bp+var_102]
		sub	al, [bp+var_134]
		mov	[bp+var_12C], al
		mov	ax, [bp+wCounter]
		cmp	ax, 1
		jz	short loc_9F1_9C2
		cmp	ax, 2
		jz	short loc_9F1_A04
		cmp	ax, 3
		jnz	short loc_9F1_9B6
		jmp	loc_9F1_A50
; ---------------------------------------------------------------------------

loc_9F1_9B6:				; CODE XREF: UpdateFrame+7CDj
		jmp	loc_9F1_7EE
; ---------------------------------------------------------------------------
		nop

loc_9F1_9BA:				; CODE XREF: UpdateFrame+6B7j
		dec	[bp+var_F6]
		jmp	loc_9F1_8A8
; ---------------------------------------------------------------------------
		nop

loc_9F1_9C2:				; CODE XREF: UpdateFrame+7C3j
		sub	di, di
		jmp	short loc_9F1_9C7
; ---------------------------------------------------------------------------

loc_9F1_9C6:				; CODE XREF: UpdateFrame+803j
					; UpdateFrame+818j ...
		inc	di

loc_9F1_9C7:				; CODE XREF: UpdateFrame+7E0j
		cmp	di, si
		jl	short loc_9F1_9CE
		jmp	loc_9F1_7EE
; ---------------------------------------------------------------------------

loc_9F1_9CE:				; CODE XREF: UpdateFrame+7E5j
		mov	ax, [bp+pUnk46]
		mov	cx, di
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		add	ax, cx
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		mov	al, [bp+var_100]
		cmp	[bx], al
		jnz	short loc_9F1_9C6
		mov	al, [bp+var_12C]
		cmp	[bx+1],	al
		jz	short loc_9F1_9FE
		cbw
		inc	ax
		mov	cx, ax
		mov	al, [bx+1]
		cbw
		cmp	ax, cx
		jnz	short loc_9F1_9C6

loc_9F1_9FE:				; CODE XREF: UpdateFrame+80Cj
		mov	[bp+di+var_32],	1
		jmp	short loc_9F1_9C6
; ---------------------------------------------------------------------------

loc_9F1_A04:				; CODE XREF: UpdateFrame+7C8j
		sub	di, di
		jmp	short loc_9F1_A09
; ---------------------------------------------------------------------------

loc_9F1_A08:				; CODE XREF: UpdateFrame+846j
					; UpdateFrame+863j ...
		inc	di

loc_9F1_A09:				; CODE XREF: UpdateFrame+822j
		cmp	di, si
		jl	short loc_9F1_A10
		jmp	loc_9F1_7EE
; ---------------------------------------------------------------------------

loc_9F1_A10:				; CODE XREF: UpdateFrame+827j
		mov	ax, [bp+pUnk46]
		mov	cx, di
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		add	ax, cx
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		mov	al, [bp+var_12C]
		cmp	[bx+1],	al
		jnz	short loc_9F1_A08
		mov	al, [bx]
		mov	byte ptr [bp+var_150], al
		mov	al, [bp+var_100]
		cmp	byte ptr [bp+var_150], al
		jz	short loc_9F1_A49
		cbw
		inc	ax
		mov	cx, ax
		mov	al, byte ptr [bp+var_150]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_A08

loc_9F1_A49:				; CODE XREF: UpdateFrame+856j
		mov	[bp+di+var_32],	1
		jmp	short loc_9F1_A08
; ---------------------------------------------------------------------------
		nop

loc_9F1_A50:				; CODE XREF: UpdateFrame+7CFj
		sub	di, di
		jmp	short loc_9F1_A55
; ---------------------------------------------------------------------------

loc_9F1_A54:				; CODE XREF: UpdateFrame+8A0j
					; UpdateFrame+8CBj ...
		inc	di

loc_9F1_A55:				; CODE XREF: UpdateFrame+86Ej
		cmp	di, si
		jl	short loc_9F1_A5C
		jmp	loc_9F1_7EE
; ---------------------------------------------------------------------------

loc_9F1_A5C:				; CODE XREF: UpdateFrame+873j
		mov	bx, [bp+pUnk46]
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	bx, ax
		mov	al, [bx]
		mov	byte ptr [bp+pVec], al
		mov	al, [bp+var_100]
		cmp	byte ptr [bp+pVec], al
		jz	short loc_9F1_A86
		cbw
		inc	ax
		mov	cx, ax
		mov	al, byte ptr [bp+pVec]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_A54

loc_9F1_A86:				; CODE XREF: UpdateFrame+893j
		mov	bx, [bp+pUnk46]
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	bx, ax
		mov	al, [bx+1]
		mov	byte ptr [bp+pVec], al
		mov	al, [bp+var_12C]
		cmp	byte ptr [bp+pVec], al
		jz	short loc_9F1_AB1
		cbw
		inc	ax
		mov	cx, ax
		mov	al, byte ptr [bp+pVec]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_A54

loc_9F1_AB1:				; CODE XREF: UpdateFrame+8BEj
		mov	[bp+di+var_32],	1
		jmp	short loc_9F1_A54
; ---------------------------------------------------------------------------
		nop

loc_9F1_AB8:				; CODE XREF: UpdateFrame+60Fj
		mov	[bp+var_3C], 0FFh
		mov	[bp+var_6C], 0
		cmp	g_cCameraMode, 0
		jnz	short loc_9F1_AD2
		cmp	byte_2B77_AC70,	0
		jnz	short loc_9F1_AD2
		jmp	loc_9F1_C55
; ---------------------------------------------------------------------------

loc_9F1_AD2:				; CODE XREF: UpdateFrame+8E2j
					; UpdateFrame+8E9j
		cmp	gameState.carPlayer.field_C9, 2
		jnz	short loc_9F1_ADC
		jmp	loc_9F1_C55
; ---------------------------------------------------------------------------

loc_9F1_ADC:				; CODE XREF: UpdateFrame+8F3j
		sub	ax, ax
		push	ax
		mov	ax, gameState.carPlayer.vecRotate.wX
		neg	ax
		push	ax
		mov	ax, gameState.carPlayer.vecRotate.wY
		neg	ax
		push	ax
		mov	ax, gameState.carPlayer.vecRotate.wZ
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix2], ax
		mov	[bp+wCounter], 0FFFFh
		mov	di, 0FFFFh
		mov	[bp+var_A2], 0
		jmp	short loc_9F1_B7C
; ---------------------------------------------------------------------------

loc_9F1_B0E:				; CODE XREF: UpdateFrame+935j
					; UpdateFrame+961j ...
		dec	si

loc_9F1_B0F:				; CODE XREF: UpdateFrame+9FCj
		cmp	[bp+wCounter], si
		jge	short loc_9F1_B78
		cmp	[bp+si+var_32],	2
		jz	short loc_9F1_B0E
		mov	ax, [bp+pUnk46]
		mov	cx, si
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		add	ax, cx
		mov	word ptr [bp+pVec], ax
		mov	al, [bp+var_10A]
		cbw
		mov	bx, word ptr [bp+pVec]
		mov	cx, ax
		mov	al, [bx]
		cbw
		add	ax, cx
		mov	cx, ax
		mov	al, [bp+var_F6]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_B0E
		mov	al, [bp+var_134]
		cbw
		mov	cx, ax
		mov	al, [bx+1]
		cbw
		add	ax, cx
		mov	cx, ax
		mov	al, [bp+var_102]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_B0E
		mov	al, [bp+var_F6]
		mov	[bp+var_3C], al
		mov	al, [bp+var_102]
		mov	[bp+var_60], al
		mov	[bp+wCounter], si
		mov	di, [bp+var_A2]
		jmp	short loc_9F1_B0E
; ---------------------------------------------------------------------------
		nop

loc_9F1_B78:				; CODE XREF: UpdateFrame+92Fj
		inc	[bp+var_A2]

loc_9F1_B7C:				; CODE XREF: UpdateFrame+928j
		cmp	[bp+var_A2], 4
		jge	short loc_9F1_BE4
		mov	bx, [bp+var_A2]
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		push	si
		push	di
		lea	di, [bp+vec2]
		lea	si, g_dwCopyOfSimd.vecWheelCoords.wX[bx]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		lea	ax, [bp+vec5]
		push	ax
		push	[bp+pMatrix2]
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec5.wX]
		cwd
		add	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		adc	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	ax, dx
		mov	[bp+var_F6], al
		mov	ax, [bp+vec5.wZ]
		cwd
		add	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		adc	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	ax, dx
		sub	al, 1Dh
		neg	al
		mov	[bp+var_102], al
		mov	si, 16h
		jmp	loc_9F1_B0F
; ---------------------------------------------------------------------------
		nop

loc_9F1_BE4:				; CODE XREF: UpdateFrame+99Dj
		cmp	di, 0FFFFh
		jz	short loc_9F1_C55
		cmp	gameState.carPlayer.cSurfaceGripIndex1,	4
		jnz	short loc_9F1_C05
		cmp	gameState.carPlayer.cSurfaceGripIndex2,	4
		jnz	short loc_9F1_C05
		cmp	gameState.carPlayer.cSurfaceGripIndex3,	4
		jnz	short loc_9F1_C05
		cmp	gameState.carPlayer.cSurfaceGripIndex4,	4
		jz	short loc_9F1_C55

loc_9F1_C05:				; CODE XREF: UpdateFrame+A0Aj
					; UpdateFrame+A11j ...
		mov	[bp+vec2.wX], 0
		mov	[bp+vec2.wZ], 0
		mov	[bp+vec2.wY], 7530h
		lea	ax, [bp+vec5]
		push	ax
		push	[bp+pMatrix2]
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		lea	ax, [bp+vec2]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		lea	ax, [bp+vec5]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec2.wZ], 0
		jg	short loc_9F1_C50
		mov	[bp+var_6C], 0F800h
		jmp	short loc_9F1_C55
; ---------------------------------------------------------------------------
		nop

loc_9F1_C50:				; CODE XREF: UpdateFrame+A62j
		mov	[bp+var_6C], 800h

loc_9F1_C55:				; CODE XREF: UpdateFrame+8EBj
					; UpdateFrame+8F5j ...
		mov	[bp+var_4A], 0FFh
		mov	[bp+var_A4], 0
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_9F1_C69
		jmp	loc_9F1_DFE
; ---------------------------------------------------------------------------

loc_9F1_C69:				; CODE XREF: UpdateFrame+A80j
		cmp	g_cCameraMode, 0
		jnz	short loc_9F1_C7A
		cmp	byte_2B77_AC70,	0
		jz	short loc_9F1_C7A
		jmp	loc_9F1_DFE
; ---------------------------------------------------------------------------

loc_9F1_C7A:				; CODE XREF: UpdateFrame+A8Aj
					; UpdateFrame+A91j
		cmp	gameState.carOpponent.field_C9,	2
		jnz	short loc_9F1_C84
		jmp	loc_9F1_DFE
; ---------------------------------------------------------------------------

loc_9F1_C84:				; CODE XREF: UpdateFrame+A9Bj
		sub	ax, ax
		push	ax
		mov	ax, gameState.carOpponent.vecRotate.wX
		neg	ax
		push	ax
		mov	ax, gameState.carOpponent.vecRotate.wY
		neg	ax
		push	ax
		mov	ax, gameState.carOpponent.vecRotate.wZ
		neg	ax
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix2], ax
		mov	[bp+wCounter], 0FFFFh
		mov	di, 0FFFFh
		mov	[bp+var_A2], 0
		jmp	short loc_9F1_D24
; ---------------------------------------------------------------------------

loc_9F1_CB6:				; CODE XREF: UpdateFrame+ADDj
					; UpdateFrame+B09j ...
		dec	si

loc_9F1_CB7:				; CODE XREF: UpdateFrame+BA4j
		cmp	[bp+wCounter], si
		jge	short loc_9F1_D20
		cmp	[bp+si+var_32],	2
		jz	short loc_9F1_CB6
		mov	ax, [bp+pUnk46]
		mov	cx, si
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		add	ax, cx
		mov	word ptr [bp+pVec], ax
		mov	al, [bp+var_10A]
		cbw
		mov	bx, word ptr [bp+pVec]
		mov	cx, ax
		mov	al, [bx]
		cbw
		add	ax, cx
		mov	cx, ax
		mov	al, [bp+var_F6]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_CB6
		mov	al, [bp+var_134]
		cbw
		mov	cx, ax
		mov	al, [bx+1]
		cbw
		add	ax, cx
		mov	cx, ax
		mov	al, [bp+var_102]
		cbw
		cmp	cx, ax
		jnz	short loc_9F1_CB6
		mov	al, [bp+var_F6]
		mov	[bp+var_4A], al
		mov	al, [bp+var_102]
		mov	[bp+var_6E], al
		mov	[bp+wCounter], si
		mov	di, [bp+var_A2]
		jmp	short loc_9F1_CB6
; ---------------------------------------------------------------------------
		nop

loc_9F1_D20:				; CODE XREF: UpdateFrame+AD7j
		inc	[bp+var_A2]

loc_9F1_D24:				; CODE XREF: UpdateFrame+AD0j
		cmp	[bp+var_A2], 4
		jge	short loc_9F1_D8C
		mov	bx, [bp+var_A2]
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		push	si
		push	di
		lea	di, [bp+vec2]
		lea	si, g_pCarInfoSimd2.vecWheelCoords.wX[bx]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		lea	ax, [bp+vec5]
		push	ax
		push	[bp+pMatrix2]
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec5.wX]
		cwd
		add	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		adc	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	ax, dx
		mov	[bp+var_F6], al
		mov	ax, [bp+vec5.wZ]
		cwd
		add	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		adc	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	ax, dx
		sub	al, 1Dh
		neg	al
		mov	[bp+var_102], al
		mov	si, 16h
		jmp	loc_9F1_CB7
; ---------------------------------------------------------------------------
		nop

loc_9F1_D8C:				; CODE XREF: UpdateFrame+B45j
		cmp	di, 0FFFFh
		jz	short loc_9F1_DFE
		cmp	gameState.carOpponent.cSurfaceGripIndex1, 4
		jnz	short loc_9F1_DAD
		cmp	gameState.carOpponent.cSurfaceGripIndex2, 4
		jnz	short loc_9F1_DAD
		cmp	gameState.carOpponent.cSurfaceGripIndex3, 4
		jnz	short loc_9F1_DAD
		cmp	gameState.carOpponent.cSurfaceGripIndex4, 4
		jz	short loc_9F1_DFE

loc_9F1_DAD:				; CODE XREF: UpdateFrame+BB2j
					; UpdateFrame+BB9j ...
		mov	[bp+vec2.wX], 0
		mov	[bp+vec2.wZ], 0
		mov	[bp+vec2.wY], 7530h
		lea	ax, [bp+vec5]
		push	ax
		push	[bp+pMatrix2]
		lea	ax, [bp+vec2]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		lea	ax, [bp+vec2]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		lea	ax, [bp+vec5]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec2.wZ], 0
		jg	short loc_9F1_DF8
		mov	[bp+var_A4], 0F800h
		jmp	short loc_9F1_DFE
; ---------------------------------------------------------------------------

loc_9F1_DF8:				; CODE XREF: UpdateFrame+C0Aj
		mov	[bp+var_A4], 800h

loc_9F1_DFE:				; CODE XREF: UpdateFrame+A82j
					; UpdateFrame+A93j ...
		mov	[bp+var_4E], 0
		sub	si, si
		jmp	loc_9F1_205D
; ---------------------------------------------------------------------------
		nop

loc_9F1_E08:				; CODE XREF: UpdateFrame+1EDEj
		mov	[bp+var_36], 1
		mov	[bp+var_10E], 97Eh
		jmp	short loc_9F1_E45
; ---------------------------------------------------------------------------
		nop

loc_9F1_E16:				; CODE XREF: UpdateFrame+1EE6j
		mov	[bp+var_36], 2
		mov	[bp+var_10E], 980h
		jmp	short loc_9F1_E45
; ---------------------------------------------------------------------------
		nop

loc_9F1_E24:				; CODE XREF: UpdateFrame+1EEEj
		mov	[bp+var_36], 3
		jmp	short loc_9F1_E3F
; ---------------------------------------------------------------------------
		nop

loc_9F1_E2C:				; CODE XREF: UpdateFrame+1EF6j
		mov	[bp+var_36], 4
		mov	[bp+var_10E], 988h
		jmp	short loc_9F1_E45
; ---------------------------------------------------------------------------
		nop

loc_9F1_E3A:				; CODE XREF: UpdateFrame+1EB9j
		mov	[bp+var_36], 1

loc_9F1_E3F:				; CODE XREF: UpdateFrame+C45j
		mov	[bp+var_10E], 984h

loc_9F1_E45:				; CODE XREF: UpdateFrame+C2Fj
					; UpdateFrame+C3Dj ...
		mov	[bp+wCounter], 0
		jmp	loc_9F1_F6A
; ---------------------------------------------------------------------------

loc_9F1_E4E:				; CODE XREF: UpdateFrame+DBBj
					; UpdateFrame+DD2j
		mov	al, [bp+var_100]
		cbw
		or	ax, ax
		jz	short loc_9F1_E70
		cmp	ax, 1Dh
		jz	short loc_9F1_EBC
		mov	al, [bp+var_12C]
		cbw
		or	ax, ax
		jz	short loc_9F1_EDC
		cmp	ax, 1Dh
		jz	short loc_9F1_EE0
		mov	di, 0FFFFh
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_E70:				; CODE XREF: UpdateFrame+C71j
		mov	al, [bp+var_12C]
		cbw
		or	ax, ax
		jz	short loc_9F1_E84
		cmp	ax, 1Dh
		jz	short loc_9F1_EB6
		mov	di, 6
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_E84:				; CODE XREF: UpdateFrame+C93j
		mov	di, 7

loc_9F1_E87:				; CODE XREF: UpdateFrame+C89j
					; UpdateFrame+C9Dj ...
		cmp	di, 0FFFFh
		jnz	short loc_9F1_E8F
		jmp	loc_9F1_F66
; ---------------------------------------------------------------------------

loc_9F1_E8F:				; CODE XREF: UpdateFrame+CA6j
		mov	al, byte ptr unk_2B77_976[di] ;	indices	to corner shapes?
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneItem2], ax
		cmp	[bp+var_FC], 0
		jnz	short loc_9F1_EE6
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.pShape3D]
		jmp	short loc_9F1_EEC
; ---------------------------------------------------------------------------
		nop

loc_9F1_EB6:				; CODE XREF: UpdateFrame+C98j
		mov	di, 5
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_EBC:				; CODE XREF: UpdateFrame+C76j
		mov	al, [bp+var_12C]
		cbw
		or	ax, ax
		jz	short loc_9F1_ED0
		cmp	ax, 1Dh
		jz	short loc_9F1_ED6
		mov	di, 2
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_ED0:				; CODE XREF: UpdateFrame+CDFj
		mov	di, 1
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_ED6:				; CODE XREF: UpdateFrame+CE4j
		mov	di, 3
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_EDC:				; CODE XREF: UpdateFrame+C7Fj
		sub	di, di
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------

loc_9F1_EE0:				; CODE XREF: UpdateFrame+C84j
		mov	di, 4
		jmp	short loc_9F1_E87
; ---------------------------------------------------------------------------
		nop

loc_9F1_EE6:				; CODE XREF: UpdateFrame+CC8j
		mov	bx, [bp+pSceneItem2]
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]

loc_9F1_EEC:				; CODE XREF: UpdateFrame+CCFj
		mov	g_transshp1.pShape3D, ax
		mov	al, [bp+var_100]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		sub	ax, [bp+vec4.wX]
		mov	g_transshp1.vecPos.wX, ax
		mov	ax, [bp+vec4.wY]
		neg	ax
		mov	g_transshp1.vecPos.wY, ax
		mov	al, [bp+var_12C]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		sub	ax, [bp+vec4.wZ]
		mov	g_transshp1.vecPos.wZ, ax
		mov	g_transshp1.pRect, offset g_rcIntroCopy
		mov	al, [bp+var_122]
		or	al, 5
		mov	g_transshp1.cFlags, al
		mov	g_transshp1.vecRot.wX, 0
		mov	g_transshp1.vecRot.wY, 0
		mov	bx, di
		shl	bx, 1
		mov	ax, g_wRotArray[bx]
		mov	g_transshp1.vecRot.wZ, ax
		mov	g_transshp1.field_10, 400h
		mov	g_transshp1.cMaterial, 0
		mov	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_F66
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------

loc_9F1_F66:				; CODE XREF: UpdateFrame+CA8j
					; UpdateFrame+D7Dj ...
		inc	[bp+wCounter]

loc_9F1_F6A:				; CODE XREF: UpdateFrame+C67j
		mov	ax, [bp+var_36]
		cmp	[bp+wCounter], ax
		jge	short loc_9F1_FBC
		mov	ax, [bp+wCounter]
		shl	ax, 1
		add	ax, [bp+var_10E]
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		mov	al, [bx]
		add	al, [bp+var_F6]
		mov	[bp+var_100], al
		mov	al, [bx+1]
		add	al, [bp+var_102]
		mov	[bp+var_12C], al
		cmp	g_wTimerFlag3, 0
		jnz	short loc_9F1_FA2
		jmp	loc_9F1_E4E
; ---------------------------------------------------------------------------

loc_9F1_FA2:				; CODE XREF: UpdateFrame+DB9j
		mov	al, [bp+var_D8]
		cmp	[bp+var_100], al
		jnz	short loc_9F1_F66
		mov	al, [bp+var_E2]
		cmp	[bp+var_12C], al
		jnz	short loc_9F1_FB9
		jmp	loc_9F1_E4E
; ---------------------------------------------------------------------------

loc_9F1_FB9:				; CODE XREF: UpdateFrame+DD0j
		jmp	short loc_9F1_F66
; ---------------------------------------------------------------------------
		nop

loc_9F1_FBC:				; CODE XREF: UpdateFrame+D8Dj
		cmp	[bp+cTerrainTile], 6
		jnz	short loc_9F1_1040
		mov	ax, word_2B77_17A
		mov	[bp+var_48], ax
		cmp	[bp+cTrackTile], 0
		jz	short loc_9F1_FD4

loc_9F1_FCF:				; CODE XREF: UpdateFrame+FBFj
		mov	[bp+cTerrainTile], 0

loc_9F1_FD4:				; CODE XREF: UpdateFrame+DE9j
					; UpdateFrame+E69j ...
		cmp	[bp+cTerrainTile], 0
		jnz	short loc_9F1_FDE
		jmp	loc_9F1_120C
; ---------------------------------------------------------------------------

loc_9F1_FDE:				; CODE XREF: UpdateFrame+DF5j
		mov	al, [bp+cTerrainTile]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes2 ; index 215, 0xd7 i sceneshapes-arrayen
					; tilene ligger	omtrent	der.. 215 er gjerde med	hjorne... :(
		mov	[bp+pSceneItem], ax
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	g_transshp1.pShape3D, ax
		mov	al, [bp+var_F6]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		sub	ax, [bp+vec4.wX]
		mov	g_transshp1.vecPos.wX, ax
		mov	ax, [bp+var_48]
		sub	ax, [bp+vec4.wY]
		mov	g_transshp1.vecPos.wY, ax
		mov	al, [bp+var_102]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		sub	ax, [bp+vec4.wZ]
		mov	g_transshp1.vecPos.wZ, ax
		cmp	[bp+var_48], 0
		jz	short loc_9F1_1037
		jmp	loc_9F1_11C4
; ---------------------------------------------------------------------------

loc_9F1_1037:				; CODE XREF: UpdateFrame+E4Ej
		mov	g_transshp1.pRect, offset g_rcIntroCopy
		jmp	loc_9F1_11CA
; ---------------------------------------------------------------------------

loc_9F1_1040:				; CODE XREF: UpdateFrame+DDDj
		mov	[bp+var_48], 0
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 69h
		jb	short loc_9F1_FD4
		cmp	ax, 6Ch
		jbe	short loc_9F1_1057
		jmp	loc_9F1_FD4
; ---------------------------------------------------------------------------

loc_9F1_1057:				; CODE XREF: UpdateFrame+E6Ej
		mov	[bp+wCounter], 0
		jmp	loc_9F1_119C
; ---------------------------------------------------------------------------

loc_9F1_1060:				; CODE XREF: UpdateFrame+FCAj
		mov	al, [bp+var_F6]

loc_9F1_1064:				; CODE XREF: UpdateFrame+F96j
		mov	[bp+var_100], al
		mov	al, [bp+var_102]

loc_9F1_106C:				; CODE XREF: UpdateFrame+FA8j
		mov	[bp+var_12C], al

loc_9F1_1070:				; CODE XREF: UpdateFrame+FDCj
		mov	al, [bp+var_100]
		cbw
		mov	word ptr [bp+pVec], ax
		mov	al, [bp+var_12C]
		cbw
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	bx, g_wTerrainRows[bx]
		add	bx, word ptr [bp+pVec]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+cTerrainTile], al
		or	al, al
		jnz	short loc_9F1_10A4
		jmp	loc_9F1_1198
; ---------------------------------------------------------------------------

loc_9F1_10A4:				; CODE XREF: UpdateFrame+EBBj
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes2
		mov	[bp+pSceneItem], ax
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	g_transshp1.pShape3D, ax
		mov	bx, word ptr [bp+pVec]
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		sub	ax, [bp+vec4.wX]
		mov	g_transshp1.vecPos.wX, ax
		mov	ax, [bp+vec4.wY]
		neg	ax
		mov	g_transshp1.vecPos.wY, ax
		mov	bx, [bp+var_150]
		mov	ax, word ptr g_wTrackCenPos[bx]
		sub	ax, [bp+vec4.wZ]
		mov	g_transshp1.vecPos.wZ, ax
		mov	g_transshp1.pRect, offset g_rcIntroCopy
		mov	al, [bp+var_122]
		or	al, 5
		mov	g_transshp1.cFlags, al
		mov	g_transshp1.vecRot.wX, 0
		mov	g_transshp1.vecRot.wY, 0
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	g_transshp1.vecRot.wZ, ax
		mov	g_transshp1.field_10, 400h
		mov	g_transshp1.cMaterial, 0
		mov	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_1198

loc_9F1_112C:				; CODE XREF: UpdateFrame+D7Fj
					; UpdateFrame+1025j ...
		push	[bp+vec4.wY]
		push	[bp+wAngle3]
		push	[bp+wAngle1]
		lea	ax, [bp+pMatrix3]
		push	ax
		push	[bp+var_2]
		push	[bp+arg_2]
		mov	al, [bp+arg_0]
		cbw
		push	ax
		push	cs
		call	near ptr SkyBoxOp
		add	sp, 0Eh
		mov	[bp+var_132], ax
		mov	bx, [bp+arg_2]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		call	sub_14D6_1296
		sub	si, si
		jmp	loc_9F1_21B2
; ---------------------------------------------------------------------------
		nop

loc_9F1_1174:				; CODE XREF: UpdateFrame+FD0j
		mov	al, [bp+var_F6]
		inc	al
		jmp	loc_9F1_1064
; ---------------------------------------------------------------------------
		nop

loc_9F1_117E:				; CODE XREF: UpdateFrame+FD5j
		mov	al, [bp+var_F6]

loc_9F1_1182:				; CODE XREF: UpdateFrame+FB2j
		mov	[bp+var_100], al
		mov	al, [bp+var_102]
		inc	al
		jmp	loc_9F1_106C
; ---------------------------------------------------------------------------
		nop

loc_9F1_1190:				; CODE XREF: UpdateFrame+FDAj
		mov	al, [bp+var_F6]
		inc	al
		jmp	short loc_9F1_1182
; ---------------------------------------------------------------------------

loc_9F1_1198:				; CODE XREF: UpdateFrame+EBDj
					; UpdateFrame+F46j
		inc	[bp+wCounter]

loc_9F1_119C:				; CODE XREF: UpdateFrame+E79j
		cmp	[bp+wCounter], 4
		jl	short loc_9F1_11A6
		jmp	loc_9F1_FCF
; ---------------------------------------------------------------------------

loc_9F1_11A6:				; CODE XREF: UpdateFrame+FBDj
		mov	ax, [bp+wCounter]
		or	ax, ax
		jnz	short loc_9F1_11B1
		jmp	loc_9F1_1060
; ---------------------------------------------------------------------------

loc_9F1_11B1:				; CODE XREF: UpdateFrame+FC8j
		cmp	ax, 1
		jz	short loc_9F1_1174
		cmp	ax, 2
		jz	short loc_9F1_117E
		cmp	ax, 3
		jz	short loc_9F1_1190
		jmp	loc_9F1_1070
; ---------------------------------------------------------------------------
		nop

loc_9F1_11C4:				; CODE XREF: UpdateFrame+E50j
		mov	g_transshp1.pRect, offset g_rcUnk

loc_9F1_11CA:				; CODE XREF: UpdateFrame+E59j
		mov	al, [bp+var_122]
		or	al, 5
		mov	g_transshp1.cFlags, al
		mov	g_transshp1.vecRot.wX, 0
		mov	g_transshp1.vecRot.wY, 0
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	g_transshp1.vecRot.wZ, ax
		mov	g_transshp1.field_10, 400h
		mov	g_transshp1.cMaterial, 0
		mov	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_120C
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------

loc_9F1_120C:				; CODE XREF: UpdateFrame+DF7j
					; UpdateFrame+1023j
		mov	g_cTransShpCounter, 0
		mov	g_pTransShp, offset g_transshp1
		cmp	[bp+cTrackTile], 0
		jnz	short loc_9F1_1220
		jmp	loc_9F1_180E
; ---------------------------------------------------------------------------

loc_9F1_1220:				; CODE XREF: UpdateFrame+1037j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneItem], ax
		mov	bx, ax
		test	[bx+SceneShape3D.cTranslateFlag], 1
		jz	short loc_9F1_1258
		mov	al, [bp+var_102]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wTrackPos[bx]
		mov	[bp+var_5E], ax
		mov	al, [bp+var_102]
		inc	al
		jmp	short loc_9F1_126C
; ---------------------------------------------------------------------------

loc_9F1_1258:				; CODE XREF: UpdateFrame+105Aj
		mov	al, [bp+var_102]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		mov	[bp+var_5E], ax
		mov	al, [bp+var_102]

loc_9F1_126C:				; CODE XREF: UpdateFrame+1072j
		mov	[bp+var_12C], al
		mov	bx, [bp+pSceneItem]
		test	[bx+SceneShape3D.cTranslateFlag], 2
		jz	short loc_9F1_1292
		mov	al, [bp+var_F6]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, (g_wMoreTrackPos+2)[bx]
		mov	[bp+var_3A], ax
		mov	al, [bp+var_F6]
		inc	al
		jmp	short loc_9F1_12A6
; ---------------------------------------------------------------------------

loc_9F1_1292:				; CODE XREF: UpdateFrame+1094j
		mov	al, [bp+var_F6]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		mov	[bp+var_3A], ax
		mov	al, [bp+var_F6]

loc_9F1_12A6:				; CODE XREF: UpdateFrame+10ACj
		mov	[bp+var_100], al
		mov	ax, [bp+var_3A]
		sub	ax, [bp+vec4.wX]
		mov	[bp+vec5.wX], ax
		mov	ax, [bp+var_48]
		sub	ax, [bp+vec4.wY]
		mov	[bp+vec5.wY], ax
		mov	ax, [bp+var_5E]
		sub	ax, [bp+vec4.wZ]
		mov	[bp+vec5.wZ], ax
		cmp	[bp+var_48], 0
		jnz	short loc_9F1_12CE
		jmp	loc_9F1_139E
; ---------------------------------------------------------------------------

loc_9F1_12CE:				; CODE XREF: UpdateFrame+10E5j
		mov	bx, [bp+pSceneItem]
		mov	al, [bx+SceneShape3D.cTranslateFlag]
		cbw
		or	ax, ax
		jz	short loc_9F1_12EC
		cmp	ax, 1
		jz	short loc_9F1_12FE
		cmp	ax, 2
		jz	short loc_9F1_130A
		cmp	ax, 3
		jz	short loc_9F1_1316
		jmp	short loc_9F1_12F5
; ---------------------------------------------------------------------------
		nop

loc_9F1_12EC:				; CODE XREF: UpdateFrame+10F4j
		mov	di, 1
		mov	[bp+var_DA], 932h

loc_9F1_12F5:				; CODE XREF: UpdateFrame+1105j
					; UpdateFrame+1123j ...
		mov	[bp+wCounter], 0
		jmp	short loc_9F1_1326
; ---------------------------------------------------------------------------
		nop

loc_9F1_12FE:				; CODE XREF: UpdateFrame+10F9j
		mov	di, 2
		mov	[bp+var_DA], 936h
		jmp	short loc_9F1_12F5
; ---------------------------------------------------------------------------
		nop

loc_9F1_130A:				; CODE XREF: UpdateFrame+10FEj
		mov	di, 2
		mov	[bp+var_DA], 93Eh
		jmp	short loc_9F1_12F5
; ---------------------------------------------------------------------------
		nop

loc_9F1_1316:				; CODE XREF: UpdateFrame+1103j
		mov	di, 4
		mov	[bp+var_DA], 946h
		jmp	short loc_9F1_12F5
; ---------------------------------------------------------------------------
		nop

loc_9F1_1322:				; CODE XREF: UpdateFrame+11B5j
		inc	[bp+wCounter]

loc_9F1_1326:				; CODE XREF: UpdateFrame+1117j
		cmp	[bp+wCounter], di
		jge	short loc_9F1_139E
		mov	bx, [bp+var_DA]
		add	[bp+var_DA], 2
		mov	ax, [bx]
		add	ax, [bp+vec5.wX]
		mov	g_transshp1.vecPos.wX, ax
		mov	ax, [bp+vec5.wY]
		mov	g_transshp1.vecPos.wY, ax
		mov	bx, [bp+var_DA]
		add	[bp+var_DA], 2
		mov	ax, [bx]
		add	ax, [bp+vec5.wZ]
		mov	g_transshp1.vecPos.wZ, ax
		mov	g_transshp1.pShape3D, (offset g_pGame3DShapes.wNumVerts+3B2h)
		mov	g_transshp1.pRect, offset g_rcUnk
		mov	al, [bp+var_122]
		or	al, 5
		mov	g_transshp1.cFlags, al
		mov	g_transshp1.vecRot.wX, 0
		mov	g_transshp1.vecRot.wY, 0
		mov	g_transshp1.vecRot.wZ, 0
		mov	g_transshp1.field_10, 800h
		mov	g_transshp1.cMaterial, 0
		mov	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_1322
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------

loc_9F1_139E:				; CODE XREF: UpdateFrame+10E7j
					; UpdateFrame+1146j
		mov	bx, [bp+pSceneItem]
		cmp	[bx+SceneShape3D.field_8], 0
		jnz	short loc_9F1_13AB
		jmp	loc_9F1_1464
; ---------------------------------------------------------------------------

loc_9F1_13AB:				; CODE XREF: UpdateFrame+11C2j
		mov	al, [bx+SceneShape3D.field_8]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneItem2], ax
		cmp	[bp+var_FC], 0
		jz	short loc_9F1_13D0
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		jmp	short loc_9F1_13D6
; ---------------------------------------------------------------------------

loc_9F1_13D0:				; CODE XREF: UpdateFrame+11E3j
		mov	bx, [bp+pSceneItem2]
		mov	ax, [bx+SceneShape3D.pShape3D]

loc_9F1_13D6:				; CODE XREF: UpdateFrame+11EAj
		mov	g_transshp2.pShape3D, ax
		or	ax, ax
		jnz	short loc_9F1_13E0
		jmp	loc_9F1_1464
; ---------------------------------------------------------------------------

loc_9F1_13E0:				; CODE XREF: UpdateFrame+11F7j
		push	si
		push	di
		mov	di, offset g_transshp2
		lea	si, [bp+vec5]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	g_transshp2.vecRot.wX, 0
		mov	g_transshp2.vecRot.wY, 0
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	g_transshp2.vecRot.wZ, ax
		cmp	[bx+SceneShape3D.cTranslateFlag], 0
		jz	short loc_9F1_1410
		mov	g_transshp2.field_10, 400h
		jmp	short loc_9F1_1416
; ---------------------------------------------------------------------------
		nop

loc_9F1_1410:				; CODE XREF: UpdateFrame+1221j
		mov	g_transshp2.field_10, 800h

loc_9F1_1416:				; CODE XREF: UpdateFrame+1229j
		cmp	[bx+SceneShape3D.cMaterial], 0
		jl	short loc_9F1_1422
		mov	al, [bx+SceneShape3D.cMaterial]
		jmp	short loc_9F1_1426
; ---------------------------------------------------------------------------
		nop

loc_9F1_1422:				; CODE XREF: UpdateFrame+1236j
		mov	al, [bp+cMaterial]

loc_9F1_1426:				; CODE XREF: UpdateFrame+123Bj
		mov	g_transshp2.cMaterial, al
		mov	al, [bx+SceneShape3D.field_A]
		or	al, [bp+var_122]
		or	al, 4
		mov	g_transshp2.cFlags, al
		test	g_transshp2.cFlags, 1
		jz	short loc_9F1_145A
		mov	g_transshp2.pRect, offset g_rcIntroCopy
		mov	ax, offset g_transshp2
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_1464
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------

loc_9F1_145A:				; CODE XREF: UpdateFrame+1256j
		mov	g_transshp2.pRect, offset g_rcUnk
		mov	[bp+var_4E], 1

loc_9F1_1464:				; CODE XREF: UpdateFrame+11C4j
					; UpdateFrame+11F9j ...
		cmp	[bp+var_FC], 0
		jz	short loc_9F1_1474
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		jmp	short loc_9F1_147B
; ---------------------------------------------------------------------------

loc_9F1_1474:				; CODE XREF: UpdateFrame+1285j
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]

loc_9F1_147B:				; CODE XREF: UpdateFrame+128Ej
		mov	g_transshp1.pShape3D, ax
		push	si
		push	di
		mov	di, offset g_transshp1
		lea	si, [bp+vec5]
		push	ds
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	g_transshp1.vecRot.wX, 0
		mov	g_transshp1.vecRot.wY, 0
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	g_transshp1.vecRot.wZ, ax
		cmp	[bx+SceneShape3D.cTranslateFlag], 0
		jz	short loc_9F1_14AE
		mov	g_transshp1.field_10, 400h
		jmp	short loc_9F1_14B4
; ---------------------------------------------------------------------------
		nop

loc_9F1_14AE:				; CODE XREF: UpdateFrame+12BFj
		mov	g_transshp1.field_10, 800h

loc_9F1_14B4:				; CODE XREF: UpdateFrame+12C7j
		mov	al, [bx+SceneShape3D.field_A]
		or	al, [bp+var_122]
		or	al, 4
		mov	g_transshp1.cFlags, al
		cmp	[bx+SceneShape3D.cMaterial], 0
		jl	short loc_9F1_14CC
		mov	al, [bx+SceneShape3D.cMaterial]
		jmp	short loc_9F1_14D0
; ---------------------------------------------------------------------------
		nop

loc_9F1_14CC:				; CODE XREF: UpdateFrame+12E0j
		mov	al, [bp+cMaterial]

loc_9F1_14D0:				; CODE XREF: UpdateFrame+12E5j
		mov	g_transshp1.cMaterial, al
		test	[bx+SceneShape3D.field_A], 1
		jz	short loc_9F1_14F8
		mov	g_transshp1.pRect, offset g_rcIntroCopy
		mov	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_155A
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------
		nop

loc_9F1_14F8:				; CODE XREF: UpdateFrame+12F3j
		mov	g_transshp1.pRect, offset g_rcUnk
		sub	ax, ax
		push	ax
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4
		cmp	[bp+var_4E], 0
		jz	short loc_9F1_1539
		mov	[bp+var_4E], 0
		sub	ax, ax
		push	ax
		mov	ax, 0F800h
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4
		cmp	[bp+var_6C], 0
		jz	short loc_9F1_152C
		mov	[bp+var_6C], 0FC00h

loc_9F1_152C:				; CODE XREF: UpdateFrame+1341j
		cmp	[bp+var_A4], 0
		jz	short loc_9F1_1539
		sub	[bp+var_A4], 400h

loc_9F1_1539:				; CODE XREF: UpdateFrame+1329j
					; UpdateFrame+134Dj
		mov	al, g_cStartCol2
		cmp	[bp+var_F6], al
		jnz	short loc_9F1_1554
		mov	al, g_cStartRow2
		cmp	[bp+var_102], al
		jnz	short loc_9F1_1554
		mov	[bp+var_12A], 0
		jmp	short loc_9F1_155A
; ---------------------------------------------------------------------------
		nop

loc_9F1_1554:				; CODE XREF: UpdateFrame+135Cj
					; UpdateFrame+1365j
		mov	[bp+var_12A], 0FFFFh

loc_9F1_155A:				; CODE XREF: UpdateFrame+130Ej
					; UpdateFrame+136Dj
		mov	al, [bp+var_102]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_F6]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata19
		mov	es, word ptr g_ppTrakdata19+2
		assume es:nothing
		mov	al, es:[bx]
		mov	[bp+var_4C], al
		cmp	al, 0FFh
		jnz	short loc_9F1_1583
		jmp	loc_9F1_181E
; ---------------------------------------------------------------------------

loc_9F1_1583:				; CODE XREF: UpdateFrame+139Aj
		cbw
		mov	bx, ax
		cmp	gameState.field_3FA[bx], 0
		jnz	short loc_9F1_1590
		jmp	loc_9F1_1716
; ---------------------------------------------------------------------------

loc_9F1_1590:				; CODE XREF: UpdateFrame+13A7j
		cmp	gameState.field_42A, 0
		jnz	short loc_9F1_159A
		jmp	loc_9F1_181E
; ---------------------------------------------------------------------------

loc_9F1_159A:				; CODE XREF: UpdateFrame+13B1j
		sub	di, di


; here starts a	loop at	18 times, writing to an	array pointed at by g_ppUnk14, which is	increased by 14h at the	end of the loop

loc_9F1_159C:				; CODE XREF: UpdateFrame+152Cj
		mov	ax, di
		shl	ax, 1
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		cmp	word ptr gameState.field_38E[bx], 0
		jnz	short loc_9F1_15B0
		jmp	loc_9F1_170A
; ---------------------------------------------------------------------------

loc_9F1_15B0:				; CODE XREF: UpdateFrame+13C7j
		mov	al, [bp+var_4C]
		cbw
		add	ax, 2
		mov	cl, gameState.field_443[di]
		sub	ch, ch
		cmp	ax, cx
		jz	short loc_9F1_15C4
		jmp	loc_9F1_170A
; ---------------------------------------------------------------------------

loc_9F1_15C4:				; CODE XREF: UpdateFrame+13DBj
		mov	al, gameState.field_42B[di]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes3
		mov	[bp+pSceneItem], ax
		mov	ax, di
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	ax, word ptr gameState.vecLong8_1.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_1.dwX+2)[bx]
		mov	cl, 6

loc_9F1_15F3:				; CODE XREF: UpdateFrame+1415j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_15F3
		mov	cx, ax
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		add	cx, es:[bx]
		sub	cx, [bp+vec4.wX]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wX], cx
		mov	bx, [bp+var_150]
		mov	ax, word ptr gameState.vecLong8_2.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_2.dwX+2)[bx]
		mov	cl, 6

loc_9F1_162B:				; CODE XREF: UpdateFrame+144Dj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_162B
		mov	cx, ax
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		add	cx, es:[bx+2]
		sub	cx, [bp+vec4.wY]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wY], cx
		mov	bx, [bp+var_150]
		mov	ax, word ptr gameState.vecLong8_3.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_3.dwX+2)[bx]
		mov	cl, 6

loc_9F1_1665:				; CODE XREF: UpdateFrame+1487j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1665
		mov	cx, ax
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		add	cx, es:[bx+4]
		sub	cx, [bp+vec4.wZ]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wZ], cx
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk
		mov	bx, g_pTransShp
		mov	al, [bp+var_122]
		or	al, 5
		mov	[bx+TransformedShape3D.cFlags],	al
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_2FE[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wX], ax
		mov	ax, di
		shl	ax, 1
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		mov	ax, gameState.field_32E[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wY], ax
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_35E[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 400h
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.cMaterial], 0
		sub	ax, ax
		push	ax
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4

loc_9F1_170A:				; CODE XREF: UpdateFrame+13C9j
					; UpdateFrame+13DDj
		inc	di
		cmp	di, 18h		; loop for 18h times, =	24
		jge	short loc_9F1_1713
		jmp	loc_9F1_159C
; ---------------------------------------------------------------------------

loc_9F1_1713:				; CODE XREF: UpdateFrame+152Aj
		jmp	loc_9F1_181E
; ---------------------------------------------------------------------------

loc_9F1_1716:				; CODE XREF: UpdateFrame+13A9j
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		add	bx, word ptr g_pTrakdata23
		mov	es, word ptr g_pTrakdata23+2
		mov	al, es:[bx]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, (offset g_sceneShapes1.field_0+0A8h)
		mov	[bp+pSceneItem], ax
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		mov	ax, es:[bx]
		sub	ax, [bp+vec4.wX]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wX], ax
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		mov	ax, es:[bx+2]
		sub	ax, [bp+vec4.wY]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wY], ax
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		mov	ax, es:[bx+4]
		sub	ax, [bp+vec4.wZ]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wZ], ax
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk
		mov	bx, g_pTransShp
		mov	al, [bp+var_122]
		or	al, 4
		mov	[bx+TransformedShape3D.cFlags],	al
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wX], 0
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wY], 0
		mov	al, [bp+var_4C]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata8
		mov	es, word ptr g_ppTrakdata8+2
		mov	ax, es:[bx]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 64h ;	'd'
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.cMaterial], 0
		sub	ax, ax
		push	ax
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4
		jmp	short loc_9F1_181E
; ---------------------------------------------------------------------------

loc_9F1_180E:				; CODE XREF: UpdateFrame+1039j
		mov	al, [bp+var_F6]
		mov	[bp+var_100], al
		mov	al, [bp+var_102]
		mov	[bp+var_12C], al

loc_9F1_181E:				; CODE XREF: UpdateFrame+139Cj
					; UpdateFrame+13B3j ...
		mov	al, [bp+var_F6]
		cmp	[bp+var_3C], al
		jz	short loc_9F1_1833
		mov	al, [bp+var_100]
		cmp	[bp+var_3C], al
		jz	short loc_9F1_1833
		jmp	loc_9F1_1ACA
; ---------------------------------------------------------------------------

loc_9F1_1833:				; CODE XREF: UpdateFrame+1641j
					; UpdateFrame+164Aj
		mov	al, [bp+var_102]
		cmp	[bp+var_60], al
		jz	short loc_9F1_1848
		mov	al, [bp+var_12C]
		cmp	[bp+var_60], al
		jz	short loc_9F1_1848
		jmp	loc_9F1_1ACA
; ---------------------------------------------------------------------------

loc_9F1_1848:				; CODE XREF: UpdateFrame+1656j
					; UpdateFrame+165Fj
		cmp	gameState.field_42A, 0
		jnz	short loc_9F1_1852
		jmp	loc_9F1_198F
; ---------------------------------------------------------------------------

loc_9F1_1852:				; CODE XREF: UpdateFrame+1669j
		sub	di, di

loc_9F1_1854:				; CODE XREF: UpdateFrame+17A8j
		mov	ax, di
		shl	ax, 1
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		cmp	word ptr gameState.field_38E[bx], 0
		jnz	short loc_9F1_1868
		jmp	loc_9F1_1986
; ---------------------------------------------------------------------------

loc_9F1_1868:				; CODE XREF: UpdateFrame+167Fj
		cmp	gameState.field_443[di], 0
		jz	short loc_9F1_1872
		jmp	loc_9F1_1986
; ---------------------------------------------------------------------------

loc_9F1_1872:				; CODE XREF: UpdateFrame+1689j
		mov	al, gameState.field_42B[di]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes3
		mov	[bp+pSceneItem], ax
		mov	ax, di
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	ax, word ptr gameState.vecLong8_1.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_1.dwX+2)[bx]
		add	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		adc	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_18A9:				; CODE XREF: UpdateFrame+16CBj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_18A9
		sub	ax, [bp+vec4.wX]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wX], ax
		mov	bx, [bp+var_150]
		mov	ax, word ptr gameState.vecLong8_2.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_2.dwX+2)[bx]
		add	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		adc	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_18D0:				; CODE XREF: UpdateFrame+16F2j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_18D0
		sub	ax, [bp+vec4.wY]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wY], ax
		mov	bx, [bp+var_150]
		mov	ax, word ptr gameState.vecLong8_3.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_3.dwX+2)[bx]
		add	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		adc	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_18F8:				; CODE XREF: UpdateFrame+171Aj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_18F8
		sub	ax, [bp+vec4.wZ]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wZ], ax
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk
		mov	bx, g_pTransShp
		mov	al, [bp+var_122]
		or	al, 5
		mov	[bx+TransformedShape3D.cFlags],	al
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_2FE[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wX], ax
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_32E[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wY], ax
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_35E[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 400h
		mov	bx, g_pTransShp
		mov	al, g_gameInfo.cPlayerMaterial
		mov	[bx+TransformedShape3D.cMaterial], al
		sub	ax, ax
		push	ax
		mov	ax, [bp+var_6C]
		and	ax, [bp+var_12A]
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4

loc_9F1_1986:				; CODE XREF: UpdateFrame+1681j
					; UpdateFrame+168Bj
		inc	di
		cmp	di, 18h
		jge	short loc_9F1_198F
		jmp	loc_9F1_1854
; ---------------------------------------------------------------------------

loc_9F1_198F:				; CODE XREF: UpdateFrame+166Bj
					; UpdateFrame+17A6j
		mov	[bp+pSceneItem], (offset g_sceneShapes.field_0+1Ch)
		mov	bx, g_pTransShp
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwX
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_19A2:				; CODE XREF: UpdateFrame+17C4j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_19A2
		sub	ax, [bp+vec4.wX]
		mov	[bx+TransformedShape3D.vecPos.wX], ax
		mov	bx, g_pTransShp
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwY
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_19BC:				; CODE XREF: UpdateFrame+17DEj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_19BC
		sub	ax, [bp+vec4.wY]
		mov	[bx+TransformedShape3D.vecPos.wY], ax
		mov	bx, g_pTransShp
		mov	ax, word ptr gameState.carPlayer.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carPlayer.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_19D7:				; CODE XREF: UpdateFrame+17F9j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_19D7
		sub	ax, [bp+vec4.wZ]
		mov	[bx+TransformedShape3D.vecPos.wZ], ax
		cmp	[bp+var_FC], 0
		jnz	short loc_9F1_19F3
		cmp	g_wTimerFlag3, 2
		jbe	short loc_9F1_1A04

loc_9F1_19F3:				; CODE XREF: UpdateFrame+1806j
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		jmp	short loc_9F1_1A3A
; ---------------------------------------------------------------------------
		nop

loc_9F1_1A04:				; CODE XREF: UpdateFrame+180Dj
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		mov	ax, offset g_wCarXSum
		push	ax
		mov	ax, offset g_pCar1_6Vecs
		push	ax
		mov	ax, offset g_pCar1_5Zeros
		push	ax
		mov	ax, offset gameState.carPlayer.rc2
		push	ax
		push	gameState.carPlayer.field_20
		mov	ax, word ptr g_pCar1Shape.pVertices
		mov	dx, word ptr g_pCar1Shape.pVertices+2
		add	ax, 30h	; '0'
		push	dx
		push	ax
		call	sub_E1A_230E
		add	sp, 0Eh

loc_9F1_1A3A:				; CODE XREF: UpdateFrame+181Dj
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_1A54
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk2

loc_9F1_1A4A:				; CODE XREF: UpdateFrame+1891j
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.cFlags],	0Ch
		jmp	short loc_9F1_1A80
; ---------------------------------------------------------------------------

loc_9F1_1A54:				; CODE XREF: UpdateFrame+185Bj
		cmp	gameState.carPlayer.field_C9, 1
		jnz	short loc_9F1_1A78
		push	si
		push	di
		lea	di, [bp+rc1]
		mov	si, offset g_rc1
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, g_pTransShp
		lea	ax, [bp+rc1]
		mov	[bx+TransformedShape3D.pRect], ax
		jmp	short loc_9F1_1A4A
; ---------------------------------------------------------------------------
		nop

loc_9F1_1A78:				; CODE XREF: UpdateFrame+1875j
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.cFlags],	4

loc_9F1_1A80:				; CODE XREF: UpdateFrame+186Ej
		mov	bx, g_pTransShp
		mov	ax, gameState.carPlayer.vecRotate.wZ
		neg	ax
		mov	[bx+TransformedShape3D.vecRot.wX], ax
		mov	bx, g_pTransShp
		mov	ax, gameState.carPlayer.vecRotate.wY
		neg	ax
		mov	[bx+TransformedShape3D.vecRot.wY], ax
		mov	bx, g_pTransShp
		mov	ax, gameState.carPlayer.vecRotate.wX
		neg	ax
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 12Ch
		mov	bx, g_pTransShp
		mov	al, g_gameInfo.cPlayerMaterial
		mov	[bx+TransformedShape3D.cMaterial], al
		mov	ax, 2
		push	ax
		mov	ax, [bp+var_6C]
		and	ax, [bp+var_12A]
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4

loc_9F1_1ACA:				; CODE XREF: UpdateFrame+164Cj
					; UpdateFrame+1661j
		mov	al, [bp+var_F6]
		cmp	[bp+var_4A], al
		jz	short loc_9F1_1ADF
		mov	al, [bp+var_100]
		cmp	[bp+var_4A], al
		jz	short loc_9F1_1ADF
		jmp	loc_9F1_1D79
; ---------------------------------------------------------------------------

loc_9F1_1ADF:				; CODE XREF: UpdateFrame+18EDj
					; UpdateFrame+18F6j
		mov	al, [bp+var_102]
		cmp	[bp+var_6E], al
		jz	short loc_9F1_1AF4
		mov	al, [bp+var_12C]
		cmp	[bp+var_6E], al
		jz	short loc_9F1_1AF4
		jmp	loc_9F1_1D79
; ---------------------------------------------------------------------------

loc_9F1_1AF4:				; CODE XREF: UpdateFrame+1902j
					; UpdateFrame+190Bj
		cmp	gameState.field_42A, 0
		jnz	short loc_9F1_1AFE
		jmp	loc_9F1_1C3C
; ---------------------------------------------------------------------------

loc_9F1_1AFE:				; CODE XREF: UpdateFrame+1915j
		sub	di, di

loc_9F1_1B00:				; CODE XREF: UpdateFrame+1A55j
		mov	ax, di
		shl	ax, 1
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		cmp	word ptr gameState.field_38E[bx], 0
		jnz	short loc_9F1_1B14
		jmp	loc_9F1_1C33
; ---------------------------------------------------------------------------

loc_9F1_1B14:				; CODE XREF: UpdateFrame+192Bj
		cmp	gameState.field_443[di], 1
		jz	short loc_9F1_1B1E
		jmp	loc_9F1_1C33
; ---------------------------------------------------------------------------

loc_9F1_1B1E:				; CODE XREF: UpdateFrame+1935j
		mov	al, gameState.field_42B[di]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes3
		mov	[bp+pSceneItem], ax
		mov	ax, di
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_150], ax
		mov	bx, ax
		mov	ax, word ptr gameState.vecLong8_1.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_1.dwX+2)[bx]
		add	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		adc	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_1B55:				; CODE XREF: UpdateFrame+1977j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1B55
		sub	ax, [bp+vec4.wX]
		mov	bx, g_pTransShp
		mov	[bx], ax
		mov	bx, [bp+var_150]
		mov	ax, word ptr gameState.vecLong8_2.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_2.dwX+2)[bx]
		add	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		adc	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_1B7C:				; CODE XREF: UpdateFrame+199Ej
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1B7C
		sub	ax, [bp+vec4.wY]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wY], ax
		mov	bx, [bp+var_150]
		mov	ax, word ptr gameState.vecLong8_3.dwX[bx]
		mov	dx, word ptr (gameState.vecLong8_3.dwX+2)[bx]
		add	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		adc	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_1BA4:				; CODE XREF: UpdateFrame+19C6j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1BA4
		sub	ax, [bp+vec4.wZ]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wZ], ax
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk
		mov	bx, g_pTransShp
		mov	al, [bp+var_122]
		or	al, 5
		mov	[bx+TransformedShape3D.cFlags],	al
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_2FE[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wX], ax
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_32E[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wY], ax
		mov	bx, word ptr [bp+pVec]
		mov	ax, gameState.field_35E[bx]
		neg	ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 400h
		mov	bx, g_pTransShp
		mov	al, g_gameInfo.cOppMaterial
		mov	[bx+TransformedShape3D.cMaterial], al
		sub	ax, ax
		push	ax
		mov	ax, [bp+var_A4]
		and	ax, [bp+var_12A]
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4

loc_9F1_1C33:				; CODE XREF: UpdateFrame+192Dj
					; UpdateFrame+1937j
		inc	di
		cmp	di, 18h
		jge	short loc_9F1_1C3C
		jmp	loc_9F1_1B00
; ---------------------------------------------------------------------------

loc_9F1_1C3C:				; CODE XREF: UpdateFrame+1917j
					; UpdateFrame+1A53j
		mov	[bp+pSceneItem], (offset g_sceneShapes.field_0+2Ah)
		mov	bx, g_pTransShp
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_1C4F:				; CODE XREF: UpdateFrame+1A71j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1C4F
		sub	ax, [bp+vec4.wX]
		mov	[bx+TransformedShape3D.vecPos.wX], ax
		mov	bx, g_pTransShp
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_1C69:				; CODE XREF: UpdateFrame+1A8Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1C69
		sub	ax, [bp+vec4.wY]
		mov	[bx+TransformedShape3D.vecPos.wY], ax
		mov	bx, g_pTransShp
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_1C84:				; CODE XREF: UpdateFrame+1AA6j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_1C84
		sub	ax, [bp+vec4.wZ]
		mov	[bx+TransformedShape3D.vecPos.wZ], ax
		cmp	[bp+var_FC], 0
		jnz	short loc_9F1_1CA0
		cmp	g_wTimerFlag3, 2
		jbe	short loc_9F1_1CB0

loc_9F1_1CA0:				; CODE XREF: UpdateFrame+1AB3j
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		jmp	short loc_9F1_1CE6
; ---------------------------------------------------------------------------

loc_9F1_1CB0:				; CODE XREF: UpdateFrame+1ABAj
		mov	bx, [bp+pSceneItem]
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], ax
		mov	ax, offset g_wCar2XSum
		push	ax
		mov	ax, offset g_pCar2_6Vecs
		push	ax
		mov	ax, offset g_pCar2_5Zeros
		push	ax
		mov	ax, offset gameState.carOpponent.rc2
		push	ax
		push	gameState.carOpponent.field_20
		mov	ax, word ptr g_pOppCar1Shape.pVertices
		mov	dx, word ptr g_pOppCar1Shape.pVertices+2
		add	ax, 30h	; '0'
		push	dx
		push	ax
		call	sub_E1A_230E
		add	sp, 0Eh

loc_9F1_1CE6:				; CODE XREF: UpdateFrame+1ACAj
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_1D00
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk3

loc_9F1_1CF6:				; CODE XREF: UpdateFrame+1B3Fj
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.cFlags],	0Ch
		jmp	short loc_9F1_1D2E
; ---------------------------------------------------------------------------

loc_9F1_1D00:				; CODE XREF: UpdateFrame+1B07j
		cmp	gameState.carOpponent.field_C9,	1
		jnz	short loc_9F1_1D26
		push	si
		push	di
		lea	di, [bp+var_8E]
		mov	si, offset g_rc1
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, g_pTransShp
		lea	ax, [bp+var_8E]
		mov	[bx+TransformedShape3D.pRect], ax
		jmp	short loc_9F1_1CF6
; ---------------------------------------------------------------------------
		nop

loc_9F1_1D26:				; CODE XREF: UpdateFrame+1B21j
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.cFlags],	4

loc_9F1_1D2E:				; CODE XREF: UpdateFrame+1B1Aj
		mov	bx, g_pTransShp
		mov	ax, gameState.carOpponent.vecRotate.wZ
		neg	ax
		mov	[bx+TransformedShape3D.vecRot.wX], ax
		mov	bx, g_pTransShp
		mov	ax, gameState.carOpponent.vecRotate.wY
		neg	ax
		mov	[bx+TransformedShape3D.vecRot.wY], ax
		mov	bx, g_pTransShp
		mov	ax, gameState.carOpponent.vecRotate.wX
		neg	ax
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 12Ch
		mov	bx, g_pTransShp
		mov	al, g_gameInfo.cOppMaterial
		mov	[bx+TransformedShape3D.cMaterial], al
		mov	ax, 3
		push	ax
		mov	ax, [bp+var_A4]
		and	ax, [bp+var_12A]
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4

loc_9F1_1D79:				; CODE XREF: UpdateFrame+18F8j
					; UpdateFrame+190Dj
		cmp	gameState.cCvxFlag2, 0
		jz	short loc_9F1_1D83
		jmp	loc_9F1_1F9A
; ---------------------------------------------------------------------------

loc_9F1_1D83:				; CODE XREF: UpdateFrame+1B9Aj
		mov	al, g_cStartCol2
		cmp	[bp+var_F6], al
		jz	short loc_9F1_1D95
		cmp	[bp+var_100], al
		jz	short loc_9F1_1D95
		jmp	loc_9F1_1F9A
; ---------------------------------------------------------------------------

loc_9F1_1D95:				; CODE XREF: UpdateFrame+1BA6j
					; UpdateFrame+1BACj
		mov	al, g_cStartRow2
		cmp	[bp+var_102], al
		jz	short loc_9F1_1DA7
		cmp	[bp+var_12C], al
		jz	short loc_9F1_1DA7
		jmp	loc_9F1_1F9A
; ---------------------------------------------------------------------------

loc_9F1_1DA7:				; CODE XREF: UpdateFrame+1BB8j
					; UpdateFrame+1BBEj
		mov	ax, 24h	; '$'
		push	ax
		push	word_2B77_965A
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	[bp+wCounter], ax
		mov	ax, 24h	; '$'
		push	ax
		push	word_2B77_965A
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, 38h	; '8'
		mov	[bp+var_36], ax
		mov	ax, word ptr m_p3DShapes.pVertices
		mov	dx, word ptr m_p3DShapes.pVertices+2
		add	ax, 30h	; '0'
		mov	word ptr [bp+var_108], ax
		mov	word ptr [bp+var_108+2], dx
		les	bx, [bp+var_108]
		mov	ax, [bp+wCounter]
		sub	ax, 24h	; '$'
		mov	es:[bx], ax
		les	bx, [bp+var_108]
		mov	ax, [bp+wCounter]
		sub	ax, 24h	; '$'
		mov	es:[bx+6], ax
		les	bx, [bp+var_108]
		mov	ax, 24h	; '$'
		sub	ax, [bp+wCounter]
		mov	es:[bx+0Ch], ax
		les	bx, [bp+var_108]
		mov	ax, 24h	; '$'
		sub	ax, [bp+wCounter]
		mov	es:[bx+12h], ax
		les	bx, [bp+var_108]
		mov	ax, [bp+var_36]
		mov	es:[bx+4], ax
		les	bx, [bp+var_108]
		mov	ax, [bp+var_36]
		mov	es:[bx+0Ah], ax
		les	bx, [bp+var_108]
		mov	ax, [bp+var_36]
		mov	es:[bx+10h], ax
		les	bx, [bp+var_108]
		mov	ax, [bp+var_36]
		mov	es:[bx+16h], ax
		mov	ax, 24h	; '$'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 1
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 1B6h
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 2
		push	cx
		mov	word ptr [bp+pVec], ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, ax
		mov	al, g_cStartCol2
		cbw
		mov	bx, ax
		shl	bx, 1
		add	cx, g_wMoreTrkCenPo[bx]
		add	cx, word ptr [bp+pVec]
		sub	cx, [bp+vec4.wX]

loc_9F1_1EAE:
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wX], cx
		mov	al, byte_2B77_922B
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, [bx+178h]
		sub	ax, [bp+vec4.wY]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wY], ax
		mov	ax, 24h	; '$'
		push	ax
		mov	ax, g_wUseTrkInRpl
		add	ah, 1
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, 1B6h
		push	cx
		mov	cx, g_wUseTrkInRpl
		add	ch, 2
		push	cx
		mov	word ptr [bp+pVec], ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, ax
		mov	al, g_cStartRow2
		cbw
		mov	bx, ax
		shl	bx, 1
		add	cx, word ptr g_wTrackCenPos[bx]
		add	cx, word ptr [bp+pVec]
		sub	cx, [bp+vec4.wZ]
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecPos.wZ], cx
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pShape3D], offset m_p3DShapes
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.pRect], offset g_rcUnk
		mov	bx, g_pTransShp
		mov	al, [bp+var_122]
		or	al, 4
		mov	[bx+TransformedShape3D.cFlags],	al
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wX], 0
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.vecRot.wY], 0
		mov	bx, g_pTransShp
		mov	ax, g_wUseTrkInRpl
		mov	[bx+TransformedShape3D.vecRot.wZ], ax
		mov	bx, g_pTransShp
		mov	[bx+TransformedShape3D.field_10], 400h
		mov	ax, word_2B77_965A
		mov	cl, 6
		sar	ax, cl
		mov	[bp+wCounter], ax
		cmp	ax, 3
		jle	short loc_9F1_1F7D
		mov	[bp+wCounter], 3

loc_9F1_1F7D:				; CODE XREF: UpdateFrame+1D91j
		mov	bx, g_pTransShp
		mov	al, byte ptr [bp+wCounter]
		mov	[bx+TransformedShape3D.cMaterial], al
		sub	ax, ax
		push	ax
		mov	ax, [bp+var_12A]
		and	ax, 0F800h
		push	ax
		push	cs
		call	near ptr NextTransShape
		add	sp, 4

loc_9F1_1F9A:				; CODE XREF: UpdateFrame+1B9Cj
					; UpdateFrame+1BAEj ...
		cmp	g_cTransShpCounter, 0
		jnz	short loc_9F1_1FA4
		jmp	loc_9F1_205C
; ---------------------------------------------------------------------------

loc_9F1_1FA4:				; CODE XREF: UpdateFrame+1DBBj
		cmp	g_cTransShpCounter, 1
		jle	short loc_9F1_1FC0
		mov	ax, offset g_pwUnk14WordTable
		push	ax
		mov	ax, offset g_pwUnk14ZTable
		push	ax
		mov	al, g_cTransShpCounter
		cbw
		push	ax
		call	sub_26BE_8
		add	sp, 6

loc_9F1_1FC0:				; CODE XREF: UpdateFrame+1DC5j
		mov	[bp+wCounter], 0
		jmp	short loc_9F1_2028
; ---------------------------------------------------------------------------

loc_9F1_1FC8:				; CODE XREF: UpdateFrame+1E60j
		cmp	gameState.carPlayer.cIsBraking,	0
		jnz	short loc_9F1_1FF9

loc_9F1_1FCF:				; CODE XREF: UpdateFrame+1E13j
		mov	byte_2B77_9DA4,	2Eh ; '.'

loc_9F1_1FD4:				; CODE XREF: UpdateFrame+1E1Aj
					; UpdateFrame+1E67j
		mov	ax, 14h
		imul	di
		add	ax, offset g_transshp1
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cbw
		mov	[bp+var_14E], ax
		or	ax, ax
		jle	short loc_9F1_2000
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------
		nop

loc_9F1_1FF2:				; CODE XREF: UpdateFrame+1E65j
		cmp	gameState.carOpponent.cIsBraking, 0
		jz	short loc_9F1_1FCF

loc_9F1_1FF9:				; CODE XREF: UpdateFrame+1DE9j
		mov	byte_2B77_9DA4,	2Fh ; '/'
		jmp	short loc_9F1_1FD4
; ---------------------------------------------------------------------------

loc_9F1_2000:				; CODE XREF: UpdateFrame+1E08j
		cmp	[bp+var_14E], 0
		jnz	short loc_9F1_2024
		mov	al, byte ptr g_pcUnk14ByteTable[di]
		cbw
		cmp	ax, 2
		jz	short loc_9F1_2018
		cmp	ax, 3
		jz	short loc_9F1_204E
		jmp	short loc_9F1_2024
; ---------------------------------------------------------------------------

loc_9F1_2018:				; CODE XREF: UpdateFrame+1E2Bj
		cmp	gameState.carPlayer.field_C9, 1
		jnz	short loc_9F1_2024
		mov	[bp+var_DC], 1

loc_9F1_2024:				; CODE XREF: UpdateFrame+1E21j
					; UpdateFrame+1E32j ...
		inc	[bp+wCounter]

loc_9F1_2028:				; CODE XREF: UpdateFrame+1DE2j
		mov	al, g_cTransShpCounter
		cbw
		cmp	[bp+wCounter], ax
		jge	short loc_9F1_205C
		mov	bx, [bp+wCounter]
		shl	bx, 1
		mov	di, word ptr g_pwUnk14WordTable[bx]
		mov	al, byte ptr g_pcUnk14ByteTable[di]
		cbw
		cmp	ax, 2
		jz	short loc_9F1_1FC8
		cmp	ax, 3
		jz	short loc_9F1_1FF2
		jmp	short loc_9F1_1FD4
; ---------------------------------------------------------------------------
		nop

loc_9F1_204E:				; CODE XREF: UpdateFrame+1E30j
		cmp	gameState.carOpponent.field_C9,	1
		jnz	short loc_9F1_2024
		mov	[bp+var_DB], 1
		jmp	short loc_9F1_2024
; ---------------------------------------------------------------------------

loc_9F1_205C:				; CODE XREF: UpdateFrame+1DBDj
					; UpdateFrame+1E4Cj ...
		inc	si

loc_9F1_205D:				; CODE XREF: UpdateFrame+C20j
		cmp	si, 17h
		jl	short loc_9F1_2065
		jmp	loc_9F1_112C
; ---------------------------------------------------------------------------

loc_9F1_2065:				; CODE XREF: UpdateFrame+1E7Cj
		cmp	[bp+si+var_32],	0
		jnz	short loc_9F1_205C
		mov	al, [bp+si+var_86]
		mov	[bp+var_F6], al
		mov	al, [bp+si+var_D4]
		mov	[bp+var_102], al
		mov	al, [bp+si+var_14C]
		mov	[bp+cTrackTile], al
		mov	al, [bp+si+var_1A]
		mov	[bp+cTerrainTile], al
		mov	al, [bp+si+var_BC]
		mov	[bp+var_FC], al
		mov	[bp+var_12A], 0
		cmp	[bp+cTrackTile], 0
		jnz	short loc_9F1_20A0
		jmp	loc_9F1_E3A
; ---------------------------------------------------------------------------

loc_9F1_20A0:				; CODE XREF: UpdateFrame+1EB7j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneItem], ax
		mov	bx, ax
		mov	al, [bx+SceneShape3D.cTranslateFlag]
		cbw
		or	ax, ax
		jnz	short loc_9F1_20C5
		jmp	loc_9F1_E08
; ---------------------------------------------------------------------------

loc_9F1_20C5:				; CODE XREF: UpdateFrame+1EDCj
		cmp	ax, 1
		jnz	short loc_9F1_20CD
		jmp	loc_9F1_E16
; ---------------------------------------------------------------------------

loc_9F1_20CD:				; CODE XREF: UpdateFrame+1EE4j
		cmp	ax, 2
		jnz	short loc_9F1_20D5
		jmp	loc_9F1_E24
; ---------------------------------------------------------------------------

loc_9F1_20D5:				; CODE XREF: UpdateFrame+1EECj
		cmp	ax, 3
		jnz	short loc_9F1_20DD
		jmp	loc_9F1_E2C
; ---------------------------------------------------------------------------

loc_9F1_20DD:				; CODE XREF: UpdateFrame+1EF4j
		jmp	loc_9F1_E45
; ---------------------------------------------------------------------------

loc_9F1_20E0:				; CODE XREF: UpdateFrame+1FE8j
		mov	[bp+pRects], offset g_rcUnk3
		jmp	short loc_9F1_20F9
; ---------------------------------------------------------------------------
		nop

loc_9F1_20E8:				; CODE XREF: UpdateFrame+1FE1j
		or	si, si
		jnz	short loc_9F1_20F2
		lea	ax, [bp+rc1]
		jmp	short loc_9F1_20F6
; ---------------------------------------------------------------------------
		nop

loc_9F1_20F2:				; CODE XREF: UpdateFrame+1F06j
		lea	ax, [bp+var_8E]

loc_9F1_20F6:				; CODE XREF: UpdateFrame+1F0Bj
		mov	[bp+pRects], ax

loc_9F1_20F9:				; CODE XREF: UpdateFrame+1F01j
					; UpdateFrame+1FF0j
		push	[bp+arg_2]
		push	[bp+pRects]
		call	MaybeRectOp
		add	sp, 4
		or	al, al
		jz	short loc_9F1_210E
		jmp	loc_9F1_21B1
; ---------------------------------------------------------------------------

loc_9F1_210E:				; CODE XREF: UpdateFrame+1F25j
		mov	bx, [bp+pRects]
		push	[bx+Rectangle.dwBottom]
		push	[bx+Rectangle.dwRight]
		push	[bx+Rectangle.dwTop]
		push	[bx+Rectangle.dwLeft]
		call	SetSprite1Size
		add	sp, 8
		mov	bx, [bp+pRects]
		mov	ax, [bx+Rectangle.dwTop]
		add	ax, [bx+Rectangle.dwLeft]
		sar	ax, 1
		mov	[bp+vec2.wX], ax
		mov	ax, [bx+4]
		add	ax, [bx+6]
		sar	ax, 1
		mov	[bp+vec2.wY], ax
		mov	ax, [bx+2]
		sub	ax, [bx]
		mov	[bp+wCounter], ax
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		mov	[bp+var_36], ax
		mov	ax, [bp+wCounter]
		cmp	[bp+var_36], ax
		jle	short loc_9F1_2160
		mov	ax, [bp+var_36]
		mov	[bp+wCounter], ax

loc_9F1_2160:				; CODE XREF: UpdateFrame+1F73j
		mov	ax, gameState.wGameFrame
		shr	ax, 1
		shr	ax, 1
		sub	dx, dx
		mov	cx, 3
		div	cx
		mov	di, dx
		mov	bx, di
		shl	bx, 1
		mov	ax, word ptr unk_2B77_9EC6[bx]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+wCounter]
		cwd
		mov	dh, dl
		mov	dl, ah
		mov	ah, al
		sub	al, al
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+var_36], ax
		push	[bp+vec2.wY]
		push	[bp+vec2.wX]
		mov	bx, di
		shl	bx, 1
		shl	bx, 1
		push	(g_pwManyExRes+2)[bx]
		push	g_pwManyExRes[bx]
		push	ax
		call	ImageSpriteOp2
		add	sp, 0Ah

loc_9F1_21B1:				; CODE XREF: UpdateFrame+1F27j
					; UpdateFrame+1FD8j
		inc	si

loc_9F1_21B2:				; CODE XREF: UpdateFrame+F8Cj
		cmp	si, 2
		jge	short loc_9F1_21D8
		cmp	[bp+si+var_DC],	0
		jz	short loc_9F1_21B1
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_21C8
		jmp	loc_9F1_20E8
; ---------------------------------------------------------------------------

loc_9F1_21C8:				; CODE XREF: UpdateFrame+1FDFj
		or	si, si
		jz	short loc_9F1_21CF
		jmp	loc_9F1_20E0
; ---------------------------------------------------------------------------

loc_9F1_21CF:				; CODE XREF: UpdateFrame+1FE6j
		mov	[bp+pRects], offset g_rcUnk2
		jmp	loc_9F1_20F9
; ---------------------------------------------------------------------------
		nop

loc_9F1_21D8:				; CODE XREF: UpdateFrame+1FD1j
		mov	bx, [bp+arg_2]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		cmp	g_cCameraMode, 0
		jz	short loc_9F1_21FA
		jmp	loc_9F1_22B6
; ---------------------------------------------------------------------------

loc_9F1_21FA:				; CODE XREF: UpdateFrame+2011j
		cmp	byte_2B77_AC70,	0
		jz	short loc_9F1_220E
		mov	[bp+pCvx], offset gameState.carOpponent
		mov	si, gameState.wGameFrame2
		jmp	short loc_9F1_2218
; ---------------------------------------------------------------------------
		nop

loc_9F1_220E:				; CODE XREF: UpdateFrame+201Bj
		mov	[bp+pCvx], offset gameState.carPlayer
		mov	si, gameState.field_146

loc_9F1_2218:				; CODE XREF: UpdateFrame+2027j
		mov	bx, [bp+pCvx]
		cmp	[bx+CarState.field_C9],	1
		jnz	short loc_9F1_226C
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_2252
		mov	ax, offset g_rcIntro
		push	ax
		push	ax
		mov	bx, [bp+arg_2]
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		push	ax
		push	word ptr [bx+4]
		mov	ax, gameState.wGameFrame
		sub	ax, si
		push	ax
		push	cs
		call	near ptr DoCracCinfRes

loc_9F1_2246:				; CODE XREF: UpdateFrame+20B6j
		add	sp, 6
		push	ax
		call	MinMaxRect
		jmp	short loc_9F1_22B3
; ---------------------------------------------------------------------------
		nop

loc_9F1_2252:				; CODE XREF: UpdateFrame+2044j
		mov	bx, [bp+arg_2]
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		push	ax
		push	word ptr [bx+4]
		mov	ax, gameState.wGameFrame
		sub	ax, si
		push	ax
		push	cs
		call	near ptr DoCracCinfRes
		jmp	short loc_9F1_22B3
; ---------------------------------------------------------------------------
		nop

loc_9F1_226C:				; CODE XREF: UpdateFrame+203Dj
		mov	bx, [bp+pCvx]
		cmp	[bx+CarState.field_C9],	2
		jnz	short loc_9F1_22B6
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_229C
		mov	ax, offset g_rcIntro
		push	ax
		push	ax
		mov	bx, [bp+arg_2]
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		push	ax
		push	word ptr [bx+4]
		mov	ax, gameState.wGameFrame
		sub	ax, si
		push	ax
		push	cs
		call	near ptr sub_9F1_3624
		jmp	short loc_9F1_2246
; ---------------------------------------------------------------------------

loc_9F1_229C:				; CODE XREF: UpdateFrame+2098j
		mov	bx, [bp+arg_2]
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		push	ax
		push	word ptr [bx+4]
		mov	ax, gameState.wGameFrame
		sub	ax, si
		push	ax
		push	cs
		call	near ptr sub_9F1_3624

loc_9F1_22B3:				; CODE XREF: UpdateFrame+206Bj
					; UpdateFrame+2085j
		add	sp, 6

loc_9F1_22B6:				; CODE XREF: UpdateFrame+2013j
					; UpdateFrame+2091j
		cmp	g_cGameMode2, 0
		jz	short loc_9F1_22C0
		jmp	loc_9F1_234B
; ---------------------------------------------------------------------------

loc_9F1_22C0:				; CODE XREF: UpdateFrame+20D7j
		cmp	gameState.cCvxFlag2, 0
		jnz	short loc_9F1_22CA
		jmp	loc_9F1_234B
; ---------------------------------------------------------------------------

loc_9F1_22CA:				; CODE XREF: UpdateFrame+20E1j
		sub	ax, ax
		push	ax
		mov	ax, g_wResetOnCvxTr
		add	ax, g_wMainFlgCp
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FormatString
		add	sp, 6
		push	word ptr g_dwFontLedRes+2
		push	word ptr g_dwFontLedRes
		call	SetFontDefImpl
		add	sp, 4
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_2328
		mov	ax, offset unk_2B77_92C4
		push	ax
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, g_wRoofBmpHeight
		add	ax, 2
		push	ax
		mov	ax, 8Ch	; 'Œ'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		call	MinMaxRect
		add	sp, 6
		jmp	short loc_9F1_2346
; ---------------------------------------------------------------------------
		nop
		nop

loc_9F1_2328:				; CODE XREF: UpdateFrame+2112j
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, g_wRoofBmpHeight
		add	ax, 2
		push	ax
		mov	ax, 8Ch	; 'Œ'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah

loc_9F1_2346:				; CODE XREF: UpdateFrame+2140j
		call	SetFontDef

loc_9F1_234B:				; CODE XREF: UpdateFrame+20D9j
					; UpdateFrame+20E3j
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_2355
		jmp	loc_9F1_23E8
; ---------------------------------------------------------------------------

loc_9F1_2355:				; CODE XREF: UpdateFrame+216Cj
		mov	ax, offset g_rcIntro
		push	ax
		push	ax
		push	cs
		call	near ptr DrawIngameText
		push	ax
		call	MinMaxRect
		add	sp, 6
		cmp	[bp+var_132], 0
		jz	short loc_9F1_239E
		mov	ax, [bp+arg_2]
		push	si
		push	di
		mov	di, offset g_rcIntro
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	si, 1

loc_9F1_2383:				; CODE XREF: UpdateFrame+21B8j
		mov	bx, si
		mov	cl, 3
		shl	bx, cl
		push	si
		push	di
		lea	di, g_rcIntro.dwLeft[bx]
		mov	si, offset g_rc1
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_2383

loc_9F1_239E:				; CODE XREF: UpdateFrame+2188j
		sub	si, si

loc_9F1_23A0:				; CODE XREF: UpdateFrame+21E6j
		mov	ax, si
		mov	cl, 3
		shl	ax, cl
		mov	word ptr [bp+pVec], ax
		mov	bx, ax
		lea	ax, g_rcIntro.dwLeft[bx]
		mov	bx, word ptr [bp+pVec]
		add	bx, g_prcMegaPoly1
		push	si
		push	di
		mov	di, bx
		mov	si, ax
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_23A0
		mov	al, [bp+arg_0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, [bp+wAngle3]
		mov	word ptr unk_2B77_928C[bx], ax
		mov	ax, [bp+wAngle3]
		mov	word_2B77_AC66,	ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_9F1_23E8:				; CODE XREF: UpdateFrame+216Ej
		push	cs
		call	near ptr DrawIngameText
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
UpdateFrame	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SkyboxRect	proc far		; CODE XREF: SkyBoxOp+3CAp
					; SkyBoxOp+5D5p ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		cmp	g_wTimerFlag3, 4
		jz	short loc_9F1_2410
		mov	si, [bp+arg_4]
		mov	bx, [bp+arg_0]
		sub	si, [bx+4]
		sub	si, g_wCurSkybox
		jmp	short loc_9F1_2419
; ---------------------------------------------------------------------------

loc_9F1_2410:				; CODE XREF: SkyboxRect+Dj
		mov	si, [bp+arg_4]
		mov	bx, [bp+arg_0]
		sub	si, [bx+4]

loc_9F1_2419:				; CODE XREF: SkyboxRect+1Cj
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		cmp	ax, si
		jge	short loc_9F1_2429
		mov	si, [bx+6]
		sub	si, [bx+4]

loc_9F1_2429:				; CODE XREF: SkyboxRect+2Fj
		or	si, si
		jle	short loc_9F1_244F
		mov	ax, [bx+4]
		add	ax, si
		push	ax
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	SetSprite1Size
		add	sp, 8
		push	g_wSomeClrColor
		call	ClearSprite1Col
		add	sp, 2

loc_9F1_244F:				; CODE XREF: SkyboxRect+39j
		cmp	g_wTimerFlag3, 4
		jnz	short loc_9F1_2459
		jmp	loc_9F1_2522
; ---------------------------------------------------------------------------

loc_9F1_2459:				; CODE XREF: SkyboxRect+62j
		mov	si, [bp+arg_2]
		add	si, 200h
		and	si, 3FFh
		sub	si, 400h
		mov	bx, [bp+arg_0]
		mov	ax, [bp+arg_4]
		cmp	[bx+4],	ax
		jl	short loc_9F1_2476
		jmp	loc_9F1_2522
; ---------------------------------------------------------------------------

loc_9F1_2476:				; CODE XREF: SkyboxRect+7Fj
		sub	ax, word_2B77_9D5E
		cmp	ax, [bx+6]
		jle	short loc_9F1_2482
		jmp	loc_9F1_2522
; ---------------------------------------------------------------------------

loc_9F1_2482:				; CODE XREF: SkyboxRect+8Bj
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	SetSprite1Size
		add	sp, 8
		mov	ax, [bp+arg_4]
		sub	ax, g_pSkybox1
		push	ax
		push	si
		push	word ptr g_wManySkyboxRe+2
		push	word ptr g_wManySkyboxRe
		call	DoMaybePutImage
		add	sp, 8
		mov	ax, [bp+arg_4]
		sub	ax, g_pSkybox2
		push	ax
		lea	ax, [si+140h]
		push	ax
		push	word ptr g_wManySkyboxRe+6
		push	word ptr g_wManySkyboxRe+4
		call	DoMaybePutImage
		add	sp, 8
		mov	ax, [bp+arg_4]
		sub	ax, g_pSkybox3
		push	ax
		lea	ax, [si+200h]
		push	ax
		push	word ptr g_wManySkyboxRe+0Ah
		push	word ptr g_wManySkyboxRe+8
		call	DoMaybePutImage
		add	sp, 8
		mov	ax, [bp+arg_4]
		sub	ax, g_pSkybox4
		push	ax
		lea	ax, [si+340h]
		push	ax
		push	word ptr g_wManySkyboxRe+0Eh
		push	word ptr g_wManySkyboxRe+0Ch
		call	DoMaybePutImage
		add	sp, 8
		mov	ax, [bp+arg_4]
		sub	ax, g_pSkybox1
		push	ax
		lea	ax, [si+400h]
		push	ax
		push	word ptr g_wManySkyboxRe+2
		push	word ptr g_wManySkyboxRe
		call	DoMaybePutImage
		add	sp, 8

loc_9F1_2522:				; CODE XREF: SkyboxRect+64j
					; SkyboxRect+81j ...
		mov	bx, [bp+arg_0]
		mov	ax, [bp+arg_4]
		cmp	[bx+4],	ax
		jle	short loc_9F1_2532
		mov	di, [bx+4]
		jmp	short loc_9F1_2535
; ---------------------------------------------------------------------------

loc_9F1_2532:				; CODE XREF: SkyboxRect+139j
		mov	di, [bp+arg_4]

loc_9F1_2535:				; CODE XREF: SkyboxRect+13Ej
		mov	si, [bx+6]
		sub	si, di
		or	si, si
		jle	short loc_9F1_255D
		mov	ax, di
		add	ax, si
		push	ax
		push	di
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	SetSprite1Size
		add	sp, 8
		push	g_wProbColor
		call	ClearSprite1Col
		add	sp, 2

loc_9F1_255D:				; CODE XREF: SkyboxRect+14Aj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SkyboxRect	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SkyBoxOp	proc far		; CODE XREF: UpdateFrame+F63p

var_78		= byte ptr -78h
var_76		= word ptr -76h
var_72		= word ptr -72h
var_6E		= word ptr -6Eh
var_5C		= word ptr -5Ch
var_5A		= word ptr -5Ah
var_58		= word ptr -58h
var_56		= word ptr -56h
var_54		= word ptr -54h
var_50		= word ptr -50h
var_4E		= word ptr -4Eh
var_4C		= word ptr -4Ch
var_4A		= word ptr -4Ah
var_48		= word ptr -48h
var_46		= word ptr -46h
var_44		= word ptr -44h
var_42		= word ptr -42h
var_40		= word ptr -40h
var_3E		= word ptr -3Eh
var_3C		= word ptr -3Ch
var_3A		= word ptr -3Ah
var_38		= word ptr -38h
var_34		= word ptr -34h
var_32		= word ptr -32h
rect		= Rectangle ptr	-30h
var_28		= word ptr -28h
var_26		= word ptr -26h
pVec		= Vector3D ptr -24h
pVec2		= Vector3D ptr -1Eh
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 78h
		push	di
		push	si
		mov	byte_2B77_A9F6,	0
		mov	[bp+var_5C], 0
		mov	bx, [bp+arg_2]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		cmp	[bp+arg_8], 0
		jnz	short loc_9F1_2597
		jmp	loc_9F1_2A48
; ---------------------------------------------------------------------------

loc_9F1_2597:				; CODE XREF: SkyBoxOp+2Ej
		mov	ax, 4650h
		imul	[bp+arg_4]
		mov	[bp+var_58], ax
		mov	ax, [bp+arg_C]
		neg	ax
		mov	[bp+var_56], ax
		mov	ax, offset g_pwTripleTable
		imul	[bp+arg_4]
		mov	[bp+var_54], ax
		lea	ax, [bp+pVec]
		push	ax
		push	[bp+arg_6]
		lea	ax, [bp+var_58]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, 0B9B0h
		imul	[bp+arg_4]
		mov	[bp+var_58], ax
		lea	ax, [bp+pVec2]
		push	ax
		push	[bp+arg_6]
		lea	ax, [bp+var_58]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+pVec.wZ], 0
		jl	short loc_9F1_25EC
		cmp	[bp+pVec2.wZ], 0
		jge	short loc_9F1_260C

loc_9F1_25EC:				; CODE XREF: SkyBoxOp+80j SkyBoxOp+DCj ...
		mov	di, g_wSomeClrColor

loc_9F1_25F0:				; CODE XREF: SkyBoxOp+E2j
		mov	bx, [bp+arg_2]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	di
		jmp	loc_9F1_2C5A
; ---------------------------------------------------------------------------

loc_9F1_260C:				; CODE XREF: SkyBoxOp+86j
		lea	ax, [bp+var_4E]
		push	ax
		lea	ax, [bp+pVec]
		push	ax
		call	VectorOp2
		add	sp, 4
		lea	ax, [bp+var_4A]
		push	ax
		lea	ax, [bp+pVec2]
		push	ax
		call	VectorOp2
		add	sp, 4
		cmp	[bp+var_4E], 140h
		jle	short loc_9F1_2648
		cmp	[bp+var_4A], 140h
		jle	short loc_9F1_2648
		mov	ax, [bp+var_48]
		cmp	[bp+var_4C], ax
		jl	short loc_9F1_25EC

loc_9F1_2642:				; CODE XREF: SkyBoxOp:loc_9F1_265Aj
					; SkyBoxOp+12Cj
		mov	di, g_wProbColor
		jmp	short loc_9F1_25F0
; ---------------------------------------------------------------------------

loc_9F1_2648:				; CODE XREF: SkyBoxOp+CDj SkyBoxOp+D4j
		cmp	[bp+var_4E], 0
		jge	short loc_9F1_265E
		cmp	[bp+var_4A], 0
		jge	short loc_9F1_265E
		mov	ax, [bp+var_48]
		cmp	[bp+var_4C], ax

loc_9F1_265A:				; CODE XREF: SkyBoxOp+113j
		jle	short loc_9F1_2642
		jmp	short loc_9F1_25EC
; ---------------------------------------------------------------------------

loc_9F1_265E:				; CODE XREF: SkyBoxOp+E8j SkyBoxOp+EEj
		mov	bx, [bp+arg_2]
		mov	ax, [bp+var_4C]
		cmp	[bx+6],	ax
		jge	short loc_9F1_267A
		mov	ax, [bp+var_48]
		cmp	[bx+6],	ax
		jge	short loc_9F1_267A
		mov	ax, [bp+var_4A]
		cmp	[bp+var_4E], ax
		jmp	short loc_9F1_265A
; ---------------------------------------------------------------------------
		nop

loc_9F1_267A:				; CODE XREF: SkyBoxOp+103j
					; SkyBoxOp+10Bj
		mov	ax, [bp+var_4C]
		cmp	[bx+4],	ax
		jle	short loc_9F1_2696
		mov	ax, [bp+var_48]
		cmp	[bx+4],	ax
		jle	short loc_9F1_2696
		mov	ax, [bp+var_4A]
		cmp	[bp+var_4E], ax
		jge	short loc_9F1_2642
		jmp	loc_9F1_25EC
; ---------------------------------------------------------------------------
		nop

loc_9F1_2696:				; CODE XREF: SkyBoxOp+11Cj
					; SkyBoxOp+124j
		mov	[bp+var_5A], 0
		cmp	g_wTimerFlag3, 4
		jz	short loc_9F1_270D
		cmp	[bp+var_4A], 0
		jge	short loc_9F1_270D
		cmp	[bp+var_4E], 140h
		jle	short loc_9F1_270D
		lea	ax, [bp+var_78]
		push	ax
		push	[bp+var_4C]
		push	[bp+var_4E]
		push	[bp+var_48]
		push	[bp+var_4A]
		call	ResetImageData
		add	sp, 0Ah
		or	ax, ax
		jnz	short loc_9F1_270D
		mov	di, [bp+var_72]
		sub	di, [bp+var_6E]
		jns	short loc_9F1_26DA
		mov	ax, di
		neg	ax
		jmp	short loc_9F1_26DC
; ---------------------------------------------------------------------------
		nop

loc_9F1_26DA:				; CODE XREF: SkyBoxOp+16Dj
		mov	ax, di

loc_9F1_26DC:				; CODE XREF: SkyBoxOp+173j
		cmp	ax, 60h	; '`'
		jge	short loc_9F1_270D
		cmp	[bp+var_76], 0
		jnz	short loc_9F1_26F2
		mov	ax, [bp+var_72]
		mov	[bp+var_32], ax
		mov	ax, [bp+var_6E]
		jmp	short loc_9F1_2702
; ---------------------------------------------------------------------------

loc_9F1_26F2:				; CODE XREF: SkyBoxOp+181j
		cmp	[bp+var_76], 13Fh
		jnz	short loc_9F1_270D
		mov	ax, [bp+var_6E]
		mov	[bp+var_32], ax
		mov	ax, [bp+var_72]

loc_9F1_2702:				; CODE XREF: SkyBoxOp+18Cj
		sub	ax, [bp+var_32]
		mov	[bp+var_26], ax
		mov	[bp+var_5A], 1

loc_9F1_270D:				; CODE XREF: SkyBoxOp+13Cj
					; SkyBoxOp+142j ...
		cmp	[bp+var_5A], 0
		jnz	short loc_9F1_2716
		jmp	loc_9F1_2942
; ---------------------------------------------------------------------------

loc_9F1_2716:				; CODE XREF: SkyBoxOp+1ADj
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_2720
		jmp	loc_9F1_28A6
; ---------------------------------------------------------------------------

loc_9F1_2720:				; CODE XREF: SkyBoxOp+1B7j
		mov	[bp+rect.dwLeft], 0
		mov	g_rcSomeRect.dwLeft, 0
		mov	[bp+rect.dwTop], 140h
		mov	g_rcSomeRect.dwTop, 140h
		cmp	byte_2B77_9D34,	0
		jz	short loc_9F1_2750
		mov	bx, [bp+arg_2]
		mov	ax, [bx+4]
		mov	g_rcSomeRect.dwRight, ax
		mov	ax, [bx+6]
		mov	g_rcSomeRect.dwBottom, ax
		jmp	loc_9F1_289A
; ---------------------------------------------------------------------------
		nop

loc_9F1_2750:				; CODE XREF: SkyBoxOp+1D7j
		mov	ax, [bp+var_32]
		add	ax, [bp+var_26]
		cmp	ax, [bp+var_32]
		jle	short loc_9F1_275E
		mov	ax, [bp+var_32]

loc_9F1_275E:				; CODE XREF: SkyBoxOp+1F5j
		sub	ax, word_2B77_9D5E
		mov	g_rcSomeRect.dwRight, ax
		mov	bx, [bp+arg_2]
		cmp	[bx+4],	ax
		jle	short loc_9F1_2773
		mov	ax, [bx+4]
		mov	g_rcSomeRect.dwRight, ax

loc_9F1_2773:				; CODE XREF: SkyBoxOp+207j
		mov	ax, [bp+var_32]
		add	ax, [bp+var_26]
		cmp	ax, [bp+var_32]
		jge	short loc_9F1_2781
		mov	ax, [bp+var_32]

loc_9F1_2781:				; CODE XREF: SkyBoxOp+218j
		mov	g_rcSomeRect.dwBottom, ax
		sub	si, si

loc_9F1_2786:				; CODE XREF: SkyBoxOp+22Bj
		mov	byte ptr unk_2B77_9DB0[si], 1
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_2786
		mov	g_cRectCmpFlag,	3
		mov	[bp+rect.dwRight], 0
		mov	ax, g_rcSomeRect.dwRight
		mov	[bp+rect.dwBottom], ax
		push	[bp+arg_2]
		lea	ax, [bp+rect]
		push	ax
		call	MaybeRectOp
		add	sp, 4
		or	al, al
		jnz	short loc_9F1_2818
		mov	byte_2B77_A9F6,	0
		mov	ax, offset unk_2B77_965E
		push	ax
		mov	ax, offset byte_2B77_A9F6
		push	ax
		lea	ax, [bp+rect]
		push	ax
		mov	ax, offset g_rcIntro
		push	ax
		push	g_prcMegaPoly1
		mov	ax, offset unk_2B77_9DB0
		push	ax
		mov	ax, 0Fh
		push	ax
		call	MaybeSetupRects
		add	sp, 0Eh
		sub	di, di
		jmp	short loc_9F1_2810
; ---------------------------------------------------------------------------
		nop

loc_9F1_27E2:				; CODE XREF: SkyBoxOp+2B2j
		mov	ax, di
		mov	cl, 3
		shl	ax, cl
		add	ax, offset unk_2B77_965E
		mov	[bp+var_28], ax
		mov	bx, ax
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	SetSprite1Size
		add	sp, 8
		push	g_wSomeClrColor
		call	ClearSprite1Col
		add	sp, 2
		inc	di

loc_9F1_2810:				; CODE XREF: SkyBoxOp+27Bj
		mov	al, byte_2B77_A9F6
		cbw
		cmp	ax, di
		jg	short loc_9F1_27E2

loc_9F1_2818:				; CODE XREF: SkyBoxOp+24Ej
		mov	ax, g_rcSomeRect.dwBottom
		mov	[bp+rect.dwRight], ax
		mov	[bp+rect.dwBottom], 0C8h
		push	[bp+arg_2]
		lea	ax, [bp+rect]
		push	ax
		call	MaybeRectOp
		add	sp, 4
		or	al, al
		jnz	short loc_9F1_289A
		mov	byte_2B77_A9F6,	0
		mov	ax, offset unk_2B77_965E
		push	ax
		mov	ax, offset byte_2B77_A9F6
		push	ax
		lea	ax, [bp+rect]
		push	ax
		mov	ax, offset g_rcIntro
		push	ax
		push	g_prcMegaPoly1
		mov	ax, offset unk_2B77_9DB0
		push	ax
		mov	ax, 0Fh
		push	ax
		call	MaybeSetupRects
		add	sp, 0Eh
		sub	di, di
		jmp	short loc_9F1_2892
; ---------------------------------------------------------------------------
		nop

loc_9F1_2864:				; CODE XREF: SkyBoxOp+334j
		mov	ax, di
		mov	cl, 3
		shl	ax, cl
		add	ax, offset unk_2B77_965E
		mov	[bp+var_28], ax
		mov	bx, ax
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	SetSprite1Size
		add	sp, 8
		push	g_wProbColor
		call	ClearSprite1Col
		add	sp, 2
		inc	di

loc_9F1_2892:				; CODE XREF: SkyBoxOp+2FDj
		mov	al, byte_2B77_A9F6
		cbw
		cmp	ax, di
		jg	short loc_9F1_2864

loc_9F1_289A:				; CODE XREF: SkyBoxOp+1E8j
					; SkyBoxOp+2D0j
		mov	ax, g_rcSomeRect.dwRight
		mov	[bp+rect.dwRight], ax
		mov	ax, g_rcSomeRect.dwBottom
		jmp	short loc_9F1_28B2
; ---------------------------------------------------------------------------
		nop

loc_9F1_28A6:				; CODE XREF: SkyBoxOp+1B9j
		mov	bx, [bp+arg_2]
		mov	ax, [bx+4]
		mov	[bp+rect.dwRight], ax
		mov	ax, [bx+6]

loc_9F1_28B2:				; CODE XREF: SkyBoxOp+33Fj
		mov	[bp+rect.dwBottom], ax
		mov	[bp+rect.dwLeft], 0
		mov	[bp+rect.dwTop], 140h
		push	[bp+arg_2]
		lea	ax, [bp+rect]
		push	ax
		call	MaybeRectOp
		add	sp, 4
		or	al, al
		jz	short loc_9F1_28D5
		jmp	loc_9F1_2C67
; ---------------------------------------------------------------------------

loc_9F1_28D5:				; CODE XREF: SkyBoxOp+36Cj
		mov	[bp+var_34], 0
		cmp	[bp+var_26], 0
		jge	short loc_9F1_28E8
		mov	ax, [bp+var_26]
		neg	ax
		jmp	short loc_9F1_28EB
; ---------------------------------------------------------------------------
		nop

loc_9F1_28E8:				; CODE XREF: SkyBoxOp+37Aj
		mov	ax, [bp+var_26]

loc_9F1_28EB:				; CODE XREF: SkyBoxOp+381j
		mov	di, ax
		inc	di
		cmp	di, 20h	; ' '
		jle	short loc_9F1_28F6
		mov	di, 20h	; ' '

loc_9F1_28F6:				; CODE XREF: SkyBoxOp+38Dj
		sub	si, si
		jmp	short loc_9F1_293B
; ---------------------------------------------------------------------------

loc_9F1_28FA:				; CODE XREF: SkyBoxOp+3D9j
		mov	ax, [bp+var_34]
		mov	[bp+rect.dwLeft], ax
		mov	ax, 140h
		imul	si
		add	ax, 140h
		cwd
		idiv	di
		and	ax, g_wVideoFlag2
		mov	[bp+rect.dwTop], ax
		cmp	[bp+rect.dwLeft], ax
		jz	short loc_9F1_293A
		mov	ax, [bp+var_26]
		imul	si
		cwd
		idiv	di
		add	ax, [bp+var_32]
		mov	[bp+var_50], ax
		push	ax
		push	[bp+arg_A]
		lea	ax, [bp+rect]
		push	ax
		push	cs
		call	near ptr SkyboxRect
		add	sp, 6
		mov	ax, [bp+rect.dwTop]
		mov	[bp+var_34], ax

loc_9F1_293A:				; CODE XREF: SkyBoxOp+3B1j
		inc	si

loc_9F1_293B:				; CODE XREF: SkyBoxOp+394j
		cmp	si, di
		jl	short loc_9F1_28FA
		jmp	loc_9F1_2C67
; ---------------------------------------------------------------------------

loc_9F1_2942:				; CODE XREF: SkyBoxOp+1AFj
		mov	ax, [bp+var_4C]
		sub	ax, [bp+var_48]
		push	ax
		mov	ax, [bp+var_4E]
		sub	ax, [bp+var_4A]
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		mov	si, ax
		and	si, 3FFh
		mov	[bp+var_26], 2
		jmp	short loc_9F1_29E0
; ---------------------------------------------------------------------------
		nop

loc_9F1_2966:				; CODE XREF: SkyBoxOp+488j
		mov	di, 1

loc_9F1_2969:				; CODE XREF: SkyBoxOp+48Dj
		mov	bx, [bp+var_26]
		shl	bx, 1
		mov	ax, word ptr unk_2B77_98C[bx]
		add	ax, si
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		mov	ax, 3E80h
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, di
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	cx, [bx-4Eh]
		add	cx, ax
		mov	bx, [bp+var_26]
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	[bx-4Eh], cx
		mov	bx, [bp+var_26]
		shl	bx, 1
		mov	ax, word ptr unk_2B77_98C[bx]
		add	ax, si
		push	ax
		call	LookupCos
		add	sp, 2
		push	ax
		mov	ax, 3E80h
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, di
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	cx, [bx-4Ch]
		add	cx, ax
		mov	bx, [bp+var_26]
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	[bx-4Ch], cx
		inc	[bp+var_26]

loc_9F1_29E0:				; CODE XREF: SkyBoxOp+3FFj
		cmp	[bp+var_26], 6
		jge	short loc_9F1_29F4
		cmp	[bp+var_26], 4
		jl	short loc_9F1_29EF
		jmp	loc_9F1_2966
; ---------------------------------------------------------------------------

loc_9F1_29EF:				; CODE XREF: SkyBoxOp+486j
		sub	di, di
		jmp	loc_9F1_2969
; ---------------------------------------------------------------------------

loc_9F1_29F4:				; CODE XREF: SkyBoxOp+480j
		push	[bp+var_44]
		push	[bp+var_46]
		push	[bp+var_40]
		push	[bp+var_42]
		push	[bp+var_48]
		push	[bp+var_4A]
		push	[bp+var_4C]
		push	[bp+var_4E]
		mov	ax, 4
		push	ax
		push	g_wSomeClrColor
		call	DoSpriteOp7
		add	sp, 14h
		push	[bp+var_38]
		push	[bp+var_3A]
		push	[bp+var_3C]
		push	[bp+var_3E]
		push	[bp+var_48]
		push	[bp+var_4A]
		push	[bp+var_4C]
		push	[bp+var_4E]
		mov	ax, 4
		push	ax
		push	g_wProbColor
		call	DoSpriteOp7
		add	sp, 14h
		jmp	loc_9F1_2C62
; ---------------------------------------------------------------------------
		nop

loc_9F1_2A48:				; CODE XREF: SkyBoxOp+30j
		mov	[bp+var_58], 0
		mov	ax, [bp+arg_C]
		neg	ax
		mov	[bp+var_56], ax
		mov	ax, 3A98h
		imul	[bp+arg_4]
		mov	[bp+var_54], ax
		lea	ax, [bp+pVec]
		push	ax
		push	[bp+arg_6]
		lea	ax, [bp+var_58]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+pVec.wZ], 0
		jge	short loc_9F1_2AB0
		push	g_wSomeClrColor
		call	ClearSprite1Col
		add	sp, 2
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_2A8D
		jmp	loc_9F1_2C67
; ---------------------------------------------------------------------------

loc_9F1_2A8D:				; CODE XREF: SkyBoxOp+524j
		mov	[bp+var_5C], 1
		mov	g_rcSomeRect.dwLeft, 0
		mov	g_rcSomeRect.dwTop, 140h
		mov	bx, [bp+arg_2]
		mov	ax, [bx+4]
		mov	g_rcSomeRect.dwRight, ax
		mov	ax, [bx+6]
		mov	g_rcSomeRect.dwBottom, ax
		jmp	loc_9F1_2C67
; ---------------------------------------------------------------------------

loc_9F1_2AB0:				; CODE XREF: SkyBoxOp+511j
		lea	ax, [bp+var_4E]
		push	ax
		lea	ax, [bp+pVec]
		push	ax
		call	VectorOp2
		add	sp, 4
		mov	ax, [bp+var_4C]
		mov	[bp+var_50], ax
		mov	bx, [bp+arg_2]
		cmp	[bx+4],	ax
		jle	short loc_9F1_2AD4
		mov	ax, [bx+4]
		mov	[bp+var_50], ax

loc_9F1_2AD4:				; CODE XREF: SkyBoxOp+568j
		cmp	[bp+arg_4], 1
		jz	short loc_9F1_2ADD
		jmp	loc_9F1_2BF0
; ---------------------------------------------------------------------------

loc_9F1_2ADD:				; CODE XREF: SkyBoxOp+574j
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_2B15
		cmp	g_wTimerFlag3, 4
		jnz	short loc_9F1_2AF2
		mov	ax, [bp+var_50]
		dec	ax
		jmp	short loc_9F1_2AF9
; ---------------------------------------------------------------------------
		nop

loc_9F1_2AF2:				; CODE XREF: SkyBoxOp+585j
		mov	ax, [bp+var_50]
		sub	ax, word_2B77_9D5E

loc_9F1_2AF9:				; CODE XREF: SkyBoxOp+58Bj
		mov	g_rcSomeRect.dwRight, ax
		mov	g_rcSomeRect.dwLeft, 0
		mov	g_rcSomeRect.dwTop, 140h
		mov	ax, [bp+var_50]
		mov	g_rcSomeRect.dwBottom, ax
		cmp	byte_2B77_9D34,	0
		jz	short loc_9F1_2B42

loc_9F1_2B15:				; CODE XREF: SkyBoxOp+57Ej
		mov	[bp+rect.dwLeft], 0
		mov	[bp+rect.dwTop], 140h
		mov	bx, [bp+arg_2]
		mov	ax, [bx+4]
		mov	[bp+rect.dwRight], ax
		mov	ax, [bx+6]
		mov	[bp+rect.dwBottom], ax
		push	[bp+var_50]
		push	[bp+arg_A]
		lea	ax, [bp+rect]
		push	ax
		push	cs
		call	near ptr SkyboxRect
		add	sp, 6
		jmp	loc_9F1_2C67
; ---------------------------------------------------------------------------

loc_9F1_2B42:				; CODE XREF: SkyBoxOp+5AFj
		sub	si, si

loc_9F1_2B44:				; CODE XREF: SkyBoxOp+5E9j
		mov	byte ptr unk_2B77_9DB0[si], 1
		inc	si
		cmp	si, 0Fh
		jl	short loc_9F1_2B44
		cmp	g_wTimerFlag3, 4
		jnz	short loc_9F1_2B62
		mov	bx, [bp+arg_0]
		shl	bx, 1
		mov	ax, word_2B77_AC66
		mov	word ptr unk_2B77_928C[bx], ax

loc_9F1_2B62:				; CODE XREF: SkyBoxOp+5F0j
		mov	bx, [bp+arg_0]
		shl	bx, 1
		mov	ax, [bp+arg_A]
		cmp	word ptr unk_2B77_928C[bx], ax
		jnz	short loc_9F1_2B9C
		mov	bx, g_prcMegaPoly1
		mov	ax, g_rcSomeRect.dwLeft
		cmp	[bx+(Rectangle.dwLeft+28h)], ax
		jnz	short loc_9F1_2B9C
		mov	ax, g_rcSomeRect.dwTop
		cmp	[bx+(Rectangle.dwTop+28h)], ax
		jnz	short loc_9F1_2B9C
		mov	ax, g_rcSomeRect.dwRight
		cmp	[bx+(Rectangle.dwRight+28h)], ax
		jnz	short loc_9F1_2B9C
		mov	ax, g_rcSomeRect.dwBottom
		cmp	[bx+(Rectangle.dwBottom+28h)], ax
		jnz	short loc_9F1_2B9C
		mov	g_cRectCmpFlag,	0
		jmp	short loc_9F1_2BA1
; ---------------------------------------------------------------------------
		nop

loc_9F1_2B9C:				; CODE XREF: SkyBoxOp+60Aj
					; SkyBoxOp+616j ...
		mov	g_cRectCmpFlag,	3

loc_9F1_2BA1:				; CODE XREF: SkyBoxOp+635j
		mov	byte_2B77_A9F6,	0
		mov	ax, offset unk_2B77_965E
		push	ax
		mov	ax, offset byte_2B77_A9F6
		push	ax
		push	[bp+arg_2]
		mov	ax, offset g_rcIntro
		push	ax
		push	g_prcMegaPoly1
		mov	ax, offset unk_2B77_9DB0
		push	ax
		mov	ax, 0Fh		; 15 rects, which is what g_prcMegapoly1 points	at
		push	ax
		call	MaybeSetupRects
		add	sp, 0Eh
		sub	di, di
		jmp	short loc_9F1_2BE6
; ---------------------------------------------------------------------------
		nop

loc_9F1_2BCE:				; CODE XREF: SkyBoxOp+688j
		push	[bp+var_50]
		push	[bp+arg_A]
		mov	ax, di
		mov	cl, 3
		shl	ax, cl
		add	ax, offset unk_2B77_965E
		push	ax
		push	cs
		call	near ptr SkyboxRect
		add	sp, 6
		inc	di

loc_9F1_2BE6:				; CODE XREF: SkyBoxOp+667j
		mov	al, byte_2B77_A9F6
		cbw
		cmp	ax, di
		jg	short loc_9F1_2BCE
		jmp	short loc_9F1_2C67
; ---------------------------------------------------------------------------

loc_9F1_2BF0:				; CODE XREF: SkyBoxOp+576j
		mov	si, [bp+var_50]
		mov	bx, [bp+arg_2]
		sub	si, [bx+4]
		mov	ax, [bx+6]
		sub	ax, [bx+4]
		cmp	ax, si
		jge	short loc_9F1_2C09
		mov	si, [bx+6]
		sub	si, [bx+4]

loc_9F1_2C09:				; CODE XREF: SkyBoxOp+69Dj
		or	si, si
		jle	short loc_9F1_2C31
		mov	ax, [bx+4]
		add	ax, si
		push	ax
		push	word ptr [bx+4]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	g_wProbColor
		call	ClearSprite1Col
		add	sp, 2

loc_9F1_2C31:				; CODE XREF: SkyBoxOp+6A7j
		mov	bx, [bp+arg_2]
		mov	si, [bx+6]
		sub	si, [bp+var_50]
		or	si, si
		jle	short loc_9F1_2C62
		mov	ax, [bp+var_50]
		add	ax, si
		push	ax
		push	[bp+var_50]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	g_wSomeClrColor

loc_9F1_2C5A:				; CODE XREF: SkyBoxOp+A5j
		call	ClearSprite1Col
		add	sp, 2

loc_9F1_2C62:				; CODE XREF: SkyBoxOp+4E0j
					; SkyBoxOp+6D8j
		mov	[bp+var_5C], 1

loc_9F1_2C67:				; CODE XREF: SkyBoxOp+36Ej
					; SkyBoxOp+3DBj ...
		mov	ax, [bp+var_5C]
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SkyBoxOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

NextTransShape	proc far		; CODE XREF: UpdateFrame+131Fp
					; UpdateFrame+1337p ...

vec2		= Vector3D ptr -0Ch
vec		= Vector3D ptr -6
arg_0		= word ptr  6
arg_2		= byte ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	di
		push	si
		mov	ax, g_pTransShp
		push	si
		push	di
		lea	di, [bp+vec]
		mov	si, ax
		push	ss
		pop	es
		assume es:nothing
		movsw
		movsw
		movsw
		pop	di
		pop	si
		lea	ax, [bp+vec2]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	al, g_cTransShpCounter
		cbw
		mov	si, ax
		mov	di, si
		shl	di, 1
		mov	ax, [bp+vec2.wZ]
		add	ax, [bp+arg_0]
		mov	word ptr g_pwUnk14ZTable[di], ax
		mov	al, [bp+arg_2]
		mov	byte ptr g_pcUnk14ByteTable[si], al
		mov	word ptr g_pwUnk14WordTable[di], si
		inc	g_cTransShpCounter
		add	g_pTransShp, 14h
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
NextTransShape	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoTransformShpTrk proc far		; CODE XREF: RunTracksMenu+B0P

var_42		= word ptr -42h
var_40		= word ptr -40h
pSceneShape	= word ptr -3Eh
var_3C		= byte ptr -3Ch
var_3A		= byte ptr -3Ah
var_38		= byte ptr -38h
var_36		= byte ptr -36h
var_34		= word ptr -34h
var_32		= byte ptr -32h
var_30		= word ptr -30h
var_2E		= byte ptr -2Eh
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
pMatrix		= word ptr -28h
transshp	= TransformedShape3D ptr -26h
var_12		= word ptr -12h
var_10		= byte ptr -10h
vec		= Vector3D ptr -0Ch
var_4		= word ptr -4
pSceneShape2	= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 42h
		push	di
		push	si
		mov	ax, word_2B77_9A2
		sub	ax, word_2B77_99C
		push	ax
		mov	ax, word_2B77_99E
		sub	ax, word_2B77_998
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_4], ax
		push	ax
		mov	ax, word_2B77_9A0
		sub	ax, word_2B77_99A
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		mov	[bp+var_34], ax
		mov	ax, 1
		push	ax
		sub	ax, ax
		push	ax
		push	[bp+var_34]
		push	ax
		call	MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		lea	ax, [bp+vec]
		push	ax
		push	[bp+pMatrix]
		mov	ax, offset g_vec
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		lea	ax, [bp+var_2E]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	VectorOp2
		add	sp, 4
		mov	ax, [bp+var_2C]
		mov	[bp+var_30], ax
		or	ax, ax
		jge	short loc_9F1_2D4B
		mov	[bp+var_30], 0

loc_9F1_2D4B:				; CODE XREF: DoTransformShpTrk+78j
		mov	ax, [bp+var_30]
		sub	ax, g_wCurSkybox
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	g_wSomeClrColor
		call	ClearSprite1Col
		add	sp, 2
		mov	ax, 64h		; 100
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		mov	ax, [bp+var_30]
		sub	ax, g_pSkybox3
		push	ax
		sub	ax, ax
		push	ax
		push	word ptr g_wManySkyboxRe+0Ah
		push	word ptr g_wManySkyboxRe+8
		call	DoMaybePutImage
		add	sp, 8
		mov	ax, [bp+var_30]
		sub	ax, g_pSkybox4
		push	ax
		mov	ax, 140h	; 320
		push	ax
		push	word ptr g_wManySkyboxRe+0Eh
		push	word ptr g_wManySkyboxRe+0Ch
		call	DoMaybePutImage
		add	sp, 8
		mov	ax, 0C8h	; 200
		push	ax
		push	[bp+var_30]
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	g_wProbColor
		call	ClearSprite1Col
		add	sp, 2
		mov	ax, 0C8h
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		mov	ax, 1
		push	ax
		mov	ax, offset g_rc2
		push	ax
		sub	ax, ax
		push	ax
		push	[bp+var_34]
		push	ax
		call	SelectRectRotate
		add	sp, 0Ah
		mov	[bp+transshp.vecRot.wX], 0
		mov	[bp+transshp.vecRot.wY], 0
		mov	[bp+transshp.field_10],	400h
		mov	[bp+var_38], 0
		jmp	loc_9F1_320B
; ---------------------------------------------------------------------------
		nop

loc_9F1_2E24:				; CODE XREF: DoTransformShpTrk+536j
		mov	[bp+var_3A], 0
		mov	[bp+var_10], 0

loc_9F1_2E2C:				; CODE XREF: DoTransformShpTrk+500j
					; DoTransformShpTrk+52Ej ...
		cmp	[bp+var_3A], 6
		jz	short loc_9F1_2E35
		jmp	loc_9F1_2EF4
; ---------------------------------------------------------------------------

loc_9F1_2E35:				; CODE XREF: DoTransformShpTrk+164j
		mov	di, word_2B77_17A
		cmp	[bp+var_10], 0
		jz	short loc_9F1_2E43

loc_9F1_2E3F:				; CODE XREF: DoTransformShpTrk+2FAj
		mov	[bp+var_3A], 0

loc_9F1_2E43:				; CODE XREF: DoTransformShpTrk+171j
					; DoTransformShpTrk+234j ...
		cmp	[bp+var_3A], 0
		jz	short loc_9F1_2EBA
		mov	al, [bp+var_3A]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes2
		mov	[bp+pSceneShape], ax
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		mov	[bp+transshp.pShape3D],	ax
		mov	al, [bp+var_32]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		sub	ax, word_2B77_998
		sar	ax, 1
		mov	[bp+transshp.vecPos.wX], ax
		mov	ax, di
		sub	ax, word_2B77_99A
		sar	ax, 1
		mov	[bp+transshp.vecPos.wY], ax
		mov	al, [bp+var_38]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		sub	ax, word_2B77_99C
		sar	ax, 1
		mov	[bp+transshp.vecPos.wZ], ax
		mov	bx, [bp+pSceneShape]
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	[bp+transshp.vecRot.wZ], ax
		mov	[bp+transshp.cFlags], 5
		mov	[bp+transshp.cMaterial], 0
		lea	ax, [bp+transshp]
		push	ax
		call	TransformedShapeOp
		add	sp, 2

loc_9F1_2EBA:				; CODE XREF: DoTransformShpTrk+17Bj
		cmp	[bp+var_10], 0
		jnz	short loc_9F1_2EC3
		jmp	loc_9F1_3176
; ---------------------------------------------------------------------------

loc_9F1_2EC3:				; CODE XREF: DoTransformShpTrk+1F2j
		mov	al, [bp+var_10]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneShape], ax
		mov	bx, ax
		test	[bx+SceneShape3D.cTranslateFlag], 1
		jnz	short loc_9F1_2EE5
		jmp	loc_9F1_3004
; ---------------------------------------------------------------------------

loc_9F1_2EE5:				; CODE XREF: DoTransformShpTrk+214j
		mov	al, [bp+var_38]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wTrackPos[bx]
		jmp	loc_9F1_3010
; ---------------------------------------------------------------------------

loc_9F1_2EF4:				; CODE XREF: DoTransformShpTrk+166j
		sub	di, di
		mov	al, [bp+var_10]
		sub	ah, ah
		cmp	ax, 69h	; 'i'
		jnb	short loc_9F1_2F03
		jmp	loc_9F1_2E43
; ---------------------------------------------------------------------------

loc_9F1_2F03:				; CODE XREF: DoTransformShpTrk+232j
		cmp	ax, 6Ch	; 'l'
		jbe	short loc_9F1_2F0B
		jmp	loc_9F1_2E43
; ---------------------------------------------------------------------------

loc_9F1_2F0B:				; CODE XREF: DoTransformShpTrk+23Aj
		mov	[bp+var_2A], di
		jmp	loc_9F1_2FC0
; ---------------------------------------------------------------------------
		nop

loc_9F1_2F12:				; CODE XREF: DoTransformShpTrk+304j
		mov	al, [bp+var_32]

loc_9F1_2F15:				; CODE XREF: DoTransformShpTrk+31Fj
		mov	[bp+var_36], al
		mov	al, [bp+var_38]

loc_9F1_2F1B:				; CODE XREF: DoTransformShpTrk+32Dj
		mov	[bp+var_3C], al

loc_9F1_2F1E:				; CODE XREF: DoTransformShpTrk+316j
		mov	al, [bp+var_36]
		cbw
		mov	[bp+var_42], ax
		mov	al, [bp+var_3C]
		cbw
		shl	ax, 1
		mov	[bp+var_40], ax
		mov	bx, ax
		mov	bx, g_wTerrainRows[bx]
		add	bx, [bp+var_42]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+var_3A], al
		or	al, al
		jz	short loc_9F1_2FBD
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes2
		mov	[bp+pSceneShape], ax
		mov	bx, ax
		mov	ax, [bx+SceneShape3D.pShape3D]
		mov	[bp+transshp.pShape3D],	ax
		mov	bx, [bp+var_42]
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		sub	ax, word_2B77_998
		sar	ax, 1
		mov	[bp+transshp.vecPos.wX], ax
		mov	ax, word_2B77_99A
		neg	ax
		sar	ax, 1
		mov	[bp+transshp.vecPos.wY], ax
		mov	bx, [bp+var_40]
		mov	ax, word ptr g_wTrackCenPos[bx]
		sub	ax, word_2B77_99C
		sar	ax, 1
		mov	[bp+transshp.vecPos.wZ], ax
		mov	[bp+transshp.cFlags], 5
		mov	[bp+transshp.vecRot.wX], 0
		mov	[bp+transshp.vecRot.wY], 0
		mov	bx, [bp+pSceneShape]
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	[bp+transshp.vecRot.wZ], ax
		mov	[bp+transshp.field_10],	400h
		mov	[bp+transshp.cMaterial], 0
		lea	ax, [bp+transshp]
		push	ax
		call	TransformedShapeOp
		add	sp, 2

loc_9F1_2FBD:				; CODE XREF: DoTransformShpTrk+27Bj
		inc	[bp+var_2A]

loc_9F1_2FC0:				; CODE XREF: DoTransformShpTrk+242j
		cmp	[bp+var_2A], 4
		jl	short loc_9F1_2FC9
		jmp	loc_9F1_2E3F
; ---------------------------------------------------------------------------

loc_9F1_2FC9:				; CODE XREF: DoTransformShpTrk+2F8j
		mov	ax, [bp+var_2A]
		or	ax, ax
		jnz	short loc_9F1_2FD3
		jmp	loc_9F1_2F12
; ---------------------------------------------------------------------------

loc_9F1_2FD3:				; CODE XREF: DoTransformShpTrk+302j
		cmp	ax, 1
		jz	short loc_9F1_2FE6
		cmp	ax, 2
		jz	short loc_9F1_2FEE
		cmp	ax, 3
		jz	short loc_9F1_2FFC
		jmp	loc_9F1_2F1E
; ---------------------------------------------------------------------------
		nop

loc_9F1_2FE6:				; CODE XREF: DoTransformShpTrk+30Aj
		mov	al, [bp+var_32]
		inc	al
		jmp	loc_9F1_2F15
; ---------------------------------------------------------------------------

loc_9F1_2FEE:				; CODE XREF: DoTransformShpTrk+30Fj
		mov	al, [bp+var_32]

loc_9F1_2FF1:				; CODE XREF: DoTransformShpTrk+335j
		mov	[bp+var_36], al
		mov	al, [bp+var_38]
		inc	al
		jmp	loc_9F1_2F1B
; ---------------------------------------------------------------------------

loc_9F1_2FFC:				; CODE XREF: DoTransformShpTrk+314j
		mov	al, [bp+var_32]
		inc	al
		jmp	short loc_9F1_2FF1
; ---------------------------------------------------------------------------
		nop

loc_9F1_3004:				; CODE XREF: DoTransformShpTrk+216j
		mov	al, [bp+var_38]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]

loc_9F1_3010:				; CODE XREF: DoTransformShpTrk+225j
		mov	[bp+var_12], ax
		mov	bx, [bp+pSceneShape]
		test	[bx+SceneShape3D.cTranslateFlag], 2
		jz	short loc_9F1_302A
		mov	al, [bp+var_32]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	si, (g_wMoreTrackPos+2)[bx]
		jmp	short loc_9F1_3036
; ---------------------------------------------------------------------------

loc_9F1_302A:				; CODE XREF: DoTransformShpTrk+34Ej
		mov	al, [bp+var_32]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	si, g_wMoreTrkCenPo[bx]

loc_9F1_3036:				; CODE XREF: DoTransformShpTrk+35Cj
		mov	ax, si
		sub	ax, word_2B77_998
		sar	ax, 1
		mov	[bp+vec.wX], ax
		mov	ax, di
		sub	ax, word_2B77_99A
		sar	ax, 1
		mov	[bp+vec.wY], ax
		mov	ax, [bp+var_12]
		sub	ax, word_2B77_99C
		sar	ax, 1
		mov	[bp+vec.wZ], ax
		or	di, di
		jz	short loc_9F1_30AF
		mov	bx, [bp+pSceneShape]
		mov	al, [bx+SceneShape3D.cTranslateFlag]
		cbw
		or	ax, ax
		jz	short loc_9F1_3082
		cmp	ax, 1
		jnz	short loc_9F1_306F
		jmp	loc_9F1_310A
; ---------------------------------------------------------------------------

loc_9F1_306F:				; CODE XREF: DoTransformShpTrk+39Ej
		cmp	ax, 2
		jnz	short loc_9F1_3077
		jmp	loc_9F1_3112
; ---------------------------------------------------------------------------

loc_9F1_3077:				; CODE XREF: DoTransformShpTrk+3A6j
		cmp	ax, 3
		jnz	short loc_9F1_307F
		jmp	loc_9F1_311A
; ---------------------------------------------------------------------------

loc_9F1_307F:				; CODE XREF: DoTransformShpTrk+3AEj
		jmp	short loc_9F1_3087
; ---------------------------------------------------------------------------
		nop

loc_9F1_3082:				; CODE XREF: DoTransformShpTrk+399j
		mov	[bp+transshp.pShape3D],	(offset	g_pGame3DShapes.wNumVerts+3B2h)

loc_9F1_3087:				; CODE XREF: DoTransformShpTrk:loc_9F1_307Fj
					; DoTransformShpTrk+443j ...
		push	si
		push	di
		lea	di, [bp+transshp]
		lea	si, [bp+vec]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	[bp+transshp.vecRot.wZ], 0
		mov	[bp+transshp.cFlags], 5
		mov	[bp+transshp.cMaterial], 0
		lea	ax, [bp+transshp]
		push	ax
		call	TransformedShapeOp
		add	sp, 2

loc_9F1_30AF:				; CODE XREF: DoTransformShpTrk+38Ej
		mov	bx, [bp+pSceneShape]
		cmp	[bx+SceneShape3D.field_8], 0
		jz	short loc_9F1_3132
		mov	al, [bx+SceneShape3D.field_8]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneShape2], ax
		mov	bx, ax
		cmp	[bx+SceneShape3D.pLoPolyShape3D], 0
		jz	short loc_9F1_3132
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		mov	[bp+transshp.pShape3D],	ax
		push	si
		push	di
		lea	di, [bp+transshp]
		lea	si, [bp+vec]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, [bp+pSceneShape]
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	[bp+transshp.vecRot.wZ], ax
		mov	[bp+transshp.cFlags], 5
		mov	bx, [bp+pSceneShape2]
		cmp	[bx+SceneShape3D.cMaterial], 0
		jl	short loc_9F1_3122
		mov	al, [bx+SceneShape3D.cMaterial]
		mov	[bp+transshp.cMaterial], al
		jmp	short loc_9F1_3126
; ---------------------------------------------------------------------------

loc_9F1_310A:				; CODE XREF: DoTransformShpTrk+3A0j
		mov	[bp+transshp.pShape3D],	(offset	stru_2B77_7A98.wNumVerts+386h)
		jmp	loc_9F1_3087
; ---------------------------------------------------------------------------

loc_9F1_3112:				; CODE XREF: DoTransformShpTrk+3A8j
		mov	[bp+transshp.pShape3D],	(offset	stru_2B77_7A98.wNumVerts+39Ch)
		jmp	loc_9F1_3087
; ---------------------------------------------------------------------------

loc_9F1_311A:				; CODE XREF: DoTransformShpTrk+3B0j
		mov	[bp+transshp.pShape3D],	(offset	stru_2B77_7A98.wNumVerts+3B2h)
		jmp	loc_9F1_3087
; ---------------------------------------------------------------------------

loc_9F1_3122:				; CODE XREF: DoTransformShpTrk+434j
		mov	[bp+transshp.cMaterial], 0

loc_9F1_3126:				; CODE XREF: DoTransformShpTrk+43Cj
		lea	ax, [bp+transshp]
		push	ax
		call	TransformedShapeOp
		add	sp, 2

loc_9F1_3132:				; CODE XREF: DoTransformShpTrk+3EAj
					; DoTransformShpTrk+409j
		mov	bx, [bp+pSceneShape]
		mov	ax, [bx+SceneShape3D.pLoPolyShape3D]
		mov	[bp+transshp.pShape3D],	ax
		push	si
		push	di
		lea	di, [bp+transshp]
		lea	si, [bp+vec]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	[bp+transshp.vecRot.wZ], ax
		mov	al, [bx+SceneShape3D.field_A]
		or	al, 4
		mov	[bp+transshp.cFlags], al
		cmp	[bx+SceneShape3D.cMaterial], 0
		jl	short loc_9F1_3166
		mov	al, [bx+SceneShape3D.cMaterial]
		mov	[bp+transshp.cMaterial], al
		jmp	short loc_9F1_316A
; ---------------------------------------------------------------------------

loc_9F1_3166:				; CODE XREF: DoTransformShpTrk+490j
		mov	[bp+transshp.cMaterial], 0

loc_9F1_316A:				; CODE XREF: DoTransformShpTrk+498j
		lea	ax, [bp+transshp]
		push	ax
		call	TransformedShapeOp
		add	sp, 2

loc_9F1_3176:				; CODE XREF: DoTransformShpTrk+1F4j
		call	sub_14D6_1296
		inc	[bp+var_32]

loc_9F1_317E:				; CODE XREF: DoTransformShpTrk+549j
		cmp	[bp+var_32], 1Eh
		jl	short loc_9F1_3187
		jmp	loc_9F1_3208
; ---------------------------------------------------------------------------

loc_9F1_3187:				; CODE XREF: DoTransformShpTrk+4B6j
		mov	al, [bp+var_32]
		cbw
		mov	[bp+var_40], ax
		mov	al, [bp+var_38]
		cbw
		shl	ax, 1
		mov	[bp+var_42], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, [bp+var_40]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+var_10], al
		mov	bx, [bp+var_42]
		mov	bx, g_wTerrainRows[bx]
		add	bx, [bp+var_40]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+var_3A], al
		cmp	[bp+var_10], 0
		jnz	short loc_9F1_31CF
		jmp	loc_9F1_2E2C
; ---------------------------------------------------------------------------

loc_9F1_31CF:				; CODE XREF: DoTransformShpTrk+4FEj
		cmp	al, 7
		jb	short loc_9F1_31F0
		cmp	al, 0Bh
		jnb	short loc_9F1_31F0
		mov	al, [bp+var_10]
		sub	ah, ah
		push	ax
		mov	al, [bp+var_3A]
		push	ax
		call	MapTerrainTrack
		add	sp, 4
		mov	[bp+var_10], al
		mov	[bp+var_3A], 0

loc_9F1_31F0:				; CODE XREF: DoTransformShpTrk+505j
					; DoTransformShpTrk+509j
		mov	al, [bp+var_10]
		sub	ah, ah
		cmp	ax, 0FDh ; 'ý'
		jnb	short loc_9F1_31FD
		jmp	loc_9F1_2E2C
; ---------------------------------------------------------------------------

loc_9F1_31FD:				; CODE XREF: DoTransformShpTrk+52Cj
		cmp	ax, 0FFh
		ja	short loc_9F1_3205
		jmp	loc_9F1_2E24
; ---------------------------------------------------------------------------

loc_9F1_3205:				; CODE XREF: DoTransformShpTrk+534j
		jmp	loc_9F1_2E2C
; ---------------------------------------------------------------------------

loc_9F1_3208:				; CODE XREF: DoTransformShpTrk+4B8j
		inc	[bp+var_38]

loc_9F1_320B:				; CODE XREF: DoTransformShpTrk+154j
		cmp	[bp+var_38], 1Eh
		jge	short loc_9F1_3218
		mov	[bp+var_32], 0
		jmp	loc_9F1_317E
; ---------------------------------------------------------------------------

loc_9F1_3218:				; CODE XREF: DoTransformShpTrk+543j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoTransformShpTrk endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DrawIngameText	proc far		; CODE XREF: UpdateFrame+2177p
					; UpdateFrame+2205p
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		push	si
		mov	di, offset g_rc3
		mov	si, offset g_rc1
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	si
		cmp	g_cTimerOverrun, 0
		jnz	short loc_9F1_323E
		jmp	loc_9F1_32D6
; ---------------------------------------------------------------------------

loc_9F1_323E:				; CODE XREF: DrawIngameText+1Bj
		mov	ax, offset aDm1	; "Professional	Driver"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0AAh ; 'ª'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6
		mov	ax, offset aDm2	; "on Closed Circuit"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0B6h ; '¶'

loc_9F1_32C5:				; CODE XREF: DrawIngameText+F9j
					; DrawIngameText+18Dj ...
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		jmp	loc_9F1_3601
; ---------------------------------------------------------------------------
		nop

loc_9F1_32D6:				; CODE XREF: DrawIngameText+1Dj
		cmp	g_cGameMode2, 0
		jz	short loc_9F1_32E0
		jmp	loc_9F1_35A0
; ---------------------------------------------------------------------------

loc_9F1_32E0:				; CODE XREF: DrawIngameText+BDj
		cmp	gameState.cCvxFlag2, 0
		jnz	short loc_9F1_331A
		mov	ax, offset aPre	; "Fasten your seatbelt!"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 5Ah	; 'Z'
		jmp	short loc_9F1_32C5
; ---------------------------------------------------------------------------
		nop

loc_9F1_331A:				; CODE XREF: DrawIngameText+C7j
		cmp	g_bPassedSecuri, 0
		jz	short loc_9F1_3324
		jmp	loc_9F1_33AE
; ---------------------------------------------------------------------------

loc_9F1_3324:				; CODE XREF: DrawIngameText+101j
		mov	ax, offset aSe1	; "You forgot to disable the"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 5Dh	; ']'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6
		mov	ax, offset aSe2	; "Car's security system first"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 69h	; 'i'
		jmp	loc_9F1_32C5
; ---------------------------------------------------------------------------

loc_9F1_33AE:				; CODE XREF: DrawIngameText+103j
		cmp	byte_2B77_AC70,	0
		jz	short loc_9F1_33B8
		jmp	loc_9F1_361B
; ---------------------------------------------------------------------------

loc_9F1_33B8:				; CODE XREF: DrawIngameText+195j
		cmp	g_cCameraMode, 0
		jz	short loc_9F1_33C2
		jmp	loc_9F1_361B
; ---------------------------------------------------------------------------

loc_9F1_33C2:				; CODE XREF: DrawIngameText+19Fj
		cmp	gameState.carPlayer.field_C9, 0
		jz	short loc_9F1_33CC
		jmp	loc_9F1_361B
; ---------------------------------------------------------------------------

loc_9F1_33CC:				; CODE XREF: DrawIngameText+1A9j
		mov	al, gameState.field_45D
		cbw
		cmp	ax, 1
		jz	short loc_9F1_33E2
		cmp	ax, 2
		jz	short loc_9F1_3428
		cmp	ax, 3
		jz	short loc_9F1_343A
		jmp	short loc_9F1_340E
; ---------------------------------------------------------------------------
		nop

loc_9F1_33E2:				; CODE XREF: DrawIngameText+1B5j
		mov	ax, 5Dh	; ']'
		push	ax
		mov	ax, 94h	; '”'
		push	ax
		push	g_pwManyExRes+0Eh
		push	g_pwManyExRes+0Ch

loc_9F1_33F2:				; CODE XREF: DrawIngameText+21Aj
		call	Sprite1Op2
		add	sp, 8
		mov	ax, offset g_rc3
		push	ax
		mov	ax, 9DAh

loc_9F1_3401:				; CODE XREF: DrawIngameText+266j
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6

loc_9F1_340E:				; CODE XREF: DrawIngameText+1C1j
		mov	g_pTempByte, 0
		mov	al, gameState.field_45E
		cbw
		cmp	ax, 1
		jz	short loc_9F1_3488
		cmp	ax, 2
		jnz	short loc_9F1_3424
		jmp	loc_9F1_356E
; ---------------------------------------------------------------------------

loc_9F1_3424:				; CODE XREF: DrawIngameText+201j
		jmp	loc_9F1_34D6
; ---------------------------------------------------------------------------
		nop

loc_9F1_3428:				; CODE XREF: DrawIngameText+1BAj
		mov	ax, 5Dh	; ']'
		push	ax
		mov	ax, 94h	; '”'
		push	ax
		push	g_pwManyExRes+12h
		push	g_pwManyExRes+10h
		jmp	short loc_9F1_33F2
; ---------------------------------------------------------------------------

loc_9F1_343A:				; CODE XREF: DrawIngameText+1BFj
		mov	ax, offset aWww	; "Wrong Way"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 5Dh	; ']'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		jmp	loc_9F1_3401
; ---------------------------------------------------------------------------
		nop

loc_9F1_3488:				; CODE XREF: DrawIngameText+1FCj
		mov	ax, 71h	; 'q'
		push	ax
		mov	ax, 44h	; 'D'
		push	ax
		push	g_pwManyExRes+0Eh
		push	g_pwManyExRes+0Ch
		call	Sprite1Op2
		add	sp, 8
		mov	ax, offset g_rc3
		push	ax
		mov	ax, offset unk_2B77_9E2
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6
		mov	ax, offset aOpp	; "Opponent Near"

loc_9F1_34B7:				; CODE XREF: DrawIngameText+37Fj
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6

loc_9F1_34D6:				; CODE XREF: DrawIngameText:loc_9F1_3424j
		cmp	g_pTempByte, 0
		jz	short loc_9F1_3512
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 74h	; 't'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6

loc_9F1_3512:				; CODE XREF: DrawIngameText+2BDj
		cmp	g_wFpsMul4, 0
		jnz	short loc_9F1_351C
		jmp	loc_9F1_361B
; ---------------------------------------------------------------------------

loc_9F1_351C:				; CODE XREF: DrawIngameText+2F9j
		mov	ax, offset aPen	; Penalty Time =
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFpsMul2
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		add	ax, offset g_pTempByte
		push	ax
		call	FormatString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 66h	; 'f'
		jmp	loc_9F1_32C5
; ---------------------------------------------------------------------------

loc_9F1_356E:				; CODE XREF: DrawIngameText+203j
		mov	ax, 71h	; 'q'
		push	ax
		mov	ax, 0E4h ; 'ä'
		push	ax
		push	g_pwManyExRes+12h
		push	g_pwManyExRes+10h
		call	Sprite1Op2
		add	sp, 8
		mov	ax, offset g_rc3
		push	ax
		mov	ax, 9EAh
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6
		mov	ax, 9CEh
		jmp	loc_9F1_34B7
; ---------------------------------------------------------------------------

loc_9F1_35A0:				; CODE XREF: DrawIngameText+BFj
		cmp	g_cGameMode2, 2
		jnz	short loc_9F1_361B
		mov	ax, gameState.wGameFrame
		sub	dx, dx
		div	g_wFramesPerSec
		mov	si, dx
		mov	ax, g_wFramesPerSec
		sar	ax, 1
		cmp	ax, si
		jle	short loc_9F1_361B
		mov	ax, offset aRpl	; blinking "Replay" text
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_rc3
		push	ax
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 0Fh
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		mov	cl, 3
		shl	ax, cl
		sub	ax, 138h
		neg	ax

loc_9F1_3601:				; CODE XREF: DrawIngameText+B4j
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		mov	ax, offset g_rc3
		push	ax
		call	MinMaxRect
		add	sp, 6

loc_9F1_361B:				; CODE XREF: DrawIngameText+197j
					; DrawIngameText+1A1j ...
		mov	ax, offset g_rc3
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DrawIngameText	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_9F1_3624	proc far		; CODE XREF: UpdateFrame+20B3p
					; UpdateFrame+20CCp

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		mov	di, g_wFramesPerSec
		mov	cl, 2
		shl	di, cl
		cmp	[bp+arg_0], di
		jle	short loc_9F1_363C
		mov	[bp+arg_0], di

loc_9F1_363C:				; CODE XREF: sub_9F1_3624+13j
		mov	ax, g_wFramesPerSec
		shl	ax, 1
		shl	ax, 1
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_0]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_4]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	si, ax
		mov	g_rc3.dwLeft, 0
		mov	g_rc3.dwTop, 140h
		mov	di, [bp+arg_2]
		add	di, [bp+arg_4]
		mov	ax, di
		sub	ax, si
		mov	g_rc3.dwRight, ax
		mov	g_rc3.dwBottom,	di
		push	di
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	word_2B77_AC72
		call	ClearSprite1Col
		add	sp, 2
		mov	ax, offset g_rc3
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_9F1_3624	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoCracCinfRes	proc far		; CODE XREF: UpdateFrame+205Fp
					; UpdateFrame+2082p

var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 1Ah
		push	di
		push	si
		mov	ax, offset aCrak ; "crak"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	AltLocateShape
		add	sp, 6
		mov	word ptr [bp+var_8], ax
		mov	word ptr [bp+var_8+2], dx
		mov	ax, offset aCinf ; "cinf"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	AltLocateShape
		add	sp, 6
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		mov	ax, g_wFramesPerSec
		cwd
		mov	cx, 7
		idiv	cx
		mov	cx, ax
		mov	ax, [bp+arg_0]
		cwd
		idiv	cx
		mov	[bp+var_1A], ax
		les	bx, [bp+var_4]
		assume es:nothing
		mov	di, es:[bx]
		cmp	ax, di
		jl	short loc_9F1_3704
		lea	ax, [di-1]
		mov	[bp+var_1A], ax

loc_9F1_3704:				; CODE XREF: DoCracCinfRes+58j
		mov	di, [bp+var_1A]
		shl	di, 1
		les	bx, [bp+var_4]
		mov	ax, es:[bx+di+2]
		mov	[bp+var_18], ax
		push	si
		mov	di, offset g_rc3
		mov	si, offset g_rc1
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	si
		sub	si, si
		jmp	loc_9F1_3880
; ---------------------------------------------------------------------------

loc_9F1_3726:				; CODE XREF: DoCracCinfRes+1E1j
		mov	di, si
		mov	cl, 3
		shl	di, cl
		les	bx, [bp+var_8]
		assume es:nothing
		mov	ax, es:[bx+di]
		mov	dx, es:[bx+di+2]
		mov	[bp+var_10], ax
		mov	[bp+var_E], dx
		mov	bx, si
		shl	bx, cl
		mov	di, word ptr [bp+var_8]
		mov	ax, es:[bx+di+4]
		mov	dx, es:[bx+di+6]
		mov	[bp+var_14], ax
		mov	[bp+var_12], dx
		mov	ax, 0C8h ; 'È'
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_4]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_E]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+var_E], ax
		mov	ax, 0C8h ; 'È'
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_4]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_12]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+var_12], ax
		sub	ax, ax
		push	ax
		mov	ax, [bp+var_12]
		add	ax, [bp+arg_2]
		dec	ax
		push	ax
		push	[bp+var_14]
		mov	ax, [bp+var_E]
		add	ax, [bp+arg_2]
		dec	ax
		push	ax
		push	[bp+var_10]
		call	ImageResetRende
		add	sp, 0Ah
		sub	ax, ax
		push	ax
		mov	ax, [bp+var_12]
		add	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+var_14]
		mov	ax, [bp+var_E]
		add	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+var_10]
		call	ImageResetRende
		add	sp, 0Ah
		push	g_wFontFlag
		mov	ax, [bp+var_12]
		add	ax, [bp+arg_2]
		push	ax
		push	[bp+var_14]
		mov	ax, [bp+var_E]
		add	ax, [bp+arg_2]
		push	ax
		push	[bp+var_10]
		call	ImageResetRende
		add	sp, 0Ah
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_37FF
		jmp	loc_9F1_387F
; ---------------------------------------------------------------------------

loc_9F1_37FF:				; CODE XREF: DoCracCinfRes+156j
		mov	ax, [bp+var_10]
		mov	[bp+var_C], ax
		mov	ax, [bp+var_E]
		add	ax, [bp+arg_2]
		dec	ax
		mov	[bp+var_A], ax
		mov	ax, offset g_rc3
		push	ax
		lea	ax, [bp+var_C]
		push	ax
		call	RectOp
		add	sp, 4
		mov	ax, [bp+var_14]
		mov	[bp+var_C], ax
		mov	ax, [bp+var_12]
		add	ax, [bp+arg_2]
		inc	ax
		mov	[bp+var_A], ax
		mov	ax, offset g_rc3
		push	ax
		lea	ax, [bp+var_C]
		push	ax
		call	RectOp
		add	sp, 4
		mov	ax, [bp+var_10]
		mov	[bp+var_C], ax
		mov	ax, [bp+var_E]
		add	ax, [bp+arg_2]
		inc	ax
		mov	[bp+var_A], ax
		mov	ax, offset g_rc3
		push	ax
		lea	ax, [bp+var_C]
		push	ax
		call	RectOp
		add	sp, 4
		mov	ax, [bp+var_14]
		mov	[bp+var_C], ax
		mov	ax, [bp+var_12]
		add	ax, [bp+arg_2]
		dec	ax
		mov	[bp+var_A], ax
		mov	ax, offset g_rc3
		push	ax
		lea	ax, [bp+var_C]
		push	ax
		call	RectOp
		add	sp, 4

loc_9F1_387F:				; CODE XREF: DoCracCinfRes+158j
		inc	si

loc_9F1_3880:				; CODE XREF: DoCracCinfRes+7Fj
		cmp	[bp+var_18], si
		jle	short loc_9F1_3888
		jmp	loc_9F1_3726
; ---------------------------------------------------------------------------

loc_9F1_3888:				; CODE XREF: DoCracCinfRes+1DFj
		mov	ax, offset g_rc3
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoCracCinfRes	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadSkybox	proc far		; CODE XREF: RunTracksMenu+5BP
					; SetupCarGameEtc+233P

var_4		= word ptr -4
arg_0		= byte ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		test	[bp+arg_0], 8
		jz	short loc_9F1_38A6
		and	[bp+arg_0], 7
		jmp	loc_9F1_397E
; ---------------------------------------------------------------------------

loc_9F1_38A6:				; CODE XREF: LoadSkybox+Bj
		cmp	byte_2B77_186, 0
		jz	short loc_9F1_38B8
		mov	al, byte_2B77_A9F7
		cmp	[bp+arg_0], al
		jnz	short loc_9F1_38B8
		jmp	loc_9F1_399F
; ---------------------------------------------------------------------------

loc_9F1_38B8:				; CODE XREF: LoadSkybox+19j
					; LoadSkybox+21j
		push	cs
		call	near ptr UnloadSkybox
		mov	al, [bp+arg_0]
		mov	byte_2B77_A9F7,	al
		mov	byte_2B77_186, 1
		cbw
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, offset aDesert ; "desert"
		push	ax
		call	far ptr	j__Load2DShape_1
		add	sp, 2
		mov	word ptr g_pSkyboxRes, ax
		mov	word ptr g_pSkyboxRes+2, dx
		mov	ax, offset g_wManySkyboxRe
		push	ax
		mov	ax, offset aScensce2sce3sc ; "scensce2sce3sce4"
		push	ax
		push	dx
		push	word ptr g_pSkyboxRes
		call	LocateManyResou
		add	sp, 8
		les	bx, g_wManySkyboxRe
		mov	ax, es:[bx+2]
		mov	g_pSkybox1, ax
		les	bx, g_wManySkyboxRe+4
		mov	ax, es:[bx+2]
		mov	g_pSkybox2, ax
		les	bx, g_wManySkyboxRe+8
		mov	ax, es:[bx+2]
		mov	g_pSkybox3, ax
		les	bx, g_wManySkyboxRe+0Ch
		mov	ax, es:[bx+2]
		mov	g_pSkybox4, ax
		mov	si, g_pSkybox1
		mov	ax, si
		cmp	ax, g_pSkybox2
		jbe	short loc_9F1_3936
		mov	si, g_pSkybox2

loc_9F1_3936:				; CODE XREF: LoadSkybox+9Ej
		mov	ax, si
		cmp	ax, g_pSkybox3
		jbe	short loc_9F1_3942
		mov	si, g_pSkybox3

loc_9F1_3942:				; CODE XREF: LoadSkybox+AAj
		mov	ax, si
		cmp	ax, g_pSkybox4
		jbe	short loc_9F1_394E
		mov	si, g_pSkybox4

loc_9F1_394E:				; CODE XREF: LoadSkybox+B6j
		mov	g_wCurSkybox, si
		mov	si, g_pSkybox1
		mov	ax, si
		cmp	ax, g_pSkybox2
		jnb	short loc_9F1_3962
		mov	si, g_pSkybox2

loc_9F1_3962:				; CODE XREF: LoadSkybox+CAj
		mov	ax, si
		cmp	ax, g_pSkybox3
		jnb	short loc_9F1_396E
		mov	si, g_pSkybox3

loc_9F1_396E:				; CODE XREF: LoadSkybox+D6j
		mov	ax, si
		cmp	ax, g_pSkybox4
		jnb	short loc_9F1_397A
		mov	si, g_pSkybox4

loc_9F1_397A:				; CODE XREF: LoadSkybox+E2j
		mov	word_2B77_9D5E,	si

loc_9F1_397E:				; CODE XREF: LoadSkybox+11j
		mov	ax, g_wVideoConst1
		mov	[bp+var_4], ax
		mov	bx, ax
		mov	ax, [bx+22h]
		mov	g_wSomeClrColor, ax
		mov	ax, [bx+20h]
		mov	g_wProbColor, ax
		mov	ax, [bx+0C8h]
		mov	word_2B77_AC72,	ax
		mov	ax, g_wFontFlag
		mov	word_2B77_95F0,	ax

loc_9F1_399F:				; CODE XREF: LoadSkybox+23j
		pop	si
		mov	sp, bp
		pop	bp
		retf
LoadSkybox	endp


; =============== S U B	R O U T	I N E =======================================


UnloadSkybox	proc far		; CODE XREF: RunTracksMenu+BAP
					; LoadSkybox+27p ...
		cmp	byte_2B77_186, 0
		jz	short loc_9F1_39BB
		push	word ptr g_pSkyboxRes+2
		push	word ptr g_pSkyboxRes
		call	UnloadResource
		add	sp, 4

loc_9F1_39BB:				; CODE XREF: UnloadSkybox+5j
		mov	byte_2B77_186, 0
		retf
UnloadSkybox	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadSdgame2Shap	proc far		; CODE XREF: SetupCarGameEtc+222P
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		mov	ax, offset aSdgame2 ; "sdgame2"
		push	ax
		mov	ax, 8
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr g_dwSgGameRes,	ax
		mov	word ptr g_dwSgGameRes+2, dx
		mov	ax, offset g_pwManyExRes
		push	ax
		mov	ax, offset aEx01ex02ex03le ; "ex01ex02ex03leftrigh"
		push	ax
		push	dx
		push	word ptr g_dwSgGameRes
		call	LocateManyResou
		add	sp, 8
		sub	si, si

loc_9F1_39F8:				; CODE XREF: LoadSdgame2Shap+4Fj
		mov	bx, si
		shl	bx, 1
		mov	di, si
		shl	di, 1
		shl	di, 1
		les	di, dword ptr g_pwManyExRes[di]
		mov	ax, es:[di]
		mov	word ptr unk_2B77_9EC6[bx], ax
		inc	si
		cmp	si, 3
		jl	short loc_9F1_39F8
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
LoadSdgame2Shap	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================


sub_9F1_3A1A	proc far		; CODE XREF: UnloadGameResou+2AP
		push	word ptr g_dwSgGameRes+2
		push	word ptr g_dwSgGameRes
		call	UnloadResource
		add	sp, 4
		retf
sub_9F1_3A1A	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupIntro	proc far		; CODE XREF: RunIntroInLoop+77P

var_5D4		= word ptr -5D4h
var_5D2		= word ptr -5D2h
var_5D0		= byte ptr -5D0h
var_440		= word ptr -440h
var_43E		= byte ptr -43Eh
var_2AE		= word ptr -2AEh
var_2AC		= word ptr -2ACh
var_2AA		= word ptr -2AAh
var_2A8		= word ptr -2A8h
var_2A6		= word ptr -2A6h
var_2A4		= word ptr -2A4h
var_2A2		= byte ptr -2A2h
var_2A0		= word ptr -2A0h
var_29E		= word ptr -29Eh
var_29C		= word ptr -29Ch
var_29A		= word ptr -29Ah
var_298		= word ptr -298h
var_296		= word ptr -296h
var_42		= word ptr -42h
var_40		= word ptr -40h
var_3E		= word ptr -3Eh
var_3C		= word ptr -3Ch
var_3A		= word ptr -3Ah
var_38		= byte ptr -38h
var_36		= word ptr -36h
var_34		= byte ptr -34h
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= word ptr -24h
pManyIntroRes	= word ptr -22h
var_16		= byte ptr -16h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
pCarCounRes1	= word ptr -0Ah
pCarCounRes2	= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 5D4h
		push	di
		push	si
		mov	[bp+var_38], 0
		mov	ax, offset aTitle ; "title"
		push	ax
		call	Load3DShape
		add	sp, 2
		mov	[bp+var_2AE], ax
		mov	[bp+var_2AC], dx
		lea	ax, [bp+pManyIntroRes]
		push	ax
		mov	ax, offset aLogolog2brav ; "logolog2brav"
		push	ax
		push	dx
		push	[bp+var_2AE]
		call	LocateManyResou
		add	sp, 8
		mov	ax, offset g_pLogo3d
		push	ax
		push	[bp+pManyIntroRes+2]
		push	[bp+pManyIntroRes]
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset p_pLog23d
		push	ax
		push	[bp+pManyIntroRes+6]
		push	[bp+pManyIntroRes+4]
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pBrav3d
		push	ax
		push	[bp+pManyIntroRes+0Ah]
		push	[bp+pManyIntroRes+8]
		call	Import3DShapeBinary
		add	sp, 6
		cmp	g_wVideoFlag4, 0
		jnz	short loc_9F1_3ABA
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx

loc_9F1_3ABA:				; CODE XREF: SetupIntro+71j
		mov	[bp+var_42], 0

loc_9F1_3ABF:				; CODE XREF: SetupIntro+EDj
		call	GetRandomKevin
		mov	cl, 7
		shl	ax, cl
		sub	ax, 4000h
		mov	si, [bp+var_42]
		mov	cx, si
		shl	si, 1
		add	si, cx
		shl	si, 1
		mov	[bp+si+var_29A], ax
		call	GetRandomKevin
		mov	cl, 7
		shl	ax, cl
		sub	ax, 1388h
		neg	ax
		mov	si, [bp+var_42]
		mov	cx, si
		shl	si, 1
		add	si, cx
		shl	si, 1
		mov	[bp+si+var_298], ax
		call	GetRandomKevin
		mov	cl, 7
		shl	ax, cl
		sub	ax, 4000h
		mov	si, [bp+var_42]
		mov	cx, si
		shl	si, 1
		add	si, cx
		shl	si, 1
		mov	[bp+si+var_296], ax
		inc	[bp+var_42]
		cmp	[bp+var_42], 64h ; 'd'
		jl	short loc_9F1_3ABF
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		mov	ax, 28h	; '('
		push	ax
		push	ax
		call	sub_1EA2_38D3
		add	sp, 8
		mov	[bp+var_3E], 400h
		mov	[bp+var_3A], 400h
		mov	[bp+var_3C], 12Ch
		mov	[bp+var_E], 0
		mov	[bp+var_5D4], 0
		mov	ax, offset aCarcoun_0 ;	"carcoun"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pCarCounRes1], ax
		mov	[bp+pCarCounRes2], dx
		mov	ax, 1
		push	ax
		push	dx
		push	[bp+pCarCounRes1]
		call	SetupAeroTrakdata
		add	sp, 6
		push	[bp+pCarCounRes2]
		push	[bp+pCarCounRes1]
		call	DoUnloadResourc
		add	sp, 4
		call	InitPlanTrak
		call	GetTimerDelta
		mov	[bp+var_2AA], 0
		mov	[bp+var_440], 0
		mov	ax, g_wTimerFlag1
		mov	g_wTimerFlag5, ax
		mov	g_rcIntro.dwLeft, 0
		mov	g_rcIntro.dwTop, 140h
		mov	g_rcIntro.dwRight, 0
		mov	g_rcIntro.dwBottom, 0C8h
		mov	di, offset g_rcIntroCopy
		mov	si, offset g_rcIntro
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		mov	di, offset g_rcIntroCp2
		mov	si, offset g_rcIntro
		movsw
		movsw
		movsw
		movsw
		mov	[bp+var_36], 0
		mov	[bp+var_2A2], 1

loc_9F1_3BCE:				; CODE XREF: SetupIntro+4FFj
		call	GetTimerDelta
		mov	[bp+var_40], ax
		add	g_wIntroTimeCou, ax
		jmp	loc_9F1_3C7A
; ---------------------------------------------------------------------------
		nop

loc_9F1_3BDE:				; CODE XREF: SetupIntro+257j
		mov	ax, g_w64hDivFps
		sub	g_wIntroTimeCou, ax
		call	DoOpponentOp
		mov	[bp+var_2A2], 1
		mov	ax, g_wFramesPerSec
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		inc	[bp+var_5D4]
		cmp	ax, [bp+var_5D4]
		jge	short loc_9F1_3C7A
		mov	[bp+var_E], 1
		add	[bp+var_3C], 14h
		sub	[bp+var_3A], 5
		mov	ax, [bp+var_3E]
		sub	ax, 400h
		mov	[bp+var_42], ax
		or	ax, ax
		jge	short loc_9F1_3C28
		neg	ax
		jmp	short loc_9F1_3C2B
; ---------------------------------------------------------------------------
		nop
		nop

loc_9F1_3C28:				; CODE XREF: SetupIntro+1F4j
		mov	ax, [bp+var_42]

loc_9F1_3C2B:				; CODE XREF: SetupIntro+1F8j
		cmp	ax, 0Ah
		jge	short loc_9F1_3C38
		mov	[bp+var_3E], 400h
		jmp	short loc_9F1_3C4E
; ---------------------------------------------------------------------------
		nop

loc_9F1_3C38:				; CODE XREF: SetupIntro+202j
		cmp	[bp+var_42], 0
		jle	short loc_9F1_3C44
		sub	[bp+var_3E], 0Ah
		jmp	short loc_9F1_3C4E
; ---------------------------------------------------------------------------

loc_9F1_3C44:				; CODE XREF: SetupIntro+210j
		cmp	[bp+var_42], 0
		jge	short loc_9F1_3C4E
		add	[bp+var_3E], 0Ah

loc_9F1_3C4E:				; CODE XREF: SetupIntro+209j
					; SetupIntro+216j ...
		cmp	[bp+var_6], 400h
		jle	short loc_9F1_3C5A
		dec	[bp+var_6]
		jmp	short loc_9F1_3C64
; ---------------------------------------------------------------------------

loc_9F1_3C5A:				; CODE XREF: SetupIntro+227j
		cmp	[bp+var_6], 400h
		jge	short loc_9F1_3C64
		inc	[bp+var_6]

loc_9F1_3C64:				; CODE XREF: SetupIntro+22Cj
					; SetupIntro+233j
		cmp	[bp+var_2], 400h
		jle	short loc_9F1_3C70
		dec	[bp+var_2]
		jmp	short loc_9F1_3C7A
; ---------------------------------------------------------------------------

loc_9F1_3C70:				; CODE XREF: SetupIntro+23Dj
		cmp	[bp+var_2], 400h
		jge	short loc_9F1_3C7A
		inc	[bp+var_2]

loc_9F1_3C7A:				; CODE XREF: SetupIntro+1AEj
					; SetupIntro+1DAj ...
		mov	ax, g_w64hDivFps
		cmp	g_wIntroTimeCou, ax
		jle	short loc_9F1_3C86
		jmp	loc_9F1_3BDE
; ---------------------------------------------------------------------------

loc_9F1_3C86:				; CODE XREF: SetupIntro+255j
		cmp	[bp+var_2A2], 0
		jnz	short loc_9F1_3C90
		jmp	loc_9F1_3F09
; ---------------------------------------------------------------------------

loc_9F1_3C90:				; CODE XREF: SetupIntro+25Fj
		mov	[bp+var_2A2], 0
		cmp	g_wVideoFlag4, 0
		jz	short loc_9F1_3CA4
		call	SetupMcgaWnd2
		jmp	short loc_9F1_3CA9
; ---------------------------------------------------------------------------
		nop

loc_9F1_3CA4:				; CODE XREF: SetupIntro+26Ej
		call	SelectWndSprite

loc_9F1_3CA9:				; CODE XREF: SetupIntro+275j
		mov	[bp+var_2C], 0FFFFh
		mov	[bp+var_2A6], 1
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_3CBD:				; CODE XREF: SetupIntro+297j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_3CBD
		mov	[bp+var_2A0], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_3CD2:				; CODE XREF: SetupIntro+2ACj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_3CD2
		mov	[bp+var_29E], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_3CE7:				; CODE XREF: SetupIntro+2C1j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_3CE7
		mov	[bp+var_29C], ax
		mov	ax, g_wFramesPerSec
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		cmp	ax, [bp+var_5D4]
		jle	short loc_9F1_3D34
		mov	[bp+var_2A6], 0
		mov	ax, gameState.carOpponent.vecRotate.wX
		and	ah, 3
		mov	[bp+var_2C], ax
		mov	[bp+var_2A4], 0
		mov	ax, [bp+var_2A0]
		mov	[bp+var_3E], ax
		mov	ax, [bp+var_29E]
		add	ax, 14h
		mov	[bp+var_3C], ax
		mov	ax, [bp+var_29C]
		mov	[bp+var_3A], ax
		jmp	short loc_9F1_3D6D
; ---------------------------------------------------------------------------
		nop

loc_9F1_3D34:				; CODE XREF: SetupIntro+2D6j
		mov	ax, g_wFramesPerSec
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		cmp	ax, [bp+var_5D4]
		jle	short loc_9F1_3D6D
		mov	[bp+var_3E], 400h
		mov	[bp+var_3A], 400h
		mov	[bp+var_3C], 5Ah ; 'Z'
		mov	ax, [bp+var_2A0]
		mov	[bp+var_6], ax
		mov	ax, [bp+var_29E]
		mov	[bp+var_4], ax
		mov	ax, [bp+var_29C]
		mov	[bp+var_2], ax

loc_9F1_3D6D:				; CODE XREF: SetupIntro+305j
					; SetupIntro+31Bj
		cmp	[bp+var_2C], 0FFFFh
		jnz	short loc_9F1_3DC1
		mov	ax, [bp+var_2]
		sub	ax, [bp+var_3A]
		push	ax
		mov	ax, [bp+var_6]
		sub	ax, [bp+var_3E]
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		neg	ax
		and	ah, 3
		mov	[bp+var_2C], ax
		mov	ax, [bp+var_2]
		sub	ax, [bp+var_3A]
		push	ax
		mov	ax, [bp+var_6]
		sub	ax, [bp+var_3E]
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_C], ax
		push	ax
		mov	ax, [bp+var_4]
		sub	ax, [bp+var_3C]
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		and	ah, 3
		mov	[bp+var_2A4], ax

loc_9F1_3DC1:				; CODE XREF: SetupIntro+345j
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_3DEC
		cmp	[bp+var_36], 0
		jnz	short loc_9F1_3DDC
		lea	ax, [bp+var_43E]
		mov	[bp+var_2A8], ax
		lea	ax, [bp+var_2AA]
		jmp	short loc_9F1_3DE8
; ---------------------------------------------------------------------------

loc_9F1_3DDC:				; CODE XREF: SetupIntro+3A0j
		lea	ax, [bp+var_5D0]
		mov	[bp+var_2A8], ax
		lea	ax, [bp+var_440]

loc_9F1_3DE8:				; CODE XREF: SetupIntro+3AEj
		mov	[bp+var_5D2], ax

loc_9F1_3DEC:				; CODE XREF: SetupIntro+39Aj
		lea	ax, [bp+var_34]
		push	ax
		lea	ax, [bp+var_16]
		push	ax
		mov	bx, [bp+var_36]
		mov	cl, 3
		shl	bx, cl
		push	g_rcIntro.dwBottom[bx]
		push	g_rcIntro.dwRight[bx]
		push	g_rcIntro.dwTop[bx]
		push	word ptr g_rcIntro.dwLeft[bx]
		push	[bp+var_5D2]
		push	[bp+var_2A8]
		lea	ax, [bp+var_29A]
		push	ax
		push	[bp+var_E]
		push	[bp+var_2A6]
		push	[bp+var_2A4]
		push	[bp+var_2C]
		push	[bp+var_3A]
		push	[bp+var_3C]
		push	[bp+var_3E]
		push	cs
		call	near ptr sub_9F1_3F96
		add	sp, 20h
		cmp	g_wVideoFlag4, 0
		jz	short loc_9F1_3E6E
		call	DoRenderMouSpr3
		call	SetupMcgaWnd1
		call	DoUseMousePos
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_3E67
		mov	bx, [bp+var_36]
		mov	cl, 3
		shl	bx, cl
		lea	di, g_rcIntro.dwLeft[bx]
		lea	si, [bp+var_16]
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw

loc_9F1_3E67:				; CODE XREF: SetupIntro+425j
		xor	byte ptr [bp+var_36], 1
		jmp	loc_9F1_3F09
; ---------------------------------------------------------------------------

loc_9F1_3E6E:				; CODE XREF: SetupIntro+40Fj
		call	SetSprite2As1_2
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_3EEC
		lea	ax, [bp+var_2A]
		push	ax
		mov	ax, offset g_rcUnk
		push	ax
		lea	ax, [bp+var_34]
		push	ax
		call	MinMaxRect
		add	sp, 6
		mov	ax, offset g_rcIntroCp2
		push	ax
		lea	ax, [bp+var_2A]
		push	ax
		call	MaybeRectOp
		add	sp, 4
		or	al, al
		jnz	short loc_9F1_3F09
		push	[bp+var_24]
		push	[bp+var_26]
		push	[bp+var_28]
		push	[bp+var_2A]
		call	SetSprite1Size
		add	sp, 8
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		assume es:nothing
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		call	DoUseMousePos
		mov	di, offset g_rcIntro
		lea	si, [bp+var_16]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		mov	di, offset g_rcUnk
		lea	si, [bp+var_34]
		movsw
		movsw
		movsw
		movsw
		jmp	short loc_9F1_3F09
; ---------------------------------------------------------------------------
		nop

loc_9F1_3EEC:				; CODE XREF: SetupIntro+44Cj
		call	DoRenderMouSpr3
		les	bx, g_pWndSprite
		assume es:nothing
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		call	DoUseMousePos

loc_9F1_3F09:				; CODE XREF: SetupIntro+261j
					; SetupIntro+43Fj ...
		push	[bp+var_40]
		call	DoInputsCheckin
		add	sp, 2
		or	ax, ax
		jz	short loc_9F1_3F1E
		mov	[bp+var_38], 1
		jmp	short loc_9F1_3F2E
; ---------------------------------------------------------------------------

loc_9F1_3F1E:				; CODE XREF: SetupIntro+4EAj
		mov	ax, 17h
		imul	g_wFramesPerSec
		cmp	ax, [bp+var_5D4]
		jle	short loc_9F1_3F2E
		jmp	loc_9F1_3BCE
; ---------------------------------------------------------------------------

loc_9F1_3F2E:				; CODE XREF: SetupIntro+4F0j
					; SetupIntro+4FDj
		cmp	g_wVideoFlag4, 0
		jz	short loc_9F1_3F6C
		call	Get0
		or	ax, ax
		jz	short loc_9F1_3F7C
		call	SetupMcgaWnd2
		sub	ax, ax
		push	ax
		mov	ax, 0C8h
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		call	Sprite1_2Op
		add	sp, 0Ah
		call	DoRenderMouSpr3
		call	SetupMcgaWnd1
		call	DoUseMousePos
		jmp	short loc_9F1_3F7C
; ---------------------------------------------------------------------------
		nop

loc_9F1_3F6C:				; CODE XREF: SetupIntro+507j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4

loc_9F1_3F7C:				; CODE XREF: SetupIntro+510j
					; SetupIntro+53Dj
		push	[bp+var_2AC]
		push	[bp+var_2AE]
		call	UnloadResource
		add	sp, 4
		mov	al, [bp+var_38]
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetupIntro	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_9F1_3F96	proc far		; CODE XREF: SetupIntro+404p

var_42		= word ptr -42h
pVec		= Vector3D ptr -40h
var_3A		= word ptr -3Ah
var_38		= word ptr -38h
var_36		= word ptr -36h
var_34		= word ptr -34h
var_32		= word ptr -32h
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= byte ptr -24h
pUnk14		= TransformedShape3D ptr -1Ch
var_8		= byte ptr -8
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h
arg_E		= word ptr  14h
arg_10		= word ptr  16h
arg_12		= word ptr  18h
arg_14		= byte ptr  1Ah
arg_1C		= word ptr  22h
arg_1E		= word ptr  24h

		push	bp
		mov	bp, sp
		sub	sp, 42h
		push	di
		push	si
		push	si
		push	di
		lea	di, [bp+var_8]
		mov	si, offset g_rc1
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		sub	ax, ax
		push	ax
		mov	ax, offset g_pwUnk8_4
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_8]
		sub	ax, ax
		push	ax
		call	SelectRectRotate
		add	sp, 0Ah
		cmp	[bp+arg_C], 0
		jz	short loc_9F1_3FD4
		mov	[bp+pUnk14.pShape3D], offset g_pLogo3d
		jmp	short loc_9F1_3FD9
; ---------------------------------------------------------------------------
		nop

loc_9F1_3FD4:				; CODE XREF: sub_9F1_3F96+34j
		mov	[bp+pUnk14.pShape3D], offset p_pLog23d

loc_9F1_3FD9:				; CODE XREF: sub_9F1_3F96+3Bj
		mov	ax, 400h
		sub	ax, [bp+arg_0]
		mov	[bp+pUnk14.vecPos.wX], ax
		mov	ax, [bp+arg_2]
		neg	ax
		mov	[bp+pUnk14.vecPos.wY], ax
		mov	ax, 400h
		sub	ax, [bp+arg_4]
		mov	[bp+pUnk14.vecPos.wZ], ax
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_4006
		lea	ax, [bp+var_8]
		mov	[bp+pUnk14.pRect], ax
		mov	[bp+pUnk14.cFlags], 0Ch
		jmp	short loc_9F1_400A
; ---------------------------------------------------------------------------

loc_9F1_4006:				; CODE XREF: sub_9F1_3F96+62j
		mov	[bp+pUnk14.cFlags], 4

loc_9F1_400A:				; CODE XREF: sub_9F1_3F96+6Ej
		mov	[bp+pUnk14.vecRot.wX], 0
		mov	[bp+pUnk14.vecRot.wY], 0
		mov	[bp+pUnk14.vecRot.wZ], 0
		mov	[bp+pUnk14.field_10], 400h
		mov	[bp+pUnk14.cMaterial], 0
		lea	ax, [bp+pUnk14]
		push	ax
		call	TransformedShapeOp
		add	sp, 2
		cmp	[bp+arg_A], 0
		jnz	short loc_9F1_4037
		jmp	loc_9F1_40BF
; ---------------------------------------------------------------------------

loc_9F1_4037:				; CODE XREF: sub_9F1_3F96+9Cj
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwX
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwX+2
		mov	cl, 6

loc_9F1_4040:				; CODE XREF: sub_9F1_3F96+B0j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_4040
		sub	ax, [bp+arg_0]
		mov	[bp+pUnk14.vecPos.wX], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwY
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwY+2
		mov	cl, 6

loc_9F1_4057:				; CODE XREF: sub_9F1_3F96+C7j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_4057
		sub	ax, [bp+arg_2]
		mov	[bp+pUnk14.vecPos.wY], ax
		mov	ax, word ptr gameState.carOpponent.vecLongUnk.dwZ
		mov	dx, word ptr gameState.carOpponent.vecLongUnk.dwZ+2
		mov	cl, 6

loc_9F1_406E:				; CODE XREF: sub_9F1_3F96+DEj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_9F1_406E
		sub	ax, [bp+arg_4]
		mov	[bp+pUnk14.vecPos.wZ], ax
		mov	[bp+pUnk14.pShape3D], offset g_pBrav3d
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_4094
		lea	ax, [bp+var_8]
		mov	[bp+pUnk14.pRect], ax
		mov	[bp+pUnk14.cFlags], 0Ch
		jmp	short loc_9F1_4098
; ---------------------------------------------------------------------------

loc_9F1_4094:				; CODE XREF: sub_9F1_3F96+F0j
		mov	[bp+pUnk14.cFlags], 4

loc_9F1_4098:				; CODE XREF: sub_9F1_3F96+FCj
		mov	[bp+pUnk14.vecRot.wX], 0
		mov	[bp+pUnk14.vecRot.wY], 0
		mov	ax, gameState.carOpponent.vecRotate.wX
		neg	ax
		mov	[bp+pUnk14.vecRot.wZ], ax
		mov	[bp+pUnk14.field_10], 400h
		mov	[bp+pUnk14.cMaterial], 0
		lea	ax, [bp+pUnk14]
		push	ax
		call	TransformedShapeOp
		add	sp, 2

loc_9F1_40BF:				; CODE XREF: sub_9F1_3F96+9Ej
		cmp	g_wTimerFlag5, 0
		jnz	short loc_9F1_40C9
		jmp	loc_9F1_415C
; ---------------------------------------------------------------------------

loc_9F1_40C9:				; CODE XREF: sub_9F1_3F96+12Ej
		mov	bx, [bp+arg_12]
		cmp	word ptr [bx], 0
		jz	short loc_9F1_4103
		sub	si, si
		jmp	short loc_9F1_40FC
; ---------------------------------------------------------------------------
		nop

loc_9F1_40D6:				; CODE XREF: sub_9F1_3F96+16Bj
		mov	bx, [bp+arg_10]
		mov	ax, si
		shl	ax, 1
		shl	ax, 1
		add	bx, ax
		mov	ax, [bx]
		mov	dx, [bx+2]
		mov	[bp+var_3A], ax
		mov	[bp+var_38], dx
		sub	ax, ax
		push	ax
		push	dx
		push	[bp+var_3A]
		call	PutPixel
		add	sp, 6
		inc	si

loc_9F1_40FC:				; CODE XREF: sub_9F1_3F96+13Dj
		mov	bx, [bp+arg_12]
		cmp	[bx], si
		jg	short loc_9F1_40D6

loc_9F1_4103:				; CODE XREF: sub_9F1_3F96+139j
		lea	ax, [bp+var_2C]
		push	ax
		lea	ax, [bp+arg_14]
		push	ax
		push	[bp+arg_1C]
		call	MinMaxRect
		add	sp, 6
		mov	ax, offset g_rcIntroCp2
		push	ax
		lea	ax, [bp+var_2C]
		push	ax
		call	MaybeRectOp
		add	sp, 4
		or	al, al
		jnz	short loc_9F1_4149
		push	[bp+var_26]
		push	[bp+var_28]
		push	[bp+var_2A]
		push	[bp+var_2C]
		call	SetSprite1Size
		add	sp, 8
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2

loc_9F1_4149:				; CODE XREF: sub_9F1_3F96+192j
		push	si
		push	di
		lea	di, [bp+var_24]
		lea	si, [bp+var_8]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		jmp	short loc_9F1_417F
; ---------------------------------------------------------------------------
		nop

loc_9F1_415C:				; CODE XREF: sub_9F1_3F96+130j
		push	g_pwUnk8_4+6
		push	g_pwUnk8_4+4
		push	g_pwUnk8_4+2
		push	g_pwUnk8_4
		call	SetSprite1Size
		add	sp, 8
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2

loc_9F1_417F:				; CODE XREF: sub_9F1_3F96+1C3j
		push	g_pwUnk8_4+6
		push	g_pwUnk8_4+4
		push	g_pwUnk8_4+2
		push	g_pwUnk8_4
		call	SetSprite1Size
		add	sp, 8
		sub	di, di
		sub	si, si

loc_9F1_419B:				; CODE XREF: sub_9F1_3F96+2B7j
		mov	ax, [bp+arg_E]
		mov	cx, si
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		shl	cx, 1
		add	ax, cx
		mov	[bp+var_42], ax
		mov	bx, ax
		mov	ax, [bx]
		sub	ax, [bp+arg_0]
		mov	[bp+var_36], ax
		mov	ax, [bx+2]
		sub	ax, [bp+arg_2]
		mov	[bp+var_34], ax
		mov	ax, [bx+4]
		sub	ax, [bp+arg_4]
		mov	[bp+var_32], ax
		lea	ax, [bp+pVec]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		lea	ax, [bp+var_36]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+pVec.wZ], 0C8h ; 'È'
		jle	short loc_9F1_4247
		lea	ax, [bp+var_3A]
		push	ax
		lea	ax, [bp+pVec]
		push	ax
		call	VectorOp2
		add	sp, 4
		push	word_2B77_A4E
		push	[bp+var_38]
		push	[bp+var_3A]
		call	PutPixel
		add	sp, 6
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_4234
		mov	bx, [bp+arg_10]
		mov	ax, di
		inc	di
		shl	ax, 1
		shl	ax, 1
		add	bx, ax
		mov	ax, [bp+var_3A]
		mov	dx, [bp+var_38]
		mov	[bx], ax
		mov	[bx+2],	dx
		lea	ax, [bp+var_24]
		push	ax
		lea	ax, [bp+var_3A]
		push	ax
		call	RectOp
		add	sp, 4

loc_9F1_4234:				; CODE XREF: sub_9F1_3F96+275j
		inc	word_2B77_A4E
		mov	ax, word_2B77_505C
		cmp	word_2B77_A4E, ax
		jnz	short loc_9F1_4247
		mov	word_2B77_A4E, 1

loc_9F1_4247:				; CODE XREF: sub_9F1_3F96+24Cj
					; sub_9F1_3F96+2A9j
		inc	si
		cmp	si, 64h	; 'd'
		jge	short loc_9F1_4250
		jmp	loc_9F1_419B
; ---------------------------------------------------------------------------

loc_9F1_4250:				; CODE XREF: sub_9F1_3F96+2B5j
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_425C
		mov	bx, [bp+arg_12]
		mov	[bx], di

loc_9F1_425C:				; CODE XREF: sub_9F1_3F96+2BFj
		call	sub_14D6_1296
		cmp	g_wTimerFlag5, 0
		jz	short loc_9F1_428A
		mov	bx, [bp+arg_1C]
		push	si
		push	di
		mov	di, bx
		lea	si, [bp+var_8]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, [bp+arg_1E]
		push	si
		push	di
		mov	di, bx
		lea	si, [bp+var_24]
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si

loc_9F1_428A:				; CODE XREF: sub_9F1_3F96+2D0j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_9F1_3F96	endp

seg003		ends

; ===========================================================================

; Segment type:	Pure code
seg004		segment	byte public 'CODE' use16
		assume cs:seg004
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TrkTerrainWall	proc far		; CODE XREF: TrkPlanSimd+431P
					; TrkPlanSimd+1515P ...

var_40		= dword	ptr -40h
c2wZVal		= word ptr -3Ch
pSceneShape	= word ptr -3Ah
var_38		= word ptr -38h
var_36		= word ptr -36h
cTerrainTile	= byte ptr -34h
var_32		= word ptr -32h
var_2E		= word ptr -2Eh
vec		= Vector3D ptr -2Ch
var_24		= word ptr -24h
wXCosScale	= word ptr -22h
cZVal		= byte ptr -20h
var_1E		= word ptr -1Eh
var_1C		= word ptr -1Ch
cXVal		= byte ptr -1Ah
vec2		= Vector3D ptr -18h
var_12		= byte ptr -12h
wShapeRot	= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
cTrackTile	= byte ptr -8
var_6		= word ptr -6
var_2		= word ptr -2
p_pVec		= word ptr  6
p_pVec2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 40h
		push	di
		push	si
		mov	g_wPlanIndex, 0
		mov	g_wTrkTerrSomeCode, 0FFFFh
		mov	g_wTrkTerrnSomeCode2, 0FFF4h
		mov	word_2B77_9218,	0FC18h
		mov	byte_2B77_95D6,	0
		mov	byte_2B77_95D7,	4
		mov	byte_2B77_81BC,	1
		sub	si, si
		mov	[bp+var_38], si
		mov	[bp+wShapeRot],	si
		mov	g_dwSomeY, si
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+Vector3D.wX]
		mov	cl, 0Ah
		sar	ax, cl
		mov	[bp+cXVal], al
		mov	ax, [bx+Vector3D.wZ]
		sar	ax, cl
		mov	[bp+cZVal], al
		mov	[bp+var_24], 0FFFFh
		cmp	[bp+cXVal], 0
		jge	short loc_E1A_5D
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------

loc_E1A_5D:				; CODE XREF: TrkTerrainWall+58j
		cmp	[bp+cXVal], 1Dh
		jle	short loc_E1A_66
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------

loc_E1A_66:				; CODE XREF: TrkTerrainWall+61j
		or	al, al
		jge	short loc_E1A_6D
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------

loc_E1A_6D:				; CODE XREF: TrkTerrainWall+68j
		cmp	al, 1Dh
		jle	short loc_E1A_74
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------

loc_E1A_74:				; CODE XREF: TrkTerrainWall+6Fj
		mov	al, [bp+cXVal]
		cbw
		mov	di, ax
		mov	bx, di
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		mov	g_dwSomeX, ax
		mov	al, [bp+cZVal]
		cbw
		shl	ax, 1
		mov	[bp+c2wZVal], ax
		mov	bx, ax
		mov	ax, word ptr g_wTerrainCenPo[bx]
		mov	g_dwSomeZ, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx+di]
		mov	[bp+cTerrainTile], al
		or	al, al
		jz	short loc_E1A_D6
		sub	ah, ah
		cmp	ax, 1
		jnz	short loc_E1A_B7
		jmp	loc_E1A_15B
; ---------------------------------------------------------------------------

loc_E1A_B7:				; CODE XREF: TrkTerrainWall+B2j
		cmp	ax, 2
		jz	short loc_E1A_FA
		cmp	ax, 3
		jz	short loc_E1A_100
		cmp	ax, 4
		jz	short loc_E1A_106
		cmp	ax, 5
		jz	short loc_E1A_10C
		cmp	ax, 6
		jnz	short loc_E1A_D6
		mov	ax, word_2B77_17A
		mov	g_dwSomeY, ax

loc_E1A_D6:				; CODE XREF: TrkTerrainWall+ABj
					; TrkTerrainWall+CEj ...
		mov	al, [bp+cZVal]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cXVal]
		cbw
		add	bx, ax
		les	di, g_ppTrakdata14
		mov	al, es:[bx+di+TrackInfo.pTrackData]
		mov	[bp+cTrackTile], al
		or	al, al
		jnz	short loc_E1A_164
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FA:				; CODE XREF: TrkTerrainWall+BAj
		mov	si, 80h	; '€'
		jmp	short loc_E1A_10F
; ---------------------------------------------------------------------------
		nop

loc_E1A_100:				; CODE XREF: TrkTerrainWall+BFj
		mov	si, 0FD80h
		jmp	short loc_E1A_10F
; ---------------------------------------------------------------------------
		nop

loc_E1A_106:				; CODE XREF: TrkTerrainWall+C4j
		mov	si, 0FE80h
		jmp	short loc_E1A_10F
; ---------------------------------------------------------------------------
		nop

loc_E1A_10C:				; CODE XREF: TrkTerrainWall+C9j
		mov	si, 0FF80h

loc_E1A_10F:				; CODE XREF: TrkTerrainWall+FDj
					; TrkTerrainWall+103j ...
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+Vector3D.wX]
		sub	ax, g_dwSomeX
		mov	[bp+vec.wX], ax
		mov	ax, [bx+Vector3D.wZ]
		sub	ax, g_dwSomeZ
		mov	[bp+vec.wZ], ax
		push	ax
		push	si
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		push	[bp+vec.wX]
		push	si
		mov	di, ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, di
		mov	[bp+wXCosScale], ax
		or	ax, ax
		jl	short loc_E1A_15B
		jmp	loc_E1A_D6
; ---------------------------------------------------------------------------

loc_E1A_15B:				; CODE XREF: TrkTerrainWall+B4j
					; TrkTerrainWall+156j
		mov	byte_2B77_95D7,	5
		jmp	loc_E1A_D6
; ---------------------------------------------------------------------------
		nop

loc_E1A_164:				; CODE XREF: TrkTerrainWall+F4j
		cmp	[bp+cTrackTile], 0FDh ;	'ý'
		jnb	short loc_E1A_16D
		jmp	loc_E1A_26C
; ---------------------------------------------------------------------------

loc_E1A_16D:				; CODE XREF: TrkTerrainWall+168j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 0FDh ; 'ý'
		jz	short loc_E1A_188
		cmp	ax, 0FEh ; 'þ'
		jz	short loc_E1A_1F0
		cmp	ax, 0FFh
		jnz	short loc_E1A_184
		jmp	loc_E1A_22C
; ---------------------------------------------------------------------------

loc_E1A_184:				; CODE XREF: TrkTerrainWall+17Fj
		jmp	loc_E1A_2C4
; ---------------------------------------------------------------------------
		nop

loc_E1A_188:				; CODE XREF: TrkTerrainWall+175j
		mov	al, [bp+cZVal]
		cbw
		mov	di, ax
		shl	di, 1
		mov	al, [bp+cXVal]
		cbw
		mov	bx, ax
		add	bx, (g_wTerrainRows+2)[di]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx-1]
		mov	[bp+cTrackTile], al
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_E1A_1C5
		mov	ax, word ptr (g_wTerrainPos+2)[di]

loc_E1A_1C2:				; CODE XREF: TrkTerrainWall+269j
		mov	g_dwSomeZ, ax

loc_E1A_1C5:				; CODE XREF: TrkTerrainWall+1BCj
					; TrkTerrainWall+262j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jnz	short loc_E1A_1E0
		jmp	loc_E1A_2C4
; ---------------------------------------------------------------------------

loc_E1A_1E0:				; CODE XREF: TrkTerrainWall+1DBj
		mov	al, [bp+cXVal]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrackPos[bx]
		jmp	loc_E1A_2C1
; ---------------------------------------------------------------------------
		nop

loc_E1A_1F0:				; CODE XREF: TrkTerrainWall+17Aj
		mov	al, [bp+cZVal]
		cbw
		mov	di, ax
		shl	di, 1
		mov	al, [bp+cXVal]
		cbw
		mov	bx, ax
		add	bx, (g_wTerrainRows+2)[di]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+cTrackTile], al
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_E1A_29D
		mov	ax, word ptr (g_wTerrainPos+2)[di]
		jmp	short loc_E1A_29A
; ---------------------------------------------------------------------------
		nop

loc_E1A_22C:				; CODE XREF: TrkTerrainWall+181j
		mov	al, [bp+cZVal]
		cbw
		mov	di, ax
		shl	di, 1
		mov	al, [bp+cXVal]
		cbw
		mov	bx, ax
		add	bx, g_wTerrainRows[di]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx-1]
		mov	[bp+cTrackTile], al
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jnz	short loc_E1A_265
		jmp	loc_E1A_1C5
; ---------------------------------------------------------------------------

loc_E1A_265:				; CODE XREF: TrkTerrainWall+260j
		mov	ax, word ptr g_wTerrainPos[di]
		jmp	loc_E1A_1C2
; ---------------------------------------------------------------------------

loc_E1A_26C:				; CODE XREF: TrkTerrainWall+16Aj
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		mov	byte ptr [bp+c2wZVal], al
		cmp	al, ah
		jz	short loc_E1A_2C4
		test	byte ptr [bp+c2wZVal], 1
		jz	short loc_E1A_29D
		mov	al, [bp+cZVal]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTerrainPos[bx]

loc_E1A_29A:				; CODE XREF: TrkTerrainWall+229j
		mov	g_dwSomeZ, ax

loc_E1A_29D:				; CODE XREF: TrkTerrainWall+223j
					; TrkTerrainWall+28Cj
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jz	short loc_E1A_2C4
		mov	al, [bp+cXVal]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, (g_wMoreTrackPos+2)[bx]

loc_E1A_2C1:				; CODE XREF: TrkTerrainWall+1ECj
		mov	g_dwSomeX, ax

loc_E1A_2C4:				; CODE XREF: TrkTerrainWall:loc_E1A_184j
					; TrkTerrainWall+1DDj ...
		mov	bx, [bp+p_pVec]	; arg_0	and arg_2 looks	like vectors here!
		mov	ax, [bx+Vector3D.wX]
		sub	ax, g_dwSomeX
		mov	[bp+vec.wX], ax
		mov	ax, [bx+Vector3D.wZ]
		sub	ax, g_dwSomeZ
		mov	[bp+vec.wZ], ax
		mov	bx, [bp+p_pVec2]
		mov	ax, [bx+Vector3D.wX]
		sub	ax, g_dwSomeX
		mov	[bp+vec2.wX], ax
		mov	ax, [bx+Vector3D.wZ]
		sub	ax, g_dwSomeZ
		mov	[bp+vec2.wZ], ax
		cmp	[bp+cTrackTile], 0
		jz	short loc_E1A_316
		cmp	[bp+cTerrainTile], 7
		jb	short loc_E1A_316
		cmp	[bp+cTerrainTile], 0Bh
		jnb	short loc_E1A_316
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		push	ax
		mov	al, [bp+cTerrainTile]
		push	ax
		push	cs
		call	near ptr MapTerrainTrack
		add	sp, 4
		mov	[bp+cTrackTile], al

loc_E1A_316:				; CODE XREF: TrkTerrainWall+2F4j
					; TrkTerrainWall+2FAj ...
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, offset g_sceneShapes
		mov	[bp+pSceneShape], ax
		mov	bx, ax
		mov	al, [bx+SceneShape3D.field_C]
		cbw
		mov	[bp+var_24], ax
		mov	ax, [bx+SceneShape3D.dwRotY]
		mov	[bp+wShapeRot],	ax
		or	ax, ax
		jz	short loc_E1A_34F
		cmp	ax, 100h
		jz	short loc_E1A_3C2
		cmp	ax, 200h
		jz	short loc_E1A_3A0
		cmp	ax, 300h
		jz	short loc_E1A_376

loc_E1A_34F:				; CODE XREF: TrkTerrainWall+33Ej
					; TrkTerrainWall+39Ej ...
		mov	[bp+var_36], 0
		mov	bx, [bp+pSceneShape]
		mov	al, [bx+SceneShape3D.cMaterial]
		inc	al
		mov	[bp+var_12], al
		cmp	al, 1
		jge	short loc_E1A_367
		mov	[bp+var_12], 1

loc_E1A_367:				; CODE XREF: TrkTerrainWall+361j
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_3EA
		mov	ax, [bp+vec.wX]
		neg	ax
		jmp	short loc_E1A_3ED
; ---------------------------------------------------------------------------
		nop
		nop

loc_E1A_376:				; CODE XREF: TrkTerrainWall+34Dj
		mov	ax, [bp+vec.wX]
		mov	[bp+var_1E], ax
		mov	ax, [bp+vec.wZ]

loc_E1A_37F:
		mov	[bp+vec.wX], ax
		mov	ax, [bp+var_1E]
		neg	ax
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec2.wX]
		mov	[bp+var_1E], ax
		mov	ax, [bp+vec2.wZ]
		mov	[bp+vec2.wX], ax
		mov	ax, [bp+var_1E]
		neg	ax

loc_E1A_39B:				; CODE XREF: TrkTerrainWall+3E7j
		mov	[bp+vec2.wZ], ax
		jmp	short loc_E1A_34F
; ---------------------------------------------------------------------------

loc_E1A_3A0:				; CODE XREF: TrkTerrainWall+348j
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+vec.wX], ax
		mov	ax, [bp+vec2.wZ]
		neg	ax
		mov	[bp+vec2.wZ], ax
		mov	ax, [bp+vec2.wX]
		neg	ax
		mov	[bp+vec2.wX], ax
		jmp	short loc_E1A_34F
; ---------------------------------------------------------------------------

loc_E1A_3C2:				; CODE XREF: TrkTerrainWall+343j
		mov	ax, [bp+vec.wX]
		mov	[bp+var_1E], ax
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wX], ax
		mov	ax, [bp+var_1E]
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec2.wX]
		mov	[bp+var_1E], ax
		mov	ax, [bp+vec2.wZ]
		neg	ax
		mov	[bp+vec2.wX], ax
		mov	ax, [bp+var_1E]
		jmp	short loc_E1A_39B
; ---------------------------------------------------------------------------
		nop

loc_E1A_3EA:				; CODE XREF: TrkTerrainWall+36Bj
		mov	ax, [bp+vec.wX]

loc_E1A_3ED:				; CODE XREF: TrkTerrainWall+372j
		mov	[bp+var_32], ax
		cmp	[bp+vec.wZ], 0
		jge	short loc_E1A_3FE
		mov	ax, [bp+vec.wZ]
		neg	ax
		jmp	short loc_E1A_401
; ---------------------------------------------------------------------------
		nop

loc_E1A_3FE:				; CODE XREF: TrkTerrainWall+3F4j
		mov	ax, [bp+vec.wZ]

loc_E1A_401:				; CODE XREF: TrkTerrainWall+3FBj
		mov	[bp+var_2E], ax
		mov	ax, [bp+var_24]
		cmp	ax, 4Ah	; 'J'
		jbe	short loc_E1A_40F
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_40F:				; CODE XREF: TrkTerrainWall+40Aj
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_E1A_15B0[bx]
; ---------------------------------------------------------------------------
		nop

loc_E1A_418:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall:off_E1A_15B0o
		cmp	gameState.cCvxFlag2, 0
		jnz	short loc_E1A_441
		cmp	[bp+vec.wX], 0
		jle	short loc_E1A_441
		cmp	[bp+vec.wZ], 0FE84h
		jge	short loc_E1A_434
		mov	g_wPlanIndex, 83h ; 'ƒ'
		jmp	short loc_E1A_441
; ---------------------------------------------------------------------------

loc_E1A_434:				; CODE XREF: TrkTerrainWall+42Aj
		cmp	[bp+vec.wZ], 0FED4h
		jge	short loc_E1A_441
		mov	g_wPlanIndex, 84h ; '„'

loc_E1A_441:				; CODE XREF: TrkTerrainWall+412j
					; TrkTerrainWall+41Dj ...
		cmp	[bp+var_32], 78h ; 'x'

loc_E1A_445:				; CODE XREF: TrkTerrainWall+45Ej
					; TrkTerrainWall+4A8j ...
		jl	short loc_E1A_44A
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_44A:				; CODE XREF: TrkTerrainWall:loc_E1A_445j
					; TrkTerrainWall+458j ...
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_454:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15C8o
		cmp	[bp+var_32], 78h ; 'x'
		jl	short loc_E1A_44A
		cmp	[bp+var_2E], 78h ; 'x'
		jmp	short loc_E1A_445
; ---------------------------------------------------------------------------

loc_E1A_460:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15BAo
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+vec.wX], ax

loc_E1A_468:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15B8o
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		cmp	[bp+vec.wX], 0
		jle	short loc_E1A_484
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+vec.wX], ax

loc_E1A_484:				; CODE XREF: TrkTerrainWall+412j
					; TrkTerrainWall+472j ...
		mov	ax, [bp+vec.wZ]
		add	ah, 4
		push	ax
		mov	ax, [bp+vec.wX]
		add	ah, 4

loc_E1A_491:				; CODE XREF: TrkTerrainWall+522j
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_A], ax
		cmp	ax, 588h
		jg	short loc_E1A_4A5
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_4A5:				; CODE XREF: TrkTerrainWall+4A0j
		cmp	ax, 678h
		jmp	short loc_E1A_445
; ---------------------------------------------------------------------------

loc_E1A_4AA:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15BCo
		cmp	[bp+var_32], 78h ; 'x'
		jl	short loc_E1A_44A

loc_E1A_4B0:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15B4o
		mov	ax, [bp+vec.wZ]
		add	ah, 2
		push	ax
		mov	ax, [bp+vec.wX]
		add	ah, 2

loc_E1A_4BD:				; CODE XREF: TrkTerrainWall+4EEj
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_A], ax
		cmp	ax, 188h
		jg	short loc_E1A_4D1
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_4D1:				; CODE XREF: TrkTerrainWall+4CCj
		cmp	ax, 278h
		jmp	loc_E1A_445
; ---------------------------------------------------------------------------
		nop

loc_E1A_4D8:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15BEo
		cmp	[bp+var_32], 78h ; 'x'
		jge	short loc_E1A_4E1
		jmp	loc_E1A_44A
; ---------------------------------------------------------------------------

loc_E1A_4E1:				; CODE XREF: TrkTerrainWall+4DCj
		mov	ax, [bp+vec.wZ]
		add	ah, 2
		push	ax
		mov	ax, 200h
		sub	ax, [bp+vec.wX]
		jmp	short loc_E1A_4BD
; ---------------------------------------------------------------------------

loc_E1A_4F0:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15C0o
		cmp	[bp+vec.wX], 188h
		jl	short loc_E1A_484
		cmp	[bp+vec.wX], 278h
		jg	short loc_E1A_501
		jmp	loc_E1A_44A
; ---------------------------------------------------------------------------

loc_E1A_501:				; CODE XREF: TrkTerrainWall+4FCj
		jmp	short loc_E1A_484
; ---------------------------------------------------------------------------
		nop

loc_E1A_504:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15C2o
		cmp	[bp+vec.wX], 0FD88h
		jl	short loc_E1A_515
		cmp	[bp+vec.wX], 0FE78h
		jg	short loc_E1A_515
		jmp	loc_E1A_44A
; ---------------------------------------------------------------------------

loc_E1A_515:				; CODE XREF: TrkTerrainWall+509j
					; TrkTerrainWall+510j
		mov	ax, [bp+vec.wZ]
		add	ah, 4
		push	ax
		mov	ax, 400h
		sub	ax, [bp+vec.wX]
		jmp	loc_E1A_491
; ---------------------------------------------------------------------------
		nop

loc_E1A_526:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15C4o
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_534
		mov	ax, [bp+vec.wX]
		neg	ax
		jmp	short loc_E1A_537
; ---------------------------------------------------------------------------
		nop

loc_E1A_534:				; CODE XREF: TrkTerrainWall+52Aj
		mov	ax, [bp+vec.wX]

loc_E1A_537:				; CODE XREF: TrkTerrainWall+531j
		mov	[bp+var_1C], ax
		sub	si, si
		jmp	short loc_E1A_53F
; ---------------------------------------------------------------------------

loc_E1A_53E:				; CODE XREF: TrkTerrainWall+54Aj
		inc	si

loc_E1A_53F:				; CODE XREF: TrkTerrainWall+53Cj
		mov	bx, si
		shl	bx, 1
		mov	ax, [bp+vec.wZ]
		cmp	word ptr unk_2B77_2EA8[bx], ax
		jl	short loc_E1A_53E
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2EB4[di]
		cmp	word ptr unk_2B77_2EB6[di], ax
		jz	short loc_E1A_58E
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2EA8[di]
		sub	ax, word ptr unk_2B77_2EA6[di]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+vec.wZ]
		sub	ax, word ptr unk_2B77_2EA6[di]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2EB6[di]
		sub	ax, word ptr unk_2B77_2EB4[di]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, word ptr unk_2B77_2EB4[di]

loc_E1A_58E:				; CODE XREF: TrkTerrainWall+558j
		mov	[bp+var_1E], ax
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2EC2[di]
		cmp	word ptr unk_2B77_2EC4[di], ax
		jz	short loc_E1A_5D3
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2EA8[di]
		sub	ax, word ptr unk_2B77_2EA6[di]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+vec.wZ]
		sub	ax, word ptr unk_2B77_2EA6[di]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2EC4[di]
		sub	ax, word ptr unk_2B77_2EC2[di]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, word ptr unk_2B77_2EC2[di]

loc_E1A_5D3:				; CODE XREF: TrkTerrainWall+59Dj
		mov	[bp+wXCosScale], ax
		mov	ax, [bp+var_1E]
		cmp	[bp+var_1C], ax
		jle	short loc_E1A_5E9
		mov	ax, [bp+wXCosScale]
		cmp	[bp+var_1C], ax
		jge	short loc_E1A_5E9
		jmp	loc_E1A_44A
; ---------------------------------------------------------------------------

loc_E1A_5E9:				; CODE XREF: TrkTerrainWall+5DCj
					; TrkTerrainWall+5E4j
		cmp	[bp+vec.wZ], 0
		jge	short loc_E1A_5F2
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_5F2:				; CODE XREF: TrkTerrainWall+5EDj
		cmp	[bp+var_1C], 78h ; 'x'
		jle	short loc_E1A_5FB
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_5FB:				; CODE XREF: TrkTerrainWall+5F6j
		mov	g_wPlanIndex, 1
		cmp	[bp+vec.wZ], 14Eh
		jl	short loc_E1A_620
		cmp	[bp+vec2.wX], 0FF88h
		jle	short loc_E1A_659

loc_E1A_60E:				; CODE XREF: TrkTerrainWall+657j
		cmp	[bp+vec2.wX], 78h ; 'x'
		jge	short loc_E1A_617
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_617:				; CODE XREF: TrkTerrainWall+612j
		mov	g_wTrkTerrSomeCode, 0BAh ; 'º'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_620:				; CODE XREF: TrkTerrainWall+606j
		cmp	[bp+vec2.wX], 0
		jl	short loc_E1A_630
		mov	g_wTrkTerrSomeCode, 0BBh ; '»'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_630:				; CODE XREF: TrkTerrainWall+624j
		mov	g_wTrkTerrSomeCode, 0BDh ; '½'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_63A:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15C6o
		cmp	[bp+var_32], 168h
		jle	short loc_E1A_644
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_644:				; CODE XREF: TrkTerrainWall+63Fj
		cmp	[bp+var_32], 78h ; 'x'
		jle	short loc_E1A_64D
		jmp	loc_E1A_44A
; ---------------------------------------------------------------------------

loc_E1A_64D:				; CODE XREF: TrkTerrainWall+648j
		mov	g_wPlanIndex, 1
		cmp	[bp+vec2.wX], 0FF88h
		jg	short loc_E1A_60E

loc_E1A_659:				; CODE XREF: TrkTerrainWall+60Cj
		mov	g_wTrkTerrSomeCode, 0BCh ; '¼'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_662:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15D0o
		cmp	[bp+vec.wZ], 0
		jle	short loc_E1A_670
		mov	byte_2B77_81BC,	0
		jmp	short loc_E1A_68B
; ---------------------------------------------------------------------------
		nop

loc_E1A_670:				; CODE XREF: TrkTerrainWall+666j
		cmp	[bp+vec2.wZ], 0
		jl	short loc_E1A_68B
		mov	g_wTrkTerrSomeCode, 66h	; 'f'
		jmp	short loc_E1A_68B
; ---------------------------------------------------------------------------

loc_E1A_67E:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15D2o
		cmp	[bp+vec2.wZ], 1DCh
		jl	short loc_E1A_68B
		mov	g_wTrkTerrSomeCode, 67h	; 'g'

loc_E1A_68B:				; CODE XREF: TrkTerrainWall+66Dj
					; TrkTerrainWall+674j ...
		cmp	[bp+vec2.wX], 0
		jge	short loc_E1A_698
		mov	ax, [bp+vec2.wX]
		neg	ax
		jmp	short loc_E1A_69B
; ---------------------------------------------------------------------------

loc_E1A_698:				; CODE XREF: TrkTerrainWall+68Fj
		mov	ax, [bp+vec2.wX]

loc_E1A_69B:				; CODE XREF: TrkTerrainWall+696j
		cmp	ax, 78h	; 'x'
		jge	short loc_E1A_6E6
		mov	g_wPlanIndex, 3
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		cmp	g_wTrkTerrSomeCode, 0FFFFh
		jz	short loc_E1A_6B6
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_6B6:				; CODE XREF: TrkTerrainWall+6B1j
		cmp	[bp+vec.wZ], 0
		jge	short loc_E1A_6BF
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_6BF:				; CODE XREF: TrkTerrainWall+6BAj
		cmp	[bp+var_32], 78h ; 'x'
		jge	short loc_E1A_6C8
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_6C8:				; CODE XREF: TrkTerrainWall+6C3j
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		mov	word_2B77_9218,	0FFF4h
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_6DD
		jmp	loc_E1A_7CF
; ---------------------------------------------------------------------------

loc_E1A_6DD:				; CODE XREF: TrkTerrainWall+6D8j
					; TrkTerrainWall+7CCj ...
		mov	g_wTrkTerrSomeCode, 65h	; 'e'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_6E6:				; CODE XREF: TrkTerrainWall+69Ej
		cmp	byte_2B77_81BC,	0
		jnz	short loc_E1A_6F0
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_6F0:				; CODE XREF: TrkTerrainWall+6EBj
		cmp	[bp+var_32], 78h ; 'x'
		jle	short loc_E1A_6F9
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_6F9:				; CODE XREF: TrkTerrainWall+6F4j
		mov	g_wPlanIndex, 3
		cmp	g_wTrkTerrSomeCode, 0FFFFh
		jz	short loc_E1A_709
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_709:				; CODE XREF: TrkTerrainWall+704j
		mov	[bp+var_38], 200h

loc_E1A_70E:				; CODE XREF: TrkTerrainWall+79Ej
		cmp	[bp+vec.wX], 0
		jmp	loc_E1A_7CA
; ---------------------------------------------------------------------------
		nop

loc_E1A_716:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15DCo
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 186h
		jle	short loc_E1A_738

loc_E1A_725:				; CODE XREF: TrkTerrainWall:loc_E1A_756j
		mov	byte_2B77_81BC,	0

loc_E1A_72A:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15D8o
		cmp	[bp+vec2.wX], 0
		jge	short loc_E1A_758
		mov	ax, [bp+vec2.wX]
		neg	ax
		jmp	short loc_E1A_75B
; ---------------------------------------------------------------------------
		nop

loc_E1A_738:				; CODE XREF: TrkTerrainWall+723j
		cmp	[bp+var_2E], 78h ; 'x'

loc_E1A_73C:				; CODE XREF: TrkTerrainWall+C9Bj
		jle	short loc_E1A_741
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_741:				; CODE XREF: TrkTerrainWall:loc_E1A_73Cj
		jmp	loc_E1A_44A
; ---------------------------------------------------------------------------

loc_E1A_744:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15D4o ...
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+Vector3D.wY]
		sub	ax, g_dwSomeY
		cmp	ax, 186h
		jg	short loc_E1A_756
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_756:				; CODE XREF: TrkTerrainWall+751j
		jmp	short loc_E1A_725
; ---------------------------------------------------------------------------

loc_E1A_758:				; CODE XREF: TrkTerrainWall+72Ej
		mov	ax, [bp+vec2.wX]

loc_E1A_75B:				; CODE XREF: TrkTerrainWall+735j
		cmp	ax, 78h	; 'x'
		jg	short loc_E1A_7A2
		mov	g_wPlanIndex, 2
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		cmp	byte_2B77_81BC,	0
		jz	short loc_E1A_78F
		cmp	[bp+vec2.wZ], 1DCh
		jl	short loc_E1A_782
		mov	g_wTrkTerrSomeCode, 67h	; 'g'
		jmp	short loc_E1A_78F
; ---------------------------------------------------------------------------

loc_E1A_782:				; CODE XREF: TrkTerrainWall+778j
		cmp	[bp+vec2.wZ], 0FE24h
		jg	short loc_E1A_78F
		mov	g_wTrkTerrSomeCode, 68h	; 'h'

loc_E1A_78F:				; CODE XREF: TrkTerrainWall+771j
					; TrkTerrainWall+780j ...
		cmp	[bp+var_32], 78h ; 'x'
		jge	short loc_E1A_798
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_798:				; CODE XREF: TrkTerrainWall+793j
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		jmp	loc_E1A_70E
; ---------------------------------------------------------------------------
		nop

loc_E1A_7A2:				; CODE XREF: TrkTerrainWall+75Ej
		cmp	byte_2B77_81BC,	0
		jnz	short loc_E1A_7AC
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_7AC:				; CODE XREF: TrkTerrainWall+7A7j
		cmp	[bp+var_32], 78h ; 'x'
		jle	short loc_E1A_7B5
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_7B5:				; CODE XREF: TrkTerrainWall+7B0j
		mov	g_wPlanIndex, 2
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		mov	[bp+var_38], 200h
		cmp	[bp+vec2.wX], 0

loc_E1A_7CA:				; CODE XREF: TrkTerrainWall+712j
		jl	short loc_E1A_7CF
		jmp	loc_E1A_6DD
; ---------------------------------------------------------------------------

loc_E1A_7CF:				; CODE XREF: TrkTerrainWall+6DAj
					; TrkTerrainWall:loc_E1A_7CAj
		mov	g_wTrkTerrSomeCode, 64h	; 'd'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_7D8:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15DAo
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+Vector3D.wY]
		sub	ax, g_dwSomeY
		cmp	ax, 186h
		jg	short loc_E1A_7EA
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_7EA:				; CODE XREF: TrkTerrainWall+7E5j
		mov	ax, [bp+vec.wZ]
		add	ah, 4
		push	ax
		mov	ax, [bp+vec.wX]
		add	ah, 4
		push	ax
		call	XZCosOrSin
		add	sp, 4
		sub	ax, 600h
		mov	[bp+var_A], ax
		cmp	ax, 0FF6Ah
		jg	short loc_E1A_80E
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_80E:				; CODE XREF: TrkTerrainWall+809j
		cmp	ax, 96h	; '–'
		jl	short loc_E1A_816
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_816:				; CODE XREF: TrkTerrainWall+811j
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	g_wPlanIndex, 2
		mov	byte_2B77_81BC,	0
		cmp	[bp+var_A], 0FF94h
		jl	short loc_E1A_836
		cmp	[bp+var_A], 6Ch	; 'l'
		jg	short loc_E1A_836
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_836:				; CODE XREF: TrkTerrainWall+82Bj
					; TrkTerrainWall+831j
		mov	ax, [bp+vec.wZ]
		add	ah, 4
		push	ax
		mov	ax, [bp+vec.wX]
		add	ah, 4
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		sub	ah, ah
		mov	cx, 12h
		imul	cx
		mov	[bp+wXCosScale], ax
		mov	cl, 8
		sar	ax, cl
		sub	ax, 11h
		neg	ax
		mov	[bp+var_1E], ax
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		mov	word_2B77_9218,	0FFF4h
		cmp	[bp+var_A], 0
		jge	short loc_E1A_87A
		add	ax, 69h	; 'i'
		jmp	short loc_E1A_880
; ---------------------------------------------------------------------------
		nop

loc_E1A_87A:				; CODE XREF: TrkTerrainWall+872j
		mov	ax, [bp+var_1E]
		add	ax, 7Bh	; '{'

loc_E1A_880:				; CODE XREF: TrkTerrainWall+877j
					; TrkTerrainWall+127Aj
		mov	g_wTrkTerrSomeCode, ax
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_886:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15E0o
		mov	[bp+var_1C], 23h ; '#'
		mov	[bp+var_1E], 0
		mov	si, 0FD60h
		jmp	short loc_E1A_8A3
; ---------------------------------------------------------------------------
		nop

loc_E1A_896:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15DEo
		mov	[bp+var_1C], 19h
		mov	[bp+var_1E], 1
		mov	si, 0A0h ; ' '

loc_E1A_8A3:				; CODE XREF: TrkTerrainWall+893j
		cmp	[bp+var_32], 78h ; 'x'
		jle	short loc_E1A_8AC
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_8AC:				; CODE XREF: TrkTerrainWall+8A7j
		cmp	[bp+var_1E], 0
		jnz	short loc_E1A_8C6
		cmp	[bp+vec2.wX], 0FF88h
		jg	short loc_E1A_8C6
		mov	[bp+var_38], 200h
		mov	g_wTrkTerrSomeCode, 64h	; 'd'
		jmp	short loc_E1A_8DD
; ---------------------------------------------------------------------------
		nop

loc_E1A_8C6:				; CODE XREF: TrkTerrainWall+8B0j
					; TrkTerrainWall+8B6j
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_8DD
		cmp	[bp+vec2.wX], 78h ; 'x'
		jl	short loc_E1A_8DD
		mov	[bp+var_38], 200h
		mov	g_wTrkTerrSomeCode, 65h	; 'e'

loc_E1A_8DD:				; CODE XREF: TrkTerrainWall+8C3j
					; TrkTerrainWall+8CAj ...
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		cmp	[bp+vec.wZ], 0FEB2h
		jge	short loc_E1A_8F0
		mov	ax, [bp+var_1C]
		jmp	short loc_E1A_8FD
; ---------------------------------------------------------------------------
		nop

loc_E1A_8F0:				; CODE XREF: TrkTerrainWall+8E8j
		cmp	[bp+vec.wZ], 14Eh
		jl	short loc_E1A_904
		mov	ax, [bp+var_1C]
		add	ax, 9

loc_E1A_8FD:				; CODE XREF: TrkTerrainWall+8EDj
					; TrkTerrainWall+11ACj
		mov	g_wPlanIndex, ax
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_904:				; CODE XREF: TrkTerrainWall+8F5j
		cmp	[bp+vec.wZ], 0FF58h
		jge	short loc_E1A_91A
		mov	ax, [bp+var_1C]
		inc	ax
		mov	g_wPlanIndex, ax
		mov	[bp+var_1E], 0
		jmp	short loc_E1A_95D
; ---------------------------------------------------------------------------
		nop

loc_E1A_91A:				; CODE XREF: TrkTerrainWall+909j
		cmp	[bp+vec.wZ], 0
		jge	short loc_E1A_930
		mov	ax, [bp+var_1C]
		add	ax, 3
		mov	g_wPlanIndex, ax
		mov	[bp+var_1E], 1
		jmp	short loc_E1A_95D
; ---------------------------------------------------------------------------

loc_E1A_930:				; CODE XREF: TrkTerrainWall+91Ej
		cmp	[bp+vec.wZ], 0A8h ; '¨'
		jge	short loc_E1A_948
		mov	ax, [bp+var_1C]
		add	ax, 5
		mov	g_wPlanIndex, ax
		mov	[bp+var_1E], 2
		jmp	short loc_E1A_95D
; ---------------------------------------------------------------------------
		nop

loc_E1A_948:				; CODE XREF: TrkTerrainWall+935j
		cmp	[bp+vec.wZ], 14Eh
		jge	short loc_E1A_95D
		mov	ax, [bp+var_1C]
		add	ax, 7
		mov	g_wPlanIndex, ax
		mov	[bp+var_1E], 3

loc_E1A_95D:				; CODE XREF: TrkTerrainWall+917j
					; TrkTerrainWall+92Ej ...
		mov	ax, [bp+vec.wZ]
		mov	bx, [bp+var_1E]
		shl	bx, 1
		sub	ax, word ptr unk_2B77_2E6E[bx]
		push	ax
		push	si
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		push	[bp+vec.wX]
		push	si
		mov	di, ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, di
		mov	[bp+wXCosScale], ax
		or	ax, ax
		jg	short loc_E1A_99F
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_99F:				; CODE XREF: TrkTerrainWall+99Aj
					; TrkTerrainWall:loc_E1A_E7Cj
		inc	g_wPlanIndex
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_9A6:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15E2o
		cmp	[bp+var_32], 78h ; 'x'
		jle	short loc_E1A_9AF
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_9AF:				; CODE XREF: TrkTerrainWall+9AAj
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	g_wPlanIndex, 6
		cmp	[bp+vec2.wX], 78h ; 'x'
		jge	short loc_E1A_9C4
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_9C4:				; CODE XREF: TrkTerrainWall+9BFj
		mov	[bp+var_38], 200h
		jmp	loc_E1A_6DD
; ---------------------------------------------------------------------------

loc_E1A_9CC:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15E4o
		mov	ax, [bp+vec.wZ]
		add	ah, 4
		push	ax
		mov	ax, [bp+vec.wX]
		add	ah, 4
		push	ax
		call	XZCosOrSin
		add	sp, 4
		sub	ax, 600h
		mov	[bp+var_A], ax
		cmp	ax, 0FF88h
		jg	short loc_E1A_9F0
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_9F0:				; CODE XREF: TrkTerrainWall+9EBj
		cmp	ax, 7Eh	; '~'
		jl	short loc_E1A_9F8
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_9F8:				; CODE XREF: TrkTerrainWall+9F3j
		mov	ax, [bp+vec.wZ]
		add	ah, 4
		push	ax
		mov	ax, [bp+vec.wX]
		add	ah, 4
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		sub	ah, ah
		mov	cx, 12h
		imul	cx
		mov	[bp+wXCosScale], ax
		mov	cl, 8
		sar	ax, cl
		sub	ax, 11h
		neg	ax
		mov	[bp+var_1E], ax
		add	ax, 7
		mov	g_wPlanIndex, ax
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		cmp	[bp+var_A], 66h	; 'f'
		jg	short loc_E1A_A39
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_A39:				; CODE XREF: TrkTerrainWall+A34j
		mov	[bp+var_38], 200h
		mov	ax, [bp+var_1E]
		add	ax, 7Bh	; '{'
		mov	g_wTrkTerrSomeCode, ax

loc_E1A_A47:				; CODE XREF: TrkTerrainWall+B61j
					; TrkTerrainWall+1204j
		mov	byte_2B77_81BC,	0
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_A50:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15E6o
		cmp	[bp+vec.wZ], 0
		jge	short loc_E1A_A6A
		mov	[bp+var_1C], 33h ; '3'
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+var_6], ax
		mov	ax, [bp+vec.wZ]
		neg	ax
		jmp	short loc_E1A_A78
; ---------------------------------------------------------------------------

loc_E1A_A6A:				; CODE XREF: TrkTerrainWall+A54j
		mov	[bp+var_1C], 2Dh ; '-'
		mov	ax, [bp+vec.wX]
		mov	[bp+var_6], ax
		mov	ax, [bp+vec.wZ]

loc_E1A_A78:				; CODE XREF: TrkTerrainWall+A68j
		mov	[bp+var_2], ax
		mov	ax, word ptr unk_2B77_2E20
		dec	ax
		cmp	[bp+var_2], ax
		jle	short loc_E1A_A98
		mov	ax, word ptr unk_2B77_2E20
		add	ax, 64h	; 'd'
		cmp	[bp+var_2], ax
		jle	short loc_E1A_A92
		jmp	loc_E1A_C0D
; ---------------------------------------------------------------------------

loc_E1A_A92:				; CODE XREF: TrkTerrainWall+A8Dj
		mov	ax, word ptr unk_2B77_2E20
		dec	ax
		jmp	short loc_E1A_A9B
; ---------------------------------------------------------------------------

loc_E1A_A98:				; CODE XREF: TrkTerrainWall+A82j
		mov	ax, [bp+var_2]

loc_E1A_A9B:				; CODE XREF: TrkTerrainWall+A96j
		mov	[bp+var_1E], ax
		sub	si, si
		jmp	short loc_E1A_AA3
; ---------------------------------------------------------------------------

loc_E1A_AA2:				; CODE XREF: TrkTerrainWall+AAEj
		inc	si

loc_E1A_AA3:				; CODE XREF: TrkTerrainWall+AA0j
		mov	bx, si
		shl	bx, 1
		mov	ax, [bp+var_1E]
		cmp	word ptr unk_2B77_2E1C[bx], ax
		jl	short loc_E1A_AA2
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 20Ch
		jg	short loc_E1A_AC2
		jmp	loc_E1A_B64
; ---------------------------------------------------------------------------

loc_E1A_AC2:				; CODE XREF: TrkTerrainWall+ABDj
		mov	ax, 5
		sub	ax, si
		mov	si, ax
		mov	di, si
		shl	di, 1
		mov	ax, [bp+var_6]
		cmp	word ptr unk_2B77_2E28[di], ax
		jle	short loc_E1A_AD9
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_AD9:				; CODE XREF: TrkTerrainWall+AD4j
		mov	ax, word ptr unk_2B77_2E2A[di]
		add	ax, 190h
		cmp	ax, [bp+var_6]
		jge	short loc_E1A_AE8
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_AE8:				; CODE XREF: TrkTerrainWall+AE3j
		mov	ax, [bp+var_6]
		cmp	word ptr unk_2B77_2E2A[di], ax
		jge	short loc_E1A_AFD
		mov	ax, word ptr unk_2B77_2E28[di]
		add	ax, 190h
		cmp	ax, [bp+var_6]
		jg	short loc_E1A_B53

loc_E1A_AFD:				; CODE XREF: TrkTerrainWall+AEFj
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2E1C[di]
		sub	ax, word ptr unk_2B77_2E1A[di]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2E1A[di]
		sub	ax, [bp+var_1E]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2E28[di]
		sub	ax, word ptr unk_2B77_2E2A[di]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+wXCosScale], ax
		mov	ax, word ptr unk_2B77_2E28[di]
		add	ax, [bp+wXCosScale]
		mov	[bp+c2wZVal], ax
		mov	ax, [bp+var_6]
		cmp	[bp+c2wZVal], ax
		jl	short loc_E1A_B45
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_B45:				; CODE XREF: TrkTerrainWall+B40j
		mov	ax, [bp+c2wZVal]
		add	ax, 190h
		cmp	ax, [bp+var_6]
		jg	short loc_E1A_B53
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_B53:				; CODE XREF: TrkTerrainWall+AFBj
					; TrkTerrainWall+B4Ej ...
		mov	ax, [bp+var_1C]
		add	ax, si
		mov	g_wPlanIndex, ax
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		jmp	loc_E1A_A47
; ---------------------------------------------------------------------------

loc_E1A_B64:				; CODE XREF: TrkTerrainWall+ABFj
		cmp	si, 1
		jle	short loc_E1A_B7B
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 64h	; 'd'
		jge	short loc_E1A_B7B
		jmp	loc_E1A_C0D
; ---------------------------------------------------------------------------

loc_E1A_B7B:				; CODE XREF: TrkTerrainWall+B67j
					; TrkTerrainWall+B76j
		mov	di, si
		shl	di, 1
		mov	ax, [bp+var_6]
		cmp	word ptr unk_2B77_2E28[di], ax
		jle	short loc_E1A_B8B
		jmp	loc_E1A_C0D
; ---------------------------------------------------------------------------

loc_E1A_B8B:				; CODE XREF: TrkTerrainWall+B86j
		mov	ax, word ptr unk_2B77_2E2A[di]
		add	ax, 190h
		cmp	ax, [bp+var_6]
		jl	short loc_E1A_C0D
		mov	ax, [bp+var_6]
		cmp	word ptr unk_2B77_2E2A[di], ax
		jge	short loc_E1A_BAC
		mov	ax, word ptr unk_2B77_2E28[di]
		add	ax, 190h
		cmp	ax, [bp+var_6]
		jg	short loc_E1A_B53

loc_E1A_BAC:				; CODE XREF: TrkTerrainWall+B9Ej
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2E28[di]
		cmp	word ptr unk_2B77_2E2A[di], ax
		jz	short loc_E1A_C0D
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2E1C[di]
		sub	ax, word ptr unk_2B77_2E1A[di]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2E1A[di]
		sub	ax, [bp+var_1E]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2E28[di]
		sub	ax, word ptr unk_2B77_2E2A[di]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	[bp+wXCosScale], ax
		mov	ax, word ptr unk_2B77_2E28[di]
		add	ax, [bp+wXCosScale]
		mov	[bp+c2wZVal], ax
		mov	ax, [bp+var_6]
		cmp	[bp+c2wZVal], ax
		jge	short loc_E1A_C0D
		mov	ax, [bp+c2wZVal]
		add	ax, 190h
		cmp	ax, [bp+var_6]
		jle	short loc_E1A_C0D
		jmp	loc_E1A_B53
; ---------------------------------------------------------------------------

loc_E1A_C0D:				; CODE XREF: TrkTerrainWall+A8Fj
					; TrkTerrainWall+B78j ...
		sub	si, si
		jmp	short loc_E1A_C13
; ---------------------------------------------------------------------------
		nop

loc_E1A_C12:				; CODE XREF: TrkTerrainWall+C1Ej
		inc	si

loc_E1A_C13:				; CODE XREF: TrkTerrainWall+C0Fj
		mov	bx, si
		shl	bx, 1
		mov	ax, [bp+var_2]
		cmp	word ptr unk_2B77_2E46[bx], ax
		jl	short loc_E1A_C12
		mov	di, si
		shl	di, 1
		mov	ax, word ptr unk_2B77_2E46[di]
		sub	ax, word ptr unk_2B77_2E44[di]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_2]
		sub	ax, word ptr unk_2B77_2E44[di]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2E54[di]
		sub	ax, word ptr unk_2B77_2E52[di]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, word ptr unk_2B77_2E52[di]
		mov	[bp+var_1E], ax
		mov	ax, word ptr unk_2B77_2E46[di]
		sub	ax, word ptr unk_2B77_2E44[di]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+var_2]
		sub	ax, word ptr unk_2B77_2E44[di]
		cwd
		push	dx
		push	ax
		mov	ax, word ptr unk_2B77_2E62[di]
		sub	ax, word ptr unk_2B77_2E60[di]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, word ptr unk_2B77_2E60[di]
		mov	[bp+wXCosScale], ax
		mov	ax, [bp+var_1E]
		cmp	[bp+var_6], ax
		jge	short loc_E1A_C95
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_C95:				; CODE XREF: TrkTerrainWall+C90j
		mov	ax, [bp+wXCosScale]
		cmp	[bp+var_6], ax
		jmp	loc_E1A_73C
; ---------------------------------------------------------------------------

loc_E1A_C9E:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15E8o
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 90h	; ''
		jge	short loc_E1A_CBC
		mov	bx, [bp+p_pVec2]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 90h	; ''
		jl	short loc_E1A_CD6

loc_E1A_CBC:				; CODE XREF: TrkTerrainWall+CABj
		cmp	[bp+var_32], 10Eh
		jl	short loc_E1A_CC6
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_CC6:				; CODE XREF: TrkTerrainWall+CC1j
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	g_wPlanIndex, 85h ; '…'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_CD6:				; CODE XREF: TrkTerrainWall+CBAj
		cmp	[bp+var_32], 78h ; 'x'
		jge	short loc_E1A_CE2
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al

loc_E1A_CE2:				; CODE XREF: TrkTerrainWall+CDAj
		cmp	[bp+vec.wX], 78h ; 'x'
		jl	short loc_E1A_D26
		cmp	[bp+vec.wX], 10Eh
		jg	short loc_E1A_D26
		mov	g_wTrkTerrnSomeCode2, 90h ; ''
		cmp	[bp+vec2.wZ], 0FE00h
		jle	short loc_E1A_D46
		cmp	[bp+vec2.wZ], 200h
		jge	short loc_E1A_D57
		cmp	[bp+vec2.wX], 78h ; 'x'
		jg	short loc_E1A_D12
		mov	g_wTrkTerrSomeCode, 98h	; '˜'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_D12:				; CODE XREF: TrkTerrainWall+D07j
		cmp	[bp+vec2.wX], 10Eh
		jge	short loc_E1A_D1C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_D1C:				; CODE XREF: TrkTerrainWall+D17j
		mov	g_wTrkTerrSomeCode, 96h	; '–'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_D26:				; CODE XREF: TrkTerrainWall+CE6j
					; TrkTerrainWall+CEDj
		cmp	[bp+vec.wX], 0FF88h
		jle	short loc_E1A_D2F
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_D2F:				; CODE XREF: TrkTerrainWall+D2Aj
		cmp	[bp+vec.wX], 0FEF2h
		jge	short loc_E1A_D39
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_D39:				; CODE XREF: TrkTerrainWall+D34j
		mov	g_wTrkTerrnSomeCode2, 90h ; ''
		cmp	[bp+vec2.wZ], 0FE00h
		jg	short loc_E1A_D50

loc_E1A_D46:				; CODE XREF: TrkTerrainWall+CFAj
		mov	g_wTrkTerrSomeCode, 9Ah	; 'š'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_D50:				; CODE XREF: TrkTerrainWall+D44j
		cmp	[bp+vec2.wZ], 200h
		jl	short loc_E1A_D60

loc_E1A_D57:				; CODE XREF: TrkTerrainWall+D01j
		mov	g_wTrkTerrSomeCode, 99h	; '™'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_D60:				; CODE XREF: TrkTerrainWall+D55j
		cmp	[bp+vec2.wX], 0FF88h
		jl	short loc_E1A_D70
		mov	g_wTrkTerrSomeCode, 97h	; '—'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_D70:				; CODE XREF: TrkTerrainWall+D64j
		cmp	[bp+vec2.wX], 0FEF2h
		jle	short loc_E1A_D7A
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_D7A:				; CODE XREF: TrkTerrainWall+D75j
		mov	g_wTrkTerrSomeCode, 95h	; '•'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_D84:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15EAo
		cmp	[bp+vec2.wX], 0
		jge	short loc_E1A_D92
		mov	ax, [bp+vec2.wX]
		neg	ax
		jmp	short loc_E1A_D95
; ---------------------------------------------------------------------------
		nop

loc_E1A_D92:				; CODE XREF: TrkTerrainWall+D88j
		mov	ax, [bp+vec2.wX]

loc_E1A_D95:				; CODE XREF: TrkTerrainWall+D8Fj
		cmp	ax, 73h	; 's'
		jl	short loc_E1A_DC0
		cmp	[bp+var_32], 0A4h ; '¤'
		jg	short loc_E1A_DC0
		mov	g_wTrkTerrnSomeCode2, 97h ; '—'
		cmp	[bp+vec2.wX], 0
		jle	short loc_E1A_DB6
		mov	g_wTrkTerrSomeCode, 9Fh	; 'Ÿ'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_DB6:				; CODE XREF: TrkTerrainWall+DABj
		mov	g_wTrkTerrSomeCode, 0A0h ; ' '
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_DC0:				; CODE XREF: TrkTerrainWall+D98j
					; TrkTerrainWall+D9Fj
		cmp	[bp+var_32], 73h ; 's'
		jl	short loc_E1A_DC9
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_DC9:				; CODE XREF: TrkTerrainWall+DC4j
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 0ABh ; '«'
		jl	short loc_E1A_DDB
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_DDB:				; CODE XREF: TrkTerrainWall+DD6j
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		cmp	[bp+var_32], 1Fh
		jge	short loc_E1A_DF0
		mov	g_wPlanIndex, 46h ; 'F'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_DF0:				; CODE XREF: TrkTerrainWall+DE5j
		cmp	[bp+vec.wX], 0FFACh
		jge	short loc_E1A_E06
		mov	g_wPlanIndex, 49h ; 'I'
		mov	[bp+var_1E], 0FF9Ch
		mov	si, 0FFFBh
		jmp	short loc_E1A_E40
; ---------------------------------------------------------------------------

loc_E1A_E06:				; CODE XREF: TrkTerrainWall+DF4j
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_E1C
		mov	g_wPlanIndex, 47h ; 'G'
		mov	[bp+var_1E], 0FFC7h
		mov	si, 0FFF8h
		jmp	short loc_E1A_E40
; ---------------------------------------------------------------------------

loc_E1A_E1C:				; CODE XREF: TrkTerrainWall+E0Aj
		cmp	[bp+vec.wX], 54h ; 'T'
		jle	short loc_E1A_E32
		mov	g_wPlanIndex, 4Dh ; 'M'
		mov	[bp+var_1E], 64h ; 'd'
		mov	si, 5
		jmp	short loc_E1A_E40
; ---------------------------------------------------------------------------

loc_E1A_E32:				; CODE XREF: TrkTerrainWall+E20j
		mov	g_wPlanIndex, 4Bh ; 'K'
		mov	[bp+var_1E], 39h ; '9'
		mov	si, 8

loc_E1A_E40:				; CODE XREF: TrkTerrainWall+E04j
					; TrkTerrainWall+E1Aj ...
		push	[bp+vec.wZ]
		push	si
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	cx, [bp+vec.wX]
		sub	cx, [bp+var_1E]
		push	cx
		push	si
		mov	di, ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, di
		mov	[bp+wXCosScale], ax
		or	ax, ax
		jl	short loc_E1A_E7C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_E7C:				; CODE XREF: TrkTerrainWall+E77j
		jmp	loc_E1A_99F
; ---------------------------------------------------------------------------
		nop

loc_E1A_E80:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15EEo
		mov	[bp+wXCosScale], 1
		jmp	short loc_E1A_E8D
; ---------------------------------------------------------------------------
		nop

loc_E1A_E88:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15ECo
		mov	[bp+wXCosScale], 0

loc_E1A_E8D:				; CODE XREF: TrkTerrainWall+E85j
		cmp	[bp+vec2.wX], 0
		jge	short loc_E1A_E9A
		mov	ax, [bp+vec2.wX]
		neg	ax
		jmp	short loc_E1A_E9D
; ---------------------------------------------------------------------------

loc_E1A_E9A:				; CODE XREF: TrkTerrainWall+E91j
		mov	ax, [bp+vec2.wX]

loc_E1A_E9D:				; CODE XREF: TrkTerrainWall+E98j
		cmp	ax, 0A4h ; '¤'
		jl	short loc_E1A_EC8
		cmp	[bp+var_32], 0A4h ; '¤'
		jg	short loc_E1A_EC8
		mov	g_wTrkTerrnSomeCode2, 97h ; '—'
		cmp	[bp+vec2.wX], 0
		jle	short loc_E1A_EBE
		mov	g_wTrkTerrSomeCode, 9Bh	; '›'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_EBE:				; CODE XREF: TrkTerrainWall+EB3j
		mov	g_wTrkTerrSomeCode, 9Ch	; 'œ'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_EC8:				; CODE XREF: TrkTerrainWall+EA0j
					; TrkTerrainWall+EA7j
		cmp	[bp+var_32], 0A4h ; '¤'
		jl	short loc_E1A_ED2
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_ED2:				; CODE XREF: TrkTerrainWall+ECDj
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 109h
		jl	short loc_E1A_EE4
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_EE4:				; CODE XREF: TrkTerrainWall+EDFj
		cmp	[bp+var_32], 82h ; '‚'
		jge	short loc_E1A_EF1
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al

loc_E1A_EF1:				; CODE XREF: TrkTerrainWall+EE9j
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 97h	; '—'
		jle	short loc_E1A_F04
		mov	[bp+var_1E], 1
		jmp	short loc_E1A_F09
; ---------------------------------------------------------------------------

loc_E1A_F04:				; CODE XREF: TrkTerrainWall+EFBj
		mov	[bp+var_1E], 0

loc_E1A_F09:				; CODE XREF: TrkTerrainWall+F02j
		cmp	[bp+wXCosScale], 0
		jz	short loc_E1A_F48
		cmp	[bp+var_1E], 0
		jnz	short loc_E1A_F48
		cmp	[bp+var_32], 54h ; 'T'
		jg	short loc_E1A_F48
		cmp	[bp+var_2E], 4Bh ; 'K'
		jg	short loc_E1A_F48
		mov	g_wPlanIndex, 45h ; 'E'
		cmp	[bp+vec2.wZ], 0FFB5h
		jg	short loc_E1A_F36
		mov	g_wTrkTerrSomeCode, 9Dh	; ''
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_F36:				; CODE XREF: TrkTerrainWall+F2Bj
		cmp	[bp+vec2.wZ], 4Bh ; 'K'
		jge	short loc_E1A_F3F
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_F3F:				; CODE XREF: TrkTerrainWall+F3Aj
		mov	g_wTrkTerrSomeCode, 9Eh	; 'ž'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_F48:				; CODE XREF: TrkTerrainWall+F0Dj
					; TrkTerrainWall+F13j ...
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 58h	; 'X'
		jle	short loc_E1A_F76
		cmp	[bp+var_1E], 0
		jnz	short loc_E1A_F76
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_F6C
		mov	g_wPlanIndex, 3Ch ; '<'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_F6C:				; CODE XREF: TrkTerrainWall+F61j
		mov	g_wPlanIndex, 42h ; 'B'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_F76:				; CODE XREF: TrkTerrainWall+F55j
					; TrkTerrainWall+F5Bj
		cmp	[bp+var_32], 1Fh
		jge	short loc_E1A_F96
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_F8C
		mov	g_wPlanIndex, 3Fh ; '?'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_F8C:				; CODE XREF: TrkTerrainWall+F80j
		mov	g_wPlanIndex, 39h ; '9'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_F96:				; CODE XREF: TrkTerrainWall+F7Aj
		cmp	[bp+vec.wX], 0FFACh
		jge	short loc_E1A_FB6
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_FAC
		mov	g_wPlanIndex, 3Dh ; '='
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FAC:				; CODE XREF: TrkTerrainWall+FA0j
		mov	g_wPlanIndex, 3Bh ; ';'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FB6:				; CODE XREF: TrkTerrainWall+F9Aj
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_FD6
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_FCC
		mov	g_wPlanIndex, 3Eh ; '>'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FCC:				; CODE XREF: TrkTerrainWall+FC0j
		mov	g_wPlanIndex, 3Ah ; ':'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FD6:				; CODE XREF: TrkTerrainWall+FBAj
		cmp	[bp+vec.wX], 54h ; 'T'
		jle	short loc_E1A_FF6
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_FEC
		mov	g_wPlanIndex, 41h ; 'A'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FEC:				; CODE XREF: TrkTerrainWall+FE0j
		mov	g_wPlanIndex, 43h ; 'C'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_FF6:				; CODE XREF: TrkTerrainWall+FDAj
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_1006
		mov	g_wPlanIndex, 40h ; '@'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_1006:				; CODE XREF: TrkTerrainWall+FFAj
		mov	g_wPlanIndex, 44h ; 'D'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_1010:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15F6o
		cmp	[bp+var_32], 96h ; '–'
		jl	short loc_E1A_101A
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_101A:				; CODE XREF: TrkTerrainWall+1015j
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 109h
		jl	short loc_E1A_102C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_102C:				; CODE XREF: TrkTerrainWall+1027j
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 97h	; '—'
		jle	short loc_E1A_1046
		mov	[bp+var_1E], 1
		jmp	short loc_E1A_104B
; ---------------------------------------------------------------------------
		nop

loc_E1A_1046:				; CODE XREF: TrkTerrainWall+103Cj
		mov	[bp+var_1E], 0

loc_E1A_104B:				; CODE XREF: TrkTerrainWall+1043j
		mov	[bp+wXCosScale], 0
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 58h	; 'X'
		jle	short loc_E1A_107A
		cmp	[bp+var_1E], 0
		jnz	short loc_E1A_107A
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_1072
		mov	[bp+wXCosScale], 3
		jmp	loc_E1A_10F5
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_E1A_1072:				; CODE XREF: TrkTerrainWall+1066j
		mov	[bp+wXCosScale], 9
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_107A:				; CODE XREF: TrkTerrainWall+105Aj
					; TrkTerrainWall+1060j
		cmp	[bp+var_32], 1Fh
		jge	short loc_E1A_108E
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_10F5
		mov	[bp+wXCosScale], 6
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_108E:				; CODE XREF: TrkTerrainWall+107Ej
		cmp	[bp+vec.wX], 0FFACh
		jge	short loc_E1A_10AA
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_10A2
		mov	[bp+wXCosScale], 4
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10A2:				; CODE XREF: TrkTerrainWall+1098j
		mov	[bp+wXCosScale], 2
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10AA:				; CODE XREF: TrkTerrainWall+1092j
		cmp	[bp+vec.wX], 0
		jge	short loc_E1A_10C6
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_10BE
		mov	[bp+wXCosScale], 5
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10BE:				; CODE XREF: TrkTerrainWall+10B4j
		mov	[bp+wXCosScale], 1
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10C6:				; CODE XREF: TrkTerrainWall+10AEj
		cmp	[bp+vec.wX], 54h ; 'T'
		jle	short loc_E1A_10E2
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_10DA
		mov	[bp+wXCosScale], 8
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10DA:				; CODE XREF: TrkTerrainWall+10D0j
		mov	[bp+wXCosScale], 0Ah
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10E2:				; CODE XREF: TrkTerrainWall+10CAj
		cmp	[bp+var_1E], 0
		jz	short loc_E1A_10F0
		mov	[bp+wXCosScale], 7
		jmp	short loc_E1A_10F5
; ---------------------------------------------------------------------------
		nop

loc_E1A_10F0:				; CODE XREF: TrkTerrainWall+10E6j
		mov	[bp+wXCosScale], 0Bh

loc_E1A_10F5:				; CODE XREF: TrkTerrainWall+106Dj
					; TrkTerrainWall+1077j	...
		cmp	[bp+wXCosScale], 0
		jz	short loc_E1A_1118
		mov	di, [bp+wXCosScale]
		shl	di, 1
		mov	ax, [bp+vec.wZ]
		cmp	word ptr unk_2B77_2E76[di], ax
		jge	short loc_E1A_1118
		cmp	word ptr unk_2B77_2E8E[di], ax
		jle	short loc_E1A_1118
		mov	ax, [bp+wXCosScale]
		add	ax, 39h	; '9'
		mov	g_wPlanIndex, ax

loc_E1A_1118:				; CODE XREF: TrkTerrainWall+10F9j
					; TrkTerrainWall+1107j	...
		cmp	g_wPlanIndex, 0
		jz	short loc_E1A_1122
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1122:				; CODE XREF: TrkTerrainWall+111Dj
		cmp	[bp+var_2E], 200h
		jl	short loc_E1A_112C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_112C:				; CODE XREF: TrkTerrainWall+1127j
		mov	g_wTrkTerrSomeCode, 0B9h ; '¹'
		mov	byte_2B77_95D6,	1
		mov	g_wTrkTerrnSomeCode2, 75h ; 'u'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1140:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15F0o
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+var_1E], ax
		mov	[bp+wXCosScale], 4Fh ; 'O'
		mov	[bp+var_C], 32h	; '2'
		mov	[bp+var_E], 4Bh	; 'K'
		jmp	short loc_E1A_116F
; ---------------------------------------------------------------------------
		nop

loc_E1A_115A:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15F2o
		mov	ax, [bp+vec.wX]
		mov	[bp+var_1E], ax
		mov	[bp+wXCosScale], 69h ; 'i'
		mov	[bp+var_C], 0
		mov	[bp+var_E], 19h

loc_E1A_116F:				; CODE XREF: TrkTerrainWall+1157j
		mov	byte_2B77_95D6,	1
		cmp	[bp+vec.wZ], 0
		jge	short loc_E1A_11B0
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 64h	; 'd'
		jge	short loc_E1A_11B0
		cmp	[bp+var_1E], 0
		jle	short loc_E1A_11B0
		cmp	[bp+var_1E], 278h
		jl	short loc_E1A_1199
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1199:				; CODE XREF: TrkTerrainWall+1194j
		cmp	[bp+var_1E], 188h
		jg	short loc_E1A_11A3
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_11A3:				; CODE XREF: TrkTerrainWall+119Ej
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	ax, [bp+wXCosScale]
		jmp	loc_E1A_8FD
; ---------------------------------------------------------------------------
		nop

loc_E1A_11B0:				; CODE XREF: TrkTerrainWall+1178j
					; TrkTerrainWall+1187j	...
		cmp	[bp+vec.wZ], 0
		jle	short loc_E1A_1208
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+2]
		sub	ax, g_dwSomeY
		cmp	ax, 15Eh
		jle	short loc_E1A_1208
		cmp	[bp+var_1E], 2B4h
		jge	short loc_E1A_1208
		cmp	[bp+var_1E], 14Ch
		jle	short loc_E1A_1208
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		mov	word_2B77_9218,	0FFF4h
		cmp	[bp+var_1E], 200h
		jle	short loc_E1A_11EC
		mov	ax, [bp+var_C]
		jmp	short loc_E1A_11EF
; ---------------------------------------------------------------------------
		nop

loc_E1A_11EC:				; CODE XREF: TrkTerrainWall+11E4j
		mov	ax, [bp+var_E]

loc_E1A_11EF:				; CODE XREF: TrkTerrainWall+11E9j
		add	ax, 18h
		mov	g_wTrkTerrSomeCode, ax
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	ax, [bp+wXCosScale]
		add	ax, 19h
		mov	g_wPlanIndex, ax
		jmp	loc_E1A_A47
; ---------------------------------------------------------------------------
		nop

loc_E1A_1208:				; CODE XREF: TrkTerrainWall+11B4j
					; TrkTerrainWall+11C3j	...
		push	[bp+vec.wZ]
		push	[bp+var_1E]
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_A], ax
		cmp	ax, 14Ch
		jg	short loc_E1A_1221
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1221:				; CODE XREF: TrkTerrainWall+121Cj
		cmp	ax, 2B4h
		jl	short loc_E1A_1229
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1229:				; CODE XREF: TrkTerrainWall+1224j
		push	[bp+vec.wZ]
		push	[bp+var_1E]
		call	GetAngleFromXZ
		add	sp, 4
		sub	ax, 100h
		neg	ax
		and	ah, 3
		mov	cx, 18h
		imul	cx
		mov	si, ax
		mov	cl, 0Ah
		sar	si, cl
		mov	ax, [bp+wXCosScale]
		add	ax, si
		inc	ax
		mov	g_wPlanIndex, ax
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al
		mov	byte_2B77_81BC,	0
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		mov	word_2B77_9218,	0FFF4h
		mov	ax, [bp+var_A]
		sub	ax, 200h
		cmp	ax, 5Ah	; 'Z'
		jle	short loc_E1A_127E
		mov	ax, [bp+var_C]

loc_E1A_1278:				; CODE XREF: TrkTerrainWall+128Fj
		add	ax, si
		jmp	loc_E1A_880
; ---------------------------------------------------------------------------
		nop

loc_E1A_127E:				; CODE XREF: TrkTerrainWall+1273j
		mov	ax, [bp+var_A]
		sub	ax, 200h
		cmp	ax, 0FFA6h
		jl	short loc_E1A_128C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_128C:				; CODE XREF: TrkTerrainWall+1287j
		mov	ax, [bp+var_E]
		jmp	short loc_E1A_1278
; ---------------------------------------------------------------------------
		nop

loc_E1A_1292:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+15F4o
		cmp	[bp+var_32], 78h ; 'x'
		jge	short loc_E1A_129E
		mov	al, [bp+var_12]
		mov	byte_2B77_95D7,	al

loc_E1A_129E:				; CODE XREF: TrkTerrainWall+1296j
		cmp	[bp+vec.wX], 17h
		jl	short loc_E1A_1300
		cmp	[bp+vec.wX], 61h ; 'a'
		jg	short loc_E1A_1300
		cmp	[bp+vec.wZ], 0FEF1h
		jle	short loc_E1A_1300
		cmp	[bp+vec.wZ], 0FF0Fh
		jge	short loc_E1A_1300
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		cmp	[bp+vec2.wZ], 0FEF1h
		jge	short loc_E1A_12CE
		mov	g_wTrkTerrSomeCode, 91h	; '‘'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_12CE:				; CODE XREF: TrkTerrainWall+12C3j
		cmp	[bp+vec2.wZ], 0FF0Fh
		jle	short loc_E1A_12DE
		mov	g_wTrkTerrSomeCode, 92h	; '’'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_12DE:				; CODE XREF: TrkTerrainWall+12D3j
		cmp	[bp+vec2.wX], 17h
		jge	short loc_E1A_12EE
		mov	g_wTrkTerrSomeCode, 94h	; '”'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_12EE:				; CODE XREF: TrkTerrainWall+12E2j
		cmp	[bp+vec2.wX], 61h ; 'a'
		jg	short loc_E1A_12F7
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_12F7:				; CODE XREF: TrkTerrainWall+12F2j
		mov	g_wTrkTerrSomeCode, 93h	; '“'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1300:				; CODE XREF: TrkTerrainWall+12A2j
					; TrkTerrainWall+12A8j	...
		cmp	[bp+vec.wX], 0FFE9h
		jle	short loc_E1A_1309
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1309:				; CODE XREF: TrkTerrainWall+1304j
		cmp	[bp+vec.wX], 0FF9Fh
		jge	short loc_E1A_1312
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1312:				; CODE XREF: TrkTerrainWall+130Dj
		cmp	[bp+vec.wZ], 10Fh
		jl	short loc_E1A_131C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_131C:				; CODE XREF: TrkTerrainWall+1317j
		cmp	[bp+vec.wZ], 0F1h ; 'ñ'
		jg	short loc_E1A_1326
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1326:				; CODE XREF: TrkTerrainWall+1321j
		mov	g_wTrkTerrnSomeCode2, 2Ah ; '*'
		cmp	[bp+vec2.wZ], 10Fh
		jle	short loc_E1A_133C
		mov	g_wTrkTerrSomeCode, 8Dh	; ''
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_133C:				; CODE XREF: TrkTerrainWall+1331j
		cmp	[bp+vec2.wZ], 0F1h ; 'ñ'
		jge	short loc_E1A_134C
		mov	g_wTrkTerrSomeCode, 8Eh	; 'Ž'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_134C:				; CODE XREF: TrkTerrainWall+1341j
		cmp	[bp+vec2.wX], 0FFE9h
		jle	short loc_E1A_135C
		mov	g_wTrkTerrSomeCode, 8Fh	; ''
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_135C:				; CODE XREF: TrkTerrainWall+1350j
		cmp	[bp+vec2.wX], 0FF9Fh
		jl	short loc_E1A_1365
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1365:				; CODE XREF: TrkTerrainWall+1360j
		mov	g_wTrkTerrSomeCode, 90h	; ''
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_136E:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+1632o
		cmp	[bp+var_32], 96h ; '–'
		jle	short loc_E1A_1378
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1378:				; CODE XREF: TrkTerrainWall+1373j
		cmp	[bp+var_2E], 96h ; '–'
		jle	short loc_E1A_1382
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1382:				; CODE XREF: TrkTerrainWall+137Dj
		mov	g_wTrkTerrnSomeCode2, 1A9h
		cmp	[bp+vec2.wZ], 0FF6Ah
		jg	short loc_E1A_1398
		mov	g_wTrkTerrSomeCode, 0A1h ; '¡'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1398:				; CODE XREF: TrkTerrainWall+138Dj
		cmp	[bp+vec2.wZ], 96h ; '–'
		jl	short loc_E1A_13A8
		mov	g_wTrkTerrSomeCode, 0A2h ; '¢'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13A8:				; CODE XREF: TrkTerrainWall+139Dj
		cmp	[bp+vec2.wX], 96h ; '–'
		jl	short loc_E1A_13B8
		mov	g_wTrkTerrSomeCode, 0A3h ; '£'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13B8:				; CODE XREF: TrkTerrainWall+13ADj
		cmp	[bp+vec2.wX], 0FF6Ah
		jle	short loc_E1A_13C2
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13C2:				; CODE XREF: TrkTerrainWall+13BDj
		mov	g_wTrkTerrSomeCode, 0A4h ; '¤'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_13CC:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+1634o
		cmp	[bp+vec.wX], 0FF38h
		jge	short loc_E1A_13D6
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13D6:				; CODE XREF: TrkTerrainWall+13D1j
		cmp	[bp+vec.wX], 104h
		jle	short loc_E1A_13E0
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13E0:				; CODE XREF: TrkTerrainWall+13DBj
		cmp	[bp+var_2E], 50h ; 'P'
		jle	short loc_E1A_13E9
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13E9:				; CODE XREF: TrkTerrainWall+13E4j
		mov	g_wTrkTerrnSomeCode2, 0E6h ; 'æ'
		cmp	[bp+vec2.wZ], 0FFB0h
		jg	short loc_E1A_13FE
		mov	g_wTrkTerrSomeCode, 0A5h ; '¥'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_13FE:				; CODE XREF: TrkTerrainWall+13F3j
		cmp	[bp+vec2.wZ], 50h ; 'P'
		jl	short loc_E1A_140E
		mov	g_wTrkTerrSomeCode, 0A8h ; '¨'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_140E:				; CODE XREF: TrkTerrainWall+1402j
		cmp	[bp+vec2.wX], 0FF38h
		jg	short loc_E1A_141E
		mov	g_wTrkTerrSomeCode, 0A6h ; '¦'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_141E:				; CODE XREF: TrkTerrainWall+1413j
		cmp	[bp+vec2.wX], 104h
		jge	short loc_E1A_1428
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1428:				; CODE XREF: TrkTerrainWall+1423j
		mov	g_wTrkTerrSomeCode, 0A7h ; '§'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_1432:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+1636o
		cmp	[bp+var_32], 0B4h ; '´'
		jle	short loc_E1A_143C
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_143C:				; CODE XREF: TrkTerrainWall+1437j
		cmp	[bp+var_2E], 64h ; 'd'
		jle	short loc_E1A_1445
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1445:				; CODE XREF: TrkTerrainWall+1440j
		mov	g_wTrkTerrnSomeCode2, 0F8h ; 'ø'
		cmp	[bp+vec2.wZ], 0FF9Ch
		jg	short loc_E1A_145A
		mov	g_wTrkTerrSomeCode, 0A9h ; '©'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_145A:				; CODE XREF: TrkTerrainWall+144Fj
		cmp	[bp+vec2.wZ], 64h ; 'd'
		jl	short loc_E1A_146A
		mov	g_wTrkTerrSomeCode, 0ACh ; '¬'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_146A:				; CODE XREF: TrkTerrainWall+145Ej
		cmp	[bp+vec2.wX], 0FF4Ch
		jg	short loc_E1A_147A
		mov	g_wTrkTerrSomeCode, 0ABh ; '«'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_147A:				; CODE XREF: TrkTerrainWall+146Fj
		cmp	[bp+vec2.wX], 0B4h ; '´'
		jge	short loc_E1A_1484
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1484:				; CODE XREF: TrkTerrainWall+147Fj
		mov	g_wTrkTerrSomeCode, 0AAh ; 'ª'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_148E:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+1638o
		cmp	[bp+var_32], 0C8h ; 'È'
		jle	short loc_E1A_1498
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1498:				; CODE XREF: TrkTerrainWall+1493j
		cmp	[bp+var_2E], 0C8h ; 'È'
		jle	short loc_E1A_14A2
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14A2:				; CODE XREF: TrkTerrainWall+149Dj
		mov	g_wTrkTerrnSomeCode2, 226h
		cmp	[bp+vec2.wZ], 0FF38h
		jg	short loc_E1A_14B8
		mov	g_wTrkTerrSomeCode, 0ADh ; '­'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14B8:				; CODE XREF: TrkTerrainWall+14ADj
		cmp	[bp+vec2.wZ], 0C8h ; 'È'
		jl	short loc_E1A_14C8
		mov	g_wTrkTerrSomeCode, 0AEh ; '®'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14C8:				; CODE XREF: TrkTerrainWall+14BDj
		cmp	[bp+vec2.wX], 0FF38h
		jg	short loc_E1A_14D8
		mov	g_wTrkTerrSomeCode, 0AFh ; '¯'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14D8:				; CODE XREF: TrkTerrainWall+14CDj
		cmp	[bp+vec2.wX], 0C8h ; 'È'
		jge	short loc_E1A_14E2
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14E2:				; CODE XREF: TrkTerrainWall+14DDj
		mov	g_wTrkTerrSomeCode, 0B0h ; '°'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_14EC:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+163Ao
		cmp	[bp+var_32], 72h ; 'r'
		jle	short loc_E1A_14F5
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14F5:				; CODE XREF: TrkTerrainWall+14F0j
		cmp	[bp+var_2E], 72h ; 'r'
		jle	short loc_E1A_14FE
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_14FE:				; CODE XREF: TrkTerrainWall+14F9j
		mov	g_wTrkTerrnSomeCode2, 1EFh
		cmp	[bp+vec2.wZ], 0FF8Eh
		jg	short loc_E1A_1514
		mov	g_wTrkTerrSomeCode, 0B4h ; '´'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_1514:				; CODE XREF: TrkTerrainWall+1508j
		cmp	[bp+vec2.wZ], 72h ; 'r'
		jl	short loc_E1A_1524
		mov	g_wTrkTerrSomeCode, 0B2h ; '²'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_1524:				; CODE XREF: TrkTerrainWall+1518j
		cmp	[bp+vec2.wX], 0FF8Eh
		jg	short loc_E1A_1534
		mov	g_wTrkTerrSomeCode, 0B1h ; '±'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_1534:				; CODE XREF: TrkTerrainWall+1528j
		cmp	[bp+vec2.wX], 72h ; 'r'
		jge	short loc_E1A_153D
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_153D:				; CODE XREF: TrkTerrainWall+1538j
		mov	g_wTrkTerrSomeCode, 0B3h ; '³'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1546:				; CODE XREF: TrkTerrainWall+412j
					; DATA XREF: TrkTerrainWall+163Co
		cmp	[bp+vec.wX], 0FF56h
		jge	short loc_E1A_1550
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1550:				; CODE XREF: TrkTerrainWall+154Bj
		cmp	[bp+vec.wX], 104h
		jle	short loc_E1A_155A
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_155A:				; CODE XREF: TrkTerrainWall+1555j
		cmp	[bp+var_2E], 6Eh ; 'n'
		jle	short loc_E1A_1563
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1563:				; CODE XREF: TrkTerrainWall+155Ej
		mov	g_wTrkTerrnSomeCode2, 0E6h ; 'æ'
		cmp	[bp+vec2.wZ], 0FF92h
		jg	short loc_E1A_157A
		mov	g_wTrkTerrSomeCode, 0B5h ; 'µ'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_E1A_157A:				; CODE XREF: TrkTerrainWall+156Dj
		cmp	[bp+vec2.wZ], 6Eh ; 'n'
		jl	short loc_E1A_158A
		mov	g_wTrkTerrSomeCode, 0B8h ; '¸'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop

loc_E1A_158A:				; CODE XREF: TrkTerrainWall+157Ej
		cmp	[bp+vec2.wX], 0FF56h
		jg	short loc_E1A_159C
		mov	g_wTrkTerrSomeCode, 0B7h ; '·'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop
		nop

loc_E1A_159C:				; CODE XREF: TrkTerrainWall+158Fj
		cmp	[bp+vec2.wX], 104h
		jge	short loc_E1A_15A6
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_15A6:				; CODE XREF: TrkTerrainWall+15A1j
		mov	g_wTrkTerrSomeCode, 0B6h ; '¶'
		jmp	loc_E1A_1646
; ---------------------------------------------------------------------------
		nop
; ---------------------------------------------------------------------------
off_E1A_15B0	dw offset loc_E1A_418	; DATA XREF: TrkTerrainWall+412r
		dw offset loc_E1A_441
		dw offset loc_E1A_4B0
		dw offset loc_E1A_484
		dw offset loc_E1A_468
		dw offset loc_E1A_460
		dw offset loc_E1A_4AA
		dw offset loc_E1A_4D8
		dw offset loc_E1A_4F0
		dw offset loc_E1A_504
		dw offset loc_E1A_526
		dw offset loc_E1A_63A
		dw offset loc_E1A_454
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_662
		dw offset loc_E1A_67E
		dw offset loc_E1A_744
		dw offset loc_E1A_744
		dw offset loc_E1A_72A
		dw offset loc_E1A_7D8
		dw offset loc_E1A_716
		dw offset loc_E1A_896
		dw offset loc_E1A_886
		dw offset loc_E1A_9A6
		dw offset loc_E1A_9CC
		dw offset loc_E1A_A50
		dw offset loc_E1A_C9E
		dw offset loc_E1A_D84
		dw offset loc_E1A_E88
		dw offset loc_E1A_E80
		dw offset loc_E1A_1140
		dw offset loc_E1A_115A
		dw offset loc_E1A_1292
		dw offset loc_E1A_1010
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_136E
		dw offset loc_E1A_13CC
		dw offset loc_E1A_1432
		dw offset loc_E1A_148E
		dw offset loc_E1A_14EC
		dw offset loc_E1A_1546
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
		dw offset loc_E1A_1646
; ---------------------------------------------------------------------------

loc_E1A_1646:				; CODE XREF: TrkTerrainWall+F6j
					; TrkTerrainWall+40Cj ...
		cmp	[bp+cTerrainTile], 7
		jnb	short loc_E1A_164F
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------

loc_E1A_164F:				; CODE XREF: TrkTerrainWall+164Aj
		mov	al, [bp+cXVal]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	di, [bp+p_pVec]
		mov	ax, [di]
		sub	ax, g_wMoreTrkCenPo[bx]
		mov	[bp+vec.wX], ax
		mov	al, [bp+cZVal]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, [di+Vector3D.wZ]
		sub	ax, word ptr g_wTerrainCenPo[bx]
		mov	[bp+vec.wZ], ax
		mov	al, [bp+cTerrainTile]
		sub	ah, ah
		sub	ax, 7
		cmp	ax, 0Bh
		ja	short loc_E1A_16F6
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_E1A_16DE[bx]

loc_E1A_168A:				; DATA XREF: TrkTerrainWall:off_E1A_16DEo
					; TrkTerrainWall+16E6o	...
		mov	[bp+wShapeRot],	0
		jmp	short loc_E1A_16F6
; ---------------------------------------------------------------------------
		nop

loc_E1A_1692:				; CODE XREF: TrkTerrainWall+1685j
					; DATA XREF: TrkTerrainWall+16E0o ...
		mov	[bp+wShapeRot],	300h
		mov	ax, [bp+vec.wX]
		mov	[bp+var_1E], ax
		mov	ax, [bp+vec.wZ]
		mov	[bp+vec.wX], ax
		mov	ax, [bp+var_1E]
		neg	ax

loc_E1A_16A8:				; CODE XREF: TrkTerrainWall+16DCj
		mov	[bp+vec.wZ], ax
		jmp	short loc_E1A_16F6
; ---------------------------------------------------------------------------
		nop

loc_E1A_16AE:				; CODE XREF: TrkTerrainWall+1685j
					; DATA XREF: TrkTerrainWall+16E2o ...
		mov	[bp+wShapeRot],	200h
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wZ], ax
		mov	ax, [bp+vec.wX]
		neg	ax
		mov	[bp+vec.wX], ax
		jmp	short loc_E1A_16F6
; ---------------------------------------------------------------------------
		nop

loc_E1A_16C6:				; CODE XREF: TrkTerrainWall+1685j
					; DATA XREF: TrkTerrainWall+16E4o ...
		mov	[bp+wShapeRot],	100h
		mov	ax, [bp+vec.wX]
		mov	[bp+var_1E], ax
		mov	ax, [bp+vec.wZ]
		neg	ax
		mov	[bp+vec.wX], ax
		mov	ax, [bp+var_1E]
		jmp	short loc_E1A_16A8
; ---------------------------------------------------------------------------
off_E1A_16DE	dw offset loc_E1A_168A	; DATA XREF: TrkTerrainWall+1685r
		dw offset loc_E1A_1692
		dw offset loc_E1A_16AE
		dw offset loc_E1A_16C6
		dw offset loc_E1A_168A
		dw offset loc_E1A_1692
		dw offset loc_E1A_16AE
		dw offset loc_E1A_16C6
		dw offset loc_E1A_168A
		dw offset loc_E1A_1692
		dw offset loc_E1A_16AE
		dw offset loc_E1A_16C6
; ---------------------------------------------------------------------------

loc_E1A_16F6:				; CODE XREF: TrkTerrainWall+1680j
					; TrkTerrainWall+168Fj	...
		mov	al, [bp+cTerrainTile]
		sub	ah, ah
		cmp	ax, 7
		jb	short loc_E1A_172D
		cmp	ax, 0Ah
		jbe	short loc_E1A_1720
		cmp	ax, 0Bh
		jb	short loc_E1A_172D
		cmp	ax, 0Eh
		jbe	short loc_E1A_175C
		cmp	ax, 0Fh
		jb	short loc_E1A_172D
		cmp	ax, 12h
		ja	short loc_E1A_171C
		jmp	loc_E1A_17A0
; ---------------------------------------------------------------------------

loc_E1A_171C:				; CODE XREF: TrkTerrainWall+1717j
		jmp	short loc_E1A_172D
; ---------------------------------------------------------------------------
		nop
		nop

loc_E1A_1720:				; CODE XREF: TrkTerrainWall+1703j
		cmp	g_wPlanIndex, 0
		jnz	short loc_E1A_172D
		mov	g_wPlanIndex, 3

loc_E1A_172D:				; CODE XREF: TrkTerrainWall+5Aj
					; TrkTerrainWall+63j ...
		cmp	g_wPlanIndex, 0
		jg	short loc_E1A_1737
		jmp	loc_E1A_17F2
; ---------------------------------------------------------------------------

loc_E1A_1737:				; CODE XREF: TrkTerrainWall+1732j
		mov	cl, 2
		shl	g_wPlanIndex, cl
		mov	ax, [bp+wShapeRot]
		cmp	ax, 100h
		jnz	short loc_E1A_1748
		jmp	loc_E1A_182C
; ---------------------------------------------------------------------------

loc_E1A_1748:				; CODE XREF: TrkTerrainWall+1743j
		cmp	ax, 200h
		jnz	short loc_E1A_1750
		jmp	loc_E1A_1824
; ---------------------------------------------------------------------------

loc_E1A_1750:				; CODE XREF: TrkTerrainWall+174Bj
		cmp	ax, 300h
		jnz	short loc_E1A_1758
		jmp	loc_E1A_17EE
; ---------------------------------------------------------------------------

loc_E1A_1758:				; CODE XREF: TrkTerrainWall+1753j
		jmp	loc_E1A_17F2
; ---------------------------------------------------------------------------
		nop

loc_E1A_175C:				; CODE XREF: TrkTerrainWall+170Dj
		push	[bp+vec.wZ]
		mov	ax, 0FF80h
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		push	[bp+vec.wX]
		mov	cx, 0FF80h
		push	cx
		mov	di, ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, di
		mov	[bp+wXCosScale], ax
		or	ax, ax
		jge	short loc_E1A_172D
		mov	g_wPlanIndex, 4
		jmp	short loc_E1A_172D
; ---------------------------------------------------------------------------
		nop

loc_E1A_17A0:				; CODE XREF: TrkTerrainWall+1719j
		push	[bp+vec.wZ]
		mov	ax, 0FF80h
		push	ax
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		push	[bp+vec.wX]
		mov	cx, 0FF80h
		push	cx
		mov	di, ax
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, di
		mov	[bp+wXCosScale], ax
		or	ax, ax
		jle	short loc_E1A_17E4
		mov	g_wPlanIndex, 5
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------

loc_E1A_17E4:				; CODE XREF: TrkTerrainWall+17D9j
		mov	g_dwSomeY, 1C2h
		jmp	loc_E1A_172D
; ---------------------------------------------------------------------------
		nop

loc_E1A_17EE:				; CODE XREF: TrkTerrainWall+1755j
		inc	g_wPlanIndex

loc_E1A_17F2:				; CODE XREF: TrkTerrainWall+1734j
					; TrkTerrainWall:loc_E1A_1758j	...
		mov	ax, 22h		; sizeof plane
		imul	g_wPlanIndex
		add	ax, word ptr g_dwPlanRes
		mov	dx, word ptr g_dwPlanRes+2
		mov	word ptr g_pTrkWallTerrainPla, ax
		mov	word ptr g_pTrkWallTerrainPla+2, dx
		cmp	byte_2B77_95D7,	4
		jnz	short loc_E1A_1834
		mov	bx, [bp+p_pVec]
		mov	ax, [bx+Vector3D.wZ]
		xor	ax, [bx+Vector3D.wX]
		mov	cl, 8
		sar	ax, cl
		and	ax, 1
		add	g_dwSomeY, ax
		jmp	short loc_E1A_1839
; ---------------------------------------------------------------------------

loc_E1A_1824:				; CODE XREF: TrkTerrainWall+174Dj
		add	g_wPlanIndex, 2
		jmp	short loc_E1A_17F2
; ---------------------------------------------------------------------------
		nop

loc_E1A_182C:				; CODE XREF: TrkTerrainWall+1745j
		add	g_wPlanIndex, 3
		jmp	short loc_E1A_17F2
; ---------------------------------------------------------------------------
		nop

loc_E1A_1834:				; CODE XREF: TrkTerrainWall+180Dj
		add	g_dwSomeY, 2

loc_E1A_1839:				; CODE XREF: TrkTerrainWall+1822j
		cmp	g_wTrkTerrSomeCode, 0
		jge	short loc_E1A_1843
		jmp	loc_E1A_193E
; ---------------------------------------------------------------------------

loc_E1A_1843:				; CODE XREF: TrkTerrainWall+183Ej
		mov	bx, g_wTrkTerrSomeCode
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		les	di, g_dwWallRes
		mov	ax, es:[bx+di]
		neg	ax
		add	ax, [bp+wShapeRot]
		add	ax, [bp+var_38]
		and	ah, 3
		mov	word_2B77_A626,	ax
		mov	ax, [bp+wShapeRot]
		or	ax, ax
		jz	short loc_E1A_1880
		cmp	ax, 100h
		jnz	short loc_E1A_1873
		jmp	loc_E1A_1906
; ---------------------------------------------------------------------------

loc_E1A_1873:				; CODE XREF: TrkTerrainWall+186Ej
		cmp	ax, 200h
		jz	short loc_E1A_18D8
		cmp	ax, 300h
		jz	short loc_E1A_18AC
		jmp	loc_E1A_1930
; ---------------------------------------------------------------------------

loc_E1A_1880:				; CODE XREF: TrkTerrainWall+1869j
		mov	ax, g_wTrkTerrSomeCode
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_dwWallRes
		mov	dx, es
		mov	word ptr [bp+var_40], ax
		mov	word ptr [bp+var_40+2],	dx
		les	bx, [bp+var_40]
		mov	ax, es:[bx+2]
		mov	g_dwCopySomeX, ax
		mov	ax, es:[bx+4]

loc_E1A_18A5:				; CODE XREF: TrkTerrainWall+18D5j
					; TrkTerrainWall+1903j
		mov	g_dwCopySomeZ, ax
		jmp	loc_E1A_1930
; ---------------------------------------------------------------------------
		nop

loc_E1A_18AC:				; CODE XREF: TrkTerrainWall+187Bj
		mov	ax, g_wTrkTerrSomeCode
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_dwWallRes
		mov	dx, word ptr g_dwWallRes+2
		mov	word ptr [bp+var_40], ax
		mov	word ptr [bp+var_40+2],	dx
		les	bx, [bp+var_40]
		mov	ax, es:[bx+4]
		neg	ax
		mov	g_dwCopySomeX, ax
		mov	ax, es:[bx+2]
		jmp	short loc_E1A_18A5
; ---------------------------------------------------------------------------
		nop

loc_E1A_18D8:				; CODE XREF: TrkTerrainWall+1876j
		mov	ax, g_wTrkTerrSomeCode
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_dwWallRes
		mov	dx, word ptr g_dwWallRes+2
		mov	word ptr [bp+var_40], ax
		mov	word ptr [bp+var_40+2],	dx
		les	bx, [bp+var_40]
		mov	ax, es:[bx+2]
		neg	ax
		mov	g_dwCopySomeX, ax
		mov	ax, es:[bx+4]

loc_E1A_1901:				; CODE XREF: TrkTerrainWall+192Dj
		neg	ax
		jmp	short loc_E1A_18A5
; ---------------------------------------------------------------------------
		nop

loc_E1A_1906:				; CODE XREF: TrkTerrainWall+1870j
		mov	ax, g_wTrkTerrSomeCode
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_dwWallRes
		mov	dx, word ptr g_dwWallRes+2
		mov	word ptr [bp+var_40], ax
		mov	word ptr [bp+var_40+2],	dx
		les	bx, [bp+var_40]
		mov	ax, es:[bx+4]
		mov	g_dwCopySomeX, ax
		mov	ax, es:[bx+2]
		jmp	short loc_E1A_1901
; ---------------------------------------------------------------------------
		nop

loc_E1A_1930:				; CODE XREF: TrkTerrainWall+187Dj
					; TrkTerrainWall+18A8j
		mov	ax, g_dwSomeX
		add	g_dwCopySomeX, ax
		mov	ax, g_dwSomeZ
		add	g_dwCopySomeZ, ax

loc_E1A_193E:				; CODE XREF: TrkTerrainWall+1840j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TrkTerrainWall	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ZXTrakdata14Shape proc far		; CODE XREF: TrkPlanSimd+1833P

var_14		= word ptr -14h
var_10		= byte ptr -10h
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 14h
		push	di
		push	si
		mov	bx, [bp+arg_2]
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		add	bx, [bp+arg_0]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+var_2], al
		or	al, al
		jnz	short loc_E1A_1972

loc_E1A_196A:				; CODE XREF: ZXTrakdata14Shape+1DAj
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_E1A_1972:				; CODE XREF: ZXTrakdata14Shape+24j
		mov	bx, [bp+arg_0]
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]
		mov	[bp+var_6], ax
		mov	bx, [bp+arg_2]
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		mov	[bp+var_C], ax
		cmp	[bp+var_2], 0FDh ; 'ý'
		jnb	short loc_E1A_1993
		jmp	loc_E1A_1A94
; ---------------------------------------------------------------------------

loc_E1A_1993:				; CODE XREF: ZXTrakdata14Shape+4Aj
		mov	al, [bp+var_2]
		sub	ah, ah
		cmp	ax, 0FDh ; 'ý'
		jz	short loc_E1A_19AE
		cmp	ax, 0FEh ; 'þ'
		jz	short loc_E1A_1A14
		cmp	ax, 0FFh
		jnz	short loc_E1A_19AA
		jmp	loc_E1A_1A52
; ---------------------------------------------------------------------------

loc_E1A_19AA:				; CODE XREF: ZXTrakdata14Shape+61j
		jmp	loc_E1A_1AE6
; ---------------------------------------------------------------------------
		nop

loc_E1A_19AE:				; CODE XREF: ZXTrakdata14Shape+57j
		mov	ax, [bp+arg_2]
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, ax
		mov	bx, word ptr byte_2B77_A5CE[bx]
		add	bx, [bp+arg_0]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx-1]
		mov	[bp+var_2], al
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_E1A_19ED
		mov	bx, [bp+var_14]
		mov	ax, (g_wTrackPos+2)[bx]

loc_E1A_19EA:				; CODE XREF: ZXTrakdata14Shape+14Dj
		mov	[bp+var_C], ax

loc_E1A_19ED:				; CODE XREF: ZXTrakdata14Shape+9Dj
					; ZXTrakdata14Shape+143j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jnz	short loc_E1A_1A08
		jmp	loc_E1A_1AE6
; ---------------------------------------------------------------------------

loc_E1A_1A08:				; CODE XREF: ZXTrakdata14Shape+BFj
		mov	bx, [bp+arg_0]
		shl	bx, 1
		mov	ax, g_wMoreTrackPos[bx]
		jmp	loc_E1A_1AE3
; ---------------------------------------------------------------------------

loc_E1A_1A14:				; CODE XREF: ZXTrakdata14Shape+5Cj
		mov	ax, [bp+arg_2]
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, ax
		mov	bx, word ptr byte_2B77_A5CE[bx]
		add	bx, [bp+arg_0]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx]
		mov	[bp+var_2], al
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_E1A_1AC2
		mov	bx, [bp+var_14]
		mov	ax, (g_wTrackPos+2)[bx]
		jmp	short loc_E1A_1ABF
; ---------------------------------------------------------------------------
		nop

loc_E1A_1A52:				; CODE XREF: ZXTrakdata14Shape+63j
		mov	ax, [bp+arg_2]
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, [bp+arg_0]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx-1]
		mov	[bp+var_2], al
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jnz	short loc_E1A_1A8A
		jmp	loc_E1A_19ED
; ---------------------------------------------------------------------------

loc_E1A_1A8A:				; CODE XREF: ZXTrakdata14Shape+141j
		mov	bx, [bp+var_14]
		mov	ax, g_wTrackPos[bx]
		jmp	loc_E1A_19EA
; ---------------------------------------------------------------------------

loc_E1A_1A94:				; CODE XREF: ZXTrakdata14Shape+4Cj
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		mov	byte ptr [bp+var_14], al
		cmp	al, ah
		jz	short loc_E1A_1AE6
		test	byte ptr [bp+var_14], 1
		jz	short loc_E1A_1AC2
		mov	bx, [bp+arg_2]
		shl	bx, 1
		mov	ax, g_wTrackPos[bx]

loc_E1A_1ABF:				; CODE XREF: ZXTrakdata14Shape+10Bj
		mov	[bp+var_C], ax

loc_E1A_1AC2:				; CODE XREF: ZXTrakdata14Shape+102j
					; ZXTrakdata14Shape+170j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jz	short loc_E1A_1AE6
		mov	bx, [bp+arg_0]
		shl	bx, 1
		mov	ax, (g_wMoreTrackPos+2)[bx]

loc_E1A_1AE3:				; CODE XREF: ZXTrakdata14Shape+CDj
		mov	[bp+var_6], ax

loc_E1A_1AE6:				; CODE XREF: ZXTrakdata14Shape:loc_E1A_19AAj
					; ZXTrakdata14Shape+C1j ...
		sub	di, di
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.field_C[bx]
		cbw
		cmp	ax, 20h	; ' '
		jz	short loc_E1A_1B22
		jg	short loc_E1A_1B54
		cmp	ax, 0Bh
		jz	short loc_E1A_1B40
		cmp	ax, 12h
		jz	short loc_E1A_1B4A
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------
		nop

loc_E1A_1B12:				; CODE XREF: ZXTrakdata14Shape+221j
		mov	di, 2
		mov	[bp+var_4], offset unk_2B77_2F06

loc_E1A_1B1A:				; CODE XREF: ZXTrakdata14Shape+1CBj
					; ZXTrakdata14Shape+1E6j ...
		or	di, di
		jnz	short loc_E1A_1B74
		jmp	loc_E1A_196A
; ---------------------------------------------------------------------------
		nop

loc_E1A_1B22:				; CODE XREF: ZXTrakdata14Shape+1BDj
		mov	di, 2
		mov	[bp+var_4], offset unk_2B77_2F12
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------

loc_E1A_1B2C:				; CODE XREF: ZXTrakdata14Shape+21Aj
		mov	di, 2
		mov	[bp+var_4], offset unk_2B77_2F1E
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------

loc_E1A_1B36:				; CODE XREF: ZXTrakdata14Shape+213j
		mov	di, 4
		mov	[bp+var_4], offset unk_2B77_2F2A
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------

loc_E1A_1B40:				; CODE XREF: ZXTrakdata14Shape+1C4j
					; ZXTrakdata14Shape+22Bj
		mov	di, 1
		mov	[bp+var_4], offset unk_2B77_2ED0
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------

loc_E1A_1B4A:				; CODE XREF: ZXTrakdata14Shape+1C9j
		mov	di, 8
		mov	[bp+var_4], offset unk_2B77_2ED6
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------

loc_E1A_1B54:				; CODE XREF: ZXTrakdata14Shape+1BFj
		cmp	ax, 22h	; '"'
		jz	short loc_E1A_1B36
		jg	short loc_E1A_1B62
		cmp	ax, 21h	; '!'
		jz	short loc_E1A_1B2C
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------

loc_E1A_1B62:				; CODE XREF: ZXTrakdata14Shape+215j
		cmp	ax, 23h	; '#'
		jz	short loc_E1A_1B12
		cmp	ax, 47h	; 'G'
		jl	short loc_E1A_1B1A
		cmp	ax, 4Ah	; 'J'
		jle	short loc_E1A_1B40
		jmp	short loc_E1A_1B1A
; ---------------------------------------------------------------------------
		nop

loc_E1A_1B74:				; CODE XREF: ZXTrakdata14Shape+1D8j
		mov	bx, [bp+arg_2]
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		add	bx, [bp+arg_0]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+var_10], al
		cmp	al, 6
		jnz	short loc_E1A_1B9A
		mov	ax, word_2B77_17A
		mov	[bp+var_A], ax
		jmp	short loc_E1A_1B9F
; ---------------------------------------------------------------------------

loc_E1A_1B9A:				; CODE XREF: ZXTrakdata14Shape+24Cj
		mov	[bp+var_A], 0

loc_E1A_1B9F:				; CODE XREF: ZXTrakdata14Shape+254j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, g_sceneShapes.dwRotY[bx]
		mov	[bp+var_8], ax
		sub	si, si
		jmp	short loc_E1A_1C06
; ---------------------------------------------------------------------------
		nop

loc_E1A_1BBC:				; CODE XREF: ZXTrakdata14Shape+2CEj
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, [bp+var_4]
		add	bx, ax
		mov	ax, [bx]
		add	ax, [bp+var_6]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx], ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx+2]
		add	ax, [bp+var_A]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx+2],	ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx+4]

loc_E1A_1BF9:				; CODE XREF: ZXTrakdata14Shape+321j
					; ZXTrakdata14Shape+3A5j
		add	ax, [bp+var_C]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx+4],	ax

loc_E1A_1C05:				; CODE XREF: ZXTrakdata14Shape+2E0j
		inc	si

loc_E1A_1C06:				; CODE XREF: ZXTrakdata14Shape+275j
		cmp	si, di
		jl	short loc_E1A_1C0D
		jmp	loc_E1A_1CEC
; ---------------------------------------------------------------------------

loc_E1A_1C0D:				; CODE XREF: ZXTrakdata14Shape+2C4j
		mov	ax, [bp+var_8]
		or	ax, ax
		jz	short loc_E1A_1BBC
		cmp	ax, 100h
		jnz	short loc_E1A_1C1C
		jmp	loc_E1A_1CAA
; ---------------------------------------------------------------------------

loc_E1A_1C1C:				; CODE XREF: ZXTrakdata14Shape+2D3j
		cmp	ax, 200h
		jz	short loc_E1A_1C68
		cmp	ax, 300h
		jnz	short loc_E1A_1C05
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, [bp+var_4]
		add	bx, ax
		mov	ax, [bx+4]
		neg	ax
		add	ax, [bp+var_6]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx], ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx+2]
		add	ax, [bp+var_A]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx+2],	ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx]
		jmp	short loc_E1A_1BF9
; ---------------------------------------------------------------------------
		nop

loc_E1A_1C68:				; CODE XREF: ZXTrakdata14Shape+2DBj
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, [bp+var_4]
		add	bx, ax
		mov	ax, [bx]
		neg	ax
		add	ax, [bp+var_6]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx], ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx+2]
		add	ax, [bp+var_A]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx+2],	ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx+4]
		jmp	short loc_E1A_1CE7
; ---------------------------------------------------------------------------
		nop

loc_E1A_1CAA:				; CODE XREF: ZXTrakdata14Shape+2D5j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, [bp+var_4]
		add	bx, ax
		mov	ax, [bx+4]
		add	ax, [bp+var_6]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx], ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx+2]
		add	ax, [bp+var_A]
		mov	bx, [bp+arg_4]
		add	bx, [bp+var_14]
		mov	[bx+2],	ax
		mov	bx, [bp+var_4]
		add	bx, [bp+var_14]
		mov	ax, [bx]

loc_E1A_1CE7:				; CODE XREF: ZXTrakdata14Shape+363j
		neg	ax
		jmp	loc_E1A_1BF9
; ---------------------------------------------------------------------------

loc_E1A_1CEC:				; CODE XREF: ZXTrakdata14Shape+2C6j
		mov	ax, di
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
ZXTrakdata14Shape endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadGame3dShpes	proc far		; CODE XREF: RunTracksMenu+63P
					; SetupCarGameEtc+23BP
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		sub	ax, ax
		mov	word ptr g_pGame1Res+2,	ax
		mov	word ptr g_pGame1Res, ax
		mov	word ptr g_pGame2Res+2,	ax
		mov	word ptr g_pGame2Res, ax
		call	GetResDiffScale
		or	dx, dx
		jg	short loc_E1A_1D22
		jl	short loc_E1A_1D19
		cmp	ax, 0FDE8h
		jnb	short loc_E1A_1D22

loc_E1A_1D19:				; CODE XREF: LoadGame3dShpes+1Ej
		mov	ax, 1
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_E1A_1D22:				; CODE XREF: LoadGame3dShpes+1Cj
					; LoadGame3dShpes+23j
		mov	ax, offset aGame1 ; "game1"
		push	ax
		call	Load3DShape
		add	sp, 2
		mov	word ptr g_pGame1Res, ax
		mov	word ptr g_pGame1Res+2,	dx
		mov	ax, offset aGame2 ; "game2"
		push	ax
		call	Load3DShape
		add	sp, 2
		mov	word ptr g_pGame2Res, ax
		mov	word ptr g_pGame2Res+2,	dx
		sub	si, si

Enumerate 116 hard coded 3d shapes here

loc_E1A_1D4A:				; CODE XREF: LoadGame3dShpes+C1j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx		; multiply by 5, and add the offset to the "barn" string so we get the id at the counter position
		add	ax, offset aBarn ; "barn"
		push	ax
		push	word ptr g_pGame1Res+2
		push	word ptr g_pGame1Res
		call	LocateShape0
		add	sp, 6
		mov	word ptr g_pBarnShape, ax
		mov	word ptr g_pBarnShape+2, dx
		or	ax, dx
		jnz	short loc_E1A_1D98
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, offset aBarn ; "barn"
		push	ax
		push	word ptr g_pGame2Res+2
		push	word ptr g_pGame2Res
		call	LocateShape
		add	sp, 6
		mov	word ptr g_pBarnShape, ax
		mov	word ptr g_pBarnShape+2, dx

loc_E1A_1D98:				; CODE XREF: LoadGame3dShpes+7Dj
		mov	ax, 16h
		imul	si
		add	ax, offset g_pGame3DShapes
		push	ax
		push	word ptr g_pBarnShape+2
		push	word ptr g_pBarnShape
		call	Import3DShapeBinary
		add	sp, 6
		inc	si
		cmp	si, 74h	; 't'   ; loop 116 times yes, approx number of 3d shapes in the array that starts with "barn"
		jl	short loc_E1A_1D4A
		sub	ax, ax
		pop	si
		mov	sp, bp
		pop	bp
		retf
LoadGame3dShpes	endp


; =============== S U B	R O U T	I N E =======================================


UnloadGameResources proc far		; CODE XREF: RunTracksMenu+B5P
					; UnloadGameResou:loc_11B7_1E64P
		mov	ax, word ptr g_pGame1Res
		or	ax, word ptr g_pGame1Res+2
		jz	short loc_E1A_1DD7
		push	word ptr g_pGame1Res+2
		push	word ptr g_pGame1Res
		call	UnloadResource
		add	sp, 4

loc_E1A_1DD7:				; CODE XREF: UnloadGameResources+7j
		mov	ax, word ptr g_pGame2Res
		or	ax, word ptr g_pGame2Res+2
		jz	short locret_E1A_1DF0
		push	word ptr g_pGame2Res+2
		push	word ptr g_pGame2Res
		call	UnloadResource
		add	sp, 4

locret_E1A_1DF0:			; CODE XREF: UnloadGameResources+20j
		retf
UnloadGameResources endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadCarShapes	proc far		; CODE XREF: RunCarMenu+39DP
					; SetupCarGameEtc+22P

var_10		= byte ptr -10h
var_E		= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
arg_0		= word ptr  6
p_pCarId	= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	di
		push	si
		mov	bx, [bp+arg_0]
		mov	al, [bx]
		mov	byte ptr aStxxx+2, al
		mov	al, [bx+1]
		mov	byte ptr aStxxx+3, al
		mov	al, [bx+2]
		mov	byte ptr aStxxx+4, al
		mov	al, [bx+3]
		mov	byte_2B77_2F9F,	al
		mov	ax, offset aStxxx ; "stxxx"
		push	ax
		call	Load3DShape
		add	sp, 2
		mov	word ptr g_dwCurCarShpFi, ax
		mov	word ptr g_dwCurCarShpFi+2, dx
		mov	ax, offset g_pCar0Shape
		push	ax
		mov	ax, offset aCar0 ; "car0"
		push	ax
		push	dx
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pCar1Shape
		push	ax
		mov	ax, offset aCar1 ; "car1"
		push	ax
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, word ptr g_pCar1Shape.pVertices
		mov	dx, word ptr g_pCar1Shape.pVertices+2
		add	ax, 30h	; '0'   ; what?? why 30h into the vertex array? (does this only on car1 shapes!)
		mov	word ptr [bp+var_E], ax
		mov	word ptr [bp+var_E+2], dx
		les	bx, [bp+var_E]
		mov	ax, es:[bx+Vector3D.wZ]
		mov	g_wCar1Z1, ax
		mov	ax, es:[bx+(Vector3D.wX+12h)] ;	+12h=+18 = 3*sizeof(vector3d)
		add	ax, es:[bx+Vector3D.wX]
		sar	ax, 1
		mov	g_wCarXSum, ax
		mov	ax, es:[bx+(Vector3D.wZ+24h)] ;	;+24 = +36 = 6*sizeof(vector3d)
		mov	g_wCar1Z2, ax
		mov	ax, es:[bx+(Vector3D.wX+24h)]
		add	ax, es:[bx+(Vector3D.wX+36h)]
		sar	ax, 1
		mov	g_wCar1XSum2, ax
		sub	si, si

loc_E1A_1EA4:				; CODE XREF: LoadCarShapes+13Fj
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax		; di = ((counter << 1) + counter) << 1
					; di = counter * 3 * 2
		mov	ax, g_wCarXSum
		les	bx, [bp+var_E]
		sub	ax, es:[bx+di+Vector3D.wX]
		mov	word ptr g_pCar1_6Vecs.wX[di], ax
		les	bx, [bp+var_E]
		mov	ax, g_wCar1Z1
		sub	ax, es:[bx+di+Vector3D.wZ]
		mov	g_pCar1_6Vecs.wZ[di], ax
		les	bx, [bp+var_E]
		mov	ax, es:[bx+di+Vector3D.wY]
		mov	g_pCar1_6Vecs.wY[di], ax
		les	bx, [bp+var_E]
		mov	ax, g_wCar1XSum2
		sub	ax, es:[bx+di+(Vector3D.wX+24h)]
		mov	word ptr g_pCar1_6Vecs2.wX[di],	ax
		les	bx, [bp+var_E]
		mov	ax, g_wCar1Z2
		sub	ax, es:[bx+di+(Vector3D.wZ+24h)]
		mov	g_pCar1_6Vecs2.wZ[di], ax
		les	bx, [bp+var_E]
		mov	ax, es:[bx+di+(Vector3D.wY+24h)]
		mov	g_pCar1_6Vecs2.wY[di], ax
		les	bx, [bp+var_E]
		push	si
		push	di
		lea	si, [bx+di+(Vector3D.wX+48h)]
		lea	di, g_pCar1_6Vecs3.wX[di]
		push	ds
		push	ds
		push	es
		pop	ds
		pop	es
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		les	bx, [bp+var_E]
		push	si
		push	di
		lea	si, [bx+di+(Vector3D.wX+6Ch)]
		lea	di, g_pCar1_6Vecs4.wX[di]
		push	ds
		push	ds
		push	es
		pop	ds
		pop	es
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		inc	si
		cmp	si, 6
		jge	short loc_E1A_1F34
		jmp	loc_E1A_1EA4	; loop 6 times over car1
; ---------------------------------------------------------------------------

loc_E1A_1F34:				; CODE XREF: LoadCarShapes+13Dj
		sub	si, si
; the following	loops sets 5 zeros

loc_E1A_1F36:				; CODE XREF: LoadCarShapes+152j
		mov	bx, si
		shl	bx, 1
		mov	g_pCar1_5Zeros[bx], 0
		inc	si
		cmp	si, 5
		jl	short loc_E1A_1F36


		mov	ax, offset g_pCar2Shape
		push	ax
		mov	ax, offset aCar2 ; "car2"
		push	ax
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pExp0Shape
		push	ax
		mov	ax, offset aExp0_0 ; "exp0"
		push	ax
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pExp1Shape
		push	ax
		mov	ax, offset aExp1_0 ; "exp1"
		push	ax
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pExp2Shape
		push	ax
		mov	ax, offset aExp2_0 ; "exp2"
		push	ax
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pExp3Shape
		push	ax
		mov	ax, offset aExp3_0 ; "exp3"
		push	ax
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	bx, [bp+p_pCarId]
		mov	al, [bx]
		mov	[bp+var_10], al
		cmp	al, 0FFh
		jnz	short loc_E1A_1FFF
		jmp	loc_E1A_228A
; ---------------------------------------------------------------------------

loc_E1A_1FFF:				; CODE XREF: LoadCarShapes+208j
		mov	bx, [bp+arg_0]
		cmp	[bx], al
		jz	short loc_E1A_2009
		jmp	loc_E1A_208A
; ---------------------------------------------------------------------------

loc_E1A_2009:				; CODE XREF: LoadCarShapes+212j
		mov	di, [bp+p_pCarId]
		mov	al, [di+1]
		cmp	[bx+1],	al
		jnz	short loc_E1A_208A
		mov	al, [di+2]
		cmp	[bx+2],	al
		jnz	short loc_E1A_208A
		mov	al, [di+3]
		cmp	[bx+3],	al
		jnz	short loc_E1A_208A
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	ResourceSizeCha
		add	sp, 4
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx
		push	dx
		push	ax
		mov	ax, offset aCar2_0 ; "car2"
		push	ax
		call	AllocResBytes
		add	sp, 6
		mov	word ptr g_dwCurCarShpF2, ax
		mov	word ptr g_dwCurCarShpF2+2, dx
		sub	ax, ax
		mov	[bp+var_8], ax
		mov	[bp+var_A], ax
		jmp	short loc_E1A_2064
; ---------------------------------------------------------------------------
		nop
		nop
		nop

loc_E1A_205C:				; CODE XREF: LoadCarShapes+295j
		add	[bp+var_A], 1
		adc	[bp+var_8], 0

loc_E1A_2064:				; CODE XREF: LoadCarShapes+265j
		mov	ax, [bp+var_6]
		mov	dx, [bp+var_4]
		cmp	[bp+var_8], dx
		jg	short loc_E1A_20B7
		jl	short loc_E1A_2076
		cmp	[bp+var_A], ax
		jnb	short loc_E1A_20B7

loc_E1A_2076:				; CODE XREF: LoadCarShapes+27Dj
		mov	bx, [bp+var_A]
		les	di, g_dwCurCarShpFi
		mov	al, es:[bx+di]
		les	di, g_dwCurCarShpF2
		mov	es:[bx+di], al
		jmp	short loc_E1A_205C
; ---------------------------------------------------------------------------
		nop

loc_E1A_208A:				; CODE XREF: LoadCarShapes+214j
					; LoadCarShapes+220j ...
		mov	bx, [bp+p_pCarId]
		mov	al, [bx]
		mov	byte ptr aStxxx+2, al
		mov	al, [bx+1]
		mov	byte ptr aStxxx+3, al
		mov	al, [bx+2]
		mov	byte ptr aStxxx+4, al
		mov	al, [bx+3]
		mov	byte_2B77_2F9F,	al
		mov	ax, offset aStxxx ; "stxxx"
		push	ax
		call	Load3DShape
		add	sp, 2
		mov	word ptr g_dwCurCarShpF2, ax
		mov	word ptr g_dwCurCarShpF2+2, dx

loc_E1A_20B7:				; CODE XREF: LoadCarShapes+27Bj
					; LoadCarShapes+282j
		mov	ax, offset g_pOppCar0Shape
		push	ax
		mov	ax, offset aCar0_0 ; "car0"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pOppCar1Shape
		push	ax
		mov	ax, offset aCar1_0 ; "car1"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, word ptr g_pOppCar1Shape.pVertices
		mov	dx, word ptr g_pOppCar1Shape.pVertices+2
		add	ax, 30h	; '0'   ; vertex #8 ? det er noe special med de 8 forste vertexene . bounding box eller noe!!! ja!
		mov	word ptr [bp+var_E], ax
		mov	word ptr [bp+var_E+2], dx
		les	bx, [bp+var_E]
		mov	ax, es:[bx+Vector3D.wZ]
		mov	g_wCar2Z, ax
		mov	ax, es:[bx+(Vector3D.wX+12h)]
		add	ax, es:[bx+Vector3D.wX]
		sar	ax, 1
		mov	g_wCar2XSum, ax
		mov	ax, es:[bx+(Vector3D.wZ+24h)]
		mov	g_wCar2Z2, ax
		mov	ax, es:[bx+(Vector3D.wX+24h)]
		add	ax, es:[bx+(Vector3D.wX+36h)]
		sar	ax, 1
		mov	g_wCar2XSum2, ax
		sub	si, si

loc_E1A_2137:				; CODE XREF: LoadCarShapes+3D2j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	di, ax
		mov	ax, g_wCar2XSum
		les	bx, [bp+var_E]
		sub	ax, es:[bx+di]
		mov	word ptr g_pCar2_6Vecs.wX[di], ax
		les	bx, [bp+var_E]
		mov	ax, g_wCar2Z
		sub	ax, es:[bx+di+4]
		mov	g_pCar2_6Vecs.wZ[di], ax
		les	bx, [bp+var_E]
		mov	ax, es:[bx+di+2]
		mov	g_pCar2_6Vecs.wY[di], ax
		les	bx, [bp+var_E]
		mov	ax, g_wCar2XSum2
		sub	ax, es:[bx+di+(Vector3D.wX+24h)]
		mov	word ptr g_pCar2_6Vecs2.wX[di],	ax
		les	bx, [bp+var_E]
		mov	ax, g_wCar2Z2
		sub	ax, es:[bx+di+(Vector3D.wZ+24h)]
		mov	g_pCar2_6Vecs2.wZ[di], ax
		les	bx, [bp+var_E]
		mov	ax, es:[bx+di+(Vector3D.wY+24h)]
		mov	g_pCar2_6Vecs2.wY[di], ax
		les	bx, [bp+var_E]
		push	si
		push	di
		lea	si, [bx+di+(Vector3D.wX+48h)]
		lea	di, g_pCar2_6Vecs3.wX[di]
		push	ds
		push	ds
		push	es
		pop	ds
		pop	es
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		les	bx, [bp+var_E]
		push	si
		push	di
		lea	si, [bx+di+(Vector3D.wX+6Ch)]
		lea	di, g_pCar2_6Vecs4.wX[di]
		push	ds
		push	ds
		push	es
		pop	ds
		pop	es
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		inc	si
		cmp	si, 6
		jge	short loc_E1A_21C7
		jmp	loc_E1A_2137
; ---------------------------------------------------------------------------

loc_E1A_21C7:				; CODE XREF: LoadCarShapes+3D0j
		sub	si, si

loc_E1A_21C9:				; CODE XREF: LoadCarShapes+3E5j
		mov	bx, si
		shl	bx, 1
		mov	g_pCar2_5Zeros[bx], 0
		inc	si
		cmp	si, 5
		jl	short loc_E1A_21C9


		mov	ax, offset g_pOppCar2Shape
		push	ax
		mov	ax, offset aCar2_1 ; "car2"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pOppExp0Shape
		push	ax
		mov	ax, offset aExp0_1 ; "exp0"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pOppExp1Shape
		push	ax
		mov	ax, offset aExp1_1 ; "exp1"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pOppExp2Shape
		push	ax
		mov	ax, offset aExp2_1 ; "exp2"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary
		add	sp, 6
		mov	ax, offset g_pOppExp3Shape
		push	ax
		mov	ax, offset aExp3_1 ; "exp3"
		push	ax
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	Import3DShapeBinary ; denne tar	unk_2b7780de som param
					; fra over, og resourcen fra GetRes
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		nop

loc_E1A_228A:				; CODE XREF: LoadCarShapes+20Aj
		sub	ax, ax
		mov	word ptr g_dwCurCarShpF2+2, ax
		mov	word ptr g_dwCurCarShpF2, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
LoadCarShapes	endp


; =============== S U B	R O U T	I N E =======================================


UnloadCurCar	proc far		; CODE XREF: RunCarMenu+381P
					; RunCarMenu+B44P ...
		mov	ax, word ptr g_dwCurCarShpF2
		or	ax, word ptr g_dwCurCarShpF2+2
		jz	short loc_E1A_22D7
		mov	ax, offset g_wCar2XSum
		push	ax
		mov	ax, offset g_pCar2_6Vecs
		push	ax
		mov	ax, offset g_pCar2_5Zeros
		push	ax
		mov	ax, offset unk_2B77_2FA0
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, word ptr g_pOppCar1Shape.pVertices
		mov	dx, word ptr g_pOppCar1Shape.pVertices+2
		add	ax, 30h	; '0'
		push	dx
		push	ax
		push	cs
		call	near ptr sub_E1A_230E
		add	sp, 0Eh
		push	word ptr g_dwCurCarShpF2+2
		push	word ptr g_dwCurCarShpF2
		call	SetResField10To0
		add	sp, 4

loc_E1A_22D7:				; CODE XREF: UnloadCurCar+7j
		mov	ax, offset g_wCarXSum
		push	ax
		mov	ax, offset g_pCar1_6Vecs
		push	ax
		mov	ax, offset g_pCar1_5Zeros
		push	ax
		mov	ax, offset unk_2B77_2FA0
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, word ptr g_pCar1Shape.pVertices
		mov	dx, word ptr g_pCar1Shape.pVertices+2
		add	ax, 30h	; '0'
		push	dx
		push	ax
		push	cs
		call	near ptr sub_E1A_230E
		add	sp, 0Eh
		push	word ptr g_dwCurCarShpFi+2
		push	word ptr g_dwCurCarShpFi
		call	UnloadResource
		add	sp, 4
		retf
UnloadCurCar	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_E1A_230E	proc far		; CODE XREF: UpdateFrame+184EP
					; UpdateFrame+1AFAP ...

var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_8		= word ptr -8
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= dword	ptr  6
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 14h
		push	di
		push	si
		mov	bx, [bp+arg_8]
		mov	ax, [bp+arg_4]
		cmp	[bx+8],	ax
		jnz	short loc_E1A_2324
		jmp	loc_E1A_24AC
; ---------------------------------------------------------------------------

loc_E1A_2324:				; CODE XREF: sub_E1A_230E+11j
		sar	ax, 1
		push	ax
		call	LookupSine
		add	sp, 2
		mov	[bp+var_C], ax
		mov	ax, [bp+arg_4]
		sar	ax, 1
		push	ax
		call	LookupCos
		add	sp, 2
		mov	[bp+var_2], ax
		sub	si, si

loc_E1A_2345:				; CODE XREF: sub_E1A_230E+E1j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_10], ax
		push	[bp+var_2]
		mov	bx, [bp+arg_A]
		mov	ax, si
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	bx, ax
		push	word ptr [bx]
		call	ScaleValue
		add	sp, 4
		push	[bp+var_C]
		mov	bx, [bp+arg_A]
		add	bx, [bp+var_10]
		push	word ptr [bx+4]
		mov	[bp+var_14], ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_C]
		mov	cx, [bx]
		add	cx, ax
		add	cx, [bp+var_14]
		les	bx, [bp+arg_0]
		add	bx, [bp+var_10]
		mov	es:[bx], cx
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_12], ax
		push	[bp+var_2]
		mov	bx, [bp+arg_A]
		mov	ax, si
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	bx, ax
		push	word ptr [bx+4]
		call	ScaleValue
		add	sp, 4
		push	[bp+var_C]
		mov	bx, [bp+arg_A]
		add	bx, [bp+var_12]
		push	word ptr [bx]
		mov	[bp+var_14], ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_C]
		mov	cx, [bx+4]
		add	cx, ax
		add	cx, [bp+var_14]
		les	bx, [bp+arg_0]
		add	bx, [bp+var_12]
		mov	es:[bx+4], cx
		inc	si
		cmp	si, 6
		jge	short loc_E1A_23F2
		jmp	loc_E1A_2345
; ---------------------------------------------------------------------------

loc_E1A_23F2:				; CODE XREF: sub_E1A_230E+DFj
		mov	si, 6

loc_E1A_23F5:				; CODE XREF: sub_E1A_230E+192j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_14], ax
		push	[bp+var_2]
		mov	bx, [bp+arg_A]
		mov	ax, si
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	bx, ax
		push	word ptr [bx]
		call	ScaleValue
		add	sp, 4
		push	[bp+var_C]
		mov	bx, [bp+arg_A]
		add	bx, [bp+var_14]
		push	word ptr [bx+4]
		mov	[bp+var_10], ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_C]
		mov	cx, [bx+6]
		add	cx, ax
		add	cx, [bp+var_10]
		les	bx, [bp+arg_0]
		add	bx, [bp+var_14]
		mov	es:[bx], cx
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_12], ax
		push	[bp+var_2]
		mov	bx, [bp+arg_A]
		mov	ax, si
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	bx, ax
		push	word ptr [bx+4]
		call	ScaleValue
		add	sp, 4
		push	[bp+var_C]
		mov	bx, [bp+arg_A]
		add	bx, [bp+var_12]
		push	word ptr [bx]
		mov	[bp+var_10], ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_C]
		mov	cx, [bx+0Ah]
		add	cx, ax
		add	cx, [bp+var_10]
		les	bx, [bp+arg_0]
		add	bx, [bp+var_12]
		mov	es:[bx+4], cx
		inc	si
		cmp	si, 0Ch
		jge	short loc_E1A_24A3
		jmp	loc_E1A_23F5
; ---------------------------------------------------------------------------

loc_E1A_24A3:				; CODE XREF: sub_E1A_230E+190j
		mov	bx, [bp+arg_8]
		mov	ax, [bp+arg_4]
		mov	[bx+8],	ax

loc_E1A_24AC:				; CODE XREF: sub_E1A_230E+13j
		sub	di, di
		jmp	short loc_E1A_24E7
; ---------------------------------------------------------------------------

loc_E1A_24B0:				; CODE XREF: sub_E1A_230E+1C8j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, [bp+arg_A]
		add	bx, ax
		mov	ax, [bx+2]
		sub	ax, [bp+var_8]
		les	bx, [bp+arg_0]
		add	bx, [bp+var_14]
		mov	es:[bx+2], ax
		inc	si

loc_E1A_24D3:				; CODE XREF: sub_E1A_230E+21Dj
		cmp	[bp+var_4], si
		jg	short loc_E1A_24B0
		mov	bx, [bp+arg_8]
		mov	ax, di
		shl	ax, 1
		add	bx, ax
		mov	ax, [bp+var_8]
		mov	[bx], ax

loc_E1A_24E6:				; CODE XREF: sub_E1A_230E+205j
		inc	di

loc_E1A_24E7:				; CODE XREF: sub_E1A_230E+1A0j
		cmp	di, 4
		jge	short loc_E1A_252E
		mov	ax, di
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	bx, [bp+arg_6]
		add	bx, ax
		mov	ax, [bx]
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	cx, 6
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_8], ax
		mov	bx, [bp+arg_8]
		add	bx, [bp+var_14]
		cmp	[bx], ax
		jz	short loc_E1A_24E6
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_E], ax
		add	ax, 6
		mov	[bp+var_4], ax
		mov	si, [bp+var_E]
		jmp	short loc_E1A_24D3
; ---------------------------------------------------------------------------
		nop

loc_E1A_252E:				; CODE XREF: sub_E1A_230E+1DCj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_E1A_230E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupTrack	proc far		; CODE XREF: _main+36DP
					; RunTracksMenu+4AAP ...

pTrakdata	= dword	ptr -0AF0h
wCurRow		= word ptr -0AECh
wCurCol		= word ptr -0AEAh
var_AE8		= byte ptr -0AE8h
var_AE6		= byte ptr -0AE6h
var_AE4		= byte ptr -0AE4h
pTcomp0		= dword	ptr -0AE2h
var_ADE		= word ptr -0ADEh
var_ADC		= word ptr -0ADCh
var_ADA		= word ptr -0ADAh
var_AD8		= word ptr -0AD8h
var_AD6		= word ptr -0AD6h
pTrackbytes_AD4	= byte ptr -0AD4h
cTrak15Byte	= byte ptr -74Eh
var_74C		= byte ptr -74Ch
pTcomp		= dword	ptr -74Ah
var_746		= byte ptr -746h
var_744		= byte ptr -744h
var_742		= byte ptr -742h
var_740		= byte ptr -740h
var_73E		= byte ptr -73Eh
cRowCounter	= byte ptr -73Ah
pTrackBytes2	= byte ptr -738h
cReturnCode	= byte ptr -3B0h
var_3AE		= word ptr -3AEh
var_3AC		= word ptr -3ACh
var_3AA		= byte ptr -3AAh
var_3A8		= byte ptr -3A8h
var_3A6		= byte ptr -3A6h
cColCounter	= byte ptr -3A4h
var_3A2		= word ptr -3A2h
pTcomp2		= dword	ptr -3A0h
var_39C		= word ptr -39Ch
var_39A		= byte ptr -39Ah
pTrackBytes3	= byte ptr -398h
cTrak15Code	= byte ptr -12h
var_10		= byte ptr -10h
cTrak14Byte	= byte ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= byte ptr -6
var_4		= byte ptr -4
var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 0AF0h
		push	di
		push	si
		mov	ax, 380h	; 896
		cwd
		push	dx
		push	ax
		mov	ax, offset aTcomp ; "tcomp"
		push	ax
		call	AllocResBytes
		add	sp, 6
		mov	word ptr [bp+pTcomp0], ax
		mov	word ptr [bp+pTcomp0+2], dx
		or	ax, dx
		jnz	short loc_E1A_2564
		mov	ax, 2
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_E1A_2564:				; CODE XREF: SetupTrack+25j
		mov	ax, word ptr [bp+pTcomp0]
		mov	dx, word ptr [bp+pTcomp0+2]
		mov	word ptr [bp+pTcomp], ax
		mov	word ptr [bp+pTcomp+2],	dx
		mov	[bp+var_3A6], 0
		mov	[bp+var_4], 0
		mov	word_2B77_A660,	0
		sub	si, si
; set 900 bytes	to -1

loc_E1A_2585:				; CODE XREF: SetupTrack+5Ej
		les	bx, g_ppTrakdata19
		mov	byte ptr es:[bx+si], 0FFh
		inc	si
		cmp	si, 385h
		jl	short loc_E1A_2585
		mov	[bp+cRowCounter], 0
		jmp	short loc_E1A_2604
; ---------------------------------------------------------------------------
		nop

loc_E1A_259C:				; CODE XREF: SetupTrack+AEj
					; SetupTrack+B2j
		mov	bl, [bp+cTrak15Byte]
		sub	bh, bh
		mov	al, g_arrTrak15_2[bx]
		mov	[bp+cTrak15Code], al
		inc	[bp+cColCounter]

loc_E1A_25AD:				; CODE XREF: SetupTrack+E0j
		cmp	[bp+cColCounter], 1Eh
		jge	short loc_E1A_2600
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]	; read byte at colXrow in trakdata15
		mov	[bp+cTrak15Byte], al
		mov	bl, al
		sub	bh, bh
		mov	al, [bp+cTrak15Code]
		cmp	g_arrTrak15[bx], al
		jz	short loc_E1A_259C
		cmp	al, 63h
		jz	short loc_E1A_259C

loc_E1A_25E8:				; CODE XREF: SetupTrack+136j
		mov	[bp+cReturnCode], 0Bh

loc_E1A_25ED:				; CODE XREF: SetupTrack+16Aj
					; SetupTrack+29Ej ...
		cmp	[bp+cColCounter], 0FFh
		jz	short loc_E1A_25F7
		jmp	loc_E1A_35DA
; ---------------------------------------------------------------------------

loc_E1A_25F7:				; CODE XREF: SetupTrack+BEj
		mov	[bp+cColCounter], 0
		jmp	loc_E1A_35E6
; ---------------------------------------------------------------------------
		nop

loc_E1A_2600:				; CODE XREF: SetupTrack+7Ej
		inc	[bp+cRowCounter]

loc_E1A_2604:				; CODE XREF: SetupTrack+65j
		cmp	[bp+cRowCounter], 1Eh
		jge	short loc_E1A_2616
		mov	[bp+cTrak15Code], 63h
		mov	[bp+cColCounter], 0
		jmp	short loc_E1A_25AD
; ---------------------------------------------------------------------------

loc_E1A_2616:				; CODE XREF: SetupTrack+D5j
		mov	[bp+cColCounter], 0
		jmp	short loc_E1A_2672
; ---------------------------------------------------------------------------
		nop

loc_E1A_261E:				; CODE XREF: SetupTrack+130j
					; SetupTrack+134j
		mov	bl, [bp+cTrak15Byte]
		sub	bh, bh
		mov	al, g_arrTrak15_4[bx]
		mov	[bp+cTrak15Code], al
		inc	[bp+cRowCounter]

loc_E1A_262F:				; CODE XREF: SetupTrack+14Ej
		cmp	[bp+cRowCounter], 1Eh
		jge	short loc_E1A_266E
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+cTrak15Byte], al
		mov	bl, al
		sub	bh, bh
		mov	al, [bp+cTrak15Code]
		cmp	g_arrTrak15_3[bx], al
		jz	short loc_E1A_261E
		cmp	al, 63h
		jz	short loc_E1A_261E
		jmp	loc_E1A_25E8
; ---------------------------------------------------------------------------
		nop

loc_E1A_266E:				; CODE XREF: SetupTrack+100j
		inc	[bp+cColCounter]

loc_E1A_2672:				; CODE XREF: SetupTrack+E7j
		cmp	[bp+cColCounter], 1Eh
		jge	short loc_E1A_2684
		mov	[bp+cTrak15Code], 63h
		mov	[bp+cRowCounter], 0
		jmp	short loc_E1A_262F
; ---------------------------------------------------------------------------

loc_E1A_2684:				; CODE XREF: SetupTrack+143j
		mov	[bp+cRowCounter], 0
		jmp	loc_E1A_27B6
; ---------------------------------------------------------------------------

loc_E1A_268C:				; CODE XREF: SetupTrack+24Fj
					; SetupTrack+25Cj ...
		mov	g_wUseTrkInRpl,	0

loc_E1A_2692:				; CODE XREF: SetupTrack+174j
					; SetupTrack+17Cj ...
		cmp	[bp+var_3A6], 0
		jz	short loc_E1A_26DA
		mov	[bp+cReturnCode], 3
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------
		nop

loc_E1A_26A2:				; CODE XREF: SetupTrack+189j
					; SetupTrack+198j ...
		mov	g_wUseTrkInRpl,	200h
		jmp	short loc_E1A_2692
; ---------------------------------------------------------------------------

loc_E1A_26AA:				; CODE XREF: SetupTrack+18Ej
					; SetupTrack+19Dj ...
		mov	g_wUseTrkInRpl,	100h
		jmp	short loc_E1A_2692
; ---------------------------------------------------------------------------

loc_E1A_26B2:				; CODE XREF: SetupTrack+193j
					; SetupTrack:loc_E1A_26D6j
		mov	g_wUseTrkInRpl,	300h
		jmp	short loc_E1A_2692
; ---------------------------------------------------------------------------

loc_E1A_26BA:				; CODE XREF: SetupTrack+254j
		cmp	ax, 94h
		jz	short loc_E1A_26A2
		cmp	ax, 95h
		jz	short loc_E1A_26AA
		cmp	ax, 96h
		jz	short loc_E1A_26B2
		cmp	ax, 0B3h
		jz	short loc_E1A_26A2
		cmp	ax, 0B4h
		jz	short loc_E1A_26AA
		cmp	ax, 0B5h

loc_E1A_26D6:				; CODE XREF: SetupTrack+27Aj
		jz	short loc_E1A_26B2
		jmp	short loc_E1A_271B
; ---------------------------------------------------------------------------

loc_E1A_26DA:				; CODE XREF: SetupTrack+163j
		mov	al, [bp+cColCounter]
		mov	g_cStartCol2, al
		mov	al, [bp+cRowCounter]
		mov	g_cStartRow2, al
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+cTrak15Byte], al
		cmp	al, 6
		jnz	short loc_E1A_2712
		mov	byte_2B77_922B,	1
		jmp	short loc_E1A_2717
; ---------------------------------------------------------------------------

loc_E1A_2712:				; CODE XREF: SetupTrack+1D5j
		mov	byte_2B77_922B,	0

loc_E1A_2717:				; CODE XREF: SetupTrack+1DCj
		inc	[bp+var_3A6]

loc_E1A_271B:				; CODE XREF: SetupTrack+1A4j
		inc	[bp+cColCounter]

loc_E1A_271F:				; CODE XREF: SetupTrack+28Ej
		cmp	[bp+cColCounter], 1Eh
		jl	short loc_E1A_2729
		jmp	loc_E1A_27B2
; ---------------------------------------------------------------------------

loc_E1A_2729:				; CODE XREF: SetupTrack+1F0j
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx]
		mov	[bp+cTrak14Byte], al
		cmp	al, 0FDh
		jb	short loc_E1A_2753
		mov	[bp+cTrak14Byte], 0

loc_E1A_2753:				; CODE XREF: SetupTrack+219j
		cmp	[bp+cTrak14Byte], 0B6h
		jb	short loc_E1A_2779
		mov	[bp+cTrak14Byte], 4
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	byte ptr es:[bx], 4

loc_E1A_2779:				; CODE XREF: SetupTrack+223j
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		cmp	ax, 93h
		jnz	short loc_E1A_2786
		jmp	loc_E1A_268C
; ---------------------------------------------------------------------------

loc_E1A_2786:				; CODE XREF: SetupTrack+24Dj
		jbe	short loc_E1A_278B
		jmp	loc_E1A_26BA
; ---------------------------------------------------------------------------

loc_E1A_278B:				; CODE XREF: SetupTrack:loc_E1A_2786j
		cmp	ax, 1
		jnz	short loc_E1A_2793
		jmp	loc_E1A_268C
; ---------------------------------------------------------------------------

loc_E1A_2793:				; CODE XREF: SetupTrack+25Aj
		cmp	ax, 86h
		jnz	short loc_E1A_279B
		jmp	loc_E1A_268C
; ---------------------------------------------------------------------------

loc_E1A_279B:				; CODE XREF: SetupTrack+262j
		cmp	ax, 87h
		jnz	short loc_E1A_27A3
		jmp	loc_E1A_26A2
; ---------------------------------------------------------------------------

loc_E1A_27A3:				; CODE XREF: SetupTrack+26Aj
		cmp	ax, 88h
		jnz	short loc_E1A_27AB
		jmp	loc_E1A_26AA
; ---------------------------------------------------------------------------

loc_E1A_27AB:				; CODE XREF: SetupTrack+272j
		cmp	ax, 89h
		jmp	loc_E1A_26D6
; ---------------------------------------------------------------------------
		nop

loc_E1A_27B2:				; CODE XREF: SetupTrack+1F2j
		inc	[bp+cRowCounter]

loc_E1A_27B6:				; CODE XREF: SetupTrack+155j
		cmp	[bp+cRowCounter], 1Eh
		jge	short loc_E1A_27C6
		mov	[bp+cColCounter], 0
		jmp	loc_E1A_271F
; ---------------------------------------------------------------------------
		nop

loc_E1A_27C6:				; CODE XREF: SetupTrack+287j
		cmp	[bp+var_3A6], 0
		jnz	short loc_E1A_27D6
		mov	[bp+cReturnCode], 1
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------
		nop

loc_E1A_27D6:				; CODE XREF: SetupTrack+297j
		mov	word_2B77_A660,	0
		mov	[bp+var_746], 0
		mov	byte_2B77_9EC5,	0
		mov	byte_2B77_A9FE,	0
		mov	[bp+var_3A8], 0
		mov	[bp+var_AE8], 0
		sub	si, si

loc_E1A_27F7:				; CODE XREF: SetupTrack+2F5j
		mov	[bp+si+pTrackBytes2], 0
		mov	ax, si
		shl	ax, 1
		mov	[bp+wCurCol], ax
		mov	bx, ax
		add	bx, word ptr g_ppTrakdata
		mov	es, word ptr g_ppTrakdata+2
		mov	word ptr es:[bx], 0FFFFh
		mov	bx, [bp+wCurCol]
		add	bx, word ptr g_ppTrakdata2
		mov	es, word ptr g_ppTrakdata2+2
		mov	word ptr es:[bx], 0FFFFh
		inc	si
		cmp	si, 385h
		jl	short loc_E1A_27F7


		mov	al, g_cStartCol2
		mov	[bp+cColCounter], al
		mov	al, g_cStartRow2
		mov	[bp+cRowCounter], al
		mov	ax, g_wUseTrkInRpl
		mov	[bp+var_8], ax
		mov	[bp+cTrak15Code], 0
		mov	[bp+var_3AC], 0FFFFh

loc_E1A_2849:				; CODE XREF: SetupTrack+3DAj
					; SetupTrack+7F5j ...
		mov	[bp+var_2], 0
		cmp	[bp+cColCounter], 0
		jl	short loc_E1A_286C
		cmp	[bp+cRowCounter], 0
		jl	short loc_E1A_286C
		cmp	[bp+cColCounter], 1Dh
		jg	short loc_E1A_286C
		cmp	[bp+cRowCounter], 1Dh
		jg	short loc_E1A_286C
		jmp	loc_E1A_2922
; ---------------------------------------------------------------------------

loc_E1A_286C:				; CODE XREF: SetupTrack+31Ej
					; SetupTrack+325j ...
		cmp	[bp+var_746], 0
		jnz	short loc_E1A_2876
		jmp	loc_E1A_2D80
; ---------------------------------------------------------------------------

loc_E1A_2876:				; CODE XREF: SetupTrack+33Dj
		dec	[bp+var_746]
		mov	al, [bp+var_746]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr [bp+pTcomp]
		mov	dx, word ptr [bp+pTcomp+2]
		mov	word ptr [bp+pTcomp2], ax
		mov	word ptr [bp+pTcomp2+2], dx
		les	bx, [bp+pTcomp2]
		mov	al, es:[bx]
		mov	[bp+cColCounter], al
		mov	al, es:[bx+1]
		mov	[bp+cRowCounter], al
		mov	al, es:[bx+2]
		mov	[bp+cTrak14Byte], al
		mov	al, es:[bx+3]
		mov	[bp+var_742], al
		mov	al, es:[bx+4]
		mov	[bp+var_73E], al
		mov	al, es:[bx+0Bh]
		mov	[bp+cTrak15Code], al
		mov	ax, es:[bx+0Ch]
		mov	[bp+var_3AC], ax
		mov	al, es:[bx+5]
		mov	[bp+var_3A8], al
		mov	al, es:[bx+6]
		mov	[bp+var_10], al
		mov	al, es:[bx+7]
		mov	[bp+var_39A], al
		mov	al, es:[bx+8]
		mov	[bp+var_AE6], al
		mov	al, es:[bx+9]
		mov	[bp+var_3AA], al
		mov	al, es:[bx+0Ah]
		mov	[bp+var_740], al
		mov	[bp+var_2], 1

loc_E1A_2908:				; CODE XREF: SetupTrack+7B4j
		cmp	[bp+var_2], 0
		jnz	short loc_E1A_2911
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_2911:				; CODE XREF: SetupTrack+3D8j
		cmp	[bp+var_4], 1
		ja	short loc_E1A_291A
		jmp	loc_E1A_2DCA
; ---------------------------------------------------------------------------

loc_E1A_291A:				; CODE XREF: SetupTrack+3E1j
		mov	[bp+cReturnCode], 0Ah
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------

loc_E1A_2922:				; CODE XREF: SetupTrack+335j
		mov	al, [bp+cColCounter]
		cbw
		mov	[bp+wCurCol], ax
		mov	al, [bp+cRowCounter]
		cbw
		shl	ax, 1
		mov	[bp+wCurRow], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, [bp+wCurCol]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx]
		mov	[bp+cTrak14Byte], al
		mov	bx, [bp+wCurRow]
		mov	bx, g_wTerrainRows[bx]
		add	bx, [bp+wCurCol]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+cTrak15Byte], al
		cmp	[bp+cTrak14Byte], 0
		jz	short loc_E1A_2990
		or	al, al
		jz	short loc_E1A_2990
		cmp	al, 7
		jb	short loc_E1A_2990
		cmp	al, 0Bh
		jnb	short loc_E1A_2990
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		push	ax
		mov	al, [bp+cTrak15Byte]
		push	ax
		push	cs
		call	near ptr MapTerrainTrack
		add	sp, 4
		mov	[bp+cTrak14Byte], al

loc_E1A_2990:				; CODE XREF: SetupTrack+439j
					; SetupTrack+43Dj ...
		cmp	[bp+cTrak14Byte], 0FDh
		jnb	short loc_E1A_2999
		jmp	loc_E1A_2A72
; ---------------------------------------------------------------------------

loc_E1A_2999:				; CODE XREF: SetupTrack+460j
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		cmp	ax, 0FDh
		jz	short loc_E1A_29D6
		cmp	ax, 0FEh
		jz	short loc_E1A_2A02
		cmp	ax, 0FFh
		jnz	short loc_E1A_29B0
		jmp	loc_E1A_2A34
; ---------------------------------------------------------------------------

loc_E1A_29B0:				; CODE XREF: SetupTrack+477j
					; SetupTrack+4C0j ...
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx]
		mov	[bp+cTrak14Byte], al
		jmp	loc_E1A_2A8E
; ---------------------------------------------------------------------------
		nop

loc_E1A_29D6:				; CODE XREF: SetupTrack+46Dj
		dec	[bp+cColCounter]
		dec	[bp+cRowCounter]
		mov	ax, [bp+var_8]
		or	ax, ax
		jz	short loc_E1A_29F6
		cmp	ax, 100h
		jz	short loc_E1A_2A62
		cmp	ax, 200h
		jz	short loc_E1A_2A62
		cmp	ax, 300h
		jz	short loc_E1A_29FC
		jmp	short loc_E1A_29B0
; ---------------------------------------------------------------------------

loc_E1A_29F6:				; CODE XREF: SetupTrack+4AFj
		mov	[bp+var_6], 0Ch
		jmp	short loc_E1A_29B0
; ---------------------------------------------------------------------------

loc_E1A_29FC:				; CODE XREF: SetupTrack+4BEj
		mov	[bp+var_6], 9
		jmp	short loc_E1A_29B0
; ---------------------------------------------------------------------------

loc_E1A_2A02:				; CODE XREF: SetupTrack+472j
		dec	[bp+cRowCounter]
		mov	ax, [bp+var_8]
		or	ax, ax
		jz	short loc_E1A_2A1E
		cmp	ax, 100h
		jz	short loc_E1A_2A24
		cmp	ax, 200h
		jz	short loc_E1A_2A62
		cmp	ax, 300h
		jz	short loc_E1A_2A2C
		jmp	short loc_E1A_29B0
; ---------------------------------------------------------------------------

loc_E1A_2A1E:				; CODE XREF: SetupTrack+4D7j
		mov	[bp+var_6], 0Bh
		jmp	short loc_E1A_29B0
; ---------------------------------------------------------------------------

loc_E1A_2A24:				; CODE XREF: SetupTrack+4DCj
		mov	[bp+var_6], 6
		jmp	short loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop
		nop

loc_E1A_2A2C:				; CODE XREF: SetupTrack+4E6j
		mov	[bp+var_6], 7
		jmp	loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop

loc_E1A_2A34:				; CODE XREF: SetupTrack+479j
		dec	[bp+cColCounter]
		mov	ax, [bp+var_8]
		or	ax, ax
		jz	short loc_E1A_2A52
		cmp	ax, 100h
		jz	short loc_E1A_2A62
		cmp	ax, 200h
		jz	short loc_E1A_2A5A
		cmp	ax, 300h
		jz	short loc_E1A_2A6A
		jmp	loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop

loc_E1A_2A52:				; CODE XREF: SetupTrack+509j
		mov	[bp+var_6], 0Ah
		jmp	loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop

loc_E1A_2A5A:				; CODE XREF: SetupTrack+513j
		mov	[bp+var_6], 5
		jmp	loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop

loc_E1A_2A62:				; CODE XREF: SetupTrack+4B4j
					; SetupTrack+4B9j ...
		mov	[bp+var_6], 0
		jmp	loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop

loc_E1A_2A6A:				; CODE XREF: SetupTrack+518j
		mov	[bp+var_6], 8
		jmp	loc_E1A_29B0
; ---------------------------------------------------------------------------
		nop

loc_E1A_2A72:				; CODE XREF: SetupTrack+462j
		mov	ax, [bp+var_8]
		or	ax, ax
		jz	short loc_E1A_2A8A
		cmp	ax, 100h
		jz	short loc_E1A_2AA8
		cmp	ax, 200h
		jz	short loc_E1A_2AA2
		cmp	ax, 300h
		jz	short loc_E1A_2AAE
		jmp	short loc_E1A_2A8E
; ---------------------------------------------------------------------------

loc_E1A_2A8A:				; CODE XREF: SetupTrack+543j
		mov	[bp+var_6], 2

loc_E1A_2A8E:				; CODE XREF: SetupTrack+49Ej
					; SetupTrack+554j ...
		cmp	[bp+var_4], 0
		jnz	short loc_E1A_2AB4
		cmp	[bp+var_6], 0
		jnz	short loc_E1A_2AB4
		mov	[bp+cReturnCode], 2
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------

loc_E1A_2AA2:				; CODE XREF: SetupTrack+54Dj
		mov	[bp+var_6], 1
		jmp	short loc_E1A_2A8E
; ---------------------------------------------------------------------------

loc_E1A_2AA8:				; CODE XREF: SetupTrack+548j
		mov	[bp+var_6], 4
		jmp	short loc_E1A_2A8E
; ---------------------------------------------------------------------------

loc_E1A_2AAE:				; CODE XREF: SetupTrack+552j
		mov	[bp+var_6], 3
		jmp	short loc_E1A_2A8E
; ---------------------------------------------------------------------------

loc_E1A_2AB4:				; CODE XREF: SetupTrack+55Ej
					; SetupTrack+564j
		mov	[bp+var_2], 0
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_sceneShapes.field_0[bx]
		mov	[bp+var_39C], ax
		or	ax, ax
		jnz	short loc_E1A_2AD8
		jmp	loc_E1A_2CE2
; ---------------------------------------------------------------------------

loc_E1A_2AD8:				; CODE XREF: SetupTrack+59Fj
		sub	si, si
		jmp	loc_E1A_2C9A
; ---------------------------------------------------------------------------
		nop

loc_E1A_2ADE:				; CODE XREF: SetupTrack+7A2j
		mov	[bp+var_AE4], 0
		jmp	short loc_E1A_2B02
; ---------------------------------------------------------------------------
		nop

loc_E1A_2AE6:				; CODE XREF: SetupTrack+797j
		mov	bx, [bp+var_3AE]
		mov	al, [bp+var_6]
		cmp	[bx+2],	al
		jnz	short loc_E1A_2B02
		mov	al, [bp+cTrak15Code]
		cmp	[bx+4],	al
		jz	short loc_E1A_2AFD
		jmp	loc_E1A_2CD9
; ---------------------------------------------------------------------------

loc_E1A_2AFD:				; CODE XREF: SetupTrack+5C4j
		mov	[bp+var_AE4], 1

loc_E1A_2B02:				; CODE XREF: SetupTrack+5AFj
					; SetupTrack+5BCj
		cmp	[bp+var_AE4], 0
		jge	short loc_E1A_2B0C
		jmp	loc_E1A_2BA8
; ---------------------------------------------------------------------------

loc_E1A_2B0C:				; CODE XREF: SetupTrack+5D3j
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, bp
		cmp	[bx+pTrackBytes2], 0
		jz	short loc_E1A_2BA8
		sub	di, di
		jmp	short loc_E1A_2B6E
; ---------------------------------------------------------------------------
		nop

loc_E1A_2B2E:				; CODE XREF: SetupTrack+66Aj
		mov	[bp+var_AE4], 0FFh
		mov	ax, [bp+var_3AC]
		shl	ax, 1
		add	ax, word ptr g_ppTrakdata
		mov	dx, word ptr g_ppTrakdata+2
		mov	word ptr [bp+pTrakdata], ax
		mov	word ptr [bp+pTrakdata+2], dx
		les	bx, [bp+pTrakdata]
		cmp	word ptr es:[bx], 0FFFFh
		jz	short loc_E1A_2B61
		mov	bx, [bp+var_3AC]
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata2
		mov	es, word ptr g_ppTrakdata2+2

loc_E1A_2B61:				; CODE XREF: SetupTrack+61Dj
		mov	es:[bx], di
		or	di, di
		jnz	short loc_E1A_2B6D
		mov	[bp+var_AE8], 1

loc_E1A_2B6D:				; CODE XREF: SetupTrack+632j
					; SetupTrack+64Bj ...
		inc	di

loc_E1A_2B6E:				; CODE XREF: SetupTrack+5F7j
		cmp	word_2B77_A660,	di
		jle	short loc_E1A_2BA8
		les	bx, g_pTrakdata21
		mov	al, [bp+cColCounter]
		cmp	es:[bx+di], al
		jnz	short loc_E1A_2B6D
		les	bx, g_ppTrakdata22
		mov	al, [bp+cRowCounter]
		cmp	es:[bx+di], al
		jnz	short loc_E1A_2B6D
		mov	ax, si
		cmp	[bp+di+pTrackbytes_AD4], al
		jnz	short loc_E1A_2B6D
		mov	al, [bp+var_AE4]
		cmp	[bp+di+pTrackBytes3], al
		jz	short loc_E1A_2B2E
		mov	[bp+cReturnCode], 5
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------

loc_E1A_2BA8:				; CODE XREF: SetupTrack+5D5j
					; SetupTrack+5F3j ...
		cmp	[bp+var_AE4], 0
		jge	short loc_E1A_2BB2
		jmp	loc_E1A_2C99
; ---------------------------------------------------------------------------

loc_E1A_2BB2:				; CODE XREF: SetupTrack+679j
		cmp	[bp+var_2], 0
		jnz	short loc_E1A_2BCA
		mov	ax, si
		mov	[bp+var_742], al
		mov	al, [bp+var_AE4]
		mov	[bp+var_73E], al
		jmp	loc_E1A_2C96
; ---------------------------------------------------------------------------
		nop

loc_E1A_2BCA:				; CODE XREF: SetupTrack+682j
		cmp	[bp+var_746], 40h ; '@'
		jnz	short loc_E1A_2BDA
		mov	[bp+cReturnCode], 8
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------
		nop

loc_E1A_2BDA:				; CODE XREF: SetupTrack+69Bj
		mov	al, [bp+var_746]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr [bp+pTcomp]
		mov	dx, word ptr [bp+pTcomp+2]
		mov	word ptr [bp+pTcomp2], ax
		mov	word ptr [bp+pTcomp2+2], dx
		les	bx, [bp+pTcomp2]
		mov	al, [bp+cColCounter]
		mov	es:[bx], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+cRowCounter]
		mov	es:[bx+1], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+cTrak14Byte]
		mov	es:[bx+2], al
		les	bx, [bp+pTcomp2]
		mov	ax, si
		mov	es:[bx+3], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_AE4]
		mov	es:[bx+4], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+cTrak15Code]
		mov	es:[bx+0Bh], al
		les	bx, [bp+pTcomp2]
		mov	ax, [bp+var_3AC]
		mov	es:[bx+0Ch], ax
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_3A8]
		mov	es:[bx+5], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_10]
		mov	es:[bx+6], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_39A]
		mov	es:[bx+7], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_AE6]
		mov	es:[bx+8], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_3AA]
		mov	es:[bx+9], al
		les	bx, [bp+pTcomp2]
		mov	al, [bp+var_740]
		mov	es:[bx+0Ah], al
		inc	[bp+var_746]

loc_E1A_2C96:				; CODE XREF: SetupTrack+692j
		inc	[bp+var_2]

loc_E1A_2C99:				; CODE XREF: SetupTrack+67Bj
		inc	si

loc_E1A_2C9A:				; CODE XREF: SetupTrack+5A6j
		mov	bx, [bp+var_39C]
		mov	al, [bx]
		sub	ah, ah
		cmp	ax, si
		jbe	short loc_E1A_2CE2
		mov	[bp+var_AE4], 0FFh
		mov	ax, bx
		mov	cx, si
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		shl	cx, 1
		add	cx, dx
		shl	cx, 1
		add	ax, cx
		mov	[bp+var_3AE], ax
		mov	bx, ax
		mov	al, [bp+var_6]
		cmp	[bx+1],	al
		jz	short loc_E1A_2CCE
		jmp	loc_E1A_2AE6
; ---------------------------------------------------------------------------

loc_E1A_2CCE:				; CODE XREF: SetupTrack+795j
		mov	al, [bp+cTrak15Code]
		cmp	[bx+3],	al
		jnz	short loc_E1A_2CD9
		jmp	loc_E1A_2ADE
; ---------------------------------------------------------------------------

loc_E1A_2CD9:				; CODE XREF: SetupTrack+5C6j
					; SetupTrack+7A0j
		mov	[bp+cReturnCode], 4
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------
		nop

loc_E1A_2CE2:				; CODE XREF: SetupTrack+5A1j
					; SetupTrack+770j
		cmp	[bp+var_2], 0
		jz	short loc_E1A_2CEB
		jmp	loc_E1A_2908
; ---------------------------------------------------------------------------

loc_E1A_2CEB:				; CODE XREF: SetupTrack+7B2j
		cmp	[bp+cTrak15Code], 1
		jz	short loc_E1A_2CF4
		jmp	loc_E1A_286C
; ---------------------------------------------------------------------------

loc_E1A_2CF4:				; CODE XREF: SetupTrack+7BBj
		cmp	[bp+var_4], 2
		jb	short loc_E1A_2CFD
		jmp	loc_E1A_286C
; ---------------------------------------------------------------------------

loc_E1A_2CFD:				; CODE XREF: SetupTrack+7C4j
		cmp	[bp+var_3A8], 2
		jnb	short loc_E1A_2D0C
		mov	[bp+cReturnCode], 9
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------

loc_E1A_2D0C:				; CODE XREF: SetupTrack+7CEj
		inc	[bp+var_3A8]
		inc	[bp+var_4]
		mov	ax, [bp+var_8]
		or	ax, ax
		jz	short loc_E1A_2D2C
		cmp	ax, 100h
		jz	short loc_E1A_2D56
		cmp	ax, 200h
		jz	short loc_E1A_2D44
		cmp	ax, 300h
		jz	short loc_E1A_2D68
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_2D2C:				; CODE XREF: SetupTrack+7E4j
		mov	al, [bp+var_10]
		mov	[bp+cColCounter], al
		mov	al, [bp+var_39A]
		sub	al, [bp+var_4]
		dec	al

loc_E1A_2D3C:				; CODE XREF: SetupTrack+820j
		mov	[bp+cRowCounter], al
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------
		nop

loc_E1A_2D44:				; CODE XREF: SetupTrack+7EEj
		mov	al, [bp+var_10]
		mov	[bp+cColCounter], al
		mov	al, [bp+var_39A]
		add	al, [bp+var_4]
		inc	al
		jmp	short loc_E1A_2D3C
; ---------------------------------------------------------------------------

loc_E1A_2D56:				; CODE XREF: SetupTrack+7E9j
		mov	al, [bp+var_39A]
		mov	[bp+cRowCounter], al
		mov	al, [bp+var_10]
		add	al, [bp+var_4]
		inc	al
		jmp	short loc_E1A_2D78
; ---------------------------------------------------------------------------

loc_E1A_2D68:				; CODE XREF: SetupTrack+7F3j
		mov	al, [bp+var_39A]
		mov	[bp+cRowCounter], al
		mov	al, [bp+var_10]
		sub	al, [bp+var_4]
		dec	al

loc_E1A_2D78:				; CODE XREF: SetupTrack+832j
		mov	[bp+cColCounter], al
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------
		nop

loc_E1A_2D80:				; CODE XREF: SetupTrack+33Fj
		cmp	[bp+var_AE8], 0
		jnz	short loc_E1A_2D90
		mov	[bp+cReturnCode], 7
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------
		nop

loc_E1A_2D90:				; CODE XREF: SetupTrack+851j
		mov	al, g_cStartCol2
		mov	g_cStartCol, al
		mov	al, g_cStartRow2
		mov	g_cStartRow, al
		mov	ax, word_2B77_A660
		cwd
		mov	cx, 3
		idiv	cx
		mov	si, ax
		cmp	si, 40h	; '@'
		jle	short loc_E1A_2DAF
		mov	si, 40h	; '@'

loc_E1A_2DAF:				; CODE XREF: SetupTrack+876j
		mov	ax, si
		mov	byte_2B77_A9FE,	al
		sub	si, si

loc_E1A_2DB6:				; CODE XREF: SetupTrack+88Cj
		mov	[bp+si+pTrackbytes_AD4], 0
		inc	si
		cmp	si, 385h
		jl	short loc_E1A_2DB6
		sub	di, di
		sub	si, si
		jmp	loc_E1A_34E8
; ---------------------------------------------------------------------------
		nop

loc_E1A_2DCA:				; CODE XREF: SetupTrack+3E3j
		mov	[bp+var_4], 0
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, bp
		mov	[bx+pTrackBytes2], 1
		mov	bx, word_2B77_A660
		add	bx, bp
		mov	al, [bp+var_742]
		mov	[bx+pTrackbytes_AD4], al
		mov	bx, word_2B77_A660
		add	bx, bp
		mov	al, [bp+var_73E]
		mov	[bx+pTrackBytes3], al
		cmp	[bp+var_3AC], 0FFFFh
		jz	short loc_E1A_2E40
		mov	ax, [bp+var_3AC]
		shl	ax, 1
		add	ax, word ptr g_ppTrakdata
		mov	dx, word ptr g_ppTrakdata+2
		mov	word ptr [bp+pTrakdata], ax
		mov	word ptr [bp+pTrakdata+2], dx
		les	bx, [bp+pTrakdata]
		cmp	word ptr es:[bx], 0FFFFh
		jz	short loc_E1A_2E3A
		mov	bx, [bp+var_3AC]
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata2
		mov	es, word ptr g_ppTrakdata2+2

loc_E1A_2E3A:				; CODE XREF: SetupTrack+8F6j
		mov	ax, word_2B77_A660
		mov	es:[bx], ax

loc_E1A_2E40:				; CODE XREF: SetupTrack+8D6j
		mov	ax, word_2B77_A660
		mov	[bp+var_3AC], ax
		mov	bx, ax
		add	bx, word ptr g_pTrakdata21
		mov	es, word ptr g_pTrakdata21+2
		mov	al, [bp+cColCounter]
		mov	es:[bx], al
		mov	bx, word_2B77_A660
		add	bx, word ptr g_ppTrakdata22
		mov	es, word ptr g_ppTrakdata22+2
		mov	al, [bp+cRowCounter]
		mov	es:[bx], al
		mov	bx, word_2B77_A660
		add	bx, word ptr g_ppTrakdata18
		mov	es, word ptr g_ppTrakdata18+2
		mov	al, [bp+var_73E]
		mov	cl, 4
		shl	al, cl
		add	al, [bp+var_742]
		mov	es:[bx], al
		mov	bx, word_2B77_A660
		add	bx, word ptr g_ppTrakdata17
		mov	es, word ptr g_ppTrakdata17+2
		mov	al, [bp+cTrak14Byte]
		mov	es:[bx], al
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_sceneShapes.field_0[bx]
		mov	[bp+var_39C], ax
		mov	al, [bp+var_742]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_39C]
		mov	[bp+var_3AE], ax
		mov	bx, ax
		mov	al, [bx+0Ch]
		mov	[bp+var_74C], al
		or	al, al
		jnz	short loc_E1A_2EE0
		inc	[bp+var_3A8]
		jmp	loc_E1A_31C7
; ---------------------------------------------------------------------------
		nop

loc_E1A_2EE0:				; CODE XREF: SetupTrack+9A2j
		cmp	[bp+var_74C], 0FFh
		jnz	short loc_E1A_2EEA
		jmp	loc_E1A_31C2
; ---------------------------------------------------------------------------

loc_E1A_2EEA:				; CODE XREF: SetupTrack+9B1j
		cmp	[bp+var_3A8], 3
		ja	short loc_E1A_2EF4
		jmp	loc_E1A_31C2
; ---------------------------------------------------------------------------

loc_E1A_2EF4:				; CODE XREF: SetupTrack+9BBj
		cmp	byte_2B77_9EC5,	30h ; '0'
		jnz	short loc_E1A_2EFE
		jmp	loc_E1A_31C2
; ---------------------------------------------------------------------------

loc_E1A_2EFE:				; CODE XREF: SetupTrack+9C5j
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_sceneShapes.field_0[bx]
		mov	[bp+var_39C], ax
		mov	al, [bp+var_742]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_39C]
		mov	[bp+var_3AE], ax
		mov	bx, ax
		mov	al, [bx+0Ch]
		mov	[bp+var_74C], al
		mov	al, [bp+var_AE6]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_sceneShapes.field_0[bx]
		mov	[bp+var_39C], ax
		mov	al, [bp+var_3AA]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_39C]
		mov	[bp+var_3AE], ax
		cmp	[bp+var_740], 0
		jz	short loc_E1A_2F82
		mov	bx, ax
		cmp	word ptr [bx+0Ah], 0
		jz	short loc_E1A_2F86
		mov	ax, [bx+0Ah]
		jmp	short loc_E1A_2F89
; ---------------------------------------------------------------------------

loc_E1A_2F82:				; CODE XREF: SetupTrack+A3Fj
		mov	bx, [bp+var_3AE]

loc_E1A_2F86:				; CODE XREF: SetupTrack+A47j
		mov	ax, [bx+8]

loc_E1A_2F89:				; CODE XREF: SetupTrack+A4Cj
		mov	[bp+var_ADE], ax
		mov	[bp+var_ADC], ds
		cmp	[bp+var_740], 0
		jz	short loc_E1A_2FB6
		mov	bx, [bp+var_3AE]
		mov	al, [bx+5]
		sub	ah, ah
		shl	ax, 1
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_ADE]
		mov	dx, ds
		add	ax, 0Ch
		jmp	short loc_E1A_2FD4
; ---------------------------------------------------------------------------

loc_E1A_2FB6:				; CODE XREF: SetupTrack+A62j
		mov	bx, [bp+var_3AE]
		mov	al, [bx+5]
		sub	ah, ah
		shl	ax, 1
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_ADE]
		mov	dx, [bp+var_ADC]
		add	ax, 6

loc_E1A_2FD4:				; CODE XREF: SetupTrack+A80j
		push	si
		push	di
		lea	di, [bp+var_ADA]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		cmp	[bp+var_73E], 0
		jz	short loc_E1A_2FFC
		mov	al, [bp+var_74C]
		cbw
		mov	bx, ax
		mov	al, byte ptr unk_2B77_2FB4[bx]
		jmp	short loc_E1A_3007
; ---------------------------------------------------------------------------
		nop

loc_E1A_2FFC:				; CODE XREF: SetupTrack+AB8j
		mov	al, [bp+var_74C]
		cbw
		mov	bx, ax
		mov	al, byte ptr unk_2B77_2FAE[bx]

loc_E1A_3007:				; CODE XREF: SetupTrack+AC5j
		mov	[bp+var_74C], al
		mov	bx, [bp+var_3AE]
		mov	ax, [bx+6]
		mov	[bp+var_8], ax
		cmp	ax, 100h
		jz	short loc_E1A_3074
		cmp	ax, 200h
		jz	short loc_E1A_305E
		cmp	ax, 300h
		jnz	short loc_E1A_303E
		mov	ax, [bp+var_ADA]
		mov	[bp+var_3A2], ax
		mov	ax, [bp+var_AD6]
		neg	ax
		mov	[bp+var_ADA], ax
		mov	ax, [bp+var_3A2]

loc_E1A_303A:				; CODE XREF: SetupTrack+B56j
		mov	[bp+var_AD6], ax

loc_E1A_303E:				; CODE XREF: SetupTrack+AEEj
					; SetupTrack+B3Ej
		cmp	[bp+var_740], 0
		jz	short loc_E1A_308C
		mov	al, byte_2B77_9EC5
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata8
		mov	es, word ptr g_ppTrakdata8+2
		mov	ax, [bp+var_8]
		xor	ah, 2
		jmp	short loc_E1A_309F
; ---------------------------------------------------------------------------
		nop

loc_E1A_305E:				; CODE XREF: SetupTrack+AE9j
		mov	ax, [bp+var_AD6]
		neg	ax
		mov	[bp+var_AD6], ax
		mov	ax, [bp+var_ADA]
		neg	ax
		mov	[bp+var_ADA], ax
		jmp	short loc_E1A_303E
; ---------------------------------------------------------------------------

loc_E1A_3074:				; CODE XREF: SetupTrack+AE4j
		mov	ax, [bp+var_ADA]
		mov	[bp+var_3A2], ax
		mov	ax, [bp+var_AD6]
		mov	[bp+var_ADA], ax
		mov	ax, [bp+var_3A2]
		neg	ax
		jmp	short loc_E1A_303A
; ---------------------------------------------------------------------------

loc_E1A_308C:				; CODE XREF: SetupTrack+B0Fj
		mov	al, byte_2B77_9EC5
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata8
		mov	es, word ptr g_ppTrakdata8+2
		mov	ax, [bp+var_8]

loc_E1A_309F:				; CODE XREF: SetupTrack+B27j
		mov	es:[bx], ax
		mov	al, byte_2B77_9EC5
		cbw
		mov	bx, ax
		add	bx, word ptr g_pTrakdata23
		mov	es, word ptr g_pTrakdata23+2
		mov	al, [bp+var_74C]
		mov	es:[bx], al
		mov	al, [bp+var_39A]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+var_10]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		cmp	byte ptr es:[bx], 6
		jnz	short loc_E1A_30DE
		add	[bp+var_AD8], 1C2h

loc_E1A_30DE:				; CODE XREF: SetupTrack+BA2j
		mov	al, byte_2B77_9EC5
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		mov	ax, [bp+var_AD8]
		mov	es:[bx+2], ax
		mov	al, [bp+var_AE6]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_E1A_3122
		mov	al, [bp+var_39A]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wTrackPos[bx]
		jmp	short loc_E1A_312F
; ---------------------------------------------------------------------------

loc_E1A_3122:				; CODE XREF: SetupTrack+BDDj
		mov	al, [bp+var_39A]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]

loc_E1A_312F:				; CODE XREF: SetupTrack+BECj
		add	ax, [bp+var_AD6]
		mov	cx, ax
		mov	al, byte_2B77_9EC5
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		mov	es:[bx+4], cx
		mov	al, [bp+var_AE6]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jz	short loc_E1A_3174
		mov	al, [bp+var_10]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, (g_wMoreTrackPos+2)[bx]
		jmp	short loc_E1A_3180
; ---------------------------------------------------------------------------

loc_E1A_3174:				; CODE XREF: SetupTrack+C30j
		mov	al, [bp+var_10]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]

loc_E1A_3180:				; CODE XREF: SetupTrack+C3Ej
		add	ax, [bp+var_ADA]
		mov	cx, ax
		mov	al, byte_2B77_9EC5
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata10
		mov	es, word ptr g_ppTrakdata10+2
		mov	es:[bx], cx
		mov	al, [bp+var_39A]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_10]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata19
		mov	es, word ptr g_ppTrakdata19+2
		mov	al, byte_2B77_9EC5
		mov	es:[bx], al
		inc	byte_2B77_9EC5

loc_E1A_31C2:				; CODE XREF: SetupTrack+9B3j
					; SetupTrack+9BDj ...
		mov	[bp+var_3A8], 0

loc_E1A_31C7:				; CODE XREF: SetupTrack+9A8j
		inc	word_2B77_A660
		cmp	word_2B77_A660,	385h
		jnz	short loc_E1A_31DC
		mov	[bp+cReturnCode], 6
		jmp	loc_E1A_25ED
; ---------------------------------------------------------------------------
		nop

loc_E1A_31DC:				; CODE XREF: SetupTrack+C9Dj
		mov	al, [bp+cTrak14Byte]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_sceneShapes.field_0[bx]
		mov	[bp+var_39C], ax
		mov	al, [bp+var_742]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_39C]
		mov	[bp+var_3AE], ax
		cmp	[bp+var_73E], 0
		jz	short loc_E1A_3224
		mov	bx, ax
		mov	al, [bx+1]
		mov	[bp+var_744], al
		mov	al, [bx+3]
		jmp	short loc_E1A_3232
; ---------------------------------------------------------------------------

loc_E1A_3224:				; CODE XREF: SetupTrack+CE0j
		mov	bx, [bp+var_3AE]
		mov	al, [bx+2]
		mov	[bp+var_744], al
		mov	al, [bx+4]

loc_E1A_3232:				; CODE XREF: SetupTrack+CEEj
		mov	[bp+cTrak15Code], al
		mov	al, [bp+cColCounter]
		mov	[bp+var_10], al
		mov	al, [bp+cRowCounter]
		mov	[bp+var_39A], al
		mov	al, [bp+var_73E]
		mov	[bp+var_740], al
		mov	al, [bp+var_742]
		mov	[bp+var_3AA], al
		mov	al, [bp+cTrak14Byte]
		mov	[bp+var_AE6], al
		mov	al, [bp+var_744]
		sub	ah, ah
		sub	ax, 1
		cmp	ax, 0Bh
		jbe	short loc_E1A_326C
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_326C:				; CODE XREF: SetupTrack+D33j
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_E1A_32DC[bx]

loc_E1A_3274:				; DATA XREF: SetupTrack:off_E1A_32DCo
		dec	[bp+cRowCounter]

loc_E1A_3278:				; CODE XREF: SetupTrack+D54j
		mov	[bp+var_8], 0
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_3280:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DB0o
		dec	[bp+cRowCounter]
		inc	[bp+cColCounter]
		jmp	short loc_E1A_3278
; ---------------------------------------------------------------------------

loc_E1A_328A:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DB2o
		inc	[bp+cRowCounter]

loc_E1A_328E:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DAEo
		dec	[bp+cColCounter]
		mov	[bp+var_8], 300h
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_329A:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DBAo
		inc	[bp+cColCounter]

loc_E1A_329E:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DAAo
		inc	[bp+cRowCounter]

loc_E1A_32A2:				; CODE XREF: SetupTrack+D7Fj
		mov	[bp+var_8], 200h
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_32AA:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DBEo
		inc	[bp+cColCounter]

loc_E1A_32AE:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DBCo
		add	[bp+cRowCounter], 2
		jmp	short loc_E1A_32A2
; ---------------------------------------------------------------------------
		nop

loc_E1A_32B6:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DACo
		inc	[bp+cColCounter]

loc_E1A_32BA:				; CODE XREF: SetupTrack+D96j
					; SetupTrack+D9Dj
		mov	[bp+var_8], 100h
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------

loc_E1A_32C2:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DB4o
		inc	[bp+cColCounter]

loc_E1A_32C6:				; CODE XREF: SetupTrack+DA5j
		inc	[bp+cRowCounter]
		jmp	short loc_E1A_32BA
; ---------------------------------------------------------------------------

loc_E1A_32CC:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DB6o
		add	[bp+cColCounter], 2
		jmp	short loc_E1A_32BA
; ---------------------------------------------------------------------------
		nop

loc_E1A_32D4:				; CODE XREF: SetupTrack+D3Bj
					; DATA XREF: SetupTrack+DB8o
		add	[bp+cColCounter], 2
		jmp	short loc_E1A_32C6
; ---------------------------------------------------------------------------
		nop
; ---------------------------------------------------------------------------
off_E1A_32DC	dw offset loc_E1A_3274	; DATA XREF: SetupTrack+D3Br
		dw offset loc_E1A_329E
		dw offset loc_E1A_32B6
		dw offset loc_E1A_328E
		dw offset loc_E1A_3280
		dw offset loc_E1A_328A
		dw offset loc_E1A_32C2
		dw offset loc_E1A_32CC
		dw offset loc_E1A_32D4
		dw offset loc_E1A_329A
		dw offset loc_E1A_32AE
		dw offset loc_E1A_32AA
; ---------------------------------------------------------------------------
		jmp	loc_E1A_2849
; ---------------------------------------------------------------------------
		nop

loc_E1A_32F8:				; CODE XREF: SetupTrack+1070j
					; SetupTrack+1094j
		mov	al, [bp+var_742]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, [bp+var_3AE]
		mov	ax, [bx+8]

loc_E1A_3311:				; CODE XREF: SetupTrack:loc_E1A_35CBj
		mov	[bp+var_ADE], ax
		mov	[bp+var_ADC], ds
		mov	al, [bp+var_742]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, [bp+var_3AE]
		mov	word ptr [bp+pTrakdata], ax
		mov	bx, ax
		mov	al, [bx+5]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, [bp+var_ADE]
		mov	dx, ds
		push	si
		push	di
		lea	di, [bp+var_ADA]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		mov	ax, [bx+6]
		mov	[bp+var_8], ax
		cmp	ax, 100h
		jz	short loc_E1A_33D6
		cmp	ax, 200h
		jz	short loc_E1A_33C0
		cmp	ax, 300h
		jnz	short loc_E1A_338A
		mov	ax, [bp+var_ADA]
		mov	[bp+var_3A2], ax
		mov	ax, [bp+var_AD6]
		neg	ax
		mov	[bp+var_ADA], ax
		mov	ax, [bp+var_3A2]

loc_E1A_3386:				; CODE XREF: SetupTrack+EB8j
		mov	[bp+var_AD6], ax

loc_E1A_338A:				; CODE XREF: SetupTrack+E3Aj
					; SetupTrack+EA0j
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cColCounter]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		cmp	byte ptr es:[bx], 6
		jnz	short loc_E1A_33EE
		mov	bx, di
		shl	bx, 1
		add	bx, word ptr g_pTrakdata7
		mov	es, word ptr g_pTrakdata7+2
		mov	word ptr es:[bx], 1C2h
		jmp	short loc_E1A_33FF
; ---------------------------------------------------------------------------
		nop

loc_E1A_33C0:				; CODE XREF: SetupTrack+E35j
		mov	ax, [bp+var_AD6]
		neg	ax
		mov	[bp+var_AD6], ax
		mov	ax, [bp+var_ADA]
		neg	ax
		mov	[bp+var_ADA], ax
		jmp	short loc_E1A_338A
; ---------------------------------------------------------------------------

loc_E1A_33D6:				; CODE XREF: SetupTrack+E30j
		mov	ax, [bp+var_ADA]
		mov	[bp+var_3A2], ax
		mov	ax, [bp+var_AD6]
		mov	[bp+var_ADA], ax
		mov	ax, [bp+var_3A2]
		neg	ax
		jmp	short loc_E1A_3386
; ---------------------------------------------------------------------------

loc_E1A_33EE:				; CODE XREF: SetupTrack+E76j
		mov	bx, di
		shl	bx, 1
		add	bx, word ptr g_pTrakdata7
		mov	es, word ptr g_pTrakdata7+2
		mov	word ptr es:[bx], 0

loc_E1A_33FF:				; CODE XREF: SetupTrack+E89j
		mov	ax, di
		shl	ax, 1
		mov	word ptr [bp+pTrakdata], ax
		mov	bx, ax
		add	bx, word ptr g_pTrakdata6
		mov	es, word ptr g_pTrakdata6+2
		mov	word ptr es:[bx], 0
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+wCurRow], ax
		mov	bx, word ptr [bp+pTrakdata]
		add	bx, word ptr g_pTrakdata7
		mov	es, word ptr g_pTrakdata7+2
		mov	ax, es:[bx]
		add	ax, [bp+var_AD8]
		mov	bx, [bp+wCurRow]
		add	bx, word ptr g_pTrakdata9
		mov	es, word ptr g_pTrakdata9+2
		mov	es:[bx+2], ax
		mov	bx, [bp+var_C]
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_E1A_3474
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wTrackPos[bx]
		add	ax, [bp+var_AD6]
		mov	bx, [bp+wCurRow]
		jmp	short loc_E1A_348F
; ---------------------------------------------------------------------------

loc_E1A_3474:				; CODE XREF: SetupTrack+F27j
		mov	al, [bp+cRowCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_wTrackCenPos[bx]
		add	ax, [bp+var_AD6]
		mov	bx, di
		mov	cx, bx
		shl	bx, 1
		add	bx, cx
		shl	bx, 1

loc_E1A_348F:				; CODE XREF: SetupTrack+F3Ej
		add	bx, word ptr g_pTrakdata9
		mov	es, word ptr g_pTrakdata9+2
		mov	es:[bx+4], ax
		mov	bx, [bp+var_C]
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jz	short loc_E1A_34C0
		mov	al, [bp+cColCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, (g_wMoreTrackPos+2)[bx]
		jmp	short loc_E1A_34CD
; ---------------------------------------------------------------------------

loc_E1A_34C0:				; CODE XREF: SetupTrack+F7Bj
		mov	al, [bp+cColCounter]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wMoreTrkCenPo[bx]

loc_E1A_34CD:				; CODE XREF: SetupTrack+F8Aj
		add	ax, [bp+var_ADA]
		mov	bx, di
		mov	cx, bx
		shl	bx, 1
		add	bx, cx
		shl	bx, 1
		add	bx, word ptr g_pTrakdata9
		mov	es, word ptr g_pTrakdata9+2
		mov	es:[bx], ax
		inc	di

loc_E1A_34E7:				; CODE XREF: SetupTrack+1016j
		inc	si

loc_E1A_34E8:				; CODE XREF: SetupTrack+892j
		mov	al, byte_2B77_A9FE
		cbw
		mov	word ptr [bp+pTrakdata], ax
		cmp	ax, si
		jg	short loc_E1A_34F7
		jmp	loc_E1A_35CE
; ---------------------------------------------------------------------------

loc_E1A_34F7:				; CODE XREF: SetupTrack+FBEj
		mov	ax, word_2B77_A660
		imul	si
		cwd
		mov	cx, word ptr [bp+pTrakdata]
		idiv	cx
		mov	[bp+var_A], ax
		mov	bx, ax
		add	bx, word ptr g_pTrakdata21
		mov	es, word ptr g_pTrakdata21+2
		mov	al, es:[bx]
		mov	[bp+cColCounter], al
		mov	bx, [bp+var_A]
		add	bx, word ptr g_ppTrakdata22
		mov	es, word ptr g_ppTrakdata22+2
		mov	al, es:[bx]
		mov	[bp+cRowCounter], al
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_wTerrainRows[bx]
		mov	cx, ax
		mov	al, [bp+cColCounter]
		cbw
		add	cx, ax
		add	cx, bp
		sub	cx, 0AD4h
		mov	[bp+wCurRow], cx
		mov	bx, cx
		cmp	byte ptr [bx], 0
		jnz	short loc_E1A_34E7
		mov	byte ptr [bx], 1
		mov	bx, [bp+var_A]
		add	bx, word ptr g_ppTrakdata17
		mov	es, word ptr g_ppTrakdata17+2
		mov	al, es:[bx]
		sub	ah, ah
		mov	[bp+var_C], ax
		mov	bx, [bp+var_A]
		add	bx, word ptr g_ppTrakdata18
		mov	es, word ptr g_ppTrakdata18+2
		mov	al, es:[bx]
		and	al, 0Fh
		mov	[bp+var_742], al
		mov	bx, [bp+var_A]
		add	bx, word ptr g_ppTrakdata18
		mov	al, es:[bx]
		and	al, 10h
		mov	[bp+var_AE4], al
		mov	bx, [bp+var_C]
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, word ptr g_sceneShapes.field_0[bx]
		mov	[bp+var_3AE], ax
		cmp	[bp+var_AE4], 0
		jnz	short loc_E1A_35A7
		jmp	loc_E1A_32F8
; ---------------------------------------------------------------------------

loc_E1A_35A7:				; CODE XREF: SetupTrack+106Ej
		mov	al, [bp+var_742]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, [bp+var_3AE]
		mov	ax, [bx+0Ah]
		mov	[bp+wCurCol], ax
		or	ax, ax
		jnz	short loc_E1A_35CB
		jmp	loc_E1A_32F8
; ---------------------------------------------------------------------------

loc_E1A_35CB:				; CODE XREF: SetupTrack+1092j
		jmp	loc_E1A_3311
; ---------------------------------------------------------------------------

loc_E1A_35CE:				; CODE XREF: SetupTrack+FC0j
		mov	ax, di
		mov	byte_2B77_A9FE,	al
		mov	[bp+cReturnCode], 0
		jmp	short loc_E1A_360E
; ---------------------------------------------------------------------------

loc_E1A_35DA:				; CODE XREF: SetupTrack+C0j
		cmp	[bp+cColCounter], 1Eh
		jnz	short loc_E1A_35E6
		mov	[bp+cColCounter], 1Dh

loc_E1A_35E6:				; CODE XREF: SetupTrack+C8j
					; SetupTrack+10ABj
		cmp	[bp+cRowCounter], 0FFh
		jnz	short loc_E1A_35F4
		mov	[bp+cRowCounter], 0
		jmp	short loc_E1A_3600
; ---------------------------------------------------------------------------

loc_E1A_35F4:				; CODE XREF: SetupTrack+10B7j
		cmp	[bp+cRowCounter], 1Eh
		jnz	short loc_E1A_3600
		mov	[bp+cRowCounter], 1Dh

loc_E1A_3600:				; CODE XREF: SetupTrack+10BEj
					; SetupTrack+10C5j
		mov	al, [bp+cColCounter]
		mov	g_cStartCol, al
		mov	al, [bp+cRowCounter]
		mov	g_cStartRow, al

loc_E1A_360E:				; CODE XREF: SetupTrack+10A4j
		push	word ptr [bp+pTcomp0+2]
		push	word ptr [bp+pTcomp0]
		call	SetResField10To0 ; maybe release the tcomp resource?
		add	sp, 4
		mov	al, [bp+cReturnCode]
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetupTrack	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupOppTrakdata proc far		; CODE XREF: SetupCarGameEtc+CCP
					; RplyMouseSpriteStuff+ABCP

var_F30		= word ptr -0F30h
var_F2E		= word ptr -0F2Eh
var_F2C		= word ptr -0F2Ch
pOppNRes1	= word ptr -0B2Eh
pOppNRes2	= word ptr -0B2Ch
var_B2A		= word ptr -0B2Ah
var_B28		= word ptr -0B28h
var_B26		= word ptr -0B26h
var_B24		= word ptr -0B24h
var_B20		= word ptr -0B20h
var_414		= word ptr -414h
var_412		= word ptr -412h
var_410		= word ptr -410h
var_40E		= word ptr -40Eh
var_20E		= word ptr -20Eh
var_20C		= word ptr -20Ch
var_20A		= word ptr -20Ah
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 0F30h
		push	di
		push	si
		mov	al, g_gameInfo.cOpponentType
		add	al, 30h	; '0'
		mov	byte ptr aOpp1+3, al ; Replace the number in the string	opp0
		mov	ax, offset aOpp1 ; "opp1"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pOppNRes1],	ax
		mov	[bp+pOppNRes2],	dx
		mov	ax, offset aNam	; "nam"
		push	ax
		push	dx
		push	[bp+pOppNRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset unk_2B77_ACF4
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset aPath ; "path"
		push	ax
		push	[bp+pOppNRes2]
		push	[bp+pOppNRes1]
		call	AltLocateShape
		add	sp, 6
		mov	[bp+var_414], ax
		mov	[bp+var_412], dx
		mov	ax, offset aSped ; "sped"
		push	ax
		push	[bp+pOppNRes2]
		push	[bp+pOppNRes1]
		call	AltLocateShape
		add	sp, 6
		mov	word ptr [bp+var_A], ax
		mov	word ptr [bp+var_A+2], dx
		sub	si, si

loc_E1A_36A6:				; CODE XREF: SetupOppTrakdata+8Aj
		les	bx, [bp+var_A]
		mov	al, es:[bx+si]
		mov	byte_2B77_95E0[si], al
		inc	si
		cmp	si, 10h
		jl	short loc_E1A_36A6
		mov	[bp+var_B26], 423Fh
		mov	[bp+var_B24], 0Fh
		mov	[bp+var_B28], 0
		sub	ax, ax
		mov	[bp+var_20C], ax
		mov	[bp+var_20E], ax
		mov	[bp+var_B2A], ax
		sub	si, si

loc_E1A_36D8:				; CODE XREF: SetupOppTrakdata+230j
					; SetupOppTrakdata+28Dj
		mov	[bp+var_410], 0
		mov	bx, si
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata
		mov	es, word ptr g_ppTrakdata+2
		mov	ax, es:[bx]
		mov	[bp+var_4], ax
		or	ax, ax
		jnz	short loc_E1A_3702
		mov	[bp+var_2], 1

loc_E1A_36F9:				; CODE XREF: SetupOppTrakdata+E3j
		mov	[bp+var_410], 1
		jmp	short loc_E1A_373A
; ---------------------------------------------------------------------------
		align 2

loc_E1A_3702:				; CODE XREF: SetupOppTrakdata+C8j
		cmp	[bp+var_4], 0FFFFh
		jnz	short loc_E1A_3710
		mov	[bp+var_2], 0
		jmp	short loc_E1A_36F9
; ---------------------------------------------------------------------------
		align 2

loc_E1A_3710:				; CODE XREF: SetupOppTrakdata+DCj
		cmp	[bp+var_B28], 0
		jz	short loc_E1A_373A
		sub	di, di
		jmp	short loc_E1A_3734
; ---------------------------------------------------------------------------
		align 2

loc_E1A_371C:				; CODE XREF: SetupOppTrakdata+10Ej
		mov	bx, di
		shl	bx, 1
		add	bx, bp
		cmp	[bx+var_B20], si
		jnz	short loc_E1A_3733
		mov	[bp+var_2], 0
		mov	[bp+var_410], 1

loc_E1A_3733:				; CODE XREF: SetupOppTrakdata+FCj
		inc	di

loc_E1A_3734:				; CODE XREF: SetupOppTrakdata+EFj
		cmp	[bp+var_B28], di
		jg	short loc_E1A_371C

loc_E1A_373A:				; CODE XREF: SetupOppTrakdata+D5j
					; SetupOppTrakdata+EBj
		mov	bx, [bp+var_B28]
		inc	[bp+var_B28]
		shl	bx, 1
		add	bx, bp
		mov	[bx+var_B20], si
		les	bx, g_ppTrakdata17
		mov	bl, es:[bx+si]
		sub	bh, bh
		add	bx, word ptr [bp+var_A]
		mov	es, word ptr [bp+var_A+2]
		mov	al, es:[bx]
		sub	ah, ah
		inc	ax
		sub	dx, dx
		add	[bp+var_20E], ax
		adc	[bp+var_20C], dx
		cmp	[bp+var_410], dx
		jnz	short loc_E1A_3772
		jmp	loc_E1A_385E
; ---------------------------------------------------------------------------

loc_E1A_3772:				; CODE XREF: SetupOppTrakdata+143j
		cmp	[bp+var_2], dx
		jnz	short loc_E1A_377A
		jmp	loc_E1A_3805
; ---------------------------------------------------------------------------

loc_E1A_377A:				; CODE XREF: SetupOppTrakdata+14Bj
		mov	ax, [bp+var_B26]
		mov	dx, [bp+var_B24]
		cmp	[bp+var_20C], dx
		ja	short loc_E1A_3805
		jb	short loc_E1A_3790
		cmp	[bp+var_20E], ax
		jnb	short loc_E1A_3805

loc_E1A_3790:				; CODE XREF: SetupOppTrakdata+15Ej
		mov	bx, [bp+var_B28]
		inc	[bp+var_B28]
		shl	bx, 1
		add	bx, bp
		mov	[bx+var_B20], 0
		mov	ax, [bp+var_20E]
		mov	dx, [bp+var_20C]
		mov	[bp+var_B26], ax
		mov	[bp+var_B24], dx
		sub	di, di
		jmp	short loc_E1A_37D8
; ---------------------------------------------------------------------------
		align 4

loc_E1A_37B8:				; CODE XREF: SetupOppTrakdata+1B2j
		mov	ax, di
		shl	ax, 1
		mov	[bp+var_F30], ax
		mov	bx, ax
		add	bx, bp
		mov	ax, [bx+var_B20]
		mov	bx, [bp+var_F30]
		add	bx, word ptr g_ppTrakdata3
		mov	es, word ptr g_ppTrakdata3+2
		mov	es:[bx], ax
		inc	di

loc_E1A_37D8:				; CODE XREF: SetupOppTrakdata+18Aj
		cmp	[bp+var_B28], di
		jg	short loc_E1A_37B8
		mov	bx, [bp+var_B28]
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata3
		mov	es, word ptr g_ppTrakdata3+2
		mov	word ptr es:[bx], 0
		mov	bx, [bp+var_B28]
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata3
		mov	es, word ptr g_ppTrakdata3+2
		mov	word ptr es:[bx+2], 1

loc_E1A_3805:				; CODE XREF: SetupOppTrakdata+14Dj
					; SetupOppTrakdata+15Cj ...
		cmp	[bp+var_B2A], 0
		jnz	short loc_E1A_3822
		push	[bp+pOppNRes2]
		push	[bp+pOppNRes1]
		call	DoUnloadResourc
		add	sp, 4
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_E1A_3822:				; CODE XREF: SetupOppTrakdata+1E0j
		dec	[bp+var_B2A]
		mov	ax, [bp+var_B2A]
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_F30], ax
		mov	bx, ax
		mov	si, [bx+var_20A]
		mov	ax, [bx+var_40E]
		mov	[bp+var_B28], ax
		mov	bx, [bp+var_B2A]
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx+var_F2E]
		mov	dx, [bx+var_F2C]
		mov	[bp+var_20E], ax
		mov	[bp+var_20C], dx
		jmp	loc_E1A_36D8
; ---------------------------------------------------------------------------
		align 2

loc_E1A_385E:				; CODE XREF: SetupOppTrakdata+145j
		mov	bx, si
		shl	bx, 1
		add	bx, word ptr g_ppTrakdata2
		mov	es, word ptr g_ppTrakdata2+2
		mov	ax, es:[bx]
		mov	[bp+var_6], ax
		cmp	ax, 0FFFFh
		jz	short loc_E1A_38B4
		mov	ax, [bp+var_B2A]
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_F30], ax
		mov	bx, ax
		mov	ax, [bp+var_6]
		mov	[bx+var_20A], ax
		mov	bx, [bp+var_F30]
		mov	ax, [bp+var_B28]
		mov	[bx+var_40E], ax
		mov	bx, [bp+var_B2A]
		inc	[bp+var_B2A]
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	ax, [bp+var_20E]
		mov	dx, [bp+var_20C]
		mov	[bx+var_F2E], ax
		mov	[bx+var_F2C], dx

loc_E1A_38B4:				; CODE XREF: SetupOppTrakdata+249j
		mov	si, [bp+var_4]
		jmp	loc_E1A_36D8
SetupOppTrakdata endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MapTerrainTrack	proc far		; CODE XREF: UpdateFrame+693P
					; DoTransformShpTrk+515P ...

cTerrainTile	= byte ptr  6
cTrackTile	= byte ptr  8

		push	bp
		mov	bp, sp
		mov	al, [bp+cTerrainTile]
		sub	ah, ah
		cmp	ax, 7
		jz	short loc_E1A_38E0
		cmp	ax, 8
		jz	short loc_E1A_391E
		cmp	ax, 9
		jnz	short loc_E1A_38D4
		jmp	loc_E1A_395E
; ---------------------------------------------------------------------------

loc_E1A_38D4:				; CODE XREF: MapTerrainTrack+15j
		cmp	ax, 0Ah
		jnz	short loc_E1A_38DC
		jmp	loc_E1A_399C
; ---------------------------------------------------------------------------

loc_E1A_38DC:				; CODE XREF: MapTerrainTrack+1Dj
					; MapTerrainTrack+49j ...
		sub	ax, ax
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_E1A_38E0:				; CODE XREF: MapTerrainTrack+Bj
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 4
		jz	short loc_E1A_3906
		cmp	ax, 0Eh
		jz	short loc_E1A_390C
		cmp	ax, 18h
		jz	short loc_E1A_3912
		cmp	ax, 27h	; '''
		jz	short loc_E1A_3918
		cmp	ax, 3Bh	; ';'
		jz	short loc_E1A_3918
		cmp	ax, 62h	; 'b'
		jz	short loc_E1A_3918
		jmp	short loc_E1A_38DC
; ---------------------------------------------------------------------------
		align 2

loc_E1A_3906:				; CODE XREF: MapTerrainTrack+2Ej
		mov	ax, 0B6h ; '¶'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------

loc_E1A_390C:				; CODE XREF: MapTerrainTrack+33j
		mov	ax, 0BAh ; 'º'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------

loc_E1A_3912:				; CODE XREF: MapTerrainTrack+38j
		mov	ax, 0BEh ; '¾'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------

loc_E1A_3918:				; CODE XREF: MapTerrainTrack+3Dj
					; MapTerrainTrack+42j ...
		mov	ax, 0C2h ; 'Â'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------

loc_E1A_391E:				; CODE XREF: MapTerrainTrack+10j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 5
		jz	short loc_E1A_3944
		cmp	ax, 0Fh
		jz	short loc_E1A_394A
		cmp	ax, 19h
		jz	short loc_E1A_3950
		cmp	ax, 24h	; '$'
		jz	short loc_E1A_3958
		cmp	ax, 38h	; '8'
		jz	short loc_E1A_3958
		cmp	ax, 5Fh	; '_'
		jz	short loc_E1A_3958
		jmp	short loc_E1A_38DC
; ---------------------------------------------------------------------------
		align 2

loc_E1A_3944:				; CODE XREF: MapTerrainTrack+6Cj
		mov	ax, 0B7h ; '·'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------

loc_E1A_394A:				; CODE XREF: MapTerrainTrack+71j
		mov	ax, 0BBh ; '»'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------

loc_E1A_3950:				; CODE XREF: MapTerrainTrack+76j
		mov	ax, 0BFh ; '¿'
		jmp	loc_E1A_39D7
; ---------------------------------------------------------------------------
		align 4

loc_E1A_3958:				; CODE XREF: MapTerrainTrack+7Bj
					; MapTerrainTrack+80j ...
		mov	ax, 0C3h ; 'Ã'
		jmp	short loc_E1A_39D7
; ---------------------------------------------------------------------------
		align 2

loc_E1A_395E:				; CODE XREF: MapTerrainTrack+17j
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 4
		jz	short loc_E1A_3984
		cmp	ax, 0Eh
		jz	short loc_E1A_398A
		cmp	ax, 18h
		jz	short loc_E1A_3990
		cmp	ax, 26h	; '&'
		jz	short loc_E1A_3996
		cmp	ax, 3Ah	; ':'
		jz	short loc_E1A_3996
		cmp	ax, 61h	; 'a'
		jz	short loc_E1A_3996
		jmp	loc_E1A_38DC
; ---------------------------------------------------------------------------

loc_E1A_3984:				; CODE XREF: MapTerrainTrack+ACj
		mov	ax, 0B8h ; '¸'
		jmp	short loc_E1A_39D7
; ---------------------------------------------------------------------------
		align 2

loc_E1A_398A:				; CODE XREF: MapTerrainTrack+B1j
		mov	ax, 0BCh ; '¼'
		jmp	short loc_E1A_39D7
; ---------------------------------------------------------------------------
		align 2

loc_E1A_3990:				; CODE XREF: MapTerrainTrack+B6j
		mov	ax, 0C0h ; 'À'
		jmp	short loc_E1A_39D7
; ---------------------------------------------------------------------------
		align 2

loc_E1A_3996:				; CODE XREF: MapTerrainTrack+BBj
					; MapTerrainTrack+C0j ...
		mov	ax, 0C4h ; 'Ä'
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_E1A_399C:				; CODE XREF: MapTerrainTrack+1Fj
		mov	al, [bp+cTrackTile]
		sub	ah, ah
		cmp	ax, 5
		jz	short loc_E1A_39C2
		cmp	ax, 0Fh
		jz	short loc_E1A_39C8
		cmp	ax, 19h
		jz	short loc_E1A_39CE
		cmp	ax, 25h	; '%'
		jz	short loc_E1A_39D4
		cmp	ax, 39h	; '9'
		jz	short loc_E1A_39D4
		cmp	ax, 60h	; '`'
		jz	short loc_E1A_39D4
		jmp	loc_E1A_38DC
; ---------------------------------------------------------------------------

loc_E1A_39C2:				; CODE XREF: MapTerrainTrack+EAj
		mov	ax, 0B9h ; '¹'
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_E1A_39C8:				; CODE XREF: MapTerrainTrack+EFj
		mov	ax, 0BDh ; '½'
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_E1A_39CE:				; CODE XREF: MapTerrainTrack+F4j
		mov	ax, 0C1h ; 'Á'
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_E1A_39D4:				; CODE XREF: MapTerrainTrack+F9j
					; MapTerrainTrack+FEj ...
		mov	ax, 0C5h ; 'Å'

loc_E1A_39D7:				; CODE XREF: MapTerrainTrack+4Fj
					; MapTerrainTrack+55j ...
		pop	bp
		retf
MapTerrainTrack	endp

seg004		ends

; ===========================================================================

; Segment type:	Pure code
seg005		segment	byte public 'CODE' use16
		assume cs:seg005
		;org 9
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RunGame		proc far		; CODE XREF: _main+4B1P

var_16		= byte ptr -16h
var_14		= word ptr -14h
wKbChar		= word ptr -12h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	si
		mov	[bp+var_C], 0FFFFh
		mov	word_2B77_81C4,	0
		mov	word_2B77_81C6,	140h
		mov	[bp+var_2], 0FFFFh
		mov	word_2B77_927A,	0FFFFh
		call	GetRandomKevin
		mov	cl, 3
		shl	ax, cl
		mov	g_wKevinRandom,	ax
		mov	g_cGameFlag1, 1
		mov	g_cGameFlag2, 0
		cmp	g_cTimerOverrun, 0 ; cTimerOverrun is set when no action happens on a menu
		jz	short _lblNoAutoReplay ; jump if we came here from a user action
		inc	g_cCameraMode	; g_cGameMode is initialized to	0
		cmp	g_cCameraMode, 4
		jnz	short loc_11B7_5A
		mov	g_cCameraMode, 0

loc_11B7_5A:				; CODE XREF: RunGame+49j
		mov	g_cGameMode2, 2
		mov	ax, offset aDefault_1 ;	"default"
		push	ax
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr LoadReplayFile
		add	sp, 4
		or	al, al
		jz	short loc_11B7_74
		jmp	_EndGame2
; ---------------------------------------------------------------------------

loc_11B7_74:				; CODE XREF: RunGame+65j
		call	SetupTrack
		jmp	short loc_11B7_9F
; ---------------------------------------------------------------------------
		align 2

_lblNoAutoReplay:			; CODE XREF: RunGame+3Ej
		cmp	g_gameInfo.wRecordedFrames, 0
		jnz	short loc_11B7_90
		mov	g_cCameraMode, 0
		mov	g_cGameMode2, 1
		jmp	short loc_11B7_9F
; ---------------------------------------------------------------------------
		align 2

loc_11B7_90:				; CODE XREF: RunGame+77j
		mov	g_cCameraMode, 0
		mov	g_cGameMode2, 2
		mov	g_cGameFlag2, 1

loc_11B7_9F:				; CODE XREF: RunGame+6Fj RunGame+83j
		push	cs
		call	near ptr SetupCarGameEtc

loc_11B7_A3:
		or	ax, ax
		jz	short _lblSetupCarGameDone
		push	cs
		call	near ptr UnloadGameResou
		call	DoMerTextRes
		jmp	_EndGame1
; ---------------------------------------------------------------------------
		align 2

_lblSetupCarGameDone:			; CODE XREF: RunGame+9Bj
		mov	g_cKbOrMouse, 0
		mov	byte_2B77_9276,	0
		mov	byte ptr word_2B77_926A, 1
		push	cs
		call	near ptr DoAddTimerFunc
		mov	byte_2B77_AA58,	0FFh
		mov	byte_2B77_8BD6,	0
		mov	byte_2B77_8BBA,	0
		mov	g_cRplBufIsFull, 0
		mov	byte_2B77_81E0,	0
		cmp	g_cTimerOverrun, 0
		jz	short _lblNoTimerOverrun
		mov	al, byte ptr g_gameInfo.wFramesPerSec
		cbw
		mov	g_wFramesPerSec, ax

_StartGameLoop:				; CODE XREF: RunGame+71Aj
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState
		add	sp, 2
		jmp	_StartGameLoop2
; ---------------------------------------------------------------------------
		align 2

_lblNoTimerOverrun:			; CODE XREF: RunGame+DBj
		cmp	g_cGameFlag2, 0
		jz	short loc_11B7_108
		jmp	loc_11B7_1BC
; ---------------------------------------------------------------------------

loc_11B7_108:				; CODE XREF: RunGame+F9j
		mov	g_cCameraMode, 0

loc_11B7_10D:
		mov	byte_2B77_81E0,	1
		mov	g_wFpsMul4, 0
		mov	ax, g_wFramesPerSec2
		mov	g_wFramesPerSec, ax
		mov	al, byte ptr g_wFramesPerSec2
		mov	byte ptr g_gameInfo.wFramesPerSec, al
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState
		add	sp, 2
		mov	word_2B77_A624,	0
		mov	byte_2B77_A5CE,	0
		mov	byte_2B77_81CC,	1
		mov	al, byte_2B77_182
		cbw
		push	ax
		push	cs
		call	near ptr MouseMinMaxPos
		add	sp, 2
		mov	g_cGameMode2, 1
		mov	ax, 0FF10h
		push	ax
		push	g_wUseTrkInRpl
		call	LookupSine
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		cwd
		mov	cl, 6

loc_11B7_16C:				; CODE XREF: RunGame+168j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_11B7_16C ; loop 6 times


		add	word ptr gameState.carPlayer.vecLongUnk.dwX, ax
		adc	word ptr gameState.carPlayer.vecLongUnk.dwX+2, dx
		mov	ax, 0FF10h
		push	ax
		push	g_wUseTrkInRpl
		call	LookupCos
		add	sp, 2
		push	ax
		call	ScaleValue
		add	sp, 4
		cwd
		mov	cl, 6

loc_11B7_198:				; CODE XREF: RunGame+194j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_11B7_198 ; loop 6 times


		add	word ptr gameState.carPlayer.vecLongUnk.dwZ, ax
		adc	word ptr gameState.carPlayer.vecLongUnk.dwZ+2, dx
		add	word ptr gameState.carPlayer.vecLongUnk.dwY, 580h
		adc	word ptr gameState.carPlayer.vecLongUnk.dwY+2, 0
		mov	g_wMainFlag, 1
		jmp	short _StartGameLoop2
; ---------------------------------------------------------------------------
		align 4

loc_11B7_1BC:				; CODE XREF: RunGame+FBj
		mov	g_cCameraMode, 0

loc_11B7_1C1:
		mov	g_cGameMode2, 2
		mov	word_2B77_965A,	1F4h
		mov	al, byte ptr g_gameInfo.wFramesPerSec
		cbw
		mov	g_wFramesPerSec, ax
		sub	ax, ax
		push	ax
		call	RestoreGameState
		add	sp, 2
		push	g_gameInfo.wRecordedFrames
		call	RestoreGameState
		add	sp, 2
		jmp	short loc_11B7_202
; ---------------------------------------------------------------------------

loc_11B7_1EC:				; CODE XREF: RunGame+1FFj
		mov	ax, 1		; time delta parameter = 1
		push	ax
		call	DoInputsCheckin
		add	sp, 2
		cmp	ax, 1Bh		; check	esc
		jz	short loc_11B7_20B
		call	UpdateGameState

loc_11B7_202:				; CODE XREF: RunGame+1E0j
		mov	ax, gameState.wGameFrame
		cmp	g_gameInfo.wRecordedFrames, ax
		jnz	short loc_11B7_1EC

loc_11B7_20B:				; CODE XREF: RunGame+1F1j
		mov	ax, g_gameInfo.wRecordedFrames
		mov	g_wMainFlgCp, ax ; MAYBE GOTO END OF REPLAY?
		jmp	short _StartGameLoop2
; ---------------------------------------------------------------------------
		align 2

loc_11B7_214:				; CODE XREF: RunGame+22Fj
		cmp	byte_2B77_182, 0
		jnz	short loc_11B7_222
		cmp	g_bSkipJoystick, 0
		jz	short loc_11B7_22D

loc_11B7_222:				; CODE XREF: RunGame+20Fj
		cmp	g_cGameMode2, 0
		jnz	short loc_11B7_22D
		push	cs
		call	near ptr UpdateTrakdata16Or

loc_11B7_22D:				; CODE XREF: RunGame+216j RunGame+21Dj
		call	UpdateGameState

_StartGameLoop2:			; CODE XREF: RunGame+F0j RunGame+1AEj	...
		mov	ax, g_wMainFlgCp
		cmp	gameState.wGameFrame, ax
		jnz	short loc_11B7_214
		cmp	g_cGameMode2, 0
		jnz	short loc_11B7_25B
		cmp	byte ptr word_2B77_926A, 0
		jnz	short loc_11B7_25B
		cmp	gameState.cCvxFlag2, 0
		jz	short loc_11B7_25B
		mov	ax, gameState.wGameFrame
		cmp	[bp+var_C], ax
		jz	short _StartGameLoop2
		mov	[bp+var_C], ax

loc_11B7_25B:				; CODE XREF: RunGame+236j RunGame+23Dj ...
		cmp	gameState.cCvxFlag2, 0
		jnz	short loc_11B7_27B
		cmp	g_cGameMode2, 0
		jnz	short loc_11B7_27B
		mov	g_wMainFlgCp, 0
		mov	g_gameInfo.wRecordedFrames, 0
		mov	gameState.wGameFrame, 0

loc_11B7_27B:				; CODE XREF: RunGame+256j RunGame+25Dj
		mov	ax, g_wTimerFlag1
		cmp	g_wTimerFlag5, ax
		jz	short loc_11B7_28C
		mov	g_wTimerFlag5, ax
		call	sub_9F1_186

loc_11B7_28C:				; CODE XREF: RunGame+278j
		cmp	g_cRplBufIsFull, 0
		jz	short loc_11B7_306
		call	PushInputStatus
		call	DrvFuncMany
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aRbf	; erbf in game.res = Replay buffer is full. Do you]want	to watch some of the replay]and	then continue
					;  racing or]continue now.]}[Continue Now[See Replay]
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	si, ax
		cmp	si, 0FFFFh
		jnz	short loc_11B7_2D9
		sub	si, si

loc_11B7_2D9:				; CODE XREF: RunGame+2CBj
		call	sub_270D_224
		mov	g_wIsInputMetho, 0
		call	PopInputStatus
		or	si, si
		jz	short loc_11B7_301
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		call	CvxSfxOp
		add	sp, 4
		mov	byte ptr word_2B77_926A, 1

loc_11B7_301:				; CODE XREF: RunGame+2E1j
		mov	g_cRplBufIsFull, 0

loc_11B7_306:				; CODE XREF: RunGame+287j
		cmp	g_wVideoFlag4, 0
		jz	short loc_11B7_31A
		call	SetupMcgaWnd2
		mov	al, byte_2B77_8BD6
		mov	byte_2B77_8BBA,	al
		jmp	short loc_11B7_31F
; ---------------------------------------------------------------------------

loc_11B7_31A:				; CODE XREF: RunGame+301j
		call	SelectWndSprite

loc_11B7_31F:				; CODE XREF: RunGame+30Ej
		mov	al, byte_2B77_AA58
		cmp	g_cGameMode2, al
		jnz	short loc_11B7_34F
		mov	al, byte_2B77_ACDA
		cmp	byte_2B77_81E0,	al
		jnz	short loc_11B7_34F
		mov	al, byte_2B77_9E62
		cmp	g_cGameFlag1, al
		jnz	short loc_11B7_34F
		mov	al, byte_2B77_9EC4
		cmp	g_cGameFlag2, al
		jnz	short loc_11B7_34F
		mov	al, byte_2B77_72C8
		cmp	byte_2B77_AC70,	al
		jnz	short loc_11B7_34F
		jmp	loc_11B7_40A
; ---------------------------------------------------------------------------

loc_11B7_34F:				; CODE XREF: RunGame+31Cj RunGame+325j ...
		mov	al, g_cGameMode2
		mov	byte_2B77_AA58,	al
		mov	al, byte_2B77_81E0
		mov	byte_2B77_ACDA,	al
		mov	al, g_cGameFlag1
		mov	byte_2B77_9E62,	al
		mov	al, g_cGameFlag2
		mov	byte_2B77_9EC4,	al
		mov	al, byte_2B77_AC70
		mov	byte_2B77_72C8,	al
		mov	word_2B77_A648,	0
		mov	byte_2B77_9272,	0
		cmp	g_cGameMode2, 2
		jnz	short loc_11B7_39A

loc_11B7_37F:
		cmp	g_cTimerOverrun, 0
		jnz	short loc_11B7_39A
		cmp	g_cGameFlag1, 0
		jz	short loc_11B7_390
		jmp	loc_11B7_47E
; ---------------------------------------------------------------------------

loc_11B7_390:				; CODE XREF: RunGame+381j
		cmp	g_cGameFlag2, 0
		jz	short loc_11B7_39A
		jmp	loc_11B7_47E
; ---------------------------------------------------------------------------

loc_11B7_39A:				; CODE XREF: RunGame+373j RunGame+37Aj ...
		mov	g_cGameMode3, 0

loc_11B7_39F:				; CODE XREF: RunGame+479j
		cmp	g_cTimerOverrun, 0
		jnz	short loc_11B7_3A9
		jmp	loc_11B7_486
; ---------------------------------------------------------------------------

loc_11B7_3A9:				; CODE XREF: RunGame+39Aj RunGame+4C1j ...
		mov	word_2B77_9D3E,	0C8h ; 'È'

loc_11B7_3AF:				; CODE XREF: RunGame+4B7j RunGame+4D4j
		mov	ax, word_2B77_A648
		cmp	[bp+var_2], ax
		jnz	short loc_11B7_3C8
		mov	ax, word_2B77_927A
		cmp	word_2B77_9D3E,	ax
		jnz	short loc_11B7_3C8
		mov	ax, word_2B77_A264
		cmp	[bp+var_E], ax
		jz	short loc_11B7_40A

loc_11B7_3C8:				; CODE XREF: RunGame+3ABj RunGame+3B4j
		mov	al, g_wVideoFlag5
		mov	byte_2B77_9D34,	al
		push	word_2B77_9D3E
		mov	ax, 140h
		push	ax
		mov	ax, word_2B77_9D3E
		cwd
		mov	cx, 6
		idiv	cx
		push	ax
		mov	ax, 23h	; '#'
		push	ax
		call	sub_1EA2_38D3	; vecanglestuff
		add	sp, 8
		mov	ax, word_2B77_A648
		mov	word_2B77_81C8,	ax
		mov	ax, word_2B77_9D3E
		mov	word_2B77_81CA,	ax
		mov	ax, word_2B77_A648
		mov	[bp+var_2], ax
		mov	ax, word_2B77_9D3E
		mov	word_2B77_927A,	ax
		mov	ax, word_2B77_A264
		mov	[bp+var_E], ax

loc_11B7_40A:				; CODE XREF: RunGame+342j RunGame+3BCj
		cmp	byte_2B77_9D34,	0
		jnz	short loc_11B7_414
		jmp	loc_11B7_4E2
; ---------------------------------------------------------------------------

loc_11B7_414:				; CODE XREF: RunGame+405j
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	byte ptr word_2B77_9268[bx], 0
		cmp	byte_2B77_9272,	0
		jz	short loc_11B7_448
		push	word_2B77_A264
		push	word_2B77_9D3E
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr SetupCarShapes
		add	sp, 2

loc_11B7_448:				; CODE XREF: RunGame+41Aj
		cmp	g_cGameMode3, 0
		jnz	short loc_11B7_452
		jmp	loc_11B7_4F4
; ---------------------------------------------------------------------------

loc_11B7_452:				; CODE XREF: RunGame+443j
		mov	ax, 0C8h
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	short loc_11B7_4F4
; ---------------------------------------------------------------------------
		align 2

loc_11B7_47E:				; CODE XREF: RunGame+383j RunGame+38Dj
		mov	g_cGameMode3, 1
		jmp	loc_11B7_39F
; ---------------------------------------------------------------------------

loc_11B7_486:				; CODE XREF: RunGame+39Cj
		cmp	byte_2B77_81E0,	0
		jz	short loc_11B7_4C4
		cmp	byte_2B77_AC70,	0
		jnz	short loc_11B7_4C4
		cmp	g_cGameMode2, 2
		jnz	short loc_11B7_4AA
		cmp	g_cGameMode3, 0
		jz	short loc_11B7_4AA
		mov	word_2B77_A264,	97h ; '—'
		jmp	short loc_11B7_4B0
; ---------------------------------------------------------------------------

loc_11B7_4AA:				; CODE XREF: RunGame+48Fj RunGame+496j
		mov	word_2B77_A264,	0C8h ; 'È'

loc_11B7_4B0:				; CODE XREF: RunGame+49Ej
		mov	byte_2B77_9272,	1
		mov	ax, g_wRoofBmpHeight
		mov	word_2B77_A648,	ax
		mov	ax, word_2B77_A64A
		mov	word_2B77_9D3E,	ax
		jmp	loc_11B7_3AF
; ---------------------------------------------------------------------------

loc_11B7_4C4:				; CODE XREF: RunGame+481j RunGame+488j
		cmp	g_cGameMode2, 2
		jz	short loc_11B7_4CE
		jmp	loc_11B7_3A9
; ---------------------------------------------------------------------------

loc_11B7_4CE:				; CODE XREF: RunGame+4BFj
		cmp	g_cGameMode3, 0
		jnz	short loc_11B7_4D8
		jmp	loc_11B7_3A9
; ---------------------------------------------------------------------------

loc_11B7_4D8:				; CODE XREF: RunGame+4C9j
		mov	word_2B77_9D3E,	97h ; '—'
		jmp	loc_11B7_3AF
; ---------------------------------------------------------------------------
		align 2

loc_11B7_4E2:				; CODE XREF: RunGame+407j
		cmp	g_cGameMode3, 0
		jnz	short loc_11B7_4F4
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	byte ptr word_2B77_9268[bx], 0

loc_11B7_4F4:				; CODE XREF: RunGame+445j RunGame+471j ...
		mov	ax, offset word_2B77_81C4
		push	ax
		mov	al, byte_2B77_8BD6
		cbw
		push	ax
		call	UpdateFrame	; is this where	do all calculations? like an UpdateFrame or something?
					; does a lot of	matrix stuff,
					; last thing it	does is	draw in	game text


		add	sp, 4
		cmp	g_wDashBitmapY,	0
		jz	short loc_11B7_56B
		cmp	byte_2B77_9272,	0
		jz	short loc_11B7_56B
		cmp	g_wTimerFlag5, 0
		jz	short loc_11B7_54B
		mov	[bp+var_A], 0
		mov	[bp+var_8], 140h
		mov	ax, g_wDashBitmapY
		mov	[bp+var_6], ax
		mov	ax, word_2B77_9D3E
		mov	[bp+var_4], ax
		cmp	g_prcMegaPoly1,	0
		jz	short loc_11B7_54B
		push	g_prcMegaPoly1
		lea	ax, [bp+var_A]
		push	ax
		push	g_prcMegaPoly1
		call	MinMaxRect
		add	sp, 6

loc_11B7_54B:				; CODE XREF: RunGame+50Ej RunGame+52Bj
		push	g_pDasmBmpSeg
		push	g_pDasmBmpOfs
		call	MaybePutImageAnd2
		add	sp, 4
		push	word ptr g_wDashBmp2Ofs+2
		push	word ptr g_wDashBmp2Ofs
		call	MaybePutImageOr2
		add	sp, 4

loc_11B7_56B:				; CODE XREF: RunGame+500j RunGame+507j
		mov	ax, offset word_2B77_81C4
		push	ax
		call	sub_9F1_4
		add	sp, 2
		cmp	byte_2B77_9272,	0
		jz	short loc_11B7_5B6
		push	word_2B77_A264
		push	word_2B77_9D3E
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr SetupCarShapes
		add	sp, 2
		mov	ax, 0C8h
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8

loc_11B7_5B6:				; CODE XREF: RunGame+572j
		cmp	byte_2B77_9D34,	0
		jz	short loc_11B7_5C1
		dec	byte_2B77_9D34

loc_11B7_5C1:				; CODE XREF: RunGame+5B1j
		cmp	g_wVideoFlag4, 0
		jz	short loc_11B7_5E2
		call	DoRenderMouSpr3
		call	SetupMcgaWnd1
		xor	byte_2B77_8BD6,	1
		mov	al, byte_2B77_8BD6
		mov	byte_2B77_8BBA,	al
		call	DoUseMousePos

loc_11B7_5E2:				; CODE XREF: RunGame+5BCj
		cmp	g_cGameMode2, 1
		jnz	short loc_11B7_60D
		cmp	byte_2B77_81CC,	0
		jnz	short loc_11B7_60D
		mov	g_cGameMode2, 0
		mov	ax, g_wFramesPerSec2
		mov	g_wFramesPerSec, ax
		mov	al, byte ptr g_wFramesPerSec2
		mov	byte ptr g_gameInfo.wFramesPerSec, al
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState
		add	sp, 2

loc_11B7_60D:				; CODE XREF: RunGame+5DDj RunGame+5E4j
		cmp	g_cTimerOverrun, 0
		jz	short loc_11B7_63A
		call	GetKbChar
		or	ax, ax
		jz	short loc_11B7_620
		jmp	loc_11B7_728
; ---------------------------------------------------------------------------

loc_11B7_620:				; CODE XREF: RunGame+611j
		cmp	byte ptr word_2B77_926A, 0
		jz	short loc_11B7_62A
		jmp	loc_11B7_728
; ---------------------------------------------------------------------------

loc_11B7_62A:				; CODE XREF: RunGame+61Bj
		call	GetKbOrJoyFlags
		or	ax, ax
		jnz	short loc_11B7_636
		jmp	_StartGameLoop2
; ---------------------------------------------------------------------------

loc_11B7_636:				; CODE XREF: RunGame+627j
		jmp	loc_11B7_728
; ---------------------------------------------------------------------------
		align 2

loc_11B7_63A:				; CODE XREF: RunGame+608j
		cmp	byte ptr word_2B77_926A, 0
		jz	short loc_11B7_698
		cmp	g_cGameMode2, 0
		jnz	short loc_11B7_652
		cmp	gameState.cCvxFlag3, 4
		jz	short loc_11B7_652
		jmp	loc_11B7_728
; ---------------------------------------------------------------------------

loc_11B7_652:				; CODE XREF: RunGame+63Cj RunGame+643j
		cmp	byte ptr word_2B77_926A, 2
		jnz	short loc_11B7_65C
		jmp	loc_11B7_728
; ---------------------------------------------------------------------------

loc_11B7_65C:				; CODE XREF: RunGame+64Dj
		mov	byte ptr word_2B77_926A, 0
		mov	g_cGameMode2, 2
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr MouseMinMaxPos
		add	sp, 2
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		mov	g_cGameFlag2, 1
		call	DoAudioCvx

loc_11B7_698:				; CODE XREF: RunGame+635j
		cmp	g_cGameMode2, 2
		jnz	short loc_11B7_6B2
		sub	ax, ax
		push	ax
		push	ax
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	_StartGameLoop2
; ---------------------------------------------------------------------------
		align 2

loc_11B7_6B2:				; CODE XREF: RunGame+693j RunGame+6C2j ...
		call	GetKbChar
		mov	[bp+wKbChar], ax
		or	ax, ax
		jz	short loc_11B7_6C6
		push	ax
		push	cs
		call	near ptr sub_11B7_88A ;	sets g_cGameMode
		add	sp, 2

loc_11B7_6C6:				; CODE XREF: RunGame+6B2j
		mov	ax, [bp+wKbChar]
		cmp	ax, 4800h	; arent	these scan codes for arrow keys?
		jz	short loc_11B7_6B2
		cmp	ax, 4B00h
		jz	short loc_11B7_6B2
		cmp	ax, 4D00h
		jz	short loc_11B7_6B2
		cmp	ax, 5000h
		jz	short loc_11B7_6B2
		cmp	g_cGameMode2, 1
		jz	short loc_11B7_6E7
		jmp	_StartGameLoop2
; ---------------------------------------------------------------------------

loc_11B7_6E7:				; CODE XREF: RunGame+6D8j
		mov	ax, offset g_wMouYPos
		push	ax
		mov	ax, offset g_wMouXPos
		push	ax
		mov	ax, offset g_wMouButStatus
		push	ax
		call	GetMouseState
		add	sp, 6
		test	byte ptr g_wMouButStatus, 3
		jnz	short loc_11B7_70E
		call	GetKbOrJoyFlags
		test	al, 30h		; 0x30 = test for shiftup+shiftdn
		jnz	short loc_11B7_70E
		jmp	_StartGameLoop2
; ---------------------------------------------------------------------------

loc_11B7_70E:				; CODE XREF: RunGame+6F6j RunGame+6FFj
		mov	g_cGameMode2, 0
		mov	byte_2B77_81CC,	0
		mov	ax, g_wFramesPerSec2
		mov	g_wFramesPerSec, ax
		mov	al, byte ptr g_wFramesPerSec2
		mov	byte ptr g_gameInfo.wFramesPerSec, al
		jmp	_StartGameLoop
; ---------------------------------------------------------------------------
		align 2

loc_11B7_728:				; CODE XREF: RunGame+613j RunGame+61Dj ...
		cmp	g_wVideoFlag4, 0
		jz	short loc_11B7_763
		call	Get0
		or	ax, ax
		jz	short loc_11B7_763
		call	DoRenderMouSpr3
		call	SetupMcgaWnd2
		sub	ax, ax
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		call	Sprite1_2Op
		add	sp, 0Ah
		call	SetupMcgaWnd1
		call	DoUseMousePos

loc_11B7_763:				; CODE XREF: RunGame+723j RunGame+72Cj
		call	SetSprite2As1_2
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		call	DelAudDrvTimer
		cmp	g_cGameMode2, 0
		jz	short loc_11B7_781
		jmp	_EndGame3
; ---------------------------------------------------------------------------

loc_11B7_781:				; CODE XREF: RunGame+772j
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_11B7_78B
		jmp	_EndGame3
; ---------------------------------------------------------------------------

loc_11B7_78B:				; CODE XREF: RunGame+77Cj
		cmp	gameState.carOpponent.field_C9,	0
		jz	short loc_11B7_795
		jmp	_EndGame3
; ---------------------------------------------------------------------------

; calculating opponent time presumably follows before eof

loc_11B7_795:				; CODE XREF: RunGame+786j
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_16]
		push	ax
		push	g_wDialogArg1
		mov	ax, 50h	; 'P'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		mov	ax, offset aCop_0 ; Calculating	Opponent Time]@]
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 3
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	byte_2B77_A5CE,	1
		mov	si, g_wFramesPerSec
		dec	si

loc_11B7_7D7:				; CODE XREF: RunGame+850j
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RecordReplay
		add	sp, 2
		call	UpdateGameState
		inc	si
		mov	ax, g_wFramesPerSec
		cmp	si, ax
		jnz	short loc_11B7_82F
		sub	si, si
		mov	ax, 1
		push	ax
		mov	ax, gameState.wGameFrame
		add	ax, g_wResetOnCvxTr
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FormatString
		add	sp, 6
		call	DoRenderMouSpr3
		push	[bp+var_14]
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		call	DoUseMousePos

loc_11B7_82F:				; CODE XREF: RunGame+7E3j
		mov	ax, 1
		push	ax
		call	DoInputsCheckin
		add	sp, 2
		cmp	ax, 1Bh		; 27 = esc key
		jz	short _EndGame3
		cmp	gameState.carOpponent.field_C9,	0
		jnz	short _EndGame3
		mov	ax, 5DCh	; 1500
		imul	g_wFramesPerSec
		mov	cx, gameState.wGameFrame
		add	cx, g_wResetOnCvxTr
		cmp	ax, cx
		jz	short _EndGame3
		jmp	loc_11B7_7D7
; ---------------------------------------------------------------------------

_EndGame3:				; CODE XREF: RunGame+774j RunGame+77Ej ...
		mov	byte_2B77_A5CE,	0
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr MouseMinMaxPos
		add	sp, 2
		push	cs
		call	near ptr sub_11B7_A06
		push	cs
		call	near ptr UnloadGameResou

_EndGame1:				; CODE XREF: RunGame+A6j
		mov	g_wWaitFlag, 64h ; 'd'
		call	CheckForInput
		call	ShowWaiting

_EndGame2:				; CODE XREF: RunGame+67j
		pop	si
		mov	sp, bp
		pop	bp
		retf
RunGame		endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_11B7_88A	proc far		; CODE XREF: RunGame+6B6p
					; RplyMouseSpriteStuff+5D0p

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		cmp	ax, 64h	; 'd'
		jz	short _lblToggleD
		jbe	short loc_11B7_89A
		jmp	loc_11B7_97E
; ---------------------------------------------------------------------------

loc_11B7_89A:				; CODE XREF: sub_11B7_88A+Bj
		cmp	ax, 44h	; 'D'
		jz	short _lblToggleD
		jbe	short loc_11B7_8A4
		jmp	loc_11B7_93C
; ---------------------------------------------------------------------------

loc_11B7_8A4:				; CODE XREF: sub_11B7_88A+15j
		cmp	ax, 1Bh		; esc
		jz	short _lblKbEsc
		cmp	ax, 43h	; 'C'
		jmp	loc_11B7_94E
; ---------------------------------------------------------------------------
		align 2

_lblKbEsc:				; CODE XREF: sub_11B7_88A+1Dj
		cmp	g_cGameMode2, 0
		jnz	short loc_11B7_8C6
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		call	CvxSfxOp
		add	sp, 4

loc_11B7_8C6:				; CODE XREF: sub_11B7_88A+2Bj
		mov	byte ptr word_2B77_926A, 1 ; kommer her	p† escape!
		jmp	loc_11B7_979
; ---------------------------------------------------------------------------

_lblCamF2:				; CODE XREF: sub_11B7_88A+123j
		mov	g_cCameraMode, 1 ; kommer her p† f2
		jmp	loc_11B7_979
; ---------------------------------------------------------------------------

_lblCamF3:				; CODE XREF: sub_11B7_88A+12Bj
		mov	g_cCameraMode, 2 ; kommer her p† f3
		jmp	loc_11B7_979
; ---------------------------------------------------------------------------

_lblCamF4:				; CODE XREF: sub_11B7_88A+133j
		mov	g_cCameraMode, 3 ; kommer her p† f4
		jmp	loc_11B7_979
; ---------------------------------------------------------------------------

_lblToggleH:				; CODE XREF: sub_11B7_88A+B5j
					; sub_11B7_88A+100j
		xor	byte_2B77_184, 1 ; dette er "h"	som toggler!
		jmp	loc_11B7_979
; ---------------------------------------------------------------------------

_lblMouseControl:			; CODE XREF: sub_11B7_88A+BAj
					; sub_11B7_88A+108j
		call	DoMouResText
		mov	al, byte_2B77_182
		cbw
		push	ax
		push	cs
		call	near ptr MouseMinMaxPos
		jmp	short loc_11B7_976
; ---------------------------------------------------------------------------
		align 4

_lblToggleD:				; CODE XREF: sub_11B7_88A+9j
					; sub_11B7_88A+13j
		xor	byte_2B77_81E0,	1 ; kommer her p† "d" -	men hva	skjer?
		jmp	short loc_11B7_979
; ---------------------------------------------------------------------------
		align 2

_lblToggleR:				; CODE XREF: sub_11B7_88A+BFj
					; sub_11B7_88A+110j
		xor	g_cGameFlag1, 1	; vi kommer her	p† "r".	.. hva er det?
		jmp	short loc_11B7_979
; ---------------------------------------------------------------------------
		align 2

_lblToggleCamera:			; CODE XREF: sub_11B7_88A:loc_11B7_94Ej
		cmp	g_cGameMode2, 1	; dette	m† vel v‘re "c"	- toggle camera
		jz	short loc_11B7_979
		inc	g_cCameraMode
		cmp	g_cCameraMode, 4
		jnz	short loc_11B7_979

_lblCamInside:				; CODE XREF: sub_11B7_88A+11Bj
		mov	g_cCameraMode, 0 ; kommer her p† f1
		jmp	short loc_11B7_979
; ---------------------------------------------------------------------------
		align 2

loc_11B7_92A:				; CODE XREF: sub_11B7_88A+F7j
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_11B7_979
		xor	byte_2B77_AC70,	1
		jmp	short loc_11B7_979
; ---------------------------------------------------------------------------

loc_11B7_938:				; CODE XREF: sub_11B7_88A+CBj
		sub	ax, ax
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_93C:				; CODE XREF: sub_11B7_88A+17j
		cmp	ax, 48h	; 'H'
		jz	short _lblToggleH
		cmp	ax, 4Dh	; 'M'
		jz	short _lblMouseControl
		cmp	ax, 52h	; 'R'
		jz	short _lblToggleR
		cmp	ax, 63h	; 'c'

loc_11B7_94E:				; CODE XREF: sub_11B7_88A+22j
		jz	short _lblToggleCamera

loc_11B7_950:				; CODE XREF: sub_11B7_88A:loc_11B7_99Dj
					; sub_11B7_88A:loc_11B7_9C0j
		cmp	g_cGameMode2, 1
		jnz	short loc_11B7_938
		mov	g_cGameMode2, 0
		mov	byte_2B77_81CC,	0
		mov	ax, g_wFramesPerSec2
		mov	g_wFramesPerSec, ax
		mov	al, byte ptr g_wFramesPerSec2
		mov	byte ptr g_gameInfo.wFramesPerSec, al
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState

loc_11B7_976:				; CODE XREF: sub_11B7_88A+72j
		add	sp, 2

loc_11B7_979:				; CODE XREF: sub_11B7_88A+41j
					; sub_11B7_88A+49j ...
		mov	ax, 1
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_97E:				; CODE XREF: sub_11B7_88A+Dj
		cmp	ax, 74h	; 't'
		jz	short loc_11B7_92A
		ja	short loc_11B7_9A0
		cmp	ax, 68h	; 'h'
		jnz	short loc_11B7_98D
		jmp	_lblToggleH
; ---------------------------------------------------------------------------

loc_11B7_98D:				; CODE XREF: sub_11B7_88A+FEj
		cmp	ax, 6Dh	; 'm'
		jnz	short loc_11B7_995
		jmp	_lblMouseControl
; ---------------------------------------------------------------------------

loc_11B7_995:				; CODE XREF: sub_11B7_88A+106j
		cmp	ax, 72h	; 'r'
		jnz	short loc_11B7_99D
		jmp	_lblToggleR
; ---------------------------------------------------------------------------

loc_11B7_99D:				; CODE XREF: sub_11B7_88A+10Ej
		jmp	short loc_11B7_950
; ---------------------------------------------------------------------------
		align 2

loc_11B7_9A0:				; CODE XREF: sub_11B7_88A+F9j
		cmp	ax, 3B00h
		jnz	short loc_11B7_9A8
		jmp	_lblCamInside
; ---------------------------------------------------------------------------

loc_11B7_9A8:				; CODE XREF: sub_11B7_88A+119j
		cmp	ax, 3C00h
		jnz	short loc_11B7_9B0
		jmp	_lblCamF2
; ---------------------------------------------------------------------------

loc_11B7_9B0:				; CODE XREF: sub_11B7_88A+121j
		cmp	ax, 3D00h
		jnz	short loc_11B7_9B8
		jmp	_lblCamF3
; ---------------------------------------------------------------------------

loc_11B7_9B8:				; CODE XREF: sub_11B7_88A+129j
		cmp	ax, 3E00h
		jnz	short loc_11B7_9C0
		jmp	_lblCamF4
; ---------------------------------------------------------------------------

loc_11B7_9C0:				; CODE XREF: sub_11B7_88A+131j
		jmp	short loc_11B7_950
sub_11B7_88A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitSomeVars	proc far		; CODE XREF: _main+263P
					; InitGameState:loc_471_2472P
		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		mov	byte_2B77_931A,	1
		mov	byte_2B77_9DBF,	2
		sub	si, si
		mov	g_wMainFlgCp, si
		sub	al, al
		mov	byte ptr word_2B77_926A, al
		mov	byte_2B77_81CC,	al
		mov	word_2B77_965A,	si
		pop	si
		mov	sp, bp
		pop	bp
		retf
InitSomeVars	endp


; =============== S U B	R O U T	I N E =======================================


DoAddTimerFunc	proc far		; CODE XREF: RunGame+BAp
		mov	word_2B77_ACF8,	0
		mov	ax, offset TimerFunc
		mov	dx, seg	seg005
		push	dx
		push	ax
		call	AddTimerFunc
		add	sp, 4
		mov	byte_2B77_8B74,	0
		retf
DoAddTimerFunc	endp


; =============== S U B	R O U T	I N E =======================================


sub_11B7_A06	proc far		; CODE XREF: RunGame+863p
		mov	ax, 0Ah
		cwd
		push	dx
		push	ax
		call	DoGetTimerCounter2X
		add	sp, 4
		mov	ax, offset TimerFunc
		mov	dx, seg	seg005
		push	dx
		push	ax
		call	RemoveTimerFunc
		add	sp, 4
		retf
sub_11B7_A06	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


TimerFunc	proc far		; DATA XREF: DoAddTimerFunc+6o
					; sub_11B7_A06+Eo
		call	CompareDS_SS
		or	ax, ax
		jnz	short loc_11B7_A32
		jmp	locret_11B7_B26
; ---------------------------------------------------------------------------

loc_11B7_A32:				; CODE XREF: TimerFunc+7j
		cmp	byte_2B77_8B74,	0
		jz	short loc_11B7_A3C
		jmp	locret_11B7_B26
; ---------------------------------------------------------------------------

loc_11B7_A3C:				; CODE XREF: TimerFunc+11j
		inc	byte_2B77_8B74
		cmp	byte_2B77_8B74,	1
		jz	short loc_11B7_A4A
		jmp	loc_11B7_B22
; ---------------------------------------------------------------------------

loc_11B7_A4A:				; CODE XREF: TimerFunc+1Fj
		inc	g_wIniEng2Flag3
		mov	ax, g_w64hDivFps
		cmp	g_wIniEng2Flag3, ax
		jl	short loc_11B7_A8E
		mov	ax, g_wIniEng2Flag2
		cmp	g_wIniEng2Flag1, ax
		jz	short loc_11B7_A8E
		push	g_wIniEng2Flag3
		mov	ax, 22h	; '"'
		imul	g_wIniEng2Flag1
		add	ax, offset unk_2B77_97DC
		push	ax
		call	sub_471_45F6
		add	sp, 4
		mov	g_wIniEng2Flag3, 0
		inc	g_wIniEng2Flag1
		cmp	g_wIniEng2Flag1, 28h ; '('
		jnz	short loc_11B7_A8E
		mov	g_wIniEng2Flag1, 0

loc_11B7_A8E:				; CODE XREF: TimerFunc+2Fj
					; TimerFunc+38j ...
		cmp	byte ptr word_2B77_926A, 0
		jz	short loc_11B7_A98
		jmp	loc_11B7_B22
; ---------------------------------------------------------------------------

loc_11B7_A98:				; CODE XREF: TimerFunc+6Dj
		cmp	g_cRplBufIsFull, 0
		jz	short loc_11B7_AA2
		jmp	loc_11B7_B22
; ---------------------------------------------------------------------------

loc_11B7_AA2:				; CODE XREF: TimerFunc+77j
		cmp	g_cGameFlag2, 0
		jz	short loc_11B7_AB0
		cmp	g_cGameMode2, 2
		jz	short loc_11B7_B22

loc_11B7_AB0:				; CODE XREF: TimerFunc+81j
		cmp	g_cGameMode2, 0
		jnz	short loc_11B7_ACE
		mov	ax, gameState.wFramesPerSec
		cmp	gameState.wFrameInSec, ax
		jl	short loc_11B7_ACE
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		jmp	short loc_11B7_B22
; ---------------------------------------------------------------------------
		nop
		nop

loc_11B7_ACE:				; CODE XREF: TimerFunc+8Fj
					; TimerFunc+98j
		dec	byte_2B77_931A
		jnz	short loc_11B7_B22
		mov	al, byte ptr g_w64hDivFps
		mov	byte_2B77_931A,	al
		inc	word_2B77_ACF8
		cmp	g_cGameMode2, 2
		jnz	short loc_11B7_B18
		mov	al, byte_2B77_9276
		cbw
		cmp	ax, 2
		jz	short loc_11B7_AF6
		cmp	ax, 3
		jz	short loc_11B7_B0E
		jmp	short loc_11B7_B18
; ---------------------------------------------------------------------------
		align 2

loc_11B7_AF6:				; CODE XREF: TimerFunc+C6j
		dec	byte_2B77_9DBF
		jnz	short loc_11B7_B22
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr RecordReplay
		add	sp, 2
		mov	byte_2B77_9DBF,	2
		jmp	short loc_11B7_B22 ; dec 2b77_8b74
; ---------------------------------------------------------------------------
		align 2

loc_11B7_B0E:				; CODE XREF: TimerFunc+CBj
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr RecordReplay
		add	sp, 2

loc_11B7_B18:				; CODE XREF: TimerFunc+BDj
					; TimerFunc+CDj
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr RecordReplay
		add	sp, 2

loc_11B7_B22:				; CODE XREF: TimerFunc+21j
					; TimerFunc+6Fj ...
		dec	byte_2B77_8B74

locret_11B7_B26:			; CODE XREF: TimerFunc+9j
					; TimerFunc+13j
		retf
TimerFunc	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RecordReplay	proc far		; CODE XREF: RunGame+7D2p
					; TimerFunc+DAp ...

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		cmp	[bp+arg_0], 0
		jz	short loc_11B7_B3C

loc_11B7_B36:				; CODE XREF: RecordReplay+53j
					; RecordReplay+5Aj ...
		sub	si, si
		jmp	loc_11B7_CA7
; ---------------------------------------------------------------------------
		align 2

loc_11B7_B3C:				; CODE XREF: RecordReplay+Cj
		cmp	g_cGameMode2, 2
		jnz	short loc_11B7_B76
		mov	ax, g_wMainFlgCp
		cmp	g_gameInfo.wRecordedFrames, ax
		jbe	short loc_11B7_B56
		inc	g_wMainFlgCp
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_B56:				; CODE XREF: RecordReplay+22j
		cmp	byte ptr word_2B77_926A, 0
		jz	short loc_11B7_B60
		jmp	loc_11B7_E15
; ---------------------------------------------------------------------------

loc_11B7_B60:				; CODE XREF: RecordReplay+33j
		mov	g_cGameFlag2, 1
		call	DoAudioCvx

loc_11B7_B6A:				; CODE XREF: RecordReplay+1A1j
		mov	byte ptr word_2B77_926A, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_B76:				; CODE XREF: RecordReplay+19j
		cmp	byte ptr word_2B77_926A, 0
		jnz	short loc_11B7_B36
		cmp	gameState.cCvxFlag3, 0
		jnz	short loc_11B7_B36
		cmp	g_cGameMode2, 1
		jz	short loc_11B7_B36
		cmp	g_bPassedSecuri, 0
		jnz	short loc_11B7_BB5
		cmp	byte_2B77_81CC,	0
		jnz	short loc_11B7_BB5
		mov	ax, g_wFramesPerSec
		shl	ax, 1
		shl	ax, 1
		cmp	ax, gameState.wGameFrame
		jnb	short loc_11B7_BB5
		sub	ax, ax
		push	ax
		mov	ax, 1
		push	ax
		call	CvxSfxOp
		add	sp, 4

loc_11B7_BB5:				; CODE XREF: RecordReplay+68j
					; RecordReplay+6Fj ...
		cmp	byte_2B77_182, 0
		jnz	short loc_11B7_BC6
		cmp	g_bSkipJoystick, 0
		jnz	short loc_11B7_BC6
		jmp	loc_11B7_C78
; ---------------------------------------------------------------------------

loc_11B7_BC6:				; CODE XREF: RecordReplay+92j
					; RecordReplay+99j
		cmp	byte_2B77_182, 0
		jz	short loc_11B7_C2A
		mov	ax, offset g_wMouYPos
		push	ax
		mov	ax, offset g_wMouXPos
		push	ax
		mov	ax, offset g_wMouButStatus
		push	ax
		call	GetMouseState
		add	sp, 6
		mov	di, g_wMouXPos
		sub	di, 0A0h ; ' '
		push	di
		call	_abs
		add	sp, 2
		cmp	ax, 12h
		jge	short loc_11B7_BFC
		sub	di, di
		jmp	short loc_11B7_C09
; ---------------------------------------------------------------------------
		align 2

loc_11B7_BFC:				; CODE XREF: RecordReplay+CDj
		or	di, di
		jle	short loc_11B7_C06
		sub	di, 12h
		jmp	short loc_11B7_C09
; ---------------------------------------------------------------------------
		align 2

loc_11B7_C06:				; CODE XREF: RecordReplay+D6j
		add	di, 12h

loc_11B7_C09:				; CODE XREF: RecordReplay+D1j
					; RecordReplay+DBj
		mov	ax, di
		mov	g_wCurveIndex, al
		test	byte ptr g_wMouButStatus, 1
		jz	short loc_11B7_C1A
		mov	si, 2
		jmp	short loc_11B7_C62
; ---------------------------------------------------------------------------

loc_11B7_C1A:				; CODE XREF: RecordReplay+EBj
		test	byte ptr g_wMouButStatus, 2
		jz	short loc_11B7_C26
		mov	si, 1
		jmp	short loc_11B7_C62
; ---------------------------------------------------------------------------

loc_11B7_C26:				; CODE XREF: RecordReplay+F7j
		sub	si, si
		jmp	short loc_11B7_C62
; ---------------------------------------------------------------------------

loc_11B7_C2A:				; CODE XREF: RecordReplay+A3j
		call	CheckJoyFlag
		mov	g_wCurveIndex, al
		or	al, al
		jle	short loc_11B7_C40
		cbw
		mov	bx, ax
		mov	al, g_pSomeCurve[bx]
		jmp	short loc_11B7_C55
; ---------------------------------------------------------------------------
		align 2

loc_11B7_C40:				; CODE XREF: RecordReplay+10Cj
		cmp	g_wCurveIndex, 0
		jge	short loc_11B7_C58
		mov	al, g_wCurveIndex
		cbw
		mov	bx, ax
		neg	bx
		mov	al, g_pSomeCurve[bx]
		neg	al

loc_11B7_C55:				; CODE XREF: RecordReplay+115j
		mov	g_wCurveIndex, al

loc_11B7_C58:				; CODE XREF: RecordReplay+11Dj
		call	GetKbOrJoyFlags
		mov	si, ax
		and	si, 33h		; si = flags for shiftup/dn / up/down

loc_11B7_C62:				; CODE XREF: RecordReplay+F0j
					; RecordReplay+FCj ...
		mov	di, g_wMainFlgCp
		and	di, 3Fh
		mov	al, g_wCurveIndex
		mov	byte_2B77_8B22[di], al
		mov	byte_2B77_8B7A[di], 1
		jmp	short loc_11B7_C7F
; ---------------------------------------------------------------------------
		align 2

loc_11B7_C78:				; CODE XREF: RecordReplay+9Bj
		call	GetKbOrJoyFlags
		mov	si, ax

loc_11B7_C7F:				; CODE XREF: RecordReplay+14Dj
		mov	ax, 1Eh
		push	ax
		call	GetKeyStatus
		add	sp, 2
		or	ax, ax
		jz	short loc_11B7_C93
		or	si, 10h

loc_11B7_C93:				; CODE XREF: RecordReplay+165j
		mov	ax, 2Ch
		push	ax
		call	GetKeyStatus
		add	sp, 2
		or	ax, ax
		jz	short loc_11B7_CA7
		or	si, 20h

loc_11B7_CA7:				; CODE XREF: RecordReplay+10j
					; RecordReplay+179j
		mov	ax, 5DCh
		imul	g_wFramesPerSec
		mov	cx, g_wMainFlgCp
		add	cx, g_wResetOnCvxTr
		cmp	ax, cx
		ja	short loc_11B7_CCC
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		call	CvxSfxOp
		add	sp, 4
		jmp	loc_11B7_B6A
; ---------------------------------------------------------------------------

loc_11B7_CCC:				; CODE XREF: RecordReplay+190j
		cmp	g_wMainFlgCp, 2EE0h ; 12000
		jz	short loc_11B7_CD7 ; sets "replay buffer full flag" if equal
		jmp	loc_11B7_DFC
; ---------------------------------------------------------------------------

loc_11B7_CD7:				; CODE XREF: RecordReplay+1AAj
		cmp	g_wResetOnCvxTr, 0
		jnz	short loc_11B7_CF6
		cmp	byte_2B77_A5CE,	0
		jnz	short loc_11B7_CF6
		mov	byte_2B77_A5CE,	1
		mov	g_cRplBufIsFull, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_CF6:				; CODE XREF: RecordReplay+1B4j
					; RecordReplay+1BBj
		sub	di, di
		jmp	loc_11B7_D99
; ---------------------------------------------------------------------------
		align 2

loc_11B7_CFC:				; CODE XREF: RecordReplay+289j
		mov	ax, 460h
		cwd
		push	dx
		push	ax
		mov	ax, di
		cwd
		push	dx
		push	ax
		call	__aFlmul
		add	ax, 5A0h
		adc	dx, 0
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, word ptr g_dwCvxBytes+2
		mov	es, dx
		mov	bx, ax
		mov	ax, [bp+var_6]
		sub	es:[bx], ax
		mov	ax, 460h
		cwd
		push	dx
		push	ax
		mov	ax, di
		cwd
		push	dx
		push	ax
		call	__aFlmul
		add	ax, 460h
		adc	dx, 0
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, word ptr g_dwCvxBytes+2
		mov	cx, 460h
		sub	bx, bx
		push	bx
		push	cx
		mov	cx, ax
		mov	ax, di
		mov	bx, dx
		cwd
		push	dx
		push	ax
		mov	[bp+var_A], cx
		mov	[bp+var_8], bx
		call	__aFlmul
		add	ax, word ptr g_dwCvxBytes
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, word ptr g_dwCvxBytes+2
		mov	bx, ax
		mov	es, dx
		mov	ax, [bp+var_A]
		mov	dx, [bp+var_8]
		push	si
		push	di
		mov	di, bx
		mov	si, ax
		push	ds
		mov	ds, dx
		mov	cx, 230h
		repne movsw
		pop	ds
		pop	di
		pop	si
		inc	di

loc_11B7_D99:				; CODE XREF: RecordReplay+1D0j
		mov	ax, 1Eh
		imul	g_wFramesPerSec
		mov	[bp+var_6], ax
		mov	ax, 2EE0h
		cwd
		mov	cx, [bp+var_6]
		idiv	cx
		dec	ax
		cmp	ax, di
		jle	short loc_11B7_DB4
		jmp	loc_11B7_CFC
; ---------------------------------------------------------------------------

loc_11B7_DB4:				; CODE XREF: RecordReplay+287j
		sub	di, di
		jmp	short loc_11B7_DCE
; ---------------------------------------------------------------------------

loc_11B7_DB8:				; CODE XREF: RecordReplay+2B8j
		mov	bx, [bp+var_A]
		add	bx, word ptr g_ppTrakdata16
		mov	es, word ptr g_ppTrakdata16+2
		mov	al, es:[bx+di]
		mov	bx, word ptr g_ppTrakdata16
		mov	es:[bx+di], al
		inc	di

loc_11B7_DCE:				; CODE XREF: RecordReplay+28Ej
		mov	ax, 1Eh		; 30 what?
		imul	g_wFramesPerSec
		mov	[bp+var_A], ax
		mov	ax, 2EE0h	; 12000	- limit	of rpl recording
		sub	ax, [bp+var_A]
		cmp	ax, di
		jg	short loc_11B7_DB8


		mov	ax, 1Eh
		imul	g_wFramesPerSec
		mov	[bp+var_A], ax
		sub	g_wMainFlgCp, ax
		sub	g_gameInfo.wRecordedFrames, ax
		add	g_wResetOnCvxTr, ax
		sub	gameState.wGameFrame, ax

loc_11B7_DFC:				; CODE XREF: RecordReplay+1ACj
		mov	bx, g_wMainFlgCp
		inc	g_wMainFlgCp
		add	bx, word ptr g_ppTrakdata16
		mov	es, word ptr g_ppTrakdata16+2
		mov	ax, si
		mov	es:[bx], al
		inc	g_gameInfo.wRecordedFrames

loc_11B7_E15:				; CODE XREF: RecordReplay+35j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
RecordReplay	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_11B7_E1C	proc far		; CODE XREF: UpdateGameState:loc_471_29CCP

pTrakdata9	= dword	ptr -34h
var_30		= word ptr -30h
wVecIndexOfs	= word ptr -2Eh
var_2C		= word ptr -2Ch
wNumPlayers	= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
pCarCvx		= word ptr -24h
var_22		= word ptr -22h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
vec		= Vector3D ptr -1Ch
var_14		= word ptr -14h
wAngle		= word ptr -10h
wCvxCarField48	= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah
var_8		= word ptr -8
vec2		= Vector3D ptr -6

		push	bp
		mov	bp, sp
		sub	sp, 34h
		push	di
		push	si
		mov	[bp+wNumPlayers], 1
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_11B7_E35
		mov	[bp+wNumPlayers], 2

loc_11B7_E35:				; CODE XREF: sub_11B7_E1C+12j
		sub	si, si
		jmp	loc_11B7_10E3
; ---------------------------------------------------------------------------
; vi kommer her	hvis vi	prosesserer den	andre bilen?

_lblSelectCar2:				; CODE XREF: sub_11B7_E1C+2F5j
		mov	[bp+pCarCvx], offset gameState.carOpponent

_lblCarStart:				; CODE XREF: sub_11B7_E1C+2FDj
		mov	bx, [bp+pCarCvx]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwY]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwY+2)]
		mov	cl, 6

loc_11B7_E4A:				; CODE XREF: sub_11B7_E1C+34j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_11B7_E4A ; shr 6?


		mov	[bp+vec.wY], ax
		mov	bx, [bp+pCarCvx]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwX]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwX+2)]
		mov	cl, 6

loc_11B7_E5F:				; CODE XREF: sub_11B7_E1C+49j
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_11B7_E5F
		mov	[bp+vec.wX], ax
		mov	bx, [bp+pCarCvx]
		mov	ax, word ptr [bx+CarState.vecLongUnk.dwZ]
		mov	dx, word ptr [bx+(CarState.vecLongUnk.dwZ+2)]
		mov	cl, 6

loc_11B7_E75:				; CODE XREF: sub_11B7_E1C+5Fj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_11B7_E75
		mov	[bp+vec.wZ], ax
		mov	bx, [bp+pCarCvx]
		push	si
		push	di
		lea	di, [bp+vec2]
		lea	si, [bx+CarState.vecUnk3]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, [bp+pCarCvx]
		mov	ax, [bx+CarState.field_48]
		mov	[bp+wCvxCarField48], ax
		or	si, si
		jnz	short loc_11B7_EAE
		cmp	gameState.field_45B, 0
		jnz	short loc_11B7_ED0
		cmp	gameState.field_45C, 0
		jnz	short loc_11B7_ED0

loc_11B7_EAE:				; CODE XREF: sub_11B7_E1C+82j
		cmp	[bx+CarState.field_B6],	0
		jnz	short loc_11B7_ED0
		cmp	[bx+CarState.field_C9],	0
		jnz	short loc_11B7_ED0
		cmp	[bx+CarState.wTrakdata3Index], 0FFFFh
		jz	short loc_11B7_ED0
		cmp	[bp+wCvxCarField48], 80h ; '€'
		jle	short loc_11B7_EDD
		cmp	[bp+wCvxCarField48], 380h
		jge	short loc_11B7_EDD

loc_11B7_ED0:				; CODE XREF: sub_11B7_E1C+89j
					; sub_11B7_E1C+90j ...
		push	si
		push	di
		lea	di, [bp+vec2]
		lea	si, [bp+vec]
		movsw
		movsw
		movsw
		pop	di
		pop	si

loc_11B7_EDD:				; CODE XREF: sub_11B7_E1C+ABj
					; sub_11B7_E1C+B2j
		mov	[bp+var_22], 1C2h
		mov	ax, [bp+vec.wY]
		add	ax, 10Eh
		mov	[bp+var_14], ax
		mov	bx, si
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	ax, gameState.vec1.wY[bx]
		sub	ax, [bp+var_14]
		mov	[bp+var_C], ax
		or	ax, ax
		jz	short loc_11B7_F26
		mov	di, ax
		cmp	di, 1Eh
		jle	short loc_11B7_F10
		mov	di, 1Eh
		jmp	short loc_11B7_F18
; ---------------------------------------------------------------------------
		align 2

loc_11B7_F10:				; CODE XREF: sub_11B7_E1C+ECj
		cmp	di, 0FFE2h
		jge	short loc_11B7_F18
		mov	di, 0FFE2h

loc_11B7_F18:				; CODE XREF: sub_11B7_E1C+F1j
					; sub_11B7_E1C+F7j
		mov	bx, si
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		sub	gameState.vec1.wY[bx], di

loc_11B7_F26:				; CODE XREF: sub_11B7_E1C+E5j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+wVecIndexOfs], ax
		mov	ax, [bp+vec2.wZ]
		mov	bx, [bp+wVecIndexOfs]
		sub	ax, gameState.vec1.wZ[bx]
		push	ax
		mov	ax, [bp+vec2.wX]
		sub	ax, gameState.vec1.wX[bx]
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		mov	[bp+wAngle], ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_30], ax
		mov	ax, [bp+vec.wZ]
		mov	bx, [bp+var_30]
		sub	ax, gameState.vec1.wZ[bx]
		push	ax
		mov	ax, [bp+vec.wX]
		sub	ax, gameState.vec1.wX[bx]
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	di, ax
		cmp	[bp+var_22], di
		jge	short loc_11B7_FE3
		sub	di, [bp+var_22]
		cmp	g_wFramesPerSec, 14h
		jnz	short loc_11B7_F94
		cmp	di, 78h
		jle	short loc_11B7_F9D
		mov	di, 78h
		jmp	short loc_11B7_F9D
; ---------------------------------------------------------------------------

loc_11B7_F94:				; CODE XREF: sub_11B7_E1C+16Cj
		cmp	di, 0F0h
		jle	short loc_11B7_F9D
		mov	di, 0F0h

loc_11B7_F9D:				; CODE XREF: sub_11B7_E1C+171j
					; sub_11B7_E1C+176j ...
		push	[bp+wAngle]
		call	LookupSine
		add	sp, 2
		push	ax
		push	di
		call	ScaleValue
		add	sp, 4
		mov	bx, si
		mov	cx, bx
		shl	bx, 1
		add	bx, cx
		shl	bx, 1
		add	gameState.vec1.wX[bx], ax
		push	[bp+wAngle]
		call	LookupCos
		add	sp, 2
		push	ax
		push	di
		call	ScaleValue
		add	sp, 4
		mov	bx, si
		mov	cx, bx
		shl	bx, 1
		add	bx, cx
		shl	bx, 1
		add	gameState.vec1.wZ[bx], ax

loc_11B7_FE3:				; CODE XREF: sub_11B7_E1C+162j
		mov	ax, gameState.wGameFrame
		sub	dx, dx
		mov	cx, g_wFramesPerSec
		sar	cx, 1
		div	cx
		or	dx, dx
		jz	short loc_11B7_FF7
		jmp	loc_11B7_10E2
; ---------------------------------------------------------------------------

loc_11B7_FF7:				; CODE XREF: sub_11B7_E1C+1D6j
		mov	[bp+var_2C], 2710h
		mov	[bp+var_A], 0
		jmp	short loc_11B7_1073
; ---------------------------------------------------------------------------
		align 4

loc_11B7_1004:				; CODE XREF: sub_11B7_E1C+2B2j
		mov	ax, [bp+var_20]
		mov	dx, [bp+var_1E]

loc_11B7_100A:				; CODE XREF: sub_11B7_E1C+2C2j
		mov	cx, ax
		mov	ax, [bp+var_2C]
		mov	bx, dx
		cwd
		cmp	bx, dx
		jg	short loc_11B7_1070
		jl	short loc_11B7_101C
		cmp	cx, ax
		jnb	short loc_11B7_1070

loc_11B7_101C:				; CODE XREF: sub_11B7_E1C+1FAj
		cmp	[bp+var_26], 0
		jge	short loc_11B7_1032
		mov	ax, [bp+var_28]
		mov	dx, [bp+var_26]
		neg	ax
		adc	dx, 0
		neg	dx
		jmp	short loc_11B7_1038
; ---------------------------------------------------------------------------
		align 2

loc_11B7_1032:				; CODE XREF: sub_11B7_E1C+204j
		mov	ax, [bp+var_28]
		mov	dx, [bp+var_26]

loc_11B7_1038:				; CODE XREF: sub_11B7_E1C+213j
		mov	cx, ax
		mov	ax, [bp+var_2C]
		mov	bx, dx
		cwd
		cmp	bx, dx
		jg	short loc_11B7_1070
		jl	short loc_11B7_104A
		cmp	cx, ax
		jnb	short loc_11B7_1070

loc_11B7_104A:				; CODE XREF: sub_11B7_E1C+228j
		push	[bp+var_28]
		push	[bp+var_20]
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_8], ax
		mov	ax, [bp+var_2C]
		cmp	[bp+var_8], ax
		jge	short loc_11B7_1070
		mov	al, [bp+var_A]
		mov	gameState.cCvxFlag4[si], al
		mov	ax, [bp+var_8]
		mov	[bp+var_2C], ax

loc_11B7_1070:				; CODE XREF: sub_11B7_E1C+1F8j
					; sub_11B7_E1C+1FEj ...
		inc	[bp+var_A]

loc_11B7_1073:				; CODE XREF: sub_11B7_E1C+1E4j
		mov	al, byte_2B77_A9FE
		cmp	[bp+var_A], al
		jge	short loc_11B7_10E2
		mov	al, [bp+var_A]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_pTrakdata9
		mov	dx, word ptr g_pTrakdata9+2
		mov	word ptr [bp+pTrakdata9], ax
		mov	word ptr [bp+pTrakdata9+2], dx
		mov	ax, [bp+vec.wX]
		cwd
		les	bx, [bp+pTrakdata9]
		mov	cx, ax
		mov	ax, es:[bx]
		mov	bx, dx
		cwd
		sub	ax, cx
		sbb	dx, bx
		mov	[bp+var_20], ax
		mov	[bp+var_1E], dx
		mov	ax, [bp+vec.wZ]
		cwd
		mov	bx, word ptr [bp+pTrakdata9]
		mov	cx, ax
		mov	ax, es:[bx+4]
		mov	bx, dx
		cwd
		sub	ax, cx
		sbb	dx, bx
		mov	[bp+var_28], ax
		mov	[bp+var_26], dx
		cmp	[bp+var_1E], 0
		jl	short loc_11B7_10D1
		jmp	loc_11B7_1004
; ---------------------------------------------------------------------------

loc_11B7_10D1:				; CODE XREF: sub_11B7_E1C+2B0j
		mov	ax, [bp+var_20]
		mov	dx, [bp+var_1E]
		neg	ax
		adc	dx, 0
		neg	dx
		jmp	loc_11B7_100A
; ---------------------------------------------------------------------------
		align 2

loc_11B7_10E2:				; CODE XREF: sub_11B7_E1C+1D8j
					; sub_11B7_E1C+25Dj
		inc	si

loc_11B7_10E3:				; CODE XREF: sub_11B7_E1C+1Bj
		cmp	[bp+wNumPlayers], si
		jle	short loc_11B7_111C
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	[bp+wVecIndexOfs], ax
		mov	bx, ax
		lea	ax, gameState.vec1.wX[bx]
		mov	bx, [bp+wVecIndexOfs]
		push	si
		push	di
		lea	di, gameState.vec3.wX[bx]
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		movsw			; copy from ds:si (vec1) to es:di (vec3)
		movsw
		movsw
		pop	di
		pop	si
		or	si, si
		jz	short _lblSelectCar1
		jmp	_lblSelectCar2
; ---------------------------------------------------------------------------

_lblSelectCar1:				; CODE XREF: sub_11B7_E1C+2F3j
		mov	[bp+pCarCvx], offset gameState.carPlayer
		jmp	_lblCarStart
; ---------------------------------------------------------------------------

loc_11B7_111C:				; CODE XREF: sub_11B7_E1C+2CAj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_11B7_E1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadReplayFile	proc far		; CODE XREF: RunOptionMenu+1DCP
					; RunGame+5Dp ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	di
		push	si
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_rpl_2 ; ".rpl"
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	CombineFilePath
		add	sp, 8
		mov	g_bSaveDelFlag,	1
		push	word ptr g_ppTrakdata13+2
		push	word ptr g_ppTrakdata13
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	LoadBinaryFile
		add	sp, 6
		mov	ax, word ptr g_ppTrakdata13
		mov	dx, word ptr g_ppTrakdata13+2
		mov	di, offset g_gameInfo
		mov	si, ax
		push	ds
		pop	es
		push	ds
		mov	ds, dx
		mov	cx, 0Dh		; copy 13 words	from rpl to our	gameinfo
		repne movsw
		pop	ds
		mov	g_bSaveDelFlag,	0
		sub	ax, ax
		pop	si
		pop	di
		pop	bp
		retf
LoadReplayFile	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SaveReplay	proc far		; CODE XREF: RplyMouseSpriteStuff+BB6p

var_6		= word ptr -6
var_4		= word ptr -4
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		les	bx, g_ppTrakdata13
		assume es:nothing
		push	si
		mov	di, bx
		mov	si, offset g_gameInfo
		mov	cx, 0Dh		; the bytes at g_pCarID	could be a struct of 13	bytes yes
		repne movsw
		pop	si
		mov	ax, g_gameInfo.wRecordedFrames
		add	ax, 724h
		cwd
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx
		mov	g_bSaveDelFlag,	1
		push	dx
		push	ax
		push	es
		push	bx
		push	[bp+arg_0]
		call	SaveAndDelFile
		add	sp, 0Ah
		mov	g_bSaveDelFlag,	0
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SaveReplay	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupCarShapes	proc far		; CODE XREF: RunGame+438p RunGame+590p ...

var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= byte ptr -1Ch
var_1A		= byte ptr -1Ah
var_18		= byte ptr -18h
var_16		= byte ptr -16h
var_14		= byte ptr -14h
var_E		= word ptr -0Eh
pDashBitmap	= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= byte ptr -6
var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 20h
		push	di
		push	si
		mov	ax, [bp+arg_0]
		or	ax, ax
		jz	short loc_11B7_11EC
		cmp	ax, 1
		jnz	short loc_11B7_11D5
		jmp	loc_11B7_1406
; ---------------------------------------------------------------------------

loc_11B7_11D5:				; CODE XREF: SetupCarShapes+12j
		cmp	ax, 2
		jnz	short loc_11B7_11DD
		jmp	loc_11B7_14C0
; ---------------------------------------------------------------------------

loc_11B7_11DD:				; CODE XREF: SetupCarShapes+1Aj
		cmp	ax, 3
		jnz	short loc_11B7_11E5
		jmp	loc_11B7_1B3C
; ---------------------------------------------------------------------------

loc_11B7_11E5:				; CODE XREF: SetupCarShapes+22j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_11EC:				; CODE XREF: SetupCarShapes+Dj
		mov	al, byte ptr g_gameInfo.dwPlayerCarID
		mov	byte ptr aXxxx_0, al ; "xxxx"
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+1
		mov	byte ptr aXxxx_0+1, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+2
		mov	byte ptr aXxxx_0+2, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+3
		mov	byte ptr aXxxx_0+3, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID
		mov	byte ptr aXxxx,	al ; "xxxx"
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+1
		mov	byte ptr aXxxx+1, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+2
		mov	byte ptr aXxxx+2, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+3
		mov	byte ptr aXxxx+3, al
		mov	ax, offset aStda ; "stda"
		push	ax
		mov	ax, 3
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr g_dwStdaRes, ax
		mov	word ptr g_dwStdaRes+2,	dx
		mov	ax, offset aStdb ; "stdb"
		push	ax
		mov	ax, 2
		push	ax
		call	LoadResource
		add	sp, 4
		mov	word ptr g_dwStdbRes, ax
		mov	word ptr g_dwStdbRes+2,	dx
		mov	ax, offset g_wWhlMultiRes
		push	ax
		mov	ax, offset aWhl1whl2whl3in ; "whl1whl2whl3ins2gboxins1ins3inm1inm3"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateManyResou
		add	sp, 8
		mov	ax, offset g_wGnobMultiRes
		push	ax
		mov	ax, offset aGnobgnabdotDot ; "gnobgnabdot dotadot1dot2"
		push	ax
		push	word ptr g_dwStdbRes+2
		push	word ptr g_dwStdbRes
		call	LocateManyResou
		add	sp, 8
		cmp	g_dwCopyOfSimd.ptSpdCenter.y, 0
		jnz	short loc_11B7_1299
		mov	ax, offset g_wDigMultiRes
		push	ax
		mov	ax, offset aDig0dig1dig2di ; "dig0dig1dig2dig3dig4dig5dig6dig7dig8dig"...
		push	ax
		push	word ptr g_dwStdbRes+2
		push	word ptr g_dwStdbRes
		call	LocateManyResou
		add	sp, 8

loc_11B7_1299:				; CODE XREF: SetupCarShapes+C1j
		mov	ax, 0Fh
		push	ax
		les	bx, dword ptr g_wWhlMultiRes+0Ch
		push	es:[bx+Shape2D.dwHeight]
		mov	ax, es:[bx+Shape2D.dwWidth]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_dwWinDefRes1, ax
		mov	word ptr g_dwWinDefRes1+2, dx
		mov	ax, 0Fh
		push	ax
		les	bx, dword ptr g_wWhlMultiRes+10h
		push	es:[bx+Shape2D.dwHeight]
		mov	ax, es:[bx+Shape2D.dwWidth]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_dwWinDefRes2, ax
		mov	word ptr g_dwWinDefRes2+2, dx
		mov	ax, 0Fh
		push	ax
		les	bx, dword ptr g_wWhlMultiRes+10h
		push	es:[bx+Shape2D.dwHeight]
		mov	ax, es:[bx+Shape2D.dwWidth]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_dwWinDefRes3, ax
		mov	word ptr g_dwWinDefRes3+2, dx
		mov	ax, offset aDash_0 ; "dash"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape
		add	sp, 6
		mov	word ptr [bp+pDashBitmap], ax
		mov	word ptr [bp+pDashBitmap+2], dx
		push	word ptr g_dwWinDefRes3+2
		push	word ptr g_dwWinDefRes3
		call	SetSprite1
		add	sp, 4
		les	bx, [bp+pDashBitmap]
		mov	ax, es:[bx+Shape2D.dwPosY]
		les	bx, dword ptr g_wWhlMultiRes+10h
		sub	ax, es:[bx+Shape2D.dwPosY]
		push	ax
		les	bx, [bp+pDashBitmap]
		mov	ax, es:[bx+Shape2D.dwPosX]
		les	bx, dword ptr g_wWhlMultiRes+10h
		sub	ax, es:[bx+Shape2D.dwPosX]
		push	ax
		push	word ptr [bp+pDashBitmap+2]
		push	word ptr [bp+pDashBitmap]
		call	sub_1EA2_5494
		add	sp, 8
		call	SetSprite2As1
		les	bx, [bp+pDashBitmap]
		mov	ax, es:[bx+Shape2D.dwPosY]
		mov	word_2B77_A64A,	ax
		mov	ax, offset aRoof_1 ; "roof"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape0
		add	sp, 6
		or	dx, ax
		jz	short loc_11B7_13A2
		mov	ax, offset aRoof_2 ; "roof"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape
		add	sp, 6
		mov	bx, ax
		mov	es, dx
		mov	ax, es:[bx+Shape2D.dwHeight]
		mov	g_wRoofBmpHeight, ax
		jmp	short loc_11B7_13A8
; ---------------------------------------------------------------------------

loc_11B7_13A2:				; CODE XREF: SetupCarShapes+1C1j
		mov	g_wRoofBmpHeight, 0

loc_11B7_13A8:				; CODE XREF: SetupCarShapes+1E2j
		mov	ax, offset aDast ; "dast"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape0
		add	sp, 6
		mov	word ptr [bp+pDashBitmap], ax
		mov	word ptr [bp+pDashBitmap+2], dx
		or	ax, dx
		jz	short loc_11B7_13FA
		les	bx, [bp+pDashBitmap]
		mov	ax, es:[bx+Shape2D.dwPosY]
		mov	g_wDashBitmapY,	ax
		mov	ax, bx
		mov	word ptr g_wDashBmp2Ofs, ax
		mov	word ptr g_wDashBmp2Ofs+2, dx
		mov	ax, offset aDasm ; "dasm"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape	; not all cars have a dasm bitmap
		add	sp, 6
		mov	g_pDasmBmpOfs, ax
		mov	g_pDasmBmpSeg, dx
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_13FA:				; CODE XREF: SetupCarShapes+206j
		mov	g_wDashBitmapY,	0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_1406:				; CODE XREF: SetupCarShapes+14j
		call	DoRenderMouSpr3
		mov	ax, offset aRoof ; "roof"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape0
		add	sp, 6
		or	dx, ax
		jz	short loc_11B7_1441
		mov	ax, offset aRoof_0 ; "roof"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	RplyManySprite
		add	sp, 4

loc_11B7_1441:				; CODE XREF: SetupCarShapes+263j
		mov	ax, offset aDash ; "dash"
		push	ax
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	MaybePutBitmapOn1
		add	sp, 4
		push	g_wWhlMultiRes+6
		push	g_wWhlMultiRes+4
		call	MaybePutBitmapOn1
		add	sp, 4
		call	DoUseMousePos
		sub	si, si
		mov	al, byte_2B77_8BBA
		cbw
		mov	[bp+var_1E], ax
		mov	bx, ax
		sub	al, al
		mov	byte ptr word_2B77_9268[bx], al
		mov	bx, [bp+var_1E]
		mov	byte ptr word_2B77_568A[bx], al
		mov	ax, [bp+var_1E]
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		mov	word_2B77_5686[bx], si
		mov	bx, [bp+var_1E]
		sub	al, al
		mov	byte ptr word_2B77_5680[bx], al
		dec	si
		mov	bx, [bp+var_20]
		mov	word_2B77_5690[bx], si
		mov	bx, [bp+var_20]
		mov	word_2B77_5608[bx], si
		mov	bx, [bp+var_20]
		mov	word_2B77_55FC[bx], si
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_14C0:				; CODE XREF: SetupCarShapes+1Cj
		mov	al, gameState.carPlayer.cFpsMul2
		cbw
		mov	cx, ax
		mov	al, gameState.carPlayer.cChangingGear
		cbw
		or	ax, cx
		jnz	short loc_11B7_152A
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		cmp	byte ptr word_2B77_568A[bx], 0
		jz	short loc_11B7_152A
		cmp	g_wVideoFlag4, 0
		jnz	short loc_11B7_14E7
		call	DoRenderMouSpr3

loc_11B7_14E7:				; CODE XREF: SetupCarShapes+322j
		push	word_2B77_A264
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		les	bx, dword ptr g_wWhlMultiRes+10h ; 5650	er det samme som dashres? en sprite?
		push	es:[bx+Shape2D.dwPosY]
		push	es:[bx+Shape2D.dwPosX]
		les	bx, g_dwWinDefRes3
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	byte ptr word_2B77_568A[bx], 0
		jmp	loc_11B7_162D
; ---------------------------------------------------------------------------

loc_11B7_152A:				; CODE XREF: SetupCarShapes+30Ej
					; SetupCarShapes+31Bj
		mov	al, byte_2B77_8BBA
		cbw
		mov	[bp+var_20], ax
		mov	bx, ax
		mov	al, gameState.carPlayer.cChangingGear
		cmp	byte ptr word_2B77_568A[bx], al
		jnz	short loc_11B7_156E
		mov	ax, bx
		shl	ax, 1
		mov	[bp+var_1E], ax
		mov	bx, ax
		mov	ax, gameState.carPlayer.wKnobX
		cmp	word_2B77_5600[bx], ax
		jnz	short loc_11B7_156E
		mov	ax, gameState.carPlayer.wKnobY
		cmp	word_2B77_5604[bx], ax
		jnz	short loc_11B7_156E
		cmp	gameState.carPlayer.cFpsMul2, 0
		jnz	short loc_11B7_1561
		jmp	loc_11B7_162D
; ---------------------------------------------------------------------------

loc_11B7_1561:				; CODE XREF: SetupCarShapes+39Ej
		mov	bx, [bp+var_20]
		cmp	byte ptr word_2B77_568A[bx], 0
		jz	short loc_11B7_156E
		jmp	loc_11B7_162D
; ---------------------------------------------------------------------------

loc_11B7_156E:				; CODE XREF: SetupCarShapes+37Cj
					; SetupCarShapes+38Ej ...
		push	word ptr g_dwWinDefRes2+2
		push	word ptr g_dwWinDefRes2
		call	SetSprite1
		add	sp, 4
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	byte ptr word_2B77_568A[bx], 1
		sub	ax, ax
		push	ax
		push	ax
		push	word ptr unk_2B77_5652
		push	g_wWhlMultiRes+10h
		call	sub_1EA2_5494
		add	sp, 8
		mov	si, gameState.carPlayer.wKnobX
		mov	di, gameState.carPlayer.wKnobY
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		mov	word_2B77_5600[bx], si
		mov	bx, [bp+var_20]
		mov	word_2B77_5604[bx], di
		push	di
		push	si
		push	g_wGnobMultiRes+6
		push	g_wGnobMultiRes+4
		call	DoMaybePutImageAnd
		add	sp, 8
		push	di
		push	si
		push	g_wGnobMultiRes+2
		push	g_wGnobMultiRes
		call	DoMaybePutBitmapOr
		add	sp, 8
		cmp	g_wVideoFlag4, 0
		jz	short loc_11B7_15EE
		call	SetupMcgaWnd2
		jmp	short loc_11B7_15F8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_15EE:				; CODE XREF: SetupCarShapes+426j
		call	SetSprite2As1_2
		call	DoRenderMouSpr3

loc_11B7_15F8:				; CODE XREF: SetupCarShapes+42Dj
		push	word_2B77_A264
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		les	bx, dword ptr g_wWhlMultiRes+10h
		push	es:[bx+Shape2D.dwPosY]
		push	es:[bx+Shape2D.dwPosX]
		les	bx, g_dwWinDefRes2
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	DoMaybePutImage
		add	sp, 8

loc_11B7_162D:				; CODE XREF: SetupCarShapes+369j
					; SetupCarShapes+3A0j ...
		mov	[bp+var_1A], 0
		mov	ax, gameState.carPlayer.field_20
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	cx, 3
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_4], ax
		mov	[bp+var_2], 1
		cmp	ax, 0FFF6h
		jge	short loc_11B7_1654
		mov	[bp+var_2], 0
		jmp	short loc_11B7_165E
; ---------------------------------------------------------------------------

loc_11B7_1654:				; CODE XREF: SetupCarShapes+48Ej
		cmp	[bp+var_4], 0Ah
		jle	short loc_11B7_165E
		mov	[bp+var_2], 2

loc_11B7_165E:				; CODE XREF: SetupCarShapes+494j
					; SetupCarShapes+49Aj
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	al, [bp+var_2]
		cmp	byte ptr word_2B77_5680[bx], al
		jnz	short loc_11B7_1677
		cmp	byte_2B77_9D34,	0
		jnz	short loc_11B7_1677
		jmp	loc_11B7_1716
; ---------------------------------------------------------------------------

loc_11B7_1677:				; CODE XREF: SetupCarShapes+4ADj
					; SetupCarShapes+4B4j
		cmp	g_wVideoFlag4, 0
		jnz	short loc_11B7_1683
		call	DoRenderMouSpr3

loc_11B7_1683:				; CODE XREF: SetupCarShapes+4BEj
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		cmp	word_2B77_5686[bx], 0
		jz	short loc_11B7_16C9
		push	word_2B77_5686[bx]
		push	word_2B77_5682[bx]
		mov	al, byte_2B77_8BD6
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr (g_arrpShape2D+2)[bx]
		push	word ptr g_arrpShape2D[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	word_2B77_5686[bx], 0
		mov	[bp+var_1A], 1

loc_11B7_16C9:				; CODE XREF: SetupCarShapes+4D5j
		mov	al, [bp+var_2]
		cbw
		or	ax, ax
		jz	short loc_11B7_16DE
		cmp	ax, 1
		jz	short loc_11B7_1702
		cmp	ax, 2
		jz	short loc_11B7_170C
		jmp	short loc_11B7_16EE
; ---------------------------------------------------------------------------
		align 2

loc_11B7_16DE:				; CODE XREF: SetupCarShapes+511j
		push	g_wWhlMultiRes+2
		push	g_wWhlMultiRes

loc_11B7_16E6:				; CODE XREF: SetupCarShapes+54Cj
					; SetupCarShapes+556j
		call	MaybePutBitmapOn1
		add	sp, 4

loc_11B7_16EE:				; CODE XREF: SetupCarShapes+51Dj
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	al, [bp+var_2]
		mov	byte ptr word_2B77_5680[bx], al
		mov	[bp+var_18], 1
		jmp	short loc_11B7_171A
; ---------------------------------------------------------------------------
		align 2

loc_11B7_1702:				; CODE XREF: SetupCarShapes+516j
		push	g_wWhlMultiRes+6
		push	g_wWhlMultiRes+4
		jmp	short loc_11B7_16E6
; ---------------------------------------------------------------------------

loc_11B7_170C:				; CODE XREF: SetupCarShapes+51Bj
		push	g_wWhlMultiRes+0Ah
		push	g_wWhlMultiRes+8
		jmp	short loc_11B7_16E6
; ---------------------------------------------------------------------------

loc_11B7_1716:				; CODE XREF: SetupCarShapes+4B6j
		mov	[bp+var_18], 0

loc_11B7_171A:				; CODE XREF: SetupCarShapes+541j
		mov	ax, g_dwCopyOfSimd.ptSpdCenter.y
		cmp	ax, 0FFFFh
		jz	short loc_11B7_1746
		or	ax, ax
		jnz	short loc_11B7_1729
		jmp	loc_11B7_1832
; ---------------------------------------------------------------------------

loc_11B7_1729:				; CODE XREF: SetupCarShapes+566j
		mov	[bp+var_6], 0
		mov	ax, gameState.carPlayer.wTrackGrip
		sub	dx, dx
		mov	cx, 280h	; 640
		div	cx
		mov	si, ax
		cmp	g_dwCopyOfSimd.wSpdNumPoints, si
		jg	short loc_11B7_174C
		mov	si, g_dwCopyOfSimd.wSpdNumPoints
		dec	si
		jmp	short loc_11B7_174C
; ---------------------------------------------------------------------------

loc_11B7_1746:				; CODE XREF: SetupCarShapes+562j
		sub	si, si
		mov	[bp+var_6], 2

loc_11B7_174C:				; CODE XREF: SetupCarShapes+57Fj
					; SetupCarShapes+586j ...
		mov	ax, gameState.carPlayer.wCurRpm
		mov	cl, 7
		shr	ax, cl
		mov	di, ax
		cmp	g_dwCopyOfSimd.cRevNumPoints, di
		jg	short loc_11B7_1760
		mov	di, g_dwCopyOfSimd.cRevNumPoints
		dec	di

loc_11B7_1760:				; CODE XREF: SetupCarShapes+59Bj
		cmp	[bp+var_18], 0
		jnz	short loc_11B7_1787
		cmp	byte_2B77_9D34,	0
		jnz	short loc_11B7_1787
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		cmp	word_2B77_5608[bx], si
		jnz	short loc_11B7_1787
		cmp	word_2B77_55FC[bx], di
		jnz	short loc_11B7_1787
		jmp	loc_11B7_19D0
; ---------------------------------------------------------------------------

loc_11B7_1787:				; CODE XREF: SetupCarShapes+5A6j
					; SetupCarShapes+5ADj ...
		cmp	g_wVideoFlag4, 0
		jnz	short loc_11B7_1793
		call	DoRenderMouSpr3

loc_11B7_1793:				; CODE XREF: SetupCarShapes+5CEj
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		cmp	word_2B77_5686[bx], 0
		jz	short loc_11B7_17D9
		push	word_2B77_5686[bx]
		push	word_2B77_5682[bx]
		mov	al, byte_2B77_8BD6
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr (g_arrpShape2D+2)[bx]
		push	word ptr g_arrpShape2D[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	word_2B77_5686[bx], 0
		mov	[bp+var_1A], 1

loc_11B7_17D9:				; CODE XREF: SetupCarShapes+5E5j
		push	word ptr g_dwWinDefRes1+2
		push	word ptr g_dwWinDefRes1
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		push	g_wWhlMultiRes+0Eh
		push	g_wWhlMultiRes+0Ch
		call	sub_1EA2_53C2
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		mov	word_2B77_5608[bx], si
		mov	bx, [bp+var_20]
		mov	word_2B77_55FC[bx], di
		cmp	[bp+var_6], 1
		jz	short loc_11B7_181C
		jmp	loc_11B7_18E6
; ---------------------------------------------------------------------------

loc_11B7_181C:				; CODE XREF: SetupCarShapes+659j
		mov	[bp+var_8], 0
		cmp	si, 0C8h ; 'È'
		jl	short loc_11B7_1842
		mov	[bp+var_8], 2
		sub	si, 0C8h ; 'È'
		jmp	short loc_11B7_184F
; ---------------------------------------------------------------------------

loc_11B7_1832:				; CODE XREF: SetupCarShapes+568j
		mov	[bp+var_6], 1
		mov	ax, gameState.carPlayer.wTrackGrip
		mov	cl, 8
		shr	ax, cl
		mov	si, ax
		jmp	loc_11B7_174C
; ---------------------------------------------------------------------------

loc_11B7_1842:				; CODE XREF: SetupCarShapes+667j
		cmp	si, 64h	; 'd'
		jl	short loc_11B7_184F
		mov	[bp+var_8], 1
		sub	si, 64h	; 'd'

loc_11B7_184F:				; CODE XREF: SetupCarShapes+672j
					; SetupCarShapes+687j
		cmp	[bp+var_8], 0
		jz	short loc_11B7_187A
		mov	al, g_dwCopyOfSimd.pSpdPoints+1
		sub	ah, ah
		push	ax
		mov	al, g_dwCopyOfSimd.pSpdPoints
		push	ax
		mov	bx, [bp+var_8]
		shl	bx, 1
		shl	bx, 1
		push	(g_wDigMultiRes+2)[bx]
		push	g_wDigMultiRes[bx]
		call	MaybePutImageOr
		add	sp, 8
		mov	[bp+var_1C], 1

loc_11B7_187A:				; CODE XREF: SetupCarShapes+695j
		mov	ax, si
		cwd
		mov	cx, 0Ah
		idiv	cx
		mov	[bp+var_8], ax
		or	ax, ax
		jnz	short loc_11B7_188F
		cmp	[bp+var_1C], 0
		jz	short loc_11B7_18C3

loc_11B7_188F:				; CODE XREF: SetupCarShapes+6C9j
		mov	al, g_dwCopyOfSimd.pSpdPoints+3
		sub	ah, ah
		push	ax
		mov	al, g_dwCopyOfSimd.pSpdPoints+2
		push	ax
		mov	bx, [bp+var_8]
		shl	bx, 1
		shl	bx, 1
		push	(g_wDigMultiRes+2)[bx]
		push	g_wDigMultiRes[bx]
		call	MaybePutImageOr
		add	sp, 8
		mov	ax, [bp+var_8]
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		sub	si, ax
		mov	[bp+var_1C], 1

loc_11B7_18C3:				; CODE XREF: SetupCarShapes+6CFj
		mov	al, g_dwCopyOfSimd.pSpdPoints+5
		sub	ah, ah
		push	ax
		mov	al, g_dwCopyOfSimd.pSpdPoints+4
		push	ax
		mov	bx, si
		shl	bx, 1
		shl	bx, 1
		push	(g_wDigMultiRes+2)[bx]
		push	g_wDigMultiRes[bx]
		call	MaybePutImageOr
		add	sp, 8
		jmp	short loc_11B7_1915
; ---------------------------------------------------------------------------
		align 2

loc_11B7_18E6:				; CODE XREF: SetupCarShapes+65Bj
		cmp	[bp+var_6], 0
		jnz	short loc_11B7_1915
		mov	ax, si
		shl	ax, 1
		mov	[bp+var_20], ax
		push	word_2B77_95F0
		mov	bx, ax
		mov	al, (g_dwCopyOfSimd.pSpdPoints+1)[bx]
		sub	ah, ah
		push	ax
		mov	al, g_dwCopyOfSimd.pSpdPoints[bx]
		push	ax
		push	g_dwCopyOfSimd.ptSpdCenter.y
		push	g_dwCopyOfSimd.ptSpdCenter.x
		call	ImageResetRende
		add	sp, 0Ah

loc_11B7_1915:				; CODE XREF: SetupCarShapes+725j
					; SetupCarShapes+72Cj
		mov	ax, di
		shl	ax, 1
		mov	[bp+var_20], ax
		push	word_2B77_95F0
		mov	bx, ax
		mov	al, (g_dwCopyOfSimd.pRevPoints+1)[bx]
		sub	ah, ah
		push	ax
		mov	al, g_dwCopyOfSimd.pRevPoints[bx]
		push	ax
		push	g_dwCopyOfSimd.ptRevCenter.y
		push	g_dwCopyOfSimd.ptRevCenter.x
		call	ImageResetRende
		add	sp, 0Ah
		mov	al, [bp+var_2]
		cbw
		or	ax, ax
		jz	short loc_11B7_194E
		cmp	ax, 2
		jz	short loc_11B7_197C
		jmp	short loc_11B7_196E
; ---------------------------------------------------------------------------
		align 2

loc_11B7_194E:				; CODE XREF: SetupCarShapes+786j
		push	word ptr g_pShape2D2+2
		push	word ptr g_pShape2D2
		call	MaybePutImageAnd2
		add	sp, 4
		push	word ptr g_pShape2D4+2
		push	word ptr g_pShape2D4

loc_11B7_1966:				; CODE XREF: SetupCarShapes+7D6j
		call	MaybePutImageOr2
		add	sp, 4

loc_11B7_196E:				; CODE XREF: SetupCarShapes+78Dj
		cmp	g_wVideoFlag4, 0
		jz	short loc_11B7_1996
		call	SetupMcgaWnd2
		jmp	short loc_11B7_199B
; ---------------------------------------------------------------------------

loc_11B7_197C:				; CODE XREF: SetupCarShapes+78Bj
		push	word ptr g_pShape2D+2
		push	word ptr g_pShape2D
		call	MaybePutImageAnd2
		add	sp, 4
		push	word ptr g_pShape2D3+2
		push	word ptr g_pShape2D3
		jmp	short loc_11B7_1966
; ---------------------------------------------------------------------------

loc_11B7_1996:				; CODE XREF: SetupCarShapes+7B5j
		call	SetSprite2As1_2

loc_11B7_199B:				; CODE XREF: SetupCarShapes+7BCj
		push	word_2B77_A264
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		les	bx, dword ptr g_wWhlMultiRes+0Ch
		push	es:[bx+Shape2D.dwPosY]
		push	es:[bx+Shape2D.dwPosX]
		les	bx, g_dwWinDefRes1
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	DoMaybePutImage
		add	sp, 8

loc_11B7_19D0:				; CODE XREF: SetupCarShapes+5C6j
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, [bp+var_4]
		cmp	word_2B77_5690[bx], ax
		jnz	short loc_11B7_19F1
		cmp	byte_2B77_9D34,	0
		jnz	short loc_11B7_19F1
		cmp	[bp+var_1A], 0
		jnz	short loc_11B7_19F1
		jmp	loc_11B7_1B30
; ---------------------------------------------------------------------------

loc_11B7_19F1:				; CODE XREF: SetupCarShapes+821j
					; SetupCarShapes+828j ...
		cmp	g_wVideoFlag4, 0
		jnz	short loc_11B7_19FD
		call	DoRenderMouSpr3

loc_11B7_19FD:				; CODE XREF: SetupCarShapes+838j
		push	word_2B77_A264
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	bx, ax
		cmp	word_2B77_5686[bx], 0
		jz	short loc_11B7_1A55
		push	word_2B77_5686[bx]
		push	word_2B77_5682[bx]
		mov	al, byte_2B77_8BD6
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr (g_arrpShape2D+2)[bx]
		push	word ptr g_arrpShape2D[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	word_2B77_5686[bx], 0

loc_11B7_1A55:				; CODE XREF: SetupCarShapes+865j
		cmp	[bp+var_4], 0
		jge	short loc_11B7_1A62
		mov	ax, [bp+var_4]
		neg	ax
		jmp	short loc_11B7_1A65
; ---------------------------------------------------------------------------

loc_11B7_1A62:				; CODE XREF: SetupCarShapes+89Bj
		mov	ax, [bp+var_4]

loc_11B7_1A65:				; CODE XREF: SetupCarShapes+8A2j
		shl	ax, 1
		add	ax, offset g_dwCopyOfSimd.ptSteeringDots
		mov	[bp+var_E], ax
		mov	bx, ax
		mov	al, [bx+1]
		mov	[bp+var_16], al
		mov	al, [bx]
		mov	[bp+var_14], al
		cmp	[bp+var_4], 0
		jge	short loc_11B7_1A89
		sub	al, g_dwCopyOfSimd.ptSteeringDots
		shl	al, 1
		sub	[bp+var_14], al

loc_11B7_1A89:				; CODE XREF: SetupCarShapes+8C0j
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_20], ax
		mov	al, [bp+var_14]
		sub	ah, ah
		les	bx, dword ptr g_wGnobMultiRes+8
		sub	ax, es:[bx+4]
		and	ax, g_wVideoFlag2
		mov	bx, [bp+var_20]
		mov	word_2B77_5682[bx], ax
		mov	al, [bp+var_16]
		sub	ah, ah
		les	bx, dword ptr g_wGnobMultiRes+8
		sub	ax, es:[bx+6]
		mov	bx, [bp+var_20]
		mov	word_2B77_5686[bx], ax
		mov	al, [bp+var_16]
		sub	ah, ah
		les	bx, dword ptr g_wGnobMultiRes+8
		sub	ax, es:[bx+6]
		push	ax
		mov	bx, [bp+var_20]
		push	word_2B77_5682[bx]
		mov	al, byte_2B77_8BD6
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr (g_arrpShape2D+2)[bx]
		push	word ptr g_arrpShape2D[bx]
		call	DoClearImageArea
		add	sp, 8
		mov	al, [bp+var_16]
		sub	ah, ah
		push	ax
		mov	al, [bp+var_14]
		push	ax
		push	word_2B77_5672
		push	word_2B77_5670
		call	DoMaybePutImageAnd
		add	sp, 8
		mov	al, [bp+var_16]
		sub	ah, ah
		push	ax
		mov	al, [bp+var_14]
		push	ax
		push	g_wGnobMultiRes+0Ah
		push	g_wGnobMultiRes+8
		call	DoMaybePutBitmapOr
		add	sp, 8
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	ax, [bp+var_4]
		mov	word_2B77_5690[bx], ax

loc_11B7_1B30:				; CODE XREF: SetupCarShapes+830j
		call	DoUseMousePos
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_1B3C:				; CODE XREF: SetupCarShapes+24j
		push	word ptr g_dwWinDefRes3+2
		push	word ptr g_dwWinDefRes3
		call	ReleaseWindow
		add	sp, 4
		push	word ptr g_dwWinDefRes2+2
		push	word ptr g_dwWinDefRes2
		call	ReleaseWindow
		add	sp, 4
		push	word ptr g_dwWinDefRes1+2
		push	word ptr g_dwWinDefRes1
		call	ReleaseWindow
		add	sp, 4
		push	word ptr g_dwStdbRes+2
		push	word ptr g_dwStdbRes
		call	UnloadResource
		add	sp, 4
		push	word ptr g_dwStdaRes+2
		push	word ptr g_dwStdaRes
		call	UnloadResource
		add	sp, 4
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetupCarShapes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupCarGameEtc	proc far		; CODE XREF: RunGame+96p
					; RplyMouseSpriteStuff+ACAp

var_8		= word ptr -8
var_6		= word ptr -6
pCarCounRes1	= word ptr -4
pCarCounRes2	= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 8
		sub	ax, ax
		mov	word ptr g_pWndSprite+2, ax
		mov	word ptr g_pWndSprite, ax
		mov	ax, 2
		push	ax
		call	EnsureFileExists ; 2 = check for sdtitl.*
		add	sp, 2
		mov	ax, offset g_gameInfo.dwOpponentID
		push	ax
		mov	ax, offset g_gameInfo
		push	ax
		call	LoadCarShapes
		add	sp, 4
		mov	al, byte ptr g_gameInfo.dwPlayerCarID
		mov	byte ptr aCarcoun+3, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+1
		mov	byte ptr aCarcoun+4, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+2
		mov	byte ptr aCarcoun+5, al
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+3
		mov	byte ptr aCarcoun+6, al
		mov	ax, offset aCarcoun ; "carcoun"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pCarCounRes1], ax
		mov	[bp+pCarCounRes2], dx
		sub	ax, ax
		push	ax
		push	dx
		push	[bp+pCarCounRes1]
		call	SetupAeroTrakdata
		add	sp, 6
		push	[bp+pCarCounRes2]
		push	[bp+pCarCounRes1]
		call	DoUnloadResourc
		add	sp, 4
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_11B7_1C63
		mov	al, byte ptr g_gameInfo.dwOpponentID
		mov	byte ptr aCarcoun+3, al
		mov	al, byte ptr g_gameInfo.dwOpponentID+1
		mov	byte ptr aCarcoun+4, al
		mov	al, byte ptr g_gameInfo.dwOpponentID+2
		mov	byte ptr aCarcoun+5, al
		mov	al, byte ptr g_gameInfo.dwOpponentID+3
		mov	byte ptr aCarcoun+6, al
		mov	ax, offset aCarcoun ; "carcoun"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pCarCounRes1], ax
		mov	[bp+pCarCounRes2], dx
		mov	ax, 1
		push	ax
		push	dx
		push	[bp+pCarCounRes1]
		call	SetupAeroTrakdata
		add	sp, 6
		push	[bp+pCarCounRes2]
		push	[bp+pCarCounRes1]
		call	DoUnloadResourc
		add	sp, 4
		mov	ax, 4
		push	ax		; ax = 4 means scan for	oppN.*
		call	EnsureFileExists ; asks	for disk if oppX.res isnt found
		add	sp, 2
		call	SetupOppTrakdata

loc_11B7_1C63:				; CODE XREF: SetupCarGameEtc+76j
		mov	ax, 3
		push	ax
		call	EnsureFileExists
		add	sp, 2
		mov	ax, offset aEng1 ; "eng1"
		push	ax
		mov	ax, 5
		push	ax
		call	LoadResource	; LoadResource type 5 =	voice file
		add	sp, 4
		mov	word ptr g_dwEng1Res, ax
		mov	word ptr g_dwEng1Res+2,	dx
		mov	ax, offset aEng	; "eng"
		push	ax
		mov	ax, 6
		push	ax
		call	LoadResource	; type 6 = sfx file
		add	sp, 4
		mov	word ptr g_dwEngRes, ax
		mov	word ptr g_dwEngRes+2, dx
		call	AddAudioDrvTime
		push	word ptr g_dwEngRes+2
		push	word ptr g_dwEngRes
		push	word ptr g_dwEng1Res+2
		push	word ptr g_dwEng1Res
		mov	ax, offset g_pAudTimEng1
		push	ds
		push	ax
		mov	ax, 21h
		push	ax
		call	InitSfxEngine
		add	sp, 0Eh
		mov	g_wSfxEng1Resul, ax
		mov	g_cIniEng1Flag1, 0
		mov	g_cIniEng1Flag2, 0
		mov	g_cIniEng1Flag3, 0
		cmp	g_gameInfo.cOpponentType, 0
		jz	short loc_11B7_1D00
		push	word ptr g_dwEngRes+2
		push	word ptr g_dwEngRes
		push	word ptr g_dwEng1Res+2
		push	word ptr g_dwEng1Res
		mov	ax, offset g_pAudTimOppEng
		push	ds
		push	ax
		mov	ax, 20h
		push	ax
		call	InitSfxEngine
		add	sp, 0Eh
		mov	g_wSfxOppEngResul, ax

loc_11B7_1D00:				; CODE XREF: SetupCarGameEtc+148j
		mov	g_wIniEng2Flag1, 0
		mov	g_wIniEng2Flag2, 0
		mov	g_wIniEng2Flag3, 0
		mov	ax, offset aFontled_fnt	; "fontled.fnt"
		push	ax
		sub	ax, ax
		push	ax
		call	LoadResource	; LoadResource type 0 =	binary
		add	sp, 4
		mov	word ptr g_dwFontLedRes, ax
		mov	word ptr g_dwFontLedRes+2, dx
		mov	ax, g_wTimerFlag1
		mov	g_wTimerFlag5, ax
		call	sub_9F1_186
		cmp	g_cTimerOverrun, 0
		jnz	short loc_11B7_1D44
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr SetupCarShapes
		add	sp, 2

loc_11B7_1D44:				; CODE XREF: SetupCarGameEtc+1A6j
		cmp	g_cTimerOverrun, 0
		jnz	short loc_11B7_1D6E
		mov	ax, offset aSdgame ; "sdgame"
		push	ax
		mov	ax, 3
		push	ax
		call	LoadResource	; type 3 = 2d shape
		add	sp, 4
		mov	word ptr g_dwSdgameRes,	ax
		mov	word ptr g_dwSdgameRes+2, dx
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6

loc_11B7_1D6E:				; CODE XREF: SetupCarGameEtc+1B7j
		mov	ax, offset aGame ; "game"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	word ptr g_dwGameRes, ax
		mov	word ptr g_dwGameRes+2,	dx
		mov	ax, offset aPlan ; "plan"
		push	ax
		push	dx
		push	word ptr g_dwGameRes
		call	AltLocateShape
		add	sp, 6
		mov	word ptr g_dwPlanRes, ax
		mov	word ptr g_dwPlanRes+2,	dx
		mov	ax, offset aWall ; "wall"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	AltLocateShape
		add	sp, 6
		mov	word ptr g_dwWallRes, ax
		mov	word ptr g_dwWallRes+2,	dx
		call	LoadSdgame2Shap
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+TrackInfo.cSkybox]
		sub	ah, ah
		push	ax
		call	LoadSkybox
		add	sp, 2
		call	LoadGame3dShpes
		or	ax, ax
		jz	short loc_11B7_1DDE

loc_11B7_1DD6:				; CODE XREF: SetupCarGameEtc+27Fj
					; SetupCarGameEtc+284j
		mov	ax, 1
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_1DDE:				; CODE XREF: SetupCarGameEtc+242j
		cmp	g_wVideoFlag4, 0
		jnz	short loc_11B7_1E33
		mov	ax, g_wSetHandlers
		imul	g_wVideoFlag3
		cwd
		push	dx
		push	ax
		mov	ax, 0FA00h
		sub	dx, dx
		push	dx
		push	ax
		call	__aFldiv
		add	ax, 12h
		adc	dx, 0
		mov	[bp+var_8], ax
		mov	[bp+var_6], dx
		call	GetResDiffScale
		cmp	dx, [bp+var_6]
		jg	short loc_11B7_1E18
		jl	short loc_11B7_1DD6
		cmp	ax, [bp+var_8]
		jbe	short loc_11B7_1DD6

loc_11B7_1E18:				; CODE XREF: SetupCarGameEtc+27Dj
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx

loc_11B7_1E33:				; CODE XREF: SetupCarGameEtc+251j
		mov	byte_2B77_AC70,	0
		mov	byte_2B77_9EC4,	0FFh
		sub	ax, ax
		mov	sp, bp
		pop	bp
		retf
SetupCarGameEtc	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


UnloadGameResou	proc far		; CODE XREF: RunGame+9Ep RunGame+867p	...
		cmp	g_wVideoFlag4, 0
		jnz	short loc_11B7_1E64
		mov	ax, word ptr g_pWndSprite
		or	ax, word ptr g_pWndSprite+2
		jz	short loc_11B7_1E64
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4

loc_11B7_1E64:				; CODE XREF: UnloadGameResou+5j
					; UnloadGameResou+Ej
		call	UnloadGameResources
		call	UnloadSkybox
		call	sub_9F1_3A1A
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	DoUnloadResourc
		add	sp, 4
		cmp	g_cTimerOverrun, 0
		jnz	short loc_11B7_1EA5
		push	word ptr g_dwSdgameRes+2
		push	word ptr g_dwSdgameRes
		call	UnloadResource
		add	sp, 4
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr SetupCarShapes
		add	sp, 2

loc_11B7_1EA5:				; CODE XREF: UnloadGameResou+44j
		push	word ptr g_dwFontLedRes+2
		push	word ptr g_dwFontLedRes
		call	UnloadResource
		add	sp, 4
		call	DelAudDrvTimer
		push	word ptr g_dwEngRes+2
		push	word ptr g_dwEngRes
		call	UnloadResource
		add	sp, 4
		push	word ptr g_dwEng1Res+2
		push	word ptr g_dwEng1Res
		call	UnloadResource
		add	sp, 4
		call	UnloadCurCar
		retf
UnloadGameResou	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MouseMinMaxPos	proc far		; CODE XREF: RunGame+13Bp RunGame+660p ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		cmp	[bp+arg_0], 0
		jz	short loc_11B7_1F12
		mov	ax, 0C8h
		push	ax
		mov	ax, 131h
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 0Fh
		push	ax
		call	SetMouseMinMax
		add	sp, 8
		mov	ax, 64h
		push	ax
		mov	ax, 0A0h
		push	ax
		call	SetMousePositio
		add	sp, 4
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_1F12:				; CODE XREF: MouseMinMaxPos+7j
		mov	ax, 0C8h
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		call	SetMouseMinMax
		add	sp, 8
		pop	bp
		retf
MouseMinMaxPos	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UpdateTrakdata16Or proc	far		; CODE XREF: RunGame+220p

var_A		= byte ptr -0Ah
var_8		= byte ptr -8
var_6		= byte ptr -6

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		mov	si, gameState.wGameFrame
		and	si, 3Fh
		cmp	byte_2B77_8B7A[si], 0
		jnz	short loc_11B7_1F41
		jmp	loc_11B7_1FD5
; ---------------------------------------------------------------------------

loc_11B7_1F41:				; CODE XREF: UpdateTrakdata16Or+14j
		mov	al, byte_2B77_8B22[si] ; 40h bytes long	table
		cbw
		mov	di, ax
		mov	ax, gameState.carPlayer.wTrackGrip2
		mov	cl, 0Ah
		shr	ax, cl
		and	al, 0FCh
		mov	[bp+var_8], al
		cbw
		mov	bx, ax
		add	bx, g_wCvxTimerFlag
		mov	al, [bx+1]
		mov	[bp+var_A], al
		cmp	gameState.carPlayer.field_20, di
		jge	short loc_11B7_1F70
		cmp	gameState.carPlayer.field_20, 0FFFFh
		jge	short loc_11B7_1F82
		jmp	short loc_11B7_1F7D
; ---------------------------------------------------------------------------

loc_11B7_1F70:				; CODE XREF: UpdateTrakdata16Or+3Dj
		cmp	gameState.carPlayer.field_20, di
		jle	short loc_11B7_1F82
		cmp	gameState.carPlayer.field_20, 1
		jle	short loc_11B7_1F82

loc_11B7_1F7D:				; CODE XREF: UpdateTrakdata16Or+46j
		mov	cl, 2
		shl	[bp+var_A], cl

loc_11B7_1F82:				; CODE XREF: UpdateTrakdata16Or+44j
					; UpdateTrakdata16Or+4Cj ...
		cmp	gameState.carPlayer.field_20, di
		jle	short loc_11B7_1F9C
		mov	al, [bp+var_A]
		cbw
		mov	cx, gameState.carPlayer.field_20
		sub	cx, ax
		cmp	cx, di
		jl	short loc_11B7_1F9C
		mov	[bp+var_6], 8
		jmp	short loc_11B7_1FB8
; ---------------------------------------------------------------------------

loc_11B7_1F9C:				; CODE XREF: UpdateTrakdata16Or+5Ej
					; UpdateTrakdata16Or+6Cj
		cmp	gameState.carPlayer.field_20, di
		jge	short loc_11B7_1FB4
		mov	al, [bp+var_A]
		cbw
		add	ax, gameState.carPlayer.field_20
		cmp	ax, di
		jg	short loc_11B7_1FB4
		mov	[bp+var_6], 4
		jmp	short loc_11B7_1FB8
; ---------------------------------------------------------------------------

loc_11B7_1FB4:				; CODE XREF: UpdateTrakdata16Or+78j
					; UpdateTrakdata16Or+84j
		mov	[bp+var_6], 0

loc_11B7_1FB8:				; CODE XREF: UpdateTrakdata16Or+72j
					; UpdateTrakdata16Or+8Aj
		cmp	[bp+var_6], 0
		jz	short loc_11B7_1FD0
		mov	bx, gameState.wGameFrame
		add	bx, word ptr g_ppTrakdata16
		mov	es, word ptr g_ppTrakdata16+2
		mov	al, [bp+var_6]
		or	es:[bx], al

loc_11B7_1FD0:				; CODE XREF: UpdateTrakdata16Or+94j
		mov	byte_2B77_8B7A[si], 0

loc_11B7_1FD5:				; CODE XREF: UpdateTrakdata16Or+16j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
UpdateTrakdata16Or endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RplyMouseSpriteStuff proc far		; CODE XREF: RunGame+46Bp RunGame+66Cp ...

var_44		= word ptr -44h
var_42		= word ptr -42h
var_40		= byte ptr -40h
var_3E		= byte ptr -3Eh
var_3D		= byte ptr -3Dh
var_3C		= byte ptr -3Ch
var_3B		= byte ptr -3Bh
var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
var_34		= byte ptr -34h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_20		= byte ptr -20h
var_1E		= byte ptr -1Eh
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_4		= word ptr -4
var_2		= byte ptr -2
p_dwMode	= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 44h
		push	di
		push	si
		mov	ax, [bp+p_dwMode]
		or	ax, ax
		jz	short loc_11B7_2000 ; load rplyres, set	arg2=4,	reset, and quit
		cmp	ax, 1
		jz	short loc_11B7_2036 ; mouse font stuff
		cmp	ax, 2
		jz	short loc_11B7_201D ; reset and	quit
		cmp	ax, 3
		jnz	short loc_11B7_1FFD ; just end
		jmp	loc_11B7_2448	; inputscheckin	++
; ---------------------------------------------------------------------------

loc_11B7_1FFD:				; CODE XREF: RplyMouseSpriteStuff+1Cj
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_2000:
		mov	ax, offset g_wRplyManyRes
		push	ax
		mov	ax, offset aRplyrpicrpacrp ; "rplyrpicrpacrpmcrptcbof6bof5bof4bof3bof"...
		push	ax
		push	word ptr g_dwSdgameRes+2
		push	word ptr g_dwSdgameRes
		call	LocateManyResou
		add	sp, 8
		mov	[bp+arg_2], 4

loc_11B7_201D:				; CODE XREF: RplyMouseSpriteStuff+17j
		sub	si, si

loc_11B7_201F:				; CODE XREF: RplyMouseSpriteStuff+4Cj
		mov	byte ptr unk_2B77_56FA[si], 0
		inc	si
		cmp	si, 9		; skrive 0 p† de 9 forste bytene
		jl	short loc_11B7_201F
		mov	bx, [bp+arg_2]
		mov	byte ptr unk_2B77_56FA[bx], 1 ;	skriv en p† der	arg2 sier (0..8?)
		jmp	_EndFunc
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2036:				; CODE XREF: RplyMouseSpriteStuff+12j
		mov	al, byte_2B77_8BBA
		cbw
		mov	[bp+var_42], ax
		mov	bx, ax
		cmp	byte ptr word_2B77_9268[bx], 0
		jz	short loc_11B7_2049
		jmp	loc_11B7_20F6
; ---------------------------------------------------------------------------

loc_11B7_2049:				; CODE XREF: RplyMouseSpriteStuff+68j
		mov	byte ptr word_2B77_9268[bx], 1
		mov	bx, [bp+var_42]
		mov	byte ptr unk_2B77_5704[bx], 0FFh
		mov	bx, [bp+var_42]
		mov	byte ptr unk_2B77_5698[bx], 0FFh
		sub	si, si

loc_11B7_2060:				; CODE XREF: RplyMouseSpriteStuff+99j
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	byte ptr unk_2B77_570A[bx], 0
		inc	si
		cmp	si, 9
		jl	short loc_11B7_2060
		call	DoRenderMouSpr3
		push	g_wRplyManyRes+2
		push	g_wRplyManyRes
		call	RplyManySprite
		add	sp, 4
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_42], ax
		mov	bx, ax
		mov	word ptr unk_2B77_569A[bx], 0FFFFh
		mov	bx, [bp+var_42]
		mov	word ptr unk_2B77_5706[bx], 0FFFFh
		mov	ax, 1
		push	ax
		mov	ax, g_gameInfo.wRecordedFrames
		add	ax, g_wResetOnCvxTr
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FormatString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		push	word ptr g_dwFontLedRes+2
		push	word ptr g_dwFontLedRes
		call	SetFontDefImpl
		add	sp, 4
		mov	ax, 0BBh ; '»'
		push	ax
		mov	ax, 0D8h ; 'Ø'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		call	SetFontDef

loc_11B7_20F6:				; CODE XREF: RplyMouseSpriteStuff+6Aj
		mov	ax, [bp+arg_4]
		add	ax, g_wResetOnCvxTr
		mov	[bp+var_42], ax
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		add	ax, offset unk_2B77_569A
		mov	[bp+var_44], ax
		mov	bx, ax
		mov	ax, [bp+var_42]
		cmp	[bx], ax
		jz	short loc_11B7_2167
		mov	[bx], ax
		mov	ax, 1
		push	ax
		push	[bp+var_42]
		mov	ax, offset g_pTempByte
		push	ax
		call	FormatString
		add	sp, 6
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		call	DoRenderMouSpr3
		push	word ptr g_dwFontLedRes+2
		push	word ptr g_dwFontLedRes
		call	SetFontDefImpl
		add	sp, 4
		mov	ax, 0BBh ; '»'
		push	ax
		mov	ax, 98h	; '˜'
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		call	SetFontDef

loc_11B7_2167:				; CODE XREF: RplyMouseSpriteStuff+137j
		mov	al, byte_2B77_8BBA
		cbw
		mov	[bp+var_44], ax
		mov	bx, ax
		mov	al, g_cCameraMode
		cmp	byte ptr unk_2B77_5704[bx], al
		jz	short loc_11B7_21D6
		mov	byte ptr unk_2B77_5704[bx], al
		mov	bx, [bp+var_44]
		shl	bx, 1
		mov	word ptr unk_2B77_5706[bx], 0FFFFh
		call	DoRenderMouSpr3
		mov	al, g_cCameraMode
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	(g_wRplyManyRes+6)[bx]
		push	(g_wRplyManyRes+4)[bx]
		call	RplyManySprite
		add	sp, 4
		mov	al, g_cCameraMode
		cbw
		mov	bx, ax
		mov	al, g_pcCamTable[bx]
		mov	byte ptr [bp+var_42], al
		mov	al, byte_2B77_326B
		cmp	byte ptr [bp+var_42], al
		jge	short loc_11B7_21C2
		mov	al, byte ptr [bp+var_42]
		mov	byte_2B77_326B,	al

loc_11B7_21C2:				; CODE XREF: RplyMouseSpriteStuff+1DEj
		mov	al, byte_2B77_8BBA
		cbw
		add	ax, offset unk_2B77_5698
		mov	[bp+var_44], ax
		mov	bx, ax
		cmp	byte ptr [bx], 6
		jle	short loc_11B7_21D6
		mov	byte ptr [bx], 0FFh

loc_11B7_21D6:				; CODE XREF: RplyMouseSpriteStuff+19Bj
					; RplyMouseSpriteStuff+1F5j
		cmp	g_gameInfo.wRecordedFrames, 0
		jnz	short loc_11B7_21E4
		sub	si, si
		sub	di, di
		jmp	short loc_11B7_2224
; ---------------------------------------------------------------------------
		align 2

loc_11B7_21E4:				; CODE XREF: RplyMouseSpriteStuff+1FFj
		mov	ax, g_gameInfo.wRecordedFrames
		cwd
		push	dx
		push	ax
		mov	ax, 6Eh	; 'n'
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_2]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	si, ax
		mov	ax, g_gameInfo.wRecordedFrames
		cwd
		push	dx
		push	ax
		mov	ax, 6Eh	; 'n'
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_4]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		mov	di, ax

loc_11B7_2224:				; CODE XREF: RplyMouseSpriteStuff+205j
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_44], ax
		mov	bx, ax
		cmp	word ptr unk_2B77_5706[bx], si
		jnz	short loc_11B7_223B
		cmp	word ptr unk_2B77_5694[bx], di
		jz	short loc_11B7_22AA

loc_11B7_223B:				; CODE XREF: RplyMouseSpriteStuff+257j
		call	DoRenderMouSpr3
		mov	al, byte_2B77_8BBA
		cbw
		shl	ax, 1
		mov	[bp+var_44], ax
		mov	bx, ax
		mov	word ptr unk_2B77_5706[bx], si
		mov	bx, [bp+var_44]
		mov	word ptr unk_2B77_5694[bx], di
		push	word_2B77_508C
		mov	ax, 6
		push	ax
		mov	ax, 74h	; 't'
		push	ax
		mov	ax, 0B1h ; '±'
		push	ax
		mov	ax, 9Ah	; 'š'
		push	ax
		call	SpriteOp
		add	sp, 0Ah
		push	g_wFontFlag
		mov	ax, 6
		push	ax
		push	ax
		mov	ax, 0B1h ; '±'
		push	ax
		lea	ax, [si+9Ah]
		push	ax
		call	SpriteOp
		add	sp, 0Ah
		push	word_2B77_508E
		mov	ax, 0B6h ; '¶'
		push	ax
		lea	ax, [di+9Fh]
		push	ax
		mov	ax, 0B1h ; '±'
		push	ax
		lea	ax, [di+9Ah]
		push	ax
		call	sub_261B_C
		add	sp, 0Ah

loc_11B7_22AA:				; CODE XREF: RplyMouseSpriteStuff+25Dj
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	al, byte_2B77_326B
		cmp	byte ptr unk_2B77_5698[bx], al
		jz	short loc_11B7_22F8

loc_11B7_22B9:				; CODE XREF: RplyMouseSpriteStuff+34Bj
		call	DoRenderMouSpr3
		mov	al, byte_2B77_8BBA
		cbw
		mov	[bp+var_44], ax
		mov	bx, ax
		cmp	byte ptr unk_2B77_5698[bx], 0FFh
		jnz	short loc_11B7_22D1
		jmp	loc_11B7_2356
; ---------------------------------------------------------------------------

loc_11B7_22D1:				; CODE XREF: RplyMouseSpriteStuff+2F0j
		mov	al, byte ptr unk_2B77_5698[bx]
		cbw
		mov	[bp+var_42], ax
		mov	bx, ax
		shl	bx, 1
		add	bx, [bp+var_44]
		cmp	byte ptr unk_2B77_570A[bx], 0
		jz	short loc_11B7_232A
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	(g_wRplyManyRes+3Ah)[bx]
		push	(g_wRplyManyRes+38h)[bx]
		jmp	short loc_11B7_2343
; ---------------------------------------------------------------------------
		align 2

loc_11B7_22F8:				; CODE XREF: RplyMouseSpriteStuff+2DBj
		mov	[bp+var_20], 0
		jmp	short loc_11B7_2301
; ---------------------------------------------------------------------------

loc_11B7_22FE:				; CODE XREF: RplyMouseSpriteStuff+349j
		inc	[bp+var_20]

loc_11B7_2301:				; CODE XREF: RplyMouseSpriteStuff+320j
		cmp	[bp+var_20], 7
		jl	short loc_11B7_230A
		jmp	loc_11B7_2440
; ---------------------------------------------------------------------------

loc_11B7_230A:				; CODE XREF: RplyMouseSpriteStuff+329j
		mov	al, [bp+var_20]
		cbw
		mov	[bp+var_44], ax
		mov	bx, ax
		mov	al, byte ptr unk_2B77_56FA[bx]
		mov	cx, ax
		mov	al, byte_2B77_8BBA
		cbw
		shl	bx, 1
		add	bx, ax
		cmp	byte ptr unk_2B77_570A[bx], cl
		jz	short loc_11B7_22FE
		jmp	short loc_11B7_22B9
; ---------------------------------------------------------------------------
		align 2

loc_11B7_232A:				; CODE XREF: RplyMouseSpriteStuff+309j
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	al, byte ptr unk_2B77_5698[bx]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	(g_wRplyManyRes+16h)[bx]
		push	(g_wRplyManyRes+14h)[bx]

loc_11B7_2343:				; CODE XREF: RplyMouseSpriteStuff+319j
		call	RplyManySprite
		add	sp, 4
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	byte ptr unk_2B77_5698[bx], 0FFh

loc_11B7_2356:				; CODE XREF: RplyMouseSpriteStuff+2F2j
		mov	[bp+var_20], 0

loc_11B7_235A:				; CODE XREF: RplyMouseSpriteStuff+3D3j
		mov	al, [bp+var_20]
		cbw
		mov	[bp+var_44], ax
		mov	bx, ax
		cmp	byte ptr unk_2B77_56FA[bx], 0
		jnz	short loc_11B7_23A8
		mov	al, byte ptr unk_2B77_56FA[bx]
		mov	cx, ax
		mov	al, byte_2B77_8BBA
		cbw
		shl	bx, 1
		add	bx, ax
		cmp	byte ptr unk_2B77_570A[bx], cl
		jz	short loc_11B7_23A8
		mov	bx, [bp+var_44]
		shl	bx, 1
		shl	bx, 1
		push	(g_wRplyManyRes+16h)[bx]
		push	(g_wRplyManyRes+14h)[bx]
		call	RplyManySprite
		add	sp, 4
		mov	al, [bp+var_20]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	al, byte_2B77_8BBA
		cbw
		add	bx, ax
		mov	byte ptr unk_2B77_570A[bx], 0

loc_11B7_23A8:				; CODE XREF: RplyMouseSpriteStuff+38Cj
					; RplyMouseSpriteStuff+3A0j
		inc	[bp+var_20]
		cmp	[bp+var_20], 7
		jl	short loc_11B7_235A
		mov	[bp+var_20], 0

loc_11B7_23B5:				; CODE XREF: RplyMouseSpriteStuff+427j
		mov	al, [bp+var_20]
		cbw
		mov	[bp+var_44], ax
		mov	bx, ax
		cmp	byte ptr unk_2B77_56FA[bx], 0
		jz	short loc_11B7_23FC
		mov	al, byte_2B77_8BBA
		cbw
		shl	bx, 1
		add	bx, ax
		mov	byte ptr unk_2B77_570A[bx], 1
		mov	bx, [bp+var_44]
		shl	bx, 1
		shl	bx, 1
		push	(g_wRplyManyRes+3Ah)[bx]
		push	(g_wRplyManyRes+38h)[bx]
		call	RplyManySprite
		add	sp, 4
		mov	al, [bp+var_20]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	al, byte_2B77_8BBA
		cbw
		add	bx, ax
		mov	byte ptr unk_2B77_570A[bx], 1

loc_11B7_23FC:				; CODE XREF: RplyMouseSpriteStuff+3E7j
		inc	[bp+var_20]
		cmp	[bp+var_20], 7
		jl	short loc_11B7_23B5
		mov	al, byte_2B77_8BBA
		cbw
		mov	bx, ax
		mov	al, byte_2B77_326B
		mov	byte ptr unk_2B77_5698[bx], al
		cmp	byte_2B77_326B,	0FFh
		jz	short loc_11B7_2440
		mov	al, byte_2B77_326B
		cbw
		shl	ax, 1
		mov	[bp+var_44], ax
		push	word_2B77_508E
		mov	bx, ax
		push	word ptr unk_2B77_32CE[bx]
		push	word ptr unk_2B77_32AA[bx]
		push	word ptr unk_2B77_32BC[bx]
		push	word ptr unk_2B77_3298[bx]
		call	sub_261B_C
		add	sp, 0Ah

loc_11B7_2440:				; CODE XREF: RplyMouseSpriteStuff+32Bj
					; RplyMouseSpriteStuff+43Bj
		call	DoUseMousePos
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_2448:				; CODE XREF: RplyMouseSpriteStuff+1Ej
		mov	al, g_cCameraMode
		cbw
		mov	bx, ax
		mov	al, g_pcCamTable[bx]
		mov	byte ptr [bp+var_44], al
		mov	al, byte_2B77_326B
		cmp	byte ptr [bp+var_44], al
		jge	short loc_11B7_246A
		cmp	g_cCameraMode, 2
		jz	short loc_11B7_246A
		mov	al, byte ptr [bp+var_44]
		mov	byte_2B77_326B,	al

loc_11B7_246A:				; CODE XREF: RplyMouseSpriteStuff+47Fj
					; RplyMouseSpriteStuff+486j
		call	SetSprite2As1
		cmp	g_wVideoFlag4, 0
		jz	short loc_11B7_247E
		mov	al, byte_2B77_8BD6
		xor	al, 1
		mov	byte_2B77_8BBA,	al

loc_11B7_247E:				; CODE XREF: RplyMouseSpriteStuff+498j
					; RplyMouseSpriteStuff+7AEj
		call	DoGetTimerDelta
		push	ax
		call	InputsChecking
		add	sp, 2
		mov	[bp+var_16], ax
		mov	ax, offset unk_2B77_32CE
		push	ax
		mov	ax, offset unk_2B77_32BC
		push	ax
		mov	ax, offset unk_2B77_32AA
		push	ax
		mov	ax, offset unk_2B77_3298
		push	ax
		mov	al, g_cCameraMode
		cbw
		mov	bx, ax
		mov	al, g_pcCamTable[bx]
		cbw
		inc	ax
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_20], al
		cmp	al, 0FFh
		jnz	short loc_11B7_24BE
		jmp	loc_11B7_2568
; ---------------------------------------------------------------------------

loc_11B7_24BE:				; CODE XREF: RplyMouseSpriteStuff+4DDj
		mov	al, byte_2B77_326B
		cmp	[bp+var_20], al
		jz	short loc_11B7_24D1
		cmp	[bp+var_16], 0
		jnz	short loc_11B7_24D1
		mov	[bp+var_16], 1

loc_11B7_24D1:				; CODE XREF: RplyMouseSpriteStuff+4E8j
					; RplyMouseSpriteStuff+4EEj
		mov	al, [bp+var_20]
		mov	byte_2B77_326B,	al
		cmp	[bp+var_16], 20h ; ' '
		jz	short loc_11B7_24E6
		cmp	[bp+var_16], 0Dh
		jz	short loc_11B7_24E6
		jmp	loc_11B7_259C
; ---------------------------------------------------------------------------

loc_11B7_24E6:				; CODE XREF: RplyMouseSpriteStuff+4FFj
					; RplyMouseSpriteStuff+505j
		cmp	byte_2B77_326B,	7
		jge	short loc_11B7_24F0
		jmp	loc_11B7_259C
; ---------------------------------------------------------------------------

loc_11B7_24F0:				; CODE XREF: RplyMouseSpriteStuff+50Fj
		jnz	short loc_11B7_2512
		mov	ax, word_2B77_32CA
		add	ax, word_2B77_32DC
		sar	ax, 1
		cmp	ax, g_wMouYPos
		jge	short loc_11B7_250A

loc_11B7_2501:				; CODE XREF: RplyMouseSpriteStuff+572j
		mov	[bp+var_16], 5000h
		jmp	loc_11B7_259C
; ---------------------------------------------------------------------------
		align 2

loc_11B7_250A:				; CODE XREF: RplyMouseSpriteStuff+523j
					; RplyMouseSpriteStuff+568j
		mov	[bp+var_16], 4800h
		jmp	loc_11B7_259C
; ---------------------------------------------------------------------------

loc_11B7_2512:				; CODE XREF: RplyMouseSpriteStuff:loc_11B7_24F0j
		mov	ax, word_2B77_32CC
		add	ax, word_2B77_32DE
		sar	ax, 1
		sub	ax, g_wMouYPos
		push	ax
		mov	ax, g_wMouXPos
		mov	cx, word_2B77_32A8
		add	cx, word_2B77_32BA
		sar	cx, 1
		sub	ax, cx
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		add	ax, 80h	; '€'
		and	ah, 3
		mov	cl, 8
		shr	ax, cl
		or	ax, ax
		jz	short loc_11B7_250A
		cmp	ax, 1
		jz	short loc_11B7_2558
		cmp	ax, 2
		jz	short loc_11B7_2501
		cmp	ax, 3
		jz	short loc_11B7_2560
		jmp	short loc_11B7_259C
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2558:				; CODE XREF: RplyMouseSpriteStuff+56Dj
		mov	[bp+var_16], 4D00h
		jmp	short loc_11B7_259C
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2560:				; CODE XREF: RplyMouseSpriteStuff+577j
		mov	[bp+var_16], 4B00h
		jmp	short loc_11B7_259C
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2568:				; CODE XREF: RplyMouseSpriteStuff+4DFj
		mov	ax, offset unk_2B77_32E6
		push	ax
		mov	ax, offset unk_2B77_32E4
		push	ax
		mov	ax, offset unk_2B77_32E2
		push	ax
		mov	ax, offset unk_2B77_32E0
		push	ax
		mov	ax, 1
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_20], al
		or	al, al
		jnz	short loc_11B7_259C
		cmp	[bp+var_16], 20h ; ' '
		jz	short loc_11B7_2597
		cmp	[bp+var_16], 0Dh
		jnz	short loc_11B7_259C

loc_11B7_2597:				; CODE XREF: RplyMouseSpriteStuff+5B3j
		mov	[bp+var_16], 63h ; 'c'

loc_11B7_259C:				; CODE XREF: RplyMouseSpriteStuff+507j
					; RplyMouseSpriteStuff+511j ...
		cmp	[bp+var_16], 0
		jz	short loc_11B7_25B9
		cmp	[bp+var_16], 1Bh
		jz	short loc_11B7_25B9
		push	[bp+var_16]
		push	cs
		call	near ptr sub_11B7_88A
		add	sp, 2
		or	al, al
		jz	short loc_11B7_25B9
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_25B9:				; CODE XREF: RplyMouseSpriteStuff+5C4j
					; RplyMouseSpriteStuff+5CAj ...
		cmp	g_cGameFlag2, 0
		jnz	short loc_11B7_25EA
		cmp	[bp+var_16], 0
		jnz	short loc_11B7_25EA
		cmp	g_cGameMode3, 0
		jnz	short loc_11B7_25D0
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_25D0:				; CODE XREF: RplyMouseSpriteStuff+5EFj
					; RplyMouseSpriteStuff+11B4j
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_25EA:				; CODE XREF: RplyMouseSpriteStuff+5E2j
					; RplyMouseSpriteStuff+5E8j
		cmp	g_cGameMode3, 0
		jnz	short loc_11B7_25FC
		mov	byte_2B77_9EC4,	0FFh
		mov	word_2B77_927A,	0FFFFh

loc_11B7_25FC:				; CODE XREF: RplyMouseSpriteStuff+613j
		cmp	g_cGameFlag2, 0
		jz	short loc_11B7_2623
		cmp	byte_2B77_56FD,	0
		jnz	short loc_11B7_2611
		cmp	byte_2B77_56FC,	0
		jz	short loc_11B7_2623

loc_11B7_2611:				; CODE XREF: RplyMouseSpriteStuff+62Cj
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6

loc_11B7_2623:				; CODE XREF: RplyMouseSpriteStuff+625j
					; RplyMouseSpriteStuff+633j
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		mov	[bp+var_40], 0
		mov	ax, 1Dh
		push	ax
		call	GetKeyStatus
		add	sp, 2
		or	ax, ax
		jnz	short loc_11B7_2658
		cmp	byte_2B77_326B,	8
		jnz	short loc_11B7_265C
		test	byte ptr g_wKbOrJoyFlag, 30h
		jz	short loc_11B7_265C

loc_11B7_2658:				; CODE XREF: RplyMouseSpriteStuff+66Cj
		mov	[bp+var_40], 1

loc_11B7_265C:				; CODE XREF: RplyMouseSpriteStuff+673j
					; RplyMouseSpriteStuff+67Aj
		cmp	[bp+var_40], 0
		jz	short loc_11B7_268E
		mov	ax, [bp+var_16]
		cmp	ax, 2Bh	; '+'
		jnz	short loc_11B7_266D
		jmp	loc_11B7_272C
; ---------------------------------------------------------------------------

loc_11B7_266D:				; CODE XREF: RplyMouseSpriteStuff+68Cj
		cmp	ax, 2Dh	; '-'
		jnz	short loc_11B7_2675
		jmp	loc_11B7_26FE
; ---------------------------------------------------------------------------

loc_11B7_2675:				; CODE XREF: RplyMouseSpriteStuff+694j
		cmp	ax, 4800h
		jz	short loc_11B7_26D2
		cmp	ax, 4B00h
		jz	short loc_11B7_26C6
		cmp	ax, 4D00h
		jz	short loc_11B7_26BA
		cmp	ax, 5000h
		jz	short loc_11B7_26E8

loc_11B7_2689:				; CODE XREF: RplyMouseSpriteStuff+6FFj
					; RplyMouseSpriteStuff+715j ...
		mov	[bp+var_16], 0

loc_11B7_268E:				; CODE XREF: RplyMouseSpriteStuff+684j
		mov	ax, [bp+var_16]
		cmp	ax, 2Bh	; '+'
		jnz	short loc_11B7_2699
		jmp	loc_11B7_272C
; ---------------------------------------------------------------------------

loc_11B7_2699:				; CODE XREF: RplyMouseSpriteStuff+6B8j
		jbe	short loc_11B7_269E
		jmp	loc_11B7_31C2
; ---------------------------------------------------------------------------

loc_11B7_269E:				; CODE XREF: RplyMouseSpriteStuff:loc_11B7_2699j
		cmp	ax, 0Dh
		jnz	short loc_11B7_26A6
		jmp	loc_11B7_27C4
; ---------------------------------------------------------------------------

loc_11B7_26A6:				; CODE XREF: RplyMouseSpriteStuff+6C5j
		cmp	ax, 1Bh
		jnz	short loc_11B7_26AE
		jmp	loc_11B7_27D6
; ---------------------------------------------------------------------------

loc_11B7_26AE:				; CODE XREF: RplyMouseSpriteStuff+6CDj
		cmp	ax, 20h	; ' '
		jnz	short loc_11B7_26B6
		jmp	loc_11B7_27C4
; ---------------------------------------------------------------------------

loc_11B7_26B6:				; CODE XREF: RplyMouseSpriteStuff+6D5j
		jmp	loc_11B7_2777
; ---------------------------------------------------------------------------
		align 2

loc_11B7_26BA:				; CODE XREF: RplyMouseSpriteStuff+6A6j
		add	word_2B77_17E, 10h
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_26C6:				; CODE XREF: RplyMouseSpriteStuff+6A1j
		sub	word_2B77_17E, 10h
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_11B7_26D2:				; CODE XREF: RplyMouseSpriteStuff+69Cj
		mov	ax, word_2B77_180
		add	ax, 10h
		cmp	ax, 100h
		jge	short loc_11B7_2689
		add	word_2B77_180, 10h
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_26E8:				; CODE XREF: RplyMouseSpriteStuff+6ABj
		mov	ax, word_2B77_180
		sub	ax, 10h
		cmp	ax, 0FF00h
		jle	short loc_11B7_2689
		sub	word_2B77_180, 10h
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_11B7_26FE:				; CODE XREF: RplyMouseSpriteStuff+696j
					; RplyMouseSpriteStuff+7D9j ...
		cmp	g_cCameraMode, 3
		jnz	short loc_11B7_2718
		cmp	word_2B77_95B0,	0
		jg	short loc_11B7_270F
		jmp	loc_11B7_2689
; ---------------------------------------------------------------------------

loc_11B7_270F:				; CODE XREF: RplyMouseSpriteStuff+72Ej
		sub	word_2B77_95B0,	1Eh
		jmp	_EndFunc
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2718:				; CODE XREF: RplyMouseSpriteStuff+727j
		cmp	word_2B77_17C, 5DCh
		jl	short loc_11B7_2723
		jmp	loc_11B7_2689
; ---------------------------------------------------------------------------

loc_11B7_2723:				; CODE XREF: RplyMouseSpriteStuff+742j
		add	word_2B77_17C, 1Eh
		jmp	_EndFunc
; ---------------------------------------------------------------------------
		align 2

loc_11B7_272C:				; CODE XREF: RplyMouseSpriteStuff+68Ej
					; RplyMouseSpriteStuff+6BAj ...
		cmp	g_cCameraMode, 3
		jnz	short loc_11B7_2746
		cmp	word_2B77_95B0,	384h
		jl	short loc_11B7_273E
		jmp	loc_11B7_2689
; ---------------------------------------------------------------------------

loc_11B7_273E:				; CODE XREF: RplyMouseSpriteStuff+75Dj
		add	word_2B77_95B0,	1Eh
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_2746:				; CODE XREF: RplyMouseSpriteStuff+755j
		cmp	word_2B77_17C, 78h ; 'x'
		jg	short loc_11B7_2750
		jmp	loc_11B7_2689
; ---------------------------------------------------------------------------

loc_11B7_2750:				; CODE XREF: RplyMouseSpriteStuff+76Fj
		sub	word_2B77_17C, 1Eh
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_2758:				; CODE XREF: RplyMouseSpriteStuff+11FBj
		mov	al, byte_2B77_326B
		cbw
		mov	bx, ax
		mov	al, [bx+326Ch]
		mov	byte ptr [bp+var_44], al
		mov	al, g_cCameraMode
		cbw
		mov	bx, ax
		mov	al, byte ptr [bp+var_44]
		cmp	[bx+3294h], al
		jl	short loc_11B7_2777

loc_11B7_2774:				; CODE XREF: RplyMouseSpriteStuff+7BCj
					; RplyMouseSpriteStuff+7CFj ...
		mov	byte_2B77_326B,	al

loc_11B7_2777:				; CODE XREF: RplyMouseSpriteStuff:loc_11B7_26B6j
					; RplyMouseSpriteStuff+796j ...
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	loc_11B7_247E
; ---------------------------------------------------------------------------
		align 2

loc_11B7_278E:				; CODE XREF: RplyMouseSpriteStuff+1203j
		mov	al, byte_2B77_326B
		cbw
		mov	bx, ax
		mov	al, [bx+3276h]
		jmp	short loc_11B7_2774
; ---------------------------------------------------------------------------

loc_11B7_279A:				; CODE XREF: RplyMouseSpriteStuff+11F3j
		cmp	byte_2B77_326B,	7
		jz	short loc_11B7_272C
		mov	al, byte_2B77_326B
		cbw
		mov	bx, ax
		mov	al, [bx+3280h]
		jmp	short loc_11B7_2774
; ---------------------------------------------------------------------------
		align 2

loc_11B7_27AE:				; CODE XREF: RplyMouseSpriteStuff+120Bj
		cmp	byte_2B77_326B,	7
		jnz	short loc_11B7_27B8
		jmp	loc_11B7_26FE
; ---------------------------------------------------------------------------

loc_11B7_27B8:				; CODE XREF: RplyMouseSpriteStuff+7D7j
		mov	al, byte_2B77_326B
		cbw
		mov	bx, ax
		mov	al, [bx+328Ah]
		jmp	short loc_11B7_2774
; ---------------------------------------------------------------------------

loc_11B7_27C4:				; CODE XREF: RplyMouseSpriteStuff+6C7j
					; RplyMouseSpriteStuff+6D7j
		mov	al, byte_2B77_326B
		cbw
		cmp	ax, 6
		ja	short loc_11B7_2777
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_11B7_31B0[bx]
; ---------------------------------------------------------------------------
		align 2

loc_11B7_27D6:				; CODE XREF: RplyMouseSpriteStuff+6CFj
					; RplyMouseSpriteStuff+7F4j
					; DATA XREF: ...
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		sub	si, si

loc_11B7_2807:				; CODE XREF: RplyMouseSpriteStuff+83Aj
		mov	bx, si
		shl	bx, 1
		add	bx, bp
		mov	[bx+var_14], 0
		inc	si
		cmp	si, 8
		jl	short loc_11B7_2807
		cmp	gameState.carPlayer.field_C9, 0
		jz	short loc_11B7_2824
		mov	[bp+var_E], 1

loc_11B7_2824:				; CODE XREF: RplyMouseSpriteStuff+841j
		cmp	g_gameInfo.wRecordedFrames, 0
		jz	short loc_11B7_2832
		cmp	g_wResetOnCvxTr, 0
		jz	short loc_11B7_2837

loc_11B7_2832:				; CODE XREF: RplyMouseSpriteStuff+84Dj
		mov	[bp+var_A], 1

loc_11B7_2837:				; CODE XREF: RplyMouseSpriteStuff+854j
		cmp	g_bPassedSecuri, 0
		jnz	short loc_11B7_2848
		mov	[bp+var_10], 1
		mov	[bp+var_E], 1

loc_11B7_2848:				; CODE XREF: RplyMouseSpriteStuff+860j
		test	g_wMainFlag, 4
		jnz	short loc_11B7_2854
		mov	[bp+var_12], 1

loc_11B7_2854:				; CODE XREF: RplyMouseSpriteStuff+871j
		mov	al, g_wVideoFlag5
		mov	byte_2B77_9D34,	al
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_14]
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMen	; Replay Menu
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_2], al
		cbw
		sub	ax, 1
		cmp	ax, 6
		jbe	short loc_11B7_289E
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------

loc_11B7_289E:				; CODE XREF: RplyMouseSpriteStuff+8BDj
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_11B7_2CAA[bx]

loc_11B7_28A6:				; DATA XREF: RplyMouseSpriteStuff+CD0o
		call	CheckForInput
		mov	ax, g_wFramesPerSec2
		mov	g_wFramesPerSec, ax
		mov	al, byte ptr g_wFramesPerSec2
		mov	byte ptr g_gameInfo.wFramesPerSec, al
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState
		add	sp, 2
		mov	g_wMainFlgCp, 0
		mov	g_gameInfo.wRecordedFrames, 0
		mov	byte_2B77_A5CE,	0
		mov	g_wMainFlag, 1
		jmp	short loc_11B7_2940
; ---------------------------------------------------------------------------
		align 2

loc_11B7_28DC:				; CODE XREF: RplyMouseSpriteStuff+8C5j
					; DATA XREF: RplyMouseSpriteStuff+CD2o
		test	g_wMainFlag, 2
		jz	short loc_11B7_28EA

loc_11B7_28E3:				; CODE XREF: RplyMouseSpriteStuff:loc_11B7_292Fj
		mov	g_wMainFlag, 3
		jmp	short loc_11B7_2937
; ---------------------------------------------------------------------------

loc_11B7_28EA:				; CODE XREF: RplyMouseSpriteStuff+905j
		mov	ax, g_wMainFlgCp
		cmp	g_gameInfo.wRecordedFrames, ax
		jz	short loc_11B7_2932
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aCon_0 ; "con"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	si, ax
		cmp	si, 1
		jge	short loc_11B7_292F
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------

loc_11B7_292F:				; CODE XREF: RplyMouseSpriteStuff+94Ej
		jmp	short loc_11B7_28E3
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2932:				; CODE XREF: RplyMouseSpriteStuff+915j
		mov	g_wMainFlag, 1

loc_11B7_2937:				; CODE XREF: RplyMouseSpriteStuff+90Cj
		mov	ax, gameState.wGameFrame
		mov	g_wMainFlgCp, ax
		mov	g_gameInfo.wRecordedFrames, ax

loc_11B7_2940:				; CODE XREF: RplyMouseSpriteStuff+8FDj
		mov	byte_2B77_81E0,	1
		mov	g_wFpsMul4, 0
		mov	byte_2B77_AC70,	0
		mov	g_cGameMode2, 0
		mov	g_cCameraMode, 0
		mov	gameState.cCvxFlag3, 0
		mov	gameState.wFrameInSec, 0
		mov	byte_2B77_9276,	0
		sub	ax, ax
		push	ax
		mov	ax, 3
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		mov	g_cGameFlag2, 0
		mov	al, byte_2B77_182
		cbw
		push	ax
		push	cs
		call	near ptr MouseMinMaxPos
		add	sp, 2
		call	CheckForInput
		mov	g_cKbOrMouse, 0
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_299A:				; CODE XREF: RplyMouseSpriteStuff+8C5j
					; DATA XREF: RplyMouseSpriteStuff+CD4o
		mov	g_wMainFlag, 0
		call	DoAudioCvx
		mov	ax, offset aRep_0 ; "rep"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset a_rpl_0 ; ".rpl"
		push	ax
		mov	ax, 140h
		push	ax
		mov	ax, 0EEh ; 'î'
		push	ax
		call	TakesTrackNames
		add	sp, 0Ah
		cbw
		mov	si, ax
		or	si, si
		jnz	short loc_11B7_29D8
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------

loc_11B7_29D8:				; CODE XREF: RplyMouseSpriteStuff+9F7j
		mov	g_wWaitFlag, 96h ; '–'
		call	ShowWaiting
		push	si
		push	di
		lea	di, [bp+var_3E]
		mov	si, offset g_gameInfo
		push	ss
		pop	es
		mov	cx, 0Dh
		repne movsw
		pop	di
		pop	si
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+TrackInfo.cSkybox]
		sub	ah, ah
		mov	[bp+var_4], ax
		mov	ax, 140h
		push	ax
		mov	ax, 0EEh ; 'î'
		push	ax
		push	cs
		call	near ptr LoadReplayFile
		add	sp, 4
		or	al, al
		jz	short loc_11B7_2A1B
		mov	g_gameInfo.wRecordedFrames, 0

loc_11B7_2A1B:				; CODE XREF: RplyMouseSpriteStuff+A37j
		mov	byte_2B77_81E0,	0
		call	SetupTrack
		sub	si, si
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+TrackInfo.cSkybox]
		sub	ah, ah
		cmp	ax, [bp+var_4]
		jz	short loc_11B7_2A3A
		mov	si, 1

loc_11B7_2A3A:				; CODE XREF: RplyMouseSpriteStuff+A59j
		mov	al, byte ptr g_gameInfo.dwPlayerCarID
		cmp	[bp+var_3E], al
		jnz	short loc_11B7_2A5A
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+1
		cmp	[bp+var_3D], al
		jnz	short loc_11B7_2A5A
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+2
		cmp	[bp+var_3C], al
		jnz	short loc_11B7_2A5A
		mov	al, byte ptr g_gameInfo.dwPlayerCarID+3
		cmp	[bp+var_3B], al
		jz	short loc_11B7_2A60

loc_11B7_2A5A:				; CODE XREF: RplyMouseSpriteStuff+A64j
					; RplyMouseSpriteStuff+A6Cj ...
		mov	si, 1
		jmp	short loc_11B7_2A9D
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2A60:				; CODE XREF: RplyMouseSpriteStuff+A7Cj
		mov	al, g_gameInfo.cOpponentType
		cmp	[bp+var_38], al
		jnz	short loc_11B7_2A5A
		or	al, al
		jz	short loc_11B7_2A9D
		mov	al, byte ptr g_gameInfo.dwOpponentID
		cmp	[bp+var_37], al
		jnz	short loc_11B7_2A5A
		mov	al, byte ptr g_gameInfo.dwOpponentID+1
		cmp	[bp+var_36], al
		jnz	short loc_11B7_2A5A
		mov	al, byte ptr g_gameInfo.dwOpponentID+2
		cmp	[bp+var_35], al
		jnz	short loc_11B7_2A5A
		mov	al, byte ptr g_gameInfo.dwOpponentID+3
		cmp	[bp+var_34], al
		jnz	short loc_11B7_2A5A
		mov	ax, 2
		push	ax
		call	EnsureFileExists
		add	sp, 2
		call	SetupOppTrakdata

loc_11B7_2A9D:				; CODE XREF: RplyMouseSpriteStuff+A81j
					; RplyMouseSpriteStuff+A8Ej
		or	si, si
		jz	short loc_11B7_2AA9
		push	cs
		call	near ptr UnloadGameResou
		push	cs
		call	near ptr SetupCarGameEtc

loc_11B7_2AA9:				; CODE XREF: RplyMouseSpriteStuff+AC3j
		mov	al, byte ptr g_gameInfo.wFramesPerSec
		cbw
		mov	g_wFramesPerSec, ax
		mov	ax, 0FFFFh
		push	ax
		call	InitGameState
		add	sp, 2
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2AC0:				; CODE XREF: RplyMouseSpriteStuff+8C5j
					; DATA XREF: RplyMouseSpriteStuff+CD6o
		call	DoAudioCvx

loc_11B7_2AC5:				; CODE XREF: RplyMouseSpriteStuff+BF8j
		mov	[bp+var_1E], 0

loc_11B7_2AC9:				; CODE XREF: RplyMouseSpriteStuff+BAEj
					; RplyMouseSpriteStuff+BC3j
		cmp	[bp+var_1E], 0
		jz	short loc_11B7_2AD2
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------

loc_11B7_2AD2:				; CODE XREF: RplyMouseSpriteStuff+AF1j
		mov	ax, offset aRep_1 ; "rep"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 140h
		push	ax
		mov	ax, 0EEh ; 'î'
		push	ax
		call	SavResRender
		add	sp, 8
		or	al, al
		jnz	short loc_11B7_2AFF
		jmp	loc_11B7_2B80
; ---------------------------------------------------------------------------

loc_11B7_2AFF:				; CODE XREF: RplyMouseSpriteStuff+B1Ej
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_rpl_1 ; ".rpl"
		push	ax
		mov	ax, offset aDefault_0 ;	"DEFAULT"
		push	ax
		mov	ax, offset g_pcData20Trak2
		push	ax
		call	CombineFilePath
		add	sp, 8
		mov	[bp+var_1E], 1
		mov	g_bSaveDelFlag,	1
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	FindFileName
		add	sp, 2
		or	ax, ax
		jz	short loc_11B7_2B78
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aFex	; "fex"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	si, ax
		cmp	si, 0FFFFh
		jnz	short loc_11B7_2B70
		mov	[bp+var_1E], 0FFh
		jmp	short loc_11B7_2B78
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2B70:				; CODE XREF: RplyMouseSpriteStuff+B8Bj
		or	si, si
		jnz	short loc_11B7_2B78
		mov	[bp+var_1E], 0

loc_11B7_2B78:				; CODE XREF: RplyMouseSpriteStuff+B52j
					; RplyMouseSpriteStuff+B91j ...
		mov	g_bSaveDelFlag,	0
		jmp	short loc_11B7_2B84
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2B80:				; CODE XREF: RplyMouseSpriteStuff+B20j
		mov	[bp+var_1E], 0FFh

loc_11B7_2B84:				; CODE XREF: RplyMouseSpriteStuff+BA1j
		cmp	[bp+var_1E], 1
		jz	short loc_11B7_2B8D
		jmp	loc_11B7_2AC9
; ---------------------------------------------------------------------------

loc_11B7_2B8D:				; CODE XREF: RplyMouseSpriteStuff+BACj
		mov	ax, 95F8h
		push	ax
		push	cs
		call	near ptr SaveReplay
		add	sp, 2
		mov	[bp+var_20], al
		or	al, al
		jnz	short loc_11B7_2BA2
		jmp	loc_11B7_2AC9
; ---------------------------------------------------------------------------

loc_11B7_2BA2:				; CODE XREF: RplyMouseSpriteStuff+BC1j
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aSer	; "ser"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 1
		push	ax
		call	DoDialog
		add	sp, 12h
		jmp	loc_11B7_2AC5
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2BD8:				; CODE XREF: RplyMouseSpriteStuff+8C5j
					; DATA XREF: RplyMouseSpriteStuff:off_11B7_2CAAo
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		call	CvxSfxOp
		add	sp, 4

loc_11B7_2BE7:				; CODE XREF: RplyMouseSpriteStuff+C28j
		mov	byte ptr word_2B77_926A, 2
		jmp	loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2BF0:				; CODE XREF: RplyMouseSpriteStuff+8C5j
					; DATA XREF: RplyMouseSpriteStuff+CDAo
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		call	CvxSfxOp
		add	sp, 4
		mov	g_wMainFlag, 0
		jmp	short loc_11B7_2BE7
; ---------------------------------------------------------------------------

loc_11B7_2C06:				; CODE XREF: RplyMouseSpriteStuff+8C5j
					; DATA XREF: RplyMouseSpriteStuff+CD8o
		sub	si, si

loc_11B7_2C08:				; CODE XREF: RplyMouseSpriteStuff+C3Bj
		mov	bx, si
		shl	bx, 1
		add	bx, bp
		mov	word ptr [bx-14h], 0
		inc	si
		cmp	si, 5
		jl	short loc_11B7_2C08
		cmp	g_gameInfo.cOpponentType, 0
		jnz	short loc_11B7_2C25
		mov	[bp+var_C], 1

loc_11B7_2C25:				; CODE XREF: RplyMouseSpriteStuff+C42j
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_14]
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMdo	; "mdo"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_2], al
		cbw
		or	ax, ax
		jz	short loc_11B7_2C78
		cmp	ax, 1
		jz	short loc_11B7_2C80
		cmp	ax, 2
		jz	short loc_11B7_2C88
		cmp	ax, 3
		jz	short loc_11B7_2C9A
		cmp	ax, 4
		jz	short loc_11B7_2CA2
		jmp	short loc_11B7_2CB8
; ---------------------------------------------------------------------------

loc_11B7_2C78:				; CODE XREF: RplyMouseSpriteStuff+C84j
		xor	byte_2B77_81E0,	1
		jmp	short loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2C80:				; CODE XREF: RplyMouseSpriteStuff+C89j
		xor	g_cGameFlag1, 1
		jmp	short loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2C88:				; CODE XREF: RplyMouseSpriteStuff+C8Ej
		inc	g_cCameraMode
		cmp	g_cCameraMode, 4
		jnz	short loc_11B7_2CB8
		mov	g_cCameraMode, 0
		jmp	short loc_11B7_2CB8
; ---------------------------------------------------------------------------

loc_11B7_2C9A:				; CODE XREF: RplyMouseSpriteStuff+C93j
		call	DoMrlTextRes
		jmp	short loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2CA2:				; CODE XREF: RplyMouseSpriteStuff+C98j
		xor	byte_2B77_AC70,	1
		jmp	short loc_11B7_2CB8
; ---------------------------------------------------------------------------
		align 2
off_11B7_2CAA	dw offset loc_11B7_2BD8	; DATA XREF: RplyMouseSpriteStuff+8C5r
		dw offset loc_11B7_28A6
		dw offset loc_11B7_28DC
		dw offset loc_11B7_299A
		dw offset loc_11B7_2AC0
		dw offset loc_11B7_2C06
		dw offset loc_11B7_2BF0
; ---------------------------------------------------------------------------

loc_11B7_2CB8:				; CODE XREF: RplyMouseSpriteStuff+8BFj
					; RplyMouseSpriteStuff+950j ...
		call	CheckForInput
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_2CC0:				; CODE XREF: RplyMouseSpriteStuff+7F4j
					; DATA XREF: RplyMouseSpriteStuff:off_11B7_31B0o
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		sub	ax, ax
		push	ax
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		call	DoGetTimerDelta
		mov	[bp+var_24], 14h
		mov	[bp+var_22], 0
		jmp	loc_11B7_2D84
; ---------------------------------------------------------------------------
		align 2

loc_11B7_2CEC:				; CODE XREF: RplyMouseSpriteStuff+DAFj
		mov	ax, 32h	; '2'
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		mov	di, ax
		add	di, 3
		cmp	di, 64h	; 'd'
		jle	short loc_11B7_2D0A
		mov	di, 64h	; 'd'

loc_11B7_2D0A:				; CODE XREF: RplyMouseSpriteStuff+D29j
		call	DoGetTimerDelta
		mov	[bp+var_18], ax
		imul	di
		mov	si, ax
		cwd
		add	[bp+var_24], ax
		adc	[bp+var_22], dx
		mov	ax, g_gameInfo.wRecordedFrames
		sub	ax, g_wMainFlgCp
		mov	[bp+var_44], ax
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		cmp	ax, [bp+var_44]
		jbe	short loc_11B7_2D54
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		push	[bp+var_44]
		call	__aFlmul
		mov	[bp+var_24], ax
		mov	[bp+var_22], dx

loc_11B7_2D54:				; CODE XREF: RplyMouseSpriteStuff+D5Fj
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		add	ax, g_wMainFlgCp
		push	ax
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		push	[bp+var_18]
		call	DoInputsCheckin
		add	sp, 2

loc_11B7_2D84:				; CODE XREF: RplyMouseSpriteStuff+D0Cj
		test	byte ptr g_wKbOrJoyFlag, 30h
		jz	short loc_11B7_2D8E
		jmp	loc_11B7_2CEC
; ---------------------------------------------------------------------------

loc_11B7_2D8E:				; CODE XREF: RplyMouseSpriteStuff+DADj
		mov	ax, g_gameInfo.wRecordedFrames
		sub	ax, g_wMainFlgCp
		mov	[bp+var_44], ax
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		cmp	ax, [bp+var_44]
		jbe	short loc_11B7_2DC5
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		push	[bp+var_44]
		call	__aFlmul
		mov	[bp+var_24], ax
		mov	[bp+var_22], dx

loc_11B7_2DC5:				; CODE XREF: RplyMouseSpriteStuff+DD0j
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		mov	si, ax
		add	si, g_wMainFlgCp
		cmp	g_gameInfo.wRecordedFrames, si
		jge	short loc_11B7_2DE6
		mov	si, g_gameInfo.wRecordedFrames

loc_11B7_2DE6:				; CODE XREF: RplyMouseSpriteStuff+E04j
		push	si
		call	RestoreGameState
		add	sp, 2
		mov	g_wMainFlgCp, si
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		mov	ax, offset aWai_1 ; "wai"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		cmp	g_wTimerFlag5, 0
		jz	short loc_11B7_2E62
		push	g_prcMegaPoly2
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		push	g_prcMegaPoly2
		call	MinMaxRect
		jmp	short loc_11B7_2E9D
; ---------------------------------------------------------------------------

loc_11B7_2E62:				; CODE XREF: RplyMouseSpriteStuff+E50j
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		jmp	short loc_11B7_2EA0
; ---------------------------------------------------------------------------

loc_11B7_2E88:				; CODE XREF: RplyMouseSpriteStuff+ECBj
		call	UpdateGameState
		push	g_wMainFlgCp
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff

loc_11B7_2E9D:				; CODE XREF: RplyMouseSpriteStuff+E84j
		add	sp, 6

loc_11B7_2EA0:				; CODE XREF: RplyMouseSpriteStuff+EAAj
		mov	ax, g_wMainFlgCp
		cmp	gameState.wGameFrame, ax
		jnz	short loc_11B7_2E88

loc_11B7_2EA9:				; CODE XREF: RplyMouseSpriteStuff+110Aj
		mov	ax, 3E8h
		push	ax
		call	DoInputsCheckin
		add	sp, 2
		jmp	_EndFunc
; ---------------------------------------------------------------------------

loc_11B7_2EB8:				; CODE XREF: RplyMouseSpriteStuff+7F4j
					; DATA XREF: RplyMouseSpriteStuff+11D6o
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		sub	ax, ax
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		call	DoGetTimerDelta
		mov	[bp+var_24], 14h
		mov	[bp+var_22], 0
		jmp	loc_11B7_2F7A
; ---------------------------------------------------------------------------
		align 4

loc_11B7_2EE8:				; CODE XREF: RplyMouseSpriteStuff+FA5j
		mov	ax, 32h	; '2'
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		mov	di, ax
		add	di, 3
		cmp	di, 64h	; 'd'
		jle	short loc_11B7_2F06
		mov	di, 64h	; 'd'

loc_11B7_2F06:				; CODE XREF: RplyMouseSpriteStuff+F25j
		call	DoGetTimerDelta
		mov	[bp+var_18], ax
		imul	di
		mov	si, ax
		cwd
		add	[bp+var_24], ax
		adc	[bp+var_22], dx
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		cmp	ax, g_wMainFlgCp
		jbe	short loc_11B7_2F48
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		push	g_wMainFlgCp
		call	__aFlmul
		mov	[bp+var_24], ax
		mov	[bp+var_22], dx

loc_11B7_2F48:				; CODE XREF: RplyMouseSpriteStuff+F52j
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		mov	cx, g_wMainFlgCp
		sub	cx, ax
		push	cx
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		push	[bp+var_18]
		call	DoInputsCheckin
		add	sp, 2

loc_11B7_2F7A:				; CODE XREF: RplyMouseSpriteStuff+F07j
		test	byte ptr g_wKbOrJoyFlag, 30h
		jz	short loc_11B7_2F84
		jmp	loc_11B7_2EE8
; ---------------------------------------------------------------------------

loc_11B7_2F84:				; CODE XREF: RplyMouseSpriteStuff+FA3j
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		cmp	ax, g_wMainFlgCp
		jbe	short loc_11B7_2FB3
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		push	g_wMainFlgCp
		call	__aFlmul
		mov	[bp+var_24], ax
		mov	[bp+var_22], dx

loc_11B7_2FB3:				; CODE XREF: RplyMouseSpriteStuff+FBDj
		mov	ax, 14h
		cwd
		push	dx
		push	ax
		push	[bp+var_22]
		push	[bp+var_24]
		call	__aFldiv
		mov	di, ax
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		or	di, di
		jnz	short loc_11B7_2FDF
		jmp	loc_11B7_30D3
; ---------------------------------------------------------------------------

loc_11B7_2FDF:				; CODE XREF: RplyMouseSpriteStuff+FFEj
		mov	ax, offset aWai_0 ; "wai"
		push	ax
		push	word ptr g_dwGameRes+2
		push	word ptr g_dwGameRes
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		cmp	g_wTimerFlag5, 0
		jz	short loc_11B7_3040
		push	g_prcMegaPoly2
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah
		push	ax
		push	g_prcMegaPoly2
		call	MinMaxRect
		add	sp, 6
		jmp	short loc_11B7_3064
; ---------------------------------------------------------------------------
		align 2

loc_11B7_3040:				; CODE XREF: RplyMouseSpriteStuff+102Aj
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, 0AC74h
		push	ax
		call	FontByteTextOp2
		add	sp, 0Ah

loc_11B7_3064:				; CODE XREF: RplyMouseSpriteStuff+1061j
		mov	si, g_wMainFlgCp
		sub	si, di
		push	si
		call	RestoreGameState
		add	sp, 2
		mov	g_wMainFlgCp, si
		mov	ax, si
		sub	ax, gameState.wGameFrame
		mov	[bp+var_4], ax
		or	ax, ax
		jz	short loc_11B7_30D3
		mov	si, ax
		jmp	short loc_11B7_30CA
; ---------------------------------------------------------------------------

loc_11B7_3088:				; CODE XREF: RplyMouseSpriteStuff+10F5j
		call	UpdateGameState
		dec	si
		push	g_wMainFlgCp
		mov	ax, [bp+var_4]
		cwd
		push	dx
		push	ax
		mov	ax, di
		cwd
		push	dx
		push	ax
		mov	ax, si
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, g_wMainFlgCp
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		mov	ax, 1
		push	ax
		call	DoInputsCheckin
		add	sp, 2

loc_11B7_30CA:				; CODE XREF: RplyMouseSpriteStuff+10AAj
		mov	ax, g_wMainFlgCp
		cmp	gameState.wGameFrame, ax
		jnz	short loc_11B7_3088

loc_11B7_30D3:				; CODE XREF: RplyMouseSpriteStuff+1000j
					; RplyMouseSpriteStuff+10A6j
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	loc_11B7_2EA9
; ---------------------------------------------------------------------------
		align 2

loc_11B7_30EA:				; CODE XREF: RplyMouseSpriteStuff+7F4j
					; DATA XREF: RplyMouseSpriteStuff+11DAo
		mov	byte_2B77_9276,	0
		sub	ax, ax
		push	ax
		mov	ax, 3
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	loc_11B7_31A8
; ---------------------------------------------------------------------------

loc_11B7_3104:				; CODE XREF: RplyMouseSpriteStuff+7F4j
					; DATA XREF: RplyMouseSpriteStuff+11DCo
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	loc_11B7_2777
; ---------------------------------------------------------------------------

loc_11B7_3136:				; CODE XREF: RplyMouseSpriteStuff+7F4j
					; DATA XREF: RplyMouseSpriteStuff+11DEo
		mov	g_cGameFlag2, 1
		call	DoAudioCvx
		sub	ax, ax
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		push	gameState.wGameFrame
		push	gameState.wGameFrame
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		sub	ax, ax
		push	ax
		call	RestoreGameState
		add	sp, 2
		mov	ax, 32h	; '2'
		cwd
		push	dx
		push	ax
		call	DoGetTimerCounter2X
		add	sp, 4
		sub	ax, ax
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		jmp	loc_11B7_25D0
; ---------------------------------------------------------------------------
		align 2

loc_11B7_3194:				; CODE XREF: RplyMouseSpriteStuff+7F4j
					; DATA XREF: RplyMouseSpriteStuff+11D8o
		sub	ax, ax
		push	ax
		mov	ax, 2
		push	ax
		push	ax
		push	cs
		call	near ptr RplyMouseSpriteStuff
		add	sp, 6
		mov	byte_2B77_9276,	3

loc_11B7_31A8:				; CODE XREF: RplyMouseSpriteStuff+1125j
		mov	g_cGameFlag2, 0
		jmp	loc_11B7_2777
; ---------------------------------------------------------------------------
off_11B7_31B0	dw offset loc_11B7_2CC0	; DATA XREF: RplyMouseSpriteStuff+7F4r
		dw offset loc_11B7_2EB8
		dw offset loc_11B7_3194
		dw offset loc_11B7_30EA
		dw offset loc_11B7_3104
		dw offset loc_11B7_3136
		dw offset loc_11B7_27D6
; ---------------------------------------------------------------------------
		jmp	loc_11B7_2777
; ---------------------------------------------------------------------------
		align 2

loc_11B7_31C2:				; CODE XREF: RplyMouseSpriteStuff+6BFj
		cmp	ax, 2Dh	; '-'
		jnz	short loc_11B7_31CA
		jmp	loc_11B7_26FE
; ---------------------------------------------------------------------------

loc_11B7_31CA:				; CODE XREF: RplyMouseSpriteStuff+11E9j
		cmp	ax, 4800h
		jnz	short loc_11B7_31D2
		jmp	loc_11B7_279A
; ---------------------------------------------------------------------------

loc_11B7_31D2:				; CODE XREF: RplyMouseSpriteStuff+11F1j
		cmp	ax, 4B00h
		jnz	short loc_11B7_31DA
		jmp	loc_11B7_2758
; ---------------------------------------------------------------------------

loc_11B7_31DA:				; CODE XREF: RplyMouseSpriteStuff+11F9j
		cmp	ax, 4D00h
		jnz	short loc_11B7_31E2
		jmp	loc_11B7_278E
; ---------------------------------------------------------------------------

loc_11B7_31E2:				; CODE XREF: RplyMouseSpriteStuff+1201j
		cmp	ax, 5000h
		jnz	short loc_11B7_31EA
		jmp	loc_11B7_27AE
; ---------------------------------------------------------------------------

loc_11B7_31EA:				; CODE XREF: RplyMouseSpriteStuff+1209j
		jmp	loc_11B7_2777
; ---------------------------------------------------------------------------
		align 2

_EndFunc:				; CODE XREF: RplyMouseSpriteStuff:loc_11B7_1FFDj
					; RplyMouseSpriteStuff+56j ...
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
RplyMouseSpriteStuff endp

seg005		ends

; ===========================================================================

; Segment type:	Pure code
seg006		segment	byte public 'CODE' use16
		assume cs:seg006
		;org 4
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


InitPolyInfo	proc far		; CODE XREF: _main+F1P
		mov	ax, 28A0h	; bytes	to reserve
		cwd
		push	dx
		push	ax
		mov	ax, offset aPolyinfo ; "polyinfo"
		push	ax
		call	AllocResBytes
		add	sp, 6
		mov	word ptr g_pwPolyBuffer, ax
		mov	word ptr g_pwPolyBuffer+2, dx
		sub	ax, ax
		push	ax
		mov	ax, offset g_matY0
		push	ax
		call	MatRotateY	; looks	up ax =	0
		add	sp, 4
		mov	ax, 100h
		push	ax
		mov	ax, offset g_wMatY100
		push	ax
		call	MatRotateY	; looks	up ax =	0x100
		add	sp, 4
		mov	ax, 200h
		push	ax
		mov	ax, offset g_matY200
		push	ax
		call	MatRotateY	; looks	up ax=0x200
		add	sp, 4
		mov	ax, 300h
		push	ax
		mov	ax, offset g_wMatY300
		push	ax
		call	MatRotateY	; looks	up ax=0x300
		add	sp, 4
		push	cs
		call	near ptr SetSinCos80
		retf
InitPolyInfo	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetVideoValues	proc far		; CODE XREF: SetVideoMode+3F8P

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		mov	g_wVidConstCp1,	ax
		mov	ax, [bp+arg_2]
		mov	g_wVidConstCp2,	ax
		mov	ax, [bp+arg_4]
		mov	g_wVidConstCp3,	ax
		mov	ax, [bp+arg_6]
		mov	g_wVidConstCp4,	ax
		mov	ax, [bp+arg_8]
		mov	g_wVidConstCp5,	ax
		pop	bp
		retf
SetVideoValues	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


ResetTrnsfrmOpVars proc	far		; CODE XREF: SelectRectRotate+29p
					; sub_14D6_1296+1FBp
		mov	g_wTrnsfrmShpOp2, 0
		mov	g_wTrnsfrmShpOp3, 0
		mov	g_wTrnsfrmShpOpFlag, 0
		mov	g_wTrnsfrmShpOp4, 0FFFFh
		mov	g_wTrnsfrmShpOp, 190h
		retf
ResetTrnsfrmOpVars endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SelectRectRotate proc far		; CODE XREF: RunCarMenu+823P
					; UpdateFrame+410P ...

vec1		= Vector3D ptr -0Eh
pMatrix		= word ptr -8
vec2		= Vector3D ptr -6
p_dwRot1	= word ptr  6
p_dwRot2	= word ptr  8
p_dwRot3	= word ptr  0Ah
p_pUnk8		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		mov	ax, 1
		push	ax
		push	[bp+p_dwRot3]
		push	[bp+p_dwRot2]
		push	[bp+p_dwRot1]
		push	cs
		call	near ptr MatRotateZXY
		add	sp, 8
		mov	di, offset g_matTemp
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		mov	cx, 9
		repne movsw
		push	cs
		call	near ptr ResetTrnsfrmOpVars
		mov	ax, [bp+p_pUnk8]
		mov	di, offset g_rcCurRect
		mov	si, ax
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw			; wrote	p_pUnk8	to g_pwCurUnk8
		mov	ax, [bp+arg_8]
		mov	g_pToRect, ax
		sub	ax, ax
		push	ax
		mov	ax, [bp+p_dwRot3]
		neg	ax
		push	ax
		mov	ax, [bp+p_dwRot2]
		neg	ax
		push	ax
		mov	ax, [bp+p_dwRot1]
		neg	ax
		push	ax
		push	cs
		call	near ptr MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		mov	[bp+vec1.wZ], 2710h
		mov	[bp+vec1.wY], 0
		mov	[bp+vec1.wX], 0
		lea	ax, [bp+vec2]
		push	ax
		push	[bp+pMatrix]
		lea	ax, [bp+vec1]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		push	[bp+vec2.wZ]
		push	[bp+vec2.wX]
		call	GetAngleFromXZ
		add	sp, 4
		and	ah, 3
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SelectRectRotate endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TransformedShapeOp proc	far		; CODE XREF: RunCarMenu+84AP
					; UpdateFrame+560P ...

var_B7C		= word ptr -0B7Ch
var_B7A		= word ptr -0B7Ah
pdwCull1	= dword	ptr -0B78h
var_B74		= word ptr -0B74h
var_B72		= word ptr -0B72h
var_B70		= word ptr -0B70h
vec4		= Vector3D ptr -0B6Eh
var_574		= word ptr -574h
var_572		= word ptr -572h
var_570		= word ptr -570h
var_56E		= dword	ptr -56Eh
vec2		= Vector3D ptr -56Ah
var_564		= word ptr -564h
var_562		= byte ptr -562h
var_462		= word ptr -462h
var_460		= word ptr -460h
var_45E		= word ptr -45Eh
var_45C		= word ptr -45Ch
var_45A		= word ptr -45Ah
vec		= Vector3D ptr -458h
var_450		= word ptr -450h
var_44E		= word ptr -44Eh
var_44A		= byte ptr -44Ah
var_448		= word ptr -448h
pMatrix3	= Matrix ptr -446h
pwdCull2	= dword	ptr -434h
var_430		= dword	ptr -430h
pMatrix		= word ptr -42Ch
pMatrix2	= Matrix ptr -42Ah
wPrimiType	= word ptr -418h
var_416		= word ptr -416h
var_414		= word ptr -414h
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
vec3		= Vector3D ptr -14h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= byte ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pTransShape	= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0B7Ch
		push	di
		push	si
		cmp	g_wTrnsfrmShpOpFlag, 0
		jz	short loc_14D6_158

loc_14D6_14E:				; CODE XREF: TransformedShapeOp+F63j
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_158:				; CODE XREF: TransformedShapeOp+Ej
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	ax, [bx+Shape3D.wNumVerts]
		mov	g_wNumVerts, ax
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	ax, word ptr [bx+Shape3D.pPrimitives]
		mov	dx, word ptr [bx+(Shape3D.pPrimitives+2)]
		mov	word ptr g_pPrimitives,	ax
		mov	word ptr g_pPrimitives+2, dx
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	ax, word ptr [bx+Shape3D.pVertices]
		mov	dx, word ptr [bx+(Shape3D.pVertices+2)]
		mov	word ptr g_pVertices, ax
		mov	word ptr g_pVertices+2,	dx
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	al, byte ptr [bx+Shape3D.wNumPaints]
		cbw
		mov	g_wSelNumPaints, ax
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	ax, word ptr [bx+Shape3D.pdwCull1]
		mov	dx, word ptr [bx+(Shape3D.pdwCull1+2)]
		mov	word ptr [bp+pdwCull1],	ax
		mov	word ptr [bp+pdwCull1+2], dx
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	ax, word ptr [bx+Shape3D.pdwCull2]
		mov	dx, word ptr [bx+(Shape3D.pdwCull2+2)]
		mov	word ptr [bp+pwdCull2],	ax
		mov	word ptr [bp+pwdCull2+2], dx
		mov	bx, [bp+p_pTransShape]
		mov	al, [bx+TransformedShape3D.cMaterial]
		mov	g_cSelMaterial,	al
		cmp	byte ptr g_wSelNumPaints, al
		ja	short loc_14D6_1D2
		mov	g_cSelMaterial,	0

loc_14D6_1D2:				; CODE XREF: TransformedShapeOp+8Dj
		mov	al, [bx+TransformedShape3D.cFlags]
		mov	g_cSelShapeFlags, al
		test	g_cSelShapeFlags, 8
		jz	short loc_14D6_1E5
		mov	ax, [bx+TransformedShape3D.pRect]
		mov	g_pSelRect, ax

loc_14D6_1E5:				; CODE XREF: TransformedShapeOp+9Fj
		sub	si, si
		jmp	short loc_14D6_1F0
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1EA:				; CODE XREF: TransformedShapeOp+B8j
		mov	[bp+si+var_562], 0FFh
		inc	si

loc_14D6_1F0:				; CODE XREF: TransformedShapeOp+A9j
		mov	ax, si
		cmp	ax, g_wNumVerts
		jb	short loc_14D6_1EA
		test	g_cSelShapeFlags, 2
		jz	short loc_14D6_256
		sub	ax, ax
		push	ax
		mov	bx, [bp+p_pTransShape]
		push	[bx+TransformedShape3D.vecRot.wZ]
		push	[bx+TransformedShape3D.vecRot.wY]
		push	[bx+TransformedShape3D.vecRot.wX]
		push	cs
		call	near ptr MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		lea	ax, [bp+pMatrix2]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		push	[bp+pMatrix]
		call	MatMultiply
		add	sp, 6
		mov	ax, [bp+p_pTransShape]
		push	si
		push	di
		lea	di, [bp+vec3]
		mov	si, ax
		push	ss
		pop	es
		assume es:nothing
		movsw
		movsw
		movsw
		pop	di
		pop	si

loc_14D6_23F:				; CODE XREF: TransformedShapeOp+1A5j
					; TransformedShapeOp+1D6j
		mov	[bp+var_45C], 0FFFFh
		mov	[bp+var_45A], 0FFFFh
		sub	ax, ax
		mov	[bp+var_8], ax
		mov	[bp+var_A], ax
		jmp	loc_14D6_343
; ---------------------------------------------------------------------------

loc_14D6_256:				; CODE XREF: TransformedShapeOp+BFj
		sub	ax, ax
		push	ax
		mov	bx, [bp+p_pTransShape]
		push	[bx+TransformedShape3D.vecRot.wZ]
		push	[bx+TransformedShape3D.vecRot.wY]
		push	[bx+TransformedShape3D.vecRot.wX]
		push	cs
		call	near ptr MatRotateZXY
		add	sp, 8
		mov	[bp+pMatrix], ax
		lea	ax, [bp+vec3]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		push	[bp+p_pTransShape]
		call	MatMultiplyVector
		add	sp, 6
		lea	ax, [bp+pMatrix2]
		push	ax
		mov	ax, offset g_matTemp
		push	ax
		push	[bp+pMatrix]
		call	MatMultiply
		add	sp, 6
		lea	ax, [bp+pMatrix3]
		push	ax
		lea	ax, [bp+pMatrix2]
		push	ax
		call	MatCopy
		add	sp, 4
		mov	[bp+vec.wX], 0
		mov	[bp+vec.wY], 0
		mov	[bp+vec.wZ], 1000h
		lea	ax, [bp+vec2]
		push	ax
		lea	ax, [bp+pMatrix3]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		cmp	[bp+vec2.wY], 0
		jle	short loc_14D6_2E6
		mov	bx, [bp+p_pTransShape]
		cmp	[bx+TransformedShape3D.vecPos.wY], 0
		jge	short loc_14D6_2E6
		jmp	loc_14D6_23F
; ---------------------------------------------------------------------------

loc_14D6_2E6:				; CODE XREF: TransformedShapeOp+19Aj
					; TransformedShapeOp+1A3j
		push	[bp+vec3.wX]
		call	_abs
		add	sp, 2
		mov	bx, [bp+p_pTransShape]
		mov	cx, [bx+TransformedShape3D.field_10]
		shl	cx, 1
		cmp	cx, ax
		jle	short loc_14D6_317
		push	[bp+vec3.wZ]
		call	_abs
		add	sp, 2
		mov	bx, [bp+p_pTransShape]
		mov	cx, [bx+TransformedShape3D.field_10]
		shl	cx, 1
		cmp	cx, ax
		jle	short loc_14D6_317
		jmp	loc_14D6_23F
; ---------------------------------------------------------------------------

loc_14D6_317:				; CODE XREF: TransformedShapeOp+1BDj
					; TransformedShapeOp+1D4j
		lea	ax, [bp+vec2]
		push	ax
		push	cs
		call	near ptr VectorOp
		add	sp, 2
		mov	g_cUnk14MatMulVecOp, al
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		mov	ax, word ptr unk_2B77_3312[bx]
		mov	dx, word ptr unk_2B77_3314[bx]
		mov	[bp+var_45C], ax
		mov	[bp+var_45A], dx
		mov	[bp+var_A], ax
		mov	[bp+var_8], dx

loc_14D6_343:				; CODE XREF: TransformedShapeOp+115j
		mov	ax, g_wTrnsfrmShpOp
		mov	g_wTrnsfrmOp, ax
		mov	g_wTrnsfrmOp2, ax
		mov	g_wTrnsfrmOp3, 0
		mov	[bp+var_45E], 0
		cmp	g_wNumVerts, 8
		jbe	short loc_14D6_366
		mov	g_cNumPolyVerts, 8
		jmp	short loc_14D6_36C
; ---------------------------------------------------------------------------

loc_14D6_366:				; CODE XREF: TransformedShapeOp+21Fj
		mov	al, byte ptr g_wNumVerts
		mov	g_cNumPolyVerts, al

loc_14D6_36C:				; CODE XREF: TransformedShapeOp+226j
		cmp	g_cNumPolyVerts, 4
		jbe	short loc_14D6_386
		les	bx, g_pVertices
		mov	ax, es:[bx+(Vector3D.wY+18h)]
		cmp	es:[bx+Vector3D.wY], ax

loc_14D6_37F:
		jnz	short loc_14D6_386
		mov	g_cNumPolyVerts, 4

loc_14D6_386:				; CODE XREF: TransformedShapeOp+233j
					; TransformedShapeOp:loc_14D6_37Fj
		mov	[bp+var_44A], 0Fh
		mov	[bp+var_460], 1
		mov	[bp+var_1A], 0
		sub	si, si
		jmp	short loc_14D6_3DF
; ---------------------------------------------------------------------------

loc_14D6_39A:				; CODE XREF: TransformedShapeOp+348j
		mov	[bp+var_460], 0
		mov	[bp+si+var_562], 0
		mov	bx, si
		shl	bx, 1
		push	g_pwTrnsfrmTab[bx]
		lea	ax, [bp+vec2]
		push	ax
		call	VectorOp2
		add	sp, 4
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_3D4
		mov	bx, si
		shl	bx, 1
		push	g_pwTrnsfrmTab[bx]
		push	cs
		call	near ptr sub_14D6_1182
		add	sp, 2
		and	[bp+var_44A], al

loc_14D6_3D4:				; CODE XREF: TransformedShapeOp+281j
		cmp	[bp+var_44A], 0
		jnz	short loc_14D6_3DE
		jmp	loc_14D6_4C0
; ---------------------------------------------------------------------------

loc_14D6_3DE:				; CODE XREF: TransformedShapeOp+29Bj
					; TransformedShapeOp+355j
		inc	si

loc_14D6_3DF:				; CODE XREF: TransformedShapeOp+25Aj
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		cmp	ax, si
		ja	short loc_14D6_3EB
		jmp	loc_14D6_496
; ---------------------------------------------------------------------------

loc_14D6_3EB:				; CODE XREF: TransformedShapeOp+2A8j
		mov	bx, si
		shl	bx, 1
		mov	ax, si
		shl	ax, 1
		shl	ax, 1
		add	ax, bp
		sub	ax, 416h
		mov	g_pwTrnsfrmTab[bx], ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_pVertices
		mov	dx, word ptr g_pVertices+2
		push	si
		push	di
		lea	di, [bp+vec]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		cmp	g_pToRect, 0
		jz	short loc_14D6_436
		sar	[bp+vec.wX], 1
		sar	[bp+vec.wY], 1
		sar	[bp+vec.wZ], 1

loc_14D6_436:				; CODE XREF: TransformedShapeOp+2EAj
		lea	ax, [bp+vec2]
		push	ax
		lea	ax, [bp+pMatrix2]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec3.wX]
		add	[bp+vec2.wX], ax
		mov	ax, [bp+vec3.wY]
		add	[bp+vec2.wY], ax
		mov	ax, [bp+vec3.wZ]
		add	[bp+vec2.wZ], ax
		mov	bx, si
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		push	si
		push	di
		lea	di, [bx+vec4]
		lea	si, [bp+vec2]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		cmp	[bp+vec2.wZ], 0Ch
		jl	short loc_14D6_489
		jmp	loc_14D6_39A
; ---------------------------------------------------------------------------

loc_14D6_489:				; CODE XREF: TransformedShapeOp+346j
		mov	[bp+si+var_562], 1
		mov	[bp+var_1A], 1
		jmp	loc_14D6_3DE
; ---------------------------------------------------------------------------

loc_14D6_496:				; CODE XREF: TransformedShapeOp+2AAj
		cmp	[bp+var_460], 0
		jnz	short loc_14D6_4B6
		cmp	[bp+var_1A], 0
		jz	short loc_14D6_4B6
		push	[bp+vec3.wX]
		call	_abs
		add	sp, 2
		mov	bx, [bp+p_pTransShape]
		cmp	[bx+TransformedShape3D.field_10], ax
		jge	short loc_14D6_4C0

loc_14D6_4B6:				; CODE XREF: TransformedShapeOp+35Dj
					; TransformedShapeOp+363j ...
		mov	ax, 0FFFFh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_4C0:				; CODE XREF: TransformedShapeOp+29Dj
					; TransformedShapeOp+376j
		mov	bx, [bp+p_pTransShape]
		mov	bx, [bx+TransformedShape3D.pShape3D]
		mov	ax, word ptr [bx+Shape3D.pPrimitives]
		mov	dx, word ptr [bx+(Shape3D.pPrimitives+2)]
		mov	word ptr g_pPrimitives,	ax
		mov	word ptr g_pPrimitives+2, dx

loc_14D6_4D3:				; CODE XREF: TransformedShapeOp+F70j
		les	bx, g_pPrimitives
		mov	bl, es:[bx]
		sub	bh, bh
		mov	al, g_pcVertCountTab[bx]
		sub	ah, ah
		add	ax, g_wSelNumPaints
		add	ax, word ptr g_pPrimitives
		mov	dx, es
		add	ax, 2
		mov	word ptr g_pCurPrimitive, ax
		mov	word ptr g_pCurPrimitive+2, dx
		mov	bx, word ptr g_pPrimitives
		mov	al, es:[bx+1]
		sub	ah, ah
		mov	[bp+var_2], ax
		mov	[bp+var_4], 0
		les	bx, [bp+pdwCull1]
		mov	ax, es:[bx]
		mov	dx, es:[bx+2]
		and	ax, [bp+var_45C]
		and	dx, [bp+var_45A]
		or	dx, ax
		jnz	short loc_14D6_522
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_522:				; CODE XREF: TransformedShapeOp+3DFj
		les	bx, g_pPrimitives
		mov	al, es:[bx]
		sub	ah, ah
		mov	[bp+wPrimiType], ax
		mov	bx, ax
		mov	al, g_pcVertCountTab[bx]
		mov	g_cNumPolyVerts, al
		mov	al, g_pcPrimTypeTab[bx]
		mov	[bp+var_6], al
		mov	ax, g_wTrnsfrmShpOp3
		add	ax, word ptr g_pwPolyBuffer
		mov	dx, word ptr g_pwPolyBuffer+2
		mov	word ptr g_dwPolyBuf1, ax
		mov	word ptr g_dwPolyBuf1+2, dx
		mov	bx, g_wTrnsfrmShpOp2
		shl	bx, 1
		shl	bx, 1
		mov	word ptr g_pPolybufTab[bx], ax
		mov	word ptr (g_pPolybufTab+2)[bx],	dx
		mov	bl, g_cSelMaterial
		sub	bh, bh
		add	bx, word ptr g_pPrimitives
		mov	es, word ptr g_pPrimitives+2
		mov	al, es:[bx+2]
		mov	byte_2B77_6112,	al
		mov	ax, g_wSelNumPaints
		add	ax, 2
		add	word ptr g_pPrimitives,	ax
		mov	[bp+var_44A], 0Fh
		mov	[bp+var_460], 1
		mov	[bp+var_1A], 0
		mov	ax, word ptr g_pPrimitives
		mov	dx, es
		mov	word ptr g_pCurPrimitive2, ax
		mov	word ptr g_pCurPrimitive2+2, dx
		mov	[bp+var_E], 0
		jmp	short loc_14D6_5C8
; ---------------------------------------------------------------------------
		align 2

loc_14D6_5A4:				; CODE XREF: TransformedShapeOp+4C6j
		mov	[bp+var_460], 0

loc_14D6_5AA:				; CODE XREF: TransformedShapeOp+589j
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_5C5
		mov	bx, [bp+var_E]
		shl	bx, 1
		push	g_pwTrnsfrmTab[bx]
		push	cs
		call	near ptr sub_14D6_1182
		add	sp, 2
		and	[bp+var_44A], al

loc_14D6_5C5:				; CODE XREF: TransformedShapeOp+471j
					; TransformedShapeOp:loc_14D6_60Ej ...
		inc	[bp+var_E]

loc_14D6_5C8:				; CODE XREF: TransformedShapeOp+463j
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		cmp	[bp+var_E], ax
		jb	short loc_14D6_5D5
		jmp	loc_14D6_6CA
; ---------------------------------------------------------------------------

loc_14D6_5D5:				; CODE XREF: TransformedShapeOp+492j
		mov	bx, word ptr g_pCurPrimitive2
		inc	word ptr g_pCurPrimitive2
		mov	es, word ptr g_pCurPrimitive2+2
		mov	al, es:[bx]
		mov	si, ax
		mov	bx, [bp+var_E]
		shl	bx, 1
		shl	ax, 1
		shl	ax, 1
		add	ax, bp
		sub	ax, 416h
		mov	g_pwTrnsfrmTab[bx], ax
		mov	al, [bp+si+var_562]
		cbw
		cmp	ax, 0FFFFh
		jz	short loc_14D6_610
		or	ax, ax
		jz	short loc_14D6_5A4
		cmp	ax, 1
		jnz	short loc_14D6_60E
		jmp	loc_14D6_69D
; ---------------------------------------------------------------------------

loc_14D6_60E:				; CODE XREF: TransformedShapeOp+4CBj
		jmp	short loc_14D6_5C5
; ---------------------------------------------------------------------------

loc_14D6_610:				; CODE XREF: TransformedShapeOp+4C2j
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr g_pVertices
		mov	dx, word ptr g_pVertices+2
		push	si
		push	di
		lea	di, [bp+vec]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		movsw
		movsw
		movsw
		pop	ds
		pop	di
		pop	si
		cmp	g_pToRect, 0
		jz	short loc_14D6_648
		sar	[bp+vec.wX], 1
		sar	[bp+vec.wY], 1
		sar	[bp+vec.wZ], 1

loc_14D6_648:				; CODE XREF: TransformedShapeOp+4FCj
		lea	ax, [bp+vec2]
		push	ax
		lea	ax, [bp+pMatrix2]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	MatMultiplyVector
		add	sp, 6
		mov	ax, [bp+vec3.wX]
		add	[bp+vec2.wX], ax
		mov	ax, [bp+vec3.wY]
		add	[bp+vec2.wY], ax
		mov	ax, [bp+vec3.wZ]
		add	[bp+vec2.wZ], ax
		mov	bx, si
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		push	si
		push	di
		lea	di, [bx+vec4]
		lea	si, [bp+vec2]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		cmp	[bp+vec2.wZ], 0Ch
		jge	short loc_14D6_6A6
		mov	[bp+si+var_562], 1

loc_14D6_69D:				; CODE XREF: TransformedShapeOp+4CDj
		mov	[bp+var_1A], 1
		jmp	loc_14D6_5C5
; ---------------------------------------------------------------------------
		align 2

loc_14D6_6A6:				; CODE XREF: TransformedShapeOp+558j
		mov	[bp+var_460], 0
		mov	[bp+si+var_562], 0
		mov	bx, [bp+var_E]
		shl	bx, 1
		push	g_pwTrnsfrmTab[bx]
		lea	ax, [bp+vec2]
		push	ax
		call	VectorOp2
		add	sp, 4
		jmp	loc_14D6_5AA
; ---------------------------------------------------------------------------

loc_14D6_6CA:				; CODE XREF: TransformedShapeOp+494j
		cmp	[bp+var_460], 0
		jz	short loc_14D6_6D4
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_6D4:				; CODE XREF: TransformedShapeOp+591j
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_6E4
		cmp	[bp+var_1A], 0
		jnz	short loc_14D6_6E4
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_6E4:				; CODE XREF: TransformedShapeOp+59Bj
					; TransformedShapeOp+5A1j
		mov	al, [bp+var_6]
		sub	ah, ah
		or	ax, ax
		jz	short loc_14D6_710
		cmp	ax, 1
		jnz	short loc_14D6_6F5
		jmp	loc_14D6_AFC
; ---------------------------------------------------------------------------

loc_14D6_6F5:				; CODE XREF: TransformedShapeOp+5B2j
		cmp	ax, 2
		jnz	short loc_14D6_6FD
		jmp	loc_14D6_E4A
; ---------------------------------------------------------------------------

loc_14D6_6FD:				; CODE XREF: TransformedShapeOp+5BAj
		cmp	ax, 3
		jnz	short loc_14D6_705
		jmp	loc_14D6_C2E
; ---------------------------------------------------------------------------

loc_14D6_705:				; CODE XREF: TransformedShapeOp+5C2j
		cmp	ax, 5
		jnz	short loc_14D6_70D
		jmp	loc_14D6_F80
; ---------------------------------------------------------------------------

loc_14D6_70D:				; CODE XREF: TransformedShapeOp+5CAj
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_710:				; CODE XREF: TransformedShapeOp+5ADj
		mov	ax, word ptr g_dwPolyBuf1
		mov	dx, word ptr g_dwPolyBuf1+2
		add	ax, 6
		mov	word ptr [bp+var_430], ax
		mov	word ptr [bp+var_430+2], dx
		mov	ax, word ptr g_pPrimitives
		mov	dx, word ptr g_pPrimitives+2
		mov	word ptr g_pCurPrimitive2, ax
		mov	word ptr g_pCurPrimitive2+2, dx
		sub	ax, ax
		mov	[bp+var_16], ax
		mov	[bp+var_18], ax
		mov	[bp+var_44A], 0Fh
		cmp	[bp+var_1A], ax
		jnz	short loc_14D6_7B8
		sub	si, si
		jmp	short loc_14D6_747
; ---------------------------------------------------------------------------

loc_14D6_746:				; CODE XREF: TransformedShapeOp+678j
		inc	si

loc_14D6_747:				; CODE XREF: TransformedShapeOp+606j
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		cmp	ax, si
		ja	short loc_14D6_753
		jmp	loc_14D6_9BA
; ---------------------------------------------------------------------------

loc_14D6_753:				; CODE XREF: TransformedShapeOp+610j
		mov	bx, word ptr g_pCurPrimitive2
		inc	word ptr g_pCurPrimitive2
		mov	es, word ptr g_pCurPrimitive2+2
		mov	al, es:[bx+Primitive3D.cType]
		mov	[bp+var_C], ax
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx+vec4.wZ]
		cwd
		add	[bp+var_18], ax
		adc	[bp+var_16], dx
		mov	ax, si
		shl	ax, 1
		add	ax, offset g_pwTrnsfrmTab
		mov	[bp+var_B7A], ax
		mov	bx, ax
		mov	bx, [bx]
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, [bp+var_430]
		mov	es:[bx], ax
		mov	es:[bx+2], dx
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_7B1
		mov	bx, [bp+var_B7A]
		push	word ptr [bx]
		push	cs
		call	near ptr sub_14D6_1182
		add	sp, 2
		and	[bp+var_44A], al

loc_14D6_7B1:				; CODE XREF: TransformedShapeOp+660j
		add	word ptr [bp+var_430], 4
		jmp	short loc_14D6_746
; ---------------------------------------------------------------------------

loc_14D6_7B8:				; CODE XREF: TransformedShapeOp+602j
		mov	[bp+var_E], 0
		mov	bl, g_cNumPolyVerts
		sub	bh, bh
		add	bx, word ptr g_pPrimitives
		mov	es, word ptr g_pPrimitives+2
		mov	al, es:[bx-1]
		sub	ah, ah
		mov	[bp+var_448], ax
		sub	si, si
		jmp	loc_14D6_88E
; ---------------------------------------------------------------------------

loc_14D6_7DA:				; CODE XREF: TransformedShapeOp+794j
		mov	bx, [bp+var_448]
		add	bx, bp
		cmp	[bx+var_562], 0
		jz	short loc_14D6_7EA
		jmp	loc_14D6_886
; ---------------------------------------------------------------------------

loc_14D6_7EA:				; CODE XREF: TransformedShapeOp+6A7j
		mov	ax, 0Ch
		push	ax
		lea	ax, [bp+vec]
		push	ax
		mov	ax, [bp+var_C]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		mov	ax, [bp+var_448]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		call	VectorOp3
		add	sp, 8
		lea	ax, [bp+var_574]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	VectorOp2
		add	sp, 4
		mov	ax, [bp+var_448]
		shl	ax, 1
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_B7C], ax
		mov	bx, ax
		mov	ax, [bp+var_574]
		cmp	[bx+var_416], ax
		jnz	short loc_14D6_854
		mov	ax, [bp+var_572]
		cmp	[bx+var_414], ax
		jz	short loc_14D6_886

loc_14D6_854:				; CODE XREF: TransformedShapeOp+70Aj
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_86B
		lea	ax, [bp+var_574]
		push	ax
		push	cs
		call	near ptr sub_14D6_1182
		add	sp, 2
		and	[bp+var_44A], al

loc_14D6_86B:				; CODE XREF: TransformedShapeOp+71Bj
		les	bx, [bp+var_430]
		mov	ax, [bp+var_574]
		mov	dx, [bp+var_572]
		mov	es:[bx], ax
		mov	es:[bx+2], dx

loc_14D6_87E:				; CODE XREF: TransformedShapeOp+85Fj
					; TransformedShapeOp+873j
		add	word ptr [bp+var_430], 4
		inc	[bp+var_E]

loc_14D6_886:				; CODE XREF: TransformedShapeOp+6A9j
					; TransformedShapeOp+714j
		mov	ax, [bp+var_C]
		mov	[bp+var_448], ax
		inc	si

loc_14D6_88E:				; CODE XREF: TransformedShapeOp+699j
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		cmp	ax, si
		ja	short loc_14D6_89A
		jmp	loc_14D6_9B4
; ---------------------------------------------------------------------------

loc_14D6_89A:				; CODE XREF: TransformedShapeOp+757j
		mov	bx, word ptr g_pCurPrimitive2
		inc	word ptr g_pCurPrimitive2
		mov	es, word ptr g_pCurPrimitive2+2
		mov	al, es:[bx+Primitive3D.cType]
		mov	[bp+var_C], ax
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_B7A], ax
		mov	bx, ax
		mov	ax, [bx+vec4.wZ]
		cwd
		add	[bp+var_18], ax
		adc	[bp+var_16], dx
		mov	bx, cx
		add	bx, bp
		cmp	[bx+var_562], 0
		jz	short loc_14D6_8D5
		jmp	loc_14D6_7DA
; ---------------------------------------------------------------------------

loc_14D6_8D5:				; CODE XREF: TransformedShapeOp+792j
		mov	bx, [bp+var_448]
		add	bx, bp
		cmp	[bx+var_562], 0
		jnz	short loc_14D6_8E5
		jmp	loc_14D6_977
; ---------------------------------------------------------------------------

loc_14D6_8E5:				; CODE XREF: TransformedShapeOp+7A2j
		mov	ax, 0Ch
		push	ax
		lea	ax, [bp+vec]
		push	ax
		mov	ax, [bp+var_448]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		mov	ax, [bp+var_B7A]
		sub	ax, 0B6Eh
		push	ax
		call	VectorOp3
		add	sp, 8
		lea	ax, [bp+var_574]
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	VectorOp2
		add	sp, 4
		mov	ax, [bp+var_C]
		shl	ax, 1
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_B7C], ax
		mov	bx, ax
		mov	ax, [bp+var_574]
		cmp	[bx+var_416], ax
		jnz	short loc_14D6_945
		mov	ax, [bp+var_572]
		cmp	[bx+var_414], ax
		jz	short loc_14D6_977

loc_14D6_945:				; CODE XREF: TransformedShapeOp+7FBj
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_95C
		lea	ax, [bp+var_574]
		push	ax
		push	cs
		call	near ptr sub_14D6_1182
		add	sp, 2
		and	[bp+var_44A], al

loc_14D6_95C:				; CODE XREF: TransformedShapeOp+80Cj
		les	bx, [bp+var_430]
		mov	ax, [bp+var_574]
		mov	dx, [bp+var_572]
		mov	es:[bx], ax
		mov	es:[bx+2], dx
		add	word ptr [bp+var_430], 4
		inc	[bp+var_E]

loc_14D6_977:				; CODE XREF: TransformedShapeOp+7A4j
					; TransformedShapeOp+805j
		mov	ax, si
		shl	ax, 1
		add	ax, offset g_pwTrnsfrmTab
		mov	[bp+var_B7C], ax
		mov	bx, ax
		mov	bx, [bx]
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, [bp+var_430]
		mov	es:[bx], ax
		mov	es:[bx+2], dx
		cmp	[bp+var_44A], 0
		jnz	short loc_14D6_9A0
		jmp	loc_14D6_87E
; ---------------------------------------------------------------------------

loc_14D6_9A0:				; CODE XREF: TransformedShapeOp+85Dj
		mov	bx, [bp+var_B7C]
		push	word ptr [bx]
		push	cs
		call	near ptr sub_14D6_1182
		add	sp, 2
		and	[bp+var_44A], al
		jmp	loc_14D6_87E
; ---------------------------------------------------------------------------

loc_14D6_9B4:				; CODE XREF: TransformedShapeOp+759j
		mov	al, byte ptr [bp+var_E]
		mov	g_cNumPolyVerts, al

loc_14D6_9BA:				; CODE XREF: TransformedShapeOp+612j
		cmp	g_cNumPolyVerts, 0
		jnz	short loc_14D6_9C4
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_9C4:				; CODE XREF: TransformedShapeOp+881j
		cmp	[bp+var_44A], 0
		jz	short loc_14D6_9CE
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_9CE:				; CODE XREF: TransformedShapeOp+88Bj
		test	byte ptr [bp+var_2], 1
		jnz	short loc_14D6_A00
		les	bx, [bp+pwdCull2]
		mov	ax, es:[bx]
		mov	dx, es:[bx+2]
		and	ax, [bp+var_A]
		and	dx, [bp+var_8]
		or	dx, ax
		jnz	short loc_14D6_A00
		mov	ax, word ptr g_dwPolyBuf1
		mov	dx, word ptr g_dwPolyBuf1+2
		add	ax, 6
		push	dx
		push	ax
		push	cs
		call	near ptr sub_14D6_11CE
		add	sp, 4
		or	al, al
		jz	short loc_14D6_A03

loc_14D6_A00:				; CODE XREF: TransformedShapeOp+894j
					; TransformedShapeOp+8A9j
		inc	[bp+var_4]

loc_14D6_A03:				; CODE XREF: TransformedShapeOp+8C0j
		cmp	[bp+var_4], 0
		jnz	short loc_14D6_A0C
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_A0C:				; CODE XREF: TransformedShapeOp+8C9j
		test	g_cSelShapeFlags, 8
		jnz	short loc_14D6_A16
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_A16:				; CODE XREF: TransformedShapeOp+8D3j
		mov	ax, word ptr g_dwPolyBuf1
		mov	dx, word ptr g_dwPolyBuf1+2
		add	ax, 6
		mov	word ptr [bp+var_56E], ax
		mov	word ptr [bp+var_56E+2], dx
		mov	[bp+var_E], 0
		jmp	short loc_14D6_A97
; ---------------------------------------------------------------------------
		align 2

loc_14D6_A30:				; CODE XREF: TransformedShapeOp+961j
		les	bx, [bp+var_56E]
		mov	ax, es:[bx]
		mov	[bp+var_564], ax
		mov	ax, es:[bx+2]
		mov	[bp+var_570], ax
		add	word ptr [bp+var_56E], 4
		mov	bx, g_pSelRect
		mov	ax, [bx+Rectangle.dwLeft]
		cmp	[bp+var_564], ax
		jge	short loc_14D6_A5A
		mov	ax, [bp+var_564]
		mov	[bx+Rectangle.dwLeft], ax

loc_14D6_A5A:				; CODE XREF: TransformedShapeOp+914j
		mov	ax, [bp+var_564]
		inc	ax
		mov	[bp+var_B7C], ax
		mov	bx, g_pSelRect
		cmp	[bx+Rectangle.dwTop], ax
		jge	short loc_14D6_A6F
		mov	[bx+Rectangle.dwTop], ax

loc_14D6_A6F:				; CODE XREF: TransformedShapeOp+92Cj
		mov	bx, g_pSelRect
		mov	ax, [bp+var_570]
		cmp	[bx+Rectangle.dwRight],	ax
		jle	short loc_14D6_A7F
		mov	[bx+Rectangle.dwRight],	ax

loc_14D6_A7F:				; CODE XREF: TransformedShapeOp+93Cj
		mov	ax, [bp+var_570]
		inc	ax
		mov	[bp+var_B7C], ax
		mov	bx, g_pSelRect
		cmp	[bx+Rectangle.dwBottom], ax
		jge	short loc_14D6_A94
		mov	[bx+Rectangle.dwBottom], ax

loc_14D6_A94:				; CODE XREF: TransformedShapeOp+951j
		inc	[bp+var_E]

loc_14D6_A97:				; CODE XREF: TransformedShapeOp+8EFj
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		cmp	[bp+var_E], ax
		jb	short loc_14D6_A30

loc_14D6_AA1:				; CODE XREF: TransformedShapeOp+3E1j
					; TransformedShapeOp+593j ...
		mov	ax, word ptr g_pCurPrimitive
		mov	dx, word ptr g_pCurPrimitive+2
		mov	word ptr g_pPrimitives,	ax
		mov	word ptr g_pPrimitives+2, dx
		add	word ptr [bp+pwdCull2],	4
		add	word ptr [bp+pdwCull1],	4
		cmp	[bp+var_4], 0
		jz	short loc_14D6_AC2
		jmp	loc_14D6_FDC
; ---------------------------------------------------------------------------

loc_14D6_AC2:				; CODE XREF: TransformedShapeOp+97Fj
		test	byte ptr [bp+var_2], 2
		jz	short loc_14D6_ACB
		jmp	loc_14D6_10A4
; ---------------------------------------------------------------------------

loc_14D6_ACB:				; CODE XREF: TransformedShapeOp+988j
					; TransformedShapeOp+9BBj
		les	bx, g_pPrimitives
		test	es:[bx+Primitive3D.cFlags], 2
		jnz	short loc_14D6_AD9
		jmp	loc_14D6_10A4
; ---------------------------------------------------------------------------

loc_14D6_AD9:				; CODE XREF: TransformedShapeOp+996j
		mov	bl, es:[bx]
		sub	bh, bh
		mov	al, g_pcVertCountTab[bx]
		sub	ah, ah
		add	ax, g_wSelNumPaints
		add	ax, 2
		add	word ptr g_pPrimitives,	ax
		add	word ptr [bp+pdwCull1],	4
		add	word ptr [bp+pwdCull2],	4
		jmp	short loc_14D6_ACB
; ---------------------------------------------------------------------------
		align 2

loc_14D6_AFC:				; CODE XREF: TransformedShapeOp+5B4j
		les	bx, g_pPrimitives
		mov	al, es:[bx+Primitive3D.cType]
		sub	ah, ah
		mov	si, ax
		mov	al, es:[bx+Primitive3D.cFlags]
		mov	di, ax
		mov	al, [bp+di+var_562]
		cbw
		mov	cx, ax
		mov	al, [bp+si+var_562]
		cbw
		add	ax, cx
		cmp	ax, 2
		jz	short loc_14D6_AA1
		cmp	[bp+si+var_562], 0
		jz	short loc_14D6_B5C
		mov	ax, 0Ch
		push	ax
		lea	ax, [bp+vec]
		push	ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		call	VectorOp3
		add	sp, 8
		mov	ax, si
		jmp	short loc_14D6_B96
; ---------------------------------------------------------------------------

loc_14D6_B5C:				; CODE XREF: TransformedShapeOp+9E7j
		cmp	[bp+di+var_562], 0
		jz	short loc_14D6_BAD
		mov	ax, 0Ch
		push	ax
		lea	ax, [bp+vec]
		push	ax
		mov	ax, di
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		sub	ax, 0B6Eh
		push	ax
		call	VectorOp3
		add	sp, 8
		mov	ax, di

loc_14D6_B96:				; CODE XREF: TransformedShapeOp+A1Cj
		shl	ax, 1
		shl	ax, 1
		add	ax, bp
		sub	ax, 416h
		push	ax
		lea	ax, [bp+vec]
		push	ax
		call	VectorOp2
		add	sp, 4

loc_14D6_BAD:				; CODE XREF: TransformedShapeOp+A23j
		mov	bx, si
		mov	ax, bx
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx+vec4.wZ]
		mov	bx, di
		mov	cx, bx
		shl	bx, 1
		add	bx, cx
		shl	bx, 1
		add	bx, bp
		add	ax, [bx+vec4.wZ]
		cwd
		mov	[bp+var_18], ax
		mov	[bp+var_16], dx
		mov	bx, g_pwTrnsfrmTab
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+6], ax
		mov	es:[bx+8], dx
		mov	bx, word_2B77_60E6
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+0Ah], ax
		mov	es:[bx+0Ch], dx
		test	g_cSelShapeFlags, 8
		jz	short loc_14D6_C23
		push	g_pSelRect
		push	g_pwTrnsfrmTab
		push	cs
		call	near ptr RectOp
		add	sp, 4
		push	g_pSelRect
		push	word_2B77_60E6

loc_14D6_C1C:				; CODE XREF: TransformedShapeOp+E3Fj
		push	cs
		call	near ptr RectOp
		add	sp, 4

loc_14D6_C23:				; CODE XREF: TransformedShapeOp+AC5j
					; TransformedShapeOp+DF1j
		mov	g_cNumPolyVerts, 2

loc_14D6_C28:				; CODE XREF: TransformedShapeOp+E9Bj
		inc	[bp+var_4]
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_C2E:				; CODE XREF: TransformedShapeOp+5C4j
		cmp	[bp+var_1A], 0
		jz	short loc_14D6_C37
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_C37:				; CODE XREF: TransformedShapeOp+AF4j
		mov	bx, g_pwTrnsfrmTab
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+6], ax
		mov	es:[bx+8], dx
		mov	bx, word_2B77_60E6
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+0Ah], ax
		mov	es:[bx+0Ch], dx
		mov	bx, word_2B77_60E8
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+0Eh], ax
		mov	es:[bx+10h], dx
		mov	bx, word_2B77_60EA
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+12h], ax
		mov	es:[bx+14h], dx
		mov	ax, word ptr g_dwPolyBuf1
		mov	dx, word ptr g_dwPolyBuf1+2
		add	ax, 6
		push	dx
		push	ax
		push	cs
		call	near ptr sub_14D6_11CE
		add	sp, 4
		or	al, al
		jnz	short loc_14D6_D1C
		mov	bx, word_2B77_60EA
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+6], ax
		mov	es:[bx+8], dx
		mov	bx, word_2B77_60EC
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+0Ah], ax
		mov	es:[bx+0Ch], dx
		mov	bx, word_2B77_60EE
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+0Eh], ax
		mov	es:[bx+10h], dx
		mov	bx, g_pwTrnsfrmTab
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+12h], ax
		mov	es:[bx+14h], dx
		les	bx, g_pPrimitives
		mov	al, es:[bx+3]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx+vec4.wZ]
		cwd
		mov	cl, 2

loc_14D6_D11:				; CODE XREF: TransformedShapeOp+BD9j
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_14D6_D11
		jmp	short loc_14D6_D3E
; ---------------------------------------------------------------------------
		align 2

loc_14D6_D1C:				; CODE XREF: TransformedShapeOp+B62j
		les	bx, g_pPrimitives
		mov	al, es:[bx+Primitive3D.cType]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx+vec4.wZ]
		cwd
		mov	cl, 2

loc_14D6_D36:				; CODE XREF: TransformedShapeOp+BFEj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_14D6_D36

loc_14D6_D3E:				; CODE XREF: TransformedShapeOp+BDBj
		mov	[bp+var_18], ax
		mov	[bp+var_16], dx
		les	bx, g_dwPolyBuf1
		mov	ax, es:[bx+8]
		sub	ax, es:[bx+0Ch]
		push	ax
		mov	ax, es:[bx+6]
		sub	ax, es:[bx+0Ah]
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	si, ax
		les	bx, g_dwPolyBuf1
		mov	ax, es:[bx+8]
		sub	ax, es:[bx+10h]
		push	ax
		mov	ax, es:[bx+6]
		sub	ax, es:[bx+0Eh]
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	di, ax
		cmp	di, si
		jle	short loc_14D6_D8A
		mov	si, di

loc_14D6_D8A:				; CODE XREF: TransformedShapeOp+C48j
		test	g_cSelShapeFlags, 8
		jnz	short loc_14D6_D94
		jmp	loc_14D6_E3C
; ---------------------------------------------------------------------------

loc_14D6_D94:				; CODE XREF: TransformedShapeOp+C51j
		les	bx, g_dwPolyBuf1
		mov	ax, es:[bx+6]
		sub	ax, si
		dec	ax
		mov	[bp+var_450], ax
		mov	ax, es:[bx+8]
		sub	ax, si
		dec	ax
		mov	[bp+var_44E], ax
		push	g_pSelRect
		lea	ax, [bp+var_450]
		push	ax
		push	cs
		call	near ptr RectOp
		add	sp, 4
		les	bx, g_dwPolyBuf1
		mov	ax, es:[bx+8]
		add	ax, si
		inc	ax
		mov	[bp+var_44E], ax
		mov	ax, es:[bx+6]
		add	ax, si
		inc	ax
		mov	[bp+var_450], ax
		push	g_pSelRect
		lea	ax, [bp+var_450]
		push	ax
		push	cs
		call	near ptr RectOp
		add	sp, 4
		les	bx, g_dwPolyBuf1
		mov	ax, es:[bx+12h]
		sub	ax, si
		dec	ax
		mov	[bp+var_450], ax
		mov	ax, es:[bx+14h]
		sub	ax, si
		dec	ax
		mov	[bp+var_44E], ax
		push	g_pSelRect
		lea	ax, [bp+var_450]
		push	ax
		push	cs
		call	near ptr RectOp
		add	sp, 4
		les	bx, g_dwPolyBuf1
		mov	ax, es:[bx+14h]
		add	ax, si
		inc	ax
		mov	[bp+var_44E], ax
		mov	ax, es:[bx+12h]
		add	ax, si
		inc	ax
		mov	[bp+var_450], ax
		push	g_pSelRect
		lea	ax, [bp+var_450]
		push	ax
		push	cs
		call	near ptr RectOp
		add	sp, 4

loc_14D6_E3C:				; CODE XREF: TransformedShapeOp+C53j
		mov	g_cNumPolyVerts, 4
		mov	[bp+var_4], 1
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------
		align 2

loc_14D6_E4A:				; CODE XREF: TransformedShapeOp+5BCj
		les	bx, g_pPrimitives
		mov	al, es:[bx]
		sub	ah, ah
		mov	si, ax
		mov	al, es:[bx+1]
		mov	di, ax
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_B7C], ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_B7A], ax
		mov	bx, ax
		mov	ax, [bx+vec4.wZ]
		mov	bx, [bp+var_B7C]
		add	ax, [bx+vec4.wZ]
		cwd
		mov	[bp+var_18], ax
		mov	[bp+var_16], dx
		mov	al, [bp+di+var_562]
		cbw
		mov	cx, ax
		mov	al, [bp+si+var_562]
		cbw
		add	ax, cx
		jz	short loc_14D6_EA1
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_EA1:				; CODE XREF: TransformedShapeOp+D5Ej
		mov	bx, g_pwTrnsfrmTab
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+6], ax
		mov	es:[bx+8], dx
		mov	bx, [bp+var_B7A]
		push	si
		push	di
		lea	di, [bp+vec2]
		lea	si, [bx+vec4]
		push	ss
		pop	es
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	bx, [bp+var_B7C]
		push	si
		push	di
		lea	di, [bp+var_B74]
		lea	si, [bx+vec4]
		movsw
		movsw
		movsw
		pop	di
		pop	si
		mov	ax, [bp+vec2.wX]
		sub	ax, [bp+var_B74]
		mov	[bp+vec.wX], ax
		mov	ax, [bp+vec2.wY]
		sub	ax, [bp+var_B72]
		mov	[bp+vec.wY], ax
		mov	ax, [bp+vec2.wZ]
		sub	ax, [bp+var_B70]
		mov	[bp+vec.wZ], ax
		push	[bp+vec2.wZ]
		lea	ax, [bp+vec]
		push	ax
		call	ZXCosSinX2
		add	sp, 2
		push	ax
		call	sub_1EA2_3D3C
		add	sp, 4
		mov	[bp+var_462], ax
		les	bx, g_dwPolyBuf1
		mov	es:[bx+0Ah], ax
		test	g_cSelShapeFlags, 8
		jnz	short loc_14D6_F32
		jmp	loc_14D6_C23
; ---------------------------------------------------------------------------

loc_14D6_F32:				; CODE XREF: TransformedShapeOp+DEFj
		mov	bx, g_pwTrnsfrmTab
		mov	ax, [bx+2]
		sub	ax, [bp+var_462]
		mov	[bp+var_44E], ax
		mov	ax, [bx]
		sub	ax, [bp+var_462]
		mov	[bp+var_450], ax
		push	g_pSelRect
		lea	ax, [bp+var_450]
		push	ax
		push	cs
		call	near ptr RectOp
		add	sp, 4
		mov	ax, [bp+var_462]
		mov	bx, g_pwTrnsfrmTab
		add	ax, [bx]
		mov	[bp+var_450], ax
		mov	ax, [bx+2]
		add	ax, [bp+var_462]
		mov	[bp+var_450], ax
		push	g_pSelRect
		lea	ax, [bp+var_450]
		push	ax
		jmp	loc_14D6_C1C
; ---------------------------------------------------------------------------

loc_14D6_F80:				; CODE XREF: TransformedShapeOp+5CCj
		les	bx, g_pPrimitives
		mov	al, es:[bx]
		sub	ah, ah
		mov	si, ax
		cmp	[bp+si+var_562], ah
		jz	short loc_14D6_F94
		jmp	loc_14D6_AA1
; ---------------------------------------------------------------------------

loc_14D6_F94:				; CODE XREF: TransformedShapeOp+E51j
		mov	bx, si
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx+vec4.wZ]
		cwd
		mov	[bp+var_18], ax
		mov	[bp+var_16], dx
		mov	bx, g_pwTrnsfrmTab
		mov	ax, [bx]
		mov	dx, [bx+2]
		les	bx, g_dwPolyBuf1
		mov	es:[bx+6], ax
		mov	es:[bx+8], dx
		test	g_cSelShapeFlags, 8
		jz	short loc_14D6_FD4
		push	g_pSelRect
		push	g_pwTrnsfrmTab
		push	cs
		call	near ptr RectOp
		add	sp, 4

loc_14D6_FD4:				; CODE XREF: TransformedShapeOp+E85j
		mov	g_cNumPolyVerts, 1
		jmp	loc_14D6_C28
; ---------------------------------------------------------------------------

loc_14D6_FDC:				; CODE XREF: TransformedShapeOp+981j
		inc	[bp+var_45E]
		les	bx, g_dwPolyBuf1
		mov	al, g_cNumPolyVerts
		mov	es:[bx+3], al
		les	bx, g_dwPolyBuf1
		mov	al, [bp+var_6]
		mov	es:[bx+4], al
		cmp	byte_2B77_6112,	2Dh ; '-'
		jnz	short loc_14D6_1006
		les	bx, g_dwPolyBuf1
		mov	al, byte_2B77_9DA4
		jmp	short loc_14D6_100D
; ---------------------------------------------------------------------------

loc_14D6_1006:				; CODE XREF: TransformedShapeOp+EBDj
		les	bx, g_dwPolyBuf1
		mov	al, byte_2B77_6112

loc_14D6_100D:				; CODE XREF: TransformedShapeOp+EC6j
		mov	es:[bx+2], al
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		cmp	ax, 1
		jz	short loc_14D6_103C
		cmp	ax, 2
		jz	short loc_14D6_1058
		cmp	ax, 4
		jz	short loc_14D6_1066
		cmp	ax, 8
		jz	short loc_14D6_107A
		sub	cx, cx
		push	cx
		push	ax
		push	[bp+var_16]
		push	[bp+var_18]
		call	__aFuldiv
		jmp	short loc_14D6_1062
; ---------------------------------------------------------------------------
		align 2

loc_14D6_103C:				; CODE XREF: TransformedShapeOp+EDBj
		mov	si, [bp+var_18]

loc_14D6_103F:				; CODE XREF: TransformedShapeOp+F26j
		les	bx, g_dwPolyBuf1
		mov	es:[bx], si
		test	g_cSelShapeFlags, 1
		jnz	short loc_14D6_1053
		test	byte ptr [bp+var_2], 2
		jz	short loc_14D6_108E

loc_14D6_1053:				; CODE XREF: TransformedShapeOp+F0Dj
		sub	ax, ax
		jmp	short loc_14D6_1091
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1058:				; CODE XREF: TransformedShapeOp+EE0j
		mov	ax, [bp+var_18]
		mov	dx, [bp+var_16]
		sar	dx, 1
		rcr	ax, 1

loc_14D6_1062:				; CODE XREF: TransformedShapeOp+EFBj
					; TransformedShapeOp+F32j ...
		mov	si, ax
		jmp	short loc_14D6_103F
; ---------------------------------------------------------------------------

loc_14D6_1066:				; CODE XREF: TransformedShapeOp+EE5j
		mov	ax, [bp+var_18]
		mov	dx, [bp+var_16]
		mov	cl, 2

loc_14D6_106E:				; CODE XREF: TransformedShapeOp+F3Aj
		or	cl, cl
		jz	short loc_14D6_1062
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jmp	short loc_14D6_106E
; ---------------------------------------------------------------------------

loc_14D6_107A:				; CODE XREF: TransformedShapeOp+EEAj
		mov	ax, [bp+var_18]
		mov	dx, [bp+var_16]
		mov	cl, 3

loc_14D6_1082:				; CODE XREF: TransformedShapeOp+F4Ej
		or	cl, cl
		jz	short loc_14D6_1062
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jmp	short loc_14D6_1082
; ---------------------------------------------------------------------------

loc_14D6_108E:				; CODE XREF: TransformedShapeOp+F13j
		mov	ax, 1

loc_14D6_1091:				; CODE XREF: TransformedShapeOp+F17j
		push	ax
		push	si
		push	cs
		call	near ptr sub_14D6_10C4
		add	sp, 4
		mov	g_wTrnsfrmShpOpFlag, ax
		or	ax, ax
		jz	short loc_14D6_10A4
		jmp	loc_14D6_14E
; ---------------------------------------------------------------------------

loc_14D6_10A4:				; CODE XREF: TransformedShapeOp+98Aj
					; TransformedShapeOp+998j ...
		les	bx, g_pPrimitives
		cmp	byte ptr es:[bx], 0
		jz	short loc_14D6_10B1
		jmp	loc_14D6_4D3
; ---------------------------------------------------------------------------

loc_14D6_10B1:				; CODE XREF: TransformedShapeOp+F6Ej
		cmp	[bp+var_45E], 0
		jnz	short loc_14D6_10BB
		jmp	loc_14D6_4B6
; ---------------------------------------------------------------------------

loc_14D6_10BB:				; CODE XREF: TransformedShapeOp+F78j
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TransformedShapeOp endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_14D6_10C4	proc far		; CODE XREF: TransformedShapeOp+F56p

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		cmp	[bp+arg_2], 0
		jnz	short loc_14D6_10DE
		mov	bx, g_wTrnsfrmOp2
		shl	bx, 1
		mov	di, word ptr unk_2B77_5766[bx]
		jmp	short loc_14D6_111B
; ---------------------------------------------------------------------------

loc_14D6_10DE:				; CODE XREF: sub_14D6_10C4+Cj
		mov	ax, g_wTrnsfrmOp
		mov	g_wTrnsfrmOp2, ax
		mov	bx, ax
		shl	bx, 1
		mov	di, word ptr unk_2B77_5766[bx]
		mov	si, g_wTrnsfrmOp3
		jmp	short loc_14D6_1117
; ---------------------------------------------------------------------------

loc_14D6_10F2:				; CODE XREF: sub_14D6_10C4+55j
		mov	ax, si
		dec	si
		or	ax, ax
		jz	short loc_14D6_111B
		mov	bx, di
		shl	bx, 1
		shl	bx, 1
		les	bx, g_pPolybufTab[bx]
		mov	ax, [bp+arg_0]
		cmp	es:[bx], ax
		jl	short loc_14D6_111B
		mov	g_wTrnsfrmOp2, di
		mov	bx, di
		shl	bx, 1
		mov	di, word ptr unk_2B77_5766[bx]

loc_14D6_1117:				; CODE XREF: sub_14D6_10C4+2Cj
		or	di, di
		jge	short loc_14D6_10F2

loc_14D6_111B:				; CODE XREF: sub_14D6_10C4+18j
					; sub_14D6_10C4+33j ...
		mov	bx, g_wTrnsfrmShpOp2
		shl	bx, 1
		mov	word ptr unk_2B77_5766[bx], di
		mov	bx, g_wTrnsfrmOp2
		shl	bx, 1
		mov	ax, g_wTrnsfrmShpOp2
		mov	word ptr unk_2B77_5766[bx], ax
		inc	g_wTrnsfrmOp3
		or	di, di
		jge	short loc_14D6_1140
		mov	ax, g_wTrnsfrmShpOp2
		mov	g_wTrnsfrmShpOp, ax

loc_14D6_1140:				; CODE XREF: sub_14D6_10C4+74j
		mov	bx, g_wTrnsfrmOp2
		shl	bx, 1
		mov	ax, word ptr unk_2B77_5766[bx]
		mov	g_wTrnsfrmOp2, ax
		inc	g_wTrnsfrmShpOp2
		mov	al, g_cNumPolyVerts
		sub	ah, ah
		shl	ax, 1
		shl	ax, 1
		add	ax, 6
		add	g_wTrnsfrmShpOp3, ax
		cmp	g_wTrnsfrmShpOp2, 190h
		jz	short loc_14D6_1171
		cmp	g_wTrnsfrmShpOp3, 2872h
		jle	short loc_14D6_117A

loc_14D6_1171:				; CODE XREF: sub_14D6_10C4+A3j
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_14D6_117A:				; CODE XREF: sub_14D6_10C4+ABj
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_14D6_10C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_14D6_1182	proc far		; CODE XREF: TransformedShapeOp+28Cp
					; TransformedShapeOp+47Dp ...

var_4		= byte ptr -4
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		mov	si, [bp+arg_0]
		mov	ax, g_rcCurRect.dwRight
		cmp	[si+2],	ax
		jge	short loc_14D6_119A
		mov	[bp+var_4], 1
		jmp	short loc_14D6_11AC
; ---------------------------------------------------------------------------

loc_14D6_119A:				; CODE XREF: sub_14D6_1182+10j
		mov	ax, g_rcCurRect.dwBottom
		cmp	[si+2],	ax
		jle	short loc_14D6_11A8
		mov	[bp+var_4], 2
		jmp	short loc_14D6_11AC
; ---------------------------------------------------------------------------

loc_14D6_11A8:				; CODE XREF: sub_14D6_1182+1Ej
		mov	[bp+var_4], 0

loc_14D6_11AC:				; CODE XREF: sub_14D6_1182+16j
					; sub_14D6_1182+24j
		mov	ax, g_rcCurRect.dwLeft
		cmp	[si], ax
		jge	short loc_14D6_11BA
		or	[bp+var_4], 4
		jmp	short loc_14D6_11C5
; ---------------------------------------------------------------------------
		align 2

loc_14D6_11BA:				; CODE XREF: sub_14D6_1182+2Fj
		mov	ax, g_rcCurRect.dwTop
		cmp	[si], ax
		jle	short loc_14D6_11C5
		or	[bp+var_4], 8

loc_14D6_11C5:				; CODE XREF: sub_14D6_1182+35j
					; sub_14D6_1182+3Dj
		mov	al, [bp+var_4]
		cbw
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_14D6_1182	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_14D6_11CE	proc far		; CODE XREF: TransformedShapeOp+8B8p
					; TransformedShapeOp+B5Ap

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	di
		push	si
		les	bx, [bp+arg_0]
		mov	ax, es:[bx+4]
		cwd
		mov	cx, ax
		mov	ax, es:[bx]
		mov	bx, dx
		cwd
		sub	ax, cx
		sbb	dx, bx
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		mov	bx, word ptr [bp+arg_0]
		mov	ax, es:[bx+4]
		cwd
		mov	cx, ax
		mov	ax, es:[bx+8]
		mov	bx, dx
		cwd
		sub	ax, cx
		sbb	dx, bx
		mov	[bp+var_C], ax
		mov	[bp+var_A], dx
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jnz	short loc_14D6_121A
		mov	ax, [bp+var_C]
		or	ax, dx
		jz	short loc_14D6_128E

loc_14D6_121A:				; CODE XREF: sub_14D6_11CE+43j
		mov	bx, word ptr [bp+arg_0]
		mov	ax, es:[bx+2]
		sub	ax, es:[bx+6]
		cwd
		mov	[bp+var_8], ax
		mov	[bp+var_6], dx
		mov	ax, es:[bx+0Ah]
		sub	ax, es:[bx+6]
		cwd
		mov	[bp+var_10], ax
		mov	[bp+var_E], dx
		mov	ax, [bp+var_8]
		or	ax, [bp+var_6]
		jnz	short loc_14D6_124A
		mov	ax, [bp+var_10]
		or	ax, dx
		jz	short loc_14D6_128E

loc_14D6_124A:				; CODE XREF: sub_14D6_11CE+73j
		push	[bp+var_E]
		push	[bp+var_10]
		push	[bp+var_2]
		push	[bp+var_4]
		call	__aFlmul
		push	[bp+var_6]
		push	[bp+var_8]
		push	[bp+var_A]
		push	[bp+var_C]
		mov	si, ax
		mov	di, dx
		call	__aFlmul
		sub	ax, si
		sbb	dx, di
		or	dx, dx
		jl	short loc_14D6_1284
		jg	short loc_14D6_127E
		or	ax, ax
		jz	short loc_14D6_1284

loc_14D6_127E:				; CODE XREF: sub_14D6_11CE+AAj
		mov	al, 1
		jmp	short loc_14D6_1286
; ---------------------------------------------------------------------------
		align 4

loc_14D6_1284:				; CODE XREF: sub_14D6_11CE+A8j
					; sub_14D6_11CE+AEj
		sub	al, al

loc_14D6_1286:				; CODE XREF: sub_14D6_11CE+B2j
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_128E:				; CODE XREF: sub_14D6_11CE+4Aj
					; sub_14D6_11CE+7Aj
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_14D6_11CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_14D6_1296	proc far		; CODE XREF: RunCarMenu+9FAP
					; UpdateFrame+F85P ...

var_40		= word ptr -40h
var_3E		= dword	ptr -3Eh
var_38		= dword	ptr -38h
var_32		= byte ptr -32h
var_30		= word ptr -30h
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 40h
		push	di
		push	si
		mov	di, 190h
		sub	si, si
		jmp	loc_14D6_134C
; ---------------------------------------------------------------------------

loc_14D6_12A6:				; CODE XREF: sub_14D6_1296+102j
		les	bx, [bp+var_38]
		mov	al, es:[bx+3]
		cbw
		mov	[bp+var_2], ax
		mov	ax, bx
		mov	dx, es
		add	ax, 6
		mov	word ptr [bp+var_3E], ax
		mov	word ptr [bp+var_3E+2],	dx
		lea	ax, [bp+var_32]
		mov	[bp+var_A], ax
		mov	[bp+var_4], 0
		jmp	short loc_14D6_12E9
; ---------------------------------------------------------------------------
		align 2

loc_14D6_12CC:				; CODE XREF: sub_14D6_1296+59j
		les	bx, [bp+var_3E]
		mov	ax, es:[bx]
		mov	dx, es:[bx+2]
		mov	bx, [bp+var_A]
		mov	[bx], ax
		mov	[bx+2],	dx
		add	[bp+var_A], 4
		add	word ptr [bp+var_3E], 4
		inc	[bp+var_4]

loc_14D6_12E9:				; CODE XREF: sub_14D6_1296+33j
		mov	ax, [bp+var_2]
		cmp	[bp+var_4], ax
		jb	short loc_14D6_12CC
		mov	bx, [bp+var_6]
		shl	bx, 1
		add	bx, g_wVidConstCp3
		mov	ax, [bx]
		or	ax, ax
		jz	short loc_14D6_1310
		cmp	ax, 1
		jz	short loc_14D6_1324
		cmp	ax, 2
		jnz	short loc_14D6_130D
		jmp	loc_14D6_13B8
; ---------------------------------------------------------------------------

loc_14D6_130D:				; CODE XREF: sub_14D6_1296+72j
		jmp	short loc_14D6_134B
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1310:				; CODE XREF: sub_14D6_1296+68j
		lea	ax, [bp+var_32]
		push	ax
		push	[bp+var_2]
		push	[bp+var_8]
		call	far ptr	DoDeriveSpriteOp3

loc_14D6_131F:				; CODE XREF: sub_14D6_1296+1F7j
		add	sp, 6
		jmp	short loc_14D6_134B
; ---------------------------------------------------------------------------

loc_14D6_1324:				; CODE XREF: sub_14D6_1296+6Dj
		mov	bx, [bp+var_6]
		shl	bx, 1
		add	bx, g_wVidConstCp4
		mov	ax, [bx]
		mov	[bp+var_40], ax
		or	ax, ax
		jz	short loc_14D6_134B
		lea	ax, [bp+var_32]
		push	ax
		push	[bp+var_2]
		push	[bp+var_8]
		push	[bp+var_40]
		call	DeriveSpriteOp4

loc_14D6_1348:				; CODE XREF: sub_14D6_1296+1E1j
		add	sp, 8

loc_14D6_134B:				; CODE XREF: sub_14D6_1296:loc_14D6_130Dj
					; sub_14D6_1296+8Cj ...
		inc	si

loc_14D6_134C:				; CODE XREF: sub_14D6_1296+Dj
		mov	ax, si
		cmp	ax, g_wTrnsfrmShpOp2
		jb	short loc_14D6_1357
		jmp	loc_14D6_1490
; ---------------------------------------------------------------------------

loc_14D6_1357:				; CODE XREF: sub_14D6_1296+BCj
		mov	bx, di
		shl	bx, 1
		mov	di, word ptr unk_2B77_5766[bx]
		mov	bx, di
		shl	bx, 1
		shl	bx, 1
		mov	ax, word ptr g_pPolybufTab[bx]
		mov	dx, word ptr (g_pPolybufTab+2)[bx]
		mov	word ptr [bp+var_38], ax
		mov	word ptr [bp+var_38+2],	dx
		les	bx, [bp+var_38]
		mov	al, es:[bx+2]
		sub	ah, ah
		mov	[bp+var_6], ax
		mov	bx, ax
		shl	bx, 1
		add	bx, g_wVidConstCp1
		mov	ax, [bx]
		mov	[bp+var_8], ax
		mov	bx, word ptr [bp+var_38]
		mov	al, es:[bx+4]
		cbw
		or	ax, ax
		jnz	short loc_14D6_139B
		jmp	loc_14D6_12A6
; ---------------------------------------------------------------------------

loc_14D6_139B:				; CODE XREF: sub_14D6_1296+100j
		cmp	ax, 1
		jz	short loc_14D6_13E4
		cmp	ax, 2
		jnz	short loc_14D6_13A8
		jmp	loc_14D6_1460
; ---------------------------------------------------------------------------

loc_14D6_13A8:				; CODE XREF: sub_14D6_1296+10Dj
		cmp	ax, 3
		jz	short loc_14D6_1406
		cmp	ax, 5
		jnz	short loc_14D6_13B5
		jmp	loc_14D6_147A
; ---------------------------------------------------------------------------

loc_14D6_13B5:				; CODE XREF: sub_14D6_1296+11Aj
		jmp	short loc_14D6_134B
; ---------------------------------------------------------------------------
		align 2

loc_14D6_13B8:				; CODE XREF: sub_14D6_1296+74j
		mov	ax, [bp+var_6]
		shl	ax, 1
		mov	[bp+var_40], ax
		lea	ax, [bp+var_32]
		push	ax
		push	[bp+var_2]
		push	[bp+var_8]
		mov	bx, [bp+var_40]
		add	bx, g_wVidConstCp2
		push	word ptr [bx]
		mov	bx, [bp+var_40]
		add	bx, g_wVidConstCp4
		push	word ptr [bx]
		call	DeriveSpriteOpReset
		jmp	short loc_14D6_13FF
; ---------------------------------------------------------------------------
		align 2

loc_14D6_13E4:				; CODE XREF: sub_14D6_1296+108j
		push	[bp+var_8]
		les	bx, [bp+var_38]
		push	word ptr es:[bx+0Ch]
		push	word ptr es:[bx+0Ah]
		push	word ptr es:[bx+8]
		push	word ptr es:[bx+6]
		call	ImageResetRende

loc_14D6_13FF:				; CODE XREF: sub_14D6_1296+14Bj
					; sub_14D6_1296+1C7j
		add	sp, 0Ah
		jmp	loc_14D6_134B
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1406:				; CODE XREF: sub_14D6_1296+115j
		mov	[bp+var_4], 0

loc_14D6_140B:				; CODE XREF: sub_14D6_1296+1A1j
		mov	ax, [bp+var_4]
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_40], ax
		mov	bx, ax
		add	bx, word ptr [bp+var_38]
		mov	es, word ptr [bp+var_38+2]
		mov	ax, es:[bx+6]
		mov	dx, es:[bx+8]
		mov	bx, [bp+var_40]
		add	bx, bp
		mov	word ptr [bx+var_32], ax
		mov	[bx+var_30], dx
		inc	[bp+var_4]
		cmp	[bp+var_4], 4
		jb	short loc_14D6_140B
		mov	ax, [bp+var_6]
		shl	ax, 1
		add	ax, g_wVidConstCp1
		mov	[bp+var_40], ax
		mov	bx, ax
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	[bp+var_8]
		mov	ax, 2500h
		push	ax
		lea	ax, [bp+var_32]
		push	ax
		call	sub_26C7_E
		jmp	short loc_14D6_13FF
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1460:				; CODE XREF: sub_14D6_1296+10Fj
		push	[bp+var_8]
		les	bx, [bp+var_38]
		push	word ptr es:[bx+0Ah]
		push	word ptr es:[bx+8]
		push	word ptr es:[bx+6]
		call	SpritePutpixel
		jmp	loc_14D6_1348
; ---------------------------------------------------------------------------

loc_14D6_147A:				; CODE XREF: sub_14D6_1296+11Cj
		push	[bp+var_8]
		les	bx, [bp+var_38]
		push	word ptr es:[bx+8]
		push	word ptr es:[bx+6]
		call	PutPixel
		jmp	loc_14D6_131F
; ---------------------------------------------------------------------------

loc_14D6_1490:				; CODE XREF: sub_14D6_1296+BEj
		push	cs
		call	near ptr ResetTrnsfrmOpVars
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_14D6_1296	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatRotateZXY	proc far		; CODE XREF: OpponentOp+D0P
					; OpponentOp+590P ...

p_wAngleZ	= word ptr  6
p_wAngleX	= word ptr  8
p_wAngleY	= word ptr  0Ah
p_wMultOrderFlag= byte ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		sub	si, si
		test	[bp+p_wAngleZ],	3FFh
		jz	short loc_14D6_14BC
		mov	si, 4
		push	[bp+p_wAngleZ]
		mov	ax, offset g_matTempRotZ
		push	ax
		call	MatRotateZ
		add	sp, si

loc_14D6_14BC:				; CODE XREF: MatRotateZXY+Fj
		test	[bp+p_wAngleX],	3FFh
		jz	short loc_14D6_14D6
		or	si, 2
		push	[bp+p_wAngleX]
		mov	ax, offset g_matTempRotX
		push	ax
		call	MatRotateX
		add	sp, 4

loc_14D6_14D6:				; CODE XREF: MatRotateZXY+27j
		test	[bp+p_wAngleY],	3FFh
		jz	short loc_14D6_1525
		or	si, 1
		mov	ax, [bp+p_wAngleY]
		and	ah, 3
		cmp	ax, g_wTempY
		jnz	short loc_14D6_14F2

loc_14D6_14ED:				; CODE XREF: MatRotateZXY+85j
		mov	di, offset g_matTempRotY
		jmp	short loc_14D6_1525
; ---------------------------------------------------------------------------

loc_14D6_14F2:				; CODE XREF: MatRotateZXY+51j
		mov	ax, [bp+p_wAngleY]
		and	ah, 3
		cmp	ax, 100h
		jz	short loc_14D6_1522
		cmp	ax, 200h
		jz	short loc_14D6_1538
		cmp	ax, 300h
		jz	short loc_14D6_153E
		push	[bp+p_wAngleY]
		mov	ax, offset g_matTempRotY
		push	ax
		call	MatRotateY
		add	sp, 4
		mov	ax, [bp+p_wAngleY]
		and	ah, 3
		mov	g_wTempY, ax
		jmp	short loc_14D6_14ED
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1522:				; CODE XREF: MatRotateZXY+61j
		mov	di, offset g_wMatY100

loc_14D6_1525:				; CODE XREF: MatRotateZXY+41j
					; MatRotateZXY+56j ...
		mov	ax, si
		cmp	ax, 7
		jbe	short loc_14D6_152F
		jmp	loc_14D6_1612
; ---------------------------------------------------------------------------

loc_14D6_152F:				; CODE XREF: MatRotateZXY+90j
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_14D6_1602[bx]
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1538:				; CODE XREF: MatRotateZXY+66j
		mov	di, offset g_matY200
		jmp	short loc_14D6_1525
; ---------------------------------------------------------------------------
		align 2

loc_14D6_153E:				; CODE XREF: MatRotateZXY+6Bj
		mov	di, offset g_wMatY300
		jmp	short loc_14D6_1525
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1544:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY:off_14D6_1602o
		mov	di, offset g_matY0
		jmp	loc_14D6_1612
; ---------------------------------------------------------------------------

loc_14D6_154A:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY+16Eo
		test	[bp+p_wMultOrderFlag], 1
		jz	short loc_14D6_155C
		mov	ax, offset g_matTempMult
		push	ax
		mov	ax, offset g_matTempRotX

loc_14D6_1557:				; CODE XREF: MatRotateZXY+E7j
		push	ax
		push	di
		jmp	short loc_14D6_1565
; ---------------------------------------------------------------------------
		align 2

loc_14D6_155C:				; CODE XREF: MatRotateZXY+B4j
		mov	ax, offset g_matTempMult
		push	ax
		push	di

loc_14D6_1561:				; CODE XREF: MatRotateZXY+102j
		mov	ax, offset g_matTempRotX

loc_14D6_1564:				; CODE XREF: MatRotateZXY+F2j
		push	ax

loc_14D6_1565:				; CODE XREF: MatRotateZXY+BFj
		call	MatMultiply
		add	sp, 6
		mov	di, offset g_matTempMult
		jmp	loc_14D6_1612
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1574:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY+172o
		test	[bp+p_wMultOrderFlag], 1
		jz	short loc_14D6_1584
		mov	ax, offset g_matTempMult
		push	ax
		mov	ax, offset g_matTempRotZ
		jmp	short loc_14D6_1557
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1584:				; CODE XREF: MatRotateZXY+DEj
		mov	ax, offset g_matTempMult
		push	ax
		push	di

loc_14D6_1589:				; CODE XREF: MatRotateZXY+10Cj
		mov	ax, offset g_matTempRotZ
		jmp	short loc_14D6_1564
; ---------------------------------------------------------------------------

loc_14D6_158E:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY+174o
		test	[bp+p_wMultOrderFlag], 1
		jz	short loc_14D6_159E
		mov	ax, offset g_matTempMult
		push	ax
		mov	ax, offset g_matTempRotZ
		push	ax
		jmp	short loc_14D6_1561
; ---------------------------------------------------------------------------

loc_14D6_159E:				; CODE XREF: MatRotateZXY+F8j
		mov	ax, offset g_matTempMult
		push	ax
		mov	ax, offset g_matTempRotX
		push	ax
		jmp	short loc_14D6_1589
; ---------------------------------------------------------------------------

loc_14D6_15A8:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY+176o
		test	[bp+p_wMultOrderFlag], 1
		jz	short loc_14D6_15D8
		mov	ax, offset g_matTempMult
		push	ax
		mov	ax, offset g_matTempRotX
		push	ax
		push	di
		call	MatMultiply
		add	sp, 6
		mov	ax, offset g_matTempRotX
		push	ax
		mov	ax, offset g_matTempRotZ
		push	ax
		mov	ax, offset g_matTempMult
		push	ax
		call	MatMultiply
		add	sp, 6

loc_14D6_15D3:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY+16Co
		mov	di, offset g_matTempRotX
		jmp	short loc_14D6_1612
; ---------------------------------------------------------------------------

loc_14D6_15D8:				; CODE XREF: MatRotateZXY+112j
		mov	ax, offset g_matTempMult
		push	ax
		mov	ax, offset g_matTempRotX
		push	ax
		mov	ax, offset g_matTempRotZ
		push	ax
		call	MatMultiply
		add	sp, 6
		mov	ax, offset g_matTempRotZ
		push	ax
		push	di
		mov	ax, offset g_matTempMult
		push	ax
		call	MatMultiply
		add	sp, 6

loc_14D6_15FD:				; CODE XREF: MatRotateZXY+98j
					; DATA XREF: MatRotateZXY+170o
		mov	di, offset g_matTempRotZ
		jmp	short loc_14D6_1612
; ---------------------------------------------------------------------------
off_14D6_1602	dw offset loc_14D6_1544	; DATA XREF: MatRotateZXY+98r
		dw offset loc_14D6_1612
		dw offset loc_14D6_15D3
		dw offset loc_14D6_154A
		dw offset loc_14D6_15FD
		dw offset loc_14D6_1574
		dw offset loc_14D6_158E
		dw offset loc_14D6_15A8
; ---------------------------------------------------------------------------

loc_14D6_1612:				; CODE XREF: MatRotateZXY+92j
					; MatRotateZXY+98j ...
		mov	ax, di
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
MatRotateZXY	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RectOp		proc far		; CODE XREF: DoCracCinfRes+173P
					; DoCracCinfRes+193P ...

var_6		= word ptr -6
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		mov	bx, [bp+arg_0]
		mov	si, [bx]
		mov	di, [bx+2]
		mov	bx, [bp+arg_2]
		cmp	[bx], si
		jle	short loc_14D6_1633
		mov	[bx], si

loc_14D6_1633:				; CODE XREF: RectOp+15j
		lea	ax, [si+1]
		mov	[bp+var_6], ax
		mov	bx, [bp+arg_2]
		cmp	[bx+2],	ax
		jge	short loc_14D6_1644
		mov	[bx+2],	ax

loc_14D6_1644:				; CODE XREF: RectOp+25j
		mov	bx, [bp+arg_2]
		cmp	[bx+4],	di
		jle	short loc_14D6_164F
		mov	[bx+4],	di

loc_14D6_164F:				; CODE XREF: RectOp+30j
		lea	ax, [di+1]
		mov	[bp+var_6], ax
		mov	bx, [bp+arg_2]
		cmp	[bx+6],	ax
		jge	short loc_14D6_1660
		mov	[bx+6],	ax

loc_14D6_1660:				; CODE XREF: RectOp+41j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
RectOp		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

VectorOp	proc far		; CODE XREF: TransformedShapeOp+1DFp

var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pVector	= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		mov	bx, [bp+p_pVector]
		push	[bx+Vector3D.wY]
		call	_abs
		add	sp, 2
		cwd
		mov	[bp+var_E], ax
		mov	[bp+var_C], dx
		mov	bx, [bp+p_pVector]
		push	[bx+Vector3D.wZ]
		call	_abs
		add	sp, 2
		push	ax
		mov	bx, [bp+p_pVector]
		push	[bx+Vector3D.wX]
		call	_abs
		add	sp, 2
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], 0
		mov	ax, word ptr g_dwSin80
		mov	dx, word ptr g_dwSin80+2
		cmp	word ptr g_dwCos80, ax
		jnz	short loc_14D6_16DA
		cmp	word ptr g_dwCos80+2, dx
		jnz	short loc_14D6_16DA
		mov	ax, [bp+var_E]
		mov	dx, [bp+var_C]
		cmp	[bp+var_2], dx
		jg	short loc_14D6_170E
		jl	short loc_14D6_16D5
		cmp	[bp+var_4], ax
		jnb	short loc_14D6_170E

loc_14D6_16D5:				; CODE XREF: VectorOp+68j VectorOp+A2j ...
		mov	ax, 1
		jmp	short loc_14D6_1710
; ---------------------------------------------------------------------------

loc_14D6_16DA:				; CODE XREF: VectorOp+55j VectorOp+5Bj
		push	word ptr g_dwSin80+2
		push	word ptr g_dwSin80
		push	[bp+var_C]
		push	[bp+var_E]
		call	__aFlmul
		push	word ptr g_dwCos80+2
		push	word ptr g_dwCos80
		push	[bp+var_2]
		push	[bp+var_4]
		mov	si, ax
		mov	di, dx
		call	__aFlmul
		cmp	dx, di
		jg	short loc_14D6_170E
		jl	short loc_14D6_16D5
		cmp	ax, si
		jb	short loc_14D6_16D5

loc_14D6_170E:				; CODE XREF: VectorOp+66j VectorOp+6Dj ...
		sub	ax, ax

loc_14D6_1710:				; CODE XREF: VectorOp+72j
		mov	[bp+var_8], ax
		mov	bx, [bp+p_pVector]
		cmp	[bx+Vector3D.wY], 0
		jge	short loc_14D6_172A
		or	ax, ax
		jz	short loc_14D6_1740
		mov	ax, 1Eh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_172A:				; CODE XREF: VectorOp+B4j
		cmp	[bx+Vector3D.wY], 0
		jle	short loc_14D6_1740
		cmp	[bp+var_8], 0
		jz	short loc_14D6_1740
		mov	ax, 1Fh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1740:				; CODE XREF: VectorOp+B8j VectorOp+C8j ...
		cmp	[bx+Vector3D.wY], 0
		jle	short loc_14D6_174C
		mov	[bp+var_A], 0Fh
		jmp	short loc_14D6_1750
; ---------------------------------------------------------------------------

loc_14D6_174C:				; CODE XREF: VectorOp+DEj
		mov	[bp+var_A], 0

loc_14D6_1750:				; CODE XREF: VectorOp+E4j
		mov	ax, [bx+Vector3D.wX]
		neg	ax
		push	ax
		push	[bx+Vector3D.wZ]
		call	GetAngleFromXZ
		add	sp, 4
		neg	ax
		mov	[bp+var_6], ax
		or	ax, ax
		jge	short loc_14D6_176D
		add	byte ptr [bp+var_6+1], 4

loc_14D6_176D:				; CODE XREF: VectorOp+101j
		mov	ax, [bp+var_6]
		cwd
		mov	cx, ax
		mov	bx, dx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		sub	ax, cx
		sbb	dx, bx
		mov	cl, 0Ah

loc_14D6_178B:				; CODE XREF: VectorOp+12Bj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_14D6_178B
		add	[bp+var_A], al
		mov	al, [bp+var_A]
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
VectorOp	endp


; =============== S U B	R O U T	I N E =======================================


SetSinCos80	proc far		; CODE XREF: InitPolyInfo+59p
		mov	ax, 80h
		push	ax
		call	LookupSine
		add	sp, 2
		cwd
		mov	word ptr g_dwSin80, ax
		mov	word ptr g_dwSin80+2, dx
		mov	ax, 80h
		push	ax
		call	LookupCos
		add	sp, 2
		cwd
		mov	word ptr g_dwCos80, ax
		mov	word ptr g_dwCos80+2, dx
		mov	ax, 80h
		push	ax
		call	LookupSine
		add	sp, 2
		cwd
		mov	word ptr g_dwSin80_2, ax
		mov	word ptr g_dwSin80_2+2,	dx
		mov	ax, 80h
		push	ax
		call	LookupCos
		add	sp, 2
		cwd
		mov	word ptr g_dwCos80_2, ax
		mov	word ptr g_dwCos80_2+2,	dx
		retf
SetSinCos80	endp

; [00000021 BYTES: COLLAPSED FUNCTION nopsub_14D6_17F1.	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MinMaxRect	proc far		; CODE XREF: RunCarMenu+887P
					; UpdateFrame+2066P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
p_pOutRect	= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		mov	bx, [bp+p_pOutRect]
		mov	si, [bp+arg_0]
		mov	ax, [si+Rectangle.dwLeft]
		mov	si, [bp+arg_2]
		cmp	ax, [si+Rectangle.dwLeft]
		jle	short loc_14D6_1827 ; jump if [arg0] < [arg2]
		mov	ax, [si+Rectangle.dwLeft] ; else set ax	to [arg2]

loc_14D6_1827:				; CODE XREF: MinMaxRect+11j
		mov	[bx+Rectangle.dwLeft], ax ; write smalles value	to [arg4]
		mov	bx, [bp+p_pOutRect]
		mov	si, [bp+arg_0]
		mov	ax, [si+Rectangle.dwTop]
		mov	si, [bp+arg_2]
		cmp	ax, [si+Rectangle.dwTop]
		jge	short loc_14D6_183D
		mov	ax, [si+Rectangle.dwTop]

loc_14D6_183D:				; CODE XREF: MinMaxRect+26j
		mov	[bx+Rectangle.dwTop], ax ; write largest value to [arg4+2]
		mov	bx, [bp+p_pOutRect]
		mov	si, [bp+arg_0]
		mov	ax, [si+Rectangle.dwRight]
		mov	si, [bp+arg_2]
		cmp	ax, [si+Rectangle.dwRight]
		jle	short loc_14D6_1854
		mov	ax, [si+Rectangle.dwRight]

loc_14D6_1854:				; CODE XREF: MinMaxRect+3Dj
		mov	[bx+Rectangle.dwRight],	ax ; write smalles value to [arg4+4]
		mov	bx, [bp+p_pOutRect]
		mov	si, [bp+arg_0]
		mov	ax, [si+Rectangle.dwBottom]
		mov	si, [bp+arg_2]
		cmp	ax, [si+Rectangle.dwBottom]
		jge	short loc_14D6_186B
		mov	ax, [si+Rectangle.dwBottom]

loc_14D6_186B:				; CODE XREF: MinMaxRect+54j
		mov	[bx+Rectangle.dwBottom], ax ; write biggest value to [arg4+6]
		cmp	g_wVideoFlag1, 1
		jz	short loc_14D6_1889
		mov	bx, [bp+p_pOutRect]
		mov	si, bx
		mov	ax, [si+2]
		add	ax, g_wVideoFlag1
		dec	ax
		and	ax, g_wVideoFlag2
		mov	[bx+2],	ax	; do som extra changes to [arg4+2] if a	global video flag is set

loc_14D6_1889:				; CODE XREF: MinMaxRect+61j
		pop	si
		pop	bp
		retf
MinMaxRect	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeRectOp	proc far		; CODE XREF: RunCarMenu+872P
					; UpdateFrame+1F1BP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		mov	bx, [bp+arg_0]
		mov	si, bx
		mov	ax, [si]
		cmp	[bx+2],	ax
		jge	short loc_14D6_18A2

loc_14D6_189C:				; CODE XREF: MaybeRectOp+21j
					; MaybeRectOp+2Dj ...
		mov	ax, 1
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_14D6_18A2:				; CODE XREF: MaybeRectOp+Ej
		mov	bx, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si]
		cmp	[bx+2],	ax
		jle	short loc_14D6_189C
		mov	bx, si
		mov	si, [bp+arg_2]
		mov	ax, [si]
		cmp	[bx+2],	ax
		jle	short loc_14D6_189C
		mov	ax, [si+6]
		cmp	[bx+4],	ax
		jge	short loc_14D6_189C
		mov	ax, [si+4]
		cmp	[bx+6],	ax
		jle	short loc_14D6_189C
		mov	bx, si
		mov	si, [bx]
		mov	bx, [bp+arg_0]
		cmp	[bx], si
		jge	short loc_14D6_18D8
		mov	[bx], si

loc_14D6_18D8:				; CODE XREF: MaybeRectOp+48j
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+2]
		cmp	[bx+2],	ax
		jle	short loc_14D6_18E9
		mov	[bx+2],	ax

loc_14D6_18E9:				; CODE XREF: MaybeRectOp+58j
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+4]
		cmp	[bx+4],	ax
		jge	short loc_14D6_18FA
		mov	[bx+4],	ax

loc_14D6_18FA:				; CODE XREF: MaybeRectOp+69j
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+6]
		cmp	[bx+6],	ax
		jle	short loc_14D6_190B
		mov	[bx+6],	ax

loc_14D6_190B:				; CODE XREF: MaybeRectOp+7Aj
		sub	ax, ax
		pop	si
		pop	bp
		retf
MaybeRectOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeRectOp2	proc far		; CODE XREF: MaybeRectOp2+1D9p
					; MaybeRectOp2+1EAp ...

var_22		= byte ptr -22h
var_20		= byte ptr -20h
var_1A		= word ptr -1Ah
var_18		= byte ptr -18h
var_16		= word ptr -16h
var_14		= byte ptr -14h
var_12		= byte ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= byte ptr -8
var_4		= word ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 22h
		push	di
		push	si
		cmp	g_wVideoFlag1, 1
		jz	short loc_14D6_1933
		mov	bx, [bp+arg_4]
		mov	si, bx
		mov	ax, [si+2]
		add	ax, g_wVideoFlag1
		dec	ax
		and	ax, g_wVideoFlag2
		mov	[bx+2],	ax

loc_14D6_1933:				; CODE XREF: MaybeRectOp2+Dj
		mov	[bp+var_14], 0
		jmp	short loc_14D6_1969
; ---------------------------------------------------------------------------
		align 2

loc_14D6_193A:				; CODE XREF: MaybeRectOp2+52j
		mov	di, si
		mov	cl, 3
		shl	di, cl
		add	di, [bp+arg_2]
		push	si
		push	di
		lea	si, [di+8]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	[bp+var_12]

loc_14D6_1953:				; CODE XREF: MaybeRectOp2+ABj
		mov	al, [bp+var_12]
		cbw
		mov	si, ax
		mov	bx, [bp+arg_0]
		mov	al, [bx]
		cbw
		dec	ax
		cmp	ax, si
		jg	short loc_14D6_193A
		dec	byte ptr [bx]

loc_14D6_1966:				; CODE XREF: MaybeRectOp2+7Ej
		inc	[bp+var_14]

loc_14D6_1969:				; CODE XREF: MaybeRectOp2+27j
		mov	bx, [bp+arg_0]
		mov	al, [bp+var_14]
		cmp	[bx], al
		jg	short loc_14D6_1976
		jmp	loc_14D6_1B20
; ---------------------------------------------------------------------------

loc_14D6_1976:				; CODE XREF: MaybeRectOp2+61j
		cbw
		mov	cl, 3
		shl	ax, cl
		add	ax, [bp+arg_2]
		mov	[bp+var_16], ax
		push	ax
		push	[bp+arg_4]
		push	cs
		call	near ptr MaybeRectOp4
		add	sp, 4
		or	al, al
		jz	short loc_14D6_1966
		push	[bp+var_16]
		push	[bp+arg_4]
		push	cs
		call	near ptr MaybeRectOp5
		add	sp, 4
		or	al, al
		jz	short loc_14D6_19A4
		jmp	loc_14D6_1BF7
; ---------------------------------------------------------------------------

loc_14D6_19A4:				; CODE XREF: MaybeRectOp2+8Fj
		push	[bp+arg_4]
		push	[bp+var_16]
		push	cs
		call	near ptr MaybeRectOp5
		add	sp, 4
		or	al, al
		jz	short loc_14D6_19BE
		mov	al, [bp+var_14]
		mov	[bp+var_12], al
		jmp	short loc_14D6_1953
; ---------------------------------------------------------------------------
		align 2

loc_14D6_19BE:				; CODE XREF: MaybeRectOp2+A3j
		mov	ax, [bp+var_16]
		lea	di, [bp+var_10]
		mov	si, ax
		push	ss
		pop	es
		assume es:nothing
		movsw
		movsw
		movsw
		movsw
		mov	bx, ax
		mov	si, [bp+arg_4]
		mov	ax, [si+4]
		cmp	[bx+4],	ax
		jge	short loc_14D6_19FA
		mov	ax, bx
		lea	di, [bp+var_20]
		mov	si, ax
		movsw
		movsw
		movsw
		movsw
		mov	bx, [bp+arg_4]
		mov	ax, [bx+4]
		mov	[bp+var_1A], ax
		mov	ax, [bx+4]
		mov	[bp+var_C], ax

loc_14D6_19F3:				; CODE XREF: MaybeRectOp2+10Ej
		mov	[bp+var_18], 1
		jmp	short loc_14D6_1A24
; ---------------------------------------------------------------------------
		align 2

loc_14D6_19FA:				; CODE XREF: MaybeRectOp2+C7j
		mov	bx, [bp+arg_4]
		mov	si, [bp+var_16]
		mov	ax, [si+4]
		cmp	[bx+4],	ax
		jge	short loc_14D6_1A20
		mov	ax, bx
		lea	di, [bp+var_20]
		mov	si, ax
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		mov	bx, [bp+var_16]
		mov	ax, [bx+4]
		mov	[bp+var_1A], ax
		jmp	short loc_14D6_19F3
; ---------------------------------------------------------------------------

loc_14D6_1A20:				; CODE XREF: MaybeRectOp2+F6j
		mov	[bp+var_18], 0

loc_14D6_1A24:				; CODE XREF: MaybeRectOp2+E7j
		mov	bx, [bp+var_16]
		mov	si, [bp+arg_4]
		mov	ax, [si+6]
		cmp	[bx+6],	ax
		jle	short loc_14D6_1A54
		mov	ax, bx
		lea	di, [bp+var_8]
		mov	si, ax
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		mov	bx, [bp+arg_4]
		mov	ax, [bx+6]
		mov	[bp+var_4], ax
		mov	ax, [bx+6]
		mov	[bp+var_A], ax

loc_14D6_1A4E:				; CODE XREF: MaybeRectOp2+168j
		mov	[bp+var_22], 1
		jmp	short loc_14D6_1A7E
; ---------------------------------------------------------------------------

loc_14D6_1A54:				; CODE XREF: MaybeRectOp2+120j
		mov	bx, [bp+arg_4]
		mov	si, [bp+var_16]
		mov	ax, [si+6]
		cmp	[bx+6],	ax
		jle	short loc_14D6_1A7A
		mov	ax, bx
		lea	di, [bp+var_8]
		mov	si, ax
		push	ss
		pop	es
		movsw
		movsw
		movsw
		movsw
		mov	bx, [bp+var_16]
		mov	ax, [bx+6]
		mov	[bp+var_4], ax
		jmp	short loc_14D6_1A4E
; ---------------------------------------------------------------------------

loc_14D6_1A7A:				; CODE XREF: MaybeRectOp2+150j
		mov	[bp+var_22], 0

loc_14D6_1A7E:				; CODE XREF: MaybeRectOp2+142j
		mov	bx, [bp+arg_4]
		mov	ax, [bx]
		mov	bx, [bp+var_16]
		cmp	ax, [bx]
		jle	short loc_14D6_1A8C
		mov	ax, [bx]

loc_14D6_1A8C:				; CODE XREF: MaybeRectOp2+178j
		mov	[bp+var_10], ax
		mov	bx, [bp+arg_4]
		mov	ax, [bx+2]
		mov	bx, [bp+var_16]
		cmp	ax, [bx+2]
		jge	short loc_14D6_1AA0
		mov	ax, [bx+2]

loc_14D6_1AA0:				; CODE XREF: MaybeRectOp2+18Bj
		mov	[bp+var_E], ax
		mov	al, [bp+var_14]
		mov	[bp+var_12], al
		jmp	short loc_14D6_1AC5
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1AAC:				; CODE XREF: MaybeRectOp2+1C4j
		mov	di, si
		mov	cl, 3
		shl	di, cl
		add	di, [bp+arg_2]
		push	si
		push	di
		lea	si, [di+8]
		push	ds
		pop	es
		assume es:dseg
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	[bp+var_12]

loc_14D6_1AC5:				; CODE XREF: MaybeRectOp2+199j
		mov	al, [bp+var_12]
		cbw
		mov	si, ax
		mov	bx, [bp+arg_0]
		mov	al, [bx]
		cbw
		dec	ax
		cmp	ax, si
		jg	short loc_14D6_1AAC
		dec	byte ptr [bx]
		cmp	[bp+var_18], 0
		jz	short loc_14D6_1AEF
		lea	ax, [bp+var_20]
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		push	cs
		call	near ptr MaybeRectOp2
		add	sp, 6

loc_14D6_1AEF:				; CODE XREF: MaybeRectOp2+1CCj
		lea	ax, [bp+var_10]
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		push	cs
		call	near ptr MaybeRectOp2
		add	sp, 6
		cmp	[bp+var_22], 0
		jnz	short loc_14D6_1B09
		jmp	loc_14D6_1BF7
; ---------------------------------------------------------------------------

loc_14D6_1B09:				; CODE XREF: MaybeRectOp2+1F4j
		lea	ax, [bp+var_8]

loc_14D6_1B0C:				; CODE XREF: MaybeRectOp2+245j
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		push	cs
		call	near ptr MaybeRectOp2
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_14D6_1B20:				; CODE XREF: MaybeRectOp2+63j
		mov	[bp+var_14], 0
		jmp	short loc_14D6_1B5B
; ---------------------------------------------------------------------------

loc_14D6_1B26:				; CODE XREF: MaybeRectOp2+23Ej
		mov	di, si
		mov	cl, 3
		shl	di, cl
		add	di, [bp+arg_2]
		push	si
		push	di
		lea	si, [di+8]
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw
		pop	di
		pop	si
		inc	[bp+var_12]

loc_14D6_1B3F:				; CODE XREF: MaybeRectOp2+2C2j
		mov	al, [bp+var_12]
		cbw
		mov	si, ax
		mov	bx, [bp+arg_0]
		mov	al, [bx]
		cbw
		dec	ax
		cmp	ax, si
		jg	short loc_14D6_1B26
		dec	byte ptr [bx]
		lea	ax, [bp+var_10]
		jmp	short loc_14D6_1B0C
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1B58:				; CODE XREF: MaybeRectOp2+26Dj
		inc	[bp+var_14]

loc_14D6_1B5B:				; CODE XREF: MaybeRectOp2+214j
		mov	bx, [bp+arg_0]
		mov	al, [bp+var_14]
		cmp	[bx], al
		jle	short loc_14D6_1BD6
		cbw
		mov	cl, 3
		shl	ax, cl
		add	ax, [bp+arg_2]
		mov	[bp+var_16], ax
		push	[bp+arg_4]
		push	ax
		push	cs
		call	near ptr MaybeRectOp3
		add	sp, 4
		or	al, al
		jz	short loc_14D6_1B58
		mov	bx, [bp+var_16]
		mov	ax, [bx]
		mov	bx, [bp+arg_4]
		cmp	ax, [bx]
		jle	short loc_14D6_1B8D
		mov	ax, [bx]

loc_14D6_1B8D:				; CODE XREF: MaybeRectOp2+279j
		mov	[bp+var_10], ax
		mov	bx, [bp+var_16]
		mov	ax, [bx+2]
		mov	bx, [bp+arg_4]
		cmp	ax, [bx+2]
		jge	short loc_14D6_1BA1
		mov	ax, [bx+2]

loc_14D6_1BA1:				; CODE XREF: MaybeRectOp2+28Cj
		mov	[bp+var_E], ax
		mov	bx, [bp+var_16]
		mov	ax, [bx+4]
		mov	bx, [bp+arg_4]
		cmp	ax, [bx+4]
		jle	short loc_14D6_1BB5
		mov	ax, [bx+4]

loc_14D6_1BB5:				; CODE XREF: MaybeRectOp2+2A0j
		mov	[bp+var_C], ax
		mov	bx, [bp+var_16]
		mov	ax, [bx+6]
		mov	bx, [bp+arg_4]
		cmp	ax, [bx+6]
		jge	short loc_14D6_1BC9
		mov	ax, [bx+6]

loc_14D6_1BC9:				; CODE XREF: MaybeRectOp2+2B4j
		mov	[bp+var_A], ax
		mov	al, [bp+var_14]
		mov	[bp+var_12], al
		jmp	loc_14D6_1B3F
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1BD6:				; CODE XREF: MaybeRectOp2+253j
		mov	bx, [bp+arg_0]
		mov	al, [bx]
		cbw
		mov	bx, ax
		mov	cl, 3
		shl	bx, cl
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_4]
		lea	di, [bx+si]
		mov	si, ax
		push	ds
		pop	es
		movsw
		movsw
		movsw
		movsw
		mov	bx, [bp+arg_0]
		inc	byte ptr [bx]

loc_14D6_1BF7:				; CODE XREF: MaybeRectOp2+91j
					; MaybeRectOp2+1F6j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
MaybeRectOp2	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeRectOp4	proc far		; CODE XREF: MaybeRectOp2+76p

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si]
		cmp	[bx+2],	ax
		jg	short loc_14D6_1C14

loc_14D6_1C0F:				; CODE XREF: MaybeRectOp4+21j
					; MaybeRectOp4+2Ej ...
		sub	ax, ax
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_14D6_1C14:				; CODE XREF: MaybeRectOp4+Fj
		mov	bx, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si]
		cmp	[bx+2],	ax
		jle	short loc_14D6_1C0F
		mov	bx, si
		mov	si, [bp+arg_2]
		mov	ax, [si+6]
		cmp	[bx+4],	ax
		jge	short loc_14D6_1C0F
		mov	ax, [si+4]
		cmp	[bx+6],	ax
		jle	short loc_14D6_1C0F
		mov	ax, 1
		pop	si
		pop	bp
		retf
MaybeRectOp4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeRectOp5	proc far		; CODE XREF: MaybeRectOp2+87p
					; MaybeRectOp2+9Bp

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+2]
		cmp	[bx+2],	ax
		jg	short loc_14D6_1C6A
		mov	ax, [si]
		cmp	[bx], ax
		jl	short loc_14D6_1C6A
		mov	ax, [si+4]
		cmp	[bx+4],	ax
		jl	short loc_14D6_1C6A
		mov	ax, [si+6]
		cmp	[bx+6],	ax
		jg	short loc_14D6_1C6A
		mov	ax, 1
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_14D6_1C6A:				; CODE XREF: MaybeRectOp5+10j
					; MaybeRectOp5+16j ...
		sub	ax, ax
		pop	si
		pop	bp
		retf
MaybeRectOp5	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeRectOp3	proc far		; CODE XREF: MaybeRectOp2+265p

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+4]
		cmp	[bx+6],	ax
		jnz	short loc_14D6_1CA2
		mov	ax, [si]
		cmp	[bx], ax
		jz	short loc_14D6_1C8E

loc_14D6_1C88:				; CODE XREF: MaybeRectOp3+2Aj
					; MaybeRectOp3+44j ...
		sub	ax, ax
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1C8E:				; CODE XREF: MaybeRectOp3+16j
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+2]
		cmp	[bx+2],	ax
		jnz	short loc_14D6_1C88

loc_14D6_1C9C:				; CODE XREF: MaybeRectOp3:loc_14D6_1CBCj
		mov	ax, 1
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_14D6_1CA2:				; CODE XREF: MaybeRectOp3+10j
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si+6]
		cmp	[bx+4],	ax
		jnz	short loc_14D6_1CC0
		mov	ax, [si]
		cmp	[bx], ax
		jnz	short loc_14D6_1C88
		mov	ax, [si+2]
		cmp	[bx+2],	ax

loc_14D6_1CBC:				; CODE XREF: MaybeRectOp3+6Bj
		jz	short loc_14D6_1C9C
		jmp	short loc_14D6_1C88
; ---------------------------------------------------------------------------

loc_14D6_1CC0:				; CODE XREF: MaybeRectOp3+3Ej
		mov	bx, [bp+arg_0]
		mov	si, [bp+arg_2]
		mov	ax, [si]
		cmp	[bx+2],	ax
		jnz	short loc_14D6_1CDE

loc_14D6_1CCD:				; CODE XREF: MaybeRectOp3+80j
		mov	ax, [si+4]
		cmp	[bx+4],	ax
		jnz	short loc_14D6_1C88
		mov	ax, [si+6]
		cmp	[bx+6],	ax
		jmp	short loc_14D6_1CBC
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1CDE:				; CODE XREF: MaybeRectOp3+5Bj
		mov	bx, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si]
		cmp	[bx+2],	ax
		jnz	short loc_14D6_1C88
		mov	bx, si
		mov	si, [bp+arg_2]
		jmp	short loc_14D6_1CCD
MaybeRectOp3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeSetupRects	proc far		; CODE XREF: sub_9F1_4+97P
					; SkyBoxOp+271P ...

pRc2		= word ptr -1Ch
pRc		= word ptr -1Ah
cCounter	= byte ptr -18h
cFlagFromArg2	= byte ptr -16h
var_14		= byte ptr -14h
rc1		= Rectangle ptr	-0Ch
var_4		= word ptr -4
var_2		= byte ptr -2
p_cNumRects	= byte ptr  6
arg_2		= word ptr  8
p_pRect		= word ptr  0Ah
p_pRect2	= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 1Ch
		push	di
		push	si
		mov	[bp+cCounter], 0
		jmp	short loc_14D6_1D60
; ---------------------------------------------------------------------------

loc_14D6_1D00:				; CODE XREF: MaybeSetupRects+CAj
					; MaybeSetupRects+D9j
		mov	ax, [bp+pRc]

loc_14D6_1D03:				; CODE XREF: MaybeSetupRects+2Ej
					; MaybeSetupRects+EEj
		mov	[bp+var_4], ax
		mov	[bp+var_2], 1
		jmp	short loc_14D6_1D26
; ---------------------------------------------------------------------------

loc_14D6_1D0C:				; CODE XREF: MaybeSetupRects+B2j
					; MaybeSetupRects+C1j
		test	[bp+cFlagFromArg2], 2
		jz	short loc_14D6_1D22
		mov	bx, [bp+pRc2]
		mov	si, bx
		mov	ax, [si]
		cmp	[bx+2],	ax
		jle	short loc_14D6_1D22
		mov	ax, bx
		jmp	short loc_14D6_1D03
; ---------------------------------------------------------------------------

loc_14D6_1D22:				; CODE XREF: MaybeSetupRects+1Ej
					; MaybeSetupRects+2Aj
		mov	[bp+var_2], 0

loc_14D6_1D26:				; CODE XREF: MaybeSetupRects+18j
		cmp	[bp+var_2], 0
		jz	short loc_14D6_1D5D
		mov	ax, [bp+var_4]
		lea	di, [bp+var_14]
		mov	si, ax
		push	ss
		pop	es
		assume es:nothing
		movsw
		movsw
		movsw
		movsw
		push	[bp+arg_8]
		lea	ax, [bp+var_14]
		push	ax
		push	cs
		call	near ptr MaybeRectOp
		add	sp, 4
		or	al, al
		jnz	short loc_14D6_1D5D
		lea	ax, [bp+var_14]
		push	ax
		push	[bp+arg_C]
		push	[bp+arg_A]
		push	cs
		call	near ptr MaybeRectOp2
		add	sp, 6

loc_14D6_1D5D:				; CODE XREF: MaybeSetupRects+38j
					; MaybeSetupRects+58j
		inc	[bp+cCounter]

loc_14D6_1D60:				; CODE XREF: MaybeSetupRects+Cj
		mov	al, [bp+p_cNumRects]
		cmp	[bp+cCounter], al
		jnb	short loc_14D6_1DE4
		mov	al, [bp+cCounter]
		cbw
		mov	si, ax
		mov	bx, [bp+arg_2]
		mov	al, [bx+si]
		mov	[bp+cFlagFromArg2], al
		test	[bp+cFlagFromArg2], 1
		jz	short loc_14D6_1D8A
		mov	ax, [bp+p_pRect]
		mov	dx, si		; si = counter
		mov	cl, 3
		shl	dx, cl
		add	ax, dx		; ax = p_pRect + (counter << 3)
		mov	[bp+pRc], ax	; so p_pRect points to an array	of rects

loc_14D6_1D8A:				; CODE XREF: MaybeSetupRects+88j
		test	[bp+cFlagFromArg2], 2
		jz	short loc_14D6_1D9E
		mov	al, [bp+cCounter]
		cbw
		mov	cl, 3
		shl	ax, cl
		add	ax, [bp+p_pRect2]
		mov	[bp+pRc2], ax

loc_14D6_1D9E:				; CODE XREF: MaybeSetupRects+9Cj
		test	[bp+cFlagFromArg2], 1
		jnz	short loc_14D6_1DA7
		jmp	loc_14D6_1D0C
; ---------------------------------------------------------------------------

loc_14D6_1DA7:				; CODE XREF: MaybeSetupRects+B0j
		mov	bx, [bp+pRc]
		mov	si, bx
		mov	ax, [si]
		cmp	[bx+2],	ax
		jg	short loc_14D6_1DB6
		jmp	loc_14D6_1D0C
; ---------------------------------------------------------------------------

loc_14D6_1DB6:				; CODE XREF: MaybeSetupRects+BFj
		test	[bp+cFlagFromArg2], 2
		jnz	short loc_14D6_1DBF
		jmp	loc_14D6_1D00
; ---------------------------------------------------------------------------

loc_14D6_1DBF:				; CODE XREF: MaybeSetupRects+C8j
		mov	bx, [bp+pRc2]
		mov	si, bx
		mov	ax, [si]
		cmp	[bx+2],	ax
		jg	short loc_14D6_1DCE
		jmp	loc_14D6_1D00
; ---------------------------------------------------------------------------

loc_14D6_1DCE:				; CODE XREF: MaybeSetupRects+D7j
		lea	ax, [bp+rc1]
		push	ax
		push	bx
		push	[bp+pRc]
		push	cs
		call	near ptr MinMaxRect
		add	sp, 6
		lea	ax, [bp+rc1]
		jmp	loc_14D6_1D03
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1DE4:				; CODE XREF: MaybeSetupRects+74j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
MaybeSetupRects	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_14D6_1DEA	proc far		; CODE XREF: sub_9F1_4+B3P

var_202		= word ptr -202h
arg_0		= byte ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 202h
		push	di
		push	si
		cmp	[bp+arg_0], 1
		jle	short loc_14D6_1E40
		sub	si, si
		jmp	short loc_14D6_1E1C
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1DFE:				; CODE XREF: sub_14D6_1DEA+38j
		mov	di, si
		shl	di, 1
		mov	bx, [bp+arg_2]
		mov	ax, si
		mov	cl, 3
		shl	ax, cl
		add	bx, ax
		mov	ax, [bx+4]
		neg	ax
		mov	[bp+di+var_202], ax
		mov	bx, [bp+arg_4]
		mov	[bx+di], si
		inc	si

loc_14D6_1E1C:				; CODE XREF: sub_14D6_1DEA+11j
		mov	al, [bp+arg_0]
		cbw
		cmp	ax, si
		jg	short loc_14D6_1DFE
		push	[bp+arg_4]
		lea	ax, [bp+var_202]
		push	ax
		mov	al, [bp+arg_0]
		cbw
		push	ax
		call	sub_26BE_8
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_14D6_1E40:				; CODE XREF: sub_14D6_1DEA+Dj
		mov	bx, [bp+arg_4]
		mov	word ptr [bx], 0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_14D6_1DEA	endp

seg006		ends

; ===========================================================================

; Segment type:	Pure code
seg007		segment	byte public 'CODE' use16
		assume cs:seg007
		;org 0Dh
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================


AddAudioDrvTime	proc far		; CODE XREF: SetupCarGameEtc+10BP
		mov	bx, 6364h
		jmp	short loc_16BA_19
; ---------------------------------------------------------------------------

loc_16BA_13:				; CODE XREF: AddAudioDrvTime+Fj
		mov	byte ptr [bx], 0
		add	bx, 4Ch	; 'L'

loc_16BA_19:				; CODE XREF: AddAudioDrvTime+3j
		cmp	bx, offset g_wAudioTimerFl
		jb	short loc_16BA_13
		mov	g_wAudioTimerFl, 16h
		mov	ax, offset AudioDrvTimer
		mov	dx, seg	seg007
		push	dx
		push	ax
		call	AddTimerFunc
		pop	bx
		pop	bx
		retf
AddAudioDrvTime	endp


; =============== S U B	R O U T	I N E =======================================


DelAudDrvTimer	proc far		; CODE XREF: RunGame+768P
					; UnloadGameResou+71P
		push	si
		mov	si, 6364h
		jmp	short loc_16BA_4F
; ---------------------------------------------------------------------------

loc_16BA_3B:				; CODE XREF: DelAudDrvTimer+1Ej
		cmp	byte ptr [si], 1
		jnz	short loc_16BA_49
		push	word ptr [si+2]
		call	sub_270D_40E
		pop	bx

loc_16BA_49:				; CODE XREF: DelAudDrvTimer+9j
		mov	byte ptr [si], 0
		add	si, 4Ch	; 'L'

loc_16BA_4F:				; CODE XREF: DelAudDrvTimer+4j
		cmp	si, 6AD0h
		jb	short loc_16BA_3B
		mov	ax, offset AudioDrvTimer
		mov	dx, seg	seg007
		push	dx
		push	ax
		call	RemoveTimerFunc
		pop	bx
		pop	bx
		pop	si
		retf
DelAudDrvTimer	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PadId		proc far		; CODE XREF: InitSfxEngine+9Ap
					; InitSfxEngine+C1p ...

arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		push	si
		les	bx, [bp+arg_0]
		mov	ax, es:[bx]
		mov	dx, es:[bx+2]
		mov	word ptr g_dwPaddedId, ax
		mov	word ptr g_dwPaddedId+2, dx
		mov	g_bPadFlag, 0
		sub	si, si

loc_16BA_82:				; CODE XREF: PadId+2Cj
		cmp	byte ptr g_dwPaddedId[si], 0
		jnz	short loc_16BA_8E
		mov	byte ptr g_dwPaddedId[si], 20h ; ' '

loc_16BA_8E:				; CODE XREF: PadId+21j
		inc	si
		cmp	si, 4
		jl	short loc_16BA_82
		mov	ax, offset g_dwPaddedId
		pop	si
		mov	sp, bp
		pop	bp
		retf
PadId		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitSfxEngine	proc far		; CODE XREF: SetupCarGameEtc+129P
					; SetupCarGameEtc+163P

var_18		= dword	ptr -18h
pAudioTimer	= word ptr -14h
pAudioTimer1COfs= word ptr -12h
pAudioTimer1CSeg= word ptr -10h
wOldCounter	= word ptr -0Eh
pEngHandleOfs	= word ptr -8
pEngHandleSeg	= word ptr -6
pAudioTimerPos	= word ptr -4
wCounter	= word ptr -2
arg_0		= word ptr  6
p_pEngHandleOfs	= word ptr  8
p_pEngHandleSeg	= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 18h
		push	di
		push	si
		mov	di, 0FFFFh
		sub	dx, dx
		mov	bx, offset g_pcAudioTimers
		jmp	short loc_16BA_BD
; ---------------------------------------------------------------------------

loc_16BA_AE:				; CODE XREF: InitSfxEngine+25j
		or	di, di
		jge	short loc_16BA_C3
		cmp	byte ptr [bx], 0
		jnz	short loc_16BA_B9
		mov	di, dx

loc_16BA_B9:				; CODE XREF: InitSfxEngine+19j
		add	bx, 4Ch		; sizeof audiotimer
		inc	dx

loc_16BA_BD:				; CODE XREF: InitSfxEngine+10j
		cmp	bx, offset g_wAudioTimerFl ; end of audiotimer
		jb	short loc_16BA_AE

loc_16BA_C3:				; CODE XREF: InitSfxEngine+14j
		or	di, di
		jge	short loc_16BA_CA
		jmp	_InitError
; ---------------------------------------------------------------------------
; found	an available slot in g_pAudioTimers

loc_16BA_CA:				; CODE XREF: InitSfxEngine+29j
		mov	ax, di		; ax = di = dx = counter
		mov	cx, 4Ch		; sizeof audiotimer
		imul	cx
		add	ax, offset g_pcAudioTimers
		mov	[bp+pAudioTimer], ax
		add	ax, 1Ch
		mov	[bp+pAudioTimer1COfs], ax
		mov	[bp+pAudioTimer1CSeg], ds
		mov	cx, [bp+p_pEngHandleOfs]
		mov	dx, [bp+p_pEngHandleSeg]
		mov	[bp+pEngHandleOfs], cx ; probably handle
		mov	[bp+pEngHandleSeg], dx
		mov	[bp+pAudioTimerPos], ax
		mov	[bp+wCounter], 0
		mov	[bp+wOldCounter], di
		jmp	short loc_16BA_115
; ---------------------------------------------------------------------------

loc_16BA_F9:				; CODE XREF: InitSfxEngine+7Dj
		les	bx, dword ptr [bp+pEngHandleOfs]
		add	[bp+pEngHandleOfs], 1
		jnb	short loc_16BA_107 ; jump if below 0xffff or 0x7ffff?
		add	[bp+pEngHandleSeg], 1000h
; kopier fra pEngHandleOfs til de siste	0x30 bytene p† g_pAudioTimer-tingen

loc_16BA_107:				; CODE XREF: InitSfxEngine+64j
		mov	al, es:[bx]
		mov	bx, [bp+pAudioTimerPos]
		inc	[bp+pAudioTimerPos]
		mov	[bx], al
		inc	[bp+wCounter]

loc_16BA_115:				; CODE XREF: InitSfxEngine+5Bj
		cmp	[bp+wCounter], 30h ; loop 30h times, 1c	+ 30 = 4c!
		jl	short loc_16BA_F9

; her leser vi det som ble kopiert inn
		mov	di, [bp+pAudioTimer1COfs]
		mov	es, [bp+pAudioTimer1CSeg]
		cmp	byte ptr es:[di+6], 0
		jz	short loc_16BA_12B
		jmp	loc_16BA_2C1
; ---------------------------------------------------------------------------

loc_16BA_12B:				; CODE XREF: InitSfxEngine+8Aj
		push	word ptr es:[di+0Ah] ; retreive	a string to pad	with spaces up to 4 bytes
		push	word ptr es:[di+8]
		mov	si, es
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		call	LocateShape
		add	sp, 6
		mov	es, si
		mov	es:[di+8], ax
		mov	es:[di+0Ah], dx
		push	word ptr es:[di+12h]
		push	word ptr es:[di+10h]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+10h], ax
		mov	es:[di+12h], dx
		push	word ptr es:[di+16h]
		push	word ptr es:[di+14h]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+14h], ax
		mov	es:[di+16h], dx
		push	word ptr es:[di+1Ah]
		push	word ptr es:[di+18h]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]

loc_16BA_1C0:
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+18h], ax
		mov	es:[di+1Ah], dx
		push	word ptr es:[di+1Eh]
		push	word ptr es:[di+1Ch]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+1Ch], ax
		mov	es:[di+1Eh], dx
		push	word ptr es:[di+22h]
		push	word ptr es:[di+20h]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+20h], ax
		mov	es:[di+22h], dx
		push	word ptr es:[di+26h]
		push	word ptr es:[di+24h]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+24h], ax
		mov	es:[di+26h], dx
		push	word ptr es:[di+2Ah]
		push	word ptr es:[di+28h]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+28h], ax
		mov	es:[di+2Ah], dx
		push	word ptr es:[di+2Eh]
		push	word ptr es:[di+2Ch]
		push	cs
		call	near ptr PadId
		pop	bx
		pop	bx
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_C]
		push	[bp+arg_A]
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	es, si
		mov	es:[di+2Ch], ax
		mov	es:[di+2Eh], dx
		mov	byte ptr es:[di+6], 1

loc_16BA_2C1:				; CODE XREF: InitSfxEngine+8Cj
		mov	si, [bp+pAudioTimer]
		mov	ax, 7Fh	; ''
		push	ax
		mov	ax, 0FFFFh
		push	ax
		call	sub_270D_3A0
		pop	bx
		pop	bx
		mov	[si+2],	ax
		mov	byte ptr [si+1], 0
		mov	word ptr [si+4], 0
		sub	ax, ax
		mov	[si+8],	ax
		mov	[si+6],	ax
		mov	byte ptr [si+0Ah], 0
		mov	es, [bp+pAudioTimer1CSeg]
		mov	ax, es:[di]
		mov	cx, es
		les	bx, es:[di+8]
		mov	dl, es:[bx+0Fh]
		mov	word ptr [bp+var_18], di
		mov	word ptr [bp+var_18+2],	cx
		mov	cl, es:[bx+0Eh]
		sub	ch, ch
		mov	bx, dx
		sub	dx, dx
		div	cx
		mov	cl, 4
		sub	bh, bh
		shl	bx, cl
		add	ax, bx
		mov	[si+0Ch], ax
		mov	byte ptr [si+0Eh], 0FFh
		mov	ax, 0FFFFh
		mov	[si+10h], ax
		mov	[si+12h], ax
		mov	[si+14h], ax
		mov	[si+16h], ax
		les	bx, [bp+var_18]
		mov	ax, es:[bx]
		mov	[si+18h], ax
		sub	al, al
		mov	[si+1Ah], al
		mov	[si+1Bh], al
		mov	byte ptr [si], 1
		mov	ax, [bp+wOldCounter]
		jmp	short loc_16BA_34E
; ---------------------------------------------------------------------------

_InitError:				; CODE XREF: InitSfxEngine+2Bj
		mov	ax, offset aInitengineAllH ; "InitEngine: All handles used."
		push	ax
		call	far ptr	ErrorMessage
		pop	bx

loc_16BA_34E:				; CODE XREF: InitSfxEngine+2A6j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InitSfxEngine	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioFunction	proc far		; CODE XREF: DoAudioCvx+348P
					; AudioDrvTimer+15Ep

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	di
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		add	si, 6364h
		cmp	byte ptr [si], 1
		jnz	short loc_16BA_3C7
		cmp	byte ptr [si+1], 0
		jnz	short loc_16BA_3C7
		lea	bx, [si+1Ch]
		push	word ptr [bx+0Ah]
		push	word ptr [bx+8]
		push	word ptr [si+2]
		mov	di, bx

loc_16BA_37E:
		call	Access4cChunk
		add	sp, 6
		mov	ax, [di]
		les	bx, [di+8]
		mov	cl, es:[bx+0Eh]
		sub	ch, ch
		sub	dx, dx
		div	cx
		mov	cl, 4
		mov	dl, es:[bx+0Fh]
		sub	dh, dh
		shl	dx, cl
		add	ax, dx
		mov	[si+0Ch], ax
		push	word ptr [si+2]
		push	ax
		call	DoDrumOp
		pop	bx
		pop	bx
		mov	[si+12h], ax
		mov	al, 1
		mov	[si+1],	al
		mov	[si+1Ah], al
		sub	ax, ax
		push	ax
		push	word ptr [si+2]
		call	AudioDrvFunc12
		pop	bx
		pop	bx

loc_16BA_3C7:				; CODE XREF: AudioFunction+14j
					; AudioFunction+1Aj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioFunction	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioFunction2	proc far		; CODE XREF: DoAudioCvx+3DP
					; DoAudioCvx+6AP ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		add	si, 6364h
		cmp	byte ptr [si], 1
		jnz	short loc_16BA_3FE
		cmp	byte ptr [si+1], 1
		jnz	short loc_16BA_3FE
		push	word ptr [si+12h]
		call	DoDrvData2
		pop	bx
		mov	word ptr [si+12h], 0FFFFh
		mov	byte ptr [si+1], 0
		mov	byte ptr [si+1Ah], 1

loc_16BA_3FE:				; CODE XREF: AudioFunction2+13j
					; AudioFunction2+19j
		pop	si
		mov	sp, bp
		pop	bp
		retf
AudioFunction2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvTimer	proc far		; DATA XREF: AddAudioDrvTime+17o
					; DelAudDrvTimer+20o

var_4		= word ptr -4
var_1		= byte ptr -1

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		call	CompareDS_SS
		or	ax, ax
		jnz	short loc_16BA_417
		jmp	loc_16BA_587
; ---------------------------------------------------------------------------

loc_16BA_417:				; CODE XREF: AudioDrvTimer+Fj
		inc	g_wAudioFlag
		cmp	g_wAudioFlag, 2
		jge	short loc_16BA_42C
		cmp	g_cDrvFlag7, 0
		jz	short loc_16BA_42C
		jmp	loc_16BA_587
; ---------------------------------------------------------------------------

loc_16BA_42C:				; CODE XREF: AudioDrvTimer+1Dj
					; AudioDrvTimer+24j
		mov	[bp+var_4], 0
		mov	si, offset g_pcAudioTimers

loc_16BA_434:				; CODE XREF: AudioDrvTimer+174j
		cmp	byte ptr [si], 0
		jnz	short loc_16BA_43C
		jmp	loc_16BA_56B
; ---------------------------------------------------------------------------

loc_16BA_43C:				; CODE XREF: AudioDrvTimer+34j
		cmp	g_cDrvFlag6, 0
		jnz	short loc_16BA_446
		jmp	loc_16BA_56B
; ---------------------------------------------------------------------------

loc_16BA_446:				; CODE XREF: AudioDrvTimer+3Ej
		mov	cl, 4
		mov	al, [si+0Ah]
		sub	ah, ah
		shl	ax, cl
		mov	dx, [si+4]
		mov	bx, dx
		shl	dx, 1
		add	dx, bx
		shl	dx, 1
		add	dx, bx
		add	ax, dx
		mov	cl, 3
		shr	ax, cl
		mov	[si+4],	ax
		mov	cl, 4
		shr	ax, cl
		mov	[bp+var_1], al
		cmp	al, [si+0Eh]
		jnz	short loc_16BA_477
		cmp	byte ptr [si+1Ah], 0
		jz	short loc_16BA_4BD

loc_16BA_477:				; CODE XREF: AudioDrvTimer+6Cj
		mov	al, [bp+var_1]
		sub	ah, ah
		push	ax
		push	word ptr [si+2]
		mov	di, ax
		call	AudioDrvFunc12
		add	sp, 4
		mov	ax, di
		sub	di, 0Ah
		jns	short loc_16BA_493
		sub	di, di

loc_16BA_493:				; CODE XREF: AudioDrvTimer+8Cj
		cmp	word ptr [si+14h], 0FFFFh
		jz	short loc_16BA_4A5
		push	di
		push	word ptr [si+14h]
		call	AudioDrvFunc12
		add	sp, 4

loc_16BA_4A5:				; CODE XREF: AudioDrvTimer+94j
		cmp	word ptr [si+16h], 0FFFFh
		jz	short loc_16BA_4B7
		push	di
		push	word ptr [si+16h]
		call	AudioDrvFunc12
		add	sp, 4

loc_16BA_4B7:				; CODE XREF: AudioDrvTimer+A6j
		mov	al, [bp+var_1]
		mov	[si+0Eh], al

loc_16BA_4BD:				; CODE XREF: AudioDrvTimer+72j
		mov	ax, [si+6]
		mov	dx, [si+8]
		mov	cx, ax
		mov	bx, dx
		shl	ax, 1
		rcl	dx, 1
		add	ax, cx
		adc	dx, bx
		shl	ax, 1
		rcl	dx, 1
		add	ax, cx
		adc	dx, bx
		mov	cx, [si+0Ch]
		sub	bx, bx
		shl	cx, 1
		rcl	bx, 1
		shl	cx, 1
		rcl	bx, 1
		shl	cx, 1
		rcl	bx, 1
		shl	cx, 1
		rcl	bx, 1
		add	cx, ax
		adc	bx, dx
		shr	bx, 1
		rcr	cx, 1
		shr	bx, 1
		rcr	cx, 1
		shr	bx, 1
		rcr	cx, 1
		mov	[si+6],	cx
		mov	[si+8],	bx
		shr	bx, 1
		rcr	cx, 1
		shr	bx, 1
		rcr	cx, 1
		shr	bx, 1
		rcr	cx, 1
		shr	bx, 1
		rcr	cx, 1
		mov	di, cx
		cmp	cx, [si+10h]
		jnz	short loc_16BA_51F
		cmp	byte ptr [si+1Ah], 0
		jz	short loc_16BA_534

loc_16BA_51F:				; CODE XREF: AudioDrvTimer+114j
		cmp	word ptr [si+12h], 0FFFFh
		jz	short loc_16BA_534
		push	di
		push	word ptr [si+12h]
		call	AudioDrvFunc24
		add	sp, 4
		mov	[si+10h], di

loc_16BA_534:				; CODE XREF: AudioDrvTimer+11Aj
					; AudioDrvTimer+120j
		mov	byte ptr [si+1Ah], 0
		cmp	byte ptr [si+1Bh], 0
		jz	short loc_16BA_56B
		cmp	byte ptr [si+1], 0
		jz	short loc_16BA_54E
		push	word ptr [si+14h]
		call	MaybeInit4cChun
		jmp	short loc_16BA_564
; ---------------------------------------------------------------------------

loc_16BA_54E:				; CODE XREF: AudioDrvTimer+13Fj
		push	word ptr [si+14h]
		call	sub_270D_64E
		add	sp, 2
		or	ax, ax
		jz	short loc_16BA_56B
		push	[bp+var_4]
		push	cs
		call	near ptr AudioFunction

loc_16BA_564:				; CODE XREF: AudioDrvTimer+149j
		add	sp, 2
		mov	byte ptr [si+1Bh], 0

loc_16BA_56B:				; CODE XREF: AudioDrvTimer+36j
					; AudioDrvTimer+40j ...
		add	si, 4Ch	; 'L'
		inc	[bp+var_4]
		cmp	[bp+var_4], 19h
		jge	short loc_16BA_57A
		jmp	loc_16BA_434
; ---------------------------------------------------------------------------

loc_16BA_57A:				; CODE XREF: AudioDrvTimer+172j
		cmp	g_wAudioFlag, 2
		jl	short loc_16BA_587
		mov	g_wAudioFlag, 0

loc_16BA_587:				; CODE XREF: AudioDrvTimer+11j
					; AudioDrvTimer+26j ...
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioDrvTimer	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

XZAudioTimer	proc far		; CODE XREF: sub_471_45F6+22P
					; sub_471_45F6+50P

var_16		= word ptr -16h
var_14		= word ptr -14h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h
arg_E		= word ptr  14h
arg_10		= word ptr  16h

		push	bp
		mov	bp, sp
		sub	sp, 16h
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_pcAudioTimers
		mov	[bp+var_2], ax
		push	[bp+arg_C]
		push	[bp+arg_E]
		push	[bp+arg_A]
		call	XZCosOrSin
		add	sp, 4
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_C], ax
		cmp	ax, 1770h
		jle	short loc_16BA_5D2
		mov	[bp+var_8], 0
		mov	bx, [bp+var_2]
		mov	byte ptr [bx+0Ah], 0
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_16BA_5D2:				; CODE XREF: XZAudioTimer+32j
		push	[bp+arg_6]
		push	[bp+arg_8]
		push	[bp+arg_4]
		call	XZCosOrSin
		add	sp, 4
		push	ax
		call	XZCosOrSin
		add	sp, 4
		mov	[bp+var_A], ax
		sub	ax, [bp+var_C]
		mov	[bp+var_16], ax
		mov	ax, 64h	; 'd'
		xor	dx, dx
		div	[bp+arg_10]
		imul	[bp+var_16]
		mov	[bp+var_16], ax
		mov	ax, 7Fh	; ''
		mul	[bp+var_C]
		mov	cx, 1770h
		div	cx
		neg	ax
		add	ax, 7Fh	; ''
		mov	[bp+var_8], ax
		cmp	[bp+var_16], 0
		jle	short loc_16BA_626
		mov	cl, 4
		mov	ax, [bp+var_8]
		shr	ax, cl
		sub	[bp+var_8], ax

loc_16BA_626:				; CODE XREF: XZAudioTimer+8Cj
		mov	ax, [bp+arg_2]
		mov	bx, [bp+var_2]
		add	bx, 1Ch
		mov	[bp+var_10], bx
		mov	[bp+var_E], ds
		les	bx, [bx+8]
		mov	cl, es:[bx+0Eh]
		sub	ch, ch
		sub	dx, dx
		div	cx
		mov	cl, 4
		mov	dl, es:[bx+0Fh]
		sub	dh, dh
		shl	dx, cl
		add	ax, dx
		mov	[bp+var_14], ax
		mov	ax, 1770h
		sub	ax, [bp+var_16]
		mov	[bp+var_6], ax
		or	ax, ax
		jz	short loc_16BA_673
		mov	ax, 1770h
		mul	[bp+var_14]
		div	[bp+var_6]
		mov	[bp+var_6], ax
		mov	ax, [bp+var_6]
		mov	bx, [bp+var_2]
		mov	[bx+0Ch], ax

loc_16BA_673:				; CODE XREF: XZAudioTimer+CEj
		mov	al, byte ptr [bp+var_8]
		mov	bx, [bp+var_2]
		mov	[bx+0Ah], al
		mov	sp, bp
		pop	bp
		retf
XZAudioTimer	endp

; [0000004C BYTES: COLLAPSED FUNCTION nopsub_16BA_680. PRESS KEYPAD "+"	TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

WrapAudioFunc2	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		add	bx, 6364h
		mov	ax, [bx+4]
		mov	cl, 4
		shr	ax, cl
		push	ax
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		push	word ptr [bx+32h]
		push	word ptr [bx+30h]
		mov	si, bx
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+14h], ax
		mov	byte ptr [si+1Ah], 1
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioFunction2
		pop	bx
		pop	si
		mov	sp, bp
		pop	bp
		retf
WrapAudioFunc2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

WrapAudioFunc2_	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		add	bx, 6364h
		mov	ax, [bx+4]
		mov	cl, 4
		shr	ax, cl
		push	ax
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		push	word ptr [bx+36h]
		push	word ptr [bx+34h]
		mov	si, bx
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+14h], ax
		mov	byte ptr [si+1Ah], 1
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioFunction2
		pop	bx
		pop	si
		mov	sp, bp
		pop	bp
		retf
WrapAudioFunc2_	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

WrapAudFunc2_2	proc far		; CODE XREF: CvxSfxOp:loc_471_4FC2P
					; CvxSfxOp:loc_471_4FECP

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		add	bx, 6364h
		mov	ax, [bx+4]
		mov	cl, 4
		shr	ax, cl
		push	ax
		mov	ax, 64h	; 'd'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		push	word ptr [bx+3Ah]
		push	word ptr [bx+38h]
		mov	si, bx
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+14h], ax
		mov	byte ptr [si+1Ah], 1
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioFunction2
		pop	bx
		pop	si
		mov	sp, bp
		pop	bp
		retf
WrapAudFunc2_2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioTimerOp2	proc far		; CODE XREF: DoAudioOp1_2+24P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		add	bx, offset g_pcAudioTimers
		mov	ax, [bx+4]
		mov	cl, 4
		shr	ax, cl
		push	ax
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		push	word ptr [bx+46h]
		push	word ptr [bx+44h]
		mov	si, bx
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+14h], ax
		mov	byte ptr [si+1Ah], 1
		pop	si
		mov	sp, bp
		pop	bp
		retf
AudioTimerOp2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioTimerOp	proc far		; CODE XREF: DoAudioOp1_2+13P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		add	bx, offset g_pcAudioTimers
		mov	ax, [bx+4]
		mov	cl, 4
		shr	ax, cl
		push	ax
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		push	word ptr [bx+4Ah]
		push	word ptr [bx+48h]
		mov	si, bx
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+14h], ax
		mov	byte ptr [si+1Ah], 1
		pop	si
		mov	sp, bp
		pop	bp
		retf
AudioTimerOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioOp		proc far		; CODE XREF: DoAudioCvx+391P

var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		add	si, offset g_pcAudioTimers
		lea	ax, [si+1Ch]
		mov	di, ax
		mov	[bp+var_2], ds
		cmp	word ptr [si+16h], 0FFFFh
		jz	short loc_16BA_83B
		push	word ptr [si+16h]
		call	MaybeInit4cChun
		pop	bx

loc_16BA_83B:				; CODE XREF: AudioOp+20j
		mov	cl, 4
		mov	ax, [si+4]
		shr	ax, cl
		push	ax
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		mov	es, [bp+var_2]
		push	word ptr es:[di+22h]
		push	word ptr es:[di+20h]
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+16h], ax
		mov	byte ptr [si+1Ah], 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioOp		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitAudioTimer2	proc far		; CODE XREF: DoAudioCvx+3A3P

var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		add	si, offset g_pcAudioTimers
		lea	ax, [si+1Ch]
		mov	di, ax
		mov	[bp+var_2], ds
		cmp	word ptr [si+16h], 0FFFFh
		jz	short loc_16BA_896
		push	word ptr [si+16h]
		call	MaybeInit4cChun
		pop	bx

loc_16BA_896:				; CODE XREF: InitAudioTimer2+20j
		mov	cl, 4
		mov	ax, [si+4]
		shr	ax, cl
		push	ax
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		mov	es, [bp+var_2]
		push	word ptr es:[di+26h]
		push	word ptr es:[di+24h]
		call	AudioFuncIfFlag
		add	sp, 0Ah
		mov	[si+16h], ax
		mov	byte ptr [si+1Ah], 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InitAudioTimer2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitAudioTimer	proc far		; CODE XREF: DoAudioCvx+2AP
					; DoAudioCvx+57P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		push	word ptr (g_pcAudioTimers+16h)[bx]
		mov	si, ax
		call	MaybeInit4cChun
		pop	bx
		mov	word ptr (g_pcAudioTimers+16h)[si], 0FFFFh
		pop	si
		mov	sp, bp
		pop	bp
		retf
InitAudioTimer	endp

; [00000026 BYTES: COLLAPSED FUNCTION nopsub_16BA_8E9. PRESS KEYPAD "+"	TO EXPAND]
		align 2
seg007		ends

; ===========================================================================

; Segment type:	Pure code
seg008		segment	byte public 'CODE' use16
		assume cs:seg008
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Trakdata12SpriteOp proc	far		; CODE XREF: DoDialog+15Cp

var_40		= byte ptr -40h
var_22		= byte ptr -22h
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 40h
		push	di
		push	si
		mov	ax, g_wSetHandlers
		imul	g_wVideoFlag3
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_6]
		sub	ax, [bp+arg_4]
		cwd
		push	dx
		push	ax
		mov	ax, [bp+arg_2]
		sub	ax, [bp+arg_0]
		cwd
		push	dx
		push	ax
		call	__aFlmul
		push	dx
		push	ax
		call	__aFldiv
		add	ax, 12h
		adc	dx, 0
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		call	GetResDiffScale
		cmp	dx, [bp+var_2]
		jg	short loc_174B_56
		jl	short loc_174B_4D
		cmp	ax, [bp+var_4]
		ja	short loc_174B_56

loc_174B_4D:				; CODE XREF: Trakdata12SpriteOp+46j
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_56:				; CODE XREF: Trakdata12SpriteOp+44j
					; Trakdata12SpriteOp+4Bj
		push	cs
		call	near ptr DoRenderMouSpr3
		mov	ax, 0Fh
		push	ax
		mov	ax, [bp+arg_6]
		sub	ax, [bp+arg_4]
		push	ax
		mov	ax, [bp+arg_2]
		sub	ax, [bp+arg_0]
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	bl, byte_2B77_18C
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		mov	word ptr unk_2B77_75A0[bx], ax
		mov	word ptr unk_2B77_75A2[bx], dx
		mov	al, byte_2B77_18C
		sub	ah, ah
		mov	si, ax
		shl	si, 1
		mov	ax, [bp+arg_0]
		mov	word ptr unk_2B77_ACFA[si], ax
		mov	ax, [bp+arg_4]
		mov	word ptr unk_2B77_AD16[si], ax
		lea	ax, [bp+var_40]
		push	ax
		call	GetSprite1And2
		add	sp, 2
		mov	al, 3Ch	; '<'
		mul	byte_2B77_18C
		mov	bx, ax
		les	di, g_ppTrakdata12
		push	si
		lea	di, [bx+di]
		lea	si, [bp+var_40]
		mov	cx, 0Fh
		repne movsw
		pop	si
		mov	al, byte_2B77_18C
		sub	ah, ah
		shl	ax, 1
		mov	cx, 1Eh
		mul	cx
		mov	di, ax
		les	bx, g_ppTrakdata12
		push	si
		lea	di, [bx+di+1Eh]
		lea	si, [bp+var_22]
		mov	cx, 0Fh
		repne movsw
		pop	si
		call	SetSprite2As1
		push	[bp+arg_4]
		push	[bp+arg_0]
		mov	bl, byte_2B77_18C
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		les	bx, dword ptr unk_2B77_75A0[bx]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	DoClearImageArea
		add	sp, 8
		inc	byte_2B77_18C
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
Trakdata12SpriteOp endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoTrakdata12	proc far		; CODE XREF: SecurityCheck:loc_0_46C5P
					; DoDialog+509p ...

var_3C		= byte ptr -3Ch
var_1E		= byte ptr -1Eh

		push	bp
		mov	bp, sp
		sub	sp, 3Ch
		push	di
		push	si
		cmp	byte_2B77_18C, 0
		jnz	short loc_174B_128
		jmp	loc_174B_1D0
; ---------------------------------------------------------------------------

loc_174B_128:				; CODE XREF: DoTrakdata12+Dj
		dec	byte_2B77_18C
		push	cs
		call	near ptr DoRenderMouSpr3
		mov	al, byte_2B77_18C
		sub	ah, ah
		mov	si, ax
		mov	di, si
		shl	di, 1
		push	word ptr unk_2B77_AD16[di]
		push	word ptr unk_2B77_ACFA[di]
		mov	bx, si
		shl	bx, 1
		shl	bx, 1
		les	bx, dword ptr unk_2B77_75A0[bx]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	sub_1EA2_5310
		add	sp, 8
		mov	al, 3Ch	; '<'
		mul	byte_2B77_18C
		add	ax, word ptr g_ppTrakdata12
		mov	dx, word ptr g_ppTrakdata12+2
		push	si
		push	di
		lea	di, [bp+var_3C]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		mov	cx, 0Fh
		repne movsw
		pop	ds
		pop	di
		pop	si
		mov	al, byte_2B77_18C
		sub	ah, ah
		shl	ax, 1
		mov	cx, 1Eh
		mul	cx
		add	ax, word ptr g_ppTrakdata12
		mov	dx, word ptr g_ppTrakdata12+2
		add	ax, cx
		push	si
		push	di
		lea	di, [bp+var_1E]
		mov	si, ax
		push	ds
		mov	ds, dx
		mov	cx, 0Fh
		repne movsw
		pop	ds
		pop	di
		pop	si
		lea	ax, [bp+var_3C]
		push	ax
		call	CopyToSprite1_2
		add	sp, 2
		mov	bl, byte_2B77_18C
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_75A2[bx]
		push	word ptr unk_2B77_75A0[bx]
		call	ReleaseWindow
		add	sp, 4
		push	cs
		call	near ptr DoUseMousePos

loc_174B_1D0:				; CODE XREF: DoTrakdata12+Fj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoTrakdata12	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoDialog	proc far		; CODE XREF: _main+565P
					; EnterHiscore+124P ...

var_1D8		= byte ptr -1D8h
wFontDefE	= word ptr -1D6h
var_1D4		= byte ptr -1D4h
var_1D2		= word ptr -1D2h
wWaiRes		= dword	ptr -1D0h
var_1CC		= word ptr -1CCh
var_1CA		= byte ptr -1CAh
var_1C8		= word ptr -1C8h
var_1C6		= word ptr -1C6h
var_1C4		= byte ptr -1C4h
var_1C2		= word ptr -1C2h
var_1C0		= byte ptr -1C0h
var_1BE		= byte ptr -1BEh
var_196		= word ptr -196h
var_194		= word ptr -194h
var_192		= byte ptr -192h
var_142		= word ptr -142h
var_140		= byte ptr -140h
var_13E		= dword	ptr -13Eh
var_13A		= dword	ptr -13Ah
var_EE		= byte ptr -0EEh
var_C6		= byte ptr -0C6h
var_9E		= byte ptr -9Eh
var_9C		= word ptr -9Ch
var_9A		= word ptr -9Ah
var_98		= byte ptr -98h
var_84		= byte ptr -84h
var_82		= word ptr -82h
var_80		= byte ptr -80h
var_30		= word ptr -30h
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= word ptr -24h
p_wInteractiveFlag= word ptr  6
arg_2		= word ptr  8
p_pTextRes1	= word ptr  0Ah
p_pTextRes2	= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h
arg_E		= word ptr  14h
arg_10		= byte ptr  16h

		push	bp
		mov	bp, sp
		sub	sp, 1D8h
		push	di
		push	si
		mov	ax, g_wFontDef_0E
		add	ax, 2
		mov	[bp+wFontDefE],	ax
		mov	[bp+var_1C6], 0
		mov	[bp+var_194], 20h ; ' '
		push	cs
		call	near ptr DoRenderMouSpr3
		mov	ax, [bp+p_pTextRes1]
		mov	dx, [bp+p_pTextRes2]
		mov	word ptr [bp+wWaiRes], ax
		mov	word ptr [bp+wWaiRes+2], dx
		mov	[bp+var_82], 0
		jmp	loc_174B_2AA
; ---------------------------------------------------------------------------

loc_174B_210:				; CODE XREF: DoDialog+E3j
		cmp	[bp+var_1D8], 5Dh ; ']'
		jnz	short loc_174B_252
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_1C2], ax
		mov	ax, [bp+var_194]
		cmp	[bp+var_1C2], ax
		jle	short loc_174B_241
		mov	ax, [bp+var_1C2]
		mov	[bp+var_194], ax

loc_174B_241:				; CODE XREF: DoDialog+61j
		mov	[bp+var_82], 0
		mov	ax, [bp+wFontDefE]
		add	[bp+var_1C6], ax
		jmp	short loc_174B_2A6
; ---------------------------------------------------------------------------
		align 2

loc_174B_252:				; CODE XREF: DoDialog+3Fj
		les	bx, [bp+wWaiRes]
		cmp	byte ptr es:[bx], 7Dh ;	'}'
		jnz	short loc_174B_294
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_1C2], ax
		mov	ax, [bp+var_194]
		cmp	[bp+var_1C2], ax
		jle	short loc_174B_286
		mov	ax, [bp+var_1C2]
		mov	[bp+var_194], ax

loc_174B_286:				; CODE XREF: DoDialog+A6j
		mov	[bp+var_82], 0
		add	[bp+var_1C6], 4
		jmp	short loc_174B_2A6
; ---------------------------------------------------------------------------
		align 2

loc_174B_294:				; CODE XREF: DoDialog+84j
		les	bx, [bp+wWaiRes]
		mov	al, es:[bx]
		mov	si, [bp+var_82]
		inc	[bp+var_82]
		mov	[bp+si+var_80],	al

loc_174B_2A6:				; CODE XREF: DoDialog+79j DoDialog+BBj
		inc	word ptr [bp+wWaiRes]

loc_174B_2AA:				; CODE XREF: DoDialog+37j
		les	bx, [bp+wWaiRes]
		mov	al, es:[bx]
		mov	[bp+var_1D8], al
		or	al, al
		jz	short loc_174B_2BC
		jmp	loc_174B_210
; ---------------------------------------------------------------------------

loc_174B_2BC:				; CODE XREF: DoDialog+E1j
		mov	ax, [bp+var_194]
		add	ax, 18h
		and	al, 0F8h
		mov	[bp+var_194], ax
		cmp	[bp+arg_8], 0FFFFh
		jnz	short loc_174B_2E0
		mov	ax, 140h	; 200
		sub	ax, [bp+var_194]
		cwd
		sub	ax, dx
		sar	ax, 1
		and	al, 0F8h
		mov	[bp+arg_8], ax

loc_174B_2E0:				; CODE XREF: DoDialog+F7j
		cmp	[bp+arg_A], 0FFFFh
		jnz	short loc_174B_2F5
		mov	ax, 0C8h	; 320
		sub	ax, [bp+var_1C6]
		cwd
		sub	ax, dx
		sar	ax, 1
		mov	[bp+arg_A], ax

loc_174B_2F5:				; CODE XREF: DoDialog+10Ej
		mov	ax, [bp+arg_8]
		mov	[bp+var_30], ax
		add	ax, [bp+var_194]
		mov	[bp+var_2E], ax
		mov	ax, [bp+arg_A]
		sub	ax, 8
		mov	[bp+var_2C], ax
		mov	ax, [bp+arg_A]
		add	ax, [bp+var_1C6]
		add	ax, 8
		mov	[bp+var_2A], ax
		add	[bp+arg_8], 8
		sub	[bp+var_194], 10h
		cmp	[bp+arg_2], 0
		jz	short loc_174B_346
		push	ax
		push	[bp+var_2C]
		push	[bp+var_2E]
		push	[bp+var_30]
		push	cs
		call	near ptr Trakdata12SpriteOp
		add	sp, 8
		or	al, al
		jnz	short loc_174B_346
		mov	ax, 0FFFFh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_346:				; CODE XREF: DoDialog+14Fj
					; DoDialog+164j
		call	SetSprite2As1
		push	[bp+var_2A]
		push	[bp+var_2C]
		push	[bp+var_2E]
		push	[bp+var_30]
		call	SetSprite1Size
		add	sp, 8
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		push	[bp+arg_C]
		mov	ax, [bp+arg_A]
		add	ax, [bp+var_1C6]
		add	ax, 4
		push	ax
		mov	ax, [bp+arg_8]
		add	ax, [bp+var_194]

loc_174B_37F:
		add	ax, 4
		push	ax
		mov	ax, [bp+arg_A]
		sub	ax, 4
		push	ax
		mov	ax, [bp+arg_8]
		sub	ax, 4
		push	ax
		call	sub_261B_C
		add	sp, 0Ah
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		mov	word_2B77_3420,	0
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		mov	[bp+var_82], 0
		mov	[bp+var_9E], 0
		mov	ax, [bp+p_pTextRes1]
		mov	dx, [bp+p_pTextRes2]
		mov	word ptr [bp+wWaiRes], ax
		mov	word ptr [bp+wWaiRes+2], dx
		mov	[bp+var_1C6], 1
		jmp	loc_174B_4DE
; ---------------------------------------------------------------------------
		align 2

loc_174B_3E0:				; CODE XREF: DoDialog+317j
		cmp	[bp+var_1D8], 5Bh ; '['
		jnz	short loc_174B_3EA
		jmp	loc_174B_4F0
; ---------------------------------------------------------------------------

loc_174B_3EA:				; CODE XREF: DoDialog+20Fj
		cmp	[bp+var_1D8], 5Dh ; ']'
		jnz	short loc_174B_432
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		mov	ax, [bp+arg_A]
		add	ax, [bp+var_1C6]
		push	ax
		push	[bp+arg_8]
		lea	ax, [bp+var_80]
		push	ax
		call	FontSpriteOp
		add	sp, 6
		mov	[bp+var_82], 0
		mov	ax, [bp+wFontDefE]
		add	[bp+var_1C6], ax

loc_174B_41E:				; CODE XREF: DoDialog+290j
		mov	ax, word ptr [bp+wWaiRes]
		mov	dx, word ptr [bp+wWaiRes+2]
		mov	[bp+var_9C], ax
		mov	[bp+var_9A], dx
		jmp	loc_174B_4DA
; ---------------------------------------------------------------------------
		align 2

loc_174B_432:				; CODE XREF: DoDialog+219j
		les	bx, [bp+wWaiRes]
		cmp	byte ptr es:[bx], 7Dh ;	'}'
		jnz	short loc_174B_468
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		mov	ax, [bp+arg_A]
		add	ax, [bp+var_1C6]
		push	ax
		push	[bp+arg_8]
		lea	ax, [bp+var_80]
		push	ax
		call	FontSpriteOp
		add	sp, 6
		mov	[bp+var_82], 0
		add	[bp+var_1C6], 4
		jmp	short loc_174B_41E
; ---------------------------------------------------------------------------

loc_174B_468:				; CODE XREF: DoDialog+264j
		les	bx, [bp+wWaiRes]
		cmp	byte ptr es:[bx], 40h ;	'@'
		jnz	short loc_174B_4C8
		cmp	[bp+p_wInteractiveFlag], 3
		jnz	short loc_174B_4BA
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		add	ax, [bp+arg_8]
		mov	cx, ax
		mov	al, [bp+var_9E]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	si, [bp+arg_E]
		mov	[bx+si], cx
		mov	al, [bp+var_9E]
		cbw
		mov	si, ax
		shl	si, 1
		mov	bx, [bp+arg_E]
		mov	ax, [bp+arg_A]
		add	ax, [bp+var_1C6]
		mov	[bx+si+2], ax
		add	[bp+var_9E], 2

loc_174B_4BA:				; CODE XREF: DoDialog+2A0j
		mov	si, [bp+var_82]
		inc	[bp+var_82]
		mov	[bp+si+var_80],	20h ; ' '
		jmp	short loc_174B_4DA
; ---------------------------------------------------------------------------

loc_174B_4C8:				; CODE XREF: DoDialog+29Aj
		les	bx, [bp+wWaiRes]
		mov	al, es:[bx]
		mov	si, [bp+var_82]
		inc	[bp+var_82]
		mov	[bp+si+var_80],	al

loc_174B_4DA:				; CODE XREF: DoDialog+258j
					; DoDialog+2F0j
		inc	word ptr [bp+wWaiRes]

loc_174B_4DE:				; CODE XREF: DoDialog+206j
		les	bx, [bp+wWaiRes]
		mov	al, es:[bx]
		mov	[bp+var_1D8], al
		or	al, al
		jz	short loc_174B_4F0
		jmp	loc_174B_3E0
; ---------------------------------------------------------------------------

loc_174B_4F0:				; CODE XREF: DoDialog+211j
					; DoDialog+315j
		mov	[bp+var_140], 0
		jmp	loc_174B_658
; ---------------------------------------------------------------------------

loc_174B_4F8:				; CODE XREF: DoDialog+48Cj
		inc	word ptr [bp+wWaiRes]
		mov	al, [bp+var_140]
		cbw
		mov	si, ax
		mov	bx, si
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	ax, word ptr [bp+wWaiRes]
		mov	dx, word ptr [bp+wWaiRes+2]
		mov	[bx-13Eh], ax
		mov	[bx-13Ch], dx
		mov	bx, [bp+var_82]
		add	bx, bp
		mov	byte ptr [bx-80h], 0
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		add	ax, [bp+arg_8]
		mov	bx, si
		shl	bx, 1
		add	bx, bp
		mov	[bx-28h], ax
		mov	si, [bp+arg_A]
		add	si, [bp+var_1C6]
		mov	al, [bp+var_140]
		cbw
		mov	di, ax
		shl	di, 1
		add	di, bp
		mov	[di-1BEh], si
		mov	ax, [bp+wFontDefE]
		add	ax, si
		mov	[di-0EEh], ax
		mov	[bp+var_1CA], 0
		mov	bx, [bp+var_82]
		inc	[bp+var_82]
		add	bx, bp
		mov	byte ptr [bx-80h], 20h ; ' '
		mov	[bp+var_1C2], 0
		jmp	loc_174B_5FE
; ---------------------------------------------------------------------------
		align 2

loc_174B_57A:				; CODE XREF: DoDialog+437j
		cmp	[bp+var_1D8], 5Bh ; '['
		jnz	short loc_174B_584
		jmp	loc_174B_610
; ---------------------------------------------------------------------------

loc_174B_584:				; CODE XREF: DoDialog+3A9j
		cmp	[bp+var_1D8], 5Dh ; ']'
		jnz	short loc_174B_5B4
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_1C2], ax
		mov	[bp+var_82], 0
		mov	ax, [bp+wFontDefE]
		add	[bp+var_1C6], ax
		jmp	short loc_174B_5FA
; ---------------------------------------------------------------------------
		align 2

loc_174B_5B4:				; CODE XREF: DoDialog+3B3j
		les	bx, [bp+wWaiRes]
		cmp	byte ptr es:[bx], 7Dh ;	'}'
		jnz	short loc_174B_5E4
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_1C2], ax
		mov	[bp+var_82], 0
		add	[bp+var_1C6], 3
		jmp	short loc_174B_5FA
; ---------------------------------------------------------------------------
		align 2

loc_174B_5E4:				; CODE XREF: DoDialog+3E6j
		les	bx, [bp+wWaiRes]
		mov	al, es:[bx]
		mov	si, [bp+var_82]
		inc	[bp+var_82]
		mov	[bp+si+var_80],	al
		inc	[bp+var_1CA]

loc_174B_5FA:				; CODE XREF: DoDialog+3DBj
					; DoDialog+40Bj
		inc	word ptr [bp+wWaiRes]

loc_174B_5FE:				; CODE XREF: DoDialog+3A0j
		les	bx, [bp+wWaiRes]
		mov	al, es:[bx]
		mov	[bp+var_1D8], al
		or	al, al
		jz	short loc_174B_610
		jmp	loc_174B_57A
; ---------------------------------------------------------------------------

loc_174B_610:				; CODE XREF: DoDialog+3ABj
					; DoDialog+435j
		mov	al, [bp+var_140]
		cbw
		mov	si, ax
		mov	al, [bp+var_1CA]
		mov	[bp+si+var_98],	al
		mov	si, [bp+var_82]
		mov	[bp+si+var_80],	0
		cmp	[bp+var_1C2], 0
		jnz	short loc_174B_63E
		lea	ax, [bp+var_80]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_1C2], ax

loc_174B_63E:				; CODE XREF: DoDialog+456j
		mov	al, [bp+var_140]
		cbw
		mov	si, ax
		shl	si, 1
		add	si, bp
		mov	ax, [si-28h]
		add	ax, [bp+var_1C2]
		mov	[si-0C6h], ax
		inc	[bp+var_140]

loc_174B_658:				; CODE XREF: DoDialog+31Fj
		les	bx, [bp+wWaiRes]
		cmp	byte ptr es:[bx], 5Bh ;	'['
		jnz	short loc_174B_665
		jmp	loc_174B_4F8
; ---------------------------------------------------------------------------

loc_174B_665:				; CODE XREF: DoDialog+48Aj
		cmp	[bp+var_140], 2
		jle	short loc_174B_6A6
		mov	ax, [bp+var_26]
		cmp	[bp+var_28], ax
		jnz	short loc_174B_6A6
		mov	ax, [bp+var_24]
		cmp	[bp+var_26], ax
		jnz	short loc_174B_6A6
		mov	[bp+var_196], 0
		jmp	short loc_174B_69B
; ---------------------------------------------------------------------------

loc_174B_684:				; CODE XREF: DoDialog+4CEj
		mov	si, [bp+var_196]
		shl	si, 1
		add	si, bp
		mov	ax, [si-28h]
		add	ax, [bp+var_194]
		mov	[si-0C6h], ax
		inc	[bp+var_196]

loc_174B_69B:				; CODE XREF: DoDialog+4ACj
		mov	al, [bp+var_140]
		cbw
		cmp	ax, [bp+var_196]
		jg	short loc_174B_684

loc_174B_6A6:				; CODE XREF: DoDialog+494j
					; DoDialog+49Cj ...
		push	cs
		call	near ptr DoUseMousePos
		mov	[bp+var_1D4], 1
		mov	ax, [bp+p_wInteractiveFlag]
		or	ax, ax
		jz	short loc_174B_70C ; mode 0 - just quit
		cmp	ax, 1
		jz	short loc_174B_6E8
		cmp	ax, 2
		jz	short loc_174B_724
		cmp	ax, 3
		jz	short loc_174B_714 ; mode 3 = also just	quit
		cmp	ax, 4
		jnz	short loc_174B_6D8
		mov	ax, 8
		cwd
		push	dx
		push	ax
		call	GetValueIfTwice
		add	sp, 4

loc_174B_6D8:				; CODE XREF: DoDialog+4F2j
					; DoDialog+534j ...
		cmp	[bp+arg_2], 0
		jz	short loc_174B_6E2
		push	cs
		call	near ptr DoTrakdata12

loc_174B_6E2:				; CODE XREF: DoDialog+506j
		mov	al, [bp+var_1D4]
		jmp	short loc_174B_71D
; ---------------------------------------------------------------------------

loc_174B_6E8:				; CODE XREF: DoDialog+4E3j
					; DoDialog+524j
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		mov	[bp+var_142], ax
		or	ax, ax
		jz	short loc_174B_6E8
		cmp	ax, 1Bh
		jnz	short loc_174B_706
		mov	[bp+var_1D4], 0

loc_174B_706:				; CODE XREF: DoDialog+529j
		push	cs
		call	near ptr CheckForInput
		jmp	short loc_174B_6D8
; ---------------------------------------------------------------------------

loc_174B_70C:				; CODE XREF: DoDialog+4DEj
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_714:				; CODE XREF: DoDialog+4EDj
		mov	al, [bp+var_9E]
		cbw
		mov	cl, 2
		idiv	cl

loc_174B_71D:				; CODE XREF: DoDialog+510j
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_724:				; CODE XREF: DoDialog+4E8j
		mov	al, [bp+arg_10]
		mov	[bp+var_1D4], al
		mov	[bp+var_1C0], 0FFh
		push	cs
		call	near ptr DoGetTimerDelta
		push	cs
		call	near ptr DoRenderMouSpr3
		cmp	[bp+var_140], 2
		jnz	short loc_174B_7B8
		mov	[bp+var_196], 0

loc_174B_745:				; CODE XREF: DoDialog+587j
		mov	bx, [bp+var_196]
		les	si, [bp+var_13E]
		mov	al, es:[bx+si]
		sub	ah, ah
		mov	[bp+var_1C8], ax
		inc	[bp+var_196]
		cmp	ax, 20h	; ' '
		jz	short loc_174B_745
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_77C
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_776
		add	ax, 20h	; ' '
		jmp	short loc_174B_778
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_174B_776:				; CODE XREF: DoDialog+597j
		mov	ax, bx

loc_174B_778:				; CODE XREF: DoDialog+59Cj
		mov	[bp+var_1C8], ax

loc_174B_77C:				; CODE XREF: DoDialog+590j
		mov	[bp+var_196], 0

loc_174B_782:				; CODE XREF: DoDialog+5C4j
		mov	bx, [bp+var_196]
		les	si, [bp+var_13A]
		mov	al, es:[bx+si]
		sub	ah, ah
		mov	[bp+var_1CC], ax
		inc	[bp+var_196]
		cmp	ax, 20h	; ' '
		jz	short loc_174B_782
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_7B8
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_7B2
		add	ax, 20h	; ' '
		jmp	short loc_174B_7B4
; ---------------------------------------------------------------------------
		align 2

loc_174B_7B2:				; CODE XREF: DoDialog+5D4j
		mov	ax, bx

loc_174B_7B4:				; CODE XREF: DoDialog+5D9j
		mov	[bp+var_1CC], ax

loc_174B_7B8:				; CODE XREF: DoDialog+567j
					; DoDialog+5CDj
		mov	[bp+var_84], 1

loc_174B_7BD:				; CODE XREF: DoDialog+7AAj
					; DoDialog+7CCj ...
		cmp	[bp+var_84], 0
		jnz	short loc_174B_7C7
		jmp	loc_174B_6D8
; ---------------------------------------------------------------------------

loc_174B_7C7:				; CODE XREF: DoDialog+5ECj
		mov	al, [bp+var_1C0]
		cmp	[bp+var_1D4], al
		jnz	short loc_174B_7D4
		jmp	loc_174B_8BD
; ---------------------------------------------------------------------------

loc_174B_7D4:				; CODE XREF: DoDialog+5F9j
		push	cs
		call	near ptr DoRenderMouSpr3
		mov	[bp+var_196], 0
		jmp	loc_174B_875
; ---------------------------------------------------------------------------
		align 2

loc_174B_7E2:				; CODE XREF: DoDialog+6B0j
					; DoDialog+6C1j
		mov	al, [bp+var_1D4]
		cbw
		cmp	ax, [bp+var_196]
		jnz	short loc_174B_7F8
		push	g_wFontFlag
		push	word_2B77_3420
		jmp	short loc_174B_800
; ---------------------------------------------------------------------------
		align 2

loc_174B_7F8:				; CODE XREF: DoDialog+615j
		push	word_2B77_3420
		push	g_wFontFlag

loc_174B_800:				; CODE XREF: DoDialog+61Fj
					; DoDialog+6CCj
		call	SetTwoFontBytes
		add	sp, 4
		mov	si, [bp+var_196]
		shl	si, 1
		shl	si, 1
		mov	ax, word ptr [bp+si+var_13E]
		mov	dx, word ptr [bp+si+var_13E+2]
		mov	word ptr [bp+wWaiRes], ax
		mov	word ptr [bp+wWaiRes+2], dx
		mov	[bp+var_82], 0
		jmp	short loc_174B_83D
; ---------------------------------------------------------------------------

loc_174B_828:				; CODE XREF: DoDialog+674j
		mov	bx, [bp+var_82]
		les	si, [bp+wWaiRes]
		mov	al, es:[bx+si]
		mov	si, bx
		mov	[bp+si+var_192], al
		inc	[bp+var_82]

loc_174B_83D:				; CODE XREF: DoDialog+650j
		mov	si, [bp+var_196]
		mov	al, [bp+si+var_98]
		cbw
		cmp	ax, [bp+var_82]
		jg	short loc_174B_828
		mov	di, [bp+var_82]
		mov	[bp+di+var_192], 0
		mov	si, [bp+var_196]
		shl	si, 1
		add	si, bp
		push	word ptr [si-1BEh]
		push	word ptr [si-28h]
		lea	ax, [bp+var_192]
		push	ax
		call	FontSpriteOp
		add	sp, 6
		inc	[bp+var_196]

loc_174B_875:				; CODE XREF: DoDialog+608j
		mov	al, [bp+var_140]
		cbw
		cmp	ax, [bp+var_196]
		jle	short loc_174B_8A6
		cmp	[bp+arg_E], 0
		jnz	short loc_174B_889
		jmp	loc_174B_7E2
; ---------------------------------------------------------------------------

loc_174B_889:				; CODE XREF: DoDialog+6AEj
		mov	bx, [bp+var_196]
		shl	bx, 1
		mov	si, [bp+arg_E]
		cmp	word ptr [bx+si], 0
		jnz	short loc_174B_89A
		jmp	loc_174B_7E2
; ---------------------------------------------------------------------------

loc_174B_89A:				; CODE XREF: DoDialog+6BFj
		push	word_2B77_3420
		push	g_wDialogArg1
		jmp	loc_174B_800
; ---------------------------------------------------------------------------
		align 2

loc_174B_8A6:				; CODE XREF: DoDialog+6A8j
		push	cs
		call	near ptr DoUseMousePos
		cmp	[bp+var_1C0], 0FFh
		jnz	short loc_174B_8B5
		push	cs
		call	near ptr CheckForInput

loc_174B_8B5:				; CODE XREF: DoDialog+6D9j
		mov	al, [bp+var_1D4]
		mov	[bp+var_1C0], al

loc_174B_8BD:				; CODE XREF: DoDialog+5FBj
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		mov	[bp+var_142], ax
		lea	ax, [bp+var_EE]
		push	ax
		lea	ax, [bp+var_1BE]
		push	ax
		lea	ax, [bp+var_C6]
		push	ax
		lea	ax, [bp+var_28]
		push	ax
		mov	al, [bp+var_140]
		cbw
		push	ax
		push	cs
		call	near ptr CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_1C4], al
		cmp	al, 0FFh
		jz	short loc_174B_90C
		cmp	[bp+arg_E], 0
		jz	short loc_174B_908
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	si, [bp+arg_E]
		cmp	word ptr [bx+si], 0
		jnz	short loc_174B_90C

loc_174B_908:				; CODE XREF: DoDialog+723j
		mov	[bp+var_1D4], al

loc_174B_90C:				; CODE XREF: DoDialog+71Dj
					; DoDialog+730j
		cmp	[bp+var_140], 2
		jnz	short loc_174B_965
		cmp	[bp+var_142], 0
		jz	short loc_174B_965
		mov	ax, [bp+var_142]
		mov	[bp+var_1D2], ax
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_93E
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_938
		add	ax, 20h	; ' '
		jmp	short loc_174B_93A
; ---------------------------------------------------------------------------
		align 2

loc_174B_938:				; CODE XREF: DoDialog+75Aj
		mov	ax, bx

loc_174B_93A:				; CODE XREF: DoDialog+75Fj
		mov	[bp+var_1D2], ax

loc_174B_93E:				; CODE XREF: DoDialog+753j
		mov	ax, [bp+var_1D2]
		cmp	[bp+var_1C8], ax
		jnz	short loc_174B_950
		mov	[bp+var_1D4], 0
		jmp	short loc_174B_95F
; ---------------------------------------------------------------------------
		align 2

loc_174B_950:				; CODE XREF: DoDialog+770j
		mov	ax, [bp+var_1D2]
		cmp	[bp+var_1CC], ax
		jnz	short loc_174B_965
		mov	[bp+var_1D4], 1

loc_174B_95F:				; CODE XREF: DoDialog+777j
		mov	[bp+var_142], 0Dh

loc_174B_965:				; CODE XREF: DoDialog+73Bj
					; DoDialog+742j ...
		mov	ax, [bp+var_142]
		cmp	ax, 20h	; ' '
		jnz	short loc_174B_971
		jmp	loc_174B_9F9
; ---------------------------------------------------------------------------

loc_174B_971:				; CODE XREF: DoDialog+796j
		jbe	short loc_174B_976
		jmp	loc_174B_A06
; ---------------------------------------------------------------------------

loc_174B_976:				; CODE XREF: DoDialog:loc_174B_971j
		cmp	ax, 0Dh
		jz	short loc_174B_9F9
		cmp	ax, 1Bh
		jz	short loc_174B_9F4
		jmp	loc_174B_7BD
; ---------------------------------------------------------------------------
		align 2

loc_174B_984:				; CODE XREF: DoDialog+7DEj
					; DoDialog+835j ...
		cmp	[bp+var_1D4], 0
		jz	short loc_174B_992
		dec	[bp+var_1D4]
		jmp	short loc_174B_99C
; ---------------------------------------------------------------------------
		align 2

loc_174B_992:				; CODE XREF: DoDialog+7B3j
		mov	al, [bp+var_140]
		dec	al
		mov	[bp+var_1D4], al

loc_174B_99C:				; CODE XREF: DoDialog+7B9j
		cmp	[bp+arg_E], 0
		jnz	short loc_174B_9A5
		jmp	loc_174B_7BD
; ---------------------------------------------------------------------------

loc_174B_9A5:				; CODE XREF: DoDialog+7CAj
		mov	al, [bp+var_1D4]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	si, [bp+arg_E]
		cmp	word ptr [bx+si], 0
		jnz	short loc_174B_984
		jmp	loc_174B_7BD
; ---------------------------------------------------------------------------
		align 2

loc_174B_9BA:				; CODE XREF: DoDialog+819j
					; DoDialog+843j ...
		mov	al, [bp+var_1D4]
		cbw
		inc	ax
		mov	cx, ax
		mov	al, [bp+var_140]
		cbw
		cmp	cx, ax
		jge	short loc_174B_9D2
		inc	[bp+var_1D4]
		jmp	short loc_174B_9D7
; ---------------------------------------------------------------------------
		align 2

loc_174B_9D2:				; CODE XREF: DoDialog+7F3j
		mov	[bp+var_1D4], 0

loc_174B_9D7:				; CODE XREF: DoDialog+7F9j
		cmp	[bp+arg_E], 0
		jnz	short loc_174B_9E0
		jmp	loc_174B_7BD
; ---------------------------------------------------------------------------

loc_174B_9E0:				; CODE XREF: DoDialog+805j
		mov	al, [bp+var_1D4]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	si, [bp+arg_E]
		cmp	word ptr [bx+si], 0
		jnz	short loc_174B_9BA
		jmp	loc_174B_7BD
; ---------------------------------------------------------------------------

loc_174B_9F4:				; CODE XREF: DoDialog+7A8j
		mov	[bp+var_1D4], 0FFh

loc_174B_9F9:				; CODE XREF: DoDialog+798j
					; DoDialog+7A3j
		mov	[bp+var_84], 0
		push	cs
		call	near ptr CheckForInput
		jmp	loc_174B_7BD
; ---------------------------------------------------------------------------
		align 2

loc_174B_A06:				; CODE XREF: DoDialog+79Dj
		cmp	ax, 4800h
		jnz	short loc_174B_A0E
		jmp	loc_174B_984
; ---------------------------------------------------------------------------

loc_174B_A0E:				; CODE XREF: DoDialog+833j
		cmp	ax, 4B00h
		jnz	short loc_174B_A16
		jmp	loc_174B_984
; ---------------------------------------------------------------------------

loc_174B_A16:				; CODE XREF: DoDialog+83Bj
		cmp	ax, 4D00h
		jz	short loc_174B_9BA
		cmp	ax, 5000h
		jz	short loc_174B_9BA
		jmp	loc_174B_7BD
DoDialog	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TakesTrackNames	proc far		; CODE XREF: RunTracksMenu+434P
					; RunOptionMenu+1BAP ...

var_71C		= word ptr -71Ch
var_71A		= word ptr -71Ah
var_718		= byte ptr -718h
var_716		= byte ptr -716h
var_714		= byte ptr -714h
var_712		= word ptr -712h
var_710		= word ptr -710h
var_70E		= word ptr -70Eh
var_70C		= word ptr -70Ch
var_70A		= word ptr -70Ah
var_708		= word ptr -708h
var_6EA		= byte ptr -6EAh
var_6E8		= word ptr -6E8h
var_6E6		= word ptr -6E6h
var_6E4		= byte ptr -6E4h
var_6E2		= byte ptr -6E2h
var_6E0		= word ptr -6E0h
var_6D0		= word ptr -6D0h
var_6CC		= word ptr -6CCh
var_6CA		= word ptr -6CAh
var_6C8		= byte ptr -6C8h
var_6B4		= byte ptr -6B4h
var_6A0		= byte ptr -6A0h
var_69C		= byte ptr -69Ch
var_69A		= byte ptr -69Ah
var_698		= byte ptr -698h
var_18		= byte ptr -18h
var_16		= byte ptr -16h
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 71Ch
		push	di
		push	si
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_712]
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aLoa	; "loa"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		or	ax, ax
		jge	short loc_174B_A6E
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_A6E:				; CODE XREF: TakesTrackNames+40j
		mov	al, g_bSaveDelFlag
		mov	[bp+var_18], al
		mov	g_bSaveDelFlag,	1
		mov	ax, [bp+var_708]
		add	ax, 4
		mov	[bp+var_71C], ax
		push	g_wDialogArg2
		push	ax
		mov	ax, [bp+var_70A]
		add	ax, 0ABh ; '«'
		push	ax
		push	[bp+var_71C]
		mov	ax, [bp+var_70A]
		sub	ax, 4
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	word_2B77_3420
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+arg_8]
		push	[bp+arg_6]
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr CopyString
		add	sp, 6
		push	[bp+var_710]
		push	[bp+var_712]
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		mov	di, [bp+var_70E]
		lea	ax, [di+0A2h]
		mov	[bp+var_6E6], ax
		mov	[bp+var_6EA], 0
		jmp	short loc_174B_B2D
; ---------------------------------------------------------------------------
		align 2

loc_174B_AEE:				; CODE XREF: TakesTrackNames+133j
		mov	al, [bp+var_6EA]
		cbw
		mov	[bp+var_71C], ax
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		mov	ax, [bx-70Ch]
		mov	bx, [bp+var_71C]
		shl	bx, 1
		add	bx, bp

loc_174B_B0B:				; CODE XREF: TakesTrackNames+140j
		mov	[bx-6E2h], ax
		mov	al, [bp+var_6EA]
		cbw
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_71C], ax
		mov	bx, ax
		mov	ax, [bx-6E2h]
		add	ax, 0Ah
		mov	[bx-6C8h], ax
		inc	[bp+var_6EA]

loc_174B_B2D:				; CODE XREF: TakesTrackNames+C7j
		cmp	[bp+var_6EA], 0Ah
		jge	short loc_174B_B66
		mov	al, [bp+var_6EA]
		cbw
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_71C], ax
		mov	bx, ax
		mov	[bx-16h], di
		mov	bx, [bp+var_71C]
		mov	ax, [bp+var_6E6]
		mov	[bx-6B4h], ax
		cmp	[bp+var_6EA], 9
		jnz	short loc_174B_AEE
		mov	bx, [bp+var_71C]
		mov	ax, [bx-6E4h]
		add	ax, 0Ah
		jmp	short loc_174B_B0B
; ---------------------------------------------------------------------------

loc_174B_B66:				; CODE XREF: TakesTrackNames+10Ej
		push	word_2B77_3420
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+var_70C]
		push	di
		push	[bp+arg_0]
		call	FontSpriteOp
		add	sp, 6

loc_174B_B86:				; CODE XREF: TakesTrackNames+1B6j
		push	cs
		call	near ptr DoUseMousePos
		mov	[bp+var_714], 0
		push	[bp+arg_4]
		mov	ax, offset asc_2B77_3426 ; "*"
		push	ax
		push	[bp+arg_0]
		call	FindFileFromPat
		add	sp, 6
		mov	[bp+var_6E8], ax
		or	ax, ax
		jnz	short loc_174B_BE4
		call	nullsub_1

loc_174B_BAE:				; CODE XREF: TakesTrackNames:loc_174B_1002j
		push	word_2B77_3420
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		mov	ax, 7530h
		cwd
		push	dx
		push	ax
		push	[bp+var_70C]
		push	di
		mov	ax, 12h
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr DoReadline
		add	sp, 0Ch
		cmp	ax, 1Bh
		jnz	short loc_174B_B86

loc_174B_BDC:				; CODE XREF: TakesTrackNames+6B2j
		mov	[bp+var_6A0], 0
		jmp	loc_174B_10FC
; ---------------------------------------------------------------------------

loc_174B_BE4:				; CODE XREF: TakesTrackNames+183j
		push	[bp+var_6E8]
		lea	ax, [bp+var_698]
		push	ax
		push	cs
		call	near ptr SubWithPathTest
		add	sp, 4
		inc	[bp+var_714]

loc_174B_BF8:				; CODE XREF: TakesTrackNames+20Cj
		call	DoFindNext
		mov	[bp+var_6E8], ax
		or	ax, ax
		jz	short loc_174B_C32
		push	ax
		mov	al, [bp+var_714]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		push	cs
		call	near ptr SubWithPathTest
		add	sp, 4
		inc	[bp+var_714]
		mov	al, [bp+var_714]
		cbw
		cmp	ax, 80h	; '€'
		jnz	short loc_174B_BF8

loc_174B_C32:				; CODE XREF: TakesTrackNames+1DFj
		call	nullsub_1
		cmp	[bp+var_714], 1
		jg	short loc_174B_C41
		jmp	loc_174B_D1C
; ---------------------------------------------------------------------------

loc_174B_C41:				; CODE XREF: TakesTrackNames+218j
		sub	si, si
		jmp	loc_174B_D07
; ---------------------------------------------------------------------------

loc_174B_C46:				; CODE XREF: TakesTrackNames+268j
					; TakesTrackNames+2DEj
		inc	[bp+var_6CA]

loc_174B_C4A:				; CODE XREF: TakesTrackNames+2F4j
		mov	al, [bp+var_714]
		cbw
		cmp	ax, [bp+var_6CA]
		ja	short loc_174B_C58
		jmp	loc_174B_D06
; ---------------------------------------------------------------------------

loc_174B_C58:				; CODE XREF: TakesTrackNames+22Fj
		mov	ax, [bp+var_6CA]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		call	_strcmp
		add	sp, 4
		or	ax, ax
		jle	short loc_174B_C46
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, [bp+var_6CA]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset g_pTempByte
		push	ax
		mov	ax, [bp+var_6CA]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		call	_strcpy
		add	sp, 4
		jmp	loc_174B_C46
; ---------------------------------------------------------------------------
		align 2

loc_174B_D06:				; CODE XREF: TakesTrackNames+231j
		inc	si

loc_174B_D07:				; CODE XREF: TakesTrackNames+21Fj
		mov	al, [bp+var_714]
		cbw
		dec	ax
		cmp	ax, si
		jbe	short loc_174B_D1C
		lea	ax, [si+1]
		mov	[bp+var_6CA], ax
		jmp	loc_174B_C4A
; ---------------------------------------------------------------------------
		align 2

loc_174B_D1C:				; CODE XREF: TakesTrackNames+21Aj
					; TakesTrackNames+2EBj
		cmp	[bp+var_714], 7
		jle	short loc_174B_D9D
		mov	ax, offset aLsu	; "lsu"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr CopyString
		add	sp, 6
		push	[bp+var_6E0]
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		mov	ax, offset aLsd	; "lsd"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr CopyString
		add	sp, 6
		mov	ax, [bp+var_6D0]
		dec	ax
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr MaybeRightAlign
		add	sp, 2
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6

loc_174B_D9D:				; CODE XREF: TakesTrackNames+2FDj
		mov	[bp+var_716], 0
		mov	[bp+var_69A], 0
		mov	[bp+var_6E4], 0FFh
		mov	[bp+var_718], 0FFh
		push	cs
		call	near ptr DoGetTimerDelta
		mov	[bp+var_2], 0

loc_174B_DB9:				; CODE XREF: TakesTrackNames+6A9j
		mov	al, [bp+var_6E4]
		cmp	[bp+var_716], al
		jnz	short loc_174B_DD0
		mov	al, [bp+var_718]
		cmp	[bp+var_69A], al
		jnz	short loc_174B_DD0
		jmp	loc_174B_EC0
; ---------------------------------------------------------------------------

loc_174B_DD0:				; CODE XREF: TakesTrackNames+39Dj
					; TakesTrackNames+3A7j
		mov	al, [bp+var_716]
		mov	[bp+var_6E4], al
		mov	al, [bp+var_69A]
		mov	[bp+var_718], al
		push	cs
		call	near ptr DoRenderMouSpr3
		sub	si, si
		jmp	loc_174B_E96
; ---------------------------------------------------------------------------
		align 2

loc_174B_DEA:				; CODE XREF: TakesTrackNames+489j
		push	word_2B77_3420
		push	g_wFontFlag

loc_174B_DF2:				; CODE XREF: TakesTrackNames+494j
		call	SetTwoFontBytes
		add	sp, 4
		mov	al, [bp+var_69A]
		cbw
		add	ax, si
		mov	[bp+var_71C], ax
		mov	al, [bp+var_714]
		cbw
		cmp	ax, [bp+var_71C]
		jbe	short loc_174B_E42
		mov	ax, [bp+var_71C]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	_strcpy
		add	sp, 4
		mov	bx, si
		shl	bx, 1
		add	bx, bp
		push	word ptr [bx-6DEh]
		push	di
		mov	ax, offset g_pTempByte
		jmp	short loc_174B_E50
; ---------------------------------------------------------------------------

loc_174B_E42:				; CODE XREF: TakesTrackNames+3EAj
		mov	bx, si
		shl	bx, 1
		add	bx, bp
		push	word ptr [bx-6DEh]
		push	di
		mov	ax, offset asc_2B77_3430 ; "	    "

loc_174B_E50:				; CODE XREF: TakesTrackNames+41Cj
		push	ax
		call	FontSpriteOp
		add	sp, 6
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_71A], ax
		push	word_2B77_3420
		mov	ax, 8
		push	ax
		mov	ax, [bp+var_6E6]
		sub	ax, [bp+var_71A]
		sub	ax, di
		push	ax
		mov	bx, si
		shl	bx, 1
		add	bx, bp
		push	word ptr [bx-6DEh]
		mov	ax, [bp+var_71A]
		add	ax, di
		push	ax
		call	SpriteOp
		add	sp, 0Ah
		inc	si

loc_174B_E96:				; CODE XREF: TakesTrackNames+3C2j
		cmp	si, 7
		jnb	short loc_174B_EBC
		mov	al, [bp+var_69A]
		cbw
		add	ax, si
		mov	cx, ax
		mov	al, [bp+var_716]
		cbw
		cmp	cx, ax
		jz	short loc_174B_EB0
		jmp	loc_174B_DEA
; ---------------------------------------------------------------------------

loc_174B_EB0:				; CODE XREF: TakesTrackNames+487j
		push	g_wFontFlag
		push	word_2B77_3420
		jmp	loc_174B_DF2
; ---------------------------------------------------------------------------
		align 2

loc_174B_EBC:				; CODE XREF: TakesTrackNames+475j
		push	cs
		call	near ptr DoUseMousePos

loc_174B_EC0:				; CODE XREF: TakesTrackNames+3A9j
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		mov	[bp+var_6CC], ax
		lea	ax, [bp+var_6C8]
		push	ax
		lea	ax, [bp+var_6E2]
		push	ax
		lea	ax, [bp+var_6B4]
		push	ax
		lea	ax, [bp+var_16]
		push	ax
		mov	ax, 0Ah
		push	ax
		push	cs
		call	near ptr CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_6EA], al
		cmp	al, 0FFh
		jnz	short loc_174B_EF9
		jmp	loc_174B_FA2
; ---------------------------------------------------------------------------

loc_174B_EF9:				; CODE XREF: TakesTrackNames+4D0j
		or	al, al
		jnz	short loc_174B_F1A
		test	byte ptr g_wMouButStatus, 3
		jnz	short loc_174B_F07
		jmp	loc_174B_FA2
; ---------------------------------------------------------------------------

loc_174B_F07:				; CODE XREF: TakesTrackNames+4DEj
		mov	[bp+var_716], 0
		mov	[bp+var_69A], 0FFh

loc_174B_F11:				; CODE XREF: TakesTrackNames+520j
					; TakesTrackNames+52Aj	...
		mov	[bp+var_6CC], 0
		jmp	loc_174B_FA2
; ---------------------------------------------------------------------------

loc_174B_F1A:				; CODE XREF: TakesTrackNames+4D7j
		cmp	[bp+var_6EA], 1
		jnz	short loc_174B_F52
		test	byte ptr g_wMouButStatus, 3
		jz	short loc_174B_FA2
		mov	al, [bp+var_69A]
		cbw
		mov	cx, ax
		mov	al, [bp+var_716]
		cbw
		add	ax, cx
		jz	short loc_174B_F3C
		dec	[bp+var_716]

loc_174B_F3C:				; CODE XREF: TakesTrackNames+512j
		mov	al, [bp+var_69A]
		cmp	[bp+var_716], al
		jge	short loc_174B_F11
		mov	al, [bp+var_716]
		mov	[bp+var_69A], al
		jmp	short loc_174B_F11
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_174B_F52:				; CODE XREF: TakesTrackNames+4FBj
		cmp	[bp+var_6EA], 9
		jnz	short loc_174B_F78
		test	byte ptr g_wMouButStatus, 3
		jz	short loc_174B_FA2
		mov	al, [bp+var_714]
		cbw
		dec	ax
		mov	cx, ax
		mov	al, [bp+var_716]
		cbw
		cmp	cx, ax
		jz	short loc_174B_F11
		inc	[bp+var_716]
		jmp	short loc_174B_F11
; ---------------------------------------------------------------------------
		align 2

loc_174B_F78:				; CODE XREF: TakesTrackNames+533j
		mov	al, [bp+var_6EA]
		cbw
		mov	cx, ax
		mov	al, [bp+var_69A]
		cbw
		add	ax, cx
		sub	ax, 2
		mov	cx, ax
		mov	al, [bp+var_714]
		cbw
		cmp	cx, ax
		jge	short loc_174B_FA2
		mov	al, [bp+var_69A]
		add	al, [bp+var_6EA]
		sub	al, 2
		mov	[bp+var_716], al

loc_174B_FA2:				; CODE XREF: TakesTrackNames+4D2j
					; TakesTrackNames+4E0j	...
		mov	ax, [bp+var_6CC]
		cmp	ax, 0Dh
		jz	short loc_174B_101E
		cmp	ax, 1Bh
		jz	short loc_174B_1024
		cmp	ax, 20h	; ' '
		jz	short loc_174B_101E
		cmp	ax, 4800h
		jz	short loc_174B_FE2
		cmp	ax, 5000h
		jz	short loc_174B_1006
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jnz	short loc_174B_FCF
		test	byte ptr g_arrSlashS[bx], 2
		jz	short loc_174B_FE6

loc_174B_FCF:				; CODE XREF: TakesTrackNames+5A2j
		mov	bx, [bp+var_6CC]
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_102A
		mov	al, byte ptr [bp+var_6CC]
		add	al, 20h	; ' '
		jmp	short loc_174B_102E
; ---------------------------------------------------------------------------

loc_174B_FE2:				; CODE XREF: TakesTrackNames+594j
		dec	[bp+var_716]

loc_174B_FE6:				; CODE XREF: TakesTrackNames+5A9j
					; TakesTrackNames+5F1j	...
		mov	al, [bp+var_69A]
		cmp	[bp+var_716], al
		jge	short loc_174B_FF8
		mov	al, [bp+var_716]
		mov	[bp+var_69A], al

loc_174B_FF8:				; CODE XREF: TakesTrackNames+5CAj
		cmp	[bp+var_69A], 0
		jl	short loc_174B_1002
		jmp	loc_174B_10B4
; ---------------------------------------------------------------------------

loc_174B_1002:				; CODE XREF: TakesTrackNames+5D9j
		jmp	loc_174B_BAE
; ---------------------------------------------------------------------------
		align 2

loc_174B_1006:				; CODE XREF: TakesTrackNames+599j
		mov	al, [bp+var_714]
		cbw
		dec	ax
		mov	cx, ax
		mov	al, [bp+var_716]
		cbw
		cmp	cx, ax
		jz	short loc_174B_FE6
		inc	[bp+var_716]
		jmp	short loc_174B_FE6
; ---------------------------------------------------------------------------
		align 2

loc_174B_101E:				; CODE XREF: TakesTrackNames+585j
					; TakesTrackNames+58Fj
		mov	[bp+var_2], 1
		jmp	short loc_174B_FE6
; ---------------------------------------------------------------------------

loc_174B_1024:				; CODE XREF: TakesTrackNames+58Aj
		mov	[bp+var_2], 0FFh
		jmp	short loc_174B_FE6
; ---------------------------------------------------------------------------

loc_174B_102A:
		mov	al, byte ptr [bp+var_6CC]

loc_174B_102E:				; CODE XREF: TakesTrackNames+5BCj
		mov	[bp+var_69C], al
		mov	[bp+var_6EA], 0
		jmp	short loc_174B_1066
; ---------------------------------------------------------------------------
		align 2

loc_174B_103A:				; CODE XREF: TakesTrackNames+66Ej
		mov	al, [bp+var_6EA]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		shl	bx, 1
		add	bx, ax
		add	bx, bp
		mov	al, [bx-698h]

loc_174B_1051:				; CODE XREF: TakesTrackNames+689j
		cmp	al, [bp+var_69C]
		jnz	short loc_174B_1062
		mov	al, [bp+var_6EA]
		mov	[bp+var_716], al
		jmp	short loc_174B_FE6
; ---------------------------------------------------------------------------
		align 2

loc_174B_1062:				; CODE XREF: TakesTrackNames+631j
		inc	[bp+var_6EA]

loc_174B_1066:				; CODE XREF: TakesTrackNames+613j
		mov	al, [bp+var_714]
		cmp	[bp+var_6EA], al
		jl	short loc_174B_1073
		jmp	loc_174B_FE6
; ---------------------------------------------------------------------------

loc_174B_1073:				; CODE XREF: TakesTrackNames+64Aj
		mov	al, [bp+var_6EA]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		shl	bx, 1
		add	bx, ax
		add	bx, bp
		mov	al, [bx-698h]
		cbw
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_174B_103A
		mov	al, [bp+var_6EA]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		shl	bx, 1
		add	bx, ax
		add	bx, bp
		mov	al, [bx-698h]
		add	al, 20h	; ' '
		jmp	short loc_174B_1051
; ---------------------------------------------------------------------------
		align 2

loc_174B_10B0:				; CODE XREF: TakesTrackNames+6A1j
		inc	[bp+var_69A]

loc_174B_10B4:				; CODE XREF: TakesTrackNames+5DBj
		mov	al, [bp+var_69A]
		cbw
		add	ax, 6
		mov	cx, ax
		mov	al, [bp+var_716]
		cbw
		cmp	cx, ax
		jl	short loc_174B_10B0
		cmp	[bp+var_2], 0
		jnz	short loc_174B_10D0
		jmp	loc_174B_DB9
; ---------------------------------------------------------------------------

loc_174B_10D0:				; CODE XREF: TakesTrackNames+6A7j
		cmp	[bp+var_2], 0FFh
		jnz	short loc_174B_10D9
		jmp	loc_174B_BDC
; ---------------------------------------------------------------------------

loc_174B_10D9:				; CODE XREF: TakesTrackNames+6B0j
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, bp
		sub	ax, 698h
		push	ax
		push	[bp+arg_2]
		call	_strcpy
		add	sp, 4
		mov	[bp+var_6A0], 1

loc_174B_10FC:				; CODE XREF: TakesTrackNames+1BDj
		push	cs
		call	near ptr DoTrakdata12
		mov	al, [bp+var_18]
		mov	g_bSaveDelFlag,	al
		mov	al, [bp+var_6A0]
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TakesTrackNames	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CombineFilePath	proc far		; CODE XREF: _main+411P
					; RunTracksMenu+44FP ...

var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		cmp	[bp+arg_0], 0
		jz	short loc_174B_113C
		push	[bp+arg_0]
		push	[bp+arg_6]
		call	_strcpy
		add	sp, 4
		push	[bp+arg_0]
		call	_strlen
		add	sp, 2
		mov	si, ax
		jmp	short loc_174B_1144
; ---------------------------------------------------------------------------

loc_174B_113C:				; CODE XREF: CombineFilePath+Bj
		mov	bx, [bp+arg_6]
		mov	byte ptr [bx], 0
		sub	si, si

loc_174B_1144:				; CODE XREF: CombineFilePath+28j
		or	si, si
		jz	short loc_174B_1168
		mov	bx, [bp+arg_0]
		mov	al, [bx+si-1]
		mov	[bp+var_2], al
		cmp	al, ':'
		jz	short loc_174B_1168
		cmp	al, '\'
		jz	short loc_174B_1168
		mov	ax, offset asc_2B77_3439 ; "\\"
		push	ax
		push	[bp+arg_6]
		call	_strcat
		add	sp, 4

loc_174B_1168:				; CODE XREF: CombineFilePath+34j
					; CombineFilePath+41j ...
		push	[bp+arg_2]
		push	[bp+arg_6]
		call	_strcat
		add	sp, 4
		push	[bp+arg_4]
		push	[bp+arg_6]
		call	_strcat
		add	sp, 4
		pop	si
		mov	sp, bp
		pop	bp
		retf
CombineFilePath	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SavResRender	proc far		; CODE XREF: RplyMouseSpriteStuff+B14P
					; TrackEditRelate+14DEP

var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_4		= byte ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 12h
		push	di
		push	si
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_12]
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aSav	; "sav"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		or	ax, ax
		jge	short loc_174B_11D2
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_11D2:				; CODE XREF: SavResRender+3Ej
		mov	[bp+var_4], 0
		push	word_2B77_3420
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+arg_6]
		push	[bp+arg_4]
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr CopyString
		add	sp, 6
		push	[bp+var_10]
		push	[bp+var_12]
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		push	word_2B77_3420
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+var_C]
		push	[bp+var_E]
		push	[bp+arg_0]
		call	FontSpriteOp
		add	sp, 6
		push	[bp+var_8]
		push	[bp+var_A]
		push	[bp+arg_2]
		call	FontSpriteOp
		add	sp, 6
		push	cs
		call	near ptr DoUseMousePos
		jmp	short loc_174B_127F
; ---------------------------------------------------------------------------
		align 2

loc_174B_1242:				; CODE XREF: SavResRender+CAj
		mov	bx, [bp+arg_2]
		cmp	byte ptr [bx+di], 20h ;	' '
		jnz	short loc_174B_124D
		mov	byte ptr [bx+di], 5Fh ;	'_'

loc_174B_124D:				; CODE XREF: SavResRender+BEj
		inc	di

loc_174B_124E:				; CODE XREF: SavResRender+113j
		mov	bx, [bp+arg_2]
		cmp	byte ptr [bx+di], 0
		jnz	short loc_174B_1242
		cmp	si, 1Bh
		jz	short loc_174B_12A4
		cmp	si, 0Dh
		jz	short loc_174B_12A0
		mov	ax, 7530h
		cwd
		push	dx
		push	ax
		push	[bp+var_C]
		push	[bp+var_E]
		mov	ax, 12h
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr DoReadline
		add	sp, 0Ch
		cmp	ax, 1Bh
		jz	short loc_174B_12A4

loc_174B_127F:				; CODE XREF: SavResRender+B5j
		mov	ax, 7530h
		cwd
		push	dx
		push	ax
		push	[bp+var_8]
		push	[bp+var_A]
		mov	ax, 8
		push	ax
		push	[bp+arg_2]
		push	cs
		call	near ptr DoReadline
		add	sp, 0Ch
		mov	si, ax
		sub	di, di
		jmp	short loc_174B_124E
; ---------------------------------------------------------------------------
		align 2

loc_174B_12A0:				; CODE XREF: SavResRender+D4j
		mov	[bp+var_4], 1

loc_174B_12A4:				; CODE XREF: SavResRender+CFj
					; SavResRender+F3j
		push	cs
		call	near ptr DoTrakdata12
		mov	al, [bp+var_4]
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SavResRender	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SubWithPathTest	proc far		; CODE XREF: TakesTrackNames+1CAp
					; TakesTrackNames+1FAp

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		push	[bp+arg_2]
		call	_strlen
		add	sp, 2
		mov	[bp+var_4], ax

loc_174B_12C7:				; CODE XREF: SubWithPathTest+2Cj
		mov	si, [bp+var_4]
		mov	bx, [bp+arg_2]
		mov	al, [bx+si-1]
		mov	[bp+var_2], al
		cmp	al, '\'
		jz	short loc_174B_12E0
		cmp	al, ':'
		jz	short loc_174B_12E0
		dec	[bp+var_4]
		jnz	short loc_174B_12C7

loc_174B_12E0:				; CODE XREF: SubWithPathTest+23j
					; SubWithPathTest+27j
		mov	[bp+var_6], 0

loc_174B_12E5:				; CODE XREF: SubWithPathTest+52j
		mov	bx, [bp+var_4]
		inc	[bp+var_4]
		mov	si, [bp+arg_2]
		mov	al, [bx+si]
		mov	bx, [bp+var_6]
		mov	si, [bp+arg_0]
		mov	[bx+si], al
		mov	bx, [bp+var_6]
		inc	[bp+var_6]
		mov	si, [bp+arg_0]
		cmp	byte ptr [bx+si], '.'
		jnz	short loc_174B_12E5
		dec	[bp+var_6]
		mov	bx, [bp+var_6]
		mov	byte ptr [bx+si], 0
		pop	si
		mov	sp, bp
		pop	bp
		retf
SubWithPathTest	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InputsChecking	proc far		; CODE XREF: RunMenu+DCP
					; RunTracksMenu+356P ...

p_dwTimeDelta	= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	ax, [bp+p_dwTimeDelta] ; arg0 is e.g 1
		add	g_wInputTime, ax
		cmp	g_wInputTime, 4E20h ; 4e20 = 20000
		jle	short loc_174B_133D
		sub	g_wInputTime, 2710h ; 2710 = 10000
		sub	g_wInputTime2, 2710h
		sub	g_wOldInpTime, 2710h

loc_174B_133D:				; CODE XREF: InputsChecking+15j
		call	GetKbChar
		mov	si, ax
		or	si, si
		jz	short loc_174B_134D
		mov	g_cKbOrMouse, 0

loc_174B_134D:				; CODE XREF: InputsChecking+32j
		call	GetJoystickFlag
		mov	di, ax
		call	GetKbOrJoyFlags
		mov	g_wKbOrJoyFlag,	ax
		cmp	g_wJoyFlags, di
		jnz	short loc_174B_1365
		jmp	loc_174B_13E6
; ---------------------------------------------------------------------------

loc_174B_1365:				; CODE XREF: InputsChecking+4Cj
		mov	ax, g_wJoyFlags
		xor	ax, di
		and	ax, di
		mov	g_wInFlagDiff, ax ; Is this a flag-diff	??
		mov	g_wJoyFlags, di

loc_174B_1373:				; CODE XREF: InputsChecking+E2j
		test	byte ptr g_wInFlagDiff,	20h
		jz	short loc_174B_1384
		mov	g_wInResultFlag, 0Dh
		jmp	short loc_174B_13D1
; ---------------------------------------------------------------------------
		align 4

loc_174B_1384:				; CODE XREF: InputsChecking+64j
		test	byte ptr g_wInFlagDiff,	10h
		jz	short loc_174B_1394
		mov	g_wInResultFlag, 20h
		jmp	short loc_174B_13D1
; ---------------------------------------------------------------------------
		align 2

loc_174B_1394:				; CODE XREF: InputsChecking+75j
		test	byte ptr g_wInFlagDiff,	1
		jz	short loc_174B_13A4
		mov	g_wInResultFlag, 4800h
		jmp	short loc_174B_13D1
; ---------------------------------------------------------------------------
		align 2

loc_174B_13A4:				; CODE XREF: InputsChecking+85j
		test	byte ptr g_wInFlagDiff,	2
		jz	short loc_174B_13B4
		mov	g_wInResultFlag, 5000h
		jmp	short loc_174B_13D1
; ---------------------------------------------------------------------------
		align 2

loc_174B_13B4:				; CODE XREF: InputsChecking+95j
		test	byte ptr g_wInFlagDiff,	8
		jz	short loc_174B_13C4
		mov	g_wInResultFlag, 4B00h
		jmp	short loc_174B_13D1
; ---------------------------------------------------------------------------
		align 2

loc_174B_13C4:				; CODE XREF: InputsChecking+A5j
		test	byte ptr g_wInFlagDiff,	4
		jz	short loc_174B_13D1
		mov	g_wInResultFlag, 4D00h

loc_174B_13D1:				; CODE XREF: InputsChecking+6Cj
					; InputsChecking+7Dj ...
		cmp	g_wInResultFlag, 0
		jz	short loc_174B_13F9
		mov	ax, g_wInputTime
		mov	g_wOldInpTime, ax
		mov	g_cKbOrMouse, 0
		jmp	short loc_174B_13F9
; ---------------------------------------------------------------------------
		align 2

loc_174B_13E6:				; CODE XREF: InputsChecking+4Ej
		or	di, di
		jz	short loc_174B_13F9
		mov	ax, g_wOldInpTime
		add	ax, 14h
		cmp	ax, g_wInputTime
		jge	short loc_174B_13F9
		jmp	loc_174B_1373
; ---------------------------------------------------------------------------

loc_174B_13F9:				; CODE XREF: InputsChecking+C2j
					; InputsChecking+CFj ...
		mov	ax, offset g_wMouYPos
		push	ax
		mov	ax, offset g_wMouXPos
		push	ax
		mov	ax, offset g_wMouButStatus
		push	ax
		call	GetMouseState
		add	sp, 6
		mov	ax, g_wMouXPos
		cmp	g_dwOldMouX, ax
		jnz	short loc_174B_1428
		mov	ax, g_wMouYPos
		cmp	g_dwOldMouY, ax
		jnz	short loc_174B_1428
		mov	ax, g_wMouButStatus
		cmp	g_dwOldMouStatu, ax
		jz	short loc_174B_1458

loc_174B_1428:				; CODE XREF: InputsChecking+100j
					; InputsChecking+109j
		mov	ax, g_wMouXPos
		mov	g_dwOldMouX, ax
		mov	ax, g_wMouYPos
		mov	g_dwOldMouY, ax
		mov	g_cKbOrMouse, 1
		mov	g_wInTimer2, 0
		cmp	g_cKbMouUnk, 0
		jz	short loc_174B_1484
		cmp	m_cDirtyMouse, 0
		jz	short loc_174B_1451
		push	cs
		call	near ptr RenderMouSpr3

loc_174B_1451:				; CODE XREF: InputsChecking+137j
		push	cs
		call	near ptr UsesMousePos
		jmp	short loc_174B_1484
; ---------------------------------------------------------------------------
		align 2

loc_174B_1458:				; CODE XREF: InputsChecking+112j
		cmp	g_cKbOrMouse, 0
		jz	short loc_174B_1484
		mov	ax, [bp+p_dwTimeDelta]
		add	g_wInTimer2, ax
		cmp	g_wInTimer2, 1F4h
		jle	short loc_174B_1484
		mov	g_wInTimer2, 0
		mov	g_cKbOrMouse, 0
		cmp	m_cDirtyMouse, 0
		jz	short loc_174B_1484
		push	cs
		call	near ptr RenderMouSpr3

loc_174B_1484:				; CODE XREF: InputsChecking+130j
					; InputsChecking+141j ...
		cmp	g_cKbOrMouse, 0
		jz	short loc_174B_1500
		mov	ax, g_dwOldMouStatu
		cmp	g_wMouButStatus, ax
		jz	short loc_174B_14CC
		mov	ax, g_wMouButStatus
		mov	g_dwOldMouStatu, ax

loc_174B_149A:				; CODE XREF: InputsChecking+1C9j
		test	byte ptr g_wMouButStatus, 1
		jz	short loc_174B_14AA
		mov	g_wButFlags, 20h
		jmp	short loc_174B_14B7
; ---------------------------------------------------------------------------
		align 2

loc_174B_14AA:				; CODE XREF: InputsChecking+18Bj
		test	byte ptr g_wMouButStatus, 2
		jz	short loc_174B_14B7
		mov	g_wButFlags, 0Dh

loc_174B_14B7:				; CODE XREF: InputsChecking+193j
					; InputsChecking+19Bj
		cmp	g_wButFlags, 0
		jz	short loc_174B_14C4
		mov	ax, g_wInputTime
		mov	g_wInputTime2, ax

loc_174B_14C4:				; CODE XREF: InputsChecking+1A8j
		mov	g_wInTimer2, 0
		jmp	short loc_174B_14DF
; ---------------------------------------------------------------------------

loc_174B_14CC:				; CODE XREF: InputsChecking+17Ej
		cmp	g_wMouButStatus, 0
		jz	short loc_174B_14DF
		mov	ax, g_wInputTime2
		add	ax, 14h
		cmp	ax, g_wInputTime
		jl	short loc_174B_149A

loc_174B_14DF:				; CODE XREF: InputsChecking+1B6j
					; InputsChecking+1BDj
		cmp	g_wMouButStatus, 0
		jz	short loc_174B_1500
		test	byte ptr g_wMouButStatus, 1
		jz	short loc_174B_14F4
		or	byte ptr g_wKbOrJoyFlag, 20h
		jmp	short loc_174B_1500
; ---------------------------------------------------------------------------

loc_174B_14F4:				; CODE XREF: InputsChecking+1D7j
		test	byte ptr g_wMouButStatus, 2
		jz	short loc_174B_1500
		or	byte ptr g_wKbOrJoyFlag, 10h

loc_174B_1500:				; CODE XREF: InputsChecking+175j
					; InputsChecking+1D0j ...
		or	si, si
		jnz	short _lblEndInputsCheckin
		cmp	g_wInResultFlag, 0
		jz	short loc_174B_1518
		mov	si, g_wInResultFlag
		mov	g_wInResultFlag, 0
		jmp	short _lblEndInputsCheckin
; ---------------------------------------------------------------------------
		align 2

loc_174B_1518:				; CODE XREF: InputsChecking+1F5j
		cmp	g_wButFlags, 0
		jz	short _lblEndInputsCheckin
		mov	si, g_wButFlags
		mov	g_wButFlags, 0

_lblEndInputsCheckin:			; CODE XREF: InputsChecking+1EEj
					; InputsChecking+201j ...
		mov	ax, si		; returns butflags.. or	0 on nothing/error
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
InputsChecking	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoInputsCheckin	proc far		; CODE XREF: _main+28AP _main+296P ...

dwTimeDelta	= word ptr  6

		push	bp
		mov	bp, sp
		push	[bp+dwTimeDelta]
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		pop	bp
		retf
DoInputsCheckin	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadResFile	proc far		; CODE XREF: _main+B1P	LoadIntroRes+CP ...

var_54		= byte ptr -54h
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 54h

loc_174B_1548:				; CODE XREF: LoadResFile+7Aj
		push	[bp+arg_0]
		lea	ax, [bp+var_54]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset a_res ; ".res"
		push	ax
		lea	ax, [bp+var_54]
		push	ax
		call	_strcat
		add	sp, 4
		lea	ax, [bp+var_54]
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr LoadResource
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_174B_15BE
		push	[bp+arg_0]
		lea	ax, [bp+var_54]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset a_pre ; ".pre"
		push	ax
		lea	ax, [bp+var_54]
		push	ax
		call	_strcat
		add	sp, 4
		lea	ax, [bp+var_54]
		push	ax
		mov	ax, 7
		push	ax
		push	cs
		call	near ptr LoadResource ;	type 7 = compressed
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_174B_15BE
		push	cs
		call	near ptr DoDeaTextRes
		jmp	short loc_174B_1548
; ---------------------------------------------------------------------------

loc_174B_15BE:				; CODE XREF: LoadResFile+3Cj
					; LoadResFile+74j
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
LoadResFile	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoUnloadResourc	proc far		; CODE XREF: LoadIntroRes+5C8P
					; RunTracksMenu+2DCP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	UnloadResource
		add	sp, 4
		pop	bp
		retf
DoUnloadResourc	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AltLocateShape	proc far		; CODE XREF: LoadIntroRes+A4P
					; LoadIntroRes+E0P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	LocateShape
		add	sp, 6
		pop	bp
		retf
AltLocateShape	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LocateTextRes	proc far		; CODE XREF: _main+553P
					; LoadIntroRes+69P ...

var_4		= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
var_1		= byte ptr -1
p_pTextRes1	= word ptr  6
p_pTextRes2	= word ptr  8
p_pID		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		mov	al, g_wVideoFlag6
		mov	[bp+var_4], al
		mov	bx, [bp+p_pID]
		mov	al, [bx]
		mov	[bp+var_3], al
		mov	al, [bx+1]
		mov	[bp+var_2], al
		mov	al, [bx+2]
		mov	[bp+var_1], al
		lea	ax, [bp+var_4]
		push	ax
		push	[bp+p_pTextRes2]
		push	[bp+p_pTextRes1]
		call	LocateShape
		mov	sp, bp
		pop	bp
		retf
LocateTextRes	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CopyString	proc far		; CODE XREF: LoadIntroRes+77P
					; LoadIntroRes+B2P ...

var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		mov	ax, [bp+arg_2]
		mov	dx, [bp+arg_4]
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx

loc_174B_1639:				; CODE XREF: CopyString+2Bj
		mov	bx, [bp+arg_0]
		les	si, [bp+var_4]
		mov	al, es:[si]
		mov	[bx], al
		inc	[bp+arg_0]
		inc	word ptr [bp+var_4]
		les	bx, [bp+var_4]
		cmp	byte ptr es:[bx], 0
		jnz	short loc_174B_1639
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx], 0
		pop	si
		mov	sp, bp
		pop	bp
		retf
CopyString	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MouseSpriteOp	proc far		; CODE XREF: TrackEditRelate+630P
					; TrackEditRelate+696P	...

var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h
arg_E		= word ptr  14h

		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	di
		push	si
		mov	ax, [bp+arg_8]
		cmp	[bp+arg_4], ax
		jle	short loc_174B_1678
		mov	[bp+var_A], 0
		mov	ax, [bp+arg_4]
		jmp	short loc_174B_1680
; ---------------------------------------------------------------------------

loc_174B_1678:				; CODE XREF: MouseSpriteOp+Ej
		mov	[bp+var_A], 1
		mov	ax, [bp+arg_8]

loc_174B_1680:				; CODE XREF: MouseSpriteOp+18j
		mov	[bp+var_6], ax
		mov	ax, [bp+arg_E]
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_14], ax
		mov	ax, [bp+var_6]
		dec	ax
		mov	[bp+var_16], ax
		imul	[bp+arg_A]
		shl	ax, 1
		shl	ax, 1
		cwd
		mov	cx, [bp+var_14]
		idiv	cx
		mov	si, ax
		mov	ax, [bp+arg_A]
		add	ax, [bp+arg_C]
		imul	[bp+var_16]
		shl	ax, 1
		shl	ax, 1
		cwd
		idiv	cx
		mov	di, ax
		sub	ax, si
		mov	[bp+var_12], ax
		mov	ax, [bp+arg_0]
		or	ax, ax
		jz	short loc_174B_16C8
		cmp	ax, 1
		jz	short loc_174B_171E
		jmp	short loc_174B_1715
; ---------------------------------------------------------------------------

loc_174B_16C8:				; CODE XREF: MouseSpriteOp+61j
		sub	ax, ax
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_4]
		push	[bp+arg_6]
		push	[bp+arg_2]
		call	SpriteOp
		add	sp, 0Ah
		cmp	[bp+var_A], 0
		jnz	short loc_174B_16FA
		push	g_wFontFlag
		push	[bp+arg_8]
		push	[bp+var_12]

loc_174B_16EF:
		push	[bp+arg_6]
		mov	ax, [bp+arg_2]
		add	ax, si
		push	ax
		jmp	short loc_174B_170D
; ---------------------------------------------------------------------------

loc_174B_16FA:				; CODE XREF: MouseSpriteOp+85j
		push	g_wFontFlag
		push	[bp+var_12]
		push	[bp+arg_4]
		mov	ax, [bp+arg_6]
		add	ax, si
		push	ax
		push	[bp+arg_2]

loc_174B_170D:				; CODE XREF: MouseSpriteOp+9Aj
		call	SpriteOp
		add	sp, 0Ah

loc_174B_1715:				; CODE XREF: MouseSpriteOp+68j
					; MouseSpriteOp+28Dj
		mov	ax, [bp+arg_A]
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_171E:				; CODE XREF: MouseSpriteOp+66j
		cmp	[bp+var_A], 0
		jnz	short loc_174B_172C
		mov	ax, g_wMouXPos
		sub	ax, [bp+arg_2]
		jmp	short loc_174B_1732
; ---------------------------------------------------------------------------

loc_174B_172C:				; CODE XREF: MouseSpriteOp+C4j
		mov	ax, g_wMouYPos
		sub	ax, [bp+arg_6]

loc_174B_1732:				; CODE XREF: MouseSpriteOp+CCj
		mov	[bp+var_4], ax
		cmp	ax, si
		jl	short loc_174B_173D
		cmp	ax, di
		jle	short loc_174B_1776

loc_174B_173D:				; CODE XREF: MouseSpriteOp+D9j
					; MouseSpriteOp+F0j
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		test	byte ptr g_wMouButStatus, 3
		jnz	short loc_174B_173D
		cmp	[bp+var_4], si
		jge	short loc_174B_1764
		cmp	[bp+arg_A], 0
		jnz	short loc_174B_175E
		jmp	loc_174B_183C
; ---------------------------------------------------------------------------

loc_174B_175E:				; CODE XREF: MouseSpriteOp+FBj
		dec	[bp+arg_A]
		jmp	loc_174B_183C
; ---------------------------------------------------------------------------

loc_174B_1764:				; CODE XREF: MouseSpriteOp+F5j
		mov	ax, [bp+arg_E]
		dec	ax
		cmp	ax, [bp+arg_A]
		jg	short loc_174B_1770
		jmp	loc_174B_183C
; ---------------------------------------------------------------------------

loc_174B_1770:				; CODE XREF: MouseSpriteOp+10Dj
		inc	[bp+arg_A]
		jmp	loc_174B_183C
; ---------------------------------------------------------------------------

loc_174B_1776:				; CODE XREF: MouseSpriteOp+DDj
		mov	[bp+arg_A], 0FFFFh
		mov	[bp+var_C], si

loc_174B_177E:				; CODE XREF: MouseSpriteOp+1DBj
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		cmp	[bp+var_A], 0
		jnz	short loc_174B_1798
		mov	ax, g_wMouXPos
		sub	ax, [bp+arg_2]
		jmp	short loc_174B_179E
; ---------------------------------------------------------------------------

loc_174B_1798:				; CODE XREF: MouseSpriteOp+130j
		mov	ax, g_wMouYPos
		sub	ax, [bp+arg_6]

loc_174B_179E:				; CODE XREF: MouseSpriteOp+138j
		mov	[bp+var_E], ax
		sub	ax, [bp+var_4]
		add	ax, si
		mov	[bp+var_2], ax
		or	ax, ax
		jge	short loc_174B_17B4
		mov	[bp+var_2], 0
		jmp	short loc_174B_17CC
; ---------------------------------------------------------------------------

loc_174B_17B4:				; CODE XREF: MouseSpriteOp+14Dj
		mov	ax, [bp+var_2]
		add	ax, [bp+var_12]
		mov	cx, [bp+var_6]
		dec	cx
		cmp	ax, cx
		jle	short loc_174B_17CC
		mov	ax, [bp+var_6]
		sub	ax, [bp+var_12]
		dec	ax
		mov	[bp+var_2], ax

loc_174B_17CC:				; CODE XREF: MouseSpriteOp+154j
					; MouseSpriteOp+162j
		mov	ax, [bp+var_C]
		cmp	[bp+var_2], ax
		jz	short loc_174B_1832
		mov	ax, [bp+var_2]
		mov	[bp+var_C], ax
		push	cs
		call	near ptr DoRenderMouSpr3
		sub	ax, ax
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_4]
		push	[bp+arg_6]
		push	[bp+arg_2]
		call	SpriteOp
		add	sp, 0Ah
		cmp	[bp+var_A], 0
		jnz	short loc_174B_1812
		push	g_wFontFlag
		push	[bp+arg_8]
		push	[bp+var_12]
		push	[bp+arg_6]
		mov	ax, [bp+arg_2]
		add	ax, [bp+var_2]
		push	ax
		jmp	short loc_174B_1826
; ---------------------------------------------------------------------------
		align 2

loc_174B_1812:				; CODE XREF: MouseSpriteOp+19Bj
		push	g_wFontFlag
		push	[bp+var_12]
		push	[bp+arg_4]
		mov	ax, [bp+arg_6]
		add	ax, [bp+var_2]
		push	ax
		push	[bp+arg_2]

loc_174B_1826:				; CODE XREF: MouseSpriteOp+1B1j
		call	SpriteOp
		add	sp, 0Ah
		push	cs
		call	near ptr DoUseMousePos

loc_174B_1832:				; CODE XREF: MouseSpriteOp+174j
		test	byte ptr g_wMouButStatus, 3
		jz	short loc_174B_183C
		jmp	loc_174B_177E
; ---------------------------------------------------------------------------

loc_174B_183C:				; CODE XREF: MouseSpriteOp+FDj
					; MouseSpriteOp+103j ...
		cmp	[bp+arg_A], 0FFFFh
		jnz	short loc_174B_185E
		mov	ax, [bp+var_6]
		cwd
		mov	cx, [bp+arg_E]
		idiv	cx
		cwd
		sub	ax, dx
		sar	ax, 1
		add	ax, [bp+var_2]
		imul	cx
		cwd
		mov	cx, [bp+var_6]
		idiv	cx
		mov	[bp+arg_A], ax

loc_174B_185E:				; CODE XREF: MouseSpriteOp+1E2j
		mov	ax, [bp+arg_E]
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_16], ax
		mov	ax, [bp+var_6]
		dec	ax
		mov	[bp+var_14], ax
		imul	[bp+arg_A]
		shl	ax, 1
		shl	ax, 1
		cwd
		mov	cx, [bp+var_16]
		idiv	cx
		mov	si, ax
		mov	ax, [bp+arg_A]
		add	ax, [bp+arg_C]
		imul	[bp+var_14]
		shl	ax, 1
		shl	ax, 1
		cwd
		idiv	cx
		mov	di, ax
		sub	ax, si
		mov	[bp+var_12], ax
		push	cs
		call	near ptr DoRenderMouSpr3
		sub	ax, ax
		push	ax
		push	[bp+arg_8]
		push	[bp+arg_4]
		push	[bp+arg_6]
		push	[bp+arg_2]
		call	SpriteOp
		add	sp, 0Ah
		cmp	[bp+var_A], 0
		jnz	short loc_174B_18CC
		push	g_wFontFlag
		push	[bp+arg_8]
		push	[bp+var_12]
		push	[bp+arg_6]
		mov	ax, [bp+arg_2]
		add	ax, si
		push	ax
		jmp	short loc_174B_18DF
; ---------------------------------------------------------------------------
		align 2

loc_174B_18CC:				; CODE XREF: MouseSpriteOp+256j
		push	g_wFontFlag
		push	[bp+var_12]
		push	[bp+arg_4]
		mov	ax, [bp+arg_6]
		add	ax, si
		push	ax
		push	[bp+arg_2]

loc_174B_18DF:				; CODE XREF: MouseSpriteOp+26Bj
		call	SpriteOp
		add	sp, 0Ah
		push	cs
		call	near ptr DoUseMousePos
		jmp	loc_174B_1715
MouseSpriteOp	endp


; =============== S U B	R O U T	I N E =======================================


DoUseMousePos	proc far		; CODE XREF: RunIntro+11P
					; LoadIntroRes+64CP ...
		mov	g_cKbMouUnk, 1
		cmp	g_cKbOrMouse, 0
		jz	short locret_174B_1905
		cmp	m_cDirtyMouse, 0
		jnz	short locret_174B_1905
		push	cs
		call	near ptr UsesMousePos

locret_174B_1905:			; CODE XREF: DoUseMousePos+Aj
					; DoUseMousePos+11j
		retf
DoUseMousePos	endp


; =============== S U B	R O U T	I N E =======================================


DoRenderMouSpr3	proc far		; CODE XREF: _main+29EP
					; _main:loc_0_575P ...
		mov	g_cKbMouUnk, 0
		cmp	m_cDirtyMouse, 0
		jz	short locret_174B_1916
		push	cs
		call	near ptr RenderMouSpr3

locret_174B_1916:			; CODE XREF: DoRenderMouSpr3+Aj
		retf
DoRenderMouSpr3	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RenderMouSpr3	proc far		; CODE XREF: InputsChecking+13Ap
					; InputsChecking+16Dp ...

sprites		= Sprite ptr -3Ch

		push	bp
		mov	bp, sp
		sub	sp, 3Ch
		lea	ax, [bp+sprites]
		push	ax
		call	GetSprite1And2
		add	sp, 2
		call	SetSprite2As1
		les	bx, g_dwMouSprite3
		push	word ptr es:[bx+(Sprite.pBitmap+2)] ; sprites point at bitmaps?
		push	word ptr es:[bx+Sprite.pBitmap]
		call	PutImageMaybe
		add	sp, 4
		lea	ax, [bp+sprites]
		push	ax
		call	CopyToSprite1_2
		mov	m_cDirtyMouse, 0
		mov	sp, bp
		pop	bp
		retf
RenderMouSpr3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UsesMousePos	proc far		; CODE XREF: InputsChecking+13Ep
					; DoUseMousePos+14p

pLocal30Words	= byte ptr -3Ch

		push	bp
		mov	bp, sp
		sub	sp, 3Eh
		push	si
		mov	si, g_wMouXPos
		mov	ax, si
		cwd
		mov	cx, g_wVideoFlag1
		idiv	cx
		sub	si, dx
		lea	ax, [bp+pLocal30Words]
		push	ax
		call	GetSprite1And2
		add	sp, 2
		call	SetSprite2As1
		push	g_wMouYPos
		push	si
		les	bx, g_dwMouSprite3
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	DoClearImageArea
		add	sp, 8
		push	g_wMouYPos
		push	g_wMouXPos
		les	bx, g_dwMouSprite2
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	MaybePutImageAnd
		add	sp, 8
		push	g_wMouYPos
		push	g_wMouXPos
		les	bx, g_dwMouSprite
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	MaybePutImageOr
		add	sp, 8
		lea	ax, [bp+pLocal30Words]
		push	ax
		call	CopyToSprite1_2
		add	sp, 2
		mov	m_cDirtyMouse, 1
		pop	si
		mov	sp, bp
		pop	bp
		retf
UsesMousePos	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CheckMousePos	proc far		; CODE XREF: RunMenu+FBP
					; RunTracksMenu+375P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		cmp	g_cKbOrMouse, 0
		jz	short loc_174B_1A2A
		sub	si, si
		jmp	short loc_174B_19F5
; ---------------------------------------------------------------------------
		align 2

loc_174B_19F4:				; CODE XREF: CheckMousePos+26j
					; CheckMousePos+2Dj ...
		inc	si

loc_174B_19F5:				; CODE XREF: CheckMousePos+11j
		cmp	[bp+arg_0], si
		jle	short loc_174B_1A2A
		mov	di, si
		shl	di, 1
		mov	bx, [bp+arg_2]
		mov	ax, g_wMouXPos
		cmp	[bx+di], ax
		jg	short loc_174B_19F4
		mov	bx, [bp+arg_4]
		cmp	[bx+di], ax
		jl	short loc_174B_19F4
		mov	bx, [bp+arg_6]
		mov	ax, g_wMouYPos
		cmp	[bx+di], ax
		jg	short loc_174B_19F4
		mov	bx, [bp+arg_8]
		cmp	[bx+di], ax
		jl	short loc_174B_19F4
		mov	ax, si
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_1A2A:				; CODE XREF: CheckMousePos+Dj
					; CheckMousePos+18j
		mov	ax, 0FFFFh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
CheckMousePos	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CheckForInput	proc far		; CODE XREF: _main:_lblDoOppMenuP
					; _main:_lblDoOptionsP	...

var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 2

loc_174B_1A3A:				; CODE XREF: CheckForInput+3Cj
		call	GetKbOrJoyFlags
		test	al, 30h
		jz	short loc_174B_1A4A

loc_174B_1A43:				; CODE XREF: CheckForInput+24j
					; CheckForInput+32j
		mov	[bp+var_2], 1
		jmp	short loc_174B_1A6C
; ---------------------------------------------------------------------------
		align 2

loc_174B_1A4A:				; CODE XREF: CheckForInput+Dj
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		or	ax, ax
		jnz	short loc_174B_1A43
		cmp	g_cKbOrMouse, 0
		jz	short loc_174B_1A68
		test	byte ptr g_wMouButStatus, 3
		jnz	short loc_174B_1A43

loc_174B_1A68:				; CODE XREF: CheckForInput+2Bj
		mov	[bp+var_2], 0

loc_174B_1A6C:				; CODE XREF: CheckForInput+13j
		cmp	[bp+var_2], 0
		jnz	short loc_174B_1A3A
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_1A76:				; CODE XREF: CheckForInput+50j
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr InputsChecking
		add	sp, 2
		or	ax, ax
		jz	short loc_174B_1A76
		push	cs
		call	near ptr CheckForInput
		retf
CheckForInput	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


SetSprite2As1_2	proc far		; CODE XREF: LoadIntroRes+5E4P
					; LoadIntroRes+6A2P ...
		mov	ax, offset g_pSprite2
		mov	dx, seg	seg012
		push	dx
		push	ax
		call	SetSprite1
		add	sp, 4
		retf
SetSprite2As1_2	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


SetSprite2Clear	proc far		; CODE XREF: RunIntro+CP
					; SetVideoMode+239P
		mov	ax, offset g_pSprite2
		mov	dx, seg	seg012
		push	dx
		push	ax
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		retf
SetSprite2Clear	endp


; =============== S U B	R O U T	I N E =======================================


SelectWndSprite	proc far		; CODE XREF: LoadIntroRes:loc_0_DECP
					; LoadIntroRes+739P ...
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	SetSprite1
		add	sp, 4
		retf
SelectWndSprite	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


SelClrWndSprite	proc far		; CODE XREF: RunIntroInLoop+B5P
					; RunIntro+16P	...
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		retf
SelClrWndSprite	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FontByteTextOp2	proc far		; CODE XREF: LoadIntroRes+92P
					; LoadIntroRes+CEP ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_4]
		mov	word_2B77_6ADC,	ax
		add	ax, g_wFontDef_0E
		inc	ax
		mov	word_2B77_6ADE,	ax
		mov	ax, [bp+arg_2]
		mov	word_2B77_6AD8,	ax
		push	[bp+arg_0]
		call	MaybeGetStrWidt
		add	sp, 2
		add	ax, [bp+arg_2]
		inc	ax
		mov	word_2B77_6ADA,	ax
		sub	ax, ax
		push	ax
		push	[bp+arg_8]
		call	SetTwoFontBytes
		add	sp, 4
		mov	ax, [bp+arg_4]
		inc	ax
		push	ax
		mov	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		sub	ax, ax
		push	ax
		push	[bp+arg_6]
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		mov	ax, offset word_2B77_6AD8
		pop	bp
		retf
FontByteTextOp2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FontByteTextOp	proc far		; CODE XREF: MainTextResFont+79P
					; MainTextResFont+B6P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_4]
		dec	ax
		mov	word_2B77_6AE4,	ax
		mov	ax, [bp+arg_4]
		add	ax, g_wFontDef_0E
		inc	ax
		mov	word_2B77_6AE6,	ax
		mov	ax, [bp+arg_2]
		dec	ax
		mov	word_2B77_6AE0,	ax
		push	[bp+arg_0]
		call	MaybeGetStrWidt
		add	sp, 2
		add	ax, [bp+arg_2]
		inc	ax
		mov	word_2B77_6AE2,	ax
		sub	ax, ax
		push	ax
		push	[bp+arg_8]
		call	SetTwoFontBytes
		add	sp, 4
		mov	ax, [bp+arg_4]
		inc	ax
		push	ax
		mov	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		mov	ax, [bp+arg_4]
		inc	ax
		push	ax
		mov	ax, [bp+arg_2]
		dec	ax
		push	ax
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		mov	ax, [bp+arg_4]
		dec	ax
		push	ax
		mov	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		mov	ax, [bp+arg_4]
		dec	ax
		push	ax
		mov	ax, [bp+arg_2]
		dec	ax
		push	ax
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		sub	ax, ax
		push	ax
		push	[bp+arg_6]
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	FontTextOp
		add	sp, 6
		mov	ax, offset word_2B77_6AE0
		pop	bp
		retf
FontByteTextOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoReadline	proc far		; CODE XREF: EnterHiscore+145P
					; SecurityCheck+189P ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		push	cs
		call	near ptr DoRenderMouSpr3
		push	[bp+arg_A]
		push	[bp+arg_8]
		mov	ax, offset locret_26AF_2 ; empty function
		mov	dx, seg	seg018
		push	dx
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		mov	ax, [bp+arg_2]
		mov	cx, ax
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		add	ax, cx
		add	ax, 9
		push	ax
		push	cx
		sub	ax, ax
		push	ax
		push	[bp+arg_0]
		mov	ax, 2
		push	ax
		call	ReadLine
		add	sp, 16h
		mov	[bp+var_4], ax
		push	cs
		call	near ptr DoUseMousePos
		push	[bp+arg_0]
		call	_strlen
		add	sp, 2
		mov	[bp+arg_2], ax
		dec	ax
		mov	[bp+var_2], ax
		jmp	short loc_174B_1C6D
; ---------------------------------------------------------------------------

loc_174B_1C6A:				; CODE XREF: DoReadline+6Aj
		dec	[bp+var_2]

loc_174B_1C6D:				; CODE XREF: DoReadline+5Cj
		mov	bx, [bp+var_2]
		mov	si, [bp+arg_0]
		cmp	byte ptr [bx+si], 20h ;	' '
		jz	short loc_174B_1C6A
		mov	si, bx
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx+si+1], 0
		mov	ax, [bp+var_4]
		pop	si
		mov	sp, bp
		pop	bp
		retf
DoReadline	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RepeatInputChec	proc far		; CODE XREF: RunIntro+84P RunIntro+D9P ...

var_4		= word ptr -4
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		sub	di, di
		push	cs
		call	near ptr DoGetTimerDelta
		jmp	short loc_174B_1CB1
; ---------------------------------------------------------------------------

loc_174B_1C9A:				; CODE XREF: RepeatInputChec+2Aj
		push	cs
		call	near ptr DoGetTimerDelta
		mov	[bp+var_4], ax
		add	di, ax
		push	ax
		push	cs
		call	near ptr DoInputsCheckin
		add	sp, 2
		mov	si, ax
		or	si, si
		jnz	short loc_174B_1CB8

loc_174B_1CB1:				; CODE XREF: RepeatInputChec+Ej
		cmp	[bp+arg_0], di
		jg	short loc_174B_1C9A
		sub	ax, ax

loc_174B_1CB8:				; CODE XREF: RepeatInputChec+25j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
RepeatInputChec	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoImgResetRende	proc far		; CODE XREF: EndOfGameScores+93EP
					; TrackEditRelate+311P	...

var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 14h
		push	di
		push	si
		mov	si, [bp+arg_0]
		add	si, [bp+arg_4]
		mov	di, [bp+arg_2]
		add	di, [bp+arg_6]
		push	[bp+arg_8]
		push	[bp+arg_2]
		push	si
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_2]
		inc	ax
		mov	[bp+var_6], ax
		push	[bp+arg_8]
		push	ax
		lea	ax, [si-1]
		push	ax
		push	[bp+var_6]
		mov	ax, [bp+arg_0]
		inc	ax
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_2]
		add	ax, 2
		mov	[bp+var_8], ax
		push	[bp+arg_A]
		push	ax
		lea	ax, [si-2]
		push	ax
		push	[bp+var_8]
		mov	ax, [bp+arg_0]
		add	ax, 2
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	[bp+arg_8]
		push	di
		push	[bp+arg_0]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_0]
		inc	ax
		mov	[bp+var_A], ax
		push	[bp+arg_8]
		lea	ax, [di-1]
		push	ax
		push	[bp+var_A]
		mov	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+var_A]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_0]
		add	ax, 2
		mov	[bp+var_C], ax
		push	[bp+arg_A]
		lea	ax, [di-2]
		push	ax
		push	[bp+var_C]
		mov	ax, [bp+arg_2]
		add	ax, 2
		push	ax
		push	[bp+var_C]
		call	ImageResetRende
		add	sp, 0Ah
		push	[bp+arg_C]
		push	di
		push	si
		push	di
		push	[bp+arg_0]
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [di-1]
		mov	[bp+var_E], ax
		push	[bp+arg_C]
		push	ax
		lea	ax, [si-1]
		push	ax
		push	[bp+var_E]
		mov	ax, [bp+arg_0]
		inc	ax
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [di-2]
		mov	[bp+var_10], ax
		push	[bp+arg_A]
		push	ax
		lea	ax, [si-2]
		push	ax
		push	[bp+var_10]
		mov	ax, [bp+arg_0]
		add	ax, 2
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	[bp+arg_C]
		push	di
		push	si
		push	[bp+arg_2]
		push	si
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [si-1]
		mov	[bp+var_12], ax
		push	[bp+arg_C]
		lea	ax, [di-1]
		push	ax
		push	[bp+var_12]
		mov	ax, [bp+arg_2]
		inc	ax
		push	ax
		push	[bp+var_12]
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [si-2]
		mov	[bp+var_14], ax
		push	[bp+arg_A]
		lea	ax, [di-2]
		push	ax
		push	[bp+var_14]
		mov	ax, [bp+arg_2]
		add	ax, 2
		push	ax
		push	[bp+var_14]
		call	ImageResetRende
		add	sp, 0Ah
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoImgResetRende	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ImgResetText	proc far		; CODE XREF: RunTracksMenu+258P
					; RunTracksMenu+293P ...

var_72		= word ptr -72h
var_70		= word ptr -70h
var_6E		= word ptr -6Eh
var_6C		= word ptr -6Ch
var_6A		= word ptr -6Ah
var_68		= word ptr -68h
var_66		= word ptr -66h
var_64		= word ptr -64h
var_62		= word ptr -62h
var_60		= word ptr -60h
var_5C		= word ptr -5Ch
var_5A		= byte ptr -5Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= byte ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h
arg_E		= word ptr  14h
arg_10		= word ptr  16h
arg_12		= word ptr  18h

		push	bp
		mov	bp, sp
		sub	sp, 72h
		push	di
		push	si
		mov	si, [bp+arg_4]
		add	si, [bp+arg_8]
		mov	di, [bp+arg_6]
		add	di, [bp+arg_A]
		push	[bp+arg_10]
		push	[bp+arg_A]
		push	[bp+arg_8]
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	SpriteOp
		add	sp, 0Ah
		push	[bp+arg_C]
		push	[bp+arg_6]
		push	si
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_6]
		inc	ax
		mov	[bp+var_64], ax
		push	[bp+arg_C]
		push	ax
		lea	ax, [si-1]
		push	ax
		push	[bp+var_64]
		mov	ax, [bp+arg_4]
		inc	ax
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_6]
		add	ax, 2
		mov	[bp+var_66], ax
		push	[bp+arg_C]
		push	ax
		lea	ax, [si-2]
		push	ax
		push	[bp+var_66]
		mov	ax, [bp+arg_4]
		add	ax, 2
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	[bp+arg_C]
		push	di
		push	[bp+arg_4]
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_4]
		inc	ax
		mov	[bp+var_68], ax
		push	[bp+arg_C]
		lea	ax, [di-1]
		push	ax
		push	[bp+var_68]
		mov	ax, [bp+arg_6]
		inc	ax
		push	ax
		push	[bp+var_68]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_4]
		add	ax, 2
		mov	[bp+var_6A], ax
		push	[bp+arg_C]
		lea	ax, [di-2]
		push	ax
		push	[bp+var_6A]
		mov	ax, [bp+arg_6]
		add	ax, 2
		push	ax
		push	[bp+var_6A]
		call	ImageResetRende
		add	sp, 0Ah
		push	[bp+arg_E]
		push	di
		push	si
		push	di
		push	[bp+arg_4]
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [di-1]
		mov	[bp+var_6C], ax
		push	[bp+arg_E]
		push	ax
		lea	ax, [si-1]
		push	ax
		push	[bp+var_6C]
		mov	ax, [bp+arg_4]
		inc	ax
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [di-2]
		mov	[bp+var_6E], ax
		push	[bp+arg_E]
		push	ax
		lea	ax, [si-2]
		push	ax
		push	[bp+var_6E]
		mov	ax, [bp+arg_4]
		add	ax, 2
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	[bp+arg_E]
		push	di
		push	si
		push	[bp+arg_6]
		push	si
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [si-1]
		mov	[bp+var_70], ax
		push	[bp+arg_E]
		lea	ax, [di-1]
		push	ax
		push	[bp+var_70]
		mov	ax, [bp+arg_6]
		inc	ax
		push	ax
		push	[bp+var_70]
		call	ImageResetRende
		add	sp, 0Ah
		lea	ax, [si-2]
		mov	[bp+var_72], ax
		push	[bp+arg_E]
		lea	ax, [di-2]
		push	ax
		push	[bp+var_72]
		mov	ax, [bp+arg_6]
		add	ax, 2
		push	ax
		push	[bp+var_72]
		call	ImageResetRende
		add	sp, 0Ah
		mov	ax, [bp+arg_0]
		or	ax, [bp+arg_2]
		jnz	short loc_174B_1FB6
		jmp	loc_174B_20A4
; ---------------------------------------------------------------------------

loc_174B_1FB6:				; CODE XREF: ImgResetText+185j
		sub	ax, ax
		push	ax
		push	[bp+arg_12]
		call	SetTwoFontBytes
		add	sp, 4
		push	[bp+arg_2]
		push	[bp+arg_0]
		mov	ax, offset g_pTempByte
		push	ax
		push	cs
		call	near ptr CopyString
		add	sp, 6
		mov	[bp+var_5C], 1
		mov	ax, offset g_pTempByte
		push	ax
		call	_strlen
		add	sp, 2
		mov	[bp+var_62], ax
		mov	[bp+var_8], 0
		jmp	short loc_174B_2000
; ---------------------------------------------------------------------------

loc_174B_1FF0:				; CODE XREF: ImgResetText+1DAj
		mov	bx, [bp+var_8]
		cmp	g_pTempByte[bx], 5Dh ; ']'
		jnz	short loc_174B_1FFD
		inc	[bp+var_5C]

loc_174B_1FFD:				; CODE XREF: ImgResetText+1CCj
		inc	[bp+var_8]

loc_174B_2000:				; CODE XREF: ImgResetText+1C2j
		mov	ax, [bp+var_62]
		cmp	[bp+var_8], ax
		jl	short loc_174B_1FF0
		mov	[bp+var_2], 0
		mov	[bp+var_6], 0
		mov	ax, [bp+arg_A]
		mov	dx, [bp+var_5C]
		mov	cl, 3
		shl	dx, cl
		sub	ax, dx
		cwd
		sub	ax, dx
		sar	ax, 1
		inc	ax
		mov	[bp+var_60], ax
		mov	[bp+var_8], 0
		jmp	short loc_174B_203F
; ---------------------------------------------------------------------------

loc_174B_202E:				; CODE XREF: ImgResetText+22Cj
		mov	bx, [bp+var_2]
		add	bx, bp
		mov	al, [bp+var_4]
		mov	[bx-5Ah], al
		inc	[bp+var_2]

loc_174B_203C:				; CODE XREF: ImgResetText+275j
		inc	[bp+var_8]

loc_174B_203F:				; CODE XREF: ImgResetText+200j
		mov	ax, [bp+var_62]
		inc	ax
		cmp	ax, [bp+var_8]
		jle	short loc_174B_20A4
		mov	bx, [bp+var_8]
		mov	al, g_pTempByte[bx]
		mov	[bp+var_4], al
		cmp	al, 5Dh	; ']'
		jz	short loc_174B_205A
		or	al, al
		jnz	short loc_174B_202E

loc_174B_205A:				; CODE XREF: ImgResetText+228j
		mov	bx, [bp+var_2]
		add	bx, bp
		mov	byte ptr [bx-5Ah], 0
		mov	ax, [bp+var_6]
		mov	cl, 3
		shl	ax, cl
		add	ax, [bp+arg_6]
		add	ax, [bp+var_60]
		push	ax
		lea	ax, [bp+var_5A]
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	cx, ax
		mov	ax, [bp+arg_8]
		sub	ax, cx
		cwd
		sub	ax, dx
		sar	ax, 1
		add	ax, [bp+arg_4]
		push	ax
		lea	ax, [bp+var_5A]
		push	ax
		call	FontTextOp
		add	sp, 6
		inc	[bp+var_6]
		mov	[bp+var_2], 0
		jmp	short loc_174B_203C
; ---------------------------------------------------------------------------
		align 2

loc_174B_20A4:				; CODE XREF: ImgResetText+187j
					; ImgResetText+21Aj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
ImgResetText	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Import3DShapeBinary proc far		; CODE XREF: SetupIntro+40P
					; SetupIntro+52P ...

dwSrcRes	= dword	ptr  6
dwTargetRes	= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		mov	bx, [bp+dwTargetRes]
		les	si, [bp+dwSrcRes]
		mov	al, es:[si+Shape3DHeader.cNumVerts]
		sub	ah, ah
		mov	[bx+Shape3D.wNumVerts],	ax ; write byte0 as a word to dest0
		mov	bx, [bp+dwTargetRes]
		les	si, [bp+dwSrcRes]
		mov	al, es:[si+Shape3DHeader.cNumPrimitives]
		mov	[bx+Shape3D.wNumPrimitives], ax	; write	byte1 as a word	to dest6
		mov	bx, [bp+dwTargetRes]
		les	si, [bp+dwSrcRes]
		mov	al, es:[si+Shape3DHeader.cNumPaints]
		mov	byte ptr [bx+Shape3D.wNumPaints], al ; write byte2 as a	word to	dest8
		mov	bx, [bp+dwTargetRes]
		mov	ax, word ptr [bp+dwSrcRes]
		mov	dx, word ptr [bp+dwSrcRes+2]
		add	ax, 4
		mov	word ptr [bx+Shape3D.pVertices], ax ; bx+2 points at vertices
		mov	word ptr [bx+(Shape3D.pVertices+2)], dx
		mov	bx, [bp+dwTargetRes]
		mov	si, bx
		mov	ax, [si+Shape3D.wNumVerts]
		mov	cx, ax		; cx, ax = dest0
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		add	ax, word ptr [bp+dwSrcRes]
		mov	dx, word ptr [bp+dwSrcRes+2]
		add	ax, 4
		mov	word ptr [bx+Shape3D.pdwCull1],	ax ; ax	= ((dest0 << 1)	+ dest0) << 1 +	src0 + 4
					; (ax=ax*7+4??)
		mov	word ptr [bx+(Shape3D.pdwCull1+2)], dx ; dx = src2
		mov	bx, [bp+dwTargetRes]
		mov	si, bx
		mov	ax, [si+Shape3D.wNumPrimitives]	; ax=dest6
		shl	ax, 1
		shl	ax, 1
		mov	cx, [si+Shape3D.wNumVerts]
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		shl	cx, 1
		add	ax, cx
		add	ax, word ptr [bp+dwSrcRes]
		mov	dx, word ptr [bp+dwSrcRes+2]
		add	ax, 4
		mov	word ptr [bx+Shape3D.pdwCull2],	ax
		mov	word ptr [bx+(Shape3D.pdwCull2+2)], dx
		mov	bx, [bp+dwTargetRes]
		mov	si, bx
		mov	ax, [si+Shape3D.wNumPrimitives]
		mov	cl, 3
		shl	ax, cl
		mov	cx, [si+Shape3D.wNumVerts]
		mov	dx, cx
		shl	cx, 1
		add	cx, dx
		shl	cx, 1
		add	ax, cx
		add	ax, word ptr [bp+dwSrcRes]
		mov	dx, word ptr [bp+dwSrcRes+2]
		add	ax, 4
		mov	word ptr [bx+Shape3D.pPrimitives], ax
		mov	word ptr [bx+(Shape3D.pPrimitives+2)], dx
		pop	si
		pop	bp
		retf
Import3DShapeBinary endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeRightAlign	proc far		; CODE XREF: RunTracksMenu+103P
					; RunTracksMenu+171P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	[bp+arg_0]
		call	MaybeGetStrWidt
		add	sp, 2
		sub	ax, 140h
		neg	ax
		cwd
		sub	ax, dx
		sar	ax, 1
		pop	bp
		retf
MaybeRightAlign	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MouseStuff	proc far		; CODE XREF: RunIntroInLoop+C5P
					; RunIntro+72P	...

p_pSprite	= dword	ptr  6
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		push	cs
		call	near ptr SetSprite2As1_2
		push	cs
		call	near ptr DoRenderMouSpr3
		cmp	[bp+arg_4], 0FFFEh
		jnz	short loc_174B_21A4
		les	bx, [bp+p_pSprite]
		push	word ptr es:[bx+(Sprite.pBitmap+2)]
		push	word ptr es:[bx+Sprite.pBitmap]
		call	PutImageMaybe
		add	sp, 4

loc_174B_2198:				; CODE XREF: MouseStuff+53j
		push	cs
		call	near ptr DoUseMousePos
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_21A4:				; CODE XREF: MouseStuff+14j
		mov	ax, [bp+arg_4]
		sub	si, si
		jmp	short loc_174B_21C0
; ---------------------------------------------------------------------------
		align 2

loc_174B_21AC:				; CODE XREF: MouseStuff+65j
		push	si
		les	bx, [bp+p_pSprite]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	BitmapOp
		add	sp, 6
		inc	si

loc_174B_21C0:				; CODE XREF: MouseStuff+39j
		cmp	si, 4
		jge	short loc_174B_2198
		push	cs
		call	near ptr DoGetTimerDelta
		push	ax
		push	cs
		call	near ptr DoInputsCheckin
		add	sp, 2
		mov	di, ax
		or	di, di
		jz	short loc_174B_21AC
		push	cs
		call	near ptr SetSprite2As1_2
		les	bx, [bp+p_pSprite]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		push	cs
		call	near ptr DoUseMousePos
		mov	ax, di
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
MouseStuff	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


ShowWaiting	proc far		; CODE XREF: _main+2CBP _main+2DDP ...
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		push	g_wWaitFlag
		mov	ax, 0FFFFh
		push	ax
		mov	ax, offset aWai	; "wai"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		push	cs
		call	near ptr DoRenderMouSpr3
		retf
ShowWaiting	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoNumberString	proc far		; CODE XREF: EndOfGameScores+400P
					; EndOfGameScores+4A8P	...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	ax, 0Ah		; 10 base
		push	ax
		push	[bp+arg_0]	; output str
		push	[bp+arg_2]	; number to itoa
		call	far ptr	_itoa
		add	sp, 6
		cmp	[bp+arg_6], 0
		jz	short loc_174B_229D
		sub	si, si
		jmp	short loc_174B_2255
; ---------------------------------------------------------------------------

loc_174B_2254:				; CODE XREF: DoNumberString+2Bj
		inc	si

loc_174B_2255:				; CODE XREF: DoNumberString+22j
		mov	bx, [bp+arg_0]
		cmp	byte ptr [bx+si], 0
		jnz	short loc_174B_2254
		jmp	short loc_174B_2298
; ---------------------------------------------------------------------------
		align 2

loc_174B_2260:				; CODE XREF: DoNumberString+6Bj
		cmp	[bp+arg_6], si
		jge	short loc_174B_227A
		sub	di, di
		jmp	short loc_174B_2273
; ---------------------------------------------------------------------------
		align 2

loc_174B_226A:				; CODE XREF: DoNumberString+45j
		mov	bx, [bp+arg_0]
		mov	al, [bx+di+1]
		mov	[bx+di], al
		inc	di

loc_174B_2273:				; CODE XREF: DoNumberString+37j
		cmp	di, si
		jl	short loc_174B_226A
		dec	si
		jmp	short loc_174B_2298
; ---------------------------------------------------------------------------

loc_174B_227A:				; CODE XREF: DoNumberString+33j
		cmp	[bp+arg_6], si
		jle	short loc_174B_2298
		mov	di, si
		jmp	short loc_174B_228D
; ---------------------------------------------------------------------------
		align 2

loc_174B_2284:				; CODE XREF: DoNumberString+5Fj
		mov	bx, [bp+arg_0]
		mov	al, [bx+di]
		mov	[bx+di+1], al
		dec	di

loc_174B_228D:				; CODE XREF: DoNumberString+51j
		or	di, di
		jge	short loc_174B_2284
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx], 20h ; ' '
		inc	si

loc_174B_2298:				; CODE XREF: DoNumberString+2Dj
					; DoNumberString+48j ...
		cmp	[bp+arg_6], si
		jnz	short loc_174B_2260

loc_174B_229D:				; CODE XREF: DoNumberString+1Ej
		cmp	[bp+arg_4], 0
		jz	short loc_174B_22BB
		sub	si, si
		jmp	short loc_174B_22B3
; ---------------------------------------------------------------------------
		align 2

loc_174B_22A8:				; CODE XREF: DoNumberString+89j
		mov	bx, [bp+arg_0]
		mov	ax, si
		inc	si
		add	bx, ax
		mov	byte ptr [bx], 30h ; '0'

loc_174B_22B3:				; CODE XREF: DoNumberString+75j
		mov	bx, [bp+arg_0]
		cmp	byte ptr [bx+si], 20h ;	' '
		jz	short loc_174B_22A8

loc_174B_22BB:				; CODE XREF: DoNumberString+71j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoNumberString	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


ResetGameTime	proc far		; CODE XREF: RunMenu+AEP
					; RunTracksMenu+310P ...
		mov	g_wGameTime, 0
		mov	g_wSomeTime, 0
		mov	g_wCurTimeDelta, 0
		retf
ResetGameTime	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TimeAndMouse	proc far		; CODE XREF: RunMenu+D0P
					; RunTracksMenu+332P ...

var_6		= word ptr -6
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		push	cs
		call	near ptr DoGetTimerDelta
		mov	si, ax
		add	g_wGameTime, si
		jmp	short loc_174B_22EF
; ---------------------------------------------------------------------------

loc_174B_22EA:				; CODE XREF: TimeAndMouse+1Ej
		sub	g_wGameTime, 3Ch ; '<'

loc_174B_22EF:				; CODE XREF: TimeAndMouse+12j
		cmp	g_wGameTime, 3Ch ; '<'
		jg	short loc_174B_22EA
		cmp	g_wGameTime, 1Eh
		jle	short loc_174B_2302
		mov	di, [bp+arg_A]
		jmp	short loc_174B_2305
; ---------------------------------------------------------------------------

loc_174B_2302:				; CODE XREF: TimeAndMouse+25j
		mov	di, [bp+arg_C]

loc_174B_2305:				; CODE XREF: TimeAndMouse+2Aj
		cmp	g_wSomeTime, di
		jz	short loc_174B_2344
		mov	g_wSomeTime, di
		push	cs
		call	near ptr DoRenderMouSpr3
		mov	ax, [bp+arg_0]
		shl	ax, 1
		mov	[bp+var_6], ax
		push	di
		mov	bx, ax
		add	bx, [bp+arg_8]
		push	word ptr [bx]
		mov	bx, ax
		add	bx, [bp+arg_4]
		push	word ptr [bx]
		mov	bx, ax
		add	bx, [bp+arg_6]
		push	word ptr [bx]
		mov	bx, ax
		add	bx, [bp+arg_2]
		push	word ptr [bx]
		call	sub_261B_C
		add	sp, 0Ah
		push	cs
		call	near ptr DoUseMousePos

loc_174B_2344:				; CODE XREF: TimeAndMouse+33j
		mov	ax, si		; Return value = time delta
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TimeAndMouse	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadAudioResour	proc far		; CODE XREF: _main+45FP
					; RunIntroInLoop+13P ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	[bp+arg_2]
		mov	ax, 5		; LoadResource type 4 =	voice/sample file
		push	ax
		push	cs
		call	near ptr LoadResource
		add	sp, 4
		mov	word ptr g_dwVoiceRes, ax
		mov	word ptr g_dwVoiceRes+2, dx
		push	[bp+arg_0]
		mov	ax, 4		; LoadResource type 4 =	song file
		push	ax
		push	cs
		call	near ptr LoadResource
		add	sp, 4
		mov	word ptr g_dwSongRes, ax
		mov	word ptr g_dwSongRes+2,	dx
		push	[bp+arg_4]
		push	word ptr g_dwVoiceRes+2
		push	word ptr g_dwVoiceRes
		push	dx
		push	ax
		call	DoInitAudioRese
		add	sp, 0Ah
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		push	dx
		push	ax
		call	LoadAudioFinali
		mov	g_bLoadedAudio,	1
		mov	sp, bp
		pop	bp
		retf
LoadAudioResour	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


UnloadAudioReso	proc far		; CODE XREF: _main:_lblDoCvxP
					; _main:_lblPrepareIntrP ...
		mov	ax, 2
		push	ax
		call	AudioDrvFunc3f
		add	sp, 2
		push	word ptr g_dwSongRes+2
		push	word ptr g_dwSongRes
		call	UnloadResource
		add	sp, 4
		push	word ptr g_dwVoiceRes+2
		push	word ptr g_dwVoiceRes
		call	UnloadResource
		add	sp, 4
		mov	g_bLoadedAudio,	0
		retf
UnloadAudioReso	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetFontDefImpl	proc far		; CODE XREF: RunTracksMenu+18EP
					; MainTextResFont+17DP	...

arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		push	word ptr [bp+arg_0+2]
		push	word ptr [bp+arg_0]
		call	SetFontDefSeg
		add	sp, 4
		les	bx, [bp+arg_0]
		mov	ax, es:[bx+0Eh]
		mov	g_wFontDef_0E, ax
		pop	bp
		retf
SetFontDefImpl	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


SetFontDef	proc far		; CODE XREF: _main+ECP
					; RunTracksMenu+210P ...
		push	word ptr g_dwFontDefRes+2
		push	word ptr g_dwFontDefRes
		push	cs
		call	near ptr SetFontDefImpl
		add	sp, 4
		retf
SetFontDef	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FormatString	proc far		; CODE XREF: Trakdata11StringOp+117P
					; EndOfGameScores+119P	...

var_16		= word ptr -16h
var_12		= byte ptr -12h
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 18h
		push	di
		push	si
		mov	ax, 3Ch	; '<'
		imul	g_wFramesPerSec
		mov	[bp+var_16], ax
		mov	ax, [bp+arg_2]
		sub	dx, dx
		div	[bp+var_16]
		mov	si, ax
		mov	ax, [bp+var_16]
		imul	si
		sub	[bp+arg_2], ax
		mov	ax, [bp+arg_2]
		sub	dx, dx
		div	g_wFramesPerSec
		mov	di, ax
		mov	ax, g_wFramesPerSec
		imul	di
		sub	[bp+arg_2], ax
		mov	ax, 2
		push	ax
		sub	ax, ax
		push	ax
		push	si
		lea	ax, [bp+var_12]
		push	ax
		push	cs
		call	near ptr DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		push	[bp+arg_0]
		call	_strcpy
		add	sp, 4
		mov	ax, offset asc_2B77_3464 ; ":"
		push	ax
		push	[bp+arg_0]
		call	_strcat
		add	sp, 4
		mov	ax, 2
		push	ax
		mov	ax, 1
		push	ax
		push	di
		lea	ax, [bp+var_12]
		push	ax
		push	cs
		call	near ptr DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		push	[bp+arg_0]
		call	_strcat
		add	sp, 4
		cmp	[bp+arg_4], 0
		jz	short loc_174B_24D8
		mov	ax, offset a_	; "."
		push	ax
		push	[bp+arg_0]
		call	_strcat
		add	sp, 4
		mov	ax, 2
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 64h	; 'd'
		cwd
		mov	cx, g_wFramesPerSec
		idiv	cx
		mul	[bp+arg_2]
		push	ax
		lea	ax, [bp+var_12]
		push	ax
		push	cs
		call	near ptr DoNumberString
		add	sp, 8
		lea	ax, [bp+var_12]
		push	ax
		push	[bp+arg_0]
		call	_strcat
		add	sp, 4

loc_174B_24D8:				; CODE XREF: FormatString+8Fj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
FormatString	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetSuperRandom	proc far		; CODE XREF: _main+388P
					; EndOfGameScores+647P	...

var_4		= word ptr -4

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		call	_rand
		mov	di, ax
		call	GetRandomKevin
		mov	[bp+var_4], ax
		call	GetTimerCounter
		add	ax, [bp+var_4]
		add	ax, di
		add	ax, g_wDrvNameTime
		mov	si, ax
		or	si, si
		jge	short loc_174B_2512
		neg	ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_2512:				; CODE XREF: GetSuperRandom+29j
		mov	ax, si
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
GetSuperRandom	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadResource	proc far		; CODE XREF: _main+C7P	_main+DDP ...

var_4		= word ptr -4
var_2		= word ptr -2
p_wType		= word ptr  6
p_pcName	= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4

loc_174B_2520:				; CODE XREF: LoadResource+B1j
		mov	ax, [bp+p_wType]
		cmp	ax, 8
		jbe	short loc_174B_252B
		jmp	loc_174B_25B0
; ---------------------------------------------------------------------------

loc_174B_252B:				; CODE XREF: LoadResource+Cj
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_174B_259E[bx]
; ---------------------------------------------------------------------------
		align 2

loc_174B_2534:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource:off_174B_259Eo
		push	[bp+p_pcName]
		call	LoadRes0_1Type

loc_174B_253C:				; CODE XREF: LoadResource+50j
					; LoadResource+5Aj ...
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		jmp	short loc_174B_25B0
; ---------------------------------------------------------------------------
		align 2

loc_174B_2548:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+86o
		push	[bp+p_pcName]
		call	LoadRes0_1Type

loc_174B_2550:				; CODE XREF: LoadResource+46j
		add	sp, 2
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_2558:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+92o
		push	[bp+p_pcName]
		call	AltUncompressFi
		jmp	short loc_174B_2550
; ---------------------------------------------------------------------------

loc_174B_2562:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+88o
		push	[bp+p_pcName]
		call	DoLoad2DShape_0
		jmp	short loc_174B_253C
; ---------------------------------------------------------------------------

loc_174B_256C:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+8Ao
		push	[bp+p_pcName]
		call	far ptr	AltLoad2dShapeR
		jmp	short loc_174B_253C
; ---------------------------------------------------------------------------

loc_174B_2576:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+8Co
		push	[bp+p_pcName]
		call	LoadSongFile
		jmp	short loc_174B_253C
; ---------------------------------------------------------------------------

loc_174B_2580:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+8Eo
		push	[bp+p_pcName]
		call	LoadVoiceFile
		jmp	short loc_174B_253C
; ---------------------------------------------------------------------------

loc_174B_258A:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+90o
		push	[bp+p_pcName]
		call	LoadSfxFile
		jmp	short loc_174B_253C
; ---------------------------------------------------------------------------

loc_174B_2594:				; CODE XREF: LoadResource+14j
					; DATA XREF: LoadResource+94o
		push	[bp+p_pcName]
		call	DoLoad2DShape_1
		jmp	short loc_174B_253C
; ---------------------------------------------------------------------------
off_174B_259E	dw offset loc_174B_2534	; DATA XREF: LoadResource+14r
		dw offset loc_174B_2548
		dw offset loc_174B_2562
		dw offset loc_174B_256C
		dw offset loc_174B_2576
		dw offset loc_174B_2580
		dw offset loc_174B_258A
		dw offset loc_174B_2558
		dw offset loc_174B_2594
; ---------------------------------------------------------------------------

loc_174B_25B0:				; CODE XREF: LoadResource+Ej
					; LoadResource+2Bj
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jz	short loc_174B_25C2
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_174B_25C2:				; CODE XREF: LoadResource+9Cj
		push	cs
		call	near ptr DoDeaTextRes
		cmp	ax, 2
		jz	short loc_174B_25CE
		jmp	loc_174B_2520
; ---------------------------------------------------------------------------

loc_174B_25CE:				; CODE XREF: LoadResource+AFj
		sub	ax, ax
		cwd
		mov	sp, bp
		pop	bp
		retf
LoadResource	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadHighScoreMa	proc far		; CODE XREF: DoHighScore+5AP

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 4

loc_174B_25DC:				; CODE XREF: LoadHighScoreMa+5Dj
		mov	ax, [bp+arg_0]
		cmp	ax, 9
		jz	short loc_174B_25EC
		cmp	ax, 0Ah
		jz	short loc_174B_2616
		jmp	short loc_174B_2603
; ---------------------------------------------------------------------------
		align 2

loc_174B_25EC:				; CODE XREF: LoadHighScoreMa+Cj
		push	[bp+arg_6]
		push	[bp+arg_4]
		push	[bp+arg_2]
		call	LoadBinaryFile2
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_174B_2603:				; CODE XREF: LoadHighScoreMa+13j
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jz	short loc_174B_262C
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_2616:				; CODE XREF: LoadHighScoreMa+11j
		push	[bp+arg_6]
		push	[bp+arg_4]
		push	[bp+arg_2]
		call	LoadBinaryFile2
		add	sp, 6
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_174B_262C:				; CODE XREF: LoadHighScoreMa+33j
		push	cs
		call	near ptr DoDeaTextRes
		cmp	ax, 2
		jnz	short loc_174B_25DC
		sub	ax, ax
		cwd
		mov	sp, bp
		pop	bp
		retf
LoadHighScoreMa	endp


; =============== S U B	R O U T	I N E =======================================


PushInputStatus	proc far		; CODE XREF: RunGame+289P
					; DoJoyResText+9p ...
		push	si
		mov	al, g_cKbRelIndex
		cbw
		mov	si, ax
		mov	al, g_cKbMouUnk
		mov	byte ptr g_arrKb_187Rel[si], al
		mov	al, g_cKbOrMouse
		mov	byte ptr g_arrKbOrMouse[si], al
		inc	g_cKbRelIndex
		pop	si
		retf
PushInputStatus	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


PopInputStatus	proc far		; CODE XREF: RunGame+2DAP
					; DoJoyResText+25Fp ...
		push	si
		cmp	g_cKbRelIndex, 0
		jz	short loc_174B_2680
		dec	g_cKbRelIndex
		mov	al, g_cKbRelIndex
		cbw
		mov	si, ax
		mov	al, byte ptr g_arrKb_187Rel[si]
		mov	g_cKbMouUnk, al
		mov	al, byte ptr g_arrKbOrMouse[si]
		mov	g_cKbOrMouse, al
		or	al, al
		jnz	short loc_174B_2680
		push	cs
		call	near ptr DoRenderMouSpr3

loc_174B_2680:				; CODE XREF: PopInputStatus+6j
					; PopInputStatus+22j
		pop	si
		retf
PopInputStatus	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoJoyResText	proc far		; CODE XREF: RunOptionMenu:loc_0_30C2P
					; DATA XREF: SetVideoMode+2Bo

var_56		= word ptr -56h
var_54		= word ptr -54h
var_52		= word ptr -52h
var_50		= word ptr -50h
var_4E		= word ptr -4Eh
var_4C		= word ptr -4Ch
var_4A		= word ptr -4Ah
var_48		= word ptr -48h
var_46		= word ptr -46h
var_44		= word ptr -44h
var_42		= word ptr -42h
var_40		= word ptr -40h
var_3E		= word ptr -3Eh
var_3C		= word ptr -3Ch
var_3A		= word ptr -3Ah
var_38		= word ptr -38h
var_36		= word ptr -36h
var_34		= word ptr -34h
var_32		= word ptr -32h
var_30		= word ptr -30h
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_1C		= word ptr -1Ch
var_18		= word ptr -18h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah

		push	bp
		mov	bp, sp
		sub	sp, 56h
		push	di
		push	si
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	DrvFuncMany
		sub	ax, ax
		push	ax
		lea	ax, [bp+var_2E]
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aJoy	; "joy"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 3
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		or	ax, ax
		jg	short loc_174B_26D4
		jmp	loc_174B_28C6
; ---------------------------------------------------------------------------

loc_174B_26D4:				; CODE XREF: DoJoyResText+4Dj
		mov	[bp+var_C], 0

loc_174B_26D9:				; CODE XREF: DoJoyResText+67j
		mov	bx, [bp+var_C]
		add	bx, bp
		mov	byte ptr [bx-0Ah], 0
		inc	[bp+var_C]
		cmp	[bp+var_C], 9
		jl	short loc_174B_26D9
		mov	g_bSkipJoystick, 1
		push	cs
		call	near ptr DoRenderMouSpr3
		push	g_wDialogArg2
		mov	ax, [bp+var_14]
		sub	ax, [bp+var_28]
		sub	ax, 8
		push	ax
		mov	ax, 1
		push	ax
		push	[bp+var_28]
		mov	ax, [bp+var_2A]
		sub	ax, 4
		push	ax
		call	SpriteOp
		add	sp, 0Ah
		push	g_wDialogArg2
		mov	ax, [bp+var_14]
		sub	ax, [bp+var_28]
		sub	ax, 8
		push	ax
		mov	ax, 1
		push	ax
		push	[bp+var_24]
		mov	ax, [bp+var_26]
		sub	ax, 4
		push	ax
		call	SpriteOp
		add	sp, 0Ah
		push	g_wDialogArg2
		mov	ax, 1
		push	ax
		mov	ax, [bp+var_22]
		sub	ax, [bp+var_2E]
		push	ax
		mov	ax, [bp+var_1C]
		sub	ax, 4
		push	ax
		push	[bp+var_2E]
		call	SpriteOp
		add	sp, 0Ah
		push	g_wDialogArg2
		mov	ax, 1
		push	ax
		mov	ax, [bp+var_22]
		sub	ax, [bp+var_2E]
		push	ax
		mov	ax, [bp+var_18]
		sub	ax, 4
		push	ax
		push	[bp+var_2E]
		call	SpriteOp
		add	sp, 0Ah
		mov	ax, [bp+var_2A]
		mov	[bp+var_40], ax
		mov	[bp+var_3E], ax
		mov	[bp+var_36], ax
		mov	ax, [bp+var_26]
		mov	[bp+var_3C], ax
		mov	[bp+var_3A], ax
		mov	[bp+var_38], ax
		mov	ax, [bp+var_2E]
		mov	[bp+var_34], ax
		mov	[bp+var_32], ax
		mov	[bp+var_30], ax
		mov	ax, [bp+var_1C]
		mov	[bp+var_54], ax
		mov	[bp+var_4E], ax
		mov	[bp+var_46], ax
		mov	ax, [bp+var_28]
		mov	[bp+var_52], ax
		mov	[bp+var_50], ax
		mov	[bp+var_44], ax
		mov	ax, [bp+var_18]
		mov	[bp+var_4C], ax
		mov	[bp+var_4A], ax
		mov	[bp+var_48], ax
		mov	ax, [bp+var_2A]
		sub	ax, [bp+var_2E]
		sub	ax, 8
		mov	[bp+var_12], ax
		mov	ax, [bp+var_1C]
		sub	ax, [bp+var_2C]
		sub	ax, 8
		mov	[bp+var_42], ax
		mov	si, 0FFFFh
		call	SetupJoyVals

loc_174B_27E6:				; CODE XREF: DoJoyResText+190j
					; DoJoyResText+1EDj
		call	ReadKbChar
		or	ax, ax
		jz	short loc_174B_27F8

loc_174B_27EF:				; CODE XREF: DoJoyResText+181j
		mov	[bp+var_C], 0
		jmp	short loc_174B_2875
; ---------------------------------------------------------------------------
		align 4

loc_174B_27F8:				; CODE XREF: DoJoyResText+16Bj
		call	GetJoystickFlag
		mov	di, ax
		test	di, 30h
		jnz	short loc_174B_27EF
		push	di
		call	LookupArray
		add	sp, 2
		mov	di, ax
		cmp	di, si
		jz	short loc_174B_27E6
		mov	[bp+var_C], 0

loc_174B_2819:				; CODE XREF: DoJoyResText+1C2j
		mov	ax, [bp+var_C]
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_56], ax
		push	word_2B77_3420
		push	[bp+var_42]
		push	[bp+var_12]
		mov	bx, ax
		push	word ptr [bx-54h]
		push	word ptr [bx-40h]
		call	SpriteOp
		add	sp, 0Ah
		inc	[bp+var_C]
		cmp	[bp+var_C], 9
		jl	short loc_174B_2819
		mov	ax, di
		shl	ax, 1
		add	ax, bp
		mov	[bp+var_56], ax
		push	g_wFontFlag
		push	[bp+var_42]
		push	[bp+var_12]
		mov	bx, ax
		push	word ptr [bx-54h]
		push	word ptr [bx-40h]
		call	SpriteOp
		add	sp, 0Ah
		mov	si, di
		mov	[bp+di+var_A], 1
		jmp	loc_174B_27E6
; ---------------------------------------------------------------------------

loc_174B_2872:				; CODE XREF: DoJoyResText+205j
		inc	[bp+var_C]

loc_174B_2875:				; CODE XREF: DoJoyResText+172j
		cmp	[bp+var_C], 9
		jge	short loc_174B_288A
		mov	bx, [bp+var_C]
		add	bx, bp
		mov	al, [bx-0Ah]
		and	g_bSkipJoystick, al
		jmp	short loc_174B_2872
; ---------------------------------------------------------------------------
		align 2

loc_174B_288A:				; CODE XREF: DoJoyResText+1F7j
		push	cs
		call	near ptr DoTrakdata12
		cmp	g_bSkipJoystick, 0
		jnz	short loc_174B_28CB
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aJox	; "jox"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		jmp	short loc_174B_28CB
; ---------------------------------------------------------------------------
		align 2

loc_174B_28C6:				; CODE XREF: DoJoyResText+4Fj
		mov	g_bSkipJoystick, 0

loc_174B_28CB:				; CODE XREF: DoJoyResText+211j
					; DoJoyResText+241j
		call	KbCheckAndRead
		mov	byte_2B77_182, 0
		call	sub_270D_224
		mov	g_wIsInputMetho, 0
		push	cs
		call	near ptr PopInputStatus
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoJoyResText	endp


; =============== S U B	R O U T	I N E =======================================


DoKeyResText	proc far		; CODE XREF: RunOptionMenu:loc_0_30BAP
					; DATA XREF: SetVideoMode+3Fo
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	DrvFuncMany
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aKey	; "key"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 4
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	g_bSkipJoystick, 0
		mov	byte_2B77_182, 0
		mov	g_wIsInputMetho, 0
		call	sub_270D_224
		push	cs
		call	near ptr PopInputStatus
		retf
DoKeyResText	endp


; =============== S U B	R O U T	I N E =======================================


DoMouResText	proc far		; CODE XREF: RunOptionMenu:loc_0_30CAP
					; sub_11B7_88A:_lblMouseControlP
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	DrvFuncMany
		mov	byte_2B77_182, 1
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMou	; "mou"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 4
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	g_wIsInputMetho, 0
		call	sub_270D_224
		push	cs
		call	near ptr PopInputStatus
		retf
DoMouResText	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


DoPauTextRes	proc far		; DATA XREF: SetVideoMode+67o
					; SetVideoMode+7Bo
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	DrvFuncMany
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aPau	; "pau"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	g_wIsInputMetho, 0
		call	sub_270D_224
		push	cs
		call	near ptr PopInputStatus
		retf
DoPauTextRes	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


DoMofTextRes	proc far		; CODE XREF: RunOptionMenu:loc_0_30D2P
					; DATA XREF: SetVideoMode+53o
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	ToggleDrvFlag2
		or	ax, ax
		jz	short loc_174B_2A0E
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, 347Dh
		jmp	short loc_174B_2A1E
; ---------------------------------------------------------------------------
		align 2

loc_174B_2A0E:				; CODE XREF: DoMofTextRes+11j
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMof	; "mof"

loc_174B_2A1E:				; CODE XREF: DoMofTextRes+23j
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 4
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	g_wIsInputMetho, 0
		push	cs
		call	near ptr PopInputStatus
		retf
DoMofTextRes	endp


; =============== S U B	R O U T	I N E =======================================


DoSonSofTextRes	proc far		; CODE XREF: RunOptionMenu:loc_0_30DAP
					; DATA XREF: SetVideoMode+A3o
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	ToggleDrvFlag6
		or	ax, ax
		jz	short loc_174B_2A70
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aSon	; "son"
		jmp	short loc_174B_2A80
; ---------------------------------------------------------------------------
		align 2

loc_174B_2A70:				; CODE XREF: DoSonSofTextRes+11j
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aSof	; "sof"

loc_174B_2A80:				; CODE XREF: DoSonSofTextRes+23j
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 4
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	g_wIsInputMetho, 0
		push	cs
		call	near ptr PopInputStatus
		retf
DoSonSofTextRes	endp


; =============== S U B	R O U T	I N E =======================================


DoDosTextRes	proc far		; CODE XREF: RunOptionMenu:loc_0_313CP
					; DATA XREF: SetVideoMode+8Fo ...
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	DrvFuncMany
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aDos_0 ; "dos"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		cmp	ax, 1
		jnz	short loc_174B_2AF6
		call	far ptr	Exit

loc_174B_2AF6:				; CODE XREF: DoDosTextRes+43j
		mov	g_wIsInputMetho, 0
		call	sub_270D_224
		push	cs
		call	near ptr PopInputStatus
		retf
DoDosTextRes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoMrlTextRes	proc far		; CODE XREF: RunOptionMenu:loc_0_3134P
					; RplyMouseSpriteStuff:loc_11B7_2C9AP
					; DATA XREF: ...

var_212		= word ptr -212h
var_20C		= byte ptr -20Ch
var_205		= byte ptr -205h
var_204		= byte ptr -204h
var_202		= byte ptr -202h
var_201		= byte ptr -201h
var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 212h
		push	di
		push	si
		push	cs
		call	near ptr PushInputStatus
		mov	g_wIsInputMetho, 1
		call	DrvFuncMany
		mov	ax, g_wFramesPerSec2
		mov	[bp+var_212], ax
		mov	[bp+var_2], 0

loc_174B_2B29:				; CODE XREF: DoMrlTextRes+EAj
					; DoMrlTextRes+F4j ...
		mov	ax, offset aMrl	; "mrl"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		lea	ax, [bp+var_202]
		push	ax
		push	cs
		call	near ptr CopyString
		add	sp, 6
		sub	si, si

loc_174B_2B4C:				; CODE XREF: DoMrlTextRes+4Fj
		mov	[bp+si+var_20C], 0
		inc	si
		cmp	si, 9
		jl	short loc_174B_2B4C
		mov	bl, g_wTimerFlag3
		sub	bh, bh
		add	bx, bp
		mov	byte ptr [bx-20Ch], 1
		mov	bx, g_wTimerFlag1
		add	bx, bp
		mov	byte ptr [bx-207h], 1
		cmp	g_wFramesPerSec2, 0Ah
		jnz	short loc_174B_2B7E
		mov	[bp+var_205], 1
		jmp	short loc_174B_2B83
; ---------------------------------------------------------------------------
		align 2

loc_174B_2B7E:				; CODE XREF: DoMrlTextRes+6Ej
		mov	[bp+var_204], 1

loc_174B_2B83:				; CODE XREF: DoMrlTextRes+75j
		sub	di, di
		sub	si, si
		jmp	short loc_174B_2BA0
; ---------------------------------------------------------------------------
		align 2

loc_174B_2B8A:				; CODE XREF: DoMrlTextRes+8Aj
		inc	di

loc_174B_2B8B:				; CODE XREF: DoMrlTextRes+9Dj
		cmp	[bp+di+var_202], 5Bh ; '['
		jnz	short loc_174B_2B8A
		cmp	[bp+si+var_20C], 0
		jz	short loc_174B_2B9E
		mov	[bp+di+var_201], 2Ah ; '*'

loc_174B_2B9E:				; CODE XREF: DoMrlTextRes+91j
		inc	di
		inc	si

loc_174B_2BA0:				; CODE XREF: DoMrlTextRes+81j
		cmp	si, 9
		jl	short loc_174B_2B8B
		mov	al, [bp+var_2]
		cbw
		push	ax
		sub	ax, ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		lea	ax, [bp+var_202]
		push	ss
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	[bp+var_2], al
		cbw
		cmp	ax, 0FFFFh
		jz	short loc_174B_2C1C
		cmp	ax, 5
		jz	short loc_174B_2BF4
		cmp	ax, 6
		jz	short loc_174B_2BFE
		cmp	ax, 7
		jz	short loc_174B_2C08
		cmp	ax, 8
		jz	short loc_174B_2C12
		cmp	ax, 9
		jz	short loc_174B_2C1C
		mov	g_wTimerFlag3, al
		jmp	loc_174B_2B29
; ---------------------------------------------------------------------------
		align 2

loc_174B_2BF4:				; CODE XREF: DoMrlTextRes+D1j
		mov	g_wTimerFlag1, 0
		jmp	loc_174B_2B29
; ---------------------------------------------------------------------------
		align 2

loc_174B_2BFE:				; CODE XREF: DoMrlTextRes+D6j
		mov	g_wTimerFlag1, 1
		jmp	loc_174B_2B29
; ---------------------------------------------------------------------------
		align 2

loc_174B_2C08:				; CODE XREF: DoMrlTextRes+DBj
		mov	g_wFramesPerSec2, 0Ah
		jmp	loc_174B_2B29
; ---------------------------------------------------------------------------
		align 2

loc_174B_2C12:				; CODE XREF: DoMrlTextRes+E0j
		mov	g_wFramesPerSec2, 14h
		jmp	loc_174B_2B29
; ---------------------------------------------------------------------------
		align 2

loc_174B_2C1C:				; CODE XREF: DoMrlTextRes+CCj
					; DoMrlTextRes+E5j
		mov	ax, g_wFramesPerSec2
		cmp	[bp+var_212], ax
		jz	short loc_174B_2C53
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMrs	; "mrs"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h

loc_174B_2C53:				; CODE XREF: DoMrlTextRes+11Dj
		mov	g_wIsInputMetho, 0
		call	sub_270D_224
		push	cs
		call	near ptr PopInputStatus
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoMrlTextRes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoDeaTextRes	proc far		; CODE XREF: LoadResFile+77p
					; LoadResource+A9p ...

var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	cs
		call	near ptr PushInputStatus
		cmp	g_bSaveDelFlag,	0
		jz	short loc_174B_2CB8
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aDea	; "dea"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		mov	[bp+var_2], ax
		or	ax, ax
		jz	short loc_174B_2CE6
		mov	[bp+var_2], 0
		jmp	short loc_174B_2CEB
; ---------------------------------------------------------------------------

loc_174B_2CB8:				; CODE XREF: DoDeaTextRes+Fj
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aDer	; "der"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h

loc_174B_2CE6:				; CODE XREF: DoDeaTextRes+47j
		mov	[bp+var_2], 1

loc_174B_2CEB:				; CODE XREF: DoDeaTextRes+4Ej
		push	cs
		call	near ptr PopInputStatus
		mov	ax, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
DoDeaTextRes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

EnsureFileExists proc far		; CODE XREF: _main+3F5P _main+444P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		jmp	short loc_174B_2D38
; ---------------------------------------------------------------------------
		align 2

loc_174B_2CFC:				; CODE XREF: EnsureFileExists+55j
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	bx, [bp+arg_0]
		shl	bx, 1
		push	word ptr (aOpp1_+5)[bx]	; "Insert Disk A/B .. etc presskey"
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		push	cs
		call	near ptr DoRenderMouSpr3
		mov	g_cKbOrMouse, 0

loc_174B_2D38:				; CODE XREF: EnsureFileExists+3j
		mov	bx, [bp+arg_0]
		shl	bx, 1
		push	g_ppFilenames[bx]
		call	FindFileName
		add	sp, 2
		or	ax, ax
		jz	short loc_174B_2CFC
		pop	bp
		retf
EnsureFileExists endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


DoMerTextRes	proc far		; CODE XREF: RunGame+A1P
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMer	; "mer"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		push	cs
		call	near ptr LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		push	cs
		call	near ptr DoDialog
		add	sp, 12h
		retf
DoMerTextRes	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


DoGetTimerDelta	proc far		; CODE XREF: LoadIntroRes+5E9P
					; LoadIntroRes:loc_0_D77P ...
		call	GetTimerDelta
		retf
DoGetTimerDelta	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Load3DShape	proc far		; CODE XREF: SetupIntro+11P
					; LoadGame3dShpes+32P ...

var_54		= byte ptr -54h
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 54h

loc_174B_2D8C:				; CODE XREF: Load3DShape+7Aj
		push	[bp+arg_0]
		lea	ax, [bp+var_54]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset a_p3s ; ".p3s"
		push	ax
		lea	ax, [bp+var_54]
		push	ax
		call	_strcat
		add	sp, 4
		lea	ax, [bp+var_54]
		push	ax
		mov	ax, 7
		push	ax
		push	cs
		call	near ptr LoadResource
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_174B_2E02
		push	[bp+arg_0]
		lea	ax, [bp+var_54]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset a_3sh ; ".3sh"
		push	ax
		lea	ax, [bp+var_54]
		push	ax
		call	_strcat
		add	sp, 4
		lea	ax, [bp+var_54]
		push	ax
		mov	ax, 1
		push	ax
		push	cs
		call	near ptr LoadResource
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_174B_2E02
		push	cs
		call	near ptr DoDeaTextRes
		jmp	short loc_174B_2D8C
; ---------------------------------------------------------------------------

loc_174B_2E02:				; CODE XREF: Load3DShape+3Cj
					; Load3DShape+74j
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
Load3DShape	endp

seg008		ends

; ===========================================================================

; Segment type:	Pure code
seg009		segment	byte public 'CODE' use16
		assume cs:seg009
		;org 0Ch
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TrackEditRelate	proc far		; CODE XREF: RunTracksMenu+4AFP

var_198		= word ptr -198h
var_196		= word ptr -196h
var_194		= word ptr -194h
var_192		= byte ptr -192h
var_190		= byte ptr -190h
cStartCol	= byte ptr -18Eh
var_18D		= byte ptr -18Dh
var_18C		= byte ptr -18Ch
var_18A		= byte ptr -18Ah
var_188		= byte ptr -188h
var_186		= byte ptr -186h
var_184		= byte ptr -184h
var_182		= byte ptr -182h
cStartRow	= byte ptr -180h
var_17F		= byte ptr -17Fh
var_17E		= byte ptr -17Eh
var_17C		= dword	ptr -17Ch
var_178		= byte ptr -178h
var_176		= byte ptr -176h
var_174		= byte ptr -174h
var_172		= word ptr -172h
var_170		= word ptr -170h
var_16E		= word ptr -16Eh
var_16C		= word ptr -16Ch
var_16A		= word ptr -16Ah
var_168		= word ptr -168h
var_166		= word ptr -166h
var_164		= word ptr -164h
var_162		= byte ptr -162h
var_DC		= word ptr -0DCh
var_DA		= byte ptr -0DAh
var_D8		= byte ptr -0D8h
var_D6		= byte ptr -0D6h
var_D4		= byte ptr -0D4h
var_D2		= word ptr -0D2h
var_D0		= word ptr -0D0h
var_CC		= word ptr -0CCh
var_CA		= word ptr -0CAh
var_C8		= word ptr -0C8h
var_C6		= byte ptr -0C6h
var_C4		= byte ptr -0C4h
var_C2		= byte ptr -0C2h
var_C0		= byte ptr -0C0h
var_BE		= byte ptr -0BEh
var_3A		= word ptr -3Ah
var_38		= word ptr -38h
var_36		= byte ptr -36h
var_34		= byte ptr -34h
var_32		= byte ptr -32h
var_30		= byte ptr -30h
var_2E		= byte ptr -2Eh
var_2C		= byte ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= word ptr -24h
pTeditRes1	= word ptr -22h
pTeditRes2	= word ptr -20h
var_1E		= byte ptr -1Eh
var_1C		= byte ptr -1Ch
var_1A		= byte ptr -1Ah
var_18		= word ptr -18h
var_16		= byte ptr -16h
var_14		= byte ptr -14h
var_12		= byte ptr -12h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_8		= byte ptr -8
var_6		= byte ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 198h
		push	di
		push	si
		mov	ax, offset aSdtedit ; "sdtedit"
		push	ax
		call	far ptr	j__Load2DShape_1
		add	sp, 2
		mov	[bp+var_2A], ax
		mov	[bp+var_28], dx
		mov	ax, offset word_2B77_70CC
		push	ax
		mov	ax, offset aFlatlakelak1la ; "flatlakelak1lak2lak3lak4highgoungouwgou"...
		push	ax
		push	dx
		push	[bp+var_2A]
		call	LocateManyResou
		add	sp, 8
		mov	ax, offset dword_2B77_70BC
		push	ax
		mov	ax, offset aCrs0crs1crs2cr ; "crs0crs1crs2crs3"
		push	ax
		push	[bp+var_28]
		push	[bp+var_2A]
		call	LocateManyResou
		add	sp, 8
		mov	ax, offset unk_2B77_7118
		push	ax
		mov	ax, offset aUcr0ucr1ucr2uc ; "ucr0ucr1ucr2ucr3"
		push	ax
		push	[bp+var_28]
		push	[bp+var_2A]
		call	LocateManyResou
		add	sp, 8
		mov	ax, 0Fh
		push	ax
		les	bx, dword_2B77_70BC
		push	word ptr es:[bx+2]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	[bp+var_172], ax
		mov	[bp+var_170], dx
		mov	ax, 0Fh
		push	ax
		les	bx, dword_2B77_70C0
		push	word ptr es:[bx+2]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	[bp+var_16E], ax
		mov	[bp+var_16C], dx
		mov	ax, 0Fh
		push	ax
		les	bx, dword_2B77_70C4
		push	word ptr es:[bx+2]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	[bp+var_16A], ax
		mov	[bp+var_168], dx
		mov	ax, 0Fh
		push	ax
		les	bx, dword_2B77_70C8
		push	word ptr es:[bx+2]
		mov	ax, es:[bx]
		imul	g_wSetHandlers
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	[bp+var_166], ax
		mov	[bp+var_164], dx
		mov	ax, offset aTedit_0 ; "tedit"
		push	ax
		call	LoadResFile
		add	sp, 2
		mov	[bp+pTeditRes1], ax
		mov	[bp+pTeditRes2], dx
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h ; 'È'
		push	ax
		mov	ax, 140h
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pWndSprite, ax
		mov	word ptr g_pWndSprite+2, dx
		mov	ax, offset aPbox ; "pbox"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	AltLocateShape
		add	sp, 6
		mov	word_2B77_6DD0,	ax
		mov	word_2B77_6DD2,	dx
		mov	ax, offset aSnam ; "snam"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	AltLocateShape
		add	sp, 6
		mov	[bp+var_26], ax
		mov	[bp+var_24], dx
		mov	ax, offset aMnam ; "mnam"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	AltLocateShape
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		mov	ax, offset aTnam ; "tnam"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	AltLocateShape
		add	sp, 6
		mov	[bp+var_D2], ax
		mov	[bp+var_D0], dx
		mov	[bp+var_D4], 0
		sub	si, si

loc_1A2B_18E:				; CODE XREF: TrackEditRelate+191j
		mov	[bp+si+var_162], 0FFh
		mov	[bp+si+var_BE],	0FFh
		inc	si
		cmp	si, 84h	; '„'
		jl	short loc_1A2B_18E
		sub	si, si

loc_1A2B_1A1:				; CODE XREF: TrackEditRelate+24Ej
		mov	ax, si
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_194], ax
		mov	ax, [bp+var_26]
		mov	dx, [bp+var_24]
		add	ax, [bp+var_194]
		mov	word ptr [bp+var_17C], ax
		mov	word ptr [bp+var_17C+2], dx
		les	bx, [bp+var_17C]
		mov	al, es:[bx]
		mov	g_pTempByte, al
		mov	al, es:[bx+1]
		mov	byte_2B77_AC75,	al
		mov	al, es:[bx+2]
		mov	byte_2B77_AC76,	al
		mov	al, es:[bx+3]
		mov	byte_2B77_AC77,	al
		mov	ax, offset g_pTempByte
		push	ax
		push	[bp+var_28]
		push	[bp+var_2A]
		call	LocateShape
		add	sp, 6
		mov	bx, [bp+var_194]
		mov	word ptr unk_2B77_6AE8[bx], ax
		mov	word ptr unk_2B77_6AEA[bx], dx
		mov	ax, si
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_196], ax
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		add	ax, [bp+var_196]
		mov	word ptr [bp+var_17C], ax
		mov	word ptr [bp+var_17C+2], dx
		les	bx, [bp+var_17C]
		mov	al, es:[bx]
		mov	g_pTempByte, al
		mov	al, es:[bx+1]
		mov	byte_2B77_AC75,	al
		mov	al, es:[bx+2]
		mov	byte_2B77_AC76,	al
		mov	al, es:[bx+3]
		mov	byte_2B77_AC77,	al
		mov	ax, 0AC74h
		push	ax
		push	[bp+var_28]
		push	[bp+var_2A]
		call	LocateShape
		add	sp, 6
		mov	bx, [bp+var_196]
		mov	[bx+6DD4h], ax
		mov	[bx+6DD6h], dx
		inc	si
		cmp	si, 0BAh ; 'º'
		jge	short loc_1A2B_25D
		jmp	loc_1A2B_1A1
; ---------------------------------------------------------------------------

loc_1A2B_25D:				; CODE XREF: TrackEditRelate+24Cj
		mov	[bp+var_DA], 0FFh
		mov	[bp+var_2C], 0FFh
		mov	[bp+var_32], 1
		mov	[bp+var_184], 1
		mov	[bp+var_A], 1
		mov	[bp+var_36], 0FFh
		mov	[bp+var_188], 1
		mov	[bp+var_C6], 1
		mov	[bp+var_30], 1
		mov	[bp+var_38], 0
		mov	[bp+var_34], 0
		mov	[bp+var_190], 0
		mov	[bp+var_18], 0
		mov	[bp+var_18D], 0
		mov	[bp+var_8], 0
		mov	[bp+var_18C], 0
		mov	[bp+var_C2], 0
		mov	[bp+var_12], 0
		mov	al, g_cStartCol
		mov	[bp+cStartCol],	al
		mov	al, g_cStartRow
		mov	[bp+cStartRow],	al
		mov	[bp+var_17F], 7
		call	SelClrWndSprite
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 16h
		push	ax
		mov	ax, 66h	; 'f'
		push	ax
		mov	ax, 3
		push	ax
		mov	ax, 0D9h ; 'Ù'
		push	ax
		mov	ax, offset aBti	; "bti"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		push	word_2B77_5080
		push	word_2B77_507E
		push	word_2B77_507C
		mov	ax, 0BEh ; '¾'
		push	ax
		mov	ax, 0CEh ; 'Î'
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 5
		push	ax
		call	DoImgResetRende
		add	sp, 0Eh
		push	word_2B77_5080
		push	word_2B77_507E
		push	word_2B77_507C
		mov	ax, 9Eh	; 'ž'
		push	ax
		mov	ax, 66h	; 'f'
		push	ax
		mov	ax, 20h	; ' '
		push	ax
		mov	ax, 0D9h ; 'Ù'
		push	ax
		call	DoImgResetRende
		add	sp, 0Eh
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 0Eh
		push	ax
		mov	ax, 5Eh	; '^'
		push	ax
		mov	ax, 8Ch	; 'Œ'
		push	ax
		mov	ax, 0DDh ; 'Ý'
		push	ax
		mov	ax, offset aBsc	; "bsc"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax

loc_1A2B_37C:
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 0Eh
		push	ax
		mov	ax, 2Eh	; '.'
		push	ax
		mov	ax, 9Ch	; 'œ'
		push	ax
		mov	ax, 0DDh ; 'Ý'
		push	ax
		mov	ax, offset aBlo	; "blo"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 0Eh
		push	ax
		mov	ax, 2Eh	; '.'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, 0DDh ; 'Ý'
		push	ax
		mov	ax, offset aBsa	; "bsa"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax

loc_1A2B_3FD:
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 0Eh
		push	ax
		mov	ax, 2Eh	; '.'
		push	ax
		mov	ax, 9Ch	; 'œ'
		push	ax
		mov	ax, 10Dh
		push	ax
		mov	ax, offset aBcl_0 ; "bcl"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h
		sub	ax, ax
		push	ax
		push	word_2B77_5088
		push	word_2B77_5086
		push	word_2B77_5084
		mov	ax, 0Eh
		push	ax
		mov	ax, 2Eh	; '.'
		push	ax
		mov	ax, 0ACh ; '¬'
		push	ax
		mov	ax, 10Dh
		push	ax
		mov	ax, offset aBex	; "bex"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		call	ImgResetText
		add	sp, 14h

loc_1A2B_470:				; CODE XREF: TrackEditRelate+1088j
					; TrackEditRelate+1097j ...
		cmp	[bp+var_A], 0
		jnz	short loc_1A2B_47F
		mov	al, [bp+var_2C]
		cmp	[bp+var_C6], al
		jz	short loc_1A2B_4C5

loc_1A2B_47F:				; CODE XREF: TrackEditRelate+468j
		mov	[bp+var_14], 1
		mov	[bp+var_6], 1
		mov	[bp+var_C4], 0
		cmp	[bp+var_C6], 0
		jz	short loc_1A2B_4C5
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		cbw
		cmp	ax, 1
		jz	short loc_1A2B_4BC
		cmp	ax, 2
		jz	short loc_1A2B_510
		cmp	ax, 3
		jz	short loc_1A2B_51C
		jmp	short loc_1A2B_4C5
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_4BC:				; CODE XREF: TrackEditRelate+4A1j
		mov	[bp+var_6], 2
		mov	[bp+var_C4], 1

loc_1A2B_4C5:				; CODE XREF: TrackEditRelate+471j
					; TrackEditRelate+485j	...
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_4CE
		jmp	loc_1A2B_5A1
; ---------------------------------------------------------------------------

loc_1A2B_4CE:				; CODE XREF: TrackEditRelate+4BDj
		cmp	[bp+cStartCol],	1Dh
		jnz	short loc_1A2B_4DF
		cmp	[bp+var_14], 2
		jnz	short loc_1A2B_4DF
		dec	[bp+cStartCol]

loc_1A2B_4DF:				; CODE XREF: TrackEditRelate+4C7j
					; TrackEditRelate+4CDj
		cmp	[bp+cStartRow],	1Dh
		jnz	short loc_1A2B_4F0
		cmp	[bp+var_6], 2
		jnz	short loc_1A2B_4F0
		dec	[bp+cStartRow]

loc_1A2B_4F0:				; CODE XREF: TrackEditRelate+4D8j
					; TrackEditRelate+4DEj	...
		mov	al, [bp+var_8]
		cbw
		mov	cx, ax
		mov	al, [bp+cStartCol]
		cbw
		sub	ax, cx
		mov	cx, ax
		mov	al, [bp+var_14]
		cbw
		add	cx, ax
		cmp	cx, 0Ch
		jle	short loc_1A2B_52F
		inc	[bp+var_8]
		jmp	short loc_1A2B_4F0
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_510:				; CODE XREF: TrackEditRelate+4A6j
		mov	[bp+var_C4], 2
		mov	[bp+var_14], 2
		jmp	short loc_1A2B_4C5
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_51C:				; CODE XREF: TrackEditRelate+4ABj
		mov	[bp+var_14], 2
		mov	[bp+var_6], 2
		mov	[bp+var_C4], 3
		jmp	short loc_1A2B_4C5
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_52C:				; CODE XREF: TrackEditRelate+530j
		dec	[bp+var_8]

loc_1A2B_52F:				; CODE XREF: TrackEditRelate+4FCj
		mov	al, [bp+var_8]
		cbw
		mov	cx, ax
		mov	al, [bp+cStartCol]
		cbw
		cmp	ax, cx
		jl	short loc_1A2B_52C
		jmp	short loc_1A2B_544
; ---------------------------------------------------------------------------

loc_1A2B_540:				; CODE XREF: TrackEditRelate+551j
		inc	[bp+var_18C]

loc_1A2B_544:				; CODE XREF: TrackEditRelate+532j
		mov	al, [bp+var_18C]
		cbw
		mov	cx, ax
		mov	al, [bp+cStartRow]
		cbw
		sub	ax, cx
		mov	cx, ax
		mov	al, [bp+var_6]
		cbw
		add	cx, ax
		cmp	cx, 0Bh
		jg	short loc_1A2B_540
		jmp	short loc_1A2B_566
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_562:				; CODE XREF: TrackEditRelate+568j
		dec	[bp+var_18C]

loc_1A2B_566:				; CODE XREF: TrackEditRelate+553j
		mov	al, [bp+var_18C]
		cbw
		mov	cx, ax
		mov	al, [bp+cStartRow]
		cbw
		cmp	ax, cx
		jl	short loc_1A2B_562
		mov	al, [bp+var_17E]
		cmp	[bp+var_8], al
		jnz	short loc_1A2B_589
		mov	al, [bp+var_D8]
		cmp	[bp+var_18C], al
		jz	short loc_1A2B_5A1

loc_1A2B_589:				; CODE XREF: TrackEditRelate+571j
		mov	al, [bp+var_8]
		mov	[bp+var_17E], al
		mov	al, [bp+var_18C]
		mov	[bp+var_D8], al
		mov	[bp+var_32], 1
		mov	[bp+var_184], 1

loc_1A2B_5A1:				; CODE XREF: TrackEditRelate+4BFj
					; TrackEditRelate+57Bj
		mov	al, [bp+var_C6]
		cmp	[bp+var_2C], al
		jnz	short loc_1A2B_5AD
		jmp	loc_1A2B_644
; ---------------------------------------------------------------------------

loc_1A2B_5AD:				; CODE XREF: TrackEditRelate+59Cj
		mov	[bp+var_A], 1
		mov	[bp+var_2C], al
		jmp	short loc_1A2B_5C8
; ---------------------------------------------------------------------------

loc_1A2B_5B6:				; CODE XREF: TrackEditRelate+5E9j
		cmp	byte ptr [bp+var_196], 0FFh
		jnz	short loc_1A2B_5C4
		dec	[bp+var_18D]
		jmp	short loc_1A2B_5C8
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_5C4:				; CODE XREF: TrackEditRelate+5AFj
		dec	[bp+var_17F]

loc_1A2B_5C8:				; CODE XREF: TrackEditRelate+5A8j
					; TrackEditRelate+5B5j
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	byte ptr [bp+var_196], al
		cmp	al, 0FEh ; 'þ'
		jnb	short loc_1A2B_5B6
		call	SelectWndSprite
		mov	al, [bp+var_C6]
		cbw
		push	ax
		push	cs
		call	near ptr sub_1A2B_1C06
		add	sp, 2
		cmp	[bp+var_C6], 0
		jnz	short loc_1A2B_61A
		mov	ax, 1
		push	ax
		push	ax
		sub	ax, ax
		jmp	short loc_1A2B_628
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_61A:				; CODE XREF: TrackEditRelate+602j
		mov	ax, 0Ah
		push	ax
		mov	ax, 1
		push	ax
		mov	al, [bp+var_C6]
		cbw
		dec	ax

loc_1A2B_628:				; CODE XREF: TrackEditRelate+60Bj
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 85h	; '…'
		push	ax
		mov	ax, 5Fh	; '_'
		push	ax
		mov	ax, 0DDh ; 'Ý'
		push	ax
		sub	ax, ax
		push	ax
		call	MouseSpriteOp
		add	sp, 10h

loc_1A2B_644:				; CODE XREF: TrackEditRelate+59Ej
		cmp	[bp+var_30], 0
		jz	short loc_1A2B_655
		mov	[bp+var_30], 0
		push	cs
		call	near ptr DoTrakdata14_15
		mov	[bp+var_12], al

loc_1A2B_655:				; CODE XREF: TrackEditRelate+63Cj
		cmp	[bp+var_32], 0
		jnz	short loc_1A2B_664
		cmp	[bp+var_A], 0
		jnz	short loc_1A2B_664
		jmp	loc_1A2B_85E
; ---------------------------------------------------------------------------

loc_1A2B_664:				; CODE XREF: TrackEditRelate+64Dj
					; TrackEditRelate+653j
		call	SelectWndSprite
		cmp	[bp+var_32], 0
		jnz	short loc_1A2B_672
		jmp	loc_1A2B_71D
; ---------------------------------------------------------------------------

loc_1A2B_672:				; CODE XREF: TrackEditRelate+661j
		mov	[bp+var_32], 0
		cmp	[bp+var_184], 0
		jz	short loc_1A2B_6D3
		mov	[bp+var_184], 0
		mov	ax, 1Eh
		push	ax
		mov	ax, 0Ch
		push	ax
		mov	al, [bp+var_8]
		cbw
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 0B5h ; 'µ'
		push	ax
		mov	ax, 0C0h ; 'À'
		push	ax
		mov	ax, 9
		push	ax
		sub	ax, ax
		push	ax
		call	MouseSpriteOp
		add	sp, 10h
		mov	ax, 1Eh
		push	ax
		mov	ax, 0Bh
		push	ax
		mov	al, [bp+var_18C]
		cbw
		push	ax
		mov	ax, 0B0h ; '°'
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 0CAh ; 'Ê'
		push	ax
		sub	ax, ax
		push	ax
		call	MouseSpriteOp
		add	sp, 10h

loc_1A2B_6D3:				; CODE XREF: TrackEditRelate+66Fj
		mov	ax, 0B3h ; '³'
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 0C8h ; 'È'
		push	ax
		mov	ax, 8
		push	ax
		call	SetSprite1Size
		add	sp, 8
		lea	ax, [bp+var_BE]
		push	ax
		lea	ax, [bp+var_162]
		push	ax
		mov	al, [bp+var_18C]
		cbw
		push	ax
		mov	al, [bp+var_8]
		cbw
		push	ax
		push	cs
		call	near ptr DoTrakdata15_14
		add	sp, 8
		mov	ax, 0C8h ; 'È'
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8

loc_1A2B_71D:				; CODE XREF: TrackEditRelate+663j
		cmp	[bp+var_A], 0
		jnz	short loc_1A2B_726
		jmp	loc_1A2B_840
; ---------------------------------------------------------------------------

loc_1A2B_726:				; CODE XREF: TrackEditRelate+715j
		mov	[bp+var_A], 0
		mov	al, [bp+var_C4]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		push	word ptr [bx-170h]
		push	word ptr [bx-172h]
		call	SetSprite1
		add	sp, 4
		cmp	[bp+var_C6], 0
		jz	short loc_1A2B_751
		jmp	loc_1A2B_7DE
; ---------------------------------------------------------------------------

loc_1A2B_751:				; CODE XREF: TrackEditRelate+740j
		sub	ax, ax
		push	ax
		push	ax
		mov	bl, [bp+var_190]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr [bx+70CEh]
		push	word ptr [bx+70CCh]
		call	sub_1EA2_5310
		add	sp, 8
		push	g_wDialogArg1
		sub	ax, ax
		push	ax
		mov	ax, 0Fh
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 1
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	g_wDialogArg1
		mov	ax, 0Eh
		push	ax
		mov	ax, 0Fh
		push	ax
		mov	ax, 0Eh
		push	ax
		mov	ax, 1
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	g_wDialogArg1
		mov	ax, 0Eh
		push	ax
		mov	ax, 1
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 1
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		push	g_wDialogArg1
		mov	ax, 0Eh
		push	ax
		mov	ax, 0Fh
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 0Fh
		push	ax
		call	ImageResetRende
		add	sp, 0Ah
		jmp	short loc_1A2B_840
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_7DE:				; CODE XREF: TrackEditRelate+742j
		sub	ax, ax
		push	ax
		push	ax
		mov	al, [bp+var_C4]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr (dword_2B77_70BC+2)[bx]
		push	word ptr dword_2B77_70BC[bx]
		call	sub_1EA2_5310
		add	sp, 8
		cmp	[bp+var_190], 0
		jz	short loc_1A2B_840
		sub	ax, ax
		push	ax
		push	ax
		mov	bl, [bp+var_190]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	sub_1EA2_4FFE
		add	sp, 8
		sub	ax, ax
		push	ax
		push	ax
		mov	bl, [bp+var_190]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6AEA[bx]
		push	word ptr unk_2B77_6AE8[bx]
		call	sub_1EA2_57F2
		add	sp, 8

loc_1A2B_840:				; CODE XREF: TrackEditRelate+717j
					; TrackEditRelate+7CFj	...
		mov	al, [bp+var_36]
		cbw
		push	ax
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	MouseStuff
		add	sp, 6
		mov	[bp+var_36], 0FEh ; 'þ'
		mov	[bp+var_C2], 0FFh

loc_1A2B_85E:				; CODE XREF: TrackEditRelate+655j
		call	SetSprite2As1_2
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_86C
		jmp	loc_1A2B_93A
; ---------------------------------------------------------------------------

loc_1A2B_86C:				; CODE XREF: TrackEditRelate+85Bj
		mov	al, [bp+var_14]
		mov	cl, 4
		shl	al, cl
		mov	[bp+var_2E], al
		mov	al, [bp+var_6]
		shl	al, cl
		mov	[bp+var_1A], al
		mov	al, [bp+cStartCol]
		cbw
		mov	[bp+var_196], ax
		mov	al, [bp+var_8]
		cbw
		mov	dx, [bp+var_196]
		sub	dx, ax
		shl	dx, cl
		add	dx, 8
		mov	[bp+var_CA], dx
		mov	al, [bp+cStartRow]
		cbw
		mov	[bp+var_194], ax
		mov	al, [bp+var_18C]
		cbw
		mov	dx, [bp+var_194]
		sub	dx, ax
		shl	dx, cl
		add	dx, 4
		mov	[bp+var_DC], dx
		mov	bx, [bp+var_194]
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		add	bx, [bp+var_196]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+var_182], al
		sub	ah, ah
		cmp	ax, 0FDh ; 'ý'
		jz	short loc_1A2B_8E8
		cmp	ax, 0FEh ; 'þ'
		jz	short loc_1A2B_90C
		cmp	ax, 0FFh
		jz	short loc_1A2B_92A
		jmp	loc_1A2B_A7B
; ---------------------------------------------------------------------------

loc_1A2B_8E8:				; CODE XREF: TrackEditRelate+8CDj
		mov	al, [bp+cStartRow]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]

loc_1A2B_8F5:				; CODE XREF: TrackEditRelate+92Bj
		mov	al, [bp+cStartCol]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	al, es:[bx-1]

loc_1A2B_904:				; CODE XREF: TrackEditRelate+91Bj
		mov	[bp+var_182], al
		jmp	loc_1A2B_A7B
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_90C:				; CODE XREF: TrackEditRelate+8D2j
		mov	al, [bp+cStartRow]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]
		mov	al, [bp+cStartCol]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	al, es:[bx]
		jmp	short loc_1A2B_904
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_92A:				; CODE XREF: TrackEditRelate+8D7j
		mov	al, [bp+cStartRow]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		jmp	short loc_1A2B_8F5
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_93A:				; CODE XREF: TrackEditRelate+85Dj
		mov	[bp+var_2E], 10h
		mov	[bp+var_1A], 10h
		mov	al, [bp+var_17F]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'
		mov	[bp+var_DC], ax
		cmp	[bp+var_17F], 6
		jnz	short loc_1A2B_96A
		mov	[bp+var_CA], 0DCh ; 'Ü'
		mov	[bp+var_1A], 8
		mov	[bp+var_2E], 60h ; '`'
		jmp	loc_1A2B_A6F
; ---------------------------------------------------------------------------

loc_1A2B_96A:				; CODE XREF: TrackEditRelate+94Bj
		cmp	[bp+var_17F], 7
		jnz	short loc_1A2B_988
		sub	[bp+var_DC], 8
		mov	[bp+var_18D], 0
		mov	[bp+var_CA], 0DCh ; 'Ü'
		mov	[bp+var_2E], 60h ; '`'
		jmp	loc_1A2B_A6A
; ---------------------------------------------------------------------------

loc_1A2B_988:				; CODE XREF: TrackEditRelate+963j
		cmp	[bp+var_17F], 7
		jle	short loc_1A2B_9BE
		sub	[bp+var_DC], 8
		cmp	[bp+var_18D], 3
		jge	short loc_1A2B_9A2
		mov	[bp+var_18D], 0
		jmp	short loc_1A2B_9A7
; ---------------------------------------------------------------------------

loc_1A2B_9A2:				; CODE XREF: TrackEditRelate+98Dj
		mov	[bp+var_18D], 3

loc_1A2B_9A7:				; CODE XREF: TrackEditRelate+994j
		mov	al, [bp+var_18D]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		mov	[bp+var_CA], ax
		mov	[bp+var_2E], 30h ; '0'
		jmp	loc_1A2B_A6A
; ---------------------------------------------------------------------------

loc_1A2B_9BE:				; CODE XREF: TrackEditRelate+981j
		mov	al, [bp+var_18D]
		cbw
		mov	[bp+var_196], ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		mov	[bp+var_CA], ax
		cmp	[bp+var_17F], 5
		jge	short loc_1A2B_A05

loc_1A2B_9D9:
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		add	bx, [bp+var_196]
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		cmp	byte ptr es:[bx+6], 0FEh ; 'þ'
		jnz	short loc_1A2B_A05
		mov	[bp+var_1A], 20h ; ' '

loc_1A2B_A05:				; CODE XREF: TrackEditRelate+9CBj
					; TrackEditRelate+9F3j
		cmp	[bp+var_18D], 5
		jge	short loc_1A2B_A3B
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		cmp	byte ptr es:[bx+1], 0FFh
		jnz	short loc_1A2B_A3B
		mov	[bp+var_2E], 20h ; ' '

loc_1A2B_A3B:				; CODE XREF: TrackEditRelate+9FEj
					; TrackEditRelate+A29j
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	[bp+var_182], al
		cmp	al, 0FDh ; 'ý'
		jb	short loc_1A2B_A6F

loc_1A2B_A6A:				; CODE XREF: TrackEditRelate+979j
					; TrackEditRelate+9AFj
		mov	[bp+var_182], 0

loc_1A2B_A6F:				; CODE XREF: TrackEditRelate+95Bj
					; TrackEditRelate+A5Cj
		cmp	[bp+var_C6], 0
		jnz	short loc_1A2B_A7B
		mov	[bp+var_182], 0

loc_1A2B_A7B:				; CODE XREF: TrackEditRelate+8D9j
					; TrackEditRelate+8FCj	...
		mov	al, [bp+var_C2]
		cmp	[bp+var_182], al
		jnz	short loc_1A2B_A88
		jmp	loc_1A2B_B44
; ---------------------------------------------------------------------------

loc_1A2B_A88:				; CODE XREF: TrackEditRelate+A77j
		call	DoRenderMouSpr3
		sub	ax, ax
		push	ax
		push	g_wFontFlag
		call	SetTwoFontBytes
		add	sp, 4
		mov	al, [bp+var_182]
		sub	ah, ah
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	ax, [bp+var_D2]
		mov	dx, [bp+var_D0]
		mov	word ptr [bp+var_17C], ax
		mov	word ptr [bp+var_17C+2], dx
		les	bx, [bp+var_17C]
		mov	al, es:[bx]
		mov	g_pTempByte, al
		mov	al, es:[bx+1]
		mov	byte_2B77_AC75,	al
		mov	al, es:[bx+2]
		mov	byte_2B77_AC76,	al
		mov	ax, offset g_pTempByte
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	CopyString
		add	sp, 6
		mov	ax, offset g_pTempByte
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	si, ax
		mov	ax, 0C0h ; 'À'
		push	ax
		mov	ax, 8
		push	ax
		mov	ax, offset g_pTempByte
		push	ax
		call	FontSpriteOp
		add	sp, 6
		cmp	[bp+var_38], si
		jle	short loc_1A2B_B34
		sub	ax, ax
		push	ax
		mov	ax, 8
		push	ax
		mov	ax, [bp+var_38]
		sub	ax, si
		push	ax
		mov	ax, 0C0h ; 'À'
		push	ax
		lea	ax, [si+8]
		push	ax
		call	SpriteOp
		add	sp, 0Ah

loc_1A2B_B34:				; CODE XREF: TrackEditRelate+B09j
		call	DoUseMousePos
		mov	[bp+var_38], si
		mov	al, [bp+var_182]
		mov	[bp+var_C2], al

loc_1A2B_B44:				; CODE XREF: TrackEditRelate+A79j
		cmp	[bp+var_12], 0
		jz	short loc_1A2B_B86
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	al, [bp+var_12]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	ax, offset aEokenseieemsee ; "eokenseieemseedewwefuenpestejsejdeteewa"...
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_12], 0

loc_1A2B_B86:				; CODE XREF: TrackEditRelate+B3Cj
		mov	[bp+var_3A], 63h ; 'c'
		mov	[bp+var_CC], 0
		call	DoRenderMouSpr3
		mov	al, [bp+var_34]
		mov	[bp+var_16], al
		or	al, al
		jnz	short loc_1A2B_BC3
		push	[bp+var_DC]
		push	[bp+var_CA]
		mov	al, [bp+var_C4]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_711A[bx]
		push	word ptr unk_2B77_7118[bx]
		call	DoClearImageArea
		add	sp, 8

loc_1A2B_BC3:				; CODE XREF: TrackEditRelate+B92j
					; TrackEditRelate+D26j
		cmp	[bp+var_3A], 0Fh
		jg	short loc_1A2B_BCC
		jmp	loc_1A2B_C5E
; ---------------------------------------------------------------------------

loc_1A2B_BCC:				; CODE XREF: TrackEditRelate+BBBj
		call	DoRenderMouSpr3
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_C26
		cmp	[bp+var_CC], 0
		jz	short loc_1A2B_C04
		push	[bp+var_DC]
		push	[bp+var_CA]
		mov	al, [bp+var_C4]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_711A[bx]
		push	word ptr unk_2B77_7118[bx]

loc_1A2B_BF9:				; CODE XREF: TrackEditRelate+C18j
		call	sub_1EA2_5310
		add	sp, 8
		jmp	short loc_1A2B_C4F
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_C04:				; CODE XREF: TrackEditRelate+BD0j
		push	[bp+var_DC]
		push	[bp+var_CA]
		mov	al, [bp+var_C4]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		add	bx, bp
		les	bx, [bx-172h]
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		jmp	short loc_1A2B_BF9
; ---------------------------------------------------------------------------

loc_1A2B_C26:				; CODE XREF: TrackEditRelate+BC9j
		push	word_2B77_5082
		mov	al, [bp+var_1A]
		cbw
		add	ax, [bp+var_DC]
		dec	ax
		push	ax
		mov	al, [bp+var_2E]
		cbw
		add	ax, [bp+var_CA]
		push	ax
		mov	ax, [bp+var_DC]
		dec	ax
		push	ax
		push	[bp+var_CA]
		call	sub_2702_E
		add	sp, 0Ah

loc_1A2B_C4F:				; CODE XREF: TrackEditRelate+BF5j
		call	DoUseMousePos
		xor	byte ptr [bp+var_CC], 1
		mov	[bp+var_3A], 0

loc_1A2B_C5E:				; CODE XREF: TrackEditRelate+BBDj
		call	DoGetTimerDelta
		mov	di, ax
		add	[bp+var_3A], di
		push	di
		call	InputsChecking
		add	sp, 2
		mov	[bp+var_C8], ax
		mov	ax, offset word_2B77_3584
		push	ax
		mov	ax, offset word_2B77_357A
		push	ax
		mov	ax, offset word_2B77_3570
		push	ax
		mov	ax, offset word_2B77_3566
		push	ax
		mov	ax, 5
		push	ax
		call	CheckMousePos
		add	sp, 0Ah
		mov	[bp+var_18A], al
		cmp	al, 0FFh
		jz	short loc_1A2B_D18
		cbw
		or	ax, ax
		jz	short loc_1A2B_CC0
		cmp	ax, 1
		jnz	short loc_1A2B_CA6
		jmp	loc_1A2B_D88
; ---------------------------------------------------------------------------

loc_1A2B_CA6:				; CODE XREF: TrackEditRelate+C95j
		cmp	ax, 2
		jnz	short loc_1A2B_CAE
		jmp	loc_1A2B_DD8
; ---------------------------------------------------------------------------

loc_1A2B_CAE:				; CODE XREF: TrackEditRelate+C9Dj
		cmp	ax, 3
		jnz	short loc_1A2B_CB6
		jmp	loc_1A2B_E32
; ---------------------------------------------------------------------------

loc_1A2B_CB6:				; CODE XREF: TrackEditRelate+CA5j
		cmp	ax, 4
		jnz	short loc_1A2B_CBE
		jmp	loc_1A2B_F00
; ---------------------------------------------------------------------------

loc_1A2B_CBE:				; CODE XREF: TrackEditRelate+CADj
		jmp	short loc_1A2B_D0C
; ---------------------------------------------------------------------------

loc_1A2B_CC0:				; CODE XREF: TrackEditRelate+C90j
		test	byte ptr g_wMouButStatus, 3
		jz	short loc_1A2B_D0C
		mov	[bp+var_34], 0
		mov	ax, 1Eh
		push	ax
		mov	ax, 0Ch
		push	ax
		mov	al, [bp+var_8]
		cbw
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 0B5h ; 'µ'
		push	ax
		mov	ax, 0C0h ; 'À'
		push	ax
		mov	ax, 9
		push	ax
		mov	ax, 1
		push	ax
		call	MouseSpriteOp
		add	sp, 10h
		mov	[bp+var_186], al
		sub	al, [bp+var_8]
		add	[bp+cStartCol],	al
		mov	al, [bp+var_186]
		mov	[bp+var_8], al

loc_1A2B_D06:				; CODE XREF: TrackEditRelate+DC8j
					; TrackEditRelate+E23j
		mov	[bp+var_C8], 1

loc_1A2B_D0C:				; CODE XREF: TrackEditRelate:loc_1A2B_CBEj
					; TrackEditRelate+CB9j	...
		cmp	[bp+var_C8], 1
		jnz	short loc_1A2B_D18
		mov	[bp+var_DA], 0FFh

loc_1A2B_D18:				; CODE XREF: TrackEditRelate+C8Bj
					; TrackEditRelate+D05j
		cmp	[bp+var_C8], 0
		jnz	short loc_1A2B_D2B
		cmp	[bp+var_18], 0
		jz	short loc_1A2B_D2B
		mov	[bp+var_C8], 1

loc_1A2B_D2B:				; CODE XREF: TrackEditRelate+D11j
					; TrackEditRelate+D17j
		cmp	[bp+var_C8], 0
		jnz	short loc_1A2B_D35
		jmp	loc_1A2B_BC3
; ---------------------------------------------------------------------------

loc_1A2B_D35:				; CODE XREF: TrackEditRelate+D24j
		cmp	[bp+var_18], 0
		jz	short loc_1A2B_D49
		mov	ax, 0Ah
		cwd
		push	dx
		push	ax
		call	DoGetTimerCounter2X
		add	sp, 4

loc_1A2B_D49:				; CODE XREF: TrackEditRelate+D2Dj
		cmp	[bp+var_CC], 0
		jnz	short loc_1A2B_D53
		jmp	loc_1A2B_1024
; ---------------------------------------------------------------------------

loc_1A2B_D53:				; CODE XREF: TrackEditRelate+D42j
		call	DoRenderMouSpr3
		cmp	[bp+var_16], 0
		jz	short loc_1A2B_D61
		jmp	loc_1A2B_FF6
; ---------------------------------------------------------------------------

loc_1A2B_D61:				; CODE XREF: TrackEditRelate+D50j
		push	[bp+var_DC]
		push	[bp+var_CA]
		mov	al, [bp+var_C4]
		cbw
		mov	bx, ax
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_711A[bx]
		push	word ptr unk_2B77_7118[bx]
		call	sub_1EA2_5310
		add	sp, 8
		jmp	loc_1A2B_101F
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_D88:				; CODE XREF: TrackEditRelate+C97j
		test	byte ptr g_wMouButStatus, 3
		jnz	short loc_1A2B_D92
		jmp	loc_1A2B_D0C
; ---------------------------------------------------------------------------

loc_1A2B_D92:				; CODE XREF: TrackEditRelate+D81j
		mov	[bp+var_34], 0
		mov	ax, 1Eh
		push	ax
		mov	ax, 0Bh
		push	ax
		mov	al, [bp+var_18C]
		cbw
		push	ax
		mov	ax, 0B0h ; '°'
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 0CAh ; 'Ê'
		push	ax
		mov	ax, 1
		push	ax
		call	MouseSpriteOp
		add	sp, 10h
		mov	[bp+var_186], al
		sub	al, [bp+var_18C]
		add	[bp+cStartRow],	al
		mov	al, [bp+var_186]
		mov	[bp+var_18C], al
		jmp	loc_1A2B_D06
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_DD8:				; CODE XREF: TrackEditRelate+C9Fj
		cmp	[bp+var_34], 1
		jnz	short loc_1A2B_DE5
		cmp	[bp+var_17F], 6
		jz	short loc_1A2B_DF4

loc_1A2B_DE5:				; CODE XREF: TrackEditRelate+DD0j
		mov	[bp+var_34], 1
		mov	[bp+var_17F], 6
		mov	[bp+var_C8], 1

loc_1A2B_DF4:				; CODE XREF: TrackEditRelate+DD7j
		test	byte ptr g_wMouButStatus, 3
		jnz	short loc_1A2B_DFE
		jmp	loc_1A2B_D0C
; ---------------------------------------------------------------------------

loc_1A2B_DFE:				; CODE XREF: TrackEditRelate+DEDj
		mov	ax, 0Ah
		push	ax
		mov	ax, 1
		push	ax
		mov	al, [bp+var_C6]
		cbw
		dec	ax
		push	ax
		mov	ax, 5
		push	ax
		mov	ax, 85h	; '…'
		push	ax
		mov	ax, 5Fh	; '_'
		push	ax
		mov	ax, 0DDh ; 'Ý'
		push	ax
		mov	ax, 1
		push	ax
		call	MouseSpriteOp
		add	sp, 10h
		inc	al
		mov	[bp+var_C6], al
		jmp	loc_1A2B_D06
; ---------------------------------------------------------------------------

loc_1A2B_E32:				; CODE XREF: TrackEditRelate+CA7j
		mov	ax, g_wMouXPos
		sub	ax, 8
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	cx, 4
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_D6], al
		mov	ax, g_wMouYPos
		sub	ax, cx
		cwd
		xor	ax, dx
		sub	ax, dx
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_174], al
		cmp	[bp+var_C6], 0
		jz	short loc_1A2B_EAA
		cmp	al, 0Ah
		jnz	short loc_1A2B_E86
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	byte ptr [bx+20A3h], 1
		jz	short loc_1A2B_E86
		dec	[bp+var_174]

loc_1A2B_E86:				; CODE XREF: TrackEditRelate+E5Bj
					; TrackEditRelate+E74j
		cmp	[bp+var_D6], 0Bh
		jnz	short loc_1A2B_EAA
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	byte ptr [bx+20A3h], 2
		jz	short loc_1A2B_EAA
		dec	[bp+var_D6]

loc_1A2B_EAA:				; CODE XREF: TrackEditRelate+E57j
					; TrackEditRelate+E7Fj	...
		mov	al, [bp+var_8]
		add	[bp+var_D6], al
		mov	al, [bp+var_18C]
		add	[bp+var_174], al
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_ED3
		mov	al, [bp+var_D6]
		cmp	[bp+cStartCol],	al
		jnz	short loc_1A2B_ED3
		mov	al, [bp+var_174]
		cmp	[bp+cStartRow],	al
		jz	short loc_1A2B_EED

loc_1A2B_ED3:				; CODE XREF: TrackEditRelate+EB1j
					; TrackEditRelate+EBBj
		mov	[bp+var_34], 0
		mov	al, [bp+var_D6]
		mov	[bp+cStartCol],	al
		mov	al, [bp+var_174]
		mov	[bp+cStartRow],	al

loc_1A2B_EE7:				; CODE XREF: TrackEditRelate+FB5j
		mov	[bp+var_C8], 1

loc_1A2B_EED:				; CODE XREF: TrackEditRelate+EC5j
					; TrackEditRelate+F9Ej
		cmp	[bp+var_C8], 20h ; ' '
		jz	short loc_1A2B_EF7
		jmp	loc_1A2B_D0C
; ---------------------------------------------------------------------------

loc_1A2B_EF7:				; CODE XREF: TrackEditRelate+EE6j
		mov	[bp+var_C8], 0Dh
		jmp	loc_1A2B_D0C
; ---------------------------------------------------------------------------

loc_1A2B_F00:				; CODE XREF: TrackEditRelate+CAFj
		mov	ax, g_wMouXPos
		sub	ax, 0DCh ; 'Ü'
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	cx, 4
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_D6], al
		mov	ax, g_wMouYPos
		sub	ax, 24h	; '$'
		cwd
		xor	ax, dx
		sub	ax, dx
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_174], al
		cmp	al, 6
		jl	short loc_1A2B_F34
		jmp	loc_1A2B_FC4
; ---------------------------------------------------------------------------

loc_1A2B_F34:				; CODE XREF: TrackEditRelate+F23j
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	cx, ax
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		mov	bx, ax
		add	bx, cx
		mov	al, [bp+var_D6]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		cmp	byte ptr es:[bx], 0FEh ; 'þ'
		jnz	short loc_1A2B_F62
		dec	[bp+var_174]

loc_1A2B_F62:				; CODE XREF: TrackEditRelate+F50j
		mov	al, [bp+var_174]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	cx, ax
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		mov	bx, ax
		add	bx, cx
		mov	al, [bp+var_D6]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		cmp	byte ptr es:[bx], 0FFh
		jnz	short loc_1A2B_F90
		dec	[bp+var_D6]

loc_1A2B_F90:				; CODE XREF: TrackEditRelate+F7Ej
					; TrackEditRelate+FD9j	...
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_FAD
		mov	al, [bp+var_D6]
		cmp	[bp+var_18D], al
		jnz	short loc_1A2B_FAD
		mov	al, [bp+var_174]
		cmp	[bp+var_17F], al
		jnz	short loc_1A2B_FAD
		jmp	loc_1A2B_EED
; ---------------------------------------------------------------------------

loc_1A2B_FAD:				; CODE XREF: TrackEditRelate+F88j
					; TrackEditRelate+F92j	...
		mov	al, [bp+var_D6]
		mov	[bp+var_18D], al
		mov	al, [bp+var_174]
		mov	[bp+var_17F], al
		mov	[bp+var_34], 1
		jmp	loc_1A2B_EE7
; ---------------------------------------------------------------------------

loc_1A2B_FC4:				; CODE XREF: TrackEditRelate+F25j
		mov	ax, g_wMouYPos
		sub	ax, 1Ch
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	cx, 4
		sar	ax, cl
		xor	ax, dx
		sub	ax, dx
		mov	[bp+var_174], al
		cmp	al, 7
		jnz	short loc_1A2B_FE8

loc_1A2B_FE0:				; CODE XREF: TrackEditRelate+FE1j
		mov	[bp+var_D6], 0
		jmp	short loc_1A2B_F90
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_FE8:				; CODE XREF: TrackEditRelate+FD2j
		cmp	[bp+var_D6], 3
		jl	short loc_1A2B_FE0
		mov	[bp+var_D6], 3
		jmp	short loc_1A2B_F90
; ---------------------------------------------------------------------------

loc_1A2B_FF6:				; CODE XREF: TrackEditRelate+D52j
		push	word_2B77_5082
		mov	al, [bp+var_1A]
		cbw
		add	ax, [bp+var_DC]
		dec	ax
		push	ax
		mov	al, [bp+var_2E]
		cbw
		add	ax, [bp+var_CA]
		push	ax
		mov	ax, [bp+var_DC]
		dec	ax
		push	ax
		push	[bp+var_CA]
		call	sub_2702_E
		add	sp, 0Ah

loc_1A2B_101F:				; CODE XREF: TrackEditRelate+D78j
		call	DoUseMousePos

loc_1A2B_1024:				; CODE XREF: TrackEditRelate+D44j
		cmp	[bp+var_18], 0
		jz	short loc_1A2B_10A6
		cmp	[bp+var_C8], 1
		jnz	short loc_1A2B_1037
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_103E

loc_1A2B_1037:				; CODE XREF: TrackEditRelate+1023j
		mov	ax, word_2B77_A660
		dec	ax
		mov	[bp+var_18], ax

loc_1A2B_103E:				; CODE XREF: TrackEditRelate+1029j
		mov	bx, [bp+var_18]
		add	bx, word ptr g_pTrakdata21
		mov	es, word ptr g_pTrakdata21+2
		mov	al, es:[bx]
		mov	[bp+cStartCol],	al
		mov	bx, [bp+var_18]
		add	bx, word ptr g_ppTrakdata22
		mov	es, word ptr g_ppTrakdata22+2
		mov	al, es:[bx]
		mov	[bp+cStartRow],	al
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cStartCol]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+var_190], al
		mov	[bp+var_32], 1
		mov	[bp+var_A], 1
		inc	[bp+var_18]
		mov	ax, word_2B77_A660
		cmp	[bp+var_18], ax
		jge	short loc_1A2B_1097
		jmp	loc_1A2B_470
; ---------------------------------------------------------------------------

loc_1A2B_1097:				; CODE XREF: TrackEditRelate+1086j
		mov	al, [bp+var_1E]
		mov	[bp+var_190], al
		mov	[bp+var_18], 0
		jmp	loc_1A2B_470
; ---------------------------------------------------------------------------

loc_1A2B_10A6:				; CODE XREF: TrackEditRelate+101Cj
		mov	[bp+var_18], 0
		sub	si, si
		jmp	short loc_1A2B_10B1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_10B0:				; CODE XREF: TrackEditRelate+10B6j
		inc	si

loc_1A2B_10B1:				; CODE XREF: TrackEditRelate+10A1j
		cmp	si, 0Ah
		jge	short loc_1A2B_10D2
		mov	bx, si
		shl	bx, 1
		mov	ax, [bp+var_C8]
		cmp	g_arrBigVals12[bx], ax
		jnz	short loc_1A2B_10B0
		mov	ax, si
		inc	al
		mov	[bp+var_C6], al
		mov	[bp+var_C8], 0

loc_1A2B_10D2:				; CODE XREF: TrackEditRelate+10A8j
		mov	ax, [bp+var_C8]
		cmp	ax, 63h	; 'c'
		jz	short loc_1A2B_113A
		jbe	short loc_1A2B_10E0
		jmp	loc_1A2B_1B4E
; ---------------------------------------------------------------------------

loc_1A2B_10E0:				; CODE XREF: TrackEditRelate+10CFj
		cmp	ax, 0Dh
		jnz	short loc_1A2B_10E8
		jmp	loc_1A2B_11EA
; ---------------------------------------------------------------------------

loc_1A2B_10E8:				; CODE XREF: TrackEditRelate+10D7j
		cmp	ax, 20h	; ' '
		jz	short loc_1A2B_1100
		cmp	ax, 2Bh	; '+'
		jz	short loc_1A2B_111A
		cmp	ax, 2Dh	; '-'
		jz	short loc_1A2B_1108
		cmp	ax, 43h	; 'C'
		jz	short loc_1A2B_113A
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1100:				; CODE XREF: TrackEditRelate+10DFj
					; TrackEditRelate+1B73j
		xor	[bp+var_34], 1
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1108:				; CODE XREF: TrackEditRelate+10E9j
					; TrackEditRelate+19DBj
		cmp	[bp+var_C6], 1
		jg	short loc_1A2B_1112
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1112:				; CODE XREF: TrackEditRelate+1101j
		dec	[bp+var_C6]
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_111A:				; CODE XREF: TrackEditRelate+10E4j
					; TrackEditRelate+1A71j
		cmp	[bp+var_C6], 0Ah
		jl	short loc_1A2B_1124
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1124:				; CODE XREF: TrackEditRelate+1113j
		inc	[bp+var_C6]
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_112C:				; CODE XREF: TrackEditRelate+1B7Bj
		mov	[bp+var_C6], 0
		mov	[bp+var_190], 0
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_113A:				; CODE XREF: TrackEditRelate+10CDj
					; TrackEditRelate+10EEj
		call	SetupTrack
		cbw
		mov	si, ax
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, si
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		add	ax, offset aEokenseieemsee ; "eokenseieemseedewwefuenpestejsejdeteewa"...
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes	; ???
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		call	DoDialog
		add	sp, 12h
		cmp	si, 1
		jle	short loc_1A2B_11E1
		mov	[bp+var_34], 0
		cmp	word_2B77_A660,	0
		jnz	short loc_1A2B_1198
		mov	al, g_cStartCol
		mov	[bp+cStartCol],	al
		mov	al, g_cStartRow
		mov	[bp+cStartRow],	al
		jmp	short loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1198:				; CODE XREF: TrackEditRelate+117Aj
		les	bx, g_pTrakdata21
		mov	al, es:[bx]
		mov	[bp+cStartCol],	al
		les	bx, g_ppTrakdata22
		mov	al, es:[bx]
		mov	[bp+cStartRow],	al
		mov	al, [bp+var_190]
		mov	[bp+var_1E], al
		mov	al, [bp+cStartRow]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cStartCol]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+var_190], al
		mov	[bp+var_18], 1
		mov	[bp+var_A], 1

loc_1A2B_11E1:				; CODE XREF: TrackEditRelate+116Fj
					; TrackEditRelate+118Aj ...
		call	CheckForInput
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_11EA:				; CODE XREF: TrackEditRelate+10D9j
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_11F3
		jmp	loc_1A2B_163E
; ---------------------------------------------------------------------------

loc_1A2B_11F3:				; CODE XREF: TrackEditRelate+11E2j
		cmp	[bp+var_17F], 6
		jl	short loc_1A2B_11FD
		jmp	loc_1A2B_1294
; ---------------------------------------------------------------------------

loc_1A2B_11FD:				; CODE XREF: TrackEditRelate+11ECj
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	[bp+var_190], al
		cmp	[bp+var_C6], 0
		jz	short loc_1A2B_128A
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_1A2B_125B
		mov	al, [bp+var_18C]
		cbw
		mov	cx, ax
		mov	al, [bp+cStartRow]
		cbw
		sub	ax, cx
		cmp	ax, 0Ah
		jnz	short loc_1A2B_125B
		dec	[bp+cStartRow]

loc_1A2B_125B:				; CODE XREF: TrackEditRelate+1236j
					; TrackEditRelate+1249j
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jz	short loc_1A2B_128A
		mov	al, [bp+var_8]
		cbw
		mov	cx, ax
		mov	al, [bp+cStartCol]
		cbw
		sub	ax, cx
		cmp	ax, 0Bh
		jnz	short loc_1A2B_128A
		dec	[bp+cStartCol]

loc_1A2B_128A:				; CODE XREF: TrackEditRelate+1221j
					; TrackEditRelate+1266j ...
		inc	[bp+var_A]
		mov	[bp+var_34], 0
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1294:				; CODE XREF: TrackEditRelate+11EEj
		mov	[bp+var_30], 1
		cmp	[bp+var_17F], 6
		jnz	short loc_1A2B_12B6
		inc	[bp+var_C6]
		cmp	[bp+var_C6], 0Ah
		jg	short loc_1A2B_12AD
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_12AD:				; CODE XREF: TrackEditRelate+129Cj
		mov	[bp+var_C6], 1
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_12B6:				; CODE XREF: TrackEditRelate+1291j
		cmp	[bp+var_17F], 7
		jnz	short loc_1A2B_1316
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+TrackInfo.cSkybox]
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMss	; "mss"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes	; Select horizon [desert, tropical, alpine, city, country, cancel}
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_C], al
		cmp	al, 0FFh
		jnz	short loc_1A2B_1303
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1303:				; CODE XREF: TrackEditRelate+12F2j
		cmp	al, 5
		jnz	short loc_1A2B_130A
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_130A:				; CODE XREF: TrackEditRelate+12F9j
		les	bx, g_ppTrakdata14
		mov	es:[bx+TrackInfo.cSkybox], al
		jmp	loc_1A2B_13B8
; ---------------------------------------------------------------------------

loc_1A2B_1316:				; CODE XREF: TrackEditRelate+12AFj
		cmp	[bp+var_17F], 8
		jz	short loc_1A2B_1320
		jmp	loc_1A2B_13C4
; ---------------------------------------------------------------------------

loc_1A2B_1320:				; CODE XREF: TrackEditRelate+130Fj
		cmp	[bp+var_18D], 0
		jnz	short loc_1A2B_132A
		jmp	loc_1A2B_13C4
; ---------------------------------------------------------------------------

loc_1A2B_132A:				; CODE XREF: TrackEditRelate+1319j
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg2
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aMen_0 ; "men"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes	; Select terrain [1 2 3	4 5 cancel]
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_C], al
		cmp	al, 0FFh
		jnz	short loc_1A2B_1365
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1365:				; CODE XREF: TrackEditRelate+1354j
		cmp	al, 5
		jnz	short loc_1A2B_136C
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_136C:				; CODE XREF: TrackEditRelate+135Bj
		sub	si, si

loc_1A2B_136E:				; CODE XREF: TrackEditRelate+136Fj
		les	bx, g_ppTrakdata14
		mov	es:[bx+si+TrackInfo.pTrackData], 0
		inc	si
		cmp	si, 384h	; 0x384	= 900, track/terrain size = 900!
		jl	short loc_1A2B_136E
		mov	al, [bp+var_C]
		add	al, 30h	; '0'
		mov	byte ptr aTer0+3, al
		mov	ax, offset aTer0 ; "ter0"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	AltLocateShape	; terX are 901 byte chunks
		add	sp, 6
		mov	word ptr [bp+var_10], ax
		mov	word ptr [bp+var_10+2],	dx
		sub	si, si

loc_1A2B_139F:				; CODE XREF: TrackEditRelate+13A5j
		les	bx, [bp+var_10]
		mov	al, es:[bx+si]
		les	bx, g_ppTrakdata15
		mov	es:[bx+si], al
		inc	si
		cmp	si, 385h
		jl	short loc_1A2B_139F
		mov	g_gameInfo.pcTrackName,	0

loc_1A2B_13B8:				; CODE XREF: TrackEditRelate+1307j
		inc	[bp+var_32]
		mov	[bp+var_D4], 1
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_13C4:				; CODE XREF: TrackEditRelate+1311j
					; TrackEditRelate+131Bj
		cmp	[bp+var_17F], 8
		jz	short loc_1A2B_13CE
		jmp	loc_1A2B_14AC
; ---------------------------------------------------------------------------

loc_1A2B_13CE:				; CODE XREF: TrackEditRelate+13BDj
		cmp	[bp+var_18D], 0
		jz	short loc_1A2B_13D8
		jmp	loc_1A2B_14AC
; ---------------------------------------------------------------------------

loc_1A2B_13D8:				; CODE XREF: TrackEditRelate+13C7j
		call	SetSprite2As1_2
		cmp	[bp+var_D4], 0
		jz	short loc_1A2B_141E
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aChl	; "chl"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes	; Track	has been changed, save first, load new track
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	si, ax
		or	si, si
		jnz	short loc_1A2B_141E
		jmp	loc_1A2B_14B6
; ---------------------------------------------------------------------------

loc_1A2B_141E:				; CODE XREF: TrackEditRelate+13D6j
					; TrackEditRelate+140Dj
		mov	si, 1
		mov	g_bSaveDelFlag,	1
		inc	[bp+var_32]
		mov	ax, offset aTrk_0 ; "trk"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes	; "Track"
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset a_trk_3 ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	TakesTrackNames
		add	sp, 0Ah
		cbw
		mov	si, ax
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_trk_4 ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	CombineFilePath
		add	sp, 8
		or	si, si
		jg	short loc_1A2B_1475
		jmp	loc_1A2B_15EB
; ---------------------------------------------------------------------------

loc_1A2B_1475:				; CODE XREF: TrackEditRelate+1464j
		push	word ptr g_ppTrakdata14+2
		push	word ptr g_ppTrakdata14
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	LoadBinaryFile
		add	sp, 6
		call	SetupTrack
		mov	[bp+var_34], 0
		mov	al, g_cStartRow
		mov	[bp+cStartRow],	al
		mov	al, g_cStartCol
		mov	[bp+cStartCol],	al
		mov	[bp+var_D4], 0
		inc	[bp+var_32]
		jmp	loc_1A2B_15EB
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_14AC:				; CODE XREF: TrackEditRelate+13BFj
					; TrackEditRelate+13C9j
		cmp	[bp+var_18D], 0
		jz	short loc_1A2B_14B6
		jmp	loc_1A2B_15F4
; ---------------------------------------------------------------------------

loc_1A2B_14B6:				; CODE XREF: TrackEditRelate+140Fj
					; TrackEditRelate+14A5j ...
		mov	[bp+var_176], 0
		mov	g_bSaveDelFlag,	1
		jmp	loc_1A2B_15E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_14C4:				; CODE XREF: TrackEditRelate+15DCj
		call	SetSprite2As1_2
		inc	[bp+var_32]
		mov	ax, offset aTrk_1 ; "trk"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes	; "Track"
		add	sp, 6
		push	dx
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	SavResRender
		add	sp, 8
		or	al, al
		jz	short loc_1A2B_155D
		mov	ax, offset g_pcFullTrackPa
		push	ax
		mov	ax, offset a_trk_5 ; ".trk"
		push	ax
		mov	ax, offset g_gameInfo.pcTrackName
		push	ax
		mov	ax, offset g_pcData20Trak1
		push	ax
		call	CombineFilePath
		add	sp, 8
		mov	[bp+var_176], 1
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	FindFileName
		add	sp, 2
		or	ax, ax
		jz	short loc_1A2B_1562
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aFex_0 ; "fex"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes	; "File	Exists!	Rename | Save"
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	si, ax
		cmp	si, 0FFFFh
		jnz	short loc_1A2B_15D0

loc_1A2B_155D:				; CODE XREF: TrackEditRelate+14E8j
		mov	[bp+var_176], 0FFh

loc_1A2B_1562:				; CODE XREF: TrackEditRelate+1515j
					; TrackEditRelate+15C6j ...
		cmp	[bp+var_176], 1
		jnz	short loc_1A2B_15E1
		mov	ax, 70Ah
		cwd
		push	dx
		push	ax
		push	word ptr g_ppTrakdata14+2
		push	word ptr g_ppTrakdata14
		mov	ax, offset g_pcFullTrackPa
		push	ax
		call	SaveAndDelFile
		add	sp, 0Ah
		mov	si, ax
		or	si, si
		jnz	short loc_1A2B_1595
		mov	ax, 1
		push	ax
		call	DoHighScore
		add	sp, 2

loc_1A2B_1595:				; CODE XREF: TrackEditRelate+157Bj
		or	si, si
		jz	short loc_1A2B_15DC
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aSer_0 ; "ser"
		push	ax
		push	g_wMainRes2
		push	g_wMainRes1
		call	LocateTextRes	; "File	Save Error"
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	[bp+var_176], 0
		jmp	short loc_1A2B_15E1
; ---------------------------------------------------------------------------

loc_1A2B_15D0:				; CODE XREF: TrackEditRelate+154Fj
		or	si, si
		jnz	short loc_1A2B_1562
		mov	[bp+var_176], 0
		jmp	short loc_1A2B_1562
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_15DC:				; CODE XREF: TrackEditRelate+158Bj
		mov	[bp+var_D4], 0

loc_1A2B_15E1:				; CODE XREF: TrackEditRelate+14B4j
					; TrackEditRelate+155Bj ...
		cmp	[bp+var_176], 0
		jnz	short loc_1A2B_15EB
		jmp	loc_1A2B_14C4
; ---------------------------------------------------------------------------

loc_1A2B_15EB:				; CODE XREF: TrackEditRelate+1466j
					; TrackEditRelate+149Cj ...
		mov	g_bSaveDelFlag,	0
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_15F4:				; CODE XREF: TrackEditRelate+14A7j
		cmp	[bp+var_D4], 0
		jz	short loc_1A2B_1635
		sub	ax, ax
		push	ax
		push	ax
		push	g_wDialogArg1
		mov	ax, 0FFFFh
		push	ax
		push	ax
		mov	ax, offset aChx	; "chx"
		push	ax
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	LocateTextRes	; Track	has been changed]}[Save	First[Exit Editor]
		add	sp, 6
		push	dx
		push	ax
		mov	ax, 1
		push	ax
		mov	ax, 2
		push	ax
		call	DoDialog
		add	sp, 12h
		mov	si, ax
		or	si, si
		jnz	short loc_1A2B_1635
		jmp	loc_1A2B_14B6
; ---------------------------------------------------------------------------

loc_1A2B_1635:				; CODE XREF: TrackEditRelate+15EDj
					; TrackEditRelate+1624j
		mov	[bp+var_188], 0
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_163E:				; CODE XREF: TrackEditRelate+11E4j
		cmp	[bp+var_C6], 0
		jz	short loc_1A2B_1648
		jmp	loc_1A2B_16DE
; ---------------------------------------------------------------------------

loc_1A2B_1648:				; CODE XREF: TrackEditRelate+1637j
		mov	al, [bp+var_DA]
		cmp	[bp+cStartCol],	al
		jnz	short loc_1A2B_1678
		mov	al, [bp+var_C0]
		cmp	[bp+cStartRow],	al
		jnz	short loc_1A2B_1678
		mov	al, [bp+var_190]
		mov	[bp+var_1C], al
		mov	al, [bp+var_192]
		mov	[bp+var_190], al
		mov	al, [bp+var_1C]
		mov	[bp+var_192], al
		inc	[bp+var_A]
		jmp	short loc_1A2B_16AB
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1678:				; CODE XREF: TrackEditRelate+1644j
					; TrackEditRelate+164Ej
		mov	al, [bp+cStartRow]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+cStartCol]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx]
		mov	[bp+var_192], al
		mov	al, [bp+cStartCol]
		mov	[bp+var_DA], al
		mov	al, [bp+cStartRow]
		mov	[bp+var_C0], al

loc_1A2B_16AB:				; CODE XREF: TrackEditRelate+1669j
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, [bp+var_190]
		mov	es:[bx], al
		mov	[bp+var_D4], 1
		mov	[bp+var_30], 1
		inc	[bp+var_32]
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_16DE:				; CODE XREF: TrackEditRelate+1639j
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 1
		jz	short loc_1A2B_1701
		cmp	[bp+cStartRow],	1Ch
		jle	short loc_1A2B_1701
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1701:				; CODE XREF: TrackEditRelate+16E9j
					; TrackEditRelate+16F0j
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		test	g_sceneShapes.cTranslateFlag[bx], 2
		jz	short loc_1A2B_1724
		cmp	[bp+cStartCol],	1Ch
		jle	short loc_1A2B_1724
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1724:				; CODE XREF: TrackEditRelate+170Cj
					; TrackEditRelate+1713j
		mov	al, [bp+var_DA]
		cmp	[bp+cStartCol],	al
		jnz	short loc_1A2B_1754
		mov	al, [bp+var_C0]
		cmp	[bp+cStartRow],	al
		jnz	short loc_1A2B_1754
		mov	al, [bp+var_190]
		mov	[bp+var_1C], al
		mov	al, [bp+var_192]
		mov	[bp+var_190], al
		mov	al, [bp+var_1C]
		mov	[bp+var_192], al
		inc	[bp+var_A]
		jmp	short loc_1A2B_1790
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1754:				; CODE XREF: TrackEditRelate+1720j
					; TrackEditRelate+172Aj
		mov	al, [bp+cStartRow]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+cStartCol]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+TrackInfo.pTrackData]
		mov	[bp+var_192], al
		cmp	al, 0FDh ; 'ý'
		jb	short loc_1A2B_1780
		mov	[bp+var_192], 0

loc_1A2B_1780:				; CODE XREF: TrackEditRelate+176Dj
		mov	al, [bp+cStartCol]
		mov	[bp+var_DA], al
		mov	al, [bp+cStartRow]
		mov	[bp+var_C0], al

loc_1A2B_1790:				; CODE XREF: TrackEditRelate+1745j
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, [bp+var_190]
		mov	es:[bx+TrackInfo.pTrackData], al
		mov	[bp+var_D4], 1
		mov	[bp+var_30], 1
		inc	[bp+var_32]
		mov	al, [bp+var_190]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		cbw
		cmp	ax, 1
		jz	short loc_1A2B_17E8
		cmp	ax, 2
		jz	short loc_1A2B_180C
		cmp	ax, 3
		jz	short loc_1A2B_1830
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_17E8:				; CODE XREF: TrackEditRelate+17CDj
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, (g_wTrackRows+2)[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	es:[bx+TrackInfo.pTrackData], 0FEh ; 'þ'
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_180C:				; CODE XREF: TrackEditRelate+17D2j
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	es:[bx+(TrackInfo.pTrackData+1)], 0FFh
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------

loc_1A2B_1830:				; CODE XREF: TrackEditRelate+17D7j
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	es:[bx+(TrackInfo.pTrackData+1)], 0FFh
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, (g_wTrackRows+2)[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	es:[bx+TrackInfo.pTrackData], 0FEh ; 'þ'
		mov	al, [bp+var_C0]
		cbw
		mov	bx, ax
		shl	bx, 1
		mov	bx, (g_wTrackRows+2)[bx]
		mov	al, [bp+var_DA]
		cbw
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	es:[bx+(TrackInfo.pTrackData+1)], 0FDh ; 'ý'
		jmp	loc_1A2B_11E1
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1896:				; CODE XREF: TrackEditRelate+1B51j
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_18A4
		mov	[bp+var_17F], 0
		jmp	loc_1A2B_1A18
; ---------------------------------------------------------------------------

loc_1A2B_18A4:				; CODE XREF: TrackEditRelate+188Ej
		mov	al, [bp+var_18C]
		cmp	[bp+cStartRow],	al
		jnz	short loc_1A2B_18C0
		mov	al, [bp+var_8]
		cmp	[bp+cStartCol],	al
		jnz	short loc_1A2B_18C0
		mov	[bp+var_8], 0
		mov	[bp+var_18C], 0

loc_1A2B_18C0:				; CODE XREF: TrackEditRelate+18A0j
					; TrackEditRelate+18A9j
		mov	al, [bp+var_18C]
		mov	[bp+cStartRow],	al
		mov	al, [bp+var_8]
		mov	[bp+cStartCol],	al
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_18D2:				; CODE XREF: TrackEditRelate+1B59j
		mov	al, [bp+var_34]
		cbw
		add	ax, bp
		sub	ax, 180h
		mov	[bp+var_196], ax
		mov	bx, ax
		cmp	byte ptr [bx], 0
		jnz	short loc_1A2B_18E9
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_18E9:				; CODE XREF: TrackEditRelate+18D8j
		mov	[bp+var_DA], 0FFh
		dec	byte ptr [bx]
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_18F9
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_18F9:				; CODE XREF: TrackEditRelate+18E8j
		cmp	[bp+var_17F], 6
		jl	short loc_1A2B_1903
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1903:				; CODE XREF: TrackEditRelate+18F2j
		jmp	short loc_1A2B_1923
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1906:				; CODE XREF: TrackEditRelate+1944j
		mov	al, byte ptr [bp+var_196]
		mov	[bp+var_178], al
		cmp	al, 0FFh
		jnz	short loc_1A2B_1918
		dec	[bp+var_18D]
		jmp	short loc_1A2B_1923
; ---------------------------------------------------------------------------

loc_1A2B_1918:				; CODE XREF: TrackEditRelate+1904j
		cmp	[bp+var_178], 0FEh ; 'þ'
		jnz	short loc_1A2B_1923
		dec	[bp+var_17F]

loc_1A2B_1923:				; CODE XREF: TrackEditRelate:loc_1A2B_1903j
					; TrackEditRelate+190Aj ...
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	byte ptr [bp+var_196], al
		cmp	al, 0FEh ; 'þ'
		jnb	short loc_1A2B_1906
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1956:				; CODE XREF: TrackEditRelate+1B6Bj
		mov	al, [bp+var_34]
		cbw
		mov	[bp+var_196], ax
		mov	bx, ax
		mov	al, byte ptr unk_2B77_3590[bx]
		add	bx, bp
		cmp	[bx-180h], al
		jb	short loc_1A2B_196F
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_196F:				; CODE XREF: TrackEditRelate+195Ej
		mov	[bp+var_DA], 0FFh
		mov	bx, [bp+var_196]
		add	bx, bp
		inc	byte ptr [bx-180h]
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_1987
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1987:				; CODE XREF: TrackEditRelate+1976j
		cmp	[bp+var_17F], 6
		jl	short loc_1A2B_1991
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1991:				; CODE XREF: TrackEditRelate+1980j
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	[bp+var_178], al
		cmp	al, 0FFh
		jnz	short loc_1A2B_19C8
		dec	[bp+var_18D]
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_19C8:				; CODE XREF: TrackEditRelate+19B2j
		cmp	[bp+var_178], 0FEh ; 'þ'
		jz	short loc_1A2B_19D2
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_19D2:				; CODE XREF: TrackEditRelate+19C1j
		inc	[bp+var_17F]
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_19DA:				; CODE XREF: TrackEditRelate+1B47j
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_19EA
		cmp	[bp+var_17F], 6
		jnz	short loc_1A2B_19EA
		jmp	loc_1A2B_1108
; ---------------------------------------------------------------------------

loc_1A2B_19EA:				; CODE XREF: TrackEditRelate+19D2j
					; TrackEditRelate+19D9j
		mov	al, [bp+var_34]
		cbw
		add	ax, bp
		sub	ax, 18Eh
		mov	[bp+var_196], ax
		mov	bx, ax
		cmp	byte ptr [bx], 0
		jnz	short loc_1A2B_1A01
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1A01:				; CODE XREF: TrackEditRelate+19F0j
		mov	[bp+var_DA], 0FFh
		dec	byte ptr [bx]
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_1A11
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1A11:				; CODE XREF: TrackEditRelate+1A00j
		cmp	[bp+var_17F], 5
		jle	short loc_1A2B_1A3D

loc_1A2B_1A18:				; CODE XREF: TrackEditRelate+1895j
		mov	[bp+var_18D], 0
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1A20:				; CODE XREF: TrackEditRelate+1A5Ej
		mov	al, byte ptr [bp+var_196]
		mov	[bp+var_178], al
		cmp	al, 0FFh
		jnz	short loc_1A2B_1A32
		dec	[bp+var_18D]
		jmp	short loc_1A2B_1A3D
; ---------------------------------------------------------------------------

loc_1A2B_1A32:				; CODE XREF: TrackEditRelate+1A1Ej
		cmp	[bp+var_178], 0FEh ; 'þ'
		jnz	short loc_1A2B_1A3D
		dec	[bp+var_17F]

loc_1A2B_1A3D:				; CODE XREF: TrackEditRelate+1A0Aj
					; TrackEditRelate+1A24j ...
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	byte ptr [bp+var_196], al
		cmp	al, 0FEh ; 'þ'
		jnb	short loc_1A2B_1A20
		jmp	loc_1A2B_1B8A
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1A70:				; CODE XREF: TrackEditRelate+1B63j
		cmp	[bp+var_34], 0
		jz	short loc_1A2B_1A80
		cmp	[bp+var_17F], 6
		jnz	short loc_1A2B_1A80
		jmp	loc_1A2B_111A
; ---------------------------------------------------------------------------

loc_1A2B_1A80:				; CODE XREF: TrackEditRelate+1A68j
					; TrackEditRelate+1A6Fj
		mov	[bp+var_178], 1
		cmp	[bp+var_34], 0
		jnz	short loc_1A2B_1A8E
		jmp	loc_1A2B_1B18
; ---------------------------------------------------------------------------

loc_1A2B_1A8E:				; CODE XREF: TrackEditRelate+1A7Dj
		cmp	[bp+var_17F], 5
		jle	short loc_1A2B_1AEB
		mov	[bp+var_178], 3
		jmp	short loc_1A2B_1B18
; ---------------------------------------------------------------------------
		nop
		nop

loc_1A2B_1A9E:				; CODE XREF: TrackEditRelate+1B0Aj
		mov	al, [bp+var_17F]
		cbw
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, 24h	; '$'
		imul	[bp+var_C6]
		add	bx, ax
		mov	al, [bp+var_18D]
		cbw
		add	bx, ax
		add	bx, [bp+var_196]
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx]
		mov	byte ptr [bp+var_198], al
		cmp	al, 0FEh ; 'þ'
		jb	short loc_1A2B_1B18
		mov	[bp+var_186], al
		cmp	al, 0FFh
		jnz	short loc_1A2B_1AE0
		inc	[bp+var_178]
		jmp	short loc_1A2B_1AEB
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1AE0:				; CODE XREF: TrackEditRelate+1ACBj
		cmp	[bp+var_186], 0FEh ; 'þ'
		jnz	short loc_1A2B_1AEB
		dec	[bp+var_17F]

loc_1A2B_1AEB:				; CODE XREF: TrackEditRelate+1A87j
					; TrackEditRelate+1AD1j ...
		mov	al, [bp+var_178]
		sub	ah, ah
		mov	[bp+var_196], ax
		mov	al, [bp+var_34]
		cbw
		mov	[bp+var_194], ax
		mov	bx, ax
		add	bx, bp
		mov	al, [bx-18Eh]
		cbw
		add	ax, [bp+var_196]
		mov	bx, [bp+var_194]
		mov	cl, byte ptr unk_2B77_358E[bx]
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_1A2B_1A9E

loc_1A2B_1B18:				; CODE XREF: TrackEditRelate+1A7Fj
					; TrackEditRelate+1A8Ej ...
		mov	al, [bp+var_34]
		cbw
		mov	[bp+var_198], ax
		mov	bx, ax
		add	bx, bp
		mov	al, [bx-18Eh]
		cbw
		mov	cl, [bp+var_178]
		sub	ch, ch
		add	ax, cx
		mov	bx, [bp+var_198]
		mov	cl, byte ptr unk_2B77_358E[bx]
		cmp	ax, cx
		jnb	short loc_1A2B_1B8A
		mov	[bp+var_DA], 0FFh
		add	bx, bp
		mov	al, [bp+var_178]
		add	[bx-18Eh], al
		jmp	short loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1B4E:				; CODE XREF: TrackEditRelate+10D1j
		cmp	ax, 4B00h
		jnz	short loc_1A2B_1B56
		jmp	loc_1A2B_19DA
; ---------------------------------------------------------------------------

loc_1A2B_1B56:				; CODE XREF: TrackEditRelate+1B45j
		ja	short loc_1A2B_1B6A
		cmp	ax, 4700h
		jnz	short loc_1A2B_1B60
		jmp	loc_1A2B_1896
; ---------------------------------------------------------------------------

loc_1A2B_1B60:				; CODE XREF: TrackEditRelate+1B4Fj
		cmp	ax, 4800h
		jnz	short loc_1A2B_1B68
		jmp	loc_1A2B_18D2
; ---------------------------------------------------------------------------

loc_1A2B_1B68:				; CODE XREF: TrackEditRelate+1B57j
		jmp	short loc_1A2B_1B8A
; ---------------------------------------------------------------------------

loc_1A2B_1B6A:				; CODE XREF: TrackEditRelate:loc_1A2B_1B56j
		cmp	ax, 4D00h
		jnz	short loc_1A2B_1B72
		jmp	loc_1A2B_1A70
; ---------------------------------------------------------------------------

loc_1A2B_1B72:				; CODE XREF: TrackEditRelate+1B61j
		cmp	ax, 5000h
		jnz	short loc_1A2B_1B7A
		jmp	loc_1A2B_1956
; ---------------------------------------------------------------------------

loc_1A2B_1B7A:				; CODE XREF: TrackEditRelate+1B69j
		cmp	ax, 5200h
		jnz	short loc_1A2B_1B82
		jmp	loc_1A2B_1100
; ---------------------------------------------------------------------------

loc_1A2B_1B82:				; CODE XREF: TrackEditRelate+1B71j
		cmp	ax, 5400h
		jnz	short loc_1A2B_1B8A
		jmp	loc_1A2B_112C
; ---------------------------------------------------------------------------

loc_1A2B_1B8A:				; CODE XREF: TrackEditRelate+10F0j
					; TrackEditRelate+10F8j ...
		cmp	[bp+var_188], 0
		jz	short loc_1A2B_1B94
		jmp	loc_1A2B_470
; ---------------------------------------------------------------------------

loc_1A2B_1B94:				; CODE XREF: TrackEditRelate+1B83j
		push	word ptr g_pWndSprite+2
		push	word ptr g_pWndSprite
		call	ReleaseWindow
		add	sp, 4
		push	[bp+var_164]
		push	[bp+var_166]
		call	ReleaseWindow
		add	sp, 4
		push	[bp+var_168]
		push	[bp+var_16A]
		call	ReleaseWindow
		add	sp, 4
		push	[bp+var_16C]
		push	[bp+var_16E]
		call	ReleaseWindow
		add	sp, 4
		push	[bp+var_170]
		push	[bp+var_172]
		call	ReleaseWindow
		add	sp, 4
		push	[bp+pTeditRes2]
		push	[bp+pTeditRes1]
		call	DoUnloadResourc
		add	sp, 4
		push	[bp+var_28]
		push	[bp+var_2A]
		call	UnloadResource
		add	sp, 4
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TrackEditRelate	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1A2B_1C06	proc far		; CODE XREF: TrackEditRelate+5F7p

var_6		= byte ptr -6
var_4		= byte ptr -4
var_2		= byte ptr -2
arg_0		= byte ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		mov	[bp+var_2], 0
		jmp	loc_1A2B_1DE5
; ---------------------------------------------------------------------------

loc_1A2B_1C14:				; CODE XREF: sub_1A2B_1C06+133j
		cmp	[bp+var_6], 0FDh ; 'ý'
		jb	short loc_1A2B_1C1D
		jmp	loc_1A2B_1CFC
; ---------------------------------------------------------------------------

loc_1A2B_1C1D:				; CODE XREF: sub_1A2B_1C06+12j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		push	ax
		push	word_2B77_70CE
		push	word_2B77_70CC
		call	sub_1EA2_5310
		add	sp, 8
		mov	al, [bp+var_6]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		cbw
		cmp	ax, 1
		jz	short loc_1A2B_1C72
		cmp	ax, 2
		jnz	short loc_1A2B_1C68
		jmp	loc_1A2B_1D6A
; ---------------------------------------------------------------------------

loc_1A2B_1C68:				; CODE XREF: sub_1A2B_1C06+5Dj
		cmp	ax, 3
		jnz	short loc_1A2B_1C70
		jmp	loc_1A2B_1D84
; ---------------------------------------------------------------------------

loc_1A2B_1C70:				; CODE XREF: sub_1A2B_1C06+65j
		jmp	short loc_1A2B_1C9A
; ---------------------------------------------------------------------------

loc_1A2B_1C72:				; CODE XREF: sub_1A2B_1C06+58j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 34h	; '4'
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'

loc_1A2B_1C89:				; CODE XREF: sub_1A2B_1C06+17Bj
		push	ax
		push	word_2B77_70CE
		push	word_2B77_70CC
		call	sub_1EA2_5310
		add	sp, 8

loc_1A2B_1C9A:				; CODE XREF: sub_1A2B_1C06:loc_1A2B_1C70j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		push	ax
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	sub_1EA2_4FFE
		add	sp, 8
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		push	ax
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6AEA[bx]
		push	word ptr unk_2B77_6AE8[bx]
		call	sub_1EA2_57F2

loc_1A2B_1CF9:				; CODE XREF: sub_1A2B_1C06+161j
		add	sp, 8

loc_1A2B_1CFC:				; CODE XREF: sub_1A2B_1C06+14j
		inc	[bp+var_4]

loc_1A2B_1CFF:				; CODE XREF: sub_1A2B_1C06+1E9j
		cmp	[bp+var_4], 6
		jb	short loc_1A2B_1D08
		jmp	loc_1A2B_1DE2
; ---------------------------------------------------------------------------

loc_1A2B_1D08:				; CODE XREF: sub_1A2B_1C06+FDj
		mov	al, [bp+var_4]
		sub	ah, ah
		mov	si, ax
		mov	al, [bp+var_2]
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		mov	cx, ax
		mov	al, 24h	; '$'
		mul	[bp+arg_0]
		mov	bx, ax
		add	bx, cx
		add	bx, word_2B77_6DD0
		mov	es, word_2B77_6DD2
		mov	al, es:[bx+si]
		mov	[bp+var_6], al
		cmp	[bp+arg_0], 0
		jz	short loc_1A2B_1D3C
		jmp	loc_1A2B_1C14
; ---------------------------------------------------------------------------

loc_1A2B_1D3C:				; CODE XREF: sub_1A2B_1C06+131j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		push	ax
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	sub_1EA2_5310
		jmp	short loc_1A2B_1CF9
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1D6A:				; CODE XREF: sub_1A2B_1C06+5Fj
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'

loc_1A2B_1D76:				; CODE XREF: sub_1A2B_1C06+1DAj
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0ECh ; 'ì'
		jmp	loc_1A2B_1C89
; ---------------------------------------------------------------------------

loc_1A2B_1D84:				; CODE XREF: sub_1A2B_1C06+67j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 24h	; '$'
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0ECh ; 'ì'
		push	ax
		push	word_2B77_70CE
		push	word_2B77_70CC
		call	sub_1EA2_5310
		add	sp, 8
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 34h	; '4'
		push	ax
		mov	al, [bp+var_4]
		sub	ah, ah
		shl	ax, cl
		add	ax, 0DCh ; 'Ü'
		push	ax
		push	word_2B77_70CE
		push	word_2B77_70CC
		call	sub_1EA2_5310
		add	sp, 8
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cl, 4
		shl	ax, cl
		add	ax, 34h	; '4'
		jmp	short loc_1A2B_1D76
; ---------------------------------------------------------------------------

loc_1A2B_1DE2:				; CODE XREF: sub_1A2B_1C06+FFj
		inc	[bp+var_2]

loc_1A2B_1DE5:				; CODE XREF: sub_1A2B_1C06+Bj
		cmp	[bp+var_2], 6
		jnb	short loc_1A2B_1DF2
		mov	[bp+var_4], 0
		jmp	loc_1A2B_1CFF
; ---------------------------------------------------------------------------

loc_1A2B_1DF2:				; CODE XREF: sub_1A2B_1C06+1E3j
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_1A2B_1C06	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoTrakdata15_14	proc far		; CODE XREF: TrackEditRelate+6F5p

var_E		= word ptr -0Eh
var_C		= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_8		= byte ptr -8
var_6		= byte ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= byte ptr  6
arg_2		= byte ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		mov	[bp+var_6], 0
		jmp	loc_1A2B_2547
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_1E08:				; CODE XREF: DoTrakdata15_14+619j
					; DoTrakdata15_14+622j
		cmp	[bp+var_C], 0FEh ; 'þ'
		jz	short loc_1A2B_1E11
		jmp	loc_1A2B_1F6A
; ---------------------------------------------------------------------------

loc_1A2B_1E11:				; CODE XREF: DoTrakdata15_14+14j
		cmp	[bp+var_6], 0
		jz	short loc_1A2B_1E1A
		jmp	loc_1A2B_1F6A
; ---------------------------------------------------------------------------

loc_1A2B_1E1A:				; CODE XREF: DoTrakdata15_14+1Dj
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 18h
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx+1]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		sub	ax, 0Ch
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	bl, es:[bx+TrackInfo.pTrackData]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	MaybePutImageAnd
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		sub	ax, 0Ch
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	bl, es:[bx]

loc_1A2B_1F51:				; CODE XREF: DoTrakdata15_14+272j
					; DoTrakdata15_14+46Bj
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6AEA[bx]
		push	word ptr unk_2B77_6AE8[bx]
		call	MaybePutImageOr

loc_1A2B_1F64:				; CODE XREF: DoTrakdata15_14+3CDj
		add	sp, 8
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_1F6A:				; CODE XREF: DoTrakdata15_14+16j
					; DoTrakdata15_14+1Fj
		cmp	[bp+var_C], 0FDh ; 'ý'
		jz	short loc_1A2B_1F73
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_1F73:				; CODE XREF: DoTrakdata15_14+176j
		cmp	[bp+var_6], 0
		jz	short loc_1A2B_1F7C
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_1F7C:				; CODE XREF: DoTrakdata15_14+17Fj
		cmp	[bp+var_8], 0
		jz	short loc_1A2B_1F85
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_1F85:				; CODE XREF: DoTrakdata15_14+188j
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		sub	ax, 0Ch
		push	ax
		mov	ax, si
		shl	ax, cl
		sub	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	bl, es:[bx-1]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	MaybePutImageAnd
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		sub	ax, 0Ch
		push	ax
		mov	ax, si
		shl	ax, cl
		sub	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]

loc_1A2B_2055:				; CODE XREF: DoTrakdata15_14+748j
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	bl, es:[bx-1]
		jmp	loc_1A2B_1F51
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_206E:				; CODE XREF: DoTrakdata15_14+5FAj
					; DoTrakdata15_14+607j
		cmp	[bp+var_C], 0
		jnz	short loc_1A2B_20D2
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_4]
		cmp	byte ptr [bx+si], 0
		jnz	short loc_1A2B_208C
		mov	si, [bp+arg_6]
		mov	al, [bp+var_A]
		cmp	[bx+si], al
		jnz	short loc_1A2B_208C
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_208C:				; CODE XREF: DoTrakdata15_14+285j
					; DoTrakdata15_14+28Fj
		mov	al, [bp+var_6]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	al, [bp+var_8]
		cbw
		shl	ax, cl
		add	ax, 8
		push	ax

loc_1A2B_20A2:
		mov	bl, [bp+var_A]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	sub_1EA2_5310
		add	sp, 8
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_4]
		mov	byte ptr [bx+si], 0
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_6]
		mov	al, [bp+var_A]
		mov	[bx+si], al
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_20D2:				; CODE XREF: DoTrakdata15_14+27Aj
		cmp	[bp+var_C], 0FDh ; 'ý'
		jb	short loc_1A2B_20DB
		jmp	loc_1A2B_237C
; ---------------------------------------------------------------------------

loc_1A2B_20DB:				; CODE XREF: DoTrakdata15_14+2DEj
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_4]
		mov	al, [bp+var_C]
		cmp	[bx+si], al
		jnz	short loc_1A2B_20F5
		mov	si, [bp+arg_6]
		mov	al, [bp+var_A]
		cmp	[bx+si], al
		jnz	short loc_1A2B_20F5
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------

loc_1A2B_20F5:				; CODE XREF: DoTrakdata15_14+2EEj
					; DoTrakdata15_14+2F8j
		mov	si, [bp+arg_4]
		mov	al, [bp+var_C]
		mov	[bx+si], al
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_6]
		mov	al, [bp+var_A]
		mov	[bx+si], al
		mov	al, [bp+var_6]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	al, [bp+var_8]
		cbw
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+var_A]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	sub_1EA2_5310
		add	sp, 8
		mov	al, [bp+var_C]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		cbw
		or	ax, ax
		jz	short loc_1A2B_216A
		cmp	ax, 1
		jz	short loc_1A2B_21C8
		cmp	ax, 2
		jnz	short loc_1A2B_215E
		jmp	loc_1A2B_2266
; ---------------------------------------------------------------------------

loc_1A2B_215E:				; CODE XREF: DoTrakdata15_14+361j
		cmp	ax, 3
		jnz	short loc_1A2B_2166
		jmp	loc_1A2B_22A8
; ---------------------------------------------------------------------------

loc_1A2B_2166:				; CODE XREF: DoTrakdata15_14+369j
		jmp	loc_1A2B_238E
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_216A:				; CODE XREF: DoTrakdata15_14+357j
		mov	al, [bp+var_6]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	al, [bp+var_8]
		cbw
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+var_C]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	sub_1EA2_4FFE
		add	sp, 8
		mov	al, [bp+var_6]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	al, [bp+var_8]
		cbw
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+var_C]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6AEA[bx]
		push	word ptr unk_2B77_6AE8[bx]
		call	sub_1EA2_57F2
		jmp	loc_1A2B_1F64
; ---------------------------------------------------------------------------

loc_1A2B_21C8:				; CODE XREF: DoTrakdata15_14+35Cj
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 14h
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, (g_wTerrainRows+2)[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx]

loc_1A2B_2205:				; CODE XREF: DoTrakdata15_14+4ACj
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_6]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	al, [bp+var_8]
		cbw
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+var_C]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	MaybePutImageAnd
		add	sp, 8
		mov	al, [bp+var_6]
		cbw
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	al, [bp+var_8]
		cbw
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+var_C]
		jmp	loc_1A2B_1F51
; ---------------------------------------------------------------------------

loc_1A2B_2266:				; CODE XREF: DoTrakdata15_14+363j
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 18h
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]

loc_1A2B_228F:				; CODE XREF: DoTrakdata15_14+580j
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx+1]
		jmp	loc_1A2B_2205
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_22A8:				; CODE XREF: DoTrakdata15_14+36Bj
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 18h
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx+1]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 14h
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, (g_wTerrainRows+2)[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 14h
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 18h
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, (g_wTerrainRows+2)[bx]
		jmp	loc_1A2B_228F
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_237C:				; CODE XREF: DoTrakdata15_14+2E0j
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_4]
		mov	byte ptr [bx+si], 0FFh
		mov	bx, [bp+var_4]
		mov	si, [bp+arg_6]
		mov	byte ptr [bx+si], 0FFh

loc_1A2B_238E:				; CODE XREF: DoTrakdata15_14+16Fj
					; DoTrakdata15_14+178j	...
		inc	[bp+var_8]

loc_1A2B_2391:				; CODE XREF: DoTrakdata15_14+76Aj
		cmp	[bp+var_8], 0Ch
		jl	short loc_1A2B_239A
		jmp	loc_1A2B_2544
; ---------------------------------------------------------------------------

loc_1A2B_239A:				; CODE XREF: DoTrakdata15_14+59Dj
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+arg_0]
		sub	ah, ah
		mov	di, ax
		mov	al, [bp+var_6]
		cbw
		mov	cl, [bp+arg_2]
		sub	ch, ch
		add	ax, cx
		shl	ax, 1
		mov	[bp+var_E], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, si
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+di+TrackInfo.pTrackData]
		mov	[bp+var_C], al
		mov	bx, [bp+var_E]
		mov	bx, g_wTerrainRows[bx]
		add	bx, si
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx+di]
		mov	[bp+var_A], al
		mov	ax, [bp+var_2]
		add	ax, si
		mov	[bp+var_4], ax
		cmp	[bp+var_C], 0FDh ; 'ý'
		jnb	short loc_1A2B_23F5
		jmp	loc_1A2B_206E
; ---------------------------------------------------------------------------

loc_1A2B_23F5:				; CODE XREF: DoTrakdata15_14+5F8j
		cmp	[bp+var_6], ch
		jz	short loc_1A2B_2402
		cmp	[bp+var_8], ch
		jz	short loc_1A2B_2402
		jmp	loc_1A2B_206E
; ---------------------------------------------------------------------------

loc_1A2B_2402:				; CODE XREF: DoTrakdata15_14+600j
					; DoTrakdata15_14+605j
		mov	bx, [bp+var_4]
		add	bx, [bp+arg_4]
		mov	byte ptr [bx], 0FFh
		cmp	[bp+var_C], 0FFh
		jz	short loc_1A2B_2414
		jmp	loc_1A2B_1E08
; ---------------------------------------------------------------------------

loc_1A2B_2414:				; CODE XREF: DoTrakdata15_14+617j
		cmp	[bp+var_8], 0
		jz	short loc_1A2B_241D
		jmp	loc_1A2B_1E08
; ---------------------------------------------------------------------------

loc_1A2B_241D:				; CODE XREF: DoTrakdata15_14+620j
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTerrainRows[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 14h
		push	ax
		mov	ax, si
		shl	ax, cl
		add	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, (g_wTerrainRows+2)[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	bl, es:[bx]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word_2B77_70CE[bx]
		push	word_2B77_70CC[bx]
		call	DoMaybePutImage
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		sub	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		add	bx, si
		mov	al, [bp+arg_0]
		sub	ah, ah
		add	bx, ax
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	bl, es:[bx-1]
		sub	bh, bh
		shl	bx, 1
		shl	bx, 1
		push	word ptr unk_2B77_6DD6[bx]
		push	word ptr unk_2B77_6DD4[bx]
		call	MaybePutImageAnd
		add	sp, 8
		mov	al, [bp+var_8]
		cbw
		mov	si, ax
		mov	al, [bp+var_6]
		cbw
		mov	di, ax
		mov	cl, 4
		shl	ax, cl
		add	ax, 4
		push	ax
		mov	ax, si
		shl	ax, cl
		sub	ax, 8
		push	ax
		mov	bl, [bp+arg_2]
		sub	bh, bh
		add	bx, di
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		jmp	loc_1A2B_2055
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2544:				; CODE XREF: DoTrakdata15_14+59Fj
		inc	[bp+var_6]

loc_1A2B_2547:				; CODE XREF: DoTrakdata15_14+Cj
		cmp	[bp+var_6], 0Bh
		jge	short loc_1A2B_2566
		mov	al, [bp+var_6]
		cbw
		mov	cx, ax
		shl	ax, 1
		add	ax, cx
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_2], ax
		mov	[bp+var_8], 0
		jmp	loc_1A2B_2391
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2566:				; CODE XREF: DoTrakdata15_14+753j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoTrakdata15_14	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoTrakdata14_15	proc far		; CODE XREF: TrackEditRelate+643p

var_A		= byte ptr -0Ah
var_8		= byte ptr -8
var_6		= byte ptr -6
var_4		= byte ptr -4
var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		push	cs
		call	near ptr TrackRelated
		mov	[bp+var_A], 0
		mov	[bp+var_6], 0
		jmp	loc_1A2B_26E3
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2584:				; CODE XREF: DoTrakdata14_15+141j
		cmp	[bp+var_4], 0FFh
		jnz	short loc_1A2B_2598
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		mov	si, g_wTrackRows[bx]
		jmp	short loc_1A2B_25CB
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2598:				; CODE XREF: DoTrakdata14_15+1Cj
		cmp	[bp+var_4], 0FEh ; 'þ'
		jnz	short loc_1A2B_25BA
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		mov	bx, word ptr byte_2B77_A5CE[bx]
		mov	al, [bp+var_2]
		sub	ah, ah
		add	bx, ax
		les	si, g_ppTrakdata14
		mov	al, es:[bx+si+TrackInfo.pTrackData]
		jmp	short loc_1A2B_25DA
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_25BA:				; CODE XREF: DoTrakdata14_15+30j
		cmp	[bp+var_4], 0FDh ; 'ý'
		jnz	short loc_1A2B_25DD
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		mov	si, word ptr byte_2B77_A5CE[bx]

loc_1A2B_25CB:				; CODE XREF: DoTrakdata14_15+29j
		mov	al, [bp+var_2]
		sub	ah, ah
		add	si, ax
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+si-1]

loc_1A2B_25DA:				; CODE XREF: DoTrakdata14_15+4Bj
		mov	[bp+var_4], al

loc_1A2B_25DD:				; CODE XREF: DoTrakdata14_15+52j
		mov	al, [bp+var_4]
		sub	ah, ah
		cmp	ax, 22h	; '"'
		jb	short loc_1A2B_2600
		cmp	ax, 23h	; '#'
		jbe	short loc_1A2B_2653
		cmp	ax, 67h	; 'g'
		jb	short loc_1A2B_2600
		cmp	ax, 6Ch	; 'l'
		jbe	short loc_1A2B_2653
		cmp	ax, 0ABh ; '«'
		jb	short loc_1A2B_2600
		cmp	ax, 0AEh ; '®'
		jbe	short loc_1A2B_2653

loc_1A2B_2600:				; CODE XREF: DoTrakdata14_15+79j
					; DoTrakdata14_15+83j ...
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_2]
		sub	ah, ah
		add	bx, ax
		les	si, g_ppTrakdata14
		mov	es:[bx+si+TrackInfo.pTrackData], ah
		mov	[bp+var_A], 0Ch
		jmp	short loc_1A2B_2653
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2620:				; CODE XREF: DoTrakdata14_15+14Ej
		mov	al, [bp+var_4]
		sub	ah, ah
		push	ax
		mov	al, [bp+var_8]
		push	ax
		call	MapTerrainTrack
		add	sp, 4
		or	al, al
		jnz	short loc_1A2B_2653
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_2]
		sub	ah, ah
		add	bx, ax
		les	si, g_ppTrakdata14
		mov	es:[bx+si+TrackInfo.pTrackData], ah
		mov	[bp+var_A], 0Dh

loc_1A2B_2653:				; CODE XREF: DoTrakdata14_15+7Ej
					; DoTrakdata14_15+88j ...
		inc	[bp+var_2]

loc_1A2B_2656:				; CODE XREF: DoTrakdata14_15+181j
		cmp	[bp+var_2], 1Eh
		jb	short loc_1A2B_265F
		jmp	loc_1A2B_26E0
; ---------------------------------------------------------------------------

loc_1A2B_265F:				; CODE XREF: DoTrakdata14_15+EEj
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	si, ax
		mov	al, [bp+var_6]
		mov	di, ax
		shl	di, 1
		mov	bx, g_wTerrainRows[di]
		add	bx, word ptr g_ppTrakdata15
		mov	es, word ptr g_ppTrakdata15+2
		mov	al, es:[bx+si]
		mov	[bp+var_8], al
		mov	bx, g_wTrackRows[di]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		mov	al, es:[bx+si+TrackInfo.pTrackData]
		mov	[bp+var_4], al
		cmp	al, ah
		jz	short loc_1A2B_2653
		cmp	[bp+var_8], ah
		jz	short loc_1A2B_2653
		cmp	[bp+var_8], 6
		jz	short loc_1A2B_2653
		mov	al, [bp+var_8]
		cmp	ax, 1
		jb	short loc_1A2B_26BD
		cmp	ax, 5
		ja	short loc_1A2B_26B0
		jmp	loc_1A2B_2584
; ---------------------------------------------------------------------------

loc_1A2B_26B0:				; CODE XREF: DoTrakdata14_15+13Fj
		cmp	ax, 7
		jb	short loc_1A2B_26BD
		cmp	ax, 0Ah
		ja	short loc_1A2B_26BD
		jmp	loc_1A2B_2620
; ---------------------------------------------------------------------------

loc_1A2B_26BD:				; CODE XREF: DoTrakdata14_15+13Aj
					; DoTrakdata14_15+147j	...
		mov	[bp+var_A], 0Eh
		mov	bl, [bp+var_6]
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_2]
		sub	ah, ah
		add	bx, ax
		mov	si, word ptr g_ppTrakdata14
		mov	es:[bx+si], ah
		jmp	loc_1A2B_2653
; ---------------------------------------------------------------------------
		align 4

loc_1A2B_26E0:				; CODE XREF: DoTrakdata14_15+F0j
		inc	[bp+var_6]

loc_1A2B_26E3:				; CODE XREF: DoTrakdata14_15+14j
		cmp	[bp+var_6], 1Eh
		jnb	short loc_1A2B_26F0
		mov	[bp+var_2], 0
		jmp	loc_1A2B_2656
; ---------------------------------------------------------------------------

loc_1A2B_26F0:				; CODE XREF: DoTrakdata14_15+17Bj
		cmp	[bp+var_A], 0
		jz	short loc_1A2B_26FA
		push	cs
		call	near ptr TrackRelated

loc_1A2B_26FA:				; CODE XREF: DoTrakdata14_15+188j
		mov	al, [bp+var_A]
		cbw
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoTrakdata14_15	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

TrackRelated	proc far		; CODE XREF: DoTrakdata14_15+9p
					; DoTrakdata14_15+18Bp

var_392		= dword	ptr -392h
var_38E		= word ptr -38Eh
var_38C		= byte ptr -38Ch
var_38A		= byte ptr -38Ah
var_388		= byte ptr -388h
var_384		= byte ptr -384h
var_383		= byte ptr -383h

		push	bp
		mov	bp, sp
		sub	sp, 392h
		push	di
		push	si
		sub	si, si

loc_1A2B_270F:				; CODE XREF: TrackRelated+15j
		mov	[bp+si+var_384], 0
		inc	si
		cmp	si, 384h	; 0x384	= 900 =	number of terrain/track	bytes
		jl	short loc_1A2B_270F
		mov	[bp+var_38C], 0
		jmp	loc_1A2B_298C
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2724:				; CODE XREF: TrackRelated+FAj
		mov	al, [bp+var_38A]
		sub	ah, ah
		mov	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		add	bx, ax
		shl	bx, 1
		mov	al, g_sceneShapes.cTranslateFlag[bx]
		cbw
		cmp	ax, 1
		jz	short loc_1A2B_2752
		cmp	ax, 2
		jnz	short loc_1A2B_2748
		jmp	loc_1A2B_280C
; ---------------------------------------------------------------------------

loc_1A2B_2748:				; CODE XREF: TrackRelated+3Fj
		cmp	ax, 3
		jnz	short loc_1A2B_2750
		jmp	loc_1A2B_2880
; ---------------------------------------------------------------------------

loc_1A2B_2750:				; CODE XREF: TrackRelated+47j
		jmp	short loc_1A2B_27C9
; ---------------------------------------------------------------------------

loc_1A2B_2752:				; CODE XREF: TrackRelated+3Aj
		mov	al, [bp+var_388]
		sub	ah, ah
		mov	di, ax
		mov	al, [bp+var_38C]
		shl	ax, 1
		mov	[bp+var_38E], ax
		mov	bx, ax
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, di
		add	bx, bp
		cmp	byte ptr [bx-384h], 0
		jz	short loc_1A2B_277A
		mov	bx, ax
		jmp	loc_1A2B_28CE
; ---------------------------------------------------------------------------

loc_1A2B_277A:				; CODE XREF: TrackRelated+6Fj
		mov	al, [bp+var_388]
		sub	ah, ah
		mov	di, ax
		mov	al, [bp+var_38C]
		shl	ax, 1
		mov	[bp+var_38E], ax
		mov	bx, ax
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		cmp	es:[bx+di+TrackInfo.pTrackData], 0FEh ;	'þ'
		jz	short loc_1A2B_27B0
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, word ptr g_ppTrakdata14

loc_1A2B_27AA:				; CODE XREF: TrackRelated+126j
					; TrackRelated+1D6j
		mov	es:[bx+di+TrackInfo.pTrackData], 0
		jmp	short loc_1A2B_27C9
; ---------------------------------------------------------------------------

loc_1A2B_27B0:				; CODE XREF: TrackRelated+9Aj
		mov	bl, [bp+var_38C]
		sub	bh, bh
		shl	bx, 1
		mov	di, (g_wTrackRows+2)[bx]
		mov	al, [bp+var_388]
		sub	ah, ah
		add	di, ax
		mov	[bp+di+var_384], 1

loc_1A2B_27C9:				; CODE XREF: TrackRelated:loc_1A2B_2750j
					; TrackRelated+AAj ...
		inc	[bp+var_388]

loc_1A2B_27CD:				; CODE XREF: TrackRelated+294j
		cmp	[bp+var_388], 1Eh
		jb	short loc_1A2B_27D7
		jmp	loc_1A2B_2988
; ---------------------------------------------------------------------------

loc_1A2B_27D7:				; CODE XREF: TrackRelated+CEj
		mov	bl, [bp+var_38C]
		sub	bh, bh
		shl	bx, 1
		mov	di, g_wTrackRows[bx]
		mov	al, [bp+var_388]
		sub	ah, ah
		add	di, ax
		les	bx, g_ppTrakdata14
		mov	al, es:[bx+di+TrackInfo.pTrackData]
		mov	[bp+var_38A], al
		cmp	al, ah
		jz	short loc_1A2B_27C9
		cmp	al, 0FDh ; 'ý'
		jnb	short loc_1A2B_2801
		jmp	loc_1A2B_2724
; ---------------------------------------------------------------------------

loc_1A2B_2801:				; CODE XREF: TrackRelated+F8j
		cmp	[bp+di+var_384], ah
		jnz	short loc_1A2B_27C9

loc_1A2B_2807:				; CODE XREF: TrackRelated+23Aj
		mov	es:[bx+di], ah
		jmp	short loc_1A2B_27C9
; ---------------------------------------------------------------------------

loc_1A2B_280C:				; CODE XREF: TrackRelated+41j
		mov	bl, [bp+var_38C]
		sub	bh, bh
		shl	bx, 1
		mov	di, g_wTrackRows[bx]
		mov	al, [bp+var_388]
		sub	ah, ah
		add	di, ax
		cmp	[bp+di+var_383], ah
		jz	short loc_1A2B_282E
		les	bx, g_ppTrakdata14
		jmp	loc_1A2B_27AA
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_282E:				; CODE XREF: TrackRelated+120j
		mov	bl, [bp+var_38C]
		sub	bh, bh
		shl	bx, 1
		mov	ax, g_wTrackRows[bx]
		mov	cl, [bp+var_388]
		sub	ch, ch
		add	ax, cx
		add	ax, word ptr g_ppTrakdata14
		mov	dx, word ptr g_ppTrakdata14+2
		mov	word ptr [bp+var_392], ax
		mov	word ptr [bp+var_392+2], dx
		les	bx, [bp+var_392]
		cmp	byte ptr es:[bx+1], 0FFh
		jz	short loc_1A2B_2864
		mov	es:[bx], ch
		jmp	loc_1A2B_27C9
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2864:				; CODE XREF: TrackRelated+157j
		mov	bl, [bp+var_38C]
		sub	bh, bh
		shl	bx, 1
		mov	di, g_wTrackRows[bx]
		mov	al, [bp+var_388]
		sub	ah, ah
		add	di, ax
		mov	[bp+di+var_383], 1
		jmp	loc_1A2B_27C9
; ---------------------------------------------------------------------------

loc_1A2B_2880:				; CODE XREF: TrackRelated+49j
		mov	al, [bp+var_388]
		sub	ah, ah
		mov	di, ax
		mov	al, [bp+var_38C]
		shl	ax, 1
		mov	word ptr [bp+var_392], ax
		mov	bx, ax
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, di
		add	bx, bp
		mov	al, [bx-383h]
		sub	ah, ah
		mov	bx, word ptr [bp+var_392]
		mov	bx, g_wTrackRows[bx]
		add	bx, di
		add	bx, bp
		mov	cl, [bx-383h]
		sub	ch, ch
		add	ax, cx
		mov	bx, word ptr [bp+var_392]
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, di
		add	bx, bp
		mov	cl, [bx-384h]
		add	ax, cx
		jz	short loc_1A2B_28DE
		mov	bx, word ptr [bp+var_392]

loc_1A2B_28CE:				; CODE XREF: TrackRelated+73j
		mov	bx, g_wTrackRows[bx]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		jmp	loc_1A2B_27AA
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_28DE:				; CODE XREF: TrackRelated+1C4j
		mov	al, [bp+var_388]
		sub	ah, ah
		mov	di, ax
		mov	al, [bp+var_38C]
		shl	ax, 1
		mov	word ptr [bp+var_392], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, word ptr g_ppTrakdata14
		mov	es, word ptr g_ppTrakdata14+2
		cmp	byte ptr es:[bx+di+1], 0FFh
		jnz	short loc_1A2B_2926
		mov	bx, ax
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, word ptr g_ppTrakdata14
		cmp	byte ptr es:[bx+di], 0FEh ; 'þ'
		jnz	short loc_1A2B_2926
		mov	bx, ax
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, word ptr g_ppTrakdata14
		cmp	byte ptr es:[bx+di+1], 0FDh ; 'ý'
		jz	short loc_1A2B_2942

loc_1A2B_2926:				; CODE XREF: TrackRelated+1FFj
					; TrackRelated+20Fj
		mov	bl, [bp+var_38C]
		sub	bh, bh
		shl	bx, 1
		mov	bx, g_wTrackRows[bx]
		mov	al, [bp+var_388]
		sub	ah, ah
		add	bx, ax
		mov	di, word ptr g_ppTrakdata14
		jmp	loc_1A2B_2807
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_2942:				; CODE XREF: TrackRelated+220j
		mov	al, [bp+var_388]
		sub	ah, ah
		mov	di, ax
		mov	al, [bp+var_38C]
		shl	ax, 1
		mov	word ptr [bp+var_392], ax
		mov	bx, ax
		mov	bx, g_wTrackRows[bx]
		add	bx, di
		add	bx, bp
		mov	byte ptr [bx-383h], 1
		mov	bx, word ptr [bp+var_392]
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, di
		add	bx, bp
		mov	byte ptr [bx-384h], 1
		mov	bx, word ptr [bp+var_392]
		mov	bx, (g_wTrackRows+2)[bx]
		add	bx, di
		add	bx, bp
		mov	byte ptr [bx-383h], 1
		jmp	loc_1A2B_27C9
; ---------------------------------------------------------------------------

loc_1A2B_2988:				; CODE XREF: TrackRelated+D0j
		inc	[bp+var_38C]

loc_1A2B_298C:				; CODE XREF: TrackRelated+1Cj
		cmp	[bp+var_38C], 1Eh
		jnb	short loc_1A2B_299C
		mov	[bp+var_388], 0
		jmp	loc_1A2B_27CD
; ---------------------------------------------------------------------------
		align 2

loc_1A2B_299C:				; CODE XREF: TrackRelated+28Dj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
TrackRelated	endp

seg009		ends

; ===========================================================================

; Segment type:	Pure code
seg010		segment	byte public 'CODE' use16
		assume cs:seg010
		;org 2
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		db 10h dup(0)
		assume ss:seg041, ds:nothing
; [0000018A BYTES: COLLAPSED FUNCTION start. PRESS KEYPAD "+" TO EXPAND]
; [00000017 BYTES: COLLAPSED FUNCTION libsub_1CC5_19C. PRESS KEYPAD "+"	TO EXPAND]
; [00000047 BYTES: COLLAPSED FUNCTION libsub_1CC5_1B3. PRESS KEYPAD "+"	TO EXPAND]
; [0000002D BYTES: COLLAPSED FUNCTION libsub_1CC5_1FA. PRESS KEYPAD "+"	TO EXPAND]
; [00000013 BYTES: COLLAPSED FUNCTION libsub_1CC5_227. PRESS KEYPAD "+"	TO EXPAND]
; ---------------------------------------------------------------------------

loc_1CC5_23A:				; CODE XREF: start+28P	start+B2P ...
		push	bp
		mov	bp, sp
		mov	ax, 0FCh ; 'ü'
		push	ax
		call	__NMSG_WRITE
		cmp	word_2B77_36AE,	0
		jz	short loc_1CC5_251
		call	dword ptr unk_2B77_36AC

loc_1CC5_251:				; CODE XREF: seg010:024Bj
		mov	ax, 0FFh
		push	ax
		call	__NMSG_WRITE
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1CC5_25E:				; CODE XREF: start+106j
					; libsub_1CC5_EC0+53J ...
		mov	ax, 2
		jmp	__amsg_exit
; [00000024 BYTES: COLLAPSED FUNCTION __chkstk.	PRESS KEYPAD "+" TO EXPAND]
; [00000026 BYTES: COLLAPSED FUNCTION __nullcheck. PRESS KEYPAD	"+" TO EXPAND]
; [00000192 BYTES: COLLAPSED FUNCTION __setargv. PRESS KEYPAD "+" TO EXPAND]
; [0000006E BYTES: COLLAPSED FUNCTION __setenvp. PRESS KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION __NMSG_TEXT. PRESS KEYPAD	"+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION __NMSG_WRITE. PRESS KEYPAD "+" TO	EXPAND]
; [00000042 BYTES: COLLAPSED FUNCTION __myalloc. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__dosret0:
		jb	short loc_1CC5_55B

loc_1CC5_548:				; CODE XREF: seg010:__dosreturnj
		xor	ax, ax
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

__dosreturn:
		jnb	short loc_1CC5_548
		push	ax
		call	libsub_1CC5_56C
		pop	ax
		mov	sp, bp
		pop	bp
		retf
; [0000000D BYTES: COLLAPSED FUNCTION __dosretax. PRESS	KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION __maperror. PRESS	KEYPAD "+" TO EXPAND]
; [0000002E BYTES: COLLAPSED FUNCTION libsub_1CC5_56C. PRESS KEYPAD "+"	TO EXPAND]
; [00000034 BYTES: COLLAPSED FUNCTION _flushall. PRESS KEYPAD "+" TO EXPAND]
; [00000042 BYTES: COLLAPSED FUNCTION _printf. PRESS KEYPAD "+"	TO EXPAND]
; [0000015D BYTES: COLLAPSED FUNCTION __flsbuf.	PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000006E BYTES: COLLAPSED FUNCTION __getbuf.	PRESS KEYPAD "+" TO EXPAND]
; [00000084 BYTES: COLLAPSED FUNCTION __stbuf. PRESS KEYPAD "+"	TO EXPAND]
; [0000009E BYTES: COLLAPSED FUNCTION __ftbuf. PRESS KEYPAD "+"	TO EXPAND]
; [00000070 BYTES: COLLAPSED FUNCTION _fflush. PRESS KEYPAD "+"	TO EXPAND]
; [0000032B BYTES: COLLAPSED FUNCTION __output.	PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000013A BYTES: COLLAPSED FUNCTION libsub_1CC5_C9A. PRESS KEYPAD "+"	TO EXPAND]
; [000000EB BYTES: COLLAPSED FUNCTION libsub_1CC5_DD4. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [000000BD BYTES: COLLAPSED FUNCTION libsub_1CC5_EC0. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [0000003F BYTES: COLLAPSED FUNCTION libsub_1CC5_F7E. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [00000060 BYTES: COLLAPSED FUNCTION libsub_1CC5_FBE. PRESS KEYPAD "+"	TO EXPAND]
; [0000006A BYTES: COLLAPSED FUNCTION libsub_1CC5_101E.	PRESS KEYPAD "+" TO EXPAND]
; [000000EC BYTES: COLLAPSED FUNCTION libsub_1CC5_1088.	PRESS KEYPAD "+" TO EXPAND]
; [00000018 BYTES: COLLAPSED FUNCTION libsub_1CC5_1174.	PRESS KEYPAD "+" TO EXPAND]
; [0000002A BYTES: COLLAPSED FUNCTION libsub_1CC5_118C.	PRESS KEYPAD "+" TO EXPAND]
; [0000007F BYTES: COLLAPSED FUNCTION libsub_1CC5_11B6.	PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000027 BYTES: COLLAPSED FUNCTION libsub_1CC5_1236.	PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000007A BYTES: COLLAPSED FUNCTION _lseek. PRESS KEYPAD "+" TO EXPAND]
; [000000A8 BYTES: COLLAPSED FUNCTION _write. PRESS KEYPAD "+" TO EXPAND]
; [0000004E BYTES: COLLAPSED FUNCTION libsub_1CC5_1380.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

loc_1CC5_13CE:				; CODE XREF: _write:loc_1CC5_1377j
		mov	cx, [bp+0Ah]
		or	cx, cx
		jnz	short loc_1CC5_13DA
		mov	ax, cx
		jmp	near ptr __dosretax
; ---------------------------------------------------------------------------

loc_1CC5_13DA:				; CODE XREF: seg010:13D3j
		mov	dx, [bp+8]
		mov	ah, 40h
		int	21h		; DOS -	2+ - WRITE TO FILE WITH	HANDLE
					; BX = file handle, CX = number	of bytes to write, DS:DX -> buffer
		jnb	short loc_1CC5_13E7
		mov	ah, 9
		jmp	short loc_1CC5_13CB
; ---------------------------------------------------------------------------

loc_1CC5_13E7:				; CODE XREF: seg010:13E1j
		or	ax, ax
		jnz	short loc_1CC5_13CB
		test	byte ptr [bx+3684h], 40h
		jz	short loc_1CC5_13FC
		mov	bx, dx
		cmp	byte ptr [bx], 1Ah
		jnz	short loc_1CC5_13FC
		clc
		jmp	short loc_1CC5_13CB
; ---------------------------------------------------------------------------

loc_1CC5_13FC:				; CODE XREF: seg010:13F0j seg010:13F7j
		stc
		mov	ax, 1C00h
		jmp	short loc_1CC5_13CB
; [00000014 BYTES: COLLAPSED FUNCTION _stackavail. PRESS KEYPAD	"+" TO EXPAND]
; [00000012 BYTES: COLLAPSED FUNCTION unknown_libname_1. PRESS KEYPAD "+" TO EXPAND]
; [00000046 BYTES: COLLAPSED FUNCTION unknown_libname_2. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

loc_1CC5_146E:				; CODE XREF: __amalloc+1j __amalloc+9j
		jmp	loc_1CC5_153F
; [000000E3 BYTES: COLLAPSED FUNCTION __amalloc. PRESS KEYPAD "+" TO EXPAND]
; [0000003A BYTES: COLLAPSED FUNCTION __amexpand. PRESS	KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION __amlink.	PRESS KEYPAD "+" TO EXPAND]
; [00000021 BYTES: COLLAPSED FUNCTION __amallocbrk. PRESS KEYPAD "+" TO	EXPAND]
		align 2
; [0000006E BYTES: COLLAPSED FUNCTION _brkctl. PRESS KEYPAD "+"	TO EXPAND]
; [00000056 BYTES: COLLAPSED FUNCTION libsub_1CC5_1640.	PRESS KEYPAD "+" TO EXPAND]
; [0000003F BYTES: COLLAPSED FUNCTION _strcat. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [00000032 BYTES: COLLAPSED FUNCTION _strcpy. PRESS KEYPAD "+"	TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION _strcmp. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [0000001B BYTES: COLLAPSED FUNCTION _strlen. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [0000001B BYTES: COLLAPSED FUNCTION _itoa. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000000A BYTES: COLLAPSED FUNCTION _ultoa. PRESS KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION _abort. PRESS KEYPAD "+" TO EXPAND]
; [00000023 BYTES: COLLAPSED FUNCTION _isatty. PRESS KEYPAD "+"	TO EXPAND]
		align 2
; [00000080 BYTES: COLLAPSED FUNCTION _int86. PRESS KEYPAD "+" TO EXPAND]
; [0000005A BYTES: COLLAPSED FUNCTION _sprintf.	PRESS KEYPAD "+" TO EXPAND]
; [00000042 BYTES: COLLAPSED FUNCTION _stricmp.	PRESS KEYPAD "+" TO EXPAND]
; [0000005F BYTES: COLLAPSED FUNCTION __cltoasub. PRESS	KEYPAD "+" TO EXPAND]
		align 2
; [00000015 BYTES: COLLAPSED FUNCTION _abs. PRESS KEYPAD "+" TO	EXPAND]
		align 2
off_1CC5_194E	dw offset loc_1CC5_19E5	; DATA XREF: _raise+43r
		dw offset loc_1CC5_19D6
		dw offset loc_1CC5_19CE
		dw offset loc_1CC5_19D6
		dw offset loc_1CC5_19D6
		dw offset loc_1CC5_19D6
; [00000091 BYTES: COLLAPSED FUNCTION _raise. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000011 BYTES: COLLAPSED FUNCTION _srand. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000028 BYTES: COLLAPSED FUNCTION _rand. PRESS KEYPAD "+" TO EXPAND]
		db 2, 4, 8, 0Bh, 0Fh, 16h
; [000000A3 BYTES: COLLAPSED FUNCTION _signal. PRESS KEYPAD "+"	TO EXPAND]
; [00000028 BYTES: COLLAPSED FUNCTION __sigentry. PRESS	KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		push	ax
		lahf
		push	ax
		push	ds
		push	dx
		mov	ax, seg	dseg
		mov	ds, ax
		cmp	word_2B77_36A4,	0
		jnz	short loc_1CC5_1B1C
		mov	ax, word_2B77_3934
		mov	dx, word_2B77_3936
		or	dx, dx
		jnz	short loc_1CC5_1B49
		cmp	ax, 1
		ja	short loc_1CC5_1B49
		or	ax, ax
		jnz	short loc_1CC5_1B6E

loc_1CC5_1B1C:				; CODE XREF: seg010:1B06j
		sub	sp, 4
		push	bp
		mov	bp, sp
		add	bp, 2
		mov	al, 4

loc_1CC5_1B27:				; CODE XREF: seg010:1B33j
		mov	dx, [bp+4]
		mov	[bp+0],	dx
		inc	bp
		inc	bp
		dec	al
		cmp	al, 0
		jnz	short loc_1CC5_1B27
		mov	ax, word_2B77_382A
		mov	[bp+0],	ax
		mov	ax, word_2B77_3828
		mov	[bp+2],	ax
		pop	bp
		pop	dx
		pop	ds
		pop	ax
		sahf
		pop	ax
		stc
		retf
; ---------------------------------------------------------------------------

loc_1CC5_1B49:				; CODE XREF: seg010:1B11j seg010:1B16j
		mov	word ptr dword_2B77_394C, ax
		mov	word ptr dword_2B77_394C+2, dx
		push	es
		push	bp
		push	di
		push	si
		push	cx
		push	bx
		xor	ax, ax
		mov	word_2B77_3934,	ax
		mov	word_2B77_3936,	ax
		mov	ax, 2
		push	ax
		cld
		call	dword_2B77_394C
		pop	ax
		pop	bx
		pop	cx
		pop	si
		pop	di
		pop	bp
		pop	es

loc_1CC5_1B6E:				; CODE XREF: seg010:1B1Aj
		pop	dx
		pop	ds
		pop	ax
		sahf
		pop	ax
		clc
		retf
; ---------------------------------------------------------------------------
		retf
; ---------------------------------------------------------------------------
		jmp	ss:dword_2B77_54B6
; ---------------------------------------------------------------------------
		push	bx
		push	cx
		push	dx
		push	es
		xor	ah, ah
		push	ax
		mov	ax, 8
		push	ax
		call	__sigentry
		push	ss
		pop	ds
		call	dword ptr [bx]
		add	sp, 4
		pop	es
		pop	dx
		pop	cx
		pop	bx
		retf
; ---------------------------------------------------------------------------
		align 2
		jmp	__aFldiv
; ---------------------------------------------------------------------------
		jmp	lib_Fldiv
; ---------------------------------------------------------------------------
		jmp	__aFlmul
; ---------------------------------------------------------------------------
		jmp	__aFFblmul
; ---------------------------------------------------------------------------
		jmp	lib_Flshr
; ---------------------------------------------------------------------------
		jmp	__aFlshr
; ---------------------------------------------------------------------------
		jmp	__aFuldiv
; ---------------------------------------------------------------------------
		jmp	lib_Fuldiv
; [0000002B BYTES: COLLAPSED FUNCTION _strrchr.	PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: library function bp-based	frame

__aFldiv	proc far		; CODE XREF: TrkPlanSimd+82FP
					; TrkPlanSimd+862P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		push	di
		push	si
		push	bx
		xor	di, di
		mov	ax, [bp+arg_2]
		or	ax, ax
		jge	short loc_1CC5_1C0C
		inc	di
		mov	dx, [bp+arg_0]
		neg	ax
		neg	dx
		sbb	ax, 0
		mov	[bp+arg_2], ax
		mov	[bp+arg_0], dx

loc_1CC5_1C0C:				; CODE XREF: __aFldiv+Dj
		mov	ax, [bp+arg_6]
		or	ax, ax
		jge	short loc_1CC5_1C24
		inc	di
		mov	dx, [bp+arg_4]
		neg	ax
		neg	dx
		sbb	ax, 0
		mov	[bp+arg_6], ax
		mov	[bp+arg_4], dx

loc_1CC5_1C24:				; CODE XREF: __aFldiv+25j
		or	ax, ax
		jnz	short loc_1CC5_1C3D
		mov	cx, [bp+arg_4]
		mov	ax, [bp+arg_2]
		xor	dx, dx
		div	cx
		mov	bx, ax
		mov	ax, [bp+arg_0]
		div	cx
		mov	dx, bx
		jmp	short loc_1CC5_1C75
; ---------------------------------------------------------------------------

loc_1CC5_1C3D:				; CODE XREF: __aFldiv+3Aj
		mov	bx, ax
		mov	cx, [bp+arg_4]
		mov	dx, [bp+arg_2]
		mov	ax, [bp+arg_0]

loc_1CC5_1C48:				; CODE XREF: __aFldiv+66j
		shr	bx, 1
		rcr	cx, 1
		shr	dx, 1
		rcr	ax, 1
		or	bx, bx
		jnz	short loc_1CC5_1C48
		div	cx
		mov	si, ax
		mul	[bp+arg_6]
		xchg	ax, cx
		mov	ax, [bp+arg_4]
		mul	si
		add	dx, cx
		jb	short loc_1CC5_1C71
		cmp	dx, [bp+arg_2]
		ja	short loc_1CC5_1C71
		jb	short loc_1CC5_1C72
		cmp	ax, [bp+arg_0]
		jbe	short loc_1CC5_1C72

loc_1CC5_1C71:				; CODE XREF: __aFldiv+77j __aFldiv+7Cj
		dec	si

loc_1CC5_1C72:				; CODE XREF: __aFldiv+7Ej __aFldiv+83j
		xor	dx, dx
		xchg	ax, si

loc_1CC5_1C75:				; CODE XREF: __aFldiv+4Fj
		dec	di
		jnz	short loc_1CC5_1C7F
		neg	dx
		neg	ax
		sbb	dx, 0

loc_1CC5_1C7F:				; CODE XREF: __aFldiv+8Aj
		pop	bx
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf	8
__aFldiv	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: library function bp-based	frame

__aFlmul	proc far		; CODE XREF: TrkPlanSimd+A4P
					; TrkPlanSimd+828P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_2]
		mov	bx, [bp+arg_6]
		or	bx, ax
		mov	bx, [bp+arg_4]
		jnz	short loc_1CC5_1CA3
		mov	ax, [bp+arg_0]
		mul	bx
		mov	sp, bp
		pop	bp
		retf	8
; ---------------------------------------------------------------------------

loc_1CC5_1CA3:				; CODE XREF: __aFlmul+Ej
		mul	bx
		mov	cx, ax
		mov	ax, [bp+arg_0]
		mul	[bp+arg_6]
		add	cx, ax
		mov	ax, [bp+arg_0]
		mul	bx
		add	dx, cx
		mov	sp, bp
		pop	bp
		retf	8
__aFlmul	endp

; [0000000B BYTES: COLLAPSED FUNCTION __aFlshr.	PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000024 BYTES: COLLAPSED FUNCTION lib_Fldiv. PRESS KEYPAD "+" TO EXPAND]
; [00000024 BYTES: COLLAPSED FUNCTION __aFFblmul. PRESS	KEYPAD "+" TO EXPAND]
; [00000021 BYTES: COLLAPSED FUNCTION lib_Flshr. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000024 BYTES: COLLAPSED FUNCTION lib_Fuldiv. PRESS	KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: library function bp-based	frame

__aFuldiv	proc far		; CODE XREF: RunCarMenu+6C3P
					; EndOfGameScores+3E1P	...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		push	bx
		push	si
		mov	ax, [bp+arg_6]
		or	ax, ax
		jnz	short loc_1CC5_1D77
		mov	cx, [bp+arg_4]
		mov	ax, [bp+arg_2]
		xor	dx, dx
		div	cx
		mov	bx, ax
		mov	ax, [bp+arg_0]
		div	cx
		mov	dx, bx
		jmp	short loc_1CC5_1DAF
; ---------------------------------------------------------------------------

loc_1CC5_1D77:				; CODE XREF: __aFuldiv+Aj
		mov	cx, ax
		mov	bx, [bp+arg_4]
		mov	dx, [bp+arg_2]
		mov	ax, [bp+arg_0]

loc_1CC5_1D82:				; CODE XREF: __aFuldiv+36j
		shr	cx, 1
		rcr	bx, 1
		shr	dx, 1
		rcr	ax, 1
		or	cx, cx
		jnz	short loc_1CC5_1D82
		div	bx
		mov	si, ax
		mul	[bp+arg_6]
		xchg	ax, cx
		mov	ax, [bp+arg_4]
		mul	si
		add	dx, cx
		jb	short loc_1CC5_1DAB
		cmp	dx, [bp+arg_2]
		ja	short loc_1CC5_1DAB
		jb	short loc_1CC5_1DAC
		cmp	ax, [bp+arg_0]
		jbe	short loc_1CC5_1DAC

loc_1CC5_1DAB:				; CODE XREF: __aFuldiv+47j
					; __aFuldiv+4Cj
		dec	si

loc_1CC5_1DAC:				; CODE XREF: __aFuldiv+4Ej
					; __aFuldiv+53j
		xor	dx, dx
		xchg	ax, si

loc_1CC5_1DAF:				; CODE XREF: __aFuldiv+1Fj
		pop	si
		pop	bx
		mov	sp, bp
		pop	bp
		retf	8
__aFuldiv	endp

seg010		ends

; ===========================================================================

; Segment type:	Pure code
seg011		segment	byte public 'CODE' use16
		assume cs:seg011
		;org 7
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ZXCosSinX2	proc far		; CODE XREF: OpponentOp+12CP
					; TrkPlanSimd+652P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_0]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		call	XZCosOrSin
		add	sp, 4
		push	ax

loc_1EA0_1F:
		call	XZCosOrSin
		add	sp, 4
		pop	bp
		retf
ZXCosSinX2	endp

seg011		ends

; ---------------------------------------------------------------------------
; ===========================================================================

; Segment type:	Pure code
seg012		segment	byte public 'CODE' use16
		assume cs:seg012
		;org 9
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		nop

ErrorMessage:				; CODE XREF: InitSfxEngine+2ACP
					; AddExitHandler+27P ...
		pop	ax
		pop	ax
		call	SetSprite2As1

loc_1EA2_11:
		call	_printf
		call	DoCallReadCharCBRep
		call	CallExitHandls
		call	_printf
		add	sp, 2
		call	_abort
; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetAngleFromXZ	proc far		; CODE XREF: RunCarMenu+7E9P
					; OpponentOp+381P ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	di
		xor	di, di
		mov	dx, [bp+arg_0]
		mov	cx, [bp+arg_2]
		or	dx, dx
		jge	short loc_1EA2_43
		or	di, 8
		neg	dx

loc_1EA2_43:				; CODE XREF: GetAngleFromXZ+Ej
		or	cx, cx
		jge	short loc_1EA2_4C
		or	di, 4
		neg	cx

loc_1EA2_4C:				; CODE XREF: GetAngleFromXZ+17j
		cmp	dx, cx
		jl	short loc_1EA2_57
		jz	short loc_1EA2_6F
		xchg	dx, cx
		or	di, 2

loc_1EA2_57:				; CODE XREF: GetAngleFromXZ+20j
		xor	ax, ax
		div	cx
		mov	bl, ah
		xor	bh, bh
		add	al, 80h	; '€'
		adc	bx, 0
		mov	al, byte_2B77_3950[bx]
		xor	ah, ah
		jmp	cs:off_1EA2_7B[di]
; ---------------------------------------------------------------------------

loc_1EA2_6F:				; CODE XREF: GetAngleFromXZ+22j
		or	dx, dx
		jz	short loc_1EA2_90
		mov	ax, 80h	; '€'
		jmp	cs:off_1EA2_7B[di]
; ---------------------------------------------------------------------------
off_1EA2_7B	dw offset loc_1EA2_90	; DATA XREF: GetAngleFromXZ+3Cr
					; GetAngleFromXZ+48r
		dw offset loc_1EA2_8B
		dw offset loc_1EA2_98
		dw offset loc_1EA2_93
		dw offset loc_1EA2_9F
		dw offset loc_1EA2_A3
		dw offset loc_1EA2_AF
		dw offset loc_1EA2_A8
; ---------------------------------------------------------------------------

loc_1EA2_8B:				; DATA XREF: GetAngleFromXZ+4Fo
		neg	ax
		add	ah, 1

loc_1EA2_90:				; CODE XREF: GetAngleFromXZ+3Cj
					; GetAngleFromXZ+43j ...
		pop	di
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_93:				; DATA XREF: GetAngleFromXZ+53o
		add	ah, 1
		jmp	short loc_1EA2_90
; ---------------------------------------------------------------------------

loc_1EA2_98:				; DATA XREF: GetAngleFromXZ+51o
		neg	ax
		add	ah, 2
		jmp	short loc_1EA2_90
; ---------------------------------------------------------------------------

loc_1EA2_9F:				; DATA XREF: GetAngleFromXZ+55o
		neg	ax
		jmp	short loc_1EA2_90
; ---------------------------------------------------------------------------

loc_1EA2_A3:				; DATA XREF: GetAngleFromXZ+57o
		sub	ah, 1
		jmp	short loc_1EA2_90
; ---------------------------------------------------------------------------

loc_1EA2_A8:				; DATA XREF: GetAngleFromXZ+5Bo
		add	ah, 1
		neg	ax
		jmp	short loc_1EA2_90
; ---------------------------------------------------------------------------

loc_1EA2_AF:				; DATA XREF: GetAngleFromXZ+59o
		sub	ah, 2
		jmp	short loc_1EA2_90
GetAngleFromXZ	endp


; =============== S U B	R O U T	I N E =======================================


GetValue	proc far		; CODE XREF: SetAddValue+3P
					; seg012:loc_1EA2_D5P ...
		cli
		mov	ax, g_wOrigValue1
		mov	dx, g_wOrigValue2
		sti
		retf
GetValue	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetAddValue	proc far		; CODE XREF: ReadLine+A5P ReadLine+EFP

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		call	GetValue
		add	ax, [bp+arg_0]
		adc	dx, [bp+arg_2]
		mov	g_wAddedValue1,	ax
		mov	g_wAddedValue2,	dx
		pop	bp
		retf
SetAddValue	endp

; ---------------------------------------------------------------------------

loc_1EA2_D5:				; CODE XREF: seg012:00DEj seg012:00E4j
		call	GetValue
		cmp	dx, g_wAddedValue2
		jb	short loc_1EA2_D5
		cmp	ax, g_wAddedValue1
		jb	short loc_1EA2_D5
		retf

; =============== S U B	R O U T	I N E =======================================


GetValueIf	proc far		; CODE XREF: ReadLine+D5P
		call	GetValue
		xor	cx, cx
		cmp	dx, g_wAddedValue2
		jb	short loc_1EA2_FB
		cmp	ax, g_wAddedValue1
		jb	short loc_1EA2_FB
		inc	cx

loc_1EA2_FB:				; CODE XREF: GetValueIf+Bj
					; GetValueIf+11j
		mov	ax, cx
		retf
GetValueIf	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetValueIfTwice	proc far		; CODE XREF: DoDialog+4FAP

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		call	GetValue
		add	ax, [bp+arg_0]
		adc	dx, [bp+arg_2]
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_1EA2_115:				; CODE XREF: GetValueIfTwice+1Fj
					; GetValueIfTwice+24j
		call	GetValue
		cmp	dx, [bp+var_2]
		jb	short loc_1EA2_115
		cmp	ax, [bp+var_4]
		jb	short loc_1EA2_115
		mov	sp, bp
		pop	bp
		retf
GetValueIfTwice	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoResetImageData proc far		; CODE XREF: SpriteOp7:loc_1EA2_2F0EP
					; SpriteOp7:loc_1EA2_2F52P

var_4		= byte ptr -4

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		push	di
		mov	[bp+var_4], 1
		jmp	short loc_1EA2_142
DoResetImageData endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ResetImageData	proc far		; CODE XREF: SkyBoxOp+15BP
					; ImageResetRende+1CP ...

var_4		= byte ptr -4
var_2		= word ptr -2
p_wX		= word ptr  6
p_wY		= word ptr  8
p_wRevX		= word ptr  0Ah
p_pRevY		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		push	di
		mov	[bp+var_4], 0

loc_1EA2_142:				; CODE XREF: DoResetImageData+Cj
		mov	si, [bp+arg_8]
		mov	word ptr [si+12h], 0FFh
		xor	ax, ax
		mov	[si], ax
		mov	[si+4],	ax
		mov	[si+14h], ax
		mov	[si+16h], ax
		mov	[si+18h], ax
		mov	[si+1Ah], ax
		mov	ax, [bp+p_wY]
		mov	bx, [bp+p_pRevY]
		mov	cx, [bp+p_wX]
		mov	dx, [bp+p_wRevX]
		cmp	ax, bx
		jg	short loc_1EA2_17C
		mov	[si+2],	cx
		mov	[si+6],	ax
		mov	[si+8],	dx
		mov	[si+0Ah], bx
		jmp	short loc_1EA2_188
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_17C:				; CODE XREF: ResetImageData+35j
		mov	[si+2],	dx
		mov	[si+6],	bx
		mov	[si+8],	cx
		mov	[si+0Ah], ax

loc_1EA2_188:				; CODE XREF: ResetImageData+43j
		jnz	short loc_1EA2_18D
		jmp	loc_1EA2_783
; ---------------------------------------------------------------------------

loc_1EA2_18D:				; CODE XREF: ResetImageData:loc_1EA2_188j
					; ResetImageData+77Dj
		xor	dx, dx
		cmp	[bp+var_4], 0
		jnz	short loc_1EA2_1FA
		mov	ax, [si+6]
		mov	bx, cs:g_pSprite1.dwTop
		mov	cx, cs:g_pSprite1.dwHeight
		cmp	ax, cx
		jl	short loc_1EA2_1AB
		mov	dl, 8
		jmp	loc_1EA2_57B
; ---------------------------------------------------------------------------

loc_1EA2_1AB:				; CODE XREF: ResetImageData+6Ej
		cmp	ax, bx
		jge	short loc_1EA2_1B2
		or	dh, 4

loc_1EA2_1B2:				; CODE XREF: ResetImageData+77j
		mov	ax, [si+0Ah]
		cmp	ax, bx
		jge	short loc_1EA2_1BE
		mov	dl, 4
		jmp	loc_1EA2_57B
; ---------------------------------------------------------------------------

loc_1EA2_1BE:				; CODE XREF: ResetImageData+81j
		cmp	ax, cx
		jl	short loc_1EA2_1C5
		or	dl, 8

loc_1EA2_1C5:				; CODE XREF: ResetImageData+8Aj
		mov	bx, cs:g_pSprite1.dwLeft2
		mov	cx, cs:g_pSprite1.dwWidthSum
		mov	ax, [si+2]
		cmp	ax, bx
		jge	short loc_1EA2_1D9
		or	dh, 2

loc_1EA2_1D9:				; CODE XREF: ResetImageData+9Ej
		cmp	ax, cx
		jl	short loc_1EA2_1E0
		or	dh, 1

loc_1EA2_1E0:				; CODE XREF: ResetImageData+A5j
		mov	ax, [si+Sprite.field_8]
		cmp	ax, bx
		jge	short loc_1EA2_1EA
		or	dl, 2

loc_1EA2_1EA:				; CODE XREF: ResetImageData+AFj
		cmp	ax, cx
		jl	short loc_1EA2_1F1
		or	dl, 1

loc_1EA2_1F1:				; CODE XREF: ResetImageData+B6j
		test	dl, dh
		jz	short loc_1EA2_1FA
		and	dl, dh
		jmp	loc_1EA2_57B
; ---------------------------------------------------------------------------

loc_1EA2_1FA:				; CODE XREF: ResetImageData+5Dj
					; ResetImageData+BDj
		or	dl, dh
		xor	dh, dh
		mov	[bp+var_2], dx
		mov	cx, [si+0Ah]
		sub	cx, [si+6]
		jno	short loc_1EA2_20C

loc_1EA2_209:				; CODE XREF: ResetImageData+DCj
					; ResetImageData+124j ...
		jmp	loc_1EA2_833
; ---------------------------------------------------------------------------

loc_1EA2_20C:				; CODE XREF: ResetImageData+D1j
		mov	dx, [si+8]
		sub	dx, [si+2]
		jo	short loc_1EA2_209
		jnz	short loc_1EA2_221
		inc	cx
		mov	[si+0Eh], cx
		mov	byte ptr [si+12h], 2
		jmp	short loc_1EA2_28D
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_221:				; CODE XREF: ResetImageData+DEj
		jl	short loc_1EA2_26F
		cmp	dx, cx
		jb	short loc_1EA2_262
		jz	short loc_1EA2_268
		mov	byte ptr [si+12h], 8

loc_1EA2_22D:				; CODE XREF: ResetImageData+147j
		xchg	cx, dx

loc_1EA2_22F:				; CODE XREF: ResetImageData+130j
					; ResetImageData+14Dj
		cmp	cx, cs:word_1EA2_A28
		jge	short loc_1EA2_249
		mov	bx, cx
		shl	bx, 1
		mov	bx, word ptr cs:byte_1EA2_A2A[bx]
		add	bx, dx
		add	bx, dx
		mov	ax, cs:[bx]
		jmp	short loc_1EA2_256
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_249:				; CODE XREF: ResetImageData+FEj
		xor	ax, ax
		div	cx
		mov	bx, cx
		shr	bx, 1
		sub	bx, dx
		adc	ax, 0

loc_1EA2_256:				; CODE XREF: ResetImageData+110j
		mov	[si+0Ch], ax
		inc	cx
		jo	short loc_1EA2_209
		mov	[si+0Eh], cx
		jmp	short loc_1EA2_28D
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_262:				; CODE XREF: ResetImageData+EFj
		mov	byte ptr [si+12h], 6
		jmp	short loc_1EA2_22F
; ---------------------------------------------------------------------------

loc_1EA2_268:				; CODE XREF: ResetImageData+F1j
		mov	byte ptr [si+12h], 4
		jmp	short loc_1EA2_289
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_26F:				; CODE XREF: ResetImageData:loc_1EA2_221j
		neg	dx
		jo	short loc_1EA2_209
		cmp	dx, cx
		jb	short loc_1EA2_27F
		jz	short loc_1EA2_285
		mov	byte ptr [si+12h], 7
		jmp	short loc_1EA2_22D
; ---------------------------------------------------------------------------

loc_1EA2_27F:				; CODE XREF: ResetImageData+13Fj
		mov	byte ptr [si+12h], 5
		jmp	short loc_1EA2_22F
; ---------------------------------------------------------------------------

loc_1EA2_285:				; CODE XREF: ResetImageData+141j
		mov	byte ptr [si+12h], 3

loc_1EA2_289:				; CODE XREF: ResetImageData+136j
		inc	cx
		mov	[si+0Eh], cx

loc_1EA2_28D:				; CODE XREF: ResetImageData+E8j
					; ResetImageData+129j ...
		mov	bx, [bp+var_2]
		shl	bx, 1
		jz	short loc_1EA2_2B9
		jmp	cs:off_1EA2_299[bx]
; ---------------------------------------------------------------------------
off_1EA2_299	dw offset loc_1EA2_2B9	; DATA XREF: ResetImageData+15Er
		dw offset loc_1EA2_5FF
		dw offset loc_1EA2_458
		dw offset loc_1EA2_458
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_385
		dw offset loc_1EA2_385
		dw offset loc_1EA2_385
		dw offset loc_1EA2_385
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_2C1
		dw offset loc_1EA2_2C1
; ---------------------------------------------------------------------------

loc_1EA2_2B9:				; CODE XREF: ResetImageData+15Cj
					; ResetImageData+15Ej ...
		xor	ax, ax
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2C1:				; CODE XREF: ResetImageData+15Ej
					; DATA XREF: ResetImageData+16Bo ...
		mov	ax, [si+6]
		mov	cx, cs:g_pSprite1.dwTop
		mov	[si+6],	cx
		sub	cx, ax
		mov	bl, [si+12h]
		shl	bx, 1
		jmp	cs:word_1EA2_2D8[bx]
; ---------------------------------------------------------------------------
word_1EA2_2D8	dw 0			; DATA XREF: ResetImageData+19Dr
		dw 0
		dw offset loc_1EA2_2EA
		dw offset loc_1EA2_2F0
		dw offset loc_1EA2_2F9
		dw offset loc_1EA2_302
		dw offset loc_1EA2_312
		dw offset loc_1EA2_322
		dw offset loc_1EA2_35E
; ---------------------------------------------------------------------------

loc_1EA2_2EA:				; DATA XREF: ResetImageData+1A6o
		sub	[si+0Eh], cx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_2F0:				; DATA XREF: ResetImageData+1A8o
		sub	[si+2],	cx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_2F9:				; DATA XREF: ResetImageData+1AAo
		add	[si+2],	cx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_302:				; DATA XREF: ResetImageData+1ACo
		mov	ax, [si+0Ch]
		mul	cx
		sub	[si], ax
		sbb	[si+2],	dx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_312:				; DATA XREF: ResetImageData+1AEo
		mov	ax, [si+0Ch]
		mul	cx
		add	[si], ax
		adc	[si+2],	dx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_322:				; DATA XREF: ResetImageData+1B0o
		mov	[si+6],	ax
		mov	dx, cx
		xor	ax, ax
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		sub	[si+2],	ax
		sub	[si+0Eh], ax
		jle	short loc_1EA2_349
		mul	word ptr [si+0Ch]
		add	[si+4],	ax
		adc	[si+6],	dx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_349:				; CODE XREF: ResetImageData+205j
					; ResetImageData+241j
		mov	word ptr [si+0Eh], 1
		mov	ax, cs:g_pSprite1.dwTop
		mov	[si+6],	ax
		mov	ax, [si+8]
		mov	[si+2],	ax
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_35E:				; DATA XREF: ResetImageData+1B2o
		mov	[si+6],	ax
		mov	dx, cx
		xor	ax, ax
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		add	[si+2],	ax
		sub	[si+0Eh], ax
		jle	short loc_1EA2_349
		mul	word ptr [si+0Ch]
		add	[si+4],	ax

loc_1EA2_37F:
		adc	[si+6],	dx
		jmp	loc_1EA2_71E
; ---------------------------------------------------------------------------

loc_1EA2_385:				; CODE XREF: ResetImageData+15Ej
					; ResetImageData+5EFj
					; DATA XREF: ...
		mov	cx, [si+0Ah]
		mov	dx, cs:g_pSprite1.dwHeight
		dec	dx
		mov	[si+0Ah], dx
		sub	cx, dx
		mov	bl, [si+12h]
		shl	bx, 1
		jmp	cs:word_1EA2_39D[bx]
; ---------------------------------------------------------------------------
word_1EA2_39D	dw 0			; DATA XREF: ResetImageData+262r
		dw 0
		dw offset loc_1EA2_3AF
		dw offset loc_1EA2_3B5
		dw offset loc_1EA2_3BE
		dw offset loc_1EA2_3C7
		dw offset loc_1EA2_3EB
		dw offset loc_1EA2_40A
		dw offset loc_1EA2_433
; ---------------------------------------------------------------------------

loc_1EA2_3AF:				; DATA XREF: ResetImageData+26Bo
		sub	[si+0Eh], cx
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_3B5:				; DATA XREF: ResetImageData+26Do
		add	[si+8],	cx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_3BE:				; DATA XREF: ResetImageData+26Fo
		sub	[si+8],	cx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_3C7:				; DATA XREF: ResetImageData+271o
		mov	dx, [si+0Eh]
		sub	dx, cx
		mov	[si+0Eh], dx
		dec	dx
		mov	ax, [si+0Ch]
		mul	dx
		mov	bx, [si]
		mov	cx, [si+2]
		sub	bx, ax
		sbb	cx, dx
		add	bx, 8000h
		adc	cx, 0
		mov	[si+8],	cx
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_3EB:				; DATA XREF: ResetImageData+273o
		mov	dx, [si+0Eh]
		sub	dx, cx
		mov	[si+0Eh], dx
		dec	dx
		mov	ax, [si+0Ch]
		mul	dx
		add	ax, [si]
		adc	dx, [si+2]
		add	ax, 8000h
		adc	dx, 0
		mov	[si+8],	dx
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_40A:				; DATA XREF: ResetImageData+275o
		xor	ax, ax
		sub	ax, [si+4]
		sbb	dx, [si+6]
		jl	short loc_1EA2_42F
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0

loc_1EA2_420:				; CODE XREF: ResetImageData+2FBj
		mov	dx, [si+2]
		sub	dx, ax
		mov	[si+8],	dx
		inc	ax
		mov	[si+0Eh], ax
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_42F:				; CODE XREF: ResetImageData+2DCj
					; ResetImageData+305j
		xor	ax, ax
		jmp	short loc_1EA2_420
; ---------------------------------------------------------------------------

loc_1EA2_433:				; DATA XREF: ResetImageData+277o
		xor	ax, ax
		sub	ax, [si+4]
		sbb	dx, [si+6]
		jl	short loc_1EA2_42F
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		mov	dx, [si+2]
		add	dx, ax
		mov	[si+8],	dx
		inc	ax
		mov	[si+0Eh], ax
		jmp	loc_1EA2_728
; ---------------------------------------------------------------------------

loc_1EA2_458:				; CODE XREF: ResetImageData+15Ej
					; DATA XREF: ResetImageData+167o ...
		mov	bl, [si+12h]
		shl	bx, 1
		jmp	cs:word_1EA2_462[bx]
; ---------------------------------------------------------------------------
word_1EA2_462	dw 0			; DATA XREF: ResetImageData+327r
		dw 0
		dw offset loc_1EA2_578
		dw offset loc_1EA2_474
		dw offset loc_1EA2_48D
		dw offset loc_1EA2_4A6
		dw offset loc_1EA2_4DE
		dw offset loc_1EA2_511
		dw offset loc_1EA2_541
; ---------------------------------------------------------------------------

loc_1EA2_474:				; DATA XREF: ResetImageData+332o
		mov	cx, cs:g_pSprite1.dwLeft2
		mov	ax, [si+8]
		mov	[si+8],	cx
		sub	cx, ax
		add	[si+16h], cx
		sub	[si+0Eh], cx
		sub	[si+0Ah], cx
		jmp	loc_1EA2_776
; ---------------------------------------------------------------------------

loc_1EA2_48D:				; DATA XREF: ResetImageData+334o
		mov	ax, [si+2]
		mov	cx, cs:g_pSprite1.dwLeft2
		mov	[si+2],	cx
		sub	cx, ax
		add	[si+14h], cx
		add	[si+6],	cx
		sub	[si+0Eh], cx
		jmp	loc_1EA2_776
; ---------------------------------------------------------------------------

loc_1EA2_4A6:				; DATA XREF: ResetImageData+336o
		mov	ax, [si]
		mov	dx, [si+2]
		mov	cx, cs:g_pSprite1.dwLeft2
		mov	[si+8],	cx
		sub	dx, cx
		jl	short loc_1EA2_4D9
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		inc	ax

loc_1EA2_4C4:				; CODE XREF: ResetImageData+3A6j
		mov	cx, [si+0Eh]
		mov	[si+0Eh], ax
		sub	cx, ax
		add	[si+16h], cx
		dec	ax
		add	ax, [si+6]
		mov	[si+0Ah], ax
		jmp	loc_1EA2_776
; ---------------------------------------------------------------------------

loc_1EA2_4D9:				; CODE XREF: ResetImageData+37Fj
		mov	ax, 1
		jmp	short loc_1EA2_4C4
; ---------------------------------------------------------------------------

loc_1EA2_4DE:				; DATA XREF: ResetImageData+338o
		mov	dx, cs:g_pSprite1.dwLeft2
		xor	ax, ax
		sub	ax, [si]
		sbb	dx, [si+2]
		jl	short loc_1EA2_50E
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		add	[si+6],	ax
		add	[si+14h], ax
		sub	[si+0Eh], ax
		jle	short loc_1EA2_578
		mul	word ptr [si+0Ch]
		add	[si], ax
		adc	[si+2],	dx
		jmp	loc_1EA2_776
; ---------------------------------------------------------------------------

loc_1EA2_50E:				; CODE XREF: ResetImageData+3B4j
		jmp	short loc_1EA2_578
; ---------------------------------------------------------------------------
		nop

loc_1EA2_511:				; DATA XREF: ResetImageData+33Ao
		mov	ax, [si+2]
		mov	dx, cs:g_pSprite1.dwLeft2
		mov	[si+8],	dx
		sub	ax, dx
		mov	cx, ax
		inc	cx
		mov	[si+0Eh], cx
		mul	word ptr [si+0Ch]
		add	ax, [si+4]
		adc	dx, [si+6]
		add	ax, 8000h
		adc	dx, 0
		mov	ax, [si+0Ah]
		sub	ax, dx
		mov	[si+0Ah], dx
		add	[si+16h], ax
		jmp	loc_1EA2_776
; ---------------------------------------------------------------------------

loc_1EA2_541:				; DATA XREF: ResetImageData+33Co
		mov	cx, [si+2]
		mov	ax, cs:g_pSprite1.dwLeft2
		mov	[si+2],	ax
		sub	ax, cx
		sub	[si+0Eh], ax
		mul	word ptr [si+0Ch]
		mov	bx, [si+4]
		mov	cx, [si+6]
		add	ax, bx
		adc	dx, cx
		mov	[si+4],	ax
		mov	[si+6],	dx
		add	bx, 8000h
		adc	cx, 0
		add	ax, 8000h
		adc	dx, 0
		sub	dx, cx
		add	[si+14h], dx
		jmp	loc_1EA2_776
; ---------------------------------------------------------------------------

loc_1EA2_578:				; CODE XREF: ResetImageData+3CBj
					; ResetImageData:loc_1EA2_50Ej
					; DATA XREF: ...
		mov	dx, 2

loc_1EA2_57B:				; CODE XREF: ResetImageData+72j
					; ResetImageData+85j ...
		mov	[si+13h], dl
		mov	word ptr [si+0Eh], 0
		mov	al, [si+13h]
		test	al, 4
		jz	short loc_1EA2_59E
		mov	bx, cs:g_pSprite1.dwTop
		mov	[si+6],	bx
		mov	word ptr [si+4], 0
		dec	bx
		mov	[si+0Ah], bx
		jmp	short loc_1EA2_5F7
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_59E:				; CODE XREF: ResetImageData+452j
		test	al, 8
		jz	short loc_1EA2_5B2
		mov	bx, cs:g_pSprite1.dwHeight
		mov	[si+6],	bx
		mov	word ptr [si+4], 0
		jmp	short loc_1EA2_5F7
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_5B2:				; CODE XREF: ResetImageData+46Aj
		mov	cx, [si+0Ah]
		cmp	cx, cs:g_pSprite1.dwHeight
		jl	short loc_1EA2_5C2
		mov	cx, cs:g_pSprite1.dwHeight
		dec	cx

loc_1EA2_5C2:				; CODE XREF: ResetImageData+484j
		mov	dx, [si+6]
		mov	bx, [si+4]
		add	bx, 8000h
		adc	dx, 0
		cmp	dx, cs:g_pSprite1.dwTop
		jge	short loc_1EA2_5DB
		mov	dx, cs:g_pSprite1.dwTop

loc_1EA2_5DB:				; CODE XREF: ResetImageData+49Ej
		mov	[si+6],	dx
		mov	word ptr [si+4], 0
		sub	cx, dx
		dec	dx
		inc	cx
		mov	[si+0Ah], dx
		test	al, 2
		jz	short loc_1EA2_5F4
		add	[si+16h], cx
		jmp	short loc_1EA2_5F7
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_5F4:				; CODE XREF: ResetImageData+4B6j
		add	[si+1Ah], cx

loc_1EA2_5F7:				; CODE XREF: ResetImageData+465j
					; ResetImageData+479j ...
		xor	ah, ah
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5FF:				; CODE XREF: ResetImageData+15Ej
					; ResetImageData+647j
					; DATA XREF: ...
		mov	bl, [si+12h]
		xor	bh, bh
		shl	bx, 1
		jmp	cs:word_1EA2_60B[bx]
; ---------------------------------------------------------------------------
word_1EA2_60B	dw 0			; DATA XREF: ResetImageData+4D0r
		dw 0
		dw offset loc_1EA2_61D
		dw offset loc_1EA2_623
		dw offset loc_1EA2_63C
		dw offset loc_1EA2_656
		dw offset loc_1EA2_683
		dw offset loc_1EA2_6B7
		dw offset loc_1EA2_6F0
; ---------------------------------------------------------------------------

loc_1EA2_61D:				; CODE XREF: ResetImageData+53Aj
					; ResetImageData+55Dj
					; DATA XREF: ...
		mov	dx, 1
		jmp	loc_1EA2_57B
; ---------------------------------------------------------------------------

loc_1EA2_623:				; DATA XREF: ResetImageData+4DBo
		mov	cx, [si+2]
		mov	ax, cs:g_pSprite1.dwWidthSum
		dec	ax
		mov	[si+2],	ax
		sub	cx, ax
		add	[si+6],	cx
		sub	[si+0Eh], cx
		add	[si+18h], cx
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_63C:				; DATA XREF: ResetImageData+4DDo
		mov	cx, cs:g_pSprite1.dwWidthSum
		dec	cx
		mov	ax, [si+8]
		mov	[si+8],	cx
		sub	ax, cx
		add	[si+1Ah], ax
		sub	[si+0Eh], ax
		sub	[si+0Ah], ax
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_656:				; DATA XREF: ResetImageData+4DFo
		mov	ax, [si]
		mov	dx, [si+2]
		sub	dx, cs:g_pSprite1.dwWidthSum
		inc	dx
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		sub	[si+0Eh], ax
		jle	short loc_1EA2_61D
		add	[si+6],	ax
		add	[si+18h], ax
		mul	word ptr [si+0Ch]
		sub	[si], ax
		sbb	[si+2],	dx
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_683:				; DATA XREF: ResetImageData+4E1o
		mov	dx, cs:g_pSprite1.dwWidthSum
		dec	dx
		mov	[si+8],	dx
		xor	ax, ax
		sub	ax, [si]
		sbb	dx, [si+2]
		jl	short loc_1EA2_61D
		mov	cx, [si+0Ch]
		div	cx
		shr	cx, 1
		sub	cx, dx
		adc	ax, 0
		inc	ax
		mov	cx, [si+0Eh]
		mov	[si+0Eh], ax
		sub	cx, ax
		add	[si+1Ah], cx
		dec	ax
		add	ax, [si+6]
		mov	[si+0Ah], ax
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_6B7:				; DATA XREF: ResetImageData+4E3o
		mov	ax, [si+2]
		mov	cx, cs:g_pSprite1.dwWidthSum
		dec	cx
		sub	ax, cx
		mov	[si+2],	cx
		sub	[si+0Eh], ax
		mul	word ptr [si+0Ch]
		mov	bx, [si+4]
		mov	cx, [si+6]
		add	ax, bx
		adc	dx, cx
		mov	[si+4],	ax
		mov	[si+6],	dx
		add	bx, 8000h
		adc	cx, 0
		add	ax, 8000h
		adc	dx, 0
		sub	dx, cx
		add	[si+18h], dx
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_6F0:				; DATA XREF: ResetImageData+4E5o
		mov	ax, cs:g_pSprite1.dwWidthSum
		mov	cx, ax
		dec	cx
		mov	[si+8],	cx
		sub	ax, [si+2]
		mov	[si+0Eh], ax
		dec	ax
		mul	word ptr [si+0Ch]
		add	ax, [si+4]
		adc	dx, [si+6]
		add	ax, 8000h
		adc	dx, 0
		mov	ax, [si+0Ah]
		sub	ax, dx
		mov	[si+0Ah], dx
		add	[si+1Ah], ax
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_71E:				; CODE XREF: ResetImageData+1B7j
					; ResetImageData+1C0j ...
		test	word ptr [bp-2], 8
		jz	short loc_1EA2_728
		jmp	loc_1EA2_385
; ---------------------------------------------------------------------------

loc_1EA2_728:				; CODE XREF: ResetImageData+27Cj
					; ResetImageData+285j ...
		xor	dx, dx
		mov	ax, [si+2]
		cmp	ax, cs:g_pSprite1.dwLeft2
		jge	short loc_1EA2_737
		or	dh, 2

loc_1EA2_737:				; CODE XREF: ResetImageData+5FCj
		mov	bx, [si]
		add	bx, 8000h
		adc	ax, 0
		cmp	ax, cs:g_pSprite1.dwWidthSum
		jl	short loc_1EA2_74A
		or	dh, 1

loc_1EA2_74A:				; CODE XREF: ResetImageData+60Fj
		mov	ax, [si+8]
		cmp	ax, cs:g_pSprite1.dwLeft2
		jge	short loc_1EA2_757
		or	dl, 2

loc_1EA2_757:				; CODE XREF: ResetImageData+61Cj
		cmp	ax, cs:g_pSprite1.dwWidthSum
		jl	short loc_1EA2_761
		or	dl, 1

loc_1EA2_761:				; CODE XREF: ResetImageData+626j
		test	dl, dh
		jz	short loc_1EA2_76A
		and	dl, dh
		jmp	loc_1EA2_57B
; ---------------------------------------------------------------------------

loc_1EA2_76A:				; CODE XREF: ResetImageData+62Dj
		or	dl, dh
		jz	short loc_1EA2_780
		xor	dh, dh
		mov	[bp-2],	dx
		jmp	loc_1EA2_28D
; ---------------------------------------------------------------------------

loc_1EA2_776:				; CODE XREF: ResetImageData+354j
					; ResetImageData+36Dj ...
		test	word ptr [bp-2], 1
		jz	short loc_1EA2_780
		jmp	loc_1EA2_5FF
; ---------------------------------------------------------------------------

loc_1EA2_780:				; CODE XREF: ResetImageData+636j
					; ResetImageData+645j
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_783:				; CODE XREF: ResetImageData+54j
		mov	byte ptr [si+12h], 1
		cmp	cx, dx
		jnz	short loc_1EA2_78F
		mov	byte ptr [si+12h], 9

loc_1EA2_78F:				; CODE XREF: ResetImageData+653j
		jle	short loc_1EA2_79D
		mov	byte ptr [si+12h], 0
		mov	[si+2],	dx
		mov	[si+8],	cx
		xchg	cx, dx

loc_1EA2_79D:				; CODE XREF: ResetImageData:loc_1EA2_78Fj
		cmp	[bp+var_4], 0
		jnz	short loc_1EA2_7C4
		mov	bx, cs:g_pSprite1.dwTop
		cmp	ax, bx
		jge	short loc_1EA2_7CD
		mov	al, 4
		mov	[si+6],	bx
		mov	[si+0Ah], bx

loc_1EA2_7B4:				; CODE XREF: ResetImageData+6A8j
					; ResetImageData+6C3j ...
		mov	[si+13h], al
		mov	word ptr [si+0Eh], 0
		xor	ah, ah
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_7C4:				; CODE XREF: ResetImageData+66Bj
		sub	dx, cx
		inc	dx
		mov	[si+0Eh], dx
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_7CD:				; CODE XREF: ResetImageData+674j
		mov	bx, cs:g_pSprite1.dwHeight
		cmp	ax, bx
		jl	short loc_1EA2_7E0
		mov	al, 8
		mov	[si+6],	bx
		mov	[si+0Ah], bx
		jmp	short loc_1EA2_7B4
; ---------------------------------------------------------------------------

loc_1EA2_7E0:				; CODE XREF: ResetImageData+69Ej
		mov	ax, dx
		sub	ax, cx
		inc	ax
		mov	[si+0Eh], ax
		cmp	dx, cs:g_pSprite1.dwLeft2
		jge	short loc_1EA2_7FB
		dec	word ptr [si+0Ah]
		mov	word ptr [si+16h], 1
		mov	al, 2
		jmp	short loc_1EA2_7B4
; ---------------------------------------------------------------------------

loc_1EA2_7FB:				; CODE XREF: ResetImageData+6B7j
		cmp	cx, cs:g_pSprite1.dwWidthSum
		jl	short loc_1EA2_80E
		dec	word ptr [si+0Ah]
		mov	word ptr [si+1Ah], 1
		mov	al, 1
		jmp	short loc_1EA2_7B4
; ---------------------------------------------------------------------------

loc_1EA2_80E:				; CODE XREF: ResetImageData+6CAj
		mov	ax, cs:g_pSprite1.dwLeft2
		mov	bx, ax
		sub	ax, cx
		jle	short loc_1EA2_81E
		mov	[si+2],	bx
		sub	[si+0Eh], ax

loc_1EA2_81E:				; CODE XREF: ResetImageData+6E0j
		mov	ax, dx
		mov	bx, cs:g_pSprite1.dwWidthSum
		dec	bx
		sub	ax, bx
		jle	short loc_1EA2_830
		sub	[si+0Eh], ax
		mov	[si+8],	bx

loc_1EA2_830:				; CODE XREF: ResetImageData+6F2j
		jmp	loc_1EA2_2B9
; ---------------------------------------------------------------------------

loc_1EA2_833:				; CODE XREF: ResetImageData:loc_1EA2_209j
		mov	cx, [si+0Ah]
		sar	cx, 1
		mov	ax, [si+6]
		sar	ax, 1
		sub	cx, ax
		sar	cx, 1
		mov	dx, [si+8]
		sar	dx, 1
		mov	ax, [si+2]
		sar	ax, 1
		sub	dx, ax
		sar	dx, 1

loc_1EA2_84F:				; CODE XREF: ResetImageData+758j
		cmp	word ptr [si+6], 0C180h
		jg	short loc_1EA2_890

loc_1EA2_856:				; CODE XREF: ResetImageData+766j
					; ResetImageData+76Dj
		mov	ax, [si+6]
		add	ax, cx
		mov	[si+6],	ax
		mov	bx, ax
		sub	ax, cs:g_pSprite1.dwTop
		jle	short loc_1EA2_88B
		cmp	ax, cx
		jle	short loc_1EA2_86D
		mov	ax, cx

loc_1EA2_86D:				; CODE XREF: ResetImageData+733j
		sub	bx, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_878
		sub	ax, bx
		jle	short loc_1EA2_88B

loc_1EA2_878:				; CODE XREF: ResetImageData+73Cj
		mov	bx, [si+2]
		cmp	bx, cs:g_pSprite1.dwLeft2
		jge	short loc_1EA2_888
		add	[si+14h], ax
		jmp	short loc_1EA2_88B
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_888:				; CODE XREF: ResetImageData+74Aj
		add	[si+18h], ax

loc_1EA2_88B:				; CODE XREF: ResetImageData+72Fj
					; ResetImageData+740j ...
		add	[si+2],	dx
		jmp	short loc_1EA2_84F
; ---------------------------------------------------------------------------

loc_1EA2_890:				; CODE XREF: ResetImageData+71Ej
					; ResetImageData+7BCj
		cmp	word ptr [si+0Ah], 3E80h
		jge	short loc_1EA2_8B6
		cmp	word ptr [si+2], 0C180h
		jle	short loc_1EA2_856
		cmp	word ptr [si+2], 3E80h
		jge	short loc_1EA2_856
		cmp	word ptr [si+8], 0C180h
		jle	short loc_1EA2_8B6
		cmp	word ptr [si+8], 3E80h
		jge	short loc_1EA2_8B6
		jmp	loc_1EA2_18D
; ---------------------------------------------------------------------------

loc_1EA2_8B6:				; CODE XREF: ResetImageData+75Fj
					; ResetImageData+774j ...
		mov	ax, [si+0Ah]
		sub	ax, cx
		mov	[si+0Ah], ax
		mov	bx, ax
		sub	ax, cs:g_pSprite1.dwHeight
		inc	ax
		jge	short loc_1EA2_8EF
		neg	ax
		cmp	ax, cx
		jle	short loc_1EA2_8D0
		mov	ax, cx

loc_1EA2_8D0:				; CODE XREF: ResetImageData+796j
		sub	bx, cs:g_pSprite1.dwTop
		inc	bx
		jge	short loc_1EA2_8DC
		add	ax, bx
		jle	short loc_1EA2_8EF

loc_1EA2_8DC:				; CODE XREF: ResetImageData+7A0j
		mov	bx, [si+8]
		cmp	bx, cs:g_pSprite1.dwLeft2
		jge	short loc_1EA2_8EC
		add	[si+16h], ax
		jmp	short loc_1EA2_8EF
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_8EC:				; CODE XREF: ResetImageData+7AEj
		add	[si+1Ah], ax

loc_1EA2_8EF:				; CODE XREF: ResetImageData+790j
					; ResetImageData+7A4j ...
		sub	[si+8],	dx
		jmp	short loc_1EA2_890
ResetImageData	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ShlALot		proc far		; CODE XREF: Maybe2dShParse+1E7P
					; Maybe2dShParse+20BP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_2]
		xor	dx, dx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	ax, [bp+arg_0]
		adc	dx, 0
		pop	bp
		retf
ShlALot		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ShrALot		proc far		; CODE XREF: Maybe2dShParse+1F7P

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_2]
		mov	dx, [bp+arg_0]
		mov	ax, dx
		shr	bx, 1
		rcr	dx, 1
		shr	bx, 1
		rcr	dx, 1
		shr	bx, 1
		rcr	dx, 1
		shr	bx, 1
		rcr	dx, 1
		and	ax, 0Fh
		pop	bp
		retf
ShrALot		endp

; ---------------------------------------------------------------------------
g_wPsp90Copy1	dw 0			; DATA XREF: SetCritErrHandl+29w
					; SomeCritExitHandler+5r ...
g_wPsp90Copy2	dw 0			; DATA XREF: SetCritErrHandl+31w
					; SomeCritExitHandler+1r ...
g_wExitCopy1	dw 0			; DATA XREF: SomeIntrHandler3+Co
					; SetCritErrHandl+14w
g_wExitCopy2	dw 0			; DATA XREF: SetCritErrHandl+1Bw

; =============== S U B	R O U T	I N E =======================================


SomeIntrHandler3 proc far		; DATA XREF: SetCritErrHandl+35o
		push	bx
		push	dx
		push	cx
		push	si
		push	di
		push	ds
		push	es
		push	bp
		mov	ax, ss
		mov	ds, ax
		mov	bx, offset g_wExitCopy1
		call	dword ptr cs:[bx]
		pop	bp
		pop	es
		pop	ds
		pop	di
		pop	si
		pop	cx
		pop	dx
		pop	bx
		iret
SomeIntrHandler3 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetCritErrHandl	proc far		; CODE XREF: SetVideoMode+28BP

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	ds
		push	cs
		mov	ax, offset SomeCritExitHandler
		push	ax
		call	AddExitHandler
		add	sp, 4
		mov	ax, [bp+arg_0]
		mov	cs:g_wExitCopy1, ax
		mov	ax, [bp+arg_2]
		mov	cs:g_wExitCopy2, ax
		xor	ax, ax
		mov	es, ax
		assume es:nothing
		mov	bx, 90h
		mov	ax, es:[bx]	; look into psp[0x90] ?
		mov	cs:g_wPsp90Copy1, ax
		mov	ax, es:[bx+2]
		mov	cs:g_wPsp90Copy2, ax
		mov	dx, offset SomeIntrHandler3
		mov	ax, cs
		mov	ds, ax
		assume ds:seg012
		mov	al, 24h
		mov	ah, 25h
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		assume ds:dseg
		pop	bp
		retf
SetCritErrHandl	endp


; =============== S U B	R O U T	I N E =======================================


SomeCritExitHandler proc far		; DATA XREF: SetCritErrHandl+5o
		push	ds
		mov	ax, cs:g_wPsp90Copy2
		sub	ax, cs:g_wPsp90Copy1
		jz	short loc_1EA2_9B8
		mov	dx, cs:g_wPsp90Copy1
		mov	ds, cs:g_wPsp90Copy2
		mov	al, 24h	; '$'
		mov	ah, 25h
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt

loc_1EA2_9B8:				; CODE XREF: SomeCritExitHandler+Aj
		pop	ds
		retf
SomeCritExitHandler endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DeriveSpriteOpReset proc far		; CODE XREF: sub_14D6_1296+146P

var_A		= byte ptr -0Ah
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch
arg_A		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	si, [bp+arg_A]
		mov	[bp+var_A], 1
		jmp	short loc_1EA2_9DD
; ---------------------------------------------------------------------------
		nop
		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	si, [bp+arg_A]
		mov	[bp+var_A], 0

loc_1EA2_9DD:				; CODE XREF: DeriveSpriteOpReset+10j
					; DoDeriveSpriteOpRese+10j ...
		mov	ax, [bp+arg_2]
		mov	g_wSpriteOpFlag, ax
		mov	ax, [bp+arg_6]
		mov	word_2B77_4BB0,	ax
		mov	ax, [bp+arg_4]
		mov	[bp+arg_2], ax
		mov	ax, [bp+arg_8]
		mov	[bp+arg_4], ax
		mov	ax, offset SpriteOp6
		mov	g_wSpriteFuncOf, ax
		mov	ax, offset ImageResetRende
		mov	g_wImageFuncOfs, ax
		jmp	loc_1EA2_2DEA
DeriveSpriteOpReset endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoDeriveSpriteOpRese proc far

var_A		= byte ptr -0Ah
arg_8		= byte ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		lea	si, [bp+arg_8]
		mov	[bp+var_A], 0
		jmp	short loc_1EA2_9DD
DoDeriveSpriteOpRese endp

; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		lea	si, [bp+0Eh]
		mov	byte ptr [bp-0Ah], 1
		jmp	short loc_1EA2_9DD
; ---------------------------------------------------------------------------
word_1EA2_A28	dw 32h			; DATA XREF: ResetImageData:loc_1EA2_22Fr
byte_1EA2_A2A	db 8Ch,	0Ah, 8Ch, 0Ah, 8Ch, 0Ah, 8Eh, 0Ah, 92h,	0Ah, 98h
					; DATA XREF: ResetImageData+104r
		db 0Ah,	0A0h, 0Ah, 0AAh, 0Ah, 0B6h, 0Ah, 0C4h, 0Ah, 0D4h
		db 0Ah,	0E6h, 0Ah, 0FAh, 0Ah, 10h, 0Bh,	28h, 0Bh, 42h
		db 0Bh,	5Eh, 0Bh, 7Ch, 0Bh, 9Ch, 0Bh, 0BEh, 0Bh, 0E2h
		db 0Bh,	8, 0Ch,	30h, 0Ch, 5Ah, 0Ch, 86h, 0Ch, 0B4h, 0Ch
		db 0E4h, 0Ch, 16h, 0Dh,	4Ah, 0Dh, 80h, 0Dh, 0B8h, 0Dh
		db 0F2h, 0Dh, 2Eh, 0Eh,	6Ch, 0Eh, 0ACh,	0Eh, 0EEh, 0Eh
		db 32h,	0Fh, 78h, 0Fh, 0C0h, 0Fh, 0Ah, 10h, 56h, 10h, 0A4h
		db 10h,	0F4h, 10h, 46h,	11h, 9Ah, 11h, 0F0h, 11h, 48h
		db 12h,	0A2h, 12h, 0FEh, 12h, 5Ch, 13h,	0, 80h,	2 dup(55h)
		db 2 dup(0AAh),	0, 40h,	0, 80h,	0, 0C0h, 2 dup(33h), 2 dup(66h)
		db 2 dup(99h), 2 dup(0CCh), 0AAh, 2Ah, 2 dup(55h), 0, 80h
		db 2 dup(0AAh),	55h, 0D5h, 92h,	2 dup(24h), 49h, 0B6h
		db 6Dh,	49h, 92h, 0DBh,	0B6h, 6Dh, 0DBh, 0, 20h, 0, 40h
		db 0, 60h, 0, 80h, 0, 0A0h, 0, 0C0h, 0,	0E0h, 71h, 1Ch
		db 0E3h, 38h, 2	dup(55h), 0C7h,	71h, 38h, 8Eh, 2 dup(0AAh)
		db 1Ch,	0C7h, 8Eh, 0E3h, 99h, 19h, 2 dup(33h), 0CCh, 4Ch
		db 2 dup(66h), 0, 80h, 2 dup(99h), 33h,	0B3h, 2	dup(0CCh)
		db 66h,	0E6h, 45h, 17h,	8Bh, 2Eh, 0D1h,	45h, 17h, 2 dup(5Dh)
		db 74h,	0A2h, 8Bh, 0E8h, 0A2h, 2Eh, 0BAh, 74h, 0D1h, 0BAh
		db 0E8h, 55h, 15h, 0AAh, 2Ah, 0, 40h, 2	dup(55h), 0AAh
		db 6Ah,	0, 80h,	55h, 95h, 2 dup(0AAh), 0, 0C0h,	55h, 0D5h
		db 0AAh, 0EAh, 0B1h, 13h, 62h, 27h, 13h, 3Bh, 0C4h, 4Eh
		db 76h,	62h, 27h, 76h, 0D8h, 2 dup(89h), 9Dh, 3Bh, 0B1h
		db 0ECh, 0C4h, 9Dh, 0D8h, 4Eh, 0ECh, 49h, 12h, 92h, 24h
		db 0DBh, 36h, 24h, 49h,	6Dh, 5Bh, 0B6h,	6Dh, 0,	80h, 49h
		db 2 dup(92h), 0A4h, 0DBh, 0B6h, 24h, 0C9h, 6Dh, 0DBh
		db 0B6h, 0EDh, 2 dup(11h), 2 dup(22h), 2 dup(33h), 2 dup(44h)
		db 2 dup(55h), 2 dup(66h), 2 dup(77h), 2 dup(88h), 2 dup(99h)
		db 2 dup(0AAh),	2 dup(0BBh), 2 dup(0CCh), 2 dup(0DDh)
		db 2 dup(0EEh),	0, 10h,	0, 20h,	0, 30h,	0, 40h,	0, 50h
		db 0, 60h, 0, 70h, 0, 80h, 0, 90h, 0, 0A0h, 0, 0B0h, 0
		db 0C0h, 0, 0D0h, 0, 0E0h, 0, 0F0h, 2 dup(0Fh),	2 dup(1Eh)
		db 2 dup(2Dh), 2 dup(3Ch), 2 dup(4Bh), 2 dup(5Ah), 2 dup(69h)
		db 2 dup(78h), 2 dup(87h), 2 dup(96h), 2 dup(0A5h), 2 dup(0B4h)
		db 2 dup(0C3h),	2 dup(0D2h), 2 dup(0E1h), 2 dup(0F0h)
		db 38h,	0Eh, 71h, 1Ch, 0AAh, 2Ah, 0E3h,	38h, 1Ch, 47h
		db 2 dup(55h), 8Eh, 63h, 0C7h, 71h, 0, 80h, 38h, 8Eh, 71h
		db 9Ch,	2 dup(0AAh), 0E3h, 0B8h, 1Ch, 0C7h, 55h, 0D5h
		db 8Eh,	0E3h, 0C7h, 0F1h, 79h, 0Dh, 0F2h, 1Ah, 6Bh, 28h
		db 0E5h, 35h, 5Eh, 43h,	0D7h, 2	dup(50h), 5Eh, 0CAh, 6Bh
		db 43h,	79h, 0BCh, 86h,	35h, 94h, 0AFh,	0A1h, 28h, 0AFh
		db 0A1h, 0BCh, 1Ah, 0CAh, 94h, 0D7h, 0Dh, 0E5h,	86h, 0F2h
		db 0CCh, 0Ch, 99h, 19h,	66h, 26h, 2 dup(33h), 0, 40h, 0CCh
		db 4Ch,	99h, 59h, 2 dup(66h), 33h, 73h,	0, 80h,	0CCh, 8Ch
		db 2 dup(99h), 66h, 0A6h, 33h, 0B3h, 0,	0C0h, 2	dup(0CCh)
		db 99h,	0D9h, 66h, 0E6h, 33h, 0F3h, 30h, 0Ch, 61h, 18h
		db 92h,	24h, 0C3h, 30h,	0F3h, 3Ch, 24h,	49h, 2 dup(55h)
		db 86h,	61h, 0B6h, 6Dh,	0E7h, 79h, 18h,	86h, 49h, 92h
		db 79h,	9Eh, 2 dup(0AAh), 0DBh,	0B6h, 0Ch, 0C3h, 3Ch, 0CFh
		db 6Dh,	0DBh, 9Eh, 0E7h, 0CFh, 0F3h, 0A2h, 0Bh,	45h, 17h
		db 0E8h, 22h, 8Bh, 2 dup(2Eh), 3Ah, 0D1h, 45h, 74h, 51h
		db 17h,	5Dh, 0BAh, 68h,	5Dh, 74h, 0, 80h, 0A2h,	8Bh, 45h
		db 97h,	0E8h, 0A2h, 8Bh, 0AEh, 2Eh, 0BAh, 0D1h,	0C5h, 74h
		db 0D1h, 17h, 0DDh, 0BAh, 0E8h,	5Dh, 0F4h, 21h,	0Bh, 42h
		db 16h,	64h, 21h, 85h, 2Ch, 0A6h, 37h
byte_1EA2_C66	db 0C8h, 42h, 0E9h, 4Dh, 0Bh, 59h, 2Ch,	64h, 4Dh, 2 dup(6Fh)
		db 7Ah,	90h, 85h, 0B2h,	90h, 0D3h, 9Bh,	0F4h, 0A6h, 16h
		db 0B2h, 37h, 0BDh, 59h, 0C8h, 7Ah, 0D3h, 9Bh, 0DEh, 0BDh
		db 0E9h, 0DEh, 0F4h, 0AAh, 0Ah,	55h, 15h, 0, 20h, 0AAh
		db 2Ah,	55h, 35h, 0, 40h, 0AAh,	4Ah, 2 dup(55h), 0, 60h
		db 0AAh, 6Ah, 55h, 75h,	0, 80h,	0AAh, 8Ah, 55h,	95h, 0
		db 0A0h, 2 dup(0AAh), 55h, 0B5h, 0, 0C0h, 0AAh,	0CAh, 55h
		db 0D5h, 0, 0E0h, 0AAh,	0EAh, 55h, 0F5h, 3Dh, 0Ah, 7Ah
		db 14h,	0B8h, 1Eh, 0F5h, 28h, 2	dup(33h), 70h, 3Dh, 0AEh
		db 47h,	0EBh, 51h, 28h,	5Ch, 2 dup(66h), 0A3h, 70h, 0E1h
		db 7Ah,	1Eh, 85h, 5Ch, 8Fh, 2 dup(99h),	0D7h, 0A3h, 14h
		db 0AEh, 51h, 0B8h, 8Fh, 0C2h, 2 dup(0CCh), 0Ah, 0D7h
		db 47h,	0E1h, 85h, 0EBh, 0C2h, 0F5h, 0D8h, 9, 0B1h, 13h
		db 89h,	1Dh, 62h, 27h, 3Bh, 31h, 13h, 3Bh, 0ECh, 44h, 0C4h
		db 4Eh,	9Dh, 58h, 76h, 62h, 4Eh, 6Ch, 27h, 76h,	0, 80h
		db 0D8h, 89h, 0B1h, 93h, 89h, 9Dh, 62h,	0A7h, 3Bh, 0B1h
		db 13h,	0BBh, 0ECh, 2 dup(0C4h), 0CEh, 9Dh, 0D8h, 76h
		db 0E2h, 4Eh, 0ECh, 27h, 0F6h, 7Bh, 9, 0F6h, 12h, 71h
		db 1Ch,	0EDh, 25h, 68h,	2Fh, 0E3h, 38h,	5Eh, 42h, 0DAh
		db 4Bh,	2 dup(55h), 0D0h, 5Eh, 4Bh, 68h, 0C7h, 71h, 42h
		db 7Bh,	0BDh, 84h, 38h,	8Eh, 0B4h, 97h,	2Fh, 0A1h, 2 dup(0AAh)
		db 25h,	0B4h, 0A1h, 0BDh, 1Ch, 0C7h, 97h, 0D0h,	12h, 0DAh
		db 8Eh,	0E3h, 9, 0EDh, 84h, 0F6h, 24h, 9, 49h, 12h, 6Dh
		db 1Bh,	92h, 24h, 0B6h,	2Dh, 0DBh, 36h,	0, 40h,	24h, 2 dup(49h)
		db 52h,	6Dh, 5Bh, 92h, 64h, 0B6h, 6Dh, 0DBh, 76h, 0, 80h
		db 24h,	89h, 49h, 92h, 6Dh, 9Bh, 92h, 0A4h, 0B6h, 0ADh
		db 0DBh, 0B6h, 0, 0C0h,	24h, 0C9h, 49h,	0D2h, 6Dh, 0DBh
		db 92h,	0E4h, 0B6h, 0EDh, 0DBh,	0F6h, 0D3h, 8, 0A7h, 11h
		db 7Bh,	1Ah, 4Fh, 2 dup(23h), 2Ch, 0F7h, 34h, 0CBh, 3Dh
		db 9Eh,	46h, 72h, 4Fh, 46h, 58h, 1Ah, 61h, 0EEh, 69h, 0C2h
		db 72h,	96h, 7Bh, 69h, 84h, 3Dh, 8Dh, 11h, 96h,	0E5h, 9Eh
		db 0B9h, 0A7h, 8Dh, 0B0h, 61h, 0B9h, 34h, 0C2h,	8, 0CBh
		db 0DCh, 0D3h, 0B0h, 0DCh, 84h,	0E5h, 58h, 0EEh, 2Ch, 0F7h
		db 88h,	8, 2 dup(11h), 99h, 19h, 2 dup(22h), 0AAh, 2Ah
		db 2 dup(33h), 0BBh, 3Bh, 2 dup(44h), 0CCh, 4Ch, 2 dup(55h)
		db 0DDh, 5Dh, 2	dup(66h), 0EEh,	6Eh, 2 dup(77h), 0, 80h
		db 2 dup(88h), 11h, 91h, 2 dup(99h), 22h, 0A2h,	2 dup(0AAh)
		db 33h,	0B3h, 2	dup(0BBh), 44h,	0C4h, 2	dup(0CCh), 55h
		db 0D5h, 2 dup(0DDh), 66h, 0E6h, 2 dup(0EEh), 77h, 0F7h
		db 42h,	8, 84h,	10h, 0C6h, 18h,	8, 21h,	4Ah, 29h, 8Ch
		db 31h,	0CEh, 39h, 10h,	42h, 52h, 4Ah, 94h, 52h, 0D6h
		db 5Ah,	18h, 63h, 5Ah, 6Bh, 9Ch, 73h, 0DEh, 7Bh, 21h, 84h
		db 63h,	8Ch, 0A5h, 94h,	0E7h, 9Ch, 29h,	0A5h, 6Bh, 2 dup(0ADh)
		db 0B5h, 0EFh, 0BDh, 31h, 0C6h,	73h, 0CEh, 0B5h, 0D6h
		db 0F7h, 0DEh, 39h, 0E7h, 7Bh, 0EFh, 0BDh, 0F7h, 0, 8
		db 0, 10h, 0, 18h, 0, 20h, 0, 28h, 0, 30h, 0, 38h, 0, 40h
		db 0, 48h, 0, 50h, 0, 58h, 0, 60h, 0, 68h, 0, 70h, 0, 78h
		db 0, 80h, 0, 88h, 0, 90h, 0, 98h, 0, 0A0h, 0, 0A8h, 0
		db 0B0h, 0, 0B8h, 0, 0C0h, 0, 0C8h, 0, 0D0h, 0,	0D8h, 0
		db 0E0h, 0, 0E8h, 0, 0F0h, 0, 0F8h, 0C1h, 7, 83h, 0Fh
		db 45h,	17h, 7,	1Fh, 0C9h, 26h,	8Bh, 2Eh, 4Dh, 36h, 0Fh
		db 3Eh,	0D1h, 45h, 93h
		db 4Dh,	2 dup(55h), 17h, 5Dh, 0D9h, 64h, 9Bh, 6Ch, 5Dh
		db 74h,	1Fh, 7Ch, 0E0h,	83h, 0A2h, 8Bh,	64h, 93h, 26h
		db 9Bh,	0E8h, 0A2h, 2 dup(0AAh), 6Ch, 0B2h, 2Eh, 0BAh
		db 0F0h, 0C1h, 0B2h, 0C9h, 74h,	0D1h, 36h, 0D9h, 0F8h
		db 0E0h, 0BAh, 0E8h, 7Ch, 0F0h,	3Eh, 0F8h, 87h,	7, 2 dup(0Fh)
		db 96h,	16h, 2 dup(1Eh), 0A5h, 25h, 2 dup(2Dh),	0B4h, 34h
		db 2 dup(3Ch), 0C3h, 43h, 2 dup(4Bh), 0D2h, 52h, 2 dup(5Ah)
		db 0E1h, 61h, 2	dup(69h), 0F0h,	70h, 2 dup(78h), 0, 80h
		db 2 dup(87h), 0Fh, 8Fh, 2 dup(96h), 1Eh, 9Eh, 2 dup(0A5h)
		db 2Dh,	0ADh, 2	dup(0B4h), 3Ch,	0BCh, 2	dup(0C3h), 4Bh
		db 0CBh, 2 dup(0D2h), 5Ah, 0DAh, 2 dup(0E1h), 69h, 0E9h
		db 2 dup(0F0h),	78h, 0F8h, 50h,	7, 0A0h, 0Eh, 0F1h, 15h
		db 41h,	1Dh, 92h, 24h, 0E2h, 2Bh, 2 dup(33h), 83h, 3Ah
		db 0D4h, 41h, 24h, 49h,	75h, 50h, 0C5h,	57h, 15h, 5Fh
		db 2 dup(66h), 0B6h, 6Dh, 7, 75h, 57h, 7Ch, 0A8h, 83h
		db 0F8h, 8Ah, 49h, 92h,	2 dup(99h), 0EAh, 0A0h,	3Ah, 0A8h
		db 8Ah,	0AFh, 0DBh, 0B6h, 2Bh, 0BEh, 7Ch, 0C5h,	2 dup(0CCh)
		db 1Dh,	0D4h, 6Dh, 0DBh, 0BEh, 0E2h, 0Eh, 0EAh,	5Fh, 0F1h
		db 0AFh, 0F8h, 1Ch, 7, 38h, 0Eh, 55h, 15h, 71h,	1Ch, 8Eh
		db 23h,	0AAh, 2Ah, 0C7h, 31h, 0E3h, 38h, 0, 40h, 1Ch, 47h
		db 38h,	4Eh, 2 dup(55h), 71h, 5Ch, 8Eh,	63h, 0AAh, 6Ah
		db 0C7h, 71h, 0E3h, 78h, 0, 80h, 1Ch, 87h, 38h,	8Eh, 55h
		db 95h,	71h, 9Ch, 8Eh, 0A3h, 2 dup(0AAh), 0C7h,	0B1h, 0E3h
		db 0B8h, 0, 0C0h, 1Ch, 0C7h, 38h, 0CEh,	55h, 0D5h, 71h
		db 0DCh, 8Eh, 0E3h, 0AAh, 0EAh,	0C7h, 0F1h, 0E3h, 0F8h
		db 0EBh, 6, 0D6h, 0Dh, 0C1h, 14h, 0ACh,	1Bh, 98h, 22h
		db 83h,	29h, 6Eh, 30h, 59h, 37h, 45h, 3Eh, 30h,	45h, 1Bh
		db 4Ch,	6, 53h,	0F2h, 59h, 0DDh, 60h, 0C8h, 67h, 0B3h
		db 6Eh,	9Fh, 75h, 8Ah, 7Ch, 75h, 83h, 60h, 8Ah,	4Ch, 91h
		db 37h,	98h, 22h, 9Fh, 0Dh, 0A6h, 0F9h,	0ACh, 0E4h, 0B3h
		db 0CFh, 2 dup(0BAh), 0C1h, 0A6h, 0C8h,	91h, 0CFh, 7Ch
		db 0D6h, 67h, 0DDh, 53h, 0E4h, 3Eh, 0EBh, 29h, 0F2h, 14h
		db 0F9h, 0BCh, 6, 79h, 0Dh, 35h, 14h, 0F2h, 1Ah, 0AFh
		db 21h,	6Bh, 2 dup(28h), 2Fh, 0E5h, 35h, 0A1h, 3Ch, 5Eh
		db 43h,	1Ah, 4Ah, 0D7h,	50h, 94h, 57h, 50h, 5Eh, 0Dh, 65h
		db 0CAh, 6Bh, 86h, 72h,	43h, 79h, 0, 80h, 0BCh,	86h, 79h
		db 8Dh,	35h, 94h, 0F2h,	9Ah, 0AFh, 0A1h, 6Bh, 0A8h, 28h
		db 0AFh, 0E5h, 0B5h, 0A1h, 0BCh, 5Eh, 0C3h, 1Ah, 0CAh
		db 0D7h, 0D0h, 94h, 0D7h, 50h, 0DEh, 0Dh, 0E5h,	0CAh, 0EBh
		db 86h,	0F2h, 43h, 0F9h, 90h, 6, 20h, 0Dh, 0B1h, 13h, 41h
		db 1Ah,	0D2h, 20h, 62h,	27h, 0F2h, 2Dh,	83h, 34h, 13h
		db 3Bh,	0A4h, 41h, 34h,	48h, 0C4h, 4Eh,	2 dup(55h), 0E5h
		db 5Bh,	76h, 62h, 6, 69h, 96h, 6Fh, 27h, 76h, 0B7h, 7Ch
		db 48h,	83h, 0D8h, 89h,	69h, 90h, 0F9h,	96h, 89h, 9Dh
		db 1Ah,	0A4h, 2	dup(0AAh), 3Bh,	0B1h, 0CBh, 0B7h, 5Bh
		db 0BEh, 0ECh, 0C4h, 7Ch, 0CBh,	0Dh, 0D2h, 9Dh,	0D8h, 2Dh
		db 0DFh, 0BEh, 0E5h, 4Eh, 0ECh,	0DFh, 0F2h, 6Fh, 0F9h
		db 66h,	6, 0CCh, 0Ch, 33h, 13h,	99h, 19h, 0, 20h, 66h
		db 26h,	0CCh, 2Ch, 2 dup(33h), 99h, 39h, 0, 40h, 66h, 46h
		db 0CCh, 4Ch, 33h, 53h,	99h, 59h, 0, 60h, 2 dup(66h), 0CCh
		db 6Ch,	33h, 73h, 99h, 79h, 0, 80h, 66h, 86h, 0CCh, 8Ch
		db 33h,	93h, 2 dup(99h), 0, 0A0h, 66h, 0A6h, 0CCh, 0ACh
		db 33h,	0B3h, 99h, 0B9h, 0, 0C0h, 66h, 0C6h, 2 dup(0CCh)
		db 33h,	0D3h, 99h, 0D9h, 0, 0E0h, 66h, 0E6h, 0CCh
		db 0ECh, 33h, 0F3h, 99h, 0F9h, 3Eh, 6, 7Ch, 0Ch, 0BBh
		db 12h,	0F9h, 18h, 38h,	1Fh, 76h, 25h, 0B5h, 2Bh, 0F3h
		db 2 dup(31h), 38h, 70h, 3Eh, 0AEh, 44h, 0EDh, 4Ah, 2Bh
		db 51h,	6Ah, 57h, 0A8h,	5Dh, 0E7h, 63h,	25h, 6Ah, 63h
		db 70h,	0A2h, 76h, 0E0h, 7Ch, 1Fh, 83h,	5Dh, 89h, 9Ch
		db 8Fh,	0DAh, 95h, 18h,	9Ch, 57h, 0A2h,	95h, 0A8h, 0D4h
		db 0AEh, 12h, 0B5h, 51h, 0BBh, 8Fh, 0C1h, 0CEh,	0C7h, 0Ch
		db 0CEh, 4Ah, 0D4h, 89h, 0DAh, 0C7h, 0E0h, 6, 0E7h, 44h
		db 0EDh, 83h, 0F3h, 0C1h, 0F9h,	18h, 6,	30h, 0Ch, 49h
		db 12h,	61h, 18h, 79h, 1Eh, 92h, 24h, 0AAh, 2Ah, 0C3h
		db 30h,	0DBh, 36h, 0F3h, 3Ch, 0Ch, 43h,	24h, 49h, 3Ch
		db 4Fh,	2 dup(55h), 6Dh, 5Bh, 86h, 61h,	9Eh, 67h, 0B6h
		db 6Dh,	0CFh, 73h, 0E7h, 79h, 0, 80h, 18h, 86h,	30h, 8Ch
		db 49h,	92h, 61h, 98h, 79h, 9Eh, 92h, 0A4h, 2 dup(0AAh)
		db 0C3h, 0B0h, 0DBh, 0B6h, 0F3h, 0BCh, 0Ch, 0C3h, 24h
		db 0C9h, 3Ch, 0CFh, 55h, 0D5h, 6Dh, 0DBh, 86h, 0E1h, 9Eh
		db 0E7h, 0B6h, 0EDh, 0CFh, 0F3h, 0E7h, 0F9h, 0F4h, 5, 0E8h
		db 0Bh,	0DCh, 11h, 0D0h, 17h, 0C4h, 1Dh, 0B8h, 23h, 0ACh
		db 29h,	0A0h, 2Fh, 94h,	35h, 88h, 3Bh, 7Dh, 41h, 71h, 47h
		db 65h,	4Dh, 59h, 53h, 4Dh, 59h, 41h, 5Fh, 35h,	65h, 29h
		db 6Bh,	1Dh, 71h, 11h, 77h, 5, 7Dh, 0FAh, 82h, 0EEh, 88h
		db 0E2h, 8Eh, 0D6h, 94h, 0CAh, 9Ah, 0BEh, 0A0h,	0B2h, 2	dup(0A6h)
		db 0ACh, 9Ah, 0B2h, 8Eh, 0B8h, 82h, 0BEh, 77h, 0C4h, 6Bh
		db 0CAh, 5Fh, 0D0h, 53h, 0D6h, 47h, 0DCh, 3Bh, 0E2h, 2Fh
		db 0E8h, 23h, 0EEh, 17h, 0F4h, 0Bh, 0FAh, 0D1h,	5, 0A2h
		db 0Bh,	74h, 11h, 45h, 2 dup(17h), 1Dh,	0E8h, 22h, 0BAh
		db 28h,	8Bh, 2Eh, 5Dh, 34h, 2Eh, 3Ah, 0, 40h, 0D1h, 45h
		db 0A2h, 4Bh, 74h, 51h,	45h, 57h, 17h, 5Dh, 0E8h, 62h
		db 0BAh, 68h, 8Bh, 6Eh,	5Dh, 74h, 2Eh, 7Ah, 0, 80h, 0D1h
		db 85h,	0A2h, 8Bh, 74h,	91h, 45h, 97h, 17h, 9Dh, 0E8h
		db 0A2h, 0BAh, 0A8h, 8Bh, 0AEh,	5Dh, 0B4h, 2Eh,	0BAh, 0
		db 0C0h, 0D1h, 0C5h, 0A2h, 0CBh, 74h, 0D1h, 45h, 0D7h
		db 17h,	0DDh, 0E8h, 0E2h, 0BAh,	0E8h, 8Bh, 0EEh, 5Dh, 0F4h
		db 2Eh,	0FAh, 0B0h, 5, 60h, 0Bh, 2 dup(11h), 0C1h, 16h
		db 71h,	1Ch, 2 dup(22h), 0D2h, 27h, 82h, 2Dh, 2	dup(33h)
		db 0E3h, 38h, 93h, 3Eh,	2 dup(44h), 0F4h, 49h, 0A4h, 4Fh
		db 2 dup(55h), 5, 5Bh, 0B6h, 60h, 2 dup(66h), 16h, 6Ch
		db 0C7h, 71h, 2	dup(77h), 27h, 7Dh, 0D8h, 82h, 2 dup(88h)
		db 38h,	8Eh, 0E9h, 93h,	2 dup(99h), 49h, 9Fh, 0FAh, 0A4h
		db 2 dup(0AAh),	5Bh, 0B0h, 0Bh,	0B6h, 2	dup(0BBh), 6Ch
		db 0C1h, 1Ch, 0C7h, 2 dup(0CCh), 7Dh, 0D2h, 2Dh, 0D8h
		db 2 dup(0DDh),	8Eh, 0E3h, 3Eh,	0E9h, 2	dup(0EEh), 9Fh
		db 0F4h, 4Fh, 0FAh, 90h, 5, 21h, 0Bh, 0B2h, 10h, 42h, 16h
		db 0D3h, 1Bh, 64h, 21h,	0F4h, 26h, 85h,	2Ch, 16h, 32h
		db 0A6h, 2 dup(37h), 3Dh, 0C8h,	42h, 59h, 48h, 0E9h, 4Dh
		db 7Ah,	53h, 0Bh, 59h, 9Bh, 5Eh, 2Ch, 64h, 0BDh, 69h, 4Dh
		db 6Fh,	0DEh, 74h, 6Fh,	7Ah, 0,	80h, 90h, 85h, 21h, 8Bh
		db 0B2h, 90h, 42h, 96h,	0D3h, 9Bh, 64h,	0A1h, 0F4h, 0A6h
		db 85h,	0ACh, 16h, 0B2h, 0A6h, 0B7h, 37h, 0BDh,	0C8h, 0C2h
		db 59h,	0C8h, 0E9h, 0CDh, 7Ah, 0D3h, 0Bh, 0D9h,	9Bh, 0DEh
		db 2Ch,	0E4h, 0BDh, 0E9h, 4Dh, 0EFh, 0DEh, 0F4h, 6Fh, 0FAh
		db 72h,	5, 0E4h, 0Ah, 57h, 10h,	0C9h, 15h, 3Bh,	1Bh, 0AEh
		db 2 dup(20h), 26h, 93h, 2Bh, 5, 31h
		db 77h,	36h, 0EAh, 3Bh,	5Ch, 41h, 0CEh,	46h, 41h, 4Ch
		db 0B3h, 51h, 26h, 57h,	98h, 5Ch, 0Ah, 62h, 7Dh, 67h, 0EFh
		db 6Ch,	62h, 72h, 0D4h,	77h, 46h, 7Dh, 0B9h, 82h, 2Bh
		db 88h,	9Dh, 8Dh, 10h, 93h, 82h, 98h, 0F5h, 9Dh, 67h, 0A3h
		db 0D9h, 0A8h, 4Ch, 0AEh, 0BEh,	0B3h, 31h, 0B9h, 0A3h
		db 0BEh, 15h, 0C4h, 88h, 0C9h, 0FAh, 0CEh, 6Ch,	0D4h, 0DFh
		db 0D9h, 51h, 0DFh, 0C4h, 0E4h,	36h, 0EAh, 0A8h, 0EFh
		db 1Bh,	0F5h, 8Dh, 0FAh, 55h, 5, 0AAh, 0Ah, 0, 10h, 55h
		db 15h,	0AAh, 1Ah, 0, 20h, 55h,	25h, 0AAh, 2Ah,	0, 30h
		db 55h,	35h, 0AAh, 3Ah,	0, 40h,	55h, 45h, 0AAh,	4Ah, 0
		db 50h,	2 dup(55h), 0AAh, 5Ah, 0, 60h, 55h, 65h, 0AAh
		db 6Ah,	0, 70h,	55h, 75h, 0AAh,	7Ah, 0,	80h, 55h, 85h
		db 0AAh, 8Ah, 0, 90h, 55h, 95h,	0AAh, 9Ah, 0, 0A0h, 55h
		db 0A5h, 2 dup(0AAh), 0, 0B0h, 55h, 0B5h, 0AAh,	0BAh, 0
		db 0C0h, 55h, 0C5h, 0AAh, 0CAh,	0, 0D0h, 55h, 0D5h, 0AAh
		db 0DAh, 0, 0E0h, 55h, 0E5h, 0AAh, 0EAh, 0, 0F0h, 55h
		db 0F5h, 0AAh, 0FAh, 39h, 5, 72h, 0Ah, 0ACh, 0Fh, 0E5h
		db 14h,	1Fh, 1Ah, 58h, 1Fh, 92h, 24h, 0CBh, 29h, 5, 2Fh
		db 3Eh,	34h, 78h, 39h, 0B1h, 3Eh, 0EBh,	43h, 24h, 49h
		db 5Eh,	4Eh, 97h, 53h, 0D0h, 58h, 0Ah, 5Eh, 43h, 63h, 7Dh
		db 68h,	0B6h, 6Dh, 0F0h, 72h, 29h, 78h,	63h, 7Dh, 9Ch
		db 82h,	0D6h, 87h, 0Fh,	8Dh, 49h, 92h, 82h, 97h, 0BCh
		db 9Ch,	0F5h, 0A1h, 2Fh, 0A7h, 68h, 0ACh, 0A1h,	0B1h, 0DBh
		db 0B6h, 14h, 0BCh, 4Eh, 0C1h, 87h, 0C6h, 0C1h,	0CBh, 0FAh
		db 0D0h, 34h, 0D6h, 6Dh, 0DBh, 0A7h, 2 dup(0E0h), 0E5h
		db 1Ah,	0EBh, 53h, 0F0h, 8Dh, 0F5h, 0C6h, 0FAh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ImageResetRende	proc far		; CODE XREF: DoCracCinfRes+108P
					; DoCracCinfRes+129P ...

var_1C		= byte ptr -1Ch
p_wX		= word ptr  6
p_wY		= word ptr  8
p_wRevX		= word ptr  0Ah
p_wRevY		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp		; men sizeof(sprite) er	1e!!
		mov	bp, sp
		sub	sp, 1Ch
		mov	ax, [bp+arg_8]
		lea	bx, [bp+var_1C]
		mov	[bx+10h], ax
		push	bx
		push	[bp+p_wRevY]
		push	[bp+p_wRevX]
		push	[bp+p_wY]
		push	[bp+p_wX]
		call	ResetImageData
		add	sp, 0Ah
		or	ax, ax
		jnz	short loc_1EA2_13F8
		lea	bx, [bp+var_1C]
		cmp	word ptr [bx+0Eh], 0
		jle	short loc_1EA2_13F8
		push	bx
		call	SpriteOp5
		add	sp, 2

loc_1EA2_13F8:				; CODE XREF: ImageResetRende+26j
					; ImageResetRende+2Fj
		mov	sp, bp
		pop	bp
		retf
ImageResetRende	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AddExitHandler	proc far		; CODE XREF: SetCritErrHandl+9P
					; SetupTimerCallb+BEP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		mov	cx, 0Ah
		mov	bx, offset g_arrFuncs
		mov	dx, [bp+arg_2]

loc_1EA2_140B:				; CODE XREF: AddExitHandler+21j
		cmp	[bx], ax
		jnz	short loc_1EA2_1414
		cmp	[bx+2],	dx
		jz	short loc_1EA2_1437

loc_1EA2_1414:				; CODE XREF: AddExitHandler+11j
		cmp	word ptr [bx+2], 0
		jz	short loc_1EA2_1428
		add	bx, 4
		loop	loc_1EA2_140B
		mov	ax, offset aExitListOverfl ; "EXIT LIST	OVERFLOW\r\n"
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_1428:				; CODE XREF: AddExitHandler+1Cj
		mov	word ptr [bx+2], 0
		mov	[bx], ax
		mov	word ptr [bx+6], 0
		mov	[bx+2],	dx

loc_1EA2_1437:				; CODE XREF: AddExitHandler+16j
		pop	bp
		retf
AddExitHandler	endp


; =============== S U B	R O U T	I N E =======================================


CallExitHandls	proc far		; CODE XREF: seg012:001BP ExitP
		push	di
		mov	di, 28h	; '('

loc_1EA2_143D:				; CODE XREF: CallExitHandls+17j
		mov	ax, (g_arrFuncs+2)[di]
		or	ax, ax
		jz	short loc_1EA2_144B
		push	di
		call	dword ptr g_arrFuncs[di]
		pop	di

loc_1EA2_144B:				; CODE XREF: CallExitHandls+Aj
		sub	di, 4
		jl	short loc_1EA2_1452
		jmp	short loc_1EA2_143D
; ---------------------------------------------------------------------------

loc_1EA2_1452:				; CODE XREF: CallExitHandls+15j
		pop	di
		retf
CallExitHandls	endp


; =============== S U B	R O U T	I N E =======================================


Exit		proc near		; CODE XREF: DoDosTextRes+45P
		call	CallExitHandls
		xor	ax, ax
		push	ax
		call	far ptr	libsub_1CC5_19C	; Exits
Exit		endp


; =============== S U B	R O U T	I N E =======================================


_AltFileSize	proc far		; CODE XREF: LoadRes0_1Type+2EP
					; UncompressFileR+55P
		add	[di-75h], dl
		in	al, dx
		sub	sp, 6
		push	ds
		push	si
		push	di
		mov	ax, [bp+8]
		mov	[bp-6],	ax
		jmp	short loc_1EA2_1493
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 6
		push	ds
		push	si
		push	di
		mov	word ptr [bp-6], 0
		jmp	short loc_1EA2_1493
; ---------------------------------------------------------------------------
		nop
		push	bp
		mov	bp, sp
		sub	sp, 6
		push	ds
		push	si
		push	di
		mov	word ptr [bp-6], 1

loc_1EA2_1493:				; CODE XREF: _AltFileSize+10j
					; _AltFileSize+21j
		mov	dx, [bp+6]
		mov	ah, 3Dh	; '='
		xor	al, al
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jnb	short loc_1EA2_14BD
		cmp	word ptr [bp-6], 0
		jnz	short loc_1EA2_14AD
		xor	ax, ax
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_14AD:				; CODE XREF: _AltFileSize+41j
		mov	ax, offset aSFileError_1 ; "%s FILE ERROR"
		mov	bx, ss
		mov	ds, bx
		push	word ptr [bp+6]
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_14BD:				; CODE XREF: _AltFileSize+3Bj
		mov	[bp-2],	ax
		mov	bx, ax
		sub	cx, cx
		sub	dx, dx
		mov	ax, 4202h
		int	21h		; DOS -	2+ - MOVE FILE READ/WRITE POINTER (LSEEK)
					; AL = method: offset from end of file
		push	dx
		push	ax
		sub	dx, dx
		mov	ax, 4200h
		int	21h		; DOS -	2+ - MOVE FILE READ/WRITE POINTER (LSEEK)
					; AL = method: offset from beginning of	file
		pop	ax
		pop	dx
		xor	bx, bx
		test	ax, 0Fh
		jz	short loc_1EA2_14E0
		mov	bx, 1

loc_1EA2_14E0:				; CODE XREF: _AltFileSize+7Aj
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		add	ax, bx
		mov	[bp-4],	ax
		mov	bx, [bp-2]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		mov	ax, [bp-4]
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
_AltFileSize	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Read4BytesFromF	proc far		; CODE XREF: UncompressFileR+2BP

var_8		= word ptr -8
var_6		= byte ptr -6
var_5		= word ptr -5
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		push	si
		push	di
		mov	ax, [bp+arg_2]
		mov	[bp+var_8], ax
		jmp	short loc_1EA2_1537
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		push	si
		push	di
		mov	[bp+var_8], 0
		jmp	short loc_1EA2_1537
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		push	si
		push	di
		mov	[bp+var_8], 1

loc_1EA2_1537:				; CODE XREF: Read4BytesFromF+Fj
					; Read4BytesFromF+20j
		mov	dx, [bp+arg_0]
		mov	dx, [bp+arg_0]
		mov	ah, 3Dh	; '='
		xor	al, al
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jnb	short loc_1EA2_1548
		jmp	short loc_1EA2_1595
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_1548:				; CODE XREF: Read4BytesFromF+3Dj
		mov	[bp+var_2], ax
		mov	bx, [bp+var_2]
		lea	dx, [bp+var_6]
		mov	cx, 4
		mov	ah, 3Fh
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		cmp	ax, cx
		jnz	short loc_1EA2_158E
		mov	bx, [bp+var_2]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		mov	ax, [bp+var_5]
		mov	dx, [bp-3]
		xor	dh, dh
		xor	bx, bx
		test	ax, 0Fh
		jz	short loc_1EA2_1575
		mov	bx, 1

loc_1EA2_1575:				; CODE XREF: Read4BytesFromF+6Aj
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		add	ax, bx
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_158E:				; CODE XREF: Read4BytesFromF+54j
		mov	bx, [bp+var_2]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle

loc_1EA2_1595:				; CODE XREF: Read4BytesFromF+3Fj
		cmp	[bp+var_8], 0
		jnz	short loc_1EA2_15A4
		xor	ax, ax
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_15A4:				; CODE XREF: Read4BytesFromF+93j
		mov	ax, offset aSFileError_1 ; "%s FILE ERROR"
		mov	bx, ss
		mov	ds, bx
		push	[bp+arg_0]
		push	ax
		call	far ptr	ErrorMessage
Read4BytesFromF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FindFileName	proc far		; CODE XREF: _main+3DEP
					; RplyMouseSpriteStuff+B48P ...

p_pcFilefilter	= word ptr  6

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		mov	dx, offset g_pcDtaBuffer
		mov	ah, 1Ah
		int	21h		; DOS -	SET DISK TRANSFER AREA ADDRESS
					; DS:DX	-> disk	transfer buffer
		mov	dx, [bp+p_pcFilefilter]
		mov	cl, 6
		mov	ah, 4Eh
		int	21h		; DOS -	2+ - FIND FIRST	ASCIZ (FINDFIRST)
					; CX = search attributes
					; DS:DX	-> ASCIZ filespec
					; (drive, path,	and wildcards allowed)
		jb	short loc_1EA2_160A
		mov	di, offset g_pcFoundFile
		mov	p_ppcFoundFileP, di
		mov	si, [bp+p_pcFilefilter]
		mov	cx, 57h		; copy 57 bytes	into array?
		mov	ax, ds
		mov	es, ax
		assume es:dseg

loc_1EA2_15DD:				; CODE XREF: FindFileName:loc_1EA2_15EFj
		lodsb
		stosb
		cmp	al, 0
		jz	short loc_1EA2_15F1
		cmp	al, ':'
		jz	short loc_1EA2_15EB
		cmp	al, '\'
		jnz	short loc_1EA2_15EF

loc_1EA2_15EB:				; CODE XREF: FindFileName+31j
		mov	p_ppcFoundFileP, di

loc_1EA2_15EF:				; CODE XREF: FindFileName+35j
		loop	loc_1EA2_15DD

loc_1EA2_15F1:				; CODE XREF: FindFileName+2Dj
					; FindNext+13j
		mov	ax, ds
		mov	es, ax
		mov	si, offset g_pcFoundFilePa
		mov	di, p_ppcFoundFileP
		mov	cx, 0Dh
		cld
		rep movsb
		mov	ax, offset g_pcFoundFile

loc_1EA2_1605:				; CODE XREF: FindFileName+58j
		pop	di
		pop	si
		pop	ds
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_160A:				; CODE XREF: FindFileName+16j
					; FindNext+11j
		xor	ax, ax
		jmp	short loc_1EA2_1605
FindFileName	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FindNext	proc far		; CODE XREF: DoFindNextP
		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		mov	dx, offset g_pcDtaBuffer
		mov	ah, 1Ah
		int	21h		; DOS -	SET DISK TRANSFER AREA ADDRESS
					; DS:DX	-> disk	transfer buffer
		mov	ah, 4Fh
		int	21h		; DOS -	2+ - FIND NEXT ASCIZ (FINDNEXT)
					; [DTA]	= data block from
					; last AH = 4Eh/4Fh call
		jb	short loc_1EA2_160A
		jmp	short loc_1EA2_15F1
FindNext	endp

; ---------------------------------------------------------------------------
		align 2
; the equivalent:
;  unsigned int	prod = (arg0 * valfromlogtable)	<< 2;
;  return (prod	>> 16) + ((prod	& 0x8000) >> 15) ;

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ScaleValue	proc far		; CODE XREF: OpponentOp+5FFP
					; OpponentOp+639P ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		imul	[bp+arg_2]
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		adc	dx, 0
		mov	ax, dx
		pop	bp
		retf
ScaleValue	endp


; =============== S U B	R O U T	I N E =======================================


SetBiosMode4	proc far		; CODE XREF: SetVideoMode+22FP
		push	di
		mov	byte_2B77_40EA,	1
		mov	ax, 40h	; '@'
		mov	es, ax
		assume es:nothing
		mov	ax, es:10h	; 40:10?
		and	ax, 0FFCFh
		or	ax, 20h
		mov	es:10h,	ax
		mov	ah, 0
		mov	al, 4
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		mov	al, 3
		mov	dx, 3BFh
		out	dx, al		; Printer Status Bits:
					; 3: 0=printer signals an error
					; 4: 1=printer is selected
					; 5: 1=out of paper
					; 6: 0=ready for next character
					; 7: 0=busy or offline or error
		mov	al, 2
		mov	dx, 3B8h
		out	dx, al
		mov	cx, 0Ch
		mov	dx, 3B4h
		xor	bx, bx

loc_1EA2_1671:				; CODE XREF: SetBiosMode4+3Ej
		mov	al, bl
		out	dx, al		; Video: CRT cntrlr addr
					; horizontal total
		inc	dx
		mov	al, g_arrVideoThing[bx]
		out	dx, al		; Video: CRT controller	internal registers
		dec	dx
		inc	bx
		loop	loc_1EA2_1671
		cld
		mov	ax, 0B800h	; B800 = text mode buffer
		mov	es, ax
		assume es:nothing
		xor	di, di
		mov	cx, 4000h
		xor	ax, ax
		rep stosw
		mov	al, 8Ah	; 'Š'
		mov	dx, 3B8h
		out	dx, al
		pop	di
		retf
SetBiosMode4	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

XZCosOrSin	proc far		; CODE XREF: OpponentOp+144P
					; CompareUpdate2Cvx+C2P ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetAngleFromXZ
		add	sp, 4
		or	ax, ax
		jge	short loc_1EA2_16AD
		neg	ax

loc_1EA2_16AD:				; CODE XREF: XZCosOrSin+13j
		cmp	ax, 100h
		jl	short loc_1EA2_16B7
		sub	ax, 200h
		neg	ax

loc_1EA2_16B7:				; CODE XREF: XZCosOrSin+1Aj
		cmp	ax, 80h	; '€'
		jg	short loc_1EA2_16DE
		push	ax
		call	LookupCos
		add	sp, 2
		mov	bx, ax
		mov	dx, [bp+arg_2]
		or	dx, dx
		jge	short loc_1EA2_16D0
		neg	dx

loc_1EA2_16D0:				; CODE XREF: XZCosOrSin+36j
		xor	ax, ax
		sar	dx, 1
		rcr	ax, 1
		sar	dx, 1
		rcr	ax, 1
		div	bx
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_16DE:				; CODE XREF: XZCosOrSin+24j
		push	ax
		call	LookupSine
		add	sp, 2
		mov	bx, ax
		mov	dx, [bp+arg_0]
		or	dx, dx
		jge	short loc_1EA2_16F2
		neg	dx

loc_1EA2_16F2:				; CODE XREF: XZCosOrSin+58j
		xor	ax, ax
		sar	dx, 1
		rcr	ax, 1
		sar	dx, 1
		rcr	ax, 1
		div	bx
		pop	bp
		retf
XZCosOrSin	endp


; =============== S U B	R O U T	I N E =======================================


SetBiosMode7	proc far		; CODE XREF: _main+58EP
		push	di
		cmp	byte_2B77_40EA,	0
		jnz	short loc_1EA2_170F
		call	SetBiosMode3
		pop	di
		retf
; ---------------------------------------------------------------------------

loc_1EA2_170F:				; CODE XREF: SetBiosMode7+6j
		mov	ax, 40h	; '@'
		mov	es, ax
		assume es:nothing
		mov	ax, es:10h
		and	ax, 0FFCFh
		or	ax, 30h
		mov	es:10h,	ax
		mov	al, 3
		mov	dx, 3BFh
		out	dx, al		; Printer Status Bits:
					; 3: 0=printer signals an error
					; 4: 1=printer is selected
					; 5: 1=out of paper
					; 6: 0=ready for next character
					; 7: 0=busy or offline or error
		mov	al, 20h	; ' '
		mov	dx, 3B8h
		out	dx, al
		mov	cx, 0Ch
		mov	dx, 3B4h
		xor	bx, bx

loc_1EA2_1736:				; CODE XREF: SetBiosMode7+41j
		mov	al, bl
		out	dx, al		; Video: CRT cntrlr addr
					; horizontal total
		inc	dx
		mov	al, [bx+40F8h]
		out	dx, al		; Video: CRT controller	internal registers
		dec	dx
		inc	bx
		loop	loc_1EA2_1736
		cld
		mov	ax, 0B800h
		mov	es, ax
		assume es:nothing
		xor	di, di
		mov	cx, 4000h
		xor	ax, ax
		rep stosw
		mov	al, 28h	; '('
		mov	dx, 3B8h
		out	dx, al
		mov	ah, 0
		mov	al, 7
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		pop	di
		retf
SetBiosMode7	endp

; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	dx, offset unk_2B77_2E9C
		mov	word_2B77_4114,	5
		mov	word_2B77_4116,	5
		mov	g_cTimerFlag3, 64h
		mov	g_cTimerFlag, 1
		jmp	short loc_1EA2_17DD
; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetupTimerCallb	proc far		; CODE XREF: SetVideoMode:loc_29E1_27AP
		push	bp
		mov	dx, 2E9Ch	; 11977. afaict	this is	used as	freq-parameter,	which gives
					; 1193180 / 11977 = ca99.6 = ca	100 ??
		mov	word_2B77_4114,	5
		mov	word_2B77_4116,	5
		mov	g_cTimerFlag, 0
		mov	g_cTimerFlag2, 1
		jmp	short loc_1EA2_17DD
; ---------------------------------------------------------------------------
		nop
		push	bp
		mov	bp, sp
		mov	dx, 1
		xor	ax, ax
		idiv	word ptr [bp+6]	; this is not in use
		mov	word_2B77_4114,	ax
		mov	word_2B77_4116,	ax
		mov	dx, [bp+6]
		mov	g_cTimerFlag, 0
		mov	g_cTimerFlag2, 1
		jmp	short loc_1EA2_17DD
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		mov	dx, 1
		xor	ax, ax
		idiv	word ptr [bp+6]
		mov	word_2B77_4114,	ax
		mov	word_2B77_4116,	ax
		mov	dx, [bp+6]
		mov	g_cTimerFlag3, 64h ; 'd'
		mov	g_cTimerFlag, 1

loc_1EA2_17DD:				; CODE XREF: seg012:177Dj
					; SetupTimerCallb+1Aj ...
		cli
		mov	byte_2B77_411C,	0
		mov	g_wTimerIntr, 0
		mov	g_wTimerIntr+2,	0
		sti
		in	al, 61h		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		and	al, 0FCh
		out	61h, al		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		mov	al, 0B6h
		out	43h, al		; Timer	8253-5 (AT: 8254.2).
		in	al, 21h		; Interrupt controller,	8259A.
		or	al, 3
		out	21h, al		; Interrupt controller,	8259A.
		xor	ax, ax
		mov	es, ax
		assume es:nothing
		cli
		mov	ax, es:20h
		cmp	ax, offset _TimerIntrCallb
		jz	short loc_1EA2_1811
		mov	word ptr g_dwOldTimerInt, ax

loc_1EA2_1811:				; CODE XREF: SetupTimerCallb+8Cj
		mov	ax, es:22h
		mov	bx, cs
		cmp	ax, bx
		jz	short loc_1EA2_182A
		mov	word ptr g_dwOldTimerInt+2, ax
		mov	word ptr es:20h, offset	_TimerIntrCallb
		mov	word ptr es:22h, cs

loc_1EA2_182A:				; CODE XREF: SetupTimerCallb+99j
		in	al, 21h		; Interrupt controller,	8259A.
		and	al, 0FCh
		out	21h, al		; Interrupt controller,	8259A.
		sti
		mov	al, dl
		out	40h, al		; Timer	8253-5 (AT: 8254.2).
		mov	al, dh
		out	40h, al		; Timer	8253-5 (AT: 8254.2).
		push	cs
		mov	ax, offset StopSoundMaybe
		push	ax
		call	AddExitHandler
		add	sp, 4
		pop	bp
		retf
SetupTimerCallb	endp


; =============== S U B	R O U T	I N E =======================================


StopSoundMaybe	proc far		; CODE XREF: _main+57AP
					; SetVideoMode+262P
					; DATA XREF: ...
		xor	ax, ax
		mov	es, ax
		mov	ax, es:22h
		mov	dx, cs
		cmp	ax, dx
		jz	short loc_1EA2_1857
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1857:				; CODE XREF: StopSoundMaybe+Cj
		mov	ax, es:20h
		cmp	ax, offset _TimerIntrCallb
		jz	short loc_1EA2_1861
		retf
; ---------------------------------------------------------------------------
in al,21h; or al,3; out	21h,al = stop interrupts

loc_1EA2_1861:				; CODE XREF: StopSoundMaybe+16j
		in	al, 21h		; Interrupt controller,	8259A.
		or	al, 3
		out	21h, al		; Interrupt controller,	8259A.
		cli
		mov	ax, word ptr g_dwOldTimerInt
		mov	es:20h,	ax
		mov	ax, word ptr g_dwOldTimerInt+2
		mov	es:22h,	ax
		in	al, 21h		; Interrupt controller,	8259A.
		and	al, 0FCh
		out	21h, al		; Interrupt controller,	8259A.
		sti
		mov	al, 0
		out	40h, al		; Timer	8253-5 (AT: 8254.2).
		out	40h, al		; Timer	8253-5 (AT: 8254.2).
		in	al, 61h		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		and	al, 0FCh
		out	61h, al		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		retf
StopSoundMaybe	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AddTimerFunc	proc far		; CODE XREF: DoAddTimerFunc+EP
					; AddAudioDrvTime+1FP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	cx, 5
		mov	bx, offset g_wTimerIntr

loc_1EA2_1893:				; CODE XREF: AddTimerFunc+12j
		cmp	word ptr [bx+2], 0
		jz	short loc_1EA2_18A7
		add	bx, 4
		loop	loc_1EA2_1893
		mov	ax, offset aNoRoomLeftOnTi ; "NO ROOM LEFT ON TIMER INTERRUPT ROUTINE"...
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_18A7:				; CODE XREF: AddTimerFunc+Dj
		mov	ax, [bp+arg_0]
		mov	[bx], ax
		mov	word ptr [bx+2], 0
		mov	ax, [bp+arg_2]
		mov	[bx+2],	ax
		mov	word ptr [bx+6], 0
		pop	bp
		retf
AddTimerFunc	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RemoveTimerFunc	proc far		; CODE XREF: sub_11B7_A06+16P
					; DelAudDrvTimer+28P ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	cx, 5
		mov	bx, offset g_wTimerIntr
		mov	ax, [bp+arg_0]
		mov	dx, [bp+arg_2]

loc_1EA2_18CD:				; CODE XREF: RemoveTimerFunc+1Bj
		cmp	[bx], ax
		jnz	short loc_1EA2_18D6
		cmp	[bx+2],	dx
		jz	short loc_1EA2_18DD

loc_1EA2_18D6:				; CODE XREF: RemoveTimerFunc+11j
		add	bx, 4
		loop	loc_1EA2_18CD
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_18DD:				; CODE XREF: RemoveTimerFunc+16j
		cli
		dec	cx
		jz	short loc_1EA2_18F1

loc_1EA2_18E1:				; CODE XREF: RemoveTimerFunc+31j
		mov	ax, [bx+4]
		mov	[bx], ax
		mov	ax, [bx+6]
		mov	[bx+2],	ax
		add	bx, 4
		loop	loc_1EA2_18E1

loc_1EA2_18F1:				; CODE XREF: RemoveTimerFunc+21j
		mov	word ptr [bx], 0
		mov	word ptr [bx+2], 0
		sti
		pop	bp
		retf
RemoveTimerFunc	endp


; =============== S U B	R O U T	I N E =======================================


CompareDS_SS	proc far		; CODE XREF: TimerFuncP
					; AudioDrvTimer+8P
		xor	ax, ax
		mov	bx, ss
		mov	dx, ds
		cmp	bx, dx
		jnz	short locret_1EA2_1908
		inc	ax

locret_1EA2_1908:			; CODE XREF: CompareDS_SS+8j
		retf
CompareDS_SS	endp

; ---------------------------------------------------------------------------

_TimerIntrCallb:			; DATA XREF: SetupTimerCallb+89o
					; SetupTimerCallb+9Eo ...
		cli
		push	ds
		push	es
		push	ax
		push	bx
		push	cx
		push	dx
		push	si
		push	di
		push	bp
		mov	ax, seg	dseg
		mov	ds, ax
		sti
		dec	word_2B77_4116
		jg	short loc_1EA2_193C
		inc	g_wOrigValue1
		jnz	short loc_1EA2_1929
		inc	g_wOrigValue2

loc_1EA2_1929:				; CODE XREF: seg012:1923j
		mov	ax, word_2B77_4114
		mov	word_2B77_4116,	ax
		cmp	g_cTimerFlag2, 0
		jz	short loc_1EA2_193C
		call	DoOldTimerInt
		jmp	short loc_1EA2_1940
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_193C:				; CODE XREF: seg012:191Dj seg012:1934j
		mov	al, 20h
		out	20h, al		; Interrupt controller,	8259A.

loc_1EA2_1940:				; CODE XREF: seg012:1939j
		cmp	byte ptr g_wIsInputMetho, 0
		jnz	short loc_1EA2_1985
		inc	word ptr g_dwTimerCounte
		jnz	short loc_1EA2_1951
		inc	word ptr g_dwTimerCounte+2

loc_1EA2_1951:				; CODE XREF: seg012:194Bj
		xor	di, di
		cli
		cmp	byte_2B77_411C,	0
		jnz	short loc_1EA2_1972
		mov	byte_2B77_411C,	1
		sti

loc_1EA2_1961:				; CODE XREF: seg012:1970j
		mov	ax, (g_wTimerIntr+2)[di]
		or	ax, ax
		jz	short loc_1EA2_1985
		call	dword ptr g_wTimerIntr[di]
		add	di, 4
		jmp	short loc_1EA2_1961
; ---------------------------------------------------------------------------

loc_1EA2_1972:				; CODE XREF: seg012:1959j
		inc	word_2B77_411A
		mov	ax, word_2B77_411A
		cmp	word_2B77_4118,	ax
		jge	short loc_1EA2_1990
		mov	word_2B77_4118,	ax
		jmp	short loc_1EA2_1990
; ---------------------------------------------------------------------------
		nop

loc_1EA2_1985:				; CODE XREF: seg012:1945j seg012:1967j
		mov	byte_2B77_411C,	0
		mov	word_2B77_411A,	0

loc_1EA2_1990:				; CODE XREF: seg012:197Dj seg012:1982j
		pop	bp
		pop	di
		pop	si
		pop	dx
		pop	cx
		pop	bx
		pop	ax
		pop	es
		assume es:nothing
		pop	ds
		iret

; =============== S U B	R O U T	I N E =======================================


DoOldTimerInt	proc near		; CODE XREF: seg012:1936p
		cmp	g_cTimerFlag, 0
		jz	short loc_1EA2_19B1
		dec	g_cTimerFlag3
		jg	short loc_1EA2_19B1
		mov	g_cTimerFlag, 0
		mov	g_cTimerFlag2, 0

loc_1EA2_19B1:				; CODE XREF: DoOldTimerInt+5j
					; DoOldTimerInt+Bj
		pushf
		call	g_dwOldTimerInt
		retn
; ---------------------------------------------------------------------------
		align 2
DoOldTimerInt	endp


; =============== S U B	R O U T	I N E =======================================


SetBiosMode3	proc far		; CODE XREF: SetBiosMode7+8P
		xor	ax, ax
		push	ax
		call	ClearScreenClr
		add	sp, 2
		mov	ax, 40h	; '@'
		mov	es, ax
		assume es:nothing
		mov	ax, es:10h
		and	ax, 0FFCFh
		or	ax, 10h
		mov	es:10h,	ax
		mov	ah, 0
		mov	al, 3
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		mov	ah, 0Bh
		mov	bx, 0
		int	10h		; - VIDEO - SET	COLOR PALETTE
					; BH = 00h, BL = border	color
					; BH = 01h, BL = palette (0-3)
		retf
SetBiosMode3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ParseKbKey	proc far		; CODE XREF: seg012:1AB2P
					; GetKbChar+16P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		cli
		cmp	g_bIsParsingKey, 0
		jz	short loc_1EA2_19F2
		sti
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_19F2:				; CODE XREF: ParseKbKey+9j
		mov	g_bIsParsingKey, 1
		sti
		mov	bx, [bp+arg_0]
		or	bl, bl
		jz	short loc_1EA2_1A21
		and	bx, 7Fh
		mov	[bp+arg_0], bx
		mov	bl, g_pcFuncPtrFlag[bx]

loc_1EA2_1A09:				; CODE XREF: ParseKbKey+4Ej
		dec	bx
		jl	short loc_1EA2_1A34
		shl	bx, 1
		push	di
		push	si
		shl	bx, 1
		call	dword ptr g_pFuncOfs[bx]
		pop	si
		pop	di
		xor	ax, ax
		mov	g_bIsParsingKey, 0
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1A21:				; CODE XREF: ParseKbKey+19j
		mov	bl, bh
		xor	bh, bh
		cmp	bx, 84h	; '„'
		jl	short loc_1EA2_1A2E
		mov	bx, 84h	; '„'

loc_1EA2_1A2E:				; CODE XREF: ParseKbKey+45j
		mov	bl, g_pcFuncPtrFlg2[bx]
		jmp	short loc_1EA2_1A09
; ---------------------------------------------------------------------------

loc_1EA2_1A34:				; CODE XREF: ParseKbKey+26j
		mov	ax, [bp+arg_0]
		mov	g_bIsParsingKey, 0
		pop	bp
		retf
ParseKbKey	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RegSomeFuncPtr	proc far		; CODE XREF: SetVideoMode+23P
					; SetVideoMode+37P ...

arg_0		= word ptr  6
p_pFuncOfs	= word ptr  8
p_pFuncSeg	= word ptr  0Ah

		push	bp		; arg_0	is some	kind of	type, a	copy of	the function is	placed in one of two tables depending on bits in the type
		mov	bp, sp
		mov	ax, [bp+p_pFuncOfs]
		mov	cx, 40h
		mov	bx, offset g_pFuncOfs
		mov	dx, [bp+p_pFuncSeg]
; Scan for an available	slot in	the function table

loc_1EA2_1A4D:				; CODE XREF: RegSomeFuncPtr+21j
		cmp	[bx], ax
		jnz	short loc_1EA2_1A56
		cmp	[bx+2],	dx
		jz	short loc_1EA2_1A68

loc_1EA2_1A56:				; CODE XREF: RegSomeFuncPtr+11j
		cmp	word ptr [bx+2], 0
		jz	short loc_1EA2_1A63
		add	bx, 4
		loop	loc_1EA2_1A4D
		pop	bp
		retf
; ---------------------------------------------------------------------------
; Write	new func seg and ofs to	[bx], which points to next available

loc_1EA2_1A63:				; CODE XREF: RegSomeFuncPtr+1Cj
		mov	[bx], ax
		mov	[bx+2],	dx

loc_1EA2_1A68:				; CODE XREF: RegSomeFuncPtr+16j
		mov	ax, 41h
		sub	ax, cx		; ax is	now 0x41 - remaining = index nr? or next?

loc_1EA2_1A6D:				; CODE XREF: RegSomeFuncPtr+56j
		mov	bx, [bp+arg_0]
		or	bl, bl
		jz	short loc_1EA2_1A7F
		cmp	bx, 7Fh
		jg	short loc_1EA2_1A7D
		mov	g_pcFuncPtrFlag[bx], al

loc_1EA2_1A7D:				; CODE XREF: RegSomeFuncPtr+39j
					; RegSomeFuncPtr+49j
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1A7F:				; CODE XREF: RegSomeFuncPtr+34j
		mov	bl, bh
		xor	bh, bh
		cmp	bx, 84h
		jg	short loc_1EA2_1A7D
		mov	g_pcFuncPtrFlg2[bx], al
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		xor	ax, ax
		jmp	short loc_1EA2_1A6D
RegSomeFuncPtr	endp

; ---------------------------------------------------------------------------
		mov	ah, 1
		int	16h		; KEYBOARD - CHECK BUFFER, DO NOT CLEAR
					; Return: ZF clear if character	in buffer
					; AH = scan code, AL = character
					; ZF set if no character in buffer
		jz	short loc_1EA2_1ABB
		mov	ah, 0
		int	16h		; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
					; Return: AH = scan code, AL = character
		or	al, al
		jz	short locret_1EA2_1AA6
		xor	ah, ah

locret_1EA2_1AA6:			; CODE XREF: seg012:1AA2j
		retf
; ---------------------------------------------------------------------------
		mov	ah, 1
		int	16h		; KEYBOARD - CHECK BUFFER, DO NOT CLEAR
					; Return: ZF clear if character	in buffer
					; AH = scan code, AL = character
					; ZF set if no character in buffer
		jz	short loc_1EA2_1ABB
		mov	ah, 0
		int	16h		; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
					; Return: AH = scan code, AL = character
		push	ax
		call	ParseKbKey
		add	sp, 2
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1ABB:				; CODE XREF: seg012:1A9Aj seg012:1AABj
		call	GetJoystickFlag
		mov	bx, ax
		test	ax, 30h
		jz	short loc_1EA2_1ACD
		mov	ax, 0Dh
		jmp	short loc_1EA2_1AD6
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_1ACD:				; CODE XREF: seg012:1AC5j
		and	bx, 0Fh
		shl	bx, 1
		mov	ax, [bx+4372h]

loc_1EA2_1AD6:				; CODE XREF: seg012:1ACAj
		cmp	ax, word_2B77_4392
		jnz	short loc_1EA2_1ADF

loc_1EA2_1ADC:				; CODE XREF: seg012:1AE9j seg012:1AF7j
		xor	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1ADF:				; CODE XREF: seg012:1ADAj
		cmp	ax, word_2B77_4394
		jnz	short loc_1EA2_1AEF
		dec	byte_2B77_4396
		jg	short loc_1EA2_1ADC
		mov	word_2B77_4392,	ax
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1AEF:				; CODE XREF: seg012:1AE3j
		mov	byte_2B77_4396,	3
		mov	word_2B77_4394,	ax
		jmp	short loc_1EA2_1ADC

; =============== S U B	R O U T	I N E =======================================


GetKbChar	proc far		; CODE XREF: RunGame+60AP
					; RunGame:loc_11B7_6B2P ...
		mov	ah, 1
		int	16h		; KEYBOARD - CHECK BUFFER, DO NOT CLEAR
					; Return: ZF clear if character	in buffer
					; AH = scan code, AL = character
					; ZF set if no character in buffer
		jnz	short loc_1EA2_1B02
		xor	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1B02:				; CODE XREF: GetKbChar+4j
		mov	bx, ss
		mov	cx, ds
		cmp	bx, cx
		jnz	short locret_1EA2_1B17
		mov	ah, 0
		int	16h		; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
					; Return: AH = scan code, AL = character
		push	ax
		call	ParseKbKey
		add	sp, 2

locret_1EA2_1B17:			; CODE XREF: GetKbChar+Fj
		retf
GetKbChar	endp

GetInputFlags returns in ax:
up	|=    1
down	|=    2
right	|=    4
left	|=    8
shiftup	|= 0x10
shiftdn	|= 0x20

(this same code	is used/documented in the rpl files)

; =============== S U B	R O U T	I N E =======================================


GetKbOrJoyFlags	proc far		; CODE XREF: RunGame:loc_11B7_62AP
					; RunGame+6F8P	...
		xor	ax, ax
		xor	bx, bx
		mov	bl, g_pKbScanCodes
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B29
		or	al, 10h

loc_1EA2_1B29:				; CODE XREF: GetKbOrJoyFlags+Dj
		mov	bl, g_pKbScanCodes+1
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B36
		or	al, 20h

loc_1EA2_1B36:				; CODE XREF: GetKbOrJoyFlags+1Aj
		mov	bl, g_pKbScanCodes+2
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B43
		or	al, 9

loc_1EA2_1B43:				; CODE XREF: GetKbOrJoyFlags+27j
		mov	bl, g_pKbScanCodes+3 ; kb up
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B50
		or	al, 1

loc_1EA2_1B50:				; CODE XREF: GetKbOrJoyFlags+34j
		mov	bl, g_pKbScanCodes+4
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B5D
		or	al, 5

loc_1EA2_1B5D:				; CODE XREF: GetKbOrJoyFlags+41j
		mov	bl, g_pKbScanCodes+5 ; kb right	(77)
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B6A
		or	al, 4

loc_1EA2_1B6A:				; CODE XREF: GetKbOrJoyFlags+4Ej
		mov	bl, g_pKbScanCodes+6
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B77
		or	al, 6

loc_1EA2_1B77:				; CODE XREF: GetKbOrJoyFlags+5Bj
		mov	bl, g_pKbScanCodes+7 ; kb down,	scancode 0x50
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B84
		or	al, 2

loc_1EA2_1B84:				; CODE XREF: GetKbOrJoyFlags+68j
		mov	bl, g_pKbScanCodes+8 ; scancode	0x4f
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B91
		or	al, 0Ah

loc_1EA2_1B91:				; CODE XREF: GetKbOrJoyFlags+75j
		mov	bl, g_pKbScanCodes+9 ; kb left (75)
		cmp	g_pKbInput[bx],	0
		jz	short loc_1EA2_1B9E
		or	al, 8

loc_1EA2_1B9E:				; CODE XREF: GetKbOrJoyFlags+82j
		or	ax, ax
		jnz	short locret_1EA2_1BA7
		call	GetJoystickFlag

locret_1EA2_1BA7:			; CODE XREF: GetKbOrJoyFlags+88j
		retf
GetKbOrJoyFlags	endp

; ---------------------------------------------------------------------------
		xor	cx, cx
		xor	bx, bx
		mov	bl, g_pKbScanCodes
		cmp	byte ptr [bx+446Ah], 0
		jz	short loc_1EA2_1BBA
		or	cl, 10h

loc_1EA2_1BBA:				; CODE XREF: seg012:1BB5j
		mov	bl, g_pKbScanCodes+1
		cmp	byte ptr [bx+446Ah], 0
		jz	short loc_1EA2_1BC8
		or	cl, 20h

loc_1EA2_1BC8:				; CODE XREF: seg012:1BC3j
		xor	ax, ax
		mov	dx, 201h
		test	g_bSkipJoystick, 1
		jz	short loc_1EA2_1BD9
		in	al, dx		; Game I/O port
					; bits 0-3: Coordinates	(resistive, time-dependent inputs)
					; bits 4-7: Buttons/Triggers (digital inputs)
		not	al
		and	al, 30h

loc_1EA2_1BD9:				; CODE XREF: seg012:1BD2j
		or	ax, cx
		retf

; =============== S U B	R O U T	I N E =======================================


GetJoystickFlag	proc far		; CODE XREF: InputsChecking:loc_174B_134DP
					; DoJoyResText:loc_174B_27F8P ...
		test	g_bSkipJoystick, 1
		jnz	short loc_1EA2_1BE6
		xor	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1BE6:				; CODE XREF: GetJoystickFlag+5j
		mov	g_bJoyInput, 0
		mov	dx, 201h
		in	al, dx		; Game I/O port
					; bits 0-3: Coordinates	(resistive, time-dependent inputs)
					; bits 4-7: Buttons/Triggers (digital inputs)
		mov	g_bJoyButton, al
		mov	bl, 3
		mov	g_wJoyFlag1, 50h ; 'P'
		mov	g_wJoyFlag2, 50h ; 'P'
		cli
		out	dx, al		; Game I/O port
					; bits 0-3: Coordinates	(resistive, time-dependent inputs)
					; bits 4-7: Buttons/Triggers (digital inputs)
		mov	cx, 14h

loc_1EA2_1C05:				; CODE XREF: GetJoystickFlag:loc_1EA2_1C05j
		loop	loc_1EA2_1C05
		mov	cx, 0

loc_1EA2_1C0A:				; CODE XREF: GetJoystickFlag+3Aj
					; GetJoystickFlag+45j ...
		in	al, dx		; Game I/O port
					; bits 0-3: Coordinates	(resistive, time-dependent inputs)
					; bits 4-7: Buttons/Triggers (digital inputs)
		and	al, bl
		xor	al, bl
		jnz	short loc_1EA2_1C1B
		inc	cx
		cmp	cx, 0FA0h	; Read game port 4000 times
		jl	short loc_1EA2_1C0A
		jmp	short _GotJoyFlags_
; ---------------------------------------------------------------------------
		nop

loc_1EA2_1C1B:				; CODE XREF: GetJoystickFlag+33j
		test	al, 1
		jnz	short loc_1EA2_1C2F

loc_1EA2_1C1F:				; CODE XREF: GetJoystickFlag+5Aj
		test	al, 2
		jz	short loc_1EA2_1C0A
		mov	g_wJoyFlag2, cx
		and	bl, 1
		jnz	short loc_1EA2_1C0A
		jmp	short _GotJoyFlags_
; ---------------------------------------------------------------------------
		nop

loc_1EA2_1C2F:				; CODE XREF: GetJoystickFlag+41j
		mov	g_wJoyFlag1, cx
		and	bl, 2
		jnz	short loc_1EA2_1C1F

_GotJoyFlags_:				; CODE XREF: GetJoystickFlag+3Cj
					; GetJoystickFlag+50j
		sti
		mov	ax, g_wJoyFlag1
		cmp	ax, word_2B77_43A8
		jge	short loc_1EA2_1C91
		dec	word_2B77_43B0
		jle	short loc_1EA2_1C54
		cmp	ax, word_2B77_43AA
		jl	short loc_1EA2_1CC5
		mov	word_2B77_43AA,	ax
		jmp	short loc_1EA2_1CC5
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_1C54:				; CODE XREF: GetJoystickFlag+6Aj
		mov	bx, word_2B77_43AA
		mov	word_2B77_43A8,	bx
		mov	bx, word_2B77_43AC

loc_1EA2_1C60:				; CODE XREF: GetJoystickFlag+D5j
		sub	bx, word_2B77_43A8
		jle	short loc_1EA2_1C70
		xor	dx, dx
		mov	ax, 4000h
		div	bx
		mov	word_2B77_43C4,	ax

loc_1EA2_1C70:				; CODE XREF: GetJoystickFlag+88j
		mov	ax, bx
		mov	dx, 201h
		shr	ax, 1
		mov	bx, ax
		shr	bx, 1
		add	ax, word_2B77_43A8
		add	ax, bx
		mov	word_2B77_43B4,	ax
		sub	ax, bx
		sub	ax, bx
		mov	word_2B77_43B2,	ax
		mov	ax, g_wJoyFlag1
		jmp	short loc_1EA2_1CB3
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_1C91:				; CODE XREF: GetJoystickFlag+64j
		cmp	ax, word_2B77_43AC
		jle	short loc_1EA2_1CB3
		dec	word_2B77_43B0
		jle	short loc_1EA2_1CA9
		cmp	ax, word_2B77_43AE
		jge	short loc_1EA2_1CC5
		mov	word_2B77_43AE,	ax
		jmp	short loc_1EA2_1CC5
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_1CA9:				; CODE XREF: GetJoystickFlag+BFj
		mov	bx, word_2B77_43AE
		mov	word_2B77_43AC,	bx
		jmp	short loc_1EA2_1C60
; ---------------------------------------------------------------------------

loc_1EA2_1CB3:				; CODE XREF: GetJoystickFlag+B2j
					; GetJoystickFlag+B9j
		mov	word_2B77_43B0,	14h
		mov	word_2B77_43AE,	4E20h
		mov	word_2B77_43AA,	0

loc_1EA2_1CC5:				; CODE XREF: GetJoystickFlag+70j
					; GetJoystickFlag+75j ...
		cmp	ax, word_2B77_43B2
		jl	short loc_1EA2_1D2E
		cmp	ax, word_2B77_43B4
		jl	short loc_1EA2_1CD6
		or	g_bJoyInput, 4

loc_1EA2_1CD6:				; CODE XREF: GetJoystickFlag+F3j
					; GetJoystickFlag+157j
		mov	ax, g_wJoyFlag2
		cmp	ax, word_2B77_43B6
		jnb	short loc_1EA2_1D35
		dec	word_2B77_43BE
		jle	short loc_1EA2_1CF1
		cmp	ax, word_2B77_43B8
		jl	short loc_1EA2_1D69
		mov	word_2B77_43B8,	ax
		jmp	short loc_1EA2_1D69
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_1CF1:				; CODE XREF: GetJoystickFlag+107j
		mov	bx, word_2B77_43B8
		mov	word_2B77_43B6,	bx
		mov	bx, word_2B77_43BA

loc_1EA2_1CFD:				; CODE XREF: GetJoystickFlag+179j
		sub	bx, word_2B77_43B6
		jle	short loc_1EA2_1D0D
		xor	dx, dx
		mov	ax, 4000h
		div	bx
		mov	word_2B77_43C6,	ax

loc_1EA2_1D0D:				; CODE XREF: GetJoystickFlag+125j
		mov	ax, bx
		mov	dx, 201h
		shr	ax, 1
		mov	bx, ax
		shr	bx, 1
		add	ax, word_2B77_43B6
		add	ax, bx
		mov	word_2B77_43C2,	ax
		sub	ax, bx
		sub	ax, bx
		mov	word_2B77_43C0,	ax
		mov	ax, g_wJoyFlag2
		jmp	short loc_1EA2_1D57
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_1D2E:				; CODE XREF: GetJoystickFlag+EDj
		or	g_bJoyInput, 8
		jmp	short loc_1EA2_1CD6
; ---------------------------------------------------------------------------

loc_1EA2_1D35:				; CODE XREF: GetJoystickFlag+101j
		cmp	ax, word_2B77_43BA
		jle	short loc_1EA2_1D57
		dec	word_2B77_43BE
		jz	short loc_1EA2_1D4D
		cmp	ax, word_2B77_43BC
		jge	short loc_1EA2_1D69
		mov	word_2B77_43BC,	ax
		jmp	short loc_1EA2_1D69
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_1D4D:				; CODE XREF: GetJoystickFlag+163j
		mov	bx, word_2B77_43BC
		mov	word_2B77_43BA,	bx
		jmp	short loc_1EA2_1CFD
; ---------------------------------------------------------------------------

loc_1EA2_1D57:				; CODE XREF: GetJoystickFlag+14Fj
					; GetJoystickFlag+15Dj
		mov	word_2B77_43BE,	14h
		mov	word_2B77_43BC,	4E20h
		mov	word_2B77_43B8,	0

loc_1EA2_1D69:				; CODE XREF: GetJoystickFlag+10Dj
					; GetJoystickFlag+112j	...
		cmp	ax, word_2B77_43C0
		jb	short loc_1EA2_1D8D
		cmp	ax, word_2B77_43C2
		jb	short loc_1EA2_1D7A
		or	g_bJoyInput, 2

loc_1EA2_1D7A:				; CODE XREF: GetJoystickFlag+197j
					; GetJoystickFlag+1B6j
		in	al, dx		; Game I/O port
					; bits 0-3: Coordinates	(resistive, time-dependent inputs)
					; bits 4-7: Buttons/Triggers (digital inputs)
		and	al, g_bJoyButton
		and	al, 30h
		xor	al, 30h
		or	g_bJoyInput, al
		mov	al, g_bJoyInput
		xor	ah, ah
		retf
; ---------------------------------------------------------------------------

loc_1EA2_1D8D:				; CODE XREF: GetJoystickFlag+191j
		or	g_bJoyInput, 1
		jmp	short loc_1EA2_1D7A
GetJoystickFlag	endp


; =============== S U B	R O U T	I N E =======================================


SetupJoyVals	proc far		; CODE XREF: DoJoyResText+15FP
		mov	g_bSkipJoystick, 1
		mov	word_2B77_43A8,	50h ; 'P'
		mov	word_2B77_43AC,	0
		mov	word_2B77_43B6,	50h ; 'P'
		mov	word_2B77_43BA,	0
		retf
SetupJoyVals	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LookupArray	proc far		; CODE XREF: DoJoyResText+184P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_0]
		and	bx, 0Fh
		mov	al, g_pcArray[bx]
		xor	ah, ah
		pop	bp
		retf
LookupArray	endp


; =============== S U B	R O U T	I N E =======================================


CheckJoyFlag	proc far		; CODE XREF: RecordReplay:loc_11B7_C2AP
		mov	ax, g_wJoyFlag1
		sub	ax, word_2B77_43A8
		jge	short loc_1EA2_1DCE
		xor	ax, ax

loc_1EA2_1DCE:				; CODE XREF: CheckJoyFlag+7j
		mul	word_2B77_43C4
		mov	al, ah
		mov	ah, dl
		sub	ax, 1Fh
		retf
CheckJoyFlag	endp

; [00000017 BYTES: COLLAPSED FUNCTION nopsub_1EA2_1DDA.	PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================


SetupSomeHandlers proc far		; CODE XREF: SetVideoMode+8P
		push	di
		in	al, 21h		; Interrupt controller,	8259A.
		mov	ah, al
		or	al, 3
		out	21h, al		; Interrupt controller,	8259A.
		xor	bx, bx
		mov	es, bx
		assume es:nothing
		mov	bx, es:24h
		cmp	bx, offset SomeIntrHandler
		jz	short loc_1EA2_1E41
		mov	word_2B77_43D8,	bx
		mov	bx, es:26h
		mov	word_2B77_43DA,	bx
		mov	word ptr es:24h, offset	SomeIntrHandler
		mov	word ptr es:26h, cs
		mov	bx, es:58h
		mov	word_2B77_43DC,	bx
		mov	bx, es:5Ah
		mov	word_2B77_43DE,	bx
		mov	word ptr es:58h, offset	SomeIntrHandler2
		mov	word ptr es:5Ah, cs

loc_1EA2_1E41:				; CODE XREF: SetupSomeHandlers+16j
		mov	al, ah
		out	21h, al		; Interrupt controller,	8259A.
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset g_pKbInput
		mov	cx, 5Ah	; 'Z'
		xor	ax, ax
		cld
		rep stosb
		push	cs
		mov	ax, offset StopIntsModPsp
		push	ax
		call	AddExitHandler
		add	sp, 4
		pop	di
		retf
SetupSomeHandlers endp


; =============== S U B	R O U T	I N E =======================================


StopIntsModPsp	proc far		; CODE XREF: _main+584P
					; DATA XREF: SetupSomeHandlers+63o
		in	al, 21h		; Interrupt controller,	8259A.
		mov	ah, al
		or	al, 3
		out	21h, al		; Interrupt controller,	8259A.
		xor	bx, bx
		mov	es, bx
		assume es:nothing
		mov	bx, word_2B77_43D8
		or	bx, bx
		jz	short loc_1EA2_1EA1
		mov	es:24h,	bx
		mov	bx, word_2B77_43DA
		mov	es:26h,	bx
		mov	bx, word_2B77_43DC
		mov	es:58h,	bx
		mov	bx, word_2B77_43DE
		mov	es:5Ah,	bx
		mov	al, es:417h
		and	al, 0F0h
		mov	es:417h, al

loc_1EA2_1EA1:				; CODE XREF: StopIntsModPsp+12j
		mov	al, ah
		out	21h, al		; Interrupt controller,	8259A.
		retf
StopIntsModPsp	endp


; =============== S U B	R O U T	I N E =======================================


SomeIntrHandler	proc far		; DATA XREF: SetupSomeHandlers+12o
					; SetupSomeHandlers+25o
		sti
		push	ax
		push	bx
		push	cx
		push	dx
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		in	al, 60h		; AT Keyboard controller 8042.
		push	ax
		in	al, 61h		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		mov	ah, al
		or	al, 80h
		out	61h, al		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		xchg	ah, al
		out	61h, al		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		pop	ax
		test	al, 80h
		jz	short loc_1EA2_1ED4
		and	al, 7Fh
		jmp	loc_1EA2_1F72
; ---------------------------------------------------------------------------

loc_1EA2_1ECA:				; CODE XREF: SomeIntrHandler+A3j
					; SomeIntrHandler+DCj
		mov	al, 20h	; ' '
		out	20h, al		; Interrupt controller,	8259A.
		pop	ds
		pop	dx
		pop	cx
		pop	bx
		pop	ax
		iret
; ---------------------------------------------------------------------------

loc_1EA2_1ED4:				; CODE XREF: SomeIntrHandler+1Dj
		xor	ah, ah
		mov	bx, ax
		cmp	bx, 5Ah	; 'Z'
		jb	short loc_1EA2_1EDF
		xor	bx, bx

loc_1EA2_1EDF:				; CODE XREF: SomeIntrHandler+35j
		mov	word_2B77_4468,	bx
		mov	byte ptr [bx+446Ah], 1
		test	g_pKbInput+38h,	1
		jnz	short loc_1EA2_1F66
		test	g_pKbInput+1Dh,	1
		jnz	short loc_1EA2_1F60
		test	g_pKbInput+2Ah,	1
		jnz	short loc_1EA2_1F5A
		test	g_pKbInput+36h,	1
		jnz	short loc_1EA2_1F5A
		test	g_pKbInput+3Ah,	1
		jnz	short loc_1EA2_1F6C
		mov	al, [bx+44C4h]

loc_1EA2_1F0F:				; CODE XREF: SomeIntrHandler+B8j
					; SomeIntrHandler+BEj ...
		test	al, 80h
		jnz	short loc_1EA2_1F4C
		xor	ah, ah

loc_1EA2_1F15:				; CODE XREF: SomeIntrHandler:loc_1EA2_1F58j
		mov	bx, word_2B77_4460
		cli
		mov	[bx+43E0h], ax
		add	bx, 2
		cmp	bx, word_2B77_4464
		jb	short loc_1EA2_1F29
		xor	bx, bx

loc_1EA2_1F29:				; CODE XREF: SomeIntrHandler+7Fj
		mov	word_2B77_4460,	bx
		mov	bx, word_2B77_4466
		add	bx, 2
		cmp	bx, word_2B77_4464
		jbe	short loc_1EA2_1F44
		mov	bx, word_2B77_4464
		mov	ax, word_2B77_4460
		mov	word_2B77_4462,	ax

loc_1EA2_1F44:				; CODE XREF: SomeIntrHandler+92j
		mov	word_2B77_4466,	bx
		sti
		jmp	loc_1EA2_1ECA
; ---------------------------------------------------------------------------

loc_1EA2_1F4C:				; CODE XREF: SomeIntrHandler+6Bj
		mov	ah, al
		xor	al, al
		cmp	ah, 85h	; '…'
		jb	short loc_1EA2_1F58
		and	ah, 7Fh

loc_1EA2_1F58:				; CODE XREF: SomeIntrHandler+ADj
		jmp	short loc_1EA2_1F15
; ---------------------------------------------------------------------------

loc_1EA2_1F5A:				; CODE XREF: SomeIntrHandler+55j
					; SomeIntrHandler+5Cj
		mov	al, [bx+451Fh]
		jmp	short loc_1EA2_1F0F
; ---------------------------------------------------------------------------

loc_1EA2_1F60:				; CODE XREF: SomeIntrHandler+4Ej
		mov	al, [bx+45D5h]
		jmp	short loc_1EA2_1F0F
; ---------------------------------------------------------------------------

loc_1EA2_1F66:				; CODE XREF: SomeIntrHandler+47j
		mov	al, [bx+4630h]
		jmp	short loc_1EA2_1F0F
; ---------------------------------------------------------------------------

loc_1EA2_1F6C:				; CODE XREF: SomeIntrHandler+63j
		mov	al, [bx+457Ah]
		jmp	short loc_1EA2_1F0F
; ---------------------------------------------------------------------------

loc_1EA2_1F72:				; CODE XREF: SomeIntrHandler+21j
		xor	ah, ah
		mov	bx, ax
		cmp	bx, 5Ah	; 'Z'
		jb	short loc_1EA2_1F7D
		xor	bx, bx

loc_1EA2_1F7D:				; CODE XREF: SomeIntrHandler+D3j
		mov	byte ptr [bx+446Ah], 0
		jmp	loc_1EA2_1ECA
SomeIntrHandler	endp


; =============== S U B	R O U T	I N E =======================================


SomeIntrHandler2 proc far		; DATA XREF: SetupSomeHandlers+43o
		push	bx
		push	ds
		mov	bx, seg	dseg
		mov	ds, bx
		cmp	ah, 0
		jz	short loc_1EA2_1FA3
		cmp	ah, 1
		jz	short loc_1EA2_1FCF
		cmp	ah, 2
		jz	short loc_1EA2_1FE4

loc_1EA2_1F9B:				; CODE XREF: SomeIntrHandler2+24j
					; SomeIntrHandler2+4Fj
		xor	ax, ax

loc_1EA2_1F9D:				; CODE XREF: SomeIntrHandler2+48j
					; SomeIntrHandler2+66j
		sti
		pop	ds
		pop	bx
		retf	2
; ---------------------------------------------------------------------------

loc_1EA2_1FA3:				; CODE XREF: SomeIntrHandler2+Aj
		cli
		cmp	word_2B77_4466,	0
		jz	short loc_1EA2_1F9B
		mov	bx, word_2B77_4462
		mov	ax, [bx+43E0h]
		add	bx, 2
		cmp	bx, word_2B77_4464
		jb	short loc_1EA2_1FBE
		xor	bx, bx

loc_1EA2_1FBE:				; CODE XREF: SomeIntrHandler2+35j
		mov	word_2B77_4462,	bx
		mov	bx, word_2B77_4466
		sub	bx, 2
		mov	word_2B77_4466,	bx
		jmp	short loc_1EA2_1F9D
; ---------------------------------------------------------------------------

loc_1EA2_1FCF:				; CODE XREF: SomeIntrHandler2+Fj
		cmp	word_2B77_4466,	0
		jz	short loc_1EA2_1F9B
		sti
		mov	bx, word_2B77_4462
		mov	ax, [bx+43E0h]
		pop	ds
		pop	bx

locret_1EA2_1FE1:
		retf	2
; ---------------------------------------------------------------------------

loc_1EA2_1FE4:				; CODE XREF: SomeIntrHandler2+14j
		mov	al, g_pKbInput+2Ah
		or	al, g_pKbInput+36h
		jmp	short loc_1EA2_1F9D
SomeIntrHandler2 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetKeyStatus	proc far		; CODE XREF: RecordReplay+15BP
					; RecordReplay+16FP ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_0]
		mov	al, g_pKbInput[bx]
		xor	ah, ah
		pop	bp
		retf
GetKeyStatus	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


CallReadCharCB	proc far		; CODE XREF: DoCallReadCharCBRepP
					; DoGetTimerKb2P ...
		call	dword ptr g_pReadCharFunc
		retf
CallReadCharCB	endp


; =============== S U B	R O U T	I N E =======================================


ReadKbChar	proc far		; CODE XREF: DoJoyResText:loc_174B_27E6P
					; DATA XREF: dseg:g_pReadCharFunco
		mov	ah, 1
		int	16h		; KEYBOARD - CHECK BUFFER, DO NOT CLEAR
					; Return: ZF clear if character	in buffer
					; AH = scan code, AL = character
					; ZF set if no character in buffer
		jnz	short loc_1EA2_200A
		xor	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_1EA2_200A:				; CODE XREF: ReadKbChar+4j
		mov	ah, 0
		int	16h		; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
					; Return: AH = scan code, AL = character
		or	al, al
		jz	short locret_1EA2_2014
		xor	ah, ah

locret_1EA2_2014:			; CODE XREF: ReadKbChar+Fj
		retf
ReadKbChar	endp


; =============== S U B	R O U T	I N E =======================================


KbChecking	proc far		; CODE XREF: DoKbChecking+BP
					; DoKbChecking2+BP
		mov	ah, 1
		int	16h		; KEYBOARD - CHECK BUFFER, DO NOT CLEAR
					; Return: ZF clear if character	in buffer
					; AH = scan code, AL = character
					; ZF set if no character in buffer
		jnz	short loc_1EA2_201D
		xor	ax, ax

loc_1EA2_201D:				; CODE XREF: KbChecking+4j
		or	al, al
		jz	short locret_1EA2_2023
		xor	ah, ah

locret_1EA2_2023:			; CODE XREF: KbChecking+Aj
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	ax, [bp+6]
		mov	g_pReadCharFunc, ax
		mov	ax, [bp+8]
		mov	seg_2B77_468E, ax
		pop	bp
		retf
; ---------------------------------------------------------------------------
		mov	ax, g_pReadCharFunc
		mov	dx, seg_2B77_468E
		retf
KbChecking	endp


; =============== S U B	R O U T	I N E =======================================


DoCallReadCharCBRep proc far		; CODE XREF: seg012:0016P
					; DoCallReadCharCBRep+8j ...
		call	CallReadCharCB
		cmp	ax, 0
		jz	short near ptr DoCallReadCharCBRep
		retf
DoCallReadCharCBRep endp


; =============== S U B	R O U T	I N E =======================================


KbCheckAndRead	proc far		; CODE XREF: DoJoyResText:loc_174B_28CBP
					; KbCheckAndRead+Dj
		mov	ah, 1
		int	16h		; KEYBOARD - CHECK BUFFER, DO NOT CLEAR
					; Return: ZF clear if character	in buffer
					; AH = scan code, AL = character
					; ZF set if no character in buffer
		jnz	short loc_1EA2_2051
		xor	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2051:				; CODE XREF: KbCheckAndRead+4j
		mov	ah, 0
		int	16h		; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
					; Return: AH = scan code, AL = character
		jmp	short near ptr KbCheckAndRead
KbCheckAndRead	endp


; =============== S U B	R O U T	I N E =======================================


DoGetTimerKb2	proc far		; CODE XREF: DoGetTimerKb2+13j
					; DoGetTimerKb2+1Bj
		call	CallReadCharCB
		cmp	ax, 0
		jnz	short locret_1EA2_2076
		call	GetTimerCounter
		cmp	dx, word ptr g_wTimerCounter+2
		jb	short near ptr DoGetTimerKb2
		ja	short loc_1EA2_2074
		cmp	ax, word ptr g_wTimerCounter
		jb	short near ptr DoGetTimerKb2

loc_1EA2_2074:				; CODE XREF: DoGetTimerKb2+15j
		xor	ax, ax

locret_1EA2_2076:			; CODE XREF: DoGetTimerKb2+8j
		retf
DoGetTimerKb2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoGetTimerKb	proc far

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		call	GetTimerCounter
		add	ax, [bp+arg_2]
		adc	dx, [bp+arg_4]
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_1EA2_208E:				; CODE XREF: DoGetTimerKb+29j
					; DoGetTimerKb+30j
		call	CallReadCharCB
		cmp	ax, 0
		jnz	short loc_1EA2_20AB
		call	GetTimerCounter
		cmp	dx, [bp+var_2]
		jb	short loc_1EA2_208E
		ja	short loc_1EA2_20A9
		cmp	ax, [bp+var_4]
		jb	short loc_1EA2_208E

loc_1EA2_20A9:				; CODE XREF: DoGetTimerKb+2Bj
		xor	ax, ax

loc_1EA2_20AB:				; CODE XREF: DoGetTimerKb+1Fj
		mov	sp, bp
		pop	bp
		retf
DoGetTimerKb	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadBinaryFileW	proc far		; CODE XREF: LoadRes0_1Type+4EP
					; UncompressFileR+73P

var_8		= word ptr -8
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		mov	ax, [bp+arg_8]
		mov	[bp+var_8], ax
		jmp	short loc_1EA2_20DB
LoadBinaryFileW	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadBinaryFile2	proc far		; CODE XREF: LoadHighScoreMa+1FP
					; LoadHighScoreMa+49P

var_8		= word ptr -8

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		mov	[bp+var_8], 0
		jmp	short loc_1EA2_20DB
LoadBinaryFile2	endp

; ---------------------------------------------------------------------------
		db 90h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadBinaryFile	proc far		; CODE XREF: _main+425P
					; RunTracksMenu+467P ...

var_11C		= byte ptr -11Ch
var_1C		= word ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= byte ptr -10h
var_8		= word ptr -8
pDestSeg	= word ptr -6
pDestOfs	= word ptr -4
f		= word ptr -2
p_pcPath	= word ptr  6
p_pDestOfs	= word ptr  8
p_pDestSeg	= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		mov	[bp+var_8], 1

loc_1EA2_20DB:				; CODE XREF: LoadBinaryFileW+Dj
					; LoadBinaryFile2+Cj
		mov	ax, [bp+p_pDestOfs]
		mov	[bp+pDestOfs], ax
		mov	ax, [bp+p_pDestSeg]
		mov	[bp+pDestSeg], ax
		mov	dx, [bp+p_pcPath]
		xor	al, al
		mov	ah, 3Dh
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jb	short loc_1EA2_2123
		mov	[bp+f],	ax

loc_1EA2_20F5:				; CODE XREF: LoadBinaryFile+40j
		mov	ds, [bp+pDestSeg]
		mov	dx, [bp+pDestOfs]
		mov	cx, 4000h
		mov	bx, [bp+f]
		mov	ah, 3Fh
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		jb	short loc_1EA2_2123
		add	[bp+pDestSeg], 400h
		cmp	ax, 4000h
		jz	short loc_1EA2_20F5
		mov	bx, [bp+f]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		mov	ax, [bp+p_pDestOfs]
		mov	dx, [bp+p_pDestSeg]
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2123:				; CODE XREF: LoadBinaryFile+21j
					; LoadBinaryFile+36j
		cmp	[bp+var_8], 0
		jnz	short loc_1EA2_2132
		xor	ax, ax
		xor	dx, dx
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2132:				; CODE XREF: LoadBinaryFile+58j
		mov	ax, offset aSFileError ; "%s FILE ERROR\r"
		mov	bx, ss
		mov	ds, bx
		push	[bp+p_pcPath]
		push	ax
		call	far ptr	ErrorMessage
LoadBinaryFile	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UncompressRelated proc far		; CODE XREF: UncompressFileR+B8J
					; DATA XREF: UncompressFileR:off_1EA2_24E4o

var_11C		= byte ptr -11Ch
var_1C		= word ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= byte ptr -10h
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		sub	sp, 116h
		cld
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	si, [bp+arg_0]
		mov	ds, [bp+arg_2]
		mov	ax, [si+1]
		mov	[bp+var_1A], ax
		mov	al, [si+3]
		xor	ah, ah
		mov	[bp+var_18], ax
		add	si, 4
		mov	cx, 8
		lea	di, [bp+var_16]
		rep movsw
		mov	si, [bp+arg_0]
		add	si, 9
		mov	dx, [bp+var_12]
		and	dx, 7Fh
		add	si, dx
		mov	[bp+arg_0], si
		cmp	byte ptr [bp+var_12], 80h ; '€'
		ja	short loc_1EA2_21C6
		call	loc_1EA2_22AF
		mov	[bp+var_16], ax
		mov	[bp+var_14], dx
		mov	si, ax
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		test	si, 0Fh
		jz	short loc_1EA2_21A9
		inc	ax

loc_1EA2_21A9:				; CODE XREF: UncompressRelated+64j
		push	ax
		mov	bx, [bp+arg_8]
		sub	bx, ax
		add	bx, [bp+arg_6]
		mov	[bp+arg_2], bx
		push	bx
		push	[bp+arg_6]
		call	sub_1EA2_27B5
		add	sp, 6
		xor	si, si
		mov	[bp+arg_0], si

loc_1EA2_21C6:				; CODE XREF: UncompressRelated+43j
		call	loc_1EA2_21D8
		mov	ax, [bp+var_1A]
		mov	dx, [bp+var_18]
		add	sp, 116h
		pop	di
		pop	si
		pop	ds
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_21D8:				; CODE XREF: UncompressRelated:loc_1EA2_21C6p
		mov	cx, 80h	; '€'
		lea	di, [bp+var_11C]
		mov	ax, ss
		mov	es, ax
		assume es:nothing
		mov	ds, ax
		xor	ax, ax
		rep stosw
		mov	cl, byte ptr [bp+var_12]
		and	cx, 7Fh
		lea	si, [bp+var_12+1]
		lea	di, [bp+var_11C]
		xor	ax, ax
		xor	bh, bh

loc_1EA2_21FA:				; CODE XREF: UncompressRelated+BEj
		inc	ax
		mov	bl, [si]
		mov	[bx+di], al
		inc	si
		loop	loc_1EA2_21FA
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	es, [bp+arg_6]
		xor	di, di
		mov	dx, [bp+var_16]
		mov	ax, [bp+var_14]
		mov	[bp+var_1C], ax

loc_1EA2_2216:				; CODE XREF: UncompressRelated+F9j
					; UncompressRelated+104j ...
		cmp	si, 8000h
		jbe	short loc_1EA2_221F
		jmp	short loc_1EA2_2293
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_221F:				; CODE XREF: UncompressRelated+D8j
					; UncompressRelated+15Cj
		cmp	di, 8000h
		jbe	short loc_1EA2_2228
		jmp	short loc_1EA2_22A1
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_2228:				; CODE XREF: UncompressRelated+E1j
					; UncompressRelated+16Aj
		lodsb
		xor	ah, ah
		lea	bx, [bp+var_11C]
		add	bx, ax
		mov	cl, ss:[bx+0]
		test	cl, 0FFh
		jnz	short loc_1EA2_2248
		stosb
		dec	dx
		jnz	short loc_1EA2_2216
		cmp	[bp+var_1C], 0
		jz	short loc_1EA2_226A
		dec	[bp+var_1C]
		jmp	short loc_1EA2_2216
; ---------------------------------------------------------------------------

loc_1EA2_2248:				; CODE XREF: UncompressRelated+F5j
		xor	ch, ch
		cmp	cl, 1
		jz	short loc_1EA2_227A
		cmp	cl, 3
		jz	short loc_1EA2_2285
		dec	cx
		lodsb
		rep stosb
		sub	dx, 2

loc_1EA2_225B:				; CODE XREF: UncompressRelated+141j
					; UncompressRelated+14Fj
		mov	ax, [bp+var_1C]
		sbb	ax, 0
		mov	[bp+var_1C], ax
		or	ax, dx
		jz	short loc_1EA2_226A
		jmp	short loc_1EA2_2216
; ---------------------------------------------------------------------------

loc_1EA2_226A:				; CODE XREF: UncompressRelated+FFj
					; UncompressRelated+124j
		mov	dx, es
		sub	dx, [bp+arg_6]
		mov	ax, 10h
		mul	dx
		add	ax, di
		adc	dx, 0
		retn
; ---------------------------------------------------------------------------

loc_1EA2_227A:				; CODE XREF: UncompressRelated+10Bj
		lodsb
		mov	cl, al
		lodsb
		rep stosb
		sub	dx, 3
		jmp	short loc_1EA2_225B
; ---------------------------------------------------------------------------

loc_1EA2_2285:				; CODE XREF: UncompressRelated+110j
		lodsb
		mov	cl, al
		lodsb
		mov	ch, al
		lodsb
		rep stosb
		sub	dx, 4
		jmp	short loc_1EA2_225B
; ---------------------------------------------------------------------------

loc_1EA2_2293:				; CODE XREF: UncompressRelated+DAj
		sub	si, 8000h
		mov	ax, ds
		add	ax, 800h
		mov	ds, ax
		assume ds:nothing
		jmp	loc_1EA2_221F
; ---------------------------------------------------------------------------

loc_1EA2_22A1:				; CODE XREF: UncompressRelated+E3j
		sub	di, 8000h
		mov	ax, es
		add	ax, 800h
		mov	es, ax
		assume es:nothing
		jmp	loc_1EA2_2228
; ---------------------------------------------------------------------------

loc_1EA2_22AF:				; CODE XREF: UncompressRelated+45p
		cmp	byte ptr [bp+var_12], 1
		jnz	short loc_1EA2_22B6
		retn
; ---------------------------------------------------------------------------

loc_1EA2_22B6:				; CODE XREF: UncompressRelated+171j
		mov	ds, [bp+arg_2]
		assume ds:dseg
		mov	si, [bp+arg_0]
		mov	es, [bp+arg_6]
		assume es:nothing
		xor	di, di
		mov	bx, [bp+var_16]
		mov	ax, [bp+var_14]
		mov	[bp+var_1C], ax
		mov	ah, [bp+var_10]

loc_1EA2_22CD:				; CODE XREF: UncompressRelated+19Ej
					; UncompressRelated+1A9j ...
		cmp	si, 8000h
		ja	short loc_1EA2_22ED

loc_1EA2_22D3:				; CODE XREF: UncompressRelated+1B7j
		cmp	di, 8000h
		ja	short loc_1EA2_22FB

loc_1EA2_22D9:				; CODE XREF: UncompressRelated+1C5j
		lodsb
		cmp	al, ah
		jz	short loc_1EA2_2319
		stosb
		dec	bx
		jnz	short loc_1EA2_22CD
		cmp	[bp+var_1C], 0
		jz	short loc_1EA2_2309
		dec	[bp+var_1C]
		jmp	short loc_1EA2_22CD
; ---------------------------------------------------------------------------

loc_1EA2_22ED:				; CODE XREF: UncompressRelated+18Fj
		sub	si, 8000h
		mov	dx, ds
		add	dx, 800h
		mov	ds, dx
		assume ds:nothing
		jmp	short loc_1EA2_22D3
; ---------------------------------------------------------------------------

loc_1EA2_22FB:				; CODE XREF: UncompressRelated+195j
		sub	di, 8000h
		mov	dx, es
		add	dx, 800h
		mov	es, dx
		assume es:nothing
		jmp	short loc_1EA2_22D9
; ---------------------------------------------------------------------------

loc_1EA2_2309:				; CODE XREF: UncompressRelated+1A4j
					; UncompressRelated+212j
		mov	dx, es
		sub	dx, [bp+arg_6]
		mov	ax, 10h
		mul	dx
		add	ax, di
		adc	dx, 0
		retn
; ---------------------------------------------------------------------------

loc_1EA2_2319:				; CODE XREF: UncompressRelated+19Aj
		mov	dx, di

loc_1EA2_231B:				; CODE XREF: UncompressRelated+1E0j
					; UncompressRelated+1E5j
		lodsb
		cmp	al, ah
		jz	short loc_1EA2_2329
		stosb
		dec	bx
		jnz	short loc_1EA2_231B
		dec	[bp+var_1C]
		jmp	short loc_1EA2_231B
; ---------------------------------------------------------------------------

loc_1EA2_2329:				; CODE XREF: UncompressRelated+1DCj
		lodsb
		push	si
		push	ds
		mov	cx, es
		mov	ds, cx
		assume ds:nothing
		mov	si, dx
		mov	cx, di
		sub	cx, dx
		mov	dl, al
		dec	dl

loc_1EA2_233A:				; CODE XREF: UncompressRelated+202j
		push	cx
		push	si
		push	ds
		rep movsb
		pop	ds
		assume ds:dseg
		pop	si
		pop	cx
		dec	dl
		jnz	short loc_1EA2_233A
		pop	ds
		pop	si
		sub	bx, 3
		sbb	[bp+var_1C], 0
		mov	dx, [bp+var_1C]
		or	dx, bx
		jz	short loc_1EA2_2309
		jmp	loc_1EA2_22CD
UncompressRelated endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadRes01Alt	proc far		; CODE XREF: Load2DShape+23BP
					; Load2DShape+25BP

var_2		= word ptr -2
arg_4		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 2
		mov	ax, [bp+arg_4]
		mov	[bp+var_2], ax
		jmp	short loc_1EA2_2381
LoadRes01Alt	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadRes0_1Type	proc far		; CODE XREF: LoadResource+1DP
					; LoadResource+31P ...

var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 2
		mov	[bp+var_2], 0
		jmp	short loc_1EA2_2381
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 2
		mov	[bp+var_2], 1

loc_1EA2_2381:				; CODE XREF: LoadRes01Alt+Cj
					; LoadRes0_1Type+Bj
		push	[bp+arg_0]
		call	GetResSomething
		add	sp, 2
		or	dx, dx
		jnz	short loc_1EA2_23BE
		push	[bp+var_2]
		push	[bp+arg_0]
		call	_AltFileSize+1
		add	sp, 4
		or	ax, ax
		jz	short loc_1EA2_23C2
		push	ax
		push	[bp+arg_0]
		call	AllocResPages
		add	sp, 4
		push	[bp+var_2]
		push	dx
		push	ax
		push	[bp+arg_0]
		call	LoadBinaryFileW
		add	sp, 8

loc_1EA2_23BE:				; CODE XREF: LoadRes0_1Type+26j
					; LoadRes0_1Type+5Cj
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_23C2:				; CODE XREF: LoadRes0_1Type+38j
		xor	dx, dx
		jmp	short loc_1EA2_23BE
LoadRes0_1Type	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadPvs		proc far		; CODE XREF: Load2DShape+D6P
					; Load2DShape+143P ...

var_C		= word ptr -0Ch
arg_4		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	di
		mov	ax, [bp+arg_4]
		mov	[bp+var_C], ax
		jmp	short _AltUncompressF
LoadPvs		endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AltUncompressFi	proc far		; CODE XREF: LoadResource+41P
					; LoadSfxGe+5DP ...

var_C		= word ptr -0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	di
		mov	[bp+var_C], 0	; var_c	= 0
					; regular UncompressFile has var_c = 1
		jmp	short _AltUncompressF
AltUncompressFi	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UncompressFileR	proc far		; CODE XREF: UncompressFileR+17DP

var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	di
		mov	[bp+var_C], 1

_AltUncompressF:			; CODE XREF: LoadPvs+Ej
					; AltUncompressFi+Dj
		push	[bp+arg_0]
		call	GetResSomething
		add	sp, 2
		or	dx, dx
		jz	short loc_1EA2_240C
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2409:				; CODE XREF: UncompressFileR+35j
					; UncompressFileR+5Fj ...
		jmp	loc_1EA2_24EF
; ---------------------------------------------------------------------------

loc_1EA2_240C:				; CODE XREF: UncompressFileR+1Aj
		push	[bp+var_C]
		push	[bp+arg_0]
		call	Read4BytesFromF
		add	sp, 4
		or	ax, ax
		jz	short loc_1EA2_2409
		add	ax, 4
		mov	[bp+var_6], ax
		push	ax
		push	[bp+arg_0]
		call	AllocResPages
		add	sp, 4
		mov	[bp+var_2], ax
		mov	[bp+var_4], dx
		push	[bp+var_C]
		push	[bp+arg_0]
		call	_AltFileSize+1
		add	sp, 4
		or	ax, ax
		jz	short loc_1EA2_2409
		mov	dx, [bp+var_6]
		sub	dx, ax
		add	dx, [bp+var_4]
		push	[bp+var_C]
		push	dx
		push	[bp+var_2]
		push	[bp+arg_0]
		call	LoadBinaryFileW
		add	sp, 8
		or	dx, dx
		jz	short loc_1EA2_2409
		mov	[bp+var_8], 1
		mov	ds, dx
		mov	si, ax
		mov	al, [si]
		test	al, 80h
		jz	short loc_1EA2_247E
		and	ax, 7Fh
		mov	[bp+var_8], ax
		add	si, 4

loc_1EA2_247E:				; CODE XREF: UncompressFileR+8Cj
					; UncompressFileR+FBj
		push	[bp+var_6]
		push	[bp+var_4]
		push	[bp+var_2]
		push	ds
		mov	bl, [si]
		dec	bl
		jl	short loc_1EA2_24EC
		cmp	bl, 2
		jge	short loc_1EA2_24EC
		push	si
		xor	bh, bh
		shl	bx, 1
		mov	ax, seg	dseg
		mov	ds, ax
		shl	bx, 1
		call	cs:off_1EA2_24E4[bx]
		add	sp, 0Ah
		dec	[bp+var_8]
		jle	short loc_1EA2_250F
		mov	si, ax
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		test	si, 0Fh
		jz	short loc_1EA2_24C5
		inc	ax

loc_1EA2_24C5:				; CODE XREF: UncompressFileR+DBj
		push	ax
		mov	bx, [bp+var_6]
		sub	bx, ax
		add	bx, [bp+var_4]
		mov	[bp+var_A], bx
		push	bx
		push	[bp+var_4]
		call	sub_1EA2_27B5
		add	sp, 6
		mov	ds, [bp+var_A]
		xor	si, si
		jmp	short loc_1EA2_247E
; ---------------------------------------------------------------------------
off_1EA2_24E4	dd UncompressRelated	; DATA XREF: UncompressFileR+B8r
		dd sub_1EA2_435C
; ---------------------------------------------------------------------------

loc_1EA2_24EC:				; CODE XREF: UncompressFileR+A5j
					; UncompressFileR+AAj
		add	sp, 8

loc_1EA2_24EF:				; CODE XREF: UncompressFileR:loc_1EA2_2409j
		cmp	word ptr [bp-0Ch], 0
		jnz	short loc_1EA2_24FF
		xor	ax, ax
		xor	dx, dx
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_24FF:				; CODE XREF: UncompressFileR+10Cj
		mov	bx, ss
		mov	ds, bx
		push	word ptr [bp+6]
		mov	ax, offset aSInvalidPackTy ; "%s INVALID PACK TYPE\r"
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_250F:				; CODE XREF: UncompressFileR+C3j
		mov	ax, [bp+var_6]
		sub	ax, 4
		push	ax
		push	[bp+var_4]
		push	[bp+var_2]
		call	ResizeMemory
		add	sp, 6
		mov	ax, [bp+var_2]
		mov	dx, [bp+var_4]
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	di
		mov	ax, [bp+arg_6]
		mov	[bp+var_C], ax
		jmp	short _AltLoadBinRes
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	di
		mov	[bp+var_C], 0
		jmp	short _AltLoadBinRes
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	di
		mov	[bp+var_C], 1

_AltLoadBinRes:				; CODE XREF: UncompressFileR+157j
					; UncompressFileR+167j
		push	[bp+var_C]
		push	[bp+arg_0]
		call	UncompressFileR
		add	sp, 4
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
UncompressFileR	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LocateShape0	proc far		; CODE XREF: LoadGame3dShpes+6CP
					; SetupCarShapes+1B7P ...
		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		xor	dx, dx
		jmp	short _AltLocateResou
LocateShape0	endp

; ---------------------------------------------------------------------------
		db 90h
; LocateResource1 calls	LocateResource2	with dx	= 1
; Calls	to LocateResource2 will	have dx	= 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LocateShape	proc far		; CODE XREF: RunIntro+27P RunIntro+54P ...
		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		mov	dx, 1		; dx =1	= locateshape error
					; dx >1	= locatesound error
					; dx = 0 .. ? from DoAltLocateShape
		jmp	short _AltLocateResou
LocateShape	endp

; ---------------------------------------------------------------------------
		db 90h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LocateSound	proc far		; CODE XREF: sub_267B_76+17P

p_dwRes		= dword	ptr  6
p_pResID	= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		mov	dx, 2

_AltLocateResou:			; CODE XREF: LocateShape0+8j
					; LocateShape+9j
		cld
		mov	ds, word ptr [bp+p_dwRes+2]
		mov	si, word ptr [bp+p_dwRes]
		mov	ax, seg	dseg
		mov	es, ax
		assume es:dseg
		mov	di, [bp+p_pResID]
		mov	cx, 4
		mov	bx, 0

loc_1EA2_25A7:				; CODE XREF: LocateSound+25j
		cmp	byte ptr es:[bx+di], 0
		jz	short loc_1EA2_2604
		inc	bx
		loop	loc_1EA2_25A7
; now we are sure we have a 4-byte space-padded	id

loc_1EA2_25B0:				; CODE XREF: LocateSound+82j
		mov	ax, [si+4]	; resource+4 ==	resource index,	> 0
		or	ax, ax
		jz	short _EndOfLocate ; if	[resource+4] ==	0, exit	function
		add	si, 6		; si + 6 = resource id?
		mov	bx, si

loc_1EA2_25BC:				; CODE XREF: LocateSound+54j
		mov	si, bx
		mov	di, [bp+p_pResID]
		mov	cx, 4		; check	for resid at resource+6

loc_1EA2_25C4:				; CODE XREF: LocateSound+3Ej
		cmpsb
		jnz	short loc_1EA2_25CC ; jnz = ulik (zf ==	true hvis begge	er like, zf er true hvis a-b = 0)
		loop	loc_1EA2_25C4
		jmp	short _FoundResource
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_25CC:				; CODE XREF: LocateSound+3Cj
		cmp	byte ptr [si-1], 0 ; id	was mismatch
		jnz	short loc_1EA2_25D9 ; if it was	non zero mismatch, try next
		cmp	byte ptr es:[di-1], 20h	; ' ' ; accept zero for space at the end of the comparison
		jz	short _FoundResource

loc_1EA2_25D9:				; CODE XREF: LocateSound+47j
		add	bx, 4
		dec	ax
		jge	short loc_1EA2_25BC ; lets try next, ax	is probably the	index of the current resource

_EndOfLocate:				; CODE XREF: LocateSound+2Cj
		cmp	dx, 1
		jl	short loc_1EA2_25FF
		jg	short loc_1EA2_25EC
		mov	dx, offset aLocateshape4_4 ; "locateshape - %-4.4s SHAPE NOT FOUND\r\n"
		jmp	short loc_1EA2_25EF
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_25EC:				; CODE XREF: LocateSound+5Bj
		mov	dx, offset aLocatesound4_4 ; "locatesound - %-4.4s SOUND NOT FOUND\r\n"

loc_1EA2_25EF:				; CODE XREF: LocateSound+60j
		mov	ax, seg	dseg
		mov	ds, ax
		push	[bp+p_pResID]
		push	dx
		call	far ptr	ErrorMessage
		int	20h		; DOS -	PROGRAM	TERMINATION
					; returns to DOS--identical to INT 21/AH=00h
; ---------------------------------------------------------------------------

loc_1EA2_25FF:				; CODE XREF: LocateSound+59j
		xor	ax, ax
		jmp	short loc_1EA2_2655
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_2604:				; CODE XREF: LocateSound+22j
					; LocateSound+80j
		mov	byte ptr es:[bx+di], 20h ; ' ' ; if the 4-byte id has a zero into, pad with spaces instead
		inc	bx
		loop	loc_1EA2_2604
		jmp	short loc_1EA2_25B0
; ---------------------------------------------------------------------------

_FoundResource:				; CODE XREF: LocateSound+40j
					; LocateSound+4Ej
		mov	si, word ptr [bp+p_dwRes]
		mov	ax, [si+4]	; resource +4 =	index
		shl	ax, 1
		shl	ax, 1
		add	bx, ax
		shl	ax, 1
		add	ax, 6
		mov	cx, ds
		xor	dx, dx
		shl	cx, 1
		rcl	dx, 1
		shl	cx, 1
		rcl	dx, 1
		shl	cx, 1
		rcl	dx, 1
		shl	cx, 1
		rcl	dx, 1
		add	ax, cx
		adc	dx, 0
		add	ax, [bx]
		adc	dx, [bx+2]
		mov	bx, ax
		and	bx, 0Fh
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		mov	dx, ax
		mov	ax, bx

loc_1EA2_2655:				; CODE XREF: LocateSound+78j
		pop	di
		pop	si
		pop	ds
		pop	bp
		retf
LocateSound	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AllocResMem	proc far		; CODE XREF: AllocResMemA000+4P
					; seg012:26E5P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, 3000h
		int	21h		; DOS -	GET DOS	VERSION
					; Return: AL = major version number (00h for DOS 1.x)
		mov	bx, cs
		cmp	al, 3
		jl	short loc_1EA2_266E
		mov	ah, 62h
		int	21h		; DOS -	3+ - GET PSP ADDRESS

loc_1EA2_266E:				; CODE XREF: AllocResMem+Ej
		mov	g_wPspOfs, bx
		mov	g_wPspSeg, ds
		cmp	word_2B77_4812,	0
		jnz	short loc_1EA2_26AD
		mov	bx, 64h
		mov	ah, 48h
		int	21h		; DOS -	2+ - ALLOCATE MEMORY
					; BX = number of 16-byte paragraphs desired
		mov	si, g_ppcFirstRes1
		mov	[si+Resource.dwOffset],	ax
		mov	word_2B77_4814,	ax
		mov	es, ax
		assume es:nothing
		mov	bx, [bp+arg_0]
		sub	bx, [si+Resource.dwOffset]
		mov	ah, 4Ah
		int	21h		; DOS -	2+ - ADJUST MEMORY BLOCK SIZE (SETBLOCK)
					; ES = segment address of block	to change
					; BX = new size	in paragraphs
		mov	ah, 4Ah
		int	21h		; DOS -	2+ - ADJUST MEMORY BLOCK SIZE (SETBLOCK)
					; ES = segment address of block	to change
					; BX = new size	in paragraphs
		mov	ax, word_2B77_4814
		add	ax, bx
		mov	si, g_ppcLastRes2
		mov	[si+Resource.dwOffset],	ax
		mov	word_2B77_4812,	ax

loc_1EA2_26AD:				; CODE XREF: AllocResMem+21j
					; seg012:270Fj	...
		mov	si, g_ppcLastRes2
		mov	g_ppcLastRes1, si
		mov	si, g_ppcFirstRes1
		mov	g_ppcFirstRes2,	si

loc_1EA2_26BD:				; CODE XREF: AllocResMem+71j
		add	si, 12h
		cmp	si, g_ppcLastRes2
		jz	short loc_1EA2_26CD
		mov	[si+Resource.field_10],	0
		jmp	short loc_1EA2_26BD
; ---------------------------------------------------------------------------

loc_1EA2_26CD:				; CODE XREF: AllocResMem+6Aj
		pop	di
		pop	si
		pop	bp
		retf
AllocResMem	endp


; =============== S U B	R O U T	I N E =======================================


AllocResMemA000	proc far		; CODE XREF: SetVideoMode+E3P
		mov	ax, 0A000h
		push	ax
		call	AllocResMem
		add	sp, 2
		retf
AllocResMemA000	endp

; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	ax, 0A000h
		push	ax
		call	AllocResMem
		add	sp, 2
		mov	ax, [bp+6]
		mov	bx, g_ppcLastRes2
		sub	[bx+0Eh], ax
		sub	word_2B77_4812,	ax
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	g_wPspOfs, cs
		mov	g_wPspSeg, ds
		cmp	word_2B77_4812,	0
		jnz	short loc_1EA2_26AD
		mov	bx, [bp+6]
		mov	ah, 48h
		int	21h		; DOS -	2+ - ALLOCATE MEMORY
					; BX = number of 16-byte paragraphs desired
		jnb	short loc_1EA2_271E
		mov	ah, 48h
		int	21h		; DOS -	2+ - ALLOCATE MEMORY
					; BX = number of 16-byte paragraphs desired

loc_1EA2_271E:				; CODE XREF: seg012:2718j
		mov	si, g_ppcFirstRes1
		mov	[si+Resource.dwOffset],	ax
		mov	word_2B77_4814,	ax
		add	ax, bx
		mov	si, g_ppcLastRes2
		mov	[si+Resource.dwOffset],	ax
		mov	word_2B77_4812,	ax
		jmp	loc_1EA2_26AD
; ---------------------------------------------------------------------------
		mov	bx, g_ppcLastRes1
		mov	ax, [bx+Resource.dwOffset]
		mov	bx, g_ppcFirstRes2
		sub	ax, [bx+Resource.dwOffset]
		sub	ax, [bx+Resource.dwSize]
		retf
; ---------------------------------------------------------------------------
		mov	bx, g_ppcFirstRes2
		mov	ax, [bx+Resource.dwOffset]
		add	ax, [bx+Resource.dwSize]
		mov	bx, g_ppcFirstRes1
		sub	ax, [bx+Resource.dwOffset]
		retf

; =============== S U B	R O U T	I N E =======================================


GetResDiff	proc far		; CODE XREF: GetResDiffScaleP
		mov	bx, g_ppcLastRes2
		mov	ax, [bx+Resource.dwOffset]
		mov	bx, g_ppcFirstRes2
		sub	ax, [bx+Resource.dwOffset]
		sub	ax, [bx+Resource.dwSize]
		retf
GetResDiff	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_276D	proc far		; CODE XREF: GetResSomething:loc_1EA2_29D6P
					; UnloadResource+160P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		cld
		mov	ds, [bp+arg_0]
		mov	es, [bp+arg_2]
		assume es:nothing
		mov	bx, [bp+arg_4]

loc_1EA2_277D:				; CODE XREF: sub_1EA2_276D+41j
		or	bx, bx
		jz	short loc_1EA2_27B0
		mov	cx, 8000h
		mov	ax, bx
		sub	bx, 1000h
		jnb	short loc_1EA2_279A
		add	bx, 1000h
		shl	bx, 1
		shl	bx, 1
		shl	bx, 1
		mov	cx, bx
		xor	bx, bx

loc_1EA2_279A:				; CODE XREF: sub_1EA2_276D+1Dj
		xor	si, si
		xor	di, di
		rep movsw
		mov	ax, ds
		add	ax, 1000h
		mov	ds, ax
		assume ds:nothing
		mov	ax, es
		add	ax, 1000h
		mov	es, ax
		assume es:nothing
		jmp	short loc_1EA2_277D
; ---------------------------------------------------------------------------

loc_1EA2_27B0:				; CODE XREF: sub_1EA2_276D+12j
		pop	di
		pop	si
		pop	ds
		assume ds:dseg
		pop	bp
		retf
sub_1EA2_276D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_27B5	proc far		; CODE XREF: UncompressRelated+77P
					; UncompressFileR+EEP ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		std
		mov	bx, [bp+arg_4]
		mov	ax, [bp+arg_0]
		add	ax, bx
		mov	ds, ax
		mov	ax, [bp+arg_2]
		add	ax, bx
		mov	es, ax
		assume es:nothing

loc_1EA2_27CD:				; CODE XREF: sub_1EA2_27B5+4Bj
		or	bx, bx
		jz	short loc_1EA2_2802
		mov	cx, 1000h
		sub	bx, 1000h
		jnb	short loc_1EA2_27E2
		add	bx, 1000h
		mov	cx, bx
		xor	bx, bx

loc_1EA2_27E2:				; CODE XREF: sub_1EA2_27B5+23j
		mov	ax, ds
		sub	ax, cx
		mov	ds, ax
		mov	ax, es
		sub	ax, cx
		mov	es, ax
		shl	cx, 1
		shl	cx, 1
		shl	cx, 1
		mov	ax, cx
		shl	ax, 1
		dec	ax
		dec	ax
		mov	si, ax
		mov	di, ax
		rep movsw
		jmp	short loc_1EA2_27CD
; ---------------------------------------------------------------------------

loc_1EA2_2802:				; CODE XREF: sub_1EA2_27B5+1Aj
		cld
		pop	di
		pop	si
		pop	ds
		pop	bp
		retf
sub_1EA2_27B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LastColonSlash	proc far		; CODE XREF: AllocResPages+21P
					; GetResSomething+CP ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		mov	si, [bp+arg_0]
		mov	bx, si
		cld

loc_1EA2_2812:				; CODE XREF: LastColonSlash+15j
					; LastColonSlash+19j
		lodsb
		or	al, al
		jz	short loc_1EA2_2823
		cmp	al, ':'
		jz	short loc_1EA2_281F
		cmp	al, '\'
		jnz	short loc_1EA2_2812

loc_1EA2_281F:				; CODE XREF: LastColonSlash+11j
		mov	bx, si
		jmp	short loc_1EA2_2812
; ---------------------------------------------------------------------------

loc_1EA2_2823:				; CODE XREF: LastColonSlash+Dj
		mov	ax, bx
		pop	si
		pop	bp
		retf
LastColonSlash	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AllocResPages	proc far		; CODE XREF: LoadRes0_1Type+3EP
					; UncompressFileR+41P ...

p_pcResName	= word ptr  6
p_wResSizePages	= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	di, g_ppcFirstRes2
		mov	si, g_ppcLastRes1
		mov	dx, [di+Resource.dwOffset]
		add	dx, [di+Resource.dwSize]
		add	di, 12h
		cmp	si, di
		jbe	short loc_1EA2_2887

loc_1EA2_2842:				; CODE XREF: AllocResPages+6Cj
		mov	g_ppcFirstRes2,	di
		push	[bp+p_pcResName]
		call	LastColonSlash
		add	sp, 2
		mov	si, ax
		xor	bx, bx
		mov	cx, 0Ch

loc_1EA2_2858:				; CODE XREF: AllocResPages+35j
		mov	al, [bx+si+Resource.pcName]
		mov	[bx+di+Resource.pcName], al ; re-write 0xc name	bytes
		inc	bx
		loop	loc_1EA2_2858
		mov	si, g_ppcLastRes1
		mov	ax, [bp+p_wResSizePages]
		mov	[di+Resource.dwOffset],	dx
		mov	[di+Resource.dwSize], ax
		mov	[di+Resource.field_10],	2
		add	ax, dx
		cmp	ax, g_wMaxResSize
		jb	short loc_1EA2_287C
		mov	g_wMaxResSize, ax

loc_1EA2_287C:				; CODE XREF: AllocResPages+4Fj
		cmp	ax, [si+Resource.dwOffset]
		ja	short loc_1EA2_28A2

loc_1EA2_2881:				; CODE XREF: AllocResPages+8Bj
		xor	ax, ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2887:				; CODE XREF: AllocResPages+18j
		cmp	si, g_ppcLastRes2
		jz	short loc_1EA2_2896
		add	si, 12h
		mov	g_ppcLastRes1, si
		jmp	short loc_1EA2_2842
; ---------------------------------------------------------------------------

loc_1EA2_2896:				; CODE XREF: AllocResPages+63j
		push	[bp+p_pcResName]
		mov	ax, offset aReservememoryO ; "reservememory - OUT OF MEMORY SLOTS RES"...
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_28A2:				; CODE XREF: AllocResPages+57j
		mov	si, g_ppcLastRes1
		mov	di, g_ppcFirstRes2
		mov	ax, [di+Resource.dwOffset]
		add	ax, [di+Resource.dwSize]

loc_1EA2_28B0:				; CODE XREF: AllocResPages+9Fj
		cmp	ax, [si+Resource.dwOffset]
		jbe	short loc_1EA2_2881
		cmp	si, g_ppcLastRes2
		jz	short loc_1EA2_28C9
		mov	[si+Resource.field_10],	0
		add	si, 12h
		mov	g_ppcLastRes1, si
		jmp	short loc_1EA2_28B0
; ---------------------------------------------------------------------------

loc_1EA2_28C9:				; CODE XREF: AllocResPages+91j
		mov	bx, g_wMaxResSize
		push	bx
		push	[di+Resource.dwSize]
		push	[bp+p_pcResName]
		mov	ax, offset aReservememor_0 ; "reservememory - OUT OF MEMORY RESERVING"...
		push	ax
		call	far ptr	ErrorMessage
AllocResPages	endp


; =============== S U B	R O U T	I N E =======================================


FindFreeResource proc far		; CODE XREF: GetResSomething:loc_1EA2_29FFP
		push	si
		push	di
		push	dx
		mov	si, g_ppcLastRes2
		mov	di, si
		xor	dx, dx

loc_1EA2_28E8:				; CODE XREF: FindFreeResource+26j
		test	[si+Resource.field_10],	1
		jnz	short loc_1EA2_28F5
		add	dx, [si+Resource.dwSize]
		jmp	short loc_1EA2_28FC
; ---------------------------------------------------------------------------
		nop

loc_1EA2_28F5:				; CODE XREF: FindFreeResource+10j
		or	dx, dx
		jnz	short loc_1EA2_2910

loc_1EA2_28F9:				; CODE XREF: FindFreeResource+6Bj
		sub	di, 12h

loc_1EA2_28FC:				; CODE XREF: FindFreeResource+15j
		sub	si, 12h
		cmp	si, g_ppcLastRes1
		jnb	short loc_1EA2_28E8
		add	di, 12h
		mov	g_ppcLastRes1, di
		pop	dx
		pop	di
		pop	si
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2910:				; CODE XREF: FindFreeResource+1Aj
		mov	bx, [si+Resource.dwSize]
		push	bx
		add	di, 12h
		mov	ax, [di+Resource.dwOffset]
		sub	ax, bx
		push	ax
		push	[si+Resource.dwOffset]
		sub	di, 12h
		mov	[di+Resource.dwSize], bx
		mov	[di+Resource.dwOffset],	ax
		mov	cx, [si+Resource.field_10]
		mov	[si+Resource.field_10],	0
		mov	[di+Resource.field_10],	cx
		xor	bx, bx
		mov	cx, 0Ch

loc_1EA2_2939:				; CODE XREF: FindFreeResource+61j
		mov	al, [bx+si+Resource.pcName]
		mov	[bx+di+Resource.pcName], al
		inc	bx
		loop	loc_1EA2_2939
		call	sub_1EA2_27B5
		add	sp, 6
		jmp	short loc_1EA2_28F9
FindFreeResource endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetResSomething	proc far		; CODE XREF: LoadRes0_1Type+1CP
					; UncompressFileR+10P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	si, g_ppcLastRes1
		push	[bp+arg_0]
		call	LastColonSlash
		add	sp, 2
		mov	di, ax

loc_1EA2_2960:				; CODE XREF: GetResSomething+42j
		xor	bx, bx
		cmp	word ptr [si+10h], 0
		jz	short loc_1EA2_298E

loc_1EA2_2968:				; CODE XREF: GetResSomething+2Cj
		mov	al, [bx+di]
		or	al, al
		jz	short loc_1EA2_297B
		cmp	al, [bx+si]
		jnz	short loc_1EA2_2985
		inc	bx
		cmp	bx, 0Ch
		jl	short loc_1EA2_2968
		jmp	short loc_1EA2_2996
; ---------------------------------------------------------------------------
		nop

loc_1EA2_297B:				; CODE XREF: GetResSomething+22j
		cmp	byte ptr [bx+si], 2Eh ;	'.'
		jz	short loc_1EA2_2996
		cmp	byte ptr [bx+si], 0
		jz	short loc_1EA2_2996

loc_1EA2_2985:				; CODE XREF: GetResSomething+26j
		add	si, 12h
		cmp	si, g_ppcLastRes2
		jb	short loc_1EA2_2960

loc_1EA2_298E:				; CODE XREF: GetResSomething+1Cj
		xor	dx, dx

loc_1EA2_2990:				; CODE XREF: GetResSomething+BDj
		xor	ax, ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2996:				; CODE XREF: GetResSomething+2Ej
					; GetResSomething+34j ...
		mov	di, g_ppcFirstRes2
		mov	dx, [di+0Eh]
		add	dx, [di+0Ch]
		add	di, 12h
		mov	g_ppcFirstRes2,	di
		mov	ax, [si+0Ch]
		push	ax
		push	dx
		push	word ptr [si+0Eh]
		mov	word ptr [si+10h], 0
		mov	[di+0Eh], dx
		mov	[di+0Ch], ax
		mov	word ptr [di+10h], 2
		xor	bx, bx
		mov	cx, 0Ch

loc_1EA2_29C4:				; CODE XREF: GetResSomething+7Fj
		mov	al, [bx+si]
		mov	[bx+di], al
		inc	bx
		loop	loc_1EA2_29C4
		cmp	di, g_ppcLastRes1
		jnz	short loc_1EA2_29D6
		add	g_ppcLastRes1, 12h

loc_1EA2_29D6:				; CODE XREF: GetResSomething+85j
		call	sub_1EA2_276D
		add	sp, 6
		mov	si, g_ppcLastRes1
		mov	di, g_ppcFirstRes2
		mov	ax, [di+0Eh]
		add	ax, [di+0Ch]

loc_1EA2_29EC:				; CODE XREF: GetResSomething+B3j
		cmp	ax, [si+0Eh]
		jbe	short loc_1EA2_29FF
		mov	word ptr [si+10h], 0
		add	si, 12h
		mov	g_ppcLastRes1, si
		jmp	short loc_1EA2_29EC
; ---------------------------------------------------------------------------

loc_1EA2_29FF:				; CODE XREF: GetResSomething+A5j
		call	FindFreeResource
		mov	dx, [di+0Eh]
		jmp	short loc_1EA2_2990
GetResSomething	endp

; [00000053 BYTES: COLLAPSED FUNCTION nopsub_1EA2_2A09.	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

UnloadResource	proc far		; CODE XREF: RunIntroInLoop+6BP
					; RunIntroInLoop+ECP ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
p_dwResOffset	= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+p_dwResOffset]
		mov	si, g_ppcFirstRes2

loc_1EA2_2A68:				; CODE XREF: UnloadResource+1Aj
		cmp	si, g_ppcFirstRes1
		jz	short _lblBlockNotFound
		cmp	ax, [si+Resource.dwOffset]
		jz	short loc_1EA2_2A84
		sub	si, 12h
		jmp	short loc_1EA2_2A68
; ---------------------------------------------------------------------------

_lblBlockNotFound:			; CODE XREF: UnloadResource+10j
					; UnloadResource:loc_1EA2_2B24j ...
		push	[bp+p_dwResOffset]
		mov	ax, offset aMemoryManagerB ; "memory manager - BLOCK NOT FOUND at SEG"...
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_2A84:				; CODE XREF: UnloadResource+15j
		mov	[bp+p_dwResOffset], 0
		mov	[si+Resource.field_10],	0
		cmp	si, g_ppcFirstRes2
		jz	short loc_1EA2_2AAE
		mov	bx, g_ppcFirstRes2
		mov	di, g_ppcLastRes1
		cmp	si, di
		jz	short loc_1EA2_2AE8
		mov	ax, [di+Resource.dwOffset]
		sub	ax, [bx+Resource.dwOffset]
		sub	ax, [bx+Resource.dwSize]
		cmp	ax, [si+Resource.dwSize]
		jb	short loc_1EA2_2AE8

loc_1EA2_2AAE:				; CODE XREF: UnloadResource+36j
		mov	bx, [si+Resource.dwSize]
		push	bx
		mov	di, g_ppcLastRes1
		mov	ax, [di+Resource.dwOffset]
		sub	ax, bx
		push	ax
		mov	[bp+p_dwResOffset], ax
		push	[si+Resource.dwOffset]
		sub	di, 12h
		mov	g_ppcLastRes1, di
		mov	[di+Resource.dwOffset],	ax
		mov	[di+Resource.dwSize], bx
		mov	[di+Resource.field_10],	1
		mov	cx, 0Ch
		xor	bx, bx

loc_1EA2_2AD9:				; CODE XREF: UnloadResource+82j
		mov	al, [bx+si]
		mov	[bx+di], al
		inc	bx
		loop	loc_1EA2_2AD9
		call	sub_1EA2_27B5
		add	sp, 6

loc_1EA2_2AE8:				; CODE XREF: UnloadResource+42j
					; UnloadResource+50j
		cmp	si, g_ppcFirstRes2
		jnz	short loc_1EA2_2AFB

loc_1EA2_2AEE:				; CODE XREF: UnloadResource+99j
		sub	si, 12h
		cmp	[si+Resource.field_10],	0
		jz	short loc_1EA2_2AEE
		mov	g_ppcFirstRes2,	si

loc_1EA2_2AFB:				; CODE XREF: UnloadResource+90j
		mov	ax, [bp+arg_0]
		mov	dx, [bp+p_dwResOffset]
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		push	di
		mov	ax, [bp+p_dwResOffset]
		mov	si, g_ppcFirstRes2

loc_1EA2_2B14:				; CODE XREF: UnloadResource+C6j
		cmp	si, g_ppcFirstRes1
		jz	short loc_1EA2_2B24
		cmp	ax, [si+Resource.dwOffset]
		jz	short loc_1EA2_2B27
		sub	si, 12h
		jmp	short loc_1EA2_2B14
; ---------------------------------------------------------------------------

loc_1EA2_2B24:				; CODE XREF: UnloadResource+BCj
		jmp	_lblBlockNotFound
; ---------------------------------------------------------------------------

loc_1EA2_2B27:				; CODE XREF: UnloadResource+C1j
		mov	[bp+p_dwResOffset], 0
		mov	[si+Resource.field_10],	0
		cmp	si, g_ppcFirstRes2
		jz	short loc_1EA2_2B50
		mov	bx, g_ppcFirstRes2
		mov	di, g_ppcLastRes2
		mov	ax, [di+Resource.dwOffset]
		sub	ax, [bx+Resource.dwOffset]
		sub	ax, [bx+Resource.dwSize]
		cmp	ax, [si+Resource.dwSize]
		ja	short loc_1EA2_2B50
		jmp	loc_1EA2_2C02
; ---------------------------------------------------------------------------

loc_1EA2_2B50:				; CODE XREF: UnloadResource+D9j
					; UnloadResource+EFj
		mov	di, g_ppcFirstRes2
		mov	ax, [di+Resource.dwOffset]
		add	ax, [di+Resource.dwSize]
		mov	[bp+var_2], ax
		mov	[bp+var_4], 0
		mov	di, g_ppcLastRes1

loc_1EA2_2B66:				; CODE XREF: UnloadResource+16Bj
		cmp	di, g_ppcLastRes2
		jz	short loc_1EA2_2BC9
		mov	ax, [di+Resource.dwOffset]
		sub	ax, [si+Resource.dwSize]
		cmp	[bp+var_2], ax
		ja	short loc_1EA2_2BC4
		mov	bx, di
		sub	bx, 12h
		cmp	bx, g_ppcFirstRes2
		jz	short loc_1EA2_2BC4
		cmp	[bp+var_4], 0
		jnz	short loc_1EA2_2B91
		mov	g_ppcLastRes1, bx
		mov	[bp+var_4], 1

loc_1EA2_2B91:				; CODE XREF: UnloadResource+12Aj
		mov	ax, [di+Resource.field_10]
		mov	[bx+Resource.field_10],	ax
		mov	ax, [di+Resource.dwSize]
		mov	[bx+Resource.dwSize], ax
		push	ax
		mov	ax, [di+Resource.dwOffset]
		sub	ax, [si+Resource.dwSize]
		mov	[bx+Resource.dwOffset],	ax
		push	ax
		push	[di+Resource.dwOffset]
		mov	cx, 0Ch

loc_1EA2_2BAE:				; CODE XREF: UnloadResource+158j
		mov	al, [di]
		mov	[bx], al
		inc	bx
		inc	di
		loop	loc_1EA2_2BAE
		sub	di, 0Ch
		sub	bx, 0Ch
		call	sub_1EA2_276D
		add	sp, 6

loc_1EA2_2BC4:				; CODE XREF: UnloadResource+119j
					; UnloadResource+124j
		add	di, 12h
		jmp	short loc_1EA2_2B66
; ---------------------------------------------------------------------------

loc_1EA2_2BC9:				; CODE XREF: UnloadResource+10Ej
		mov	ax, [di+Resource.dwOffset]
		sub	di, 12h
		cmp	[bp+var_4], 0
		jnz	short loc_1EA2_2BD9
		mov	g_ppcLastRes1, di

loc_1EA2_2BD9:				; CODE XREF: UnloadResource+177j
		mov	bx, [si+Resource.dwSize]
		mov	[di+Resource.dwSize], bx
		push	bx
		sub	ax, bx
		mov	[di+Resource.dwOffset],	ax
		push	ax
		push	[si+Resource.dwOffset]
		mov	[di+Resource.field_10],	1
		mov	cx, 0Ch
		xor	bx, bx

loc_1EA2_2BF3:				; CODE XREF: UnloadResource+19Cj
		mov	al, [bx+si]
		mov	[bx+di], al
		inc	bx
		loop	loc_1EA2_2BF3
		call	sub_1EA2_27B5
		add	sp, 6

loc_1EA2_2C02:				; CODE XREF: UnloadResource+F1j
		cmp	si, g_ppcFirstRes2
		jnz	short loc_1EA2_2C15

loc_1EA2_2C08:				; CODE XREF: UnloadResource+1B3j
		sub	si, 12h
		cmp	[si+Resource.field_10],	0
		jz	short loc_1EA2_2C08
		mov	g_ppcFirstRes2,	si

loc_1EA2_2C15:				; CODE XREF: UnloadResource+1AAj
		mov	ax, [bp+arg_0]
		mov	dx, [bp+p_dwResOffset]
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
UnloadResource	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetResField10To0 proc far		; CODE XREF: _main+524P
					; EndOfGameScores+834P	...

p_dwOffset	= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+p_dwOffset]
		mov	si, g_ppcFirstRes2

loc_1EA2_2C2D:				; CODE XREF: SetResField10To0+1Aj
		cmp	si, g_ppcFirstRes1
		jz	short loc_1EA2_2C3D
		cmp	ax, [si+Resource.dwOffset]
		jz	short loc_1EA2_2C40
		sub	si, 12h
		jmp	short loc_1EA2_2C2D
; ---------------------------------------------------------------------------

loc_1EA2_2C3D:				; CODE XREF: SetResField10To0+10j
		jmp	_lblBlockNotFound ; "block not found" error
; ---------------------------------------------------------------------------

loc_1EA2_2C40:				; CODE XREF: SetResField10To0+15j
		mov	[si+Resource.field_10],	0
		cmp	si, g_ppcFirstRes2
		jnz	short loc_1EA2_2C58

loc_1EA2_2C4B:				; CODE XREF: SetResField10To0+31j
		sub	si, 12h
		cmp	[si+Resource.field_10],	0
		jz	short loc_1EA2_2C4B
		mov	g_ppcFirstRes2,	si

loc_1EA2_2C58:				; CODE XREF: SetResField10To0+28j
		pop	di
		pop	si
		pop	bp
		retf
SetResField10To0 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetResourceSize	proc far		; CODE XREF: ResourceSizeCha+9P
					; Load2DShapeRes+52P

arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+arg_2]
		mov	si, g_ppcFirstRes2

loc_1EA2_2C68:				; CODE XREF: GetResourceSize+1Aj
		cmp	si, g_ppcFirstRes1
		jz	short loc_1EA2_2C78
		cmp	ax, [si+Resource.dwOffset]
		jz	short loc_1EA2_2C7B
		sub	si, 12h
		jmp	short loc_1EA2_2C68
; ---------------------------------------------------------------------------

loc_1EA2_2C78:				; CODE XREF: GetResourceSize+10j
		jmp	_lblBlockNotFound
; ---------------------------------------------------------------------------

loc_1EA2_2C7B:				; CODE XREF: GetResourceSize+15j
		mov	ax, [si+Resource.dwSize]
		pop	di
		pop	si
		pop	bp
		retf
GetResourceSize	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ResizeMemory	proc far		; CODE XREF: UncompressFileR+135P
					; Maybe2dShParse+2E1P

arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+arg_2]
		mov	si, g_ppcFirstRes2

loc_1EA2_2C8E:				; CODE XREF: ResizeMemory+1Aj
		cmp	si, g_ppcFirstRes1
		jz	short loc_1EA2_2C9E
		cmp	ax, [si+Resource.dwOffset]
		jz	short loc_1EA2_2CA1
		sub	si, 12h
		jmp	short loc_1EA2_2C8E
; ---------------------------------------------------------------------------

loc_1EA2_2C9E:				; CODE XREF: ResizeMemory+10j
		jmp	_lblBlockNotFound
; ---------------------------------------------------------------------------

loc_1EA2_2CA1:				; CODE XREF: ResizeMemory+15j
		mov	ax, [bp+arg_4]
		cmp	ax, [si+Resource.dwSize]
		ja	short loc_1EA2_2CB0
		mov	[si+Resource.dwSize], ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2CB0:				; CODE XREF: ResizeMemory+25j
		cmp	si, g_ppcFirstRes2
		jnz	short loc_1EA2_2CD4
		mov	[si+Resource.dwSize], ax
		mov	di, g_ppcLastRes1
		add	ax, [si+Resource.dwOffset]
		cmp	ax, g_wMaxResSize
		jb	short loc_1EA2_2CC9
		mov	g_wMaxResSize, ax

loc_1EA2_2CC9:				; CODE XREF: ResizeMemory+42j
		cmp	ax, [di+Resource.dwOffset]
		ja	short loc_1EA2_2CDD

loc_1EA2_2CCE:				; CODE XREF: ResizeMemory+6Cj
		xor	ax, ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2CD4:				; CODE XREF: ResizeMemory+32j
		mov	ax, offset aResizememoryCa ; "resizememory - CANNOT EXPAND BLOCK NOT "...
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_2CDD:				; CODE XREF: ResizeMemory+4Aj
		mov	si, g_ppcLastRes1
		mov	di, g_ppcFirstRes2
		mov	ax, [di+Resource.dwOffset]
		add	ax, [di+Resource.dwSize]

loc_1EA2_2CEB:				; CODE XREF: ResizeMemory+80j
		cmp	ax, [si+Resource.dwOffset]
		jbe	short loc_1EA2_2CCE
		cmp	si, g_ppcLastRes2
		jz	short loc_1EA2_2D04
		mov	[si+Resource.field_10],	0
		add	si, 12h
		mov	g_ppcLastRes1, si
		jmp	short loc_1EA2_2CEB
; ---------------------------------------------------------------------------

loc_1EA2_2D04:				; CODE XREF: ResizeMemory+72j
		mov	bx, g_wMaxResSize
		push	bx
		mov	ax, offset aResizememoryNo ; "resizememory - NO	MEMORY LEFT TO EXPAND"...
		push	ax
		call	far ptr	ErrorMessage
ResizeMemory	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ResourceOp	proc far		; CODE XREF: Load2DShape+293P
					; Load2DShapeRes+92P

arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+arg_2]
		mov	si, g_ppcFirstRes2

loc_1EA2_2D1E:				; CODE XREF: ResourceOp+1Aj
		cmp	si, g_ppcFirstRes1
		jz	short loc_1EA2_2D2E
		cmp	ax, [si+Resource.dwOffset]
		jz	short loc_1EA2_2D31
		sub	si, 12h
		jmp	short loc_1EA2_2D1E
; ---------------------------------------------------------------------------

loc_1EA2_2D2E:				; CODE XREF: ResourceOp+10j
		jmp	_lblBlockNotFound
; ---------------------------------------------------------------------------

loc_1EA2_2D31:				; CODE XREF: ResourceOp+15j
		mov	di, si
		sub	di, 12h
		cmp	[di+Resource.field_10],	0
		jnz	short loc_1EA2_2D8D

loc_1EA2_2D3C:				; CODE XREF: ResourceOp+31j
		sub	di, 12h
		cmp	[di+Resource.field_10],	0
		jz	short loc_1EA2_2D3C
		mov	[si+Resource.field_10],	0
		mov	bx, [si+Resource.dwSize]
		push	bx
		mov	ax, [di+Resource.dwOffset]
		add	ax, [di+Resource.dwSize]
		push	ax
		push	[si+Resource.dwOffset]
		add	di, 12h
		cmp	si, g_ppcFirstRes2
		jnz	short loc_1EA2_2D65
		mov	g_ppcFirstRes2,	di

loc_1EA2_2D65:				; CODE XREF: ResourceOp+4Dj
		mov	[di+Resource.dwOffset],	ax
		mov	[di+Resource.dwSize], bx
		mov	[di+Resource.field_10],	2
		mov	cx, 0Ch
		xor	bx, bx

loc_1EA2_2D75:				; CODE XREF: ResourceOp+68j
		mov	al, [bx+si]
		mov	[bx+di], al
		inc	bx
		loop	loc_1EA2_2D75
		call	sub_1EA2_276D
		add	sp, 6

loc_1EA2_2D84:				; CODE XREF: ResourceOp+7Dj
		mov	dx, [di+Resource.dwOffset]
		xor	ax, ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2D8D:				; CODE XREF: ResourceOp+28j
		mov	di, si
		jmp	short loc_1EA2_2D84
ResourceOp	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoDeriveSpriteOp3 proc near		; CODE XREF: sub_14D6_1296+84P

var_A		= byte ptr -0Ah

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	[bp+var_A], 1
		jmp	short loc_1EA2_2DAE
DoDeriveSpriteOp3 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DeriveSpriteOp3	proc far		; CODE XREF: sub_26BB_E+21P
					; sub_26C7_E+17BP ...

var_A		= byte ptr -0Ah
arg_6		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	[bp+var_A], 0

loc_1EA2_2DAE:				; CODE XREF: DoDeriveSpriteOp3+Dj
		mov	ax, offset SpriteOp3
		mov	g_wSpriteFuncOf, ax
		mov	ax, offset ImageResetRende
		mov	g_wImageFuncOfs, ax
		mov	si, [bp+arg_6]
		jmp	short loc_1EA2_2DEA
DeriveSpriteOp3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoSpriteOp7	proc far		; CODE XREF: SkyBoxOp+4B0P
					; SkyBoxOp+4D8P

var_A		= byte ptr -0Ah

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	[bp+var_A], 1
		jmp	short loc_1EA2_2DDB
DoSpriteOp7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp7	proc far		; CODE XREF: sub_26C7_E+4DP
					; sub_26C7_E+8BP

var_7D0		= byte ptr -7D0h
var_798		= byte ptr -798h
var_3D8		= byte ptr -3D8h
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_wColor	= word ptr  6
arg_2		= word ptr  8
arg_4		= byte ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	[bp+var_A], 0

loc_1EA2_2DDB:				; CODE XREF: DoSpriteOp7+Dj
		mov	ax, offset SpriteOp3
		mov	g_wSpriteFuncOf, ax
		mov	ax, offset ImageResetRende
		mov	g_wImageFuncOfs, ax
		lea	si, [bp+arg_4]

loc_1EA2_2DEA:				; CODE XREF: DeriveSpriteOpReset+47j
					; DeriveSpriteOp3+1Cj ...
		mov	[bp+var_6], si
		mov	cx, [bp+arg_2]
		mov	ax, cx
		dec	ax
		shl	ax, 1
		shl	ax, 1
		add	ax, si
		mov	[bp+var_8], ax
		cld
		mov	ax, ss
		mov	es, ax
		lea	ax, [bp+var_798]
		mov	[bp+var_18], ax
		mov	ax, cs:g_pSprite1.dwLeft2
		mov	[bp+var_2], ax
		mov	ax, cs:g_pSprite1.dwWidthSum
		dec	ax
		mov	[bp+var_4], ax
		mov	ax, [si+2]
		mov	[bp+var_E], ax
		mov	[bp+var_12], ax
		mov	bx, [si]
		mov	dx, bx
		mov	[bp+var_10], si
		mov	[bp+var_14], si
		add	si, 4
		dec	cx
		jnz	short loc_1EA2_2E4D
		push	[bp+p_wColor]
		mov	si, [bp+var_6]
		push	word ptr [si+2]
		push	word ptr [si]
		push	word ptr [si+2]
		push	word ptr [si]
		call	dword ptr g_wImageFuncOfs ; usually calls ImageResetRende
		add	sp, 0Ah
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2E4D:				; CODE XREF: SpriteOp7+60j
					; SpriteOp7+A9j
		mov	ax, [si+2]
		cmp	ax, [bp+var_E]
		jg	short loc_1EA2_2E5B
		mov	[bp+var_E], ax
		mov	[bp+var_10], si

loc_1EA2_2E5B:				; CODE XREF: SpriteOp7+85j
		cmp	ax, [bp+var_12]
		jle	short loc_1EA2_2E66
		mov	[bp+var_12], ax
		mov	[bp+var_14], si

loc_1EA2_2E66:				; CODE XREF: SpriteOp7+90j
		mov	ax, [si]
		cmp	ax, bx
		jge	short loc_1EA2_2E6E
		mov	bx, ax

loc_1EA2_2E6E:				; CODE XREF: SpriteOp7+9Cj
		cmp	ax, dx
		jle	short loc_1EA2_2E74
		mov	dx, ax

loc_1EA2_2E74:				; CODE XREF: SpriteOp7+A2j
		add	si, 4
		loop	loc_1EA2_2E4D
		cmp	dx, [bp+var_2]
		jl	short loc_1EA2_2ED0
		cmp	bx, [bp+var_4]
		jge	short loc_1EA2_2ED0
		mov	ax, [bp+var_12]
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_2ED0
		mov	cx, [bp+var_E]
		cmp	cx, cs:g_pSprite1.dwHeight
		jge	short loc_1EA2_2ED0
		mov	[bp+var_C], 0

loc_1EA2_2E9B:
		cmp	dx, [bp+var_4]
		jg	short loc_1EA2_2EB3
		cmp	bx, [bp+var_2]
		jl	short loc_1EA2_2EB3
		cmp	ax, cs:g_pSprite1.dwHeight
		jge	short loc_1EA2_2EB3
		cmp	cx, cs:g_pSprite1.dwTop
		jge	short loc_1EA2_2EB7

loc_1EA2_2EB3:				; CODE XREF: SpriteOp7+D0j
					; SpriteOp7+D5j ...
		mov	[bp+var_C], 1

loc_1EA2_2EB7:				; CODE XREF: SpriteOp7+E3j
		cmp	ax, cx
		jz	short loc_1EA2_2EBF
		cmp	dx, bx
		jnz	short loc_1EA2_2ED6

loc_1EA2_2EBF:				; CODE XREF: SpriteOp7+EBj
		push	[bp+p_wColor]
		mov	si, [bp+var_6]
		push	ax
		push	dx
		push	cx
		push	bx
		call	dword ptr g_wImageFuncOfs
		add	sp, 0Ah

loc_1EA2_2ED0:				; CODE XREF: SpriteOp7+AEj
					; SpriteOp7+B3j ...
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2ED6:				; CODE XREF: SpriteOp7+EFj
		lea	si, [bp+var_7D0]
		mov	di, [bp+var_10]

loc_1EA2_2EDD:				; CODE XREF: SpriteOp7+154j
		mov	ax, [di+2]
		mov	cx, [di]
		add	di, 4
		cmp	di, [bp+var_8]
		jbe	short loc_1EA2_2EED
		mov	di, [bp+var_6]

loc_1EA2_2EED:				; CODE XREF: SpriteOp7+11Aj
		mov	dx, [di+2]
		cmp	dx, ax
		jle	short loc_1EA2_2F1F
		push	si
		push	dx
		push	word ptr [di]
		push	ax
		push	cx
		cmp	[bp+var_C], 0
		jz	short loc_1EA2_2F0E
		call	ResetImageData
		mov	[bp+var_16], di
		call	loc_1EA2_2FAD
		jmp	short loc_1EA2_2F19
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_2F0E:				; CODE XREF: SpriteOp7+130j
		call	DoResetImageData
		mov	[bp+var_16], di
		call	loc_1EA2_3047

loc_1EA2_2F19:				; CODE XREF: SpriteOp7+13Dj
		mov	di, [bp+var_16]
		add	sp, 0Ah

loc_1EA2_2F1F:				; CODE XREF: SpriteOp7+124j
		cmp	di, [bp+var_14]
		jnz	short loc_1EA2_2EDD
		mov	di, [bp+var_10]

loc_1EA2_2F27:				; CODE XREF: SpriteOp7+198j
		mov	ax, [di+2]
		mov	cx, [di]
		sub	di, 4
		cmp	di, [bp+var_6]
		jnb	short loc_1EA2_2F37
		mov	di, [bp+var_8]

loc_1EA2_2F37:				; CODE XREF: SpriteOp7+164j
		mov	dx, [di+2]
		cmp	dx, ax
		jle	short loc_1EA2_2F63
		push	si
		push	dx
		push	word ptr [di]
		push	ax
		push	cx
		cmp	[bp+var_C], 0
		jz	short loc_1EA2_2F52
		call	ResetImageData
		jmp	short loc_1EA2_2F57
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_2F52:				; CODE XREF: SpriteOp7+17Aj
		call	DoResetImageData

loc_1EA2_2F57:				; CODE XREF: SpriteOp7+181j
		mov	[bp+var_16], di
		call	sub_1EA2_313E
		mov	di, [bp+var_16]
		add	sp, 0Ah

loc_1EA2_2F63:				; CODE XREF: SpriteOp7+16Ej
		cmp	di, [bp+var_14]
		jnz	short loc_1EA2_2F27
		mov	ax, [bp+var_12]
		cmp	ax, cs:g_pSprite1.dwHeight
		jl	short loc_1EA2_2F77
		mov	ax, cs:g_pSprite1.dwHeight
		dec	ax

loc_1EA2_2F77:				; CODE XREF: SpriteOp7+1A2j
		mov	bx, [bp+var_E]
		cmp	bx, cs:g_pSprite1.dwTop
		jge	short loc_1EA2_2F86
		mov	bx, cs:g_pSprite1.dwTop

loc_1EA2_2F86:				; CODE XREF: SpriteOp7+1B1j
		sub	ax, bx
		jle	short loc_1EA2_2FA7
		inc	ax
		push	[bp+p_wColor]
		push	ax
		push	bx
		shl	bx, 1
		lea	ax, [bp+var_3D8]
		add	ax, bx
		push	ax
		lea	ax, [bp+var_798]
		add	ax, bx
		push	ax
		call	dword ptr g_wSpriteFuncOf
		add	sp, 0Ah

loc_1EA2_2FA7:				; CODE XREF: SpriteOp7+1BAj
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_2FAD:				; CODE XREF: SpriteOp7+13Ap
					; sub_1EA2_3519+197p
		mov	cx, [si+14h]
		or	cx, cx
		jle	short loc_1EA2_2FD9
		mov	di, [si+6]
		mov	dx, [si+4]
		add	dx, 8000h
		adc	di, 0
		sub	di, cx
		shl	di, 1
		add	di, [bp+var_18]
		mov	ax, cs:g_pSprite1.dwLeft2
		push	cx
		push	di
		rep stosw
		pop	di
		pop	cx
		add	di, 3C0h
		dec	ax
		rep stosw

loc_1EA2_2FD9:				; CODE XREF: SpriteOp7+1E4j
		mov	cx, [si+18h]
		or	cx, cx
		jle	short loc_1EA2_3005
		mov	di, [si+6]
		mov	dx, [si+4]
		add	dx, 8000h
		adc	di, 0
		sub	di, cx
		shl	di, 1
		add	di, [bp+var_18]
		mov	ax, cs:g_pSprite1.dwWidthSum
		push	cx
		push	di
		rep stosw
		pop	di
		pop	cx
		add	di, 3C0h
		dec	ax
		rep stosw

loc_1EA2_3005:				; CODE XREF: SpriteOp7+210j
		mov	cx, [si+16h]
		or	cx, cx
		jle	short loc_1EA2_3026
		mov	di, [si+0Ah]
		inc	di
		shl	di, 1
		add	di, [bp+var_18]
		mov	ax, cs:g_pSprite1.dwLeft2
		push	cx
		push	di
		rep stosw
		pop	di
		pop	cx
		add	di, 3C0h
		dec	ax
		rep stosw

loc_1EA2_3026:				; CODE XREF: SpriteOp7+23Cj
		mov	cx, [si+1Ah]
		or	cx, cx
		jle	short loc_1EA2_3047
		mov	di, [si+0Ah]
		inc	di
		shl	di, 1
		add	di, [bp+var_18]
		mov	ax, cs:g_pSprite1.dwWidthSum
		push	cx
		push	di
		rep stosw
		pop	di
		pop	cx
		add	di, 3C0h
		dec	ax
		rep stosw

loc_1EA2_3047:				; CODE XREF: SpriteOp7+148p
					; SpriteOp7+25Dj ...
		mov	cx, [si+0Eh]
		or	cx, cx
		jle	short locret_1EA2_3083
		mov	di, [si+6]
		shl	di, 1
		add	di, [bp+var_18]
		mov	bl, [si+12h]
		xor	bh, bh
		shl	bx, 1
		jmp	cs:off_1EA2_3062[bx]
; ---------------------------------------------------------------------------
off_1EA2_3062	dw offset locret_1EA2_3083 ; DATA XREF:	SpriteOp7+28Fr
		dw offset locret_1EA2_3083
		dw offset loc_1EA2_3076
		dw offset loc_1EA2_3084
		dw offset loc_1EA2_3093
		dw offset loc_1EA2_30A2
		dw offset loc_1EA2_30C1
		dw offset loc_1EA2_30E0
		dw offset loc_1EA2_310C
		dw offset locret_1EA2_3083
; ---------------------------------------------------------------------------

loc_1EA2_3076:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+298o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]

loc_1EA2_307C:				; CODE XREF: SpriteOp7+2B3j
		mov	[di+3C0h], ax
		stosw
		loop	loc_1EA2_307C

locret_1EA2_3083:			; CODE XREF: SpriteOp7+27Ej
					; SpriteOp7+28Fj ...
		retn
; ---------------------------------------------------------------------------

loc_1EA2_3084:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+29Ao
		mov	cx, [si+0Eh]
		mov	ax, [si+2]

loc_1EA2_308A:				; CODE XREF: SpriteOp7+2C2j
		mov	[di+3C0h], ax
		stosw
		dec	ax
		loop	loc_1EA2_308A
		retn
; ---------------------------------------------------------------------------

loc_1EA2_3093:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+29Co
		mov	cx, [si+0Eh]
		mov	ax, [si+2]

loc_1EA2_3099:				; CODE XREF: SpriteOp7+2D1j
		mov	[di+3C0h], ax
		stosw
		inc	ax
		loop	loc_1EA2_3099
		retn
; ---------------------------------------------------------------------------

loc_1EA2_30A2:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+29Eo
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	dx, [si]
		add	dx, 8000h
		adc	ax, 0
		mov	bx, [si+0Ch]

loc_1EA2_30B4:				; CODE XREF: SpriteOp7+2F0j
		mov	[di+3C0h], ax
		stosw
		sub	dx, bx
		sbb	ax, 0
		loop	loc_1EA2_30B4
		retn
; ---------------------------------------------------------------------------

loc_1EA2_30C1:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+2A0o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	dx, [si]
		add	dx, 8000h
		adc	ax, 0
		mov	bx, [si+0Ch]

loc_1EA2_30D3:				; CODE XREF: SpriteOp7+30Fj
		mov	[di+3C0h], ax
		stosw
		add	dx, bx
		adc	ax, 0
		loop	loc_1EA2_30D3
		retn
; ---------------------------------------------------------------------------

loc_1EA2_30E0:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+2A2o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	bx, [si+0Ch]
		mov	dx, [si+4]
		add	dx, 8000h
		jnb	short loc_1EA2_30F5
		add	di, 2

loc_1EA2_30F5:				; CODE XREF: SpriteOp7+322j
					; SpriteOp7+331j
		mov	[di+3C0h], ax

loc_1EA2_30F9:				; CODE XREF: SpriteOp7+338j
		add	dx, bx
		jnb	short loc_1EA2_3105
		stosw
		dec	ax
		loop	loc_1EA2_30F5
		sub	di, 2
		retn
; ---------------------------------------------------------------------------

loc_1EA2_3105:				; CODE XREF: SpriteOp7+32Dj
		dec	ax
		loop	loc_1EA2_30F9
		inc	ax
		mov	[di], ax
		retn
; ---------------------------------------------------------------------------

loc_1EA2_310C:				; CODE XREF: SpriteOp7+28Fj
					; DATA XREF: SpriteOp7+2A4o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	bx, [si+0Ch]
		mov	dx, [si+4]
		add	dx, 8000h
		jnb	short loc_1EA2_3121
		add	di, 2

loc_1EA2_3121:				; CODE XREF: SpriteOp7+34Ej
					; SpriteOp7+361j
		mov	[di], ax

loc_1EA2_3123:				; CODE XREF: SpriteOp7+368j
		add	dx, bx
		jnb	short loc_1EA2_3135
		mov	[di+3C0h], ax
		add	di, 2
		inc	ax
		loop	loc_1EA2_3121
		sub	di, 2
		retn
; ---------------------------------------------------------------------------

loc_1EA2_3135:				; CODE XREF: SpriteOp7+357j
		inc	ax
		loop	loc_1EA2_3123
		dec	ax
		mov	[di+3C0h], ax
		retn
SpriteOp7	endp


; =============== S U B	R O U T	I N E =======================================


sub_1EA2_313E	proc near		; CODE XREF: SpriteOp7+18Cp
					; sub_1EA2_3519+1D3p

arg_0		= word ptr  2
arg_2		= word ptr  4
arg_4		= word ptr  6
arg_A		= word ptr  0Ch
arg_C		= word ptr  0Eh
arg_10		= byte ptr  12h

		mov	cx, [si+arg_C]
		or	cx, cx
		jle	short loc_1EA2_3188
		mov	di, [si+arg_4]
		shl	di, 1
		add	di, [bp-18h]
		mov	bl, [si+arg_10]
		xor	bh, bh
		shl	bx, 1
		cmp	byte ptr [bp-0Ah], 0
		jnz	short loc_1EA2_315F
		jmp	cs:off_1EA2_32D7[bx]
; ---------------------------------------------------------------------------

loc_1EA2_315F:				; CODE XREF: sub_1EA2_313E+1Aj
		jmp	cs:off_1EA2_3164[bx]
; ---------------------------------------------------------------------------
off_1EA2_3164	dw offset locret_1EA2_3083 ; DATA XREF:	sub_1EA2_313E:loc_1EA2_315Fr
		dw offset locret_1EA2_3083
		dw offset loc_1EA2_3178
		dw offset loc_1EA2_3197
		dw offset loc_1EA2_31BB
		dw offset loc_1EA2_31DF
		dw offset loc_1EA2_3217
		dw offset loc_1EA2_324F
		dw offset loc_1EA2_3291
		dw offset locret_1EA2_3083
; ---------------------------------------------------------------------------

loc_1EA2_3178:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+2Ao
		mov	ax, [si+arg_0]

loc_1EA2_317B:				; CODE XREF: sub_1EA2_313E+48j
					; sub_1EA2_313E+54j
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_318B
		cmp	[di], ax
		jle	short loc_1EA2_318F
		stosw
		loop	loc_1EA2_317B

loc_1EA2_3188:				; CODE XREF: sub_1EA2_313E+5j
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_318B:				; CODE XREF: sub_1EA2_313E+41j
		mov	[di+3C0h], ax

loc_1EA2_318F:				; CODE XREF: sub_1EA2_313E+45j
		add	di, 2
		loop	loc_1EA2_317B
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3197:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+2Co
		mov	cx, [si+arg_C]
		mov	ax, [si+arg_0]

loc_1EA2_319D:				; CODE XREF: sub_1EA2_313E+6Bj
					; sub_1EA2_313E+78j
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_31AE
		cmp	[di], ax
		jle	short loc_1EA2_31B2
		stosw
		dec	ax
		loop	loc_1EA2_319D
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_31AE:				; CODE XREF: sub_1EA2_313E+63j
		mov	[di+3C0h], ax

loc_1EA2_31B2:				; CODE XREF: sub_1EA2_313E+67j
		add	di, 2
		dec	ax
		loop	loc_1EA2_319D
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_31BB:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+2Eo
		mov	cx, [si+arg_C]
		mov	ax, [si+arg_0]

loc_1EA2_31C1:				; CODE XREF: sub_1EA2_313E+8Fj
					; sub_1EA2_313E+9Cj
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_31D2
		cmp	[di], ax
		jle	short loc_1EA2_31D6
		stosw
		inc	ax
		loop	loc_1EA2_31C1
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_31D2:				; CODE XREF: sub_1EA2_313E+87j
		mov	[di+3C0h], ax

loc_1EA2_31D6:				; CODE XREF: sub_1EA2_313E+8Bj
		add	di, 2
		inc	ax
		loop	loc_1EA2_31C1
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_31DF:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+30o
		mov	cx, [si+arg_C]
		mov	ax, [si+arg_0]
		mov	dx, [si+0]
		add	dx, 8000h
		adc	ax, 0
		mov	bx, [si+arg_A]

loc_1EA2_31F1:				; CODE XREF: sub_1EA2_313E+C3j
					; sub_1EA2_313E+D4j
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_3206
		cmp	[di], ax
		jle	short loc_1EA2_320A
		stosw
		sub	dx, bx
		sbb	ax, 0
		loop	loc_1EA2_31F1
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3206:				; CODE XREF: sub_1EA2_313E+B7j
		mov	[di+3C0h], ax

loc_1EA2_320A:				; CODE XREF: sub_1EA2_313E+BBj
		add	di, 2
		sub	dx, bx
		sbb	ax, 0
		loop	loc_1EA2_31F1
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3217:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+32o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	dx, [si]
		add	dx, 8000h
		adc	ax, 0
		mov	bx, [si+0Ch]

loc_1EA2_3229:				; CODE XREF: sub_1EA2_313E+FBj
					; sub_1EA2_313E+10Cj
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_323E
		cmp	[di], ax
		jle	short loc_1EA2_3242
		stosw
		add	dx, bx
		adc	ax, 0
		loop	loc_1EA2_3229
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_323E:				; CODE XREF: sub_1EA2_313E+EFj
		mov	[di+3C0h], ax

loc_1EA2_3242:				; CODE XREF: sub_1EA2_313E+F3j
		add	di, 2
		add	dx, bx
		adc	ax, 0
		loop	loc_1EA2_3229
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_324F:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+34o
		mov	cx, [si+arg_C]
		mov	ax, [si+arg_0]
		mov	bx, [si+arg_A]
		mov	dx, [si+arg_2]
		add	dx, 8000h
		jnb	short loc_1EA2_3264
		add	di, 2

loc_1EA2_3264:				; CODE XREF: sub_1EA2_313E+121j
					; sub_1EA2_313E+13Ej
		cmp	[di+3C0h], ax
		jge	short loc_1EA2_326E
		mov	[di+3C0h], ax

loc_1EA2_326E:				; CODE XREF: sub_1EA2_313E+12Aj
					; sub_1EA2_313E+147j
		add	dx, bx
		jnb	short loc_1EA2_3284
		cmp	[di], ax
		jle	short loc_1EA2_3278
		mov	[di], ax

loc_1EA2_3278:				; CODE XREF: sub_1EA2_313E+136j
		add	di, 2
		dec	ax
		loop	loc_1EA2_3264
		sub	di, 2
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3284:				; CODE XREF: sub_1EA2_313E+132j
		dec	ax
		loop	loc_1EA2_326E
		inc	ax
		cmp	[di], ax
		jle	short loc_1EA2_328E
		mov	[di], ax

loc_1EA2_328E:				; CODE XREF: sub_1EA2_313E+14Cj
					; sub_1EA2_313E+190j
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3291:				; CODE XREF: sub_1EA2_313E:loc_1EA2_315Fj
					; DATA XREF: sub_1EA2_313E+36o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	bx, [si+0Ch]
		mov	dx, [si+4]
		add	dx, 8000h
		jnb	short loc_1EA2_32A6
		add	di, 2

loc_1EA2_32A6:				; CODE XREF: sub_1EA2_313E+163j
					; sub_1EA2_313E+180j
		cmp	[di], ax
		jle	short loc_1EA2_32AC
		mov	[di], ax

loc_1EA2_32AC:				; CODE XREF: sub_1EA2_313E+16Aj
					; sub_1EA2_313E+189j
		add	dx, bx
		jnb	short loc_1EA2_32C6
		cmp	[di+3C0h], ax
		jge	short loc_1EA2_32BA
		mov	[di+3C0h], ax

loc_1EA2_32BA:				; CODE XREF: sub_1EA2_313E+176j
		add	di, 2
		inc	ax
		loop	loc_1EA2_32A6
		sub	di, 2
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_32C6:				; CODE XREF: sub_1EA2_313E+170j
		inc	ax
		loop	loc_1EA2_32AC
		dec	ax
		cmp	[di+3C0h], ax
		jge	short loc_1EA2_328E
		mov	[di+3C0h], ax
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------
off_1EA2_32D7	dw offset locret_1EA2_3083 ; DATA XREF:	sub_1EA2_313E+1Cr
		dw offset locret_1EA2_3083
		dw offset loc_1EA2_32EB
		dw offset loc_1EA2_3311
		dw offset loc_1EA2_333C
		dw offset loc_1EA2_3367
		dw offset loc_1EA2_33AA
		dw offset loc_1EA2_33ED
		dw offset loc_1EA2_3441
		dw offset locret_1EA2_3083
; ---------------------------------------------------------------------------

loc_1EA2_32EB:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+19Do
		mov	cx, [si+0Eh]
		mov	ax, [si+2]

loc_1EA2_32F1:				; CODE XREF: sub_1EA2_313E+1C0j
		cmp	[di], ax
		jg	short loc_1EA2_3303
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_3308
		add	di, 2
		loop	loc_1EA2_32F1
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3303:				; CODE XREF: sub_1EA2_313E+1B5j
		rep stosw
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3308:				; CODE XREF: sub_1EA2_313E+1BBj
		add	di, 3C0h
		rep stosw
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3311:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+19Fo
		mov	cx, [si+0Eh]
		mov	ax, [si+2]

loc_1EA2_3317:				; CODE XREF: sub_1EA2_313E+1E7j
		cmp	[di], ax
		jg	short loc_1EA2_332A
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_3331
		add	di, 2
		dec	ax
		loop	loc_1EA2_3317
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_332A:				; CODE XREF: sub_1EA2_313E+1DBj
					; sub_1EA2_313E+1EEj
		stosw
		dec	ax
		loop	loc_1EA2_332A
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3331:				; CODE XREF: sub_1EA2_313E+1E1j
		add	di, 3C0h

loc_1EA2_3335:				; CODE XREF: sub_1EA2_313E+1F9j
		stosw
		dec	ax
		loop	loc_1EA2_3335
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_333C:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+1A1o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]

loc_1EA2_3342:				; CODE XREF: sub_1EA2_313E+212j
		cmp	[di], ax
		jg	short loc_1EA2_3355
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_335C
		add	di, 2
		inc	ax
		loop	loc_1EA2_3342
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3355:				; CODE XREF: sub_1EA2_313E+206j
					; sub_1EA2_313E+219j
		stosw
		inc	ax
		loop	loc_1EA2_3355
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_335C:				; CODE XREF: sub_1EA2_313E+20Cj
		add	di, 3C0h

loc_1EA2_3360:				; CODE XREF: sub_1EA2_313E+224j
		stosw
		inc	ax
		loop	loc_1EA2_3360
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3367:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+1A3o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	dx, [si]
		add	dx, 8000h
		adc	ax, 0
		mov	bx, [si+0Ch]

loc_1EA2_3379:				; CODE XREF: sub_1EA2_313E+24Dj
		cmp	[di], ax
		jg	short loc_1EA2_3390
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_339B
		add	di, 2
		sub	dx, bx
		sbb	ax, 0
		loop	loc_1EA2_3379
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3390:				; CODE XREF: sub_1EA2_313E+23Dj
					; sub_1EA2_313E+258j
		stosw
		sub	dx, bx
		sbb	ax, 0
		loop	loc_1EA2_3390
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_339B:				; CODE XREF: sub_1EA2_313E+243j
		add	di, 3C0h

loc_1EA2_339F:				; CODE XREF: sub_1EA2_313E+267j
		stosw
		sub	dx, bx
		sbb	ax, 0
		loop	loc_1EA2_339F
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_33AA:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+1A5o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	dx, [si]
		add	dx, 8000h
		adc	ax, 0
		mov	bx, [si+0Ch]

loc_1EA2_33BC:				; CODE XREF: sub_1EA2_313E+290j
		cmp	[di], ax
		jg	short loc_1EA2_33D3
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_33DE
		add	di, 2
		add	dx, bx
		adc	ax, 0
		loop	loc_1EA2_33BC
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_33D3:				; CODE XREF: sub_1EA2_313E+280j
					; sub_1EA2_313E+29Bj
		stosw
		add	dx, bx
		adc	ax, 0
		loop	loc_1EA2_33D3
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_33DE:				; CODE XREF: sub_1EA2_313E+286j
		add	di, 3C0h

loc_1EA2_33E2:				; CODE XREF: sub_1EA2_313E+2AAj
		stosw
		add	dx, bx
		adc	ax, 0
		loop	loc_1EA2_33E2
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_33ED:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+1A7o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	bx, [si+0Ch]
		mov	dx, [si+4]
		add	dx, 8000h
		jnb	short loc_1EA2_3402
		add	di, 2

loc_1EA2_3402:				; CODE XREF: sub_1EA2_313E+2BFj
					; sub_1EA2_313E+2D6j
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_3419
		add	dx, bx
		jnb	short loc_1EA2_3413
		cmp	[di], ax
		jg	short loc_1EA2_3431
		add	di, 2

loc_1EA2_3413:				; CODE XREF: sub_1EA2_313E+2CCj
		dec	ax
		loop	loc_1EA2_3402
		jmp	loc_1EA2_3499
; ---------------------------------------------------------------------------

loc_1EA2_3419:				; CODE XREF: sub_1EA2_313E+2C8j
		add	di, 3C0h

loc_1EA2_341D:				; CODE XREF: sub_1EA2_313E+2E5j
		stosw

loc_1EA2_341E:				; CODE XREF: sub_1EA2_313E:loc_1EA2_3428j
		dec	ax
		add	dx, bx
		jnb	short loc_1EA2_3428
		loop	loc_1EA2_341D
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_3428:				; CODE XREF: sub_1EA2_313E+2E3j
		loop	loc_1EA2_341E
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_342D:				; CODE XREF: sub_1EA2_313E+2F5j
					; sub_1EA2_313E+2FBj
		add	dx, bx
		jnb	short loc_1EA2_3438

loc_1EA2_3431:				; CODE XREF: sub_1EA2_313E+2D0j
		stosw
		dec	ax
		loop	loc_1EA2_342D
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_3438:				; CODE XREF: sub_1EA2_313E+2F1j
		dec	ax
		loop	loc_1EA2_342D
		inc	ax
		mov	[di], ax
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_3441:				; CODE XREF: sub_1EA2_313E+1Cj
					; DATA XREF: sub_1EA2_313E+1A9o
		mov	cx, [si+0Eh]
		mov	ax, [si+2]
		mov	bx, [si+0Ch]
		mov	dx, [si+4]
		add	dx, 8000h
		jnb	short loc_1EA2_3456
		add	di, 2

loc_1EA2_3456:				; CODE XREF: sub_1EA2_313E+313j
					; sub_1EA2_313E+32Aj
		cmp	[di], ax
		jg	short loc_1EA2_3492
		add	dx, bx
		jnb	short loc_1EA2_3467
		cmp	[di+3C0h], ax
		jl	short loc_1EA2_346D
		add	di, 2

loc_1EA2_3467:				; CODE XREF: sub_1EA2_313E+31Ej
		inc	ax
		loop	loc_1EA2_3456
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_346D:				; CODE XREF: sub_1EA2_313E+324j
		add	di, 3C0h

loc_1EA2_3471:				; CODE XREF: sub_1EA2_313E+33Dj
		mov	[di], ax

loc_1EA2_3473:				; CODE XREF: sub_1EA2_313E:loc_1EA2_3483j
		inc	ax
		add	dx, bx
		jnb	short loc_1EA2_3483
		add	di, 2
		loop	loc_1EA2_3471
		dec	ax
		mov	[di], ax
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_3483:				; CODE XREF: sub_1EA2_313E+338j
		loop	loc_1EA2_3473
		add	di, 2
		dec	ax
		mov	[di], ax
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_348E:				; CODE XREF: sub_1EA2_313E+356j
		add	dx, bx
		jnb	short loc_1EA2_3493

loc_1EA2_3492:				; CODE XREF: sub_1EA2_313E+31Aj
		stosw

loc_1EA2_3493:				; CODE XREF: sub_1EA2_313E+352j
		inc	ax
		loop	loc_1EA2_348E
		jmp	short loc_1EA2_3499
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_3499:				; CODE XREF: sub_1EA2_313E:loc_1EA2_3188j
					; sub_1EA2_313E+56j ...
		cmp	byte ptr [bp-0Ch], 0
		jnz	short loc_1EA2_34A0
		retn
; ---------------------------------------------------------------------------

loc_1EA2_34A0:				; CODE XREF: sub_1EA2_313E+35Fj
		mov	cx, [si+14h]
		or	cx, cx
		jle	short loc_1EA2_34C1
		mov	di, [si+6]
		mov	dx, [si+4]
		add	dx, 8000h
		adc	di, 0
		sub	di, cx
		shl	di, 1
		add	di, [bp-18h]
		mov	ax, cs:g_pSprite1.dwLeft2
		rep stosw

loc_1EA2_34C1:				; CODE XREF: sub_1EA2_313E+367j
		mov	cx, [si+18h]
		or	cx, cx
		jle	short loc_1EA2_34E7
		mov	di, [si+6]
		mov	dx, [si+4]
		add	dx, 8000h
		adc	di, 0
		sub	di, cx
		shl	di, 1
		add	di, [bp-18h]
		add	di, 3C0h
		mov	ax, cs:g_pSprite1.dwWidthSum
		dec	ax
		rep stosw

loc_1EA2_34E7:				; CODE XREF: sub_1EA2_313E+388j
		mov	cx, [si+16h]
		or	cx, cx
		jle	short loc_1EA2_34FD
		mov	di, [si+0Ah]
		inc	di
		shl	di, 1
		add	di, [bp-18h]
		mov	ax, cs:g_pSprite1.dwLeft2
		rep stosw

loc_1EA2_34FD:				; CODE XREF: sub_1EA2_313E+3AEj
		mov	cx, [si+1Ah]
		or	cx, cx
		jle	short locret_1EA2_3518
		mov	di, [si+0Ah]
		inc	di
		shl	di, 1
		add	di, [bp-18h]
		add	di, 3C0h
		mov	ax, cs:g_pSprite1.dwWidthSum
		dec	ax
		rep stosw

locret_1EA2_3518:			; CODE XREF: sub_1EA2_313E+3C4j
		retn
sub_1EA2_313E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3519	proc far

var_7D0		= word ptr -7D0h
var_798		= byte ptr -798h
var_3D8		= byte ptr -3D8h
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= byte ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	[bp+var_A], 1
		mov	ax, offset SpriteOp3
		mov	g_wSpriteFuncOf, ax
		mov	ax, offset SpriteOp5
		mov	g_wImageFuncOfs, ax
		jmp	short loc_1EA2_354E
; ---------------------------------------------------------------------------
		nop
		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	[bp+var_A], 0
		mov	ax, offset SpriteOp3
		mov	g_wSpriteFuncOf, ax
		mov	ax, offset SpriteOp5
		mov	g_wImageFuncOfs, ax

loc_1EA2_354E:				; CODE XREF: sub_1EA2_3519+19j
		lea	si, [bp+arg_4]
		mov	[bp+var_6], si
		mov	cx, [bp+arg_2]
		mov	ax, cx
		dec	ax
		shl	ax, 1
		add	ax, si
		mov	[bp+var_8], ax
		cld
		mov	ax, ss
		mov	es, ax
		lea	ax, [bp+var_798]
		mov	[bp+var_18], ax
		mov	ax, cs:g_pSprite1.dwLeft2
		mov	[bp+var_2], ax
		mov	ax, cs:g_pSprite1.dwWidthSum
		dec	ax
		mov	[bp+var_4], ax
		mov	di, [si]
		mov	ax, [di+6]
		sub	ax, [di+14h]
		sub	ax, [di+18h]
		mov	[bp+var_E], ax
		mov	ax, [di+0Ah]
		add	ax, [di+16h]
		add	ax, [di+1Ah]
		mov	[bp+var_12], ax
		mov	[bp+var_7D0], 3
		mov	bx, [di+2]
		mov	dx, [di+8]
		cmp	bx, dx
		jle	short loc_1EA2_35A8
		xchg	bx, dx

loc_1EA2_35A8:				; CODE XREF: sub_1EA2_3519+8Bj
		mov	[bp+var_10], si
		mov	[bp+var_14], si
		add	si, 2
		dec	cx
		jnz	short loc_1EA2_35C8
		mov	ax, [bp+arg_0]
		mov	[bp+di+arg_0], ax
		push	di
		call	dword ptr g_wImageFuncOfs
		add	sp, 2
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_35C8:				; CODE XREF: sub_1EA2_3519+99j
					; sub_1EA2_3519+128j
		mov	di, [si]
		mov	ax, [di+6]
		sub	ax, [di+14h]
		sub	ax, [di+18h]
		cmp	ax, [bp+var_E]
		jg	short loc_1EA2_35F0
		jnz	short loc_1EA2_35E2
		test	[bp+var_7D0], 1
		jz	short loc_1EA2_35F5

loc_1EA2_35E2:				; CODE XREF: sub_1EA2_3519+BFj
		mov	[bp+var_E], ax
		mov	[bp+var_10], si
		or	[bp+var_7D0], 1
		jmp	short loc_1EA2_35F5
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_35F0:				; CODE XREF: sub_1EA2_3519+BDj
		and	[bp+var_7D0], 2

loc_1EA2_35F5:				; CODE XREF: sub_1EA2_3519+C7j
					; sub_1EA2_3519+D4j
		mov	ax, [di+0Ah]
		add	ax, [di+16h]
		add	ax, [di+1Ah]
		cmp	ax, [bp+var_12]
		jl	short loc_1EA2_361B
		jnz	short loc_1EA2_360D
		test	[bp+var_7D0], 2
		jnz	short loc_1EA2_3620

loc_1EA2_360D:				; CODE XREF: sub_1EA2_3519+EAj
		mov	[bp+var_12], ax
		mov	[bp+var_14], si
		or	[bp+var_7D0], 2
		jmp	short loc_1EA2_3620
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_361B:				; CODE XREF: sub_1EA2_3519+E8j
		and	[bp+var_7D0], 1

loc_1EA2_3620:				; CODE XREF: sub_1EA2_3519+F2j
					; sub_1EA2_3519+FFj
		mov	ax, [di+2]
		cmp	ax, bx
		jge	short loc_1EA2_3629
		mov	bx, ax

loc_1EA2_3629:				; CODE XREF: sub_1EA2_3519+10Cj
		cmp	ax, dx
		jle	short loc_1EA2_362F
		mov	dx, ax

loc_1EA2_362F:				; CODE XREF: sub_1EA2_3519+112j
		mov	ax, [di+8]
		cmp	ax, bx
		jge	short loc_1EA2_3638
		mov	bx, ax

loc_1EA2_3638:				; CODE XREF: sub_1EA2_3519+11Bj
		cmp	ax, dx
		jle	short loc_1EA2_363E
		mov	dx, ax

loc_1EA2_363E:				; CODE XREF: sub_1EA2_3519+121j
		add	si, 2
		loop	loc_1EA2_35C8
		cmp	dx, [bp+var_2]
		jl	short loc_1EA2_3696
		cmp	bx, [bp+var_4]
		jge	short loc_1EA2_3696
		mov	ax, [bp+var_12]
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_3696
		mov	cx, [bp+var_E]
		cmp	cx, cs:g_pSprite1.dwHeight
		jge	short loc_1EA2_3696
		mov	[bp+var_C], 0
		cmp	dx, [bp+var_4]
		jg	short loc_1EA2_367D
		cmp	bx, [bp+var_2]
		jl	short loc_1EA2_367D
		cmp	ax, cs:g_pSprite1.dwHeight
		jge	short loc_1EA2_367D
		cmp	cx, cs:g_pSprite1.dwTop
		jge	short loc_1EA2_3681

loc_1EA2_367D:				; CODE XREF: sub_1EA2_3519+14Fj
					; sub_1EA2_3519+154j ...
		mov	[bp+var_C], 1

loc_1EA2_3681:				; CODE XREF: sub_1EA2_3519+162j
		cmp	ax, cx
		jz	short loc_1EA2_3689
		cmp	dx, bx
		jnz	short loc_1EA2_369C

loc_1EA2_3689:				; CODE XREF: sub_1EA2_3519+16Aj
		mov	si, [bp+var_6]
		mov	di, [si]
		push	di
		call	dword ptr g_wImageFuncOfs
		add	sp, 2

loc_1EA2_3696:				; CODE XREF: sub_1EA2_3519+12Dj
					; sub_1EA2_3519+132j ...
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_369C:				; CODE XREF: sub_1EA2_3519+16Ej
		mov	di, [bp+var_10]

loc_1EA2_369F:				; CODE XREF: sub_1EA2_3519+1AEj
					; sub_1EA2_3519+1B3j
		mov	si, [di]
		cmp	byte ptr [si+12h], 2
		jl	short loc_1EA2_36BC
		mov	[bp+var_16], di
		cmp	[bp+var_C], 0
		jz	short loc_1EA2_36B6
		call	loc_1EA2_2FAD	; calls	into SpriteOp7
		jmp	short loc_1EA2_36B9
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_36B6:				; CODE XREF: sub_1EA2_3519+195j
		call	loc_1EA2_3047

loc_1EA2_36B9:				; CODE XREF: sub_1EA2_3519+19Aj
		mov	di, [bp+var_16]

loc_1EA2_36BC:				; CODE XREF: sub_1EA2_3519+18Cj
		cmp	di, [bp+var_14]
		jz	short loc_1EA2_36CE
		add	di, 2
		cmp	di, [bp+var_8]
		jbe	short loc_1EA2_369F
		mov	di, [bp+var_6]
		jmp	short loc_1EA2_369F
; ---------------------------------------------------------------------------

loc_1EA2_36CE:				; CODE XREF: sub_1EA2_3519+1A6j
		mov	di, [bp+var_10]

loc_1EA2_36D1:				; CODE XREF: sub_1EA2_3519+1CEj
					; sub_1EA2_3519+1D9j
		sub	di, 2
		cmp	di, [bp+var_6]
		jnb	short loc_1EA2_36DC
		mov	di, [bp+var_8]

loc_1EA2_36DC:				; CODE XREF: sub_1EA2_3519+1BEj
		cmp	di, [bp+var_14]
		jz	short loc_1EA2_36F4
		mov	si, [di]
		cmp	byte ptr [si+12h], 2
		jl	short loc_1EA2_36D1
		mov	[bp+var_16], di
		call	sub_1EA2_313E
		mov	di, [bp+var_16]
		jmp	short loc_1EA2_36D1
; ---------------------------------------------------------------------------

loc_1EA2_36F4:				; CODE XREF: sub_1EA2_3519+1C6j
		mov	ax, [bp+var_12]
		cmp	ax, cs:g_pSprite1.dwHeight
		jl	short loc_1EA2_3703
		mov	ax, cs:g_pSprite1.dwHeight
		dec	ax

loc_1EA2_3703:				; CODE XREF: sub_1EA2_3519+1E3j
		mov	bx, [bp+var_E]
		cmp	bx, cs:g_pSprite1.dwTop
		jge	short loc_1EA2_3712
		mov	bx, cs:g_pSprite1.dwTop

loc_1EA2_3712:				; CODE XREF: sub_1EA2_3519+1F2j
		sub	ax, bx
		jle	short loc_1EA2_3733
		inc	ax
		push	[bp+arg_0]
		push	ax
		push	bx
		shl	bx, 1
		lea	ax, [bp+var_3D8]
		add	ax, bx
		push	ax
		lea	ax, [bp+var_798]
		add	ax, bx
		push	ax
		call	dword ptr g_wSpriteFuncOf
		add	sp, 0Ah

loc_1EA2_3733:				; CODE XREF: sub_1EA2_3519+1FBj
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_1EA2_3519	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


sub_1EA2_373A	proc far		; CODE XREF: sub_1EA2_377D+B5P
		push	di
		mov	ax, 0B000h
		mov	es, ax
		assume es:nothing
		xor	di, di
		mov	cx, 7D0h
		xor	ax, ax
		cld
		rep stosw
		pop	di
		retf
sub_1EA2_373A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1EA2_374C	proc far		; CODE XREF: sub_1EA2_377D+4AP
					; sub_1EA2_377D+7CP
		push	si
		push	di
		push	ds
		mov	al, byte_2B77_4BBA
		mov	bl, 0A0h ; ' '
		mul	bl
		mov	si, ax
		mov	di, si
		add	si, 0A0h ; ' '
		mov	ax, 18h
		sub	al, byte_2B77_4BBA
		mov	bl, 50h	; 'P'
		mul	bl
		mov	cx, ax
		mov	ax, es
		mov	ds, ax
		assume ds:nothing
		cld
		rep movsw
		xor	ax, ax
		mov	cx, 50h	; 'P'
		rep stosw
		pop	ds
		assume ds:dseg
		pop	di
		pop	si
		retf
sub_1EA2_374C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1EA2_377D	proc far		; CODE XREF: nopsub_16BA_680+38P
					; sub_270D_14A0+1EP ...
		pop	ax
		mov	word_2B77_4BC2,	ax
		pop	ax
		mov	word_2B77_4BC4,	ax
		mov	ax, offset unk_2B77_4BC6
		push	ax
		call	_sprintf
		add	sp, 2
		mov	byte_2B77_4BBB,	1
		mov	ax, word_2B77_4BBE
		mov	word_2B77_4BC0,	ax

loc_1EA2_379C:				; CODE XREF: sub_1EA2_377D+FAj
		mov	ax, word_2B77_4BC4
		push	ax
		mov	ax, word_2B77_4BC2
		push	ax
		push	si
		mov	ax, 0B000h
		mov	es, ax
		mov	si, offset unk_2B77_4BC6
		mov	dh, byte_2B77_4BBC

loc_1EA2_37B1:				; CODE XREF: sub_1EA2_377D+5Ej
					; sub_1EA2_377D+87j ...
		mov	dl, [si]
		inc	si
		or	dl, dl
		jz	short loc_1EA2_37DD
		cmp	dl, 20h	; ' '
		jl	short loc_1EA2_37EC
		mov	bx, word_2B77_4BC0
		cmp	bx, 0FA0h
		jl	short loc_1EA2_37D3
		call	sub_1EA2_374C
		mov	bx, 0F00h
		mov	word_2B77_4BC0,	bx

loc_1EA2_37D3:				; CODE XREF: sub_1EA2_377D+48j
		mov	es:[bx], dx
		add	word_2B77_4BC0,	2
		jmp	short loc_1EA2_37B1
; ---------------------------------------------------------------------------

loc_1EA2_37DD:				; CODE XREF: sub_1EA2_377D+39j
		cmp	byte_2B77_4BBB,	0
		jz	short loc_1EA2_37EA
		mov	ax, word_2B77_4BC0
		mov	word_2B77_4BBE,	ax

loc_1EA2_37EA:				; CODE XREF: sub_1EA2_377D+65j
		pop	si
		retf
; ---------------------------------------------------------------------------

loc_1EA2_37EC:				; CODE XREF: sub_1EA2_377D+3Ej
		cmp	dl, 0Ah
		jnz	short loc_1EA2_381A
		cmp	word_2B77_4BC0,	0F00h
		jle	short loc_1EA2_3806
		call	sub_1EA2_374C
		mov	word_2B77_4BC0,	0F00h
		jmp	short loc_1EA2_37B1
; ---------------------------------------------------------------------------

loc_1EA2_3806:				; CODE XREF: sub_1EA2_377D+7Aj
		mov	ax, word_2B77_4BC0
		mov	bx, 0A0h ; ' '
		div	bl
		xor	ah, ah
		mul	bl
		add	ax, 0A0h ; ' '
		mov	word_2B77_4BC0,	ax
		jmp	short loc_1EA2_37B1
; ---------------------------------------------------------------------------

loc_1EA2_381A:				; CODE XREF: sub_1EA2_377D+72j
		cmp	dl, 8
		jnz	short loc_1EA2_382D
		cmp	word_2B77_4BC0,	0
		jz	short loc_1EA2_37B1
		sub	word_2B77_4BC0,	2
		jmp	short loc_1EA2_37B1
; ---------------------------------------------------------------------------

loc_1EA2_382D:				; CODE XREF: sub_1EA2_377D+A0j
		cmp	dl, 0Ch
		jnz	short loc_1EA2_3840
		call	sub_1EA2_373A
		mov	word_2B77_4BC0,	0
		jmp	loc_1EA2_37B1
; ---------------------------------------------------------------------------

loc_1EA2_3840:				; CODE XREF: sub_1EA2_377D+B3j
		cmp	dl, 9
		jnz	short loc_1EA2_384F
		add	word_2B77_4BC0,	10h
		and	word_2B77_4BC0,	0FFF0h

loc_1EA2_384F:				; CODE XREF: sub_1EA2_377D+C6j
		jmp	loc_1EA2_37B1
; ---------------------------------------------------------------------------
		pop	ax
		mov	word_2B77_4BC2,	ax
		pop	ax
		mov	word_2B77_4BC4,	ax
		pop	dx
		pop	ax
		mov	bx, 0A0h ; ' '
		mul	bl
		add	ax, dx
		mov	word_2B77_4BC0,	ax
		mov	ax, offset unk_2B77_4BC6
		push	ax
		call	_sprintf
		sub	sp, 2
		mov	byte_2B77_4BBB,	0
		jmp	loc_1EA2_379C
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	ax, [bp+6]
		cmp	ax, 0
		jge	short loc_1EA2_3887
		xor	ax, ax

loc_1EA2_3887:				; CODE XREF: sub_1EA2_377D+106j
		cmp	ax, 18h
		jle	short loc_1EA2_388F
		mov	ax, 18h

loc_1EA2_388F:				; CODE XREF: sub_1EA2_377D+10Dj
		mov	byte_2B77_4BBA,	al
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	ax, [bp+6]
		mov	byte_2B77_4BBC,	al
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_38A0:
		push	bp
		mov	bp, sp
		mov	ax, [bp+6]
		mov	word_2B77_4C42,	ax
		add	ax, word_2B77_4C3E
		mov	g_wVecOp2Adder,	ax
		mov	ax, [bp+8]
		mov	word_2B77_4C44,	ax
		add	ax, word_2B77_4C40
		mov	g_wVecOp2Adder2, ax
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+6]
		mov	word_2B77_4C4E,	ax
		mov	ax, [bp+8]
		mov	word_2B77_4C50,	ax
		jmp	short loc_1EA2_3914
; ---------------------------------------------------------------------------
		db 90h
sub_1EA2_377D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_38D3	proc far		; CODE XREF: RunTracksMenu+75P
					; RunCarMenu+33BP ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+arg_0]
		xor	dh, dh
		mov	dl, ah
		mov	ah, al
		xor	al, al
		mov	cx, 3

loc_1EA2_38E6:				; CODE XREF: sub_1EA2_38D3+17j
		shl	ax, 1
		rcl	dx, 1
		loop	loc_1EA2_38E6
		mov	cx, 168h
		div	cx
		shr	ax, 1
		mov	word_2B77_4C4E,	ax
		mov	ax, [bp+arg_2]
		xor	dh, dh
		mov	dl, ah
		mov	ah, al
		xor	al, al
		mov	cx, 3

loc_1EA2_3904:				; CODE XREF: sub_1EA2_38D3+35j
		shl	ax, 1
		rcl	dx, 1
		loop	loc_1EA2_3904
		mov	cx, 168h
		div	cx
		shr	ax, 1
		mov	word_2B77_4C50,	ax

loc_1EA2_3914:				; CODE XREF: sub_1EA2_377D+153j
		mov	ax, [bp+arg_4]
		shr	ax, 1
		mov	word_2B77_4C3E,	ax
		add	ax, word_2B77_4C42
		mov	g_wVecOp2Adder,	ax
		mov	ax, [bp+arg_6]
		shr	ax, 1
		mov	word_2B77_4C40,	ax
		add	ax, word_2B77_4C44
		mov	g_wVecOp2Adder2, ax
		push	word_2B77_4C4E
		call	LookupCos
		add	sp, 2
		mul	word_2B77_4C3E
		mov	si, ax
		mov	di, dx
		push	word_2B77_4C4E
		call	LookupSine
		add	sp, 2
		mov	cx, ax
		mov	dx, di
		mov	ax, si
		div	cx
		mov	g_wVecOp2XMultiplier, ax
		mov	bx, word_2B77_4C50
		or	bx, bx
		jz	short loc_1EA2_3994
		push	word_2B77_4C50
		call	LookupCos
		add	sp, 2
		mul	word_2B77_4C40
		mov	si, ax
		mov	di, dx
		push	word_2B77_4C50
		call	LookupSine
		add	sp, 2
		mov	cx, ax
		mov	dx, di
		mov	ax, si
		div	cx
		mov	g_wVecOp2YMultiplier, ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3994:				; CODE XREF: sub_1EA2_38D3+90j
		mov	bx, ax
		shr	bx, 1
		shr	bx, 1
		shr	bx, 1
		sub	ax, bx
		shr	bx, 1
		sub	ax, bx
		mov	g_wVecOp2YMultiplier, ax
		push	word_2B77_4C40
		push	ax
		call	GetAngleFromXZ
		add	sp, 4
		mov	word_2B77_4C50,	ax
		pop	di
		pop	si
		pop	bp
		retf
sub_1EA2_38D3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

VectorOp2	proc far		; CODE XREF: SkyBoxOp+B0P SkyBoxOp+C0P ...

p_pVector	= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	di
		push	si
		mov	si, [bp+p_pVector]
		mov	di, [bp+arg_2]
		mov	cx, [si+Vector3D.wZ]
		or	cx, cx
		jle	short loc_1EA2_3A11
		mov	ax, [si+Vector3D.wX]
		or	ax, ax
		jl	short loc_1EA2_39EF
		mul	g_wVecOp2XMultiplier
		mov	bx, dx
		shl	bx, 1
		or	ax, ax
		jge	short loc_1EA2_39DE
		inc	bx

loc_1EA2_39DE:				; CODE XREF: VectorOp2+22j
		cmp	cx, bx
		jle	short loc_1EA2_3A20
		div	cx
		add	ax, g_wVecOp2Adder
		jo	short loc_1EA2_3A1C
		mov	[di], ax
		jmp	short loc_1EA2_3A2D
; ---------------------------------------------------------------------------
		nop

loc_1EA2_39EF:				; CODE XREF: VectorOp2+16j
		neg	ax
		mul	g_wVecOp2XMultiplier
		mov	bx, dx
		shl	bx, 1
		or	ax, ax
		jge	short loc_1EA2_39FE
		inc	bx

loc_1EA2_39FE:				; CODE XREF: VectorOp2+42j
		cmp	cx, bx
		jle	short loc_1EA2_3A28
		div	cx
		neg	ax
		add	ax, g_wVecOp2Adder
		jo	short loc_1EA2_3A1C
		mov	[di], ax
		jmp	short loc_1EA2_3A2D
; ---------------------------------------------------------------------------
		nop

loc_1EA2_3A11:				; CODE XREF: VectorOp2+10j
		mov	ax, 8000h
		mov	[di], ax
		mov	[di+2],	ax
		jmp	short loc_1EA2_3A52
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_3A1C:				; CODE XREF: VectorOp2+2Fj
					; VectorOp2+51j
		or	ax, ax
		jge	short loc_1EA2_3A28

loc_1EA2_3A20:				; CODE XREF: VectorOp2+27j
		mov	ax, 7D00h
		mov	[di], ax
		jmp	short loc_1EA2_3A2D
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_3A28:				; CODE XREF: VectorOp2+47j
					; VectorOp2+65j
		mov	ax, 8300h
		mov	[di], ax

loc_1EA2_3A2D:				; CODE XREF: VectorOp2+33j
					; VectorOp2+55j ...
		mov	ax, [si+Vector3D.wY]
		or	ax, ax
		jl	short loc_1EA2_3A56
		mul	g_wVecOp2YMultiplier
		mov	bx, dx
		shl	bx, 1
		or	ax, ax
		jge	short loc_1EA2_3A41
		inc	bx

loc_1EA2_3A41:				; CODE XREF: VectorOp2+85j
		cmp	cx, bx
		jle	short loc_1EA2_3A7A
		div	cx
		neg	ax
		add	ax, g_wVecOp2Adder2
		jo	short loc_1EA2_3A76
		mov	[di+2],	ax

loc_1EA2_3A52:				; CODE XREF: VectorOp2+60j
					; VectorOp2+BBj ...
		pop	si
		pop	di
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3A56:				; CODE XREF: VectorOp2+79j
		neg	ax
		mul	g_wVecOp2YMultiplier
		mov	bx, dx
		shl	bx, 1
		or	ax, ax
		jge	short loc_1EA2_3A65
		inc	bx

loc_1EA2_3A65:				; CODE XREF: VectorOp2+A9j
		cmp	cx, bx
		jle	short loc_1EA2_3A82
		div	cx
		add	ax, g_wVecOp2Adder2
		jo	short loc_1EA2_3A76
		mov	[di+2],	ax
		jmp	short loc_1EA2_3A52
; ---------------------------------------------------------------------------

loc_1EA2_3A76:				; CODE XREF: VectorOp2+94j
					; VectorOp2+B6j
		or	ax, ax
		jl	short loc_1EA2_3A82

loc_1EA2_3A7A:				; CODE XREF: VectorOp2+8Aj
		mov	ax, 8300h
		mov	[di+2],	ax
		jmp	short loc_1EA2_3A52
; ---------------------------------------------------------------------------

loc_1EA2_3A82:				; CODE XREF: VectorOp2+AEj
					; VectorOp2+BFj
		mov	ax, 7D00h
		mov	[di+2],	ax
		jmp	short loc_1EA2_3A52
VectorOp2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ReleaseWindow	proc far		; CODE XREF: RunIntroInLoop+5BP
					; RunIntroInLoop+DCP ...

var_4		= word ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		mov	es, [bp+arg_2]
		assume es:nothing
		mov	di, [bp+arg_0]
		mov	ds, word ptr es:[di+2]
		mov	si, es:[di]
		mov	ax, [si+2]
		add	ax, 0Fh
		shl	ax, 1
		mov	dx, ax
		add	dx, di
		mov	bx, cs:g_ppNextWndDef
		cmp	bx, dx
		jnz	short loc_1EA2_3ACC
		sub	bx, ax
		mov	cs:g_ppNextWndDef, bx
		push	ds
		push	si
		mov	ax, ss
		mov	ds, ax
		call	SetResField10To0
		add	sp, 4
		pop	di
		pop	si
		pop	ds
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3ACC:				; CODE XREF: ReleaseWindow+26j
		mov	ax, ss
		mov	ds, ax
		lea	ax, aWindowReleased ; "Window Released Out of Order\r\n"
		push	ax
		call	far ptr	ErrorMessage
		push	bp
		mov	bp, sp
		sub	sp, 6
		push	ds
		push	si
		push	di
		mov	[bp+var_4], 0
		jmp	short loc_1EA2_3AF9
ReleaseWindow	endp

; ---------------------------------------------------------------------------
		db 90h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SaveAndDelFile	proc far		; CODE XREF: DoHighScore+F1P
					; HiscoreRelated+7AP ...

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	ds
		push	si
		push	di
		mov	[bp+var_4], 1

loc_1EA2_3AF9:				; CODE XREF: ReleaseWindow+5Ej
		mov	dx, [bp+arg_0]
		xor	cx, cx
		mov	ah, 3Ch
		int	21h		; DOS -	2+ - CREATE A FILE WITH	HANDLE (CREAT)
					; CX = attributes for file
					; DS:DX	-> ASCIZ filename (may include drive and path)
		jb	short loc_1EA2_3B50
		mov	[bp+var_2], ax

loc_1EA2_3B07:				; CODE XREF: SaveAndDelFile+60j
		cmp	[bp+arg_6], 0
		jnz	short loc_1EA2_3B13
		cmp	[bp+arg_8], 0
		jz	short loc_1EA2_3B7E

loc_1EA2_3B13:				; CODE XREF: SaveAndDelFile+20j
		mov	cx, 4000h
		mov	ax, [bp+arg_6]
		sub	[bp+arg_6], cx
		sbb	[bp+arg_8], 0
		jnb	short loc_1EA2_3B33
		mov	cx, [bp+arg_6]
		mov	[bp+arg_6], 0
		mov	[bp+arg_8], 0
		add	cx, 4000h

loc_1EA2_3B33:				; CODE XREF: SaveAndDelFile+35j
		mov	ds, [bp+arg_4]
		mov	dx, [bp+arg_2]
		mov	bx, [bp+var_2]
		mov	ah, 40h
		int	21h		; DOS -	2+ - WRITE TO FILE WITH	HANDLE
					; BX = file handle, CX = number	of bytes to write, DS:DX -> buffer
		jb	short loc_1EA2_3B50
		cmp	ax, cx
		jnz	short loc_1EA2_3B4D
		add	[bp+arg_4], 400h
		jmp	short loc_1EA2_3B07
; ---------------------------------------------------------------------------

loc_1EA2_3B4D:				; CODE XREF: SaveAndDelFile+59j
		mov	ax, 1

loc_1EA2_3B50:				; CODE XREF: SaveAndDelFile+17j
					; SaveAndDelFile+55j
		mov	[bp+var_6], ax
		mov	bx, [bp+var_2]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		mov	ax, ss
		mov	ds, ax
		mov	dx, [bp+arg_0]
		mov	ah, 41h
		int	21h		; DOS -	2+ - DELETE A FILE (UNLINK)
					; DS:DX	-> ASCIZ pathname of file to delete (no	wildcards allowed)
		mov	ax, [bp+var_6]
		cmp	[bp+var_4], 0
		jnz	short loc_1EA2_3B87
		mov	ax, ss
		mov	ds, ax
		mov	ax, offset aSFileError_0 ; "%s FILE ERROR\r"
		push	[bp+arg_0]
		push	ax
		call	far ptr	ErrorMessage

loc_1EA2_3B7E:				; CODE XREF: SaveAndDelFile+26j
		mov	bx, [bp+var_2]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		xor	ax, ax

loc_1EA2_3B87:				; CODE XREF: SaveAndDelFile+81j
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
SaveAndDelFile	endp


; =============== S U B	R O U T	I N E =======================================


AddVideoExitHan	proc far		; CODE XREF: CallBiosMode13hP
		cmp	g_cVideoMode, 0
		jnz	short locret_1EA2_3BB5
		mov	ah, 0Fh
		int	10h		; - VIDEO - GET	CURRENT	VIDEO MODE
					; Return: AH = number of columns on screen
					; AL = current video mode
					; BH = current active display page
		mov	g_cVideoMode, al
		mov	ax, 40h	; '@'
		mov	es, ax
		assume es:nothing
		mov	al, es:10h
		mov	g_cVideoMode2, al
		push	cs
		mov	ax, offset VideoAtExit
		push	ax
		call	AddExitHandler
		add	sp, 4

locret_1EA2_3BB5:			; CODE XREF: AddVideoExitHan+5j
		retf
AddVideoExitHan	endp


; =============== S U B	R O U T	I N E =======================================


VideoAtExit	proc far		; DATA XREF: AddVideoExitHan+1Bo
		mov	ax, 40h	; '@'
		mov	es, ax
		mov	al, g_cVideoMode2
		mov	es:10h,	al
		mov	ah, 0
		mov	al, g_cVideoMode
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		mov	ax, 40h	; '@'
		mov	es, ax
		mov	al, g_cVideoMode2
		mov	es:10h,	al
		and	al, 30h
		cmp	al, 30h	; '0'
		jnz	short loc_1EA2_3BE6
		xor	ax, ax
		push	ax
		call	ClearScreenClr
		add	sp, 2

loc_1EA2_3BE6:				; CODE XREF: VideoAtExit+23j
		mov	ah, 0Bh
		mov	bx, 0
		int	10h		; - VIDEO - SET	COLOR PALETTE
					; BH = 00h, BL = border	color
					; BH = 01h, BL = palette (0-3)
		retf
VideoAtExit	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetSprite1And2	proc far		; CODE XREF: Trakdata12SpriteOp+A1P
					; RenderMouSpr3+AP ...

p_pTarget	= word ptr  6

		push	bp
		mov	bp, sp
		push	ds
		push	di
		push	si
		lea	si, g_pSprite1	; ; on cs / seg12
		mov	di, [bp+p_pTarget]
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	ax, cs
		mov	ds, ax
		assume ds:seg012
		cld
		mov	cx, 1Eh
		rep movsw		; ds:si	-> es:di
		pop	si
		pop	di
		pop	ds
		assume ds:dseg
		pop	bp
		retf
GetSprite1And2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CopyToSprite1_2	proc far		; CODE XREF: DoTrakdata12+94P
					; RenderMouSpr3+2EP ...

p_pSource	= word ptr  6

		push	bp
		mov	bp, sp
		push	ds
		push	di
		push	si
		mov	si, [bp+p_pSource]
		mov	ax, cs
		mov	es, ax
		assume es:seg012
		lea	di, g_pSprite1
		cld
		mov	cx, 1Eh
		rep movsw
		pop	si
		pop	di
		pop	ds
		pop	bp
		retf
CopyToSprite1_2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetWord4FromArg	proc far		; CODE XREF: Maybe2dShParse+EP
					; GetUnflipSize+CP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		mov	es, [bp+arg_2]
		assume es:nothing
		mov	si, [bp+arg_0]
		mov	ax, es:[si+4]
		pop	si
		pop	bp
		retf
GetWord4FromArg	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetWord4Scaled	proc far		; CODE XREF: sub_1EA2_40C2+39P
					; sub_1EA2_7528+32P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		mov	es, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, es:[si+4]
		shl	ax, 1
		shl	ax, 1
		mov	bx, [bp+arg_4]
		shl	bx, 1
		shl	bx, 1
		add	bx, ax

loc_1EA2_3C56:
		add	bx, 6
		shl	ax, 1
		add	ax, 6
		mov	cx, es
		xor	dx, dx
		shl	cx, 1
		rcl	dx, 1
		shl	cx, 1
		rcl	dx, 1
		shl	cx, 1
		rcl	dx, 1
		shl	cx, 1
		rcl	dx, 1
		add	ax, cx
		adc	dx, 0
		add	ax, es:[bx]
		adc	dx, es:[bx+2]
		mov	bx, ax
		and	bx, 0Fh
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		shr	dx, 1
		rcr	ax, 1
		mov	dx, ax
		mov	ax, bx
		pop	si
		pop	bp
		retf
GetWord4Scaled	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3C9A	proc far

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		push	si
		mov	es, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	bx, [bp+arg_4]
		shl	bx, 1
		shl	bx, 1
		mov	ax, es:[bx+si+6]
		mov	dx, es:[bx+si+8]
		mov	si, [bp+arg_6]
		mov	[si], ax
		mov	[si+2],	dx
		pop	si
		pop	bp
		retf
sub_1EA2_3C9A	endp

; looks	up the index of	al in the logtable, using (ah and 3)
; as the look up method

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LookupSine	proc far		; CODE XREF: OpponentOp+630P
					; TrkPlanSimd+1995P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]	; arg is g_dwUseRplTrk | some nums

loc_1EA2_3CC4:				; CODE XREF: LookupCos+9j
		mov	bl, ah		; bl is	one more if current track is in	the rpl
		xor	ah, ah
		and	bx, 3
		shl	bx, 1
		jmp	cs:off_1EA2_3CD2[bx]
; ---------------------------------------------------------------------------
off_1EA2_3CD2	dw offset loc_1EA2_3CDA	; DATA XREF: LookupSine+Fr
		dw offset loc_1EA2_3CE4
		dw offset loc_1EA2_3CF1
		dw offset loc_1EA2_3CFD
; ---------------------------------------------------------------------------

loc_1EA2_3CDA:				; CODE XREF: LookupSine+Fj
					; DATA XREF: LookupSine:off_1EA2_3CD2o
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_pwQuarterSineTab[bx]
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3CE4:				; CODE XREF: LookupSine+Fj
					; DATA XREF: LookupSine+16o
		mov	bx, 100h
		sub	bx, ax
		shl	bx, 1
		mov	ax, g_pwQuarterSineTab[bx]
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3CF1:				; CODE XREF: LookupSine+Fj
					; DATA XREF: LookupSine+18o
		mov	bx, ax
		shl	bx, 1
		mov	ax, g_pwQuarterSineTab[bx]
		neg	ax
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3CFD:				; CODE XREF: LookupSine+Fj
					; DATA XREF: LookupSine+1Ao
		mov	bx, 100h
		sub	bx, ax
		shl	bx, 1
		mov	ax, g_pwQuarterSineTab[bx]
		neg	ax
		pop	bp
		retf
LookupSine	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LookupCos	proc far		; CODE XREF: OpponentOp+5F6P
					; TrkPlanSimd+19CFP ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		add	ax, 100h
		jmp	short loc_1EA2_3CC4
LookupCos	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3D18	proc far

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		mov	dx, [bp+arg_2]
		mov	ax, [bp+arg_0]
		div	[bp+arg_4]
		pop	bp
		retf
sub_1EA2_3D18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3D26	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, g_wVecOp2XMultiplier
		mul	[bp+arg_0]
		pop	bp
		retf
sub_1EA2_3D26	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3D31	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, g_wVecOp2YMultiplier
		mul	[bp+arg_0]
		pop	bp
		retf
sub_1EA2_3D31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3D3C	proc far		; CODE XREF: TransformedShapeOp+DD6P

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	ax, g_wVecOp2XMultiplier
		mul	[bp+arg_0]
		div	[bp+arg_2]
		pop	bp
		retf
sub_1EA2_3D3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_3D4A	proc far

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	ax, g_wVecOp2YMultiplier
		mul	[bp+arg_0]
		div	[bp+arg_2]
		pop	bp
		retf
sub_1EA2_3D4A	endp


; =============== S U B	R O U T	I N E =======================================


GetTimerCounter	proc far		; CODE XREF: GetSuperRandom+17P
					; DoGetTimerKb2+AP ...
		cli
		mov	ax, word ptr g_dwTimerCounte
		mov	dx, word ptr g_dwTimerCounte+2
		sti
		retf
GetTimerCounter	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SubtractTimerCounter proc far

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_0]
		mov	cx, [bp+arg_2]
		cli
		mov	ax, word ptr g_dwTimerCounte
		mov	dx, word ptr g_dwTimerCounte+2
		sti
		sub	ax, bx
		sbb	dx, cx
		pop	bp
		retf
SubtractTimerCounter endp


; =============== S U B	R O U T	I N E =======================================


GetTimerDelta	proc far		; CODE XREF: SetupIntro+153P
					; SetupIntro:loc_9F1_3BCEP ...
		mov	bx, word ptr g_dwLastTimerCo
		mov	cx, word ptr g_dwLastTimerCo+2
		cli
		mov	ax, word ptr g_dwTimerCounte
		mov	dx, word ptr g_dwTimerCounte+2
		sti
		mov	word ptr g_dwLastTimerCo, ax
		mov	word ptr g_dwLastTimerCo+2, dx
		sub	ax, bx
		sbb	dx, cx
		retf
GetTimerDelta	endp


; =============== S U B	R O U T	I N E =======================================


ResetTimerCount	proc far
		xor	ax, ax
		mov	word ptr g_dwTimerCounte, ax
		mov	word ptr g_dwTimerCounte+2, ax
		retf
ResetTimerCount	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

CopyTimerCounte	proc far		; CODE XREF: AudioDrvFunc3f+44P
					; AudioDrvFunc3f+9DP ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		call	GetTimerCounter
		add	ax, [bp+arg_0]
		adc	dx, [bp+arg_2]
		mov	word ptr g_wTimerCounter, ax
		mov	word ptr g_wTimerCounter+2, dx
		pop	bp
		retf
CopyTimerCounte	endp


; =============== S U B	R O U T	I N E =======================================


WaitDXIsTimerCo	proc far		; CODE XREF: WaitDXIsTimerCo+9j
					; WaitDXIsTimerCo+11j ...
		call	GetTimerCounter
		cmp	dx, word ptr g_wTimerCounter+2
		jb	short near ptr WaitDXIsTimerCo
		ja	short locret_1EA2_3DCA
		cmp	ax, word ptr g_wTimerCounter
		jb	short near ptr WaitDXIsTimerCo

locret_1EA2_3DCA:			; CODE XREF: WaitDXIsTimerCo+Bj
		retf
WaitDXIsTimerCo	endp


; =============== S U B	R O U T	I N E =======================================


CompareDXTimerC	proc far		; CODE XREF: ReadLine+124P
		call	GetTimerCounter
		cmp	dx, word ptr g_wTimerCounter+2
		jb	short loc_1EA2_3DE2
		ja	short loc_1EA2_3DDE
		cmp	ax, word ptr g_wTimerCounter
		jb	short loc_1EA2_3DE2

loc_1EA2_3DDE:				; CODE XREF: CompareDXTimerC+Bj
		mov	ax, 1
		retf
; ---------------------------------------------------------------------------

loc_1EA2_3DE2:				; CODE XREF: CompareDXTimerC+9j
					; CompareDXTimerC+11j
		xor	ax, ax
		retf
CompareDXTimerC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoGetTimerCounter2X proc far		; CODE XREF: sub_11B7_A06+6P
					; RplyMouseSpriteStuff+119AP ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		call	GetTimerCounter
		add	ax, [bp+arg_0]
		adc	dx, [bp+arg_2]
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_1EA2_3DFC:				; CODE XREF: DoGetTimerCounter2X+1Fj
					; DoGetTimerCounter2X+26j
		call	GetTimerCounter
		cmp	dx, [bp+var_2]
		jb	short loc_1EA2_3DFC
		ja	short loc_1EA2_3E0D
		cmp	ax, [bp+var_4]
		jb	short loc_1EA2_3DFC

loc_1EA2_3E0D:				; CODE XREF: DoGetTimerCounter2X+21j
		mov	sp, bp
		pop	bp
		retf
DoGetTimerCounter2X endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

WrapStrWidth	proc far		; CODE XREF: ReadlineHelper+3DP
					; ReadlineHelper+63P

arg_4		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	dx, [bp+arg_4]
		or	dx, dx
		jnz	short loc_1EA2_3E2A
		xor	ax, ax
		jmp	short loc_1EA2_3E62
WrapStrWidth	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeGetStrWidt	proc far		; CODE XREF: EndOfGameScores+A2CP
					; EndOfGameScores+B03P	...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	si
		push	di
		xor	dx, dx

loc_1EA2_3E2A:				; CODE XREF: WrapStrWidth+Aj
		mov	es, g_segFontDef
		mov	si, [bp+arg_0]
		xor	ax, ax
		mov	cl, es:14h	; read byte 0x14 from the font def
		mov	di, es:10h	; read by 0x10 from the	font def

loc_1EA2_3E3D:				; CODE XREF: MaybeGetStrWidt+2Bj
					; MaybeGetStrWidt+3Dj
		mov	bl, [si]
		or	bl, bl
		jz	short loc_1EA2_3E62
		inc	si
		xor	bh, bh
		shl	bx, 1
		mov	bx, es:[bx+16h]
		or	bx, bx
		jz	short loc_1EA2_3E3D
		or	cl, cl
		jz	short loc_1EA2_3E5B
		mov	bl, es:[bx]
		xor	bh, bh
		mov	di, bx

loc_1EA2_3E5B:				; CODE XREF: MaybeGetStrWidt+2Fj
		add	ax, di
		dec	dx
		jz	short loc_1EA2_3E62
		jmp	short loc_1EA2_3E3D
; ---------------------------------------------------------------------------

loc_1EA2_3E62:				; CODE XREF: WrapStrWidth+Ej
					; MaybeGetStrWidt+1Ej ...
		pop	di
		pop	si
		pop	bp
		retf
MaybeGetStrWidt	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DeriveSpriteOp4	proc far		; CODE XREF: sub_14D6_1296+ADP

var_A		= byte ptr -0Ah
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	si, [bp+arg_6]
		mov	[bp+var_A], 1
		jmp	short loc_1EA2_3E88
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 7D0h
		push	si
		push	di
		mov	si, [bp+arg_6]
		mov	[bp+var_A], 0

loc_1EA2_3E88:				; CODE XREF: DeriveSpriteOp4+10j
					; sub_1EA2_3EA9+10j ...
		mov	ax, [bp+arg_0]
		mov	g_wSpriteOpFlag, ax
		mov	ax, [bp+arg_2]
		mov	[bp+arg_0], ax
		mov	ax, [bp+arg_4]
		mov	[bp+arg_2], ax
		mov	ax, offset SpriteOp4
		mov	g_wSpriteFuncOf, ax
		mov	ax, offset ImageResetRende
		mov	g_wImageFuncOfs, ax
		jmp	loc_1EA2_2DEA
DeriveSpriteOp4	endp

; [00000012 BYTES: COLLAPSED FUNCTION sub_1EA2_3EA9. PRESS KEYPAD "+" TO EXPAND]
; [00000012 BYTES: COLLAPSED FUNCTION sub_1EA2_3EBB. PRESS KEYPAD "+" TO EXPAND]
		align 2

; ReadPolyInfo reads from the polyinfo and arg0+0, arg0+2, arg0+4, and writes to arg_4+0, arg4+2 and arg4+4 (xyz vectors?)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatMultiplyVector proc far		; CODE XREF: OpponentOp+200P
					; OpponentOp+26FP ...

p_pInVec	= word ptr  6
p_pMatrix	= word ptr  8
p_pOutVec	= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	bx, [bp+p_pMatrix]
		mov	si, [bp+p_pInVec]
		mov	di, [bp+p_pOutVec]
		xor	dx, dx
		mov	ax, [bx+Matrix._11]
		or	ax, ax
		jz	short loc_1EA2_3EF4
		mov	cx, [si+Vector3D.wX]
		or	cx, cx
		jz	short loc_1EA2_3EF4
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1

loc_1EA2_3EF4:				; CODE XREF: MatMultiplyVector+14j
					; MatMultiplyVector+1Aj
		mov	[di+Vector3D.wX], dx
		mov	ax, [bx+Matrix._12]
		or	ax, ax
		jz	short loc_1EA2_3F10
		mov	cx, [si+Vector3D.wY]
		or	cx, cx
		jz	short loc_1EA2_3F10
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Vector3D.wX], dx

loc_1EA2_3F10:				; CODE XREF: MatMultiplyVector+2Dj
					; MatMultiplyVector+34j
		mov	ax, [bx+Matrix._13]
		or	ax, ax
		jz	short loc_1EA2_3F2A
		mov	cx, [si+Vector3D.wZ]
		or	cx, cx
		jz	short loc_1EA2_3F2A
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Vector3D.wX], dx

loc_1EA2_3F2A:				; CODE XREF: MatMultiplyVector+47j
					; MatMultiplyVector+4Ej
		xor	dx, dx
		mov	ax, [bx+Matrix._21]
		or	ax, ax
		jz	short loc_1EA2_3F43
		mov	cx, [si+Vector3D.wX]
		or	cx, cx
		jz	short loc_1EA2_3F43
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1

loc_1EA2_3F43:				; CODE XREF: MatMultiplyVector+63j
					; MatMultiplyVector+69j
		mov	[di+Vector3D.wY], dx
		mov	ax, [bx+Matrix._22]
		or	ax, ax
		jz	short loc_1EA2_3F61
		mov	cx, [si+Vector3D.wY]
		or	cx, cx
		jz	short loc_1EA2_3F61
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Vector3D.wY], dx

loc_1EA2_3F61:				; CODE XREF: MatMultiplyVector+7Dj
					; MatMultiplyVector+84j
		mov	ax, [bx+Matrix._23]
		or	ax, ax
		jz	short loc_1EA2_3F7C
		mov	cx, [si+Vector3D.wZ]
		or	cx, cx
		jz	short loc_1EA2_3F7C
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Vector3D.wY], dx

loc_1EA2_3F7C:				; CODE XREF: MatMultiplyVector+98j
					; MatMultiplyVector+9Fj
		xor	dx, dx
		mov	ax, [bx+Matrix._31]
		or	ax, ax
		jz	short loc_1EA2_3F95
		mov	cx, [si+Vector3D.wX]
		or	cx, cx
		jz	short loc_1EA2_3F95
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1

loc_1EA2_3F95:				; CODE XREF: MatMultiplyVector+B5j
					; MatMultiplyVector+BBj
		mov	[di+Vector3D.wZ], dx
		mov	ax, [bx+Matrix._32]
		or	ax, ax
		jz	short loc_1EA2_3FB3
		mov	cx, [si+Vector3D.wY]
		or	cx, cx
		jz	short loc_1EA2_3FB3
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Vector3D.wZ], dx

loc_1EA2_3FB3:				; CODE XREF: MatMultiplyVector+CFj
					; MatMultiplyVector+D6j
		mov	ax, [bx+Matrix._33]
		or	ax, ax
		jz	short loc_1EA2_3FCE
		mov	cx, [si+Vector3D.wZ]
		or	cx, cx
		jz	short loc_1EA2_3FCE
		imul	cx
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Vector3D.wZ], dx

loc_1EA2_3FCE:				; CODE XREF: MatMultiplyVector+EAj
					; MatMultiplyVector+F1j
		pop	di
		pop	si
		pop	bp
		retf
MatMultiplyVector endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatMultiply	proc far		; CODE XREF: TransformedShapeOp+E8P
					; TransformedShapeOp+152P ...

p_pMatrix	= word ptr  6
p_pMatrix2	= word ptr  8
p_pMatrix3	= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	si, [bp+p_pMatrix]
		mov	bx, [bp+p_pMatrix2]
		mov	di, [bp+p_pMatrix3]
		mov	cx, 9

loc_1EA2_3FE3:				; CODE XREF: MatMultiply+6Ej
					; MatMultiply+7Aj
		xor	dx, dx
		mov	ax, [si+Matrix._11]
		or	ax, ax
		jz	short loc_1EA2_3FFA
		cmp	[bx+Matrix._11], 0
		jz	short loc_1EA2_3FFA
		imul	[bx+Matrix._11]
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1

loc_1EA2_3FFA:				; CODE XREF: MatMultiply+17j
					; MatMultiply+1Cj
		mov	[di+Matrix._11], dx
		mov	ax, [si+Matrix._21]
		or	ax, ax
		jz	short loc_1EA2_4016
		cmp	[bx+Matrix._12], 0
		jz	short loc_1EA2_4016
		imul	[bx+Matrix._12]
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Matrix._11], dx

loc_1EA2_4016:				; CODE XREF: MatMultiply+2Fj
					; MatMultiply+35j
		mov	ax, [si+Matrix._31]
		or	ax, ax
		jz	short loc_1EA2_4030
		cmp	[bx+Matrix._13], 0
		jz	short loc_1EA2_4030
		imul	[bx+Matrix._13]
		shl	ax, 1
		rcl	dx, 1
		shl	ax, 1
		rcl	dx, 1
		add	[di+Matrix._11], dx

loc_1EA2_4030:				; CODE XREF: MatMultiply+49j
					; MatMultiply+4Fj
		add	di, 2
		cmp	cx, 7
		jz	short loc_1EA2_4046
		cmp	cx, 4
		jz	short loc_1EA2_4046
		add	bx, 2
		loop	loc_1EA2_3FE3
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4046:				; CODE XREF: MatMultiply+64j
					; MatMultiply+69j
		sub	bx, 4
		add	si, 6
		loop	loc_1EA2_3FE3
		pop	di
		pop	si
		pop	bp
		retf
MatMultiply	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatCopy		proc far		; CODE XREF: TrkPlanSimd+A70P
					; PlaneRotateOp+82P ...

p_pPolyInfo1	= word ptr  6
p_pPolyInfo2	= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	si, [bp+p_pPolyInfo1]
		mov	di, [bp+p_pPolyInfo2]
		mov	cx, 9
		cmp	si, di
		jnz	short loc_1EA2_4083
		mov	ax, [si+Matrix._21]
		xchg	ax, [si+Matrix._12]
		mov	[si+Matrix._21], ax
		mov	ax, [si+Matrix._31]
		xchg	ax, [si+Matrix._13]
		mov	[si+Matrix._31], ax
		mov	ax, [si+Matrix._32]
		xchg	ax, [si+Matrix._23]
		mov	[si+Matrix._32], ax
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4083:				; CODE XREF: MatCopy+10j
		mov	ax, [si+Matrix._11]
		mov	[di+Matrix._11], ax
		mov	ax, [si+Matrix._21]
		mov	[di+Matrix._12], ax
		mov	ax, [si+Matrix._31]
		mov	[di+Matrix._13], ax
		mov	ax, [si+Matrix._12]
		mov	[di+Matrix._21], ax
		mov	ax, [si+Matrix._22]
		mov	[di+Matrix._22], ax
		mov	ax, [si+Matrix._32]
		mov	[di+Matrix._23], ax
		mov	ax, [si+Matrix._13]
		mov	[di+Matrix._31], ax
		mov	ax, [si+Matrix._23]
		mov	[di+Matrix._32], ax
		mov	ax, [si+Matrix._33]
		mov	[di+Matrix._33], ax
		pop	di
		pop	si
		pop	bp
		retf
MatCopy		endp

; ---------------------------------------------------------------------------
		align 2
off_1EA2_40BC	dw offset loc_1EA2_4158	; DATA XREF: sub_1EA2_40C2+91r
		dw offset loc_1EA2_4173
		dw offset loc_1EA2_41BE

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_40C2	proc far		; CODE XREF: Load2DShape+10FP

var_210		= byte ptr -210h
var_110		= byte ptr -110h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		cld
		mov	ax, [bp+arg_2]
		mov	ds, ax
		mov	ax, [bp+arg_0]
		mov	si, ax
		mov	ax, [bp+arg_6]
		mov	[bp+var_A], ax
		mov	ax, [bp+arg_4]
		mov	[bp+var_8], ax
		mov	bx, [si+4]
		mov	[bp+var_2], bx
		mov	[bp+var_4], 0

loc_1EA2_40ED:				; CODE XREF: sub_1EA2_40C2+72j
		push	[bp+var_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		mov	ax, seg	dseg
		mov	ds, ax
		call	GetWord4Scaled
		add	sp, 6
		mov	[bp+var_6], ax
		mov	si, ax
		mov	ds, dx
		mov	di, [bp+var_8]
		mov	es, [bp+var_A]
		mov	al, [si+0Fh]
		and	al, 0F0h
		jnz	short loc_1EA2_412E
		mov	al, [si+0Eh]
		shr	al, 1
		shr	al, 1
		shr	al, 1
		shr	al, 1
		jz	short loc_1EA2_412E
		cmp	al, 4
		jb	short loc_1EA2_413F
		mov	ax, 1
		jmp	short loc_1EA2_4138
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_412E:				; CODE XREF: sub_1EA2_40C2+53j
					; sub_1EA2_40C2+60j ...
		inc	[bp+var_4]
		dec	[bp+var_2]
		jg	short loc_1EA2_40ED
		xor	ax, ax

loc_1EA2_4138:				; CODE XREF: sub_1EA2_40C2+69j
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_413F:				; CODE XREF: sub_1EA2_40C2+64j
		mov	dx, [si]
		mov	[bp+var_C], dx
		mov	dx, [si+2]
		mov	[bp+var_E], dx
		xor	dx, dx
		xor	ah, ah
		mov	bx, ax
		dec	bx
		shl	bx, 1
		jmp	cs:off_1EA2_40BC[bx]

loc_1EA2_4158:				; CODE XREF: sub_1EA2_40C2+ACj
					; DATA XREF: seg012:off_1EA2_40BCo
		mov	bx, si
		add	bx, 10h
		add	bx, dx
		mov	cx, [bp+var_C]

loc_1EA2_4162:				; CODE XREF: sub_1EA2_40C2+A6j
		mov	al, [bx]
		stosb
		add	bx, [bp+var_E]
		loop	loc_1EA2_4162
		inc	dx
		cmp	dx, [bp+var_E]
		jnz	short loc_1EA2_4158
		jmp	loc_1EA2_41F5
; ---------------------------------------------------------------------------

loc_1EA2_4173:				; CODE XREF: sub_1EA2_40C2+91j
					; sub_1EA2_40C2+CDj
					; DATA XREF: ...
		mov	bx, dx
		shr	bx, 1
		add	bx, 10h
		add	bx, si
		mov	cx, [bp+var_C]

loc_1EA2_417F:				; CODE XREF: sub_1EA2_40C2+C3j
		mov	al, [bx]
		stosb
		add	bx, [bp+var_E]
		loop	loc_1EA2_417F
		add	di, [bp+var_C]
		inc	dx
		inc	dx
		cmp	dx, [bp+var_E]
		jb	short loc_1EA2_4173
		mov	dx, 1
		mov	di, [bp+var_8]
		add	di, [bp+var_C]

loc_1EA2_419A:				; CODE XREF: sub_1EA2_40C2+F7j
		mov	bx, dx
		add	bx, [bp+var_E]
		shr	bx, 1
		add	bx, 10h
		add	bx, si
		mov	cx, [bp+var_C]

loc_1EA2_41A9:				; CODE XREF: sub_1EA2_40C2+EDj
		mov	al, [bx]
		stosb
		add	bx, [bp+var_E]
		loop	loc_1EA2_41A9
		add	di, [bp+var_C]
		inc	dx
		inc	dx
		cmp	dx, [bp+var_E]
		jb	short loc_1EA2_419A
		jmp	short loc_1EA2_41F5
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_41BE:				; CODE XREF: sub_1EA2_40C2+91j
					; sub_1EA2_40C2+131j
					; DATA XREF: ...
		mov	bx, dx
		shr	bx, 1
		add	bx, 10h
		add	bx, [bp+var_6]
		mov	cx, [bp+var_C]
		mov	si, [bp+var_E]
		shr	si, 1
		adc	si, 0

loc_1EA2_41D3:				; CODE XREF: sub_1EA2_40C2+116j
		mov	al, [bx]
		stosb
		add	bx, si
		loop	loc_1EA2_41D3
		inc	dx
		cmp	dx, [bp+var_E]
		jz	short loc_1EA2_41F5
		mov	cx, [bp+var_C]
		mov	si, [bp+var_E]
		shr	si, 1

loc_1EA2_41E8:				; CODE XREF: sub_1EA2_40C2+12Bj
		mov	al, [bx]
		stosb
		add	bx, si
		loop	loc_1EA2_41E8
		inc	dx
		cmp	dx, [bp+var_E]
		jnz	short loc_1EA2_41BE

loc_1EA2_41F5:				; CODE XREF: sub_1EA2_40C2+AEj
					; sub_1EA2_40C2+F9j ...
		mov	di, [bp+var_6]
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		add	di, 10h
		mov	si, [bp+var_8]
		mov	ds, [bp+var_A]
		mov	ax, [bp+var_C]
		mul	[bp+var_E]
		mov	cx, ax
		shr	cx, 1
		jb	short loc_1EA2_4216
		rep movsw
		jmp	loc_1EA2_412E
; ---------------------------------------------------------------------------

loc_1EA2_4216:				; CODE XREF: sub_1EA2_40C2+14Dj
		rep movsw
		movsb
		jmp	loc_1EA2_412E
sub_1EA2_40C2	endp

; ---------------------------------------------------------------------------
word_1EA2_421C	dw 0A0h	dup(0)		; DATA XREF: sub_1EA2_435C:loc_1EA2_43A1w
					; sub_1EA2_435C+4Cw ...

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_435C	proc far		; CODE XREF: UncompressFileR+B8J
					; DATA XREF: UncompressFileR+101o

var_210		= byte ptr -210h
var_110		= byte ptr -110h
var_E		= word ptr -0Eh
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		push	ds
		cld
		sub	sp, 200h
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+1]
		mov	[bp+var_2], ax
		mov	[bp+var_6], ax
		mov	al, [si+3]
		xor	ah, ah
		mov	[bp+var_4], ax
		mov	[bp+var_8], ax
		mov	al, [si+4]
		xor	ah, ah
		mov	[bp+var_A], ax
		and	ax, 7Fh
		add	si, 5
		mov	[bp+var_E], si
		lea	cx, word_1EA2_421C+40h
		shl	ax, 1
		mov	di, ax
		xor	bx, bx
		xor	dx, dx

loc_1EA2_43A1:				; CODE XREF: sub_1EA2_435C+66j
		mov	cs:word_1EA2_421C[bx], cx
		shl	dx, 1
		sub	cs:word_1EA2_421C[bx], dx
		lodsb
		xor	ah, ah
		add	dx, ax
		add	cx, ax
		or	ax, ax
		jz	short $+2
		mov	cs:(word_1EA2_421C+20h)[bx], dx
		add	bx, 2
		cmp	bx, di
		jl	short loc_1EA2_43A1
		sub	cx, (offset word_1EA2_421C+40h)
		mov	ax, cs
		mov	es, ax
		assume es:seg012
		mov	di, (offset word_1EA2_421C+40h)
		rep movsb
		push	si
		mov	bx, [bp+var_A]
		mov	bh, bl
		cmp	bh, 8
		jle	short loc_1EA2_43DE
		mov	bh, 8

loc_1EA2_43DE:				; CODE XREF: sub_1EA2_435C+7Ej
		xor	si, si
		mov	bl, 1
		mov	cl, 80h	; '€'
		mov	di, cs:word_1EA2_421C

loc_1EA2_43E9:				; CODE XREF: sub_1EA2_435C+B7j
		xchg	si, [bp+var_E]
		lodsb
		xchg	si, [bp+var_E]
		mov	dh, al
		or	al, al
		jz	short loc_1EA2_4409

loc_1EA2_43F6:				; CODE XREF: sub_1EA2_435C+AFj
		mov	ch, cl
		mov	dl, cs:[di]
		inc	di

loc_1EA2_43FC:				; CODE XREF: sub_1EA2_435C+ABj
		mov	[bp+si+var_110], dl
		mov	[bp+si+var_210], bl
		inc	si
		dec	ch
		jnz	short loc_1EA2_43FC

loc_1EA2_4409:				; CODE XREF: sub_1EA2_435C+98j
		dec	dh
		jg	short loc_1EA2_43F6
		shr	cl, 1
		inc	bl
		cmp	bl, bh
		jle	short loc_1EA2_43E9

loc_1EA2_4415:				; CODE XREF: sub_1EA2_435C+C3j
		mov	[bp+si+var_210], 40h ; '@'
		inc	si
		cmp	si, 100h
		jnz	short loc_1EA2_4415
		pop	si
		mov	bx, si
		mov	es, [bp+arg_6]
		assume es:nothing
		mov	di, [bp+arg_4]
		mov	dl, [bx]
		inc	bx
		mov	dh, [bx]
		inc	bx
		mov	ah, 8
		test	[bp+var_A], 80h
		jz	short loc_1EA2_443C
		jmp	loc_1EA2_4507
; ---------------------------------------------------------------------------

loc_1EA2_443C:				; CODE XREF: sub_1EA2_435C+DBj
					; sub_1EA2_435C+10Ej ...
		mov	si, dx
		and	si, 0FFh
		mov	cl, [bp+si+var_210]
		cmp	cl, 8
		ja	short loc_1EA2_4495
		mov	al, [bp+si+var_110]
		stosb
		cmp	cl, ah
		jle	short loc_1EA2_445F
		xchg	cl, ah
		rol	dx, cl
		xchg	cl, ah
		sub	cl, ah
		jmp	short loc_1EA2_4480
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_445F:				; CODE XREF: sub_1EA2_435C+F6j
					; sub_1EA2_435C+12Bj ...
		rol	dx, cl
		sub	ah, cl
		or	di, di
		jz	short loc_1EA2_4474

loc_1EA2_4467:				; CODE XREF: sub_1EA2_435C+122j
		dec	[bp+var_2]
		jnz	short loc_1EA2_443C
		dec	[bp+var_4]
		jge	short loc_1EA2_443C
		jmp	loc_1EA2_44F6
; ---------------------------------------------------------------------------

loc_1EA2_4474:				; CODE XREF: sub_1EA2_435C+109j
		mov	di, es
		add	di, 1000h
		mov	es, di
		assume es:nothing
		xor	di, di
		jmp	short loc_1EA2_4467
; ---------------------------------------------------------------------------

loc_1EA2_4480:				; CODE XREF: sub_1EA2_435C+100j
		mov	dh, [bx]
		inc	bx
		jz	short loc_1EA2_4489

loc_1EA2_4485:				; CODE XREF: sub_1EA2_435C+137j
		mov	ah, 8
		jmp	short loc_1EA2_445F
; ---------------------------------------------------------------------------

loc_1EA2_4489:				; CODE XREF: sub_1EA2_435C+127j
		mov	bx, ds
		add	bx, 1000h
		mov	ds, bx
		assume ds:nothing
		xor	bx, bx
		jmp	short loc_1EA2_4485
; ---------------------------------------------------------------------------

loc_1EA2_4495:				; CODE XREF: sub_1EA2_435C+EDj
		push	si
		push	bp
		mov	si, bx
		mov	bp, 0Eh
		mov	bh, dh
		xor	dh, dh
		xor	ch, ch

loc_1EA2_44A2:				; CODE XREF: sub_1EA2_435C+167j
					; sub_1EA2_435C+183j
		cmp	ah, 0
		jz	short loc_1EA2_44E1

loc_1EA2_44A7:				; CODE XREF: sub_1EA2_435C+18Cj
		cmp	ch, 0
		jz	short loc_1EA2_44B4
		mov	dh, bh
		mov	bx, si
		pop	bp
		pop	si
		jmp	short loc_1EA2_445F
; ---------------------------------------------------------------------------

loc_1EA2_44B4:				; CODE XREF: sub_1EA2_435C+14Ej
		shl	bh, 1
		rcl	dx, 1
		sub	ah, 1
		add	bp, 2
		cmp	dx, cs:(word_1EA2_421C+20h)[bp]
		jnb	short loc_1EA2_44A2
		add	dx, cs:word_1EA2_421C[bp]
		mov	bp, dx
		mov	al, cs:[bp+0]
		stosb
		mov	dh, bh
		mov	cl, ah
		rol	dx, cl
		mov	cl, 8
		sub	cl, ah
		mov	ah, 0
		mov	ch, 1
		jmp	short loc_1EA2_44A2
; ---------------------------------------------------------------------------

loc_1EA2_44E1:				; CODE XREF: sub_1EA2_435C+149j
		mov	bh, [si]
		inc	si
		jz	short loc_1EA2_44EA

loc_1EA2_44E6:				; CODE XREF: sub_1EA2_435C+198j
		mov	ah, 8
		jmp	short loc_1EA2_44A7
; ---------------------------------------------------------------------------

loc_1EA2_44EA:				; CODE XREF: sub_1EA2_435C+188j
		mov	si, ds
		add	si, 1000h
		mov	ds, si
		assume ds:nothing
		xor	si, si
		jmp	short loc_1EA2_44E6
; ---------------------------------------------------------------------------

loc_1EA2_44F6:				; CODE XREF: sub_1EA2_435C+115j
					; sub_1EA2_435C+1E4j
		mov	ax, [bp+var_6]
		mov	dx, [bp+var_8]
		add	sp, 200h
		pop	ds
		assume ds:dseg
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4507:				; CODE XREF: sub_1EA2_435C+DDj
					; sub_1EA2_435C+1DDj ...
		mov	si, dx
		and	si, 0FFh
		mov	cl, [bp+si+var_210]
		cmp	cl, 8
		ja	short loc_1EA2_4563
		mov	al, [bp+si+var_110]
		add	al, ch
		stosb
		cmp	cl, ah
		jle	short loc_1EA2_452C
		xchg	cl, ah
		rol	dx, cl
		xchg	cl, ah
		sub	cl, ah
		jmp	short loc_1EA2_454E
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_452C:				; CODE XREF: sub_1EA2_435C+1C3j
					; sub_1EA2_435C+1F9j ...
		rol	dx, cl
		sub	ah, cl
		or	di, di
		jz	short loc_1EA2_4542

loc_1EA2_4534:				; CODE XREF: sub_1EA2_435C+1F0j
		mov	ch, al
		dec	[bp+var_2]
		jnz	short loc_1EA2_4507
		dec	[bp+var_4]
		jge	short loc_1EA2_4507
		jmp	short loc_1EA2_44F6
; ---------------------------------------------------------------------------

loc_1EA2_4542:				; CODE XREF: sub_1EA2_435C+1D6j
		mov	di, es
		add	di, 1000h
		mov	es, di
		assume es:nothing
		xor	di, di
		jmp	short loc_1EA2_4534
; ---------------------------------------------------------------------------

loc_1EA2_454E:				; CODE XREF: sub_1EA2_435C+1CDj
		mov	dh, [bx]
		inc	bx
		jz	short loc_1EA2_4557

loc_1EA2_4553:				; CODE XREF: sub_1EA2_435C+205j
		mov	ah, 8
		jmp	short loc_1EA2_452C
; ---------------------------------------------------------------------------

loc_1EA2_4557:				; CODE XREF: sub_1EA2_435C+1F5j
		mov	bx, ds
		add	bx, 1000h
		mov	ds, bx
		assume ds:nothing
		xor	bx, bx
		jmp	short loc_1EA2_4553
; ---------------------------------------------------------------------------

loc_1EA2_4563:				; CODE XREF: sub_1EA2_435C+1B8j
		push	si
		push	bp
		mov	si, bx
		mov	bp, 0Eh
		mov	bh, dh
		xor	dh, dh
		mov	[bp+var_E], 0

loc_1EA2_4573:				; CODE XREF: sub_1EA2_435C+239j
					; sub_1EA2_435C+25Aj
		cmp	ah, 0
		jz	short loc_1EA2_45B8

loc_1EA2_4578:				; CODE XREF: sub_1EA2_435C+263j
		cmp	[bp+var_E], 0
		jz	short loc_1EA2_4586
		mov	dh, bh
		mov	bx, si
		pop	bp
		pop	si
		jmp	short loc_1EA2_452C
; ---------------------------------------------------------------------------

loc_1EA2_4586:				; CODE XREF: sub_1EA2_435C+220j
		shl	bh, 1
		rcl	dx, 1
		sub	ah, 1
		add	bp, 2
		cmp	dx, cs:(word_1EA2_421C+20h)[bp]
		jnb	short loc_1EA2_4573
		add	dx, cs:word_1EA2_421C[bp]
		mov	bp, dx
		mov	al, cs:[bp+0]
		add	al, ch
		stosb
		mov	dh, bh
		mov	cl, ah
		rol	dx, cl
		mov	cl, 8
		sub	cl, ah
		mov	ah, 0
		mov	[bp+var_E], 1
		jmp	short loc_1EA2_4573
; ---------------------------------------------------------------------------

loc_1EA2_45B8:				; CODE XREF: sub_1EA2_435C+21Aj
		mov	bh, [si]
		inc	si
		jz	short loc_1EA2_45C1

loc_1EA2_45BD:				; CODE XREF: sub_1EA2_435C+26Fj
		mov	ah, 8
		jmp	short loc_1EA2_4578
; ---------------------------------------------------------------------------

loc_1EA2_45C1:				; CODE XREF: sub_1EA2_435C+25Fj
		mov	si, ds
		add	si, 1000h
		mov	ds, si
		assume ds:nothing
		xor	si, si
		jmp	short loc_1EA2_45BD
sub_1EA2_435C	endp

; ---------------------------------------------------------------------------
		align 2
; [0000000E BYTES: COLLAPSED FUNCTION VertRetrace. PRESS KEYPAD	"+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


GetVideoStatus	proc far		; CODE XREF: RandomWait+8P
					; RandomWait:loc_29E1_467P
		mov	dx, 3DAh
GetVideoStatus	endp

		in	al, dx		; Video	status bits:
					; 0: retrace.  1=display is in vert or horiz retrace.
					; 1: 1=light pen is triggered; 0=armed
					; 2: 1=light pen switch	is open; 0=closed
					; 3: 1=vertical	sync pulse is occurring.
		and	al, 8
		xor	ah, ah
		retf
; ---------------------------------------------------------------------------
		align 2
; [0000000D BYTES: COLLAPSED FUNCTION sub_1EA2_45E6. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

VectorOp3	proc far		; CODE XREF: TrkPlanSimd+61CP
					; TrkPlanSimd+CCAP ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
p_pOutVec	= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		push	di
		mov	ax, [bp+arg_6]

loc_1EA2_45FF:				; CODE XREF: sub_1EA2_45E6+Bj
		mov	si, [bp+arg_0]
		mov	bx, [bp+arg_2]
		mov	di, [bp+p_pOutVec]
		mov	[di+Vector3D.wZ], ax
		sub	ax, [bx+4]
		mov	[bp+var_4], ax
		mov	ax, [si+4]
		sub	ax, [bx+4]
		or	ax, ax
		jge	short loc_1EA2_4620
		shr	[bp+var_4], 1
		shr	ax, 1

loc_1EA2_4620:				; CODE XREF: VectorOp3+25j
		mov	[bp+var_2], ax
		mov	ax, [si]
		sub	ax, [bx]
		imul	[bp+var_4]
		idiv	[bp+var_2]
		add	ax, [bx]
		mov	[di+Vector3D.wX], ax
		mov	ax, [si+2]
		sub	ax, [bx+2]
		imul	[bp+var_4]
		idiv	[bp+var_2]
		add	ax, [bx+2]
		mov	[di+Vector3D.wY], ax
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
VectorOp3	endp

; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	ax, [bp+6]
		mov	ds:4E92h, ax

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpritePutpixel	proc far		; CODE XREF: sub_14D6_1296+1DCP

var_79A		= byte ptr -79Ah
var_3DA		= byte ptr -3DAh
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h

		push	bp
		mov	bp, sp
		sub	sp, 79Ah
		push	si
		push	di
		mov	dx, [bp+arg_4]
		mov	ax, dx
		shr	ax, 1
		shr	ax, 1
		sub	dx, ax
		shr	ax, 1
		shr	ax, 1
		add	dx, ax
		or	dx, dx
		jg	short loc_1EA2_4676
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4676:				; CODE XREF: SpritePutpixel+1Cj
		mov	[bp+var_6], dx
		mov	bx, dx
		shr	dx, 1
		jnz	short loc_1EA2_4696
		push	[bp+arg_6]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	PutPixel
		add	sp, 6

loc_1EA2_4690:				; CODE XREF: SpritePutpixel+61j
					; SpritePutpixel+6Dj ...
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4696:				; CODE XREF: SpritePutpixel+2Bj
		sub	bx, dx
		mov	ax, cs:g_pSprite1.dwLeft2
		mov	[bp+var_4], ax
		mov	ax, cs:g_pSprite1.dwWidthSum
		dec	ax
		mov	[bp+var_2], ax
		mov	cx, [bp+arg_2]
		mov	ax, cx
		sub	ax, dx
		cmp	ax, cs:g_pSprite1.dwHeight
		jge	short loc_1EA2_4690
		mov	[bp+var_14], ax
		add	cx, bx
		cmp	cx, cs:g_pSprite1.dwTop
		jle	short loc_1EA2_4690
		mov	dx, bx
		mov	ax, dx
		shr	ax, 1
		shr	ax, 1
		add	dx, ax
		mov	cx, [bp+arg_0]
		mov	ax, cx
		sub	ax, dx
		cmp	ax, [bp+var_2]
		jg	short loc_1EA2_4690
		add	cx, dx
		cmp	cx, [bp+var_4]
		jl	short loc_1EA2_4690
		cmp	bx, ds:3C56h
		jl	short loc_1EA2_4728
		mov	ax, [bp+arg_0]
		mov	[bp+var_12], ax
		mov	[bp+var_E], ax
		mov	dx, [bp+arg_4]
		shr	dx, 1
		add	ax, dx
		mov	[bp+var_A], ax
		mov	ax, [bp+arg_2]
		mov	[bp+var_10], ax
		mov	[bp+var_8], ax
		mov	dx, [bp+var_6]
		shr	dx, 1
		add	ax, dx
		mov	[bp+var_C], ax
		mov	dx, [bp+arg_6]
		lea	ax, [bp+var_12]
		add	sp, 780h
		push	dx
		push	ax
		call	sub_26BB_E
		add	sp, 4
		sub	sp, 780h
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4728:				; CODE XREF: SpritePutpixel+90j
		shl	bx, 1
		mov	ax, ds:g_pIncSizeTbls[bx]
		mov	[bp+var_16], ax
		mov	ax, [bp+var_6]
		mov	[bp+var_1A], ax
		dec	ax
		shl	ax, 1
		mov	[bp+var_18], ax
		lea	si, [bp+var_3DA]
		lea	di, [bp+var_79A]

loc_1EA2_4745:				; CODE XREF: SpritePutpixel+136j
					; SpritePutpixel+146j
		mov	bx, [bp+var_16]
		mov	dl, [bx]
		inc	[bp+var_16]
		xor	dh, dh
		mov	bx, [bp+var_18]
		mov	ax, [bp+arg_0]
		sub	ax, dx
		cmp	ax, [bp+var_2]
		jg	short loc_1EA2_478D
		cmp	ax, [bp+var_4]
		jge	short loc_1EA2_4764
		mov	ax, [bp+var_4]

loc_1EA2_4764:				; CODE XREF: SpritePutpixel+10Dj
		mov	[si], ax
		mov	[bx+si], ax
		mov	ax, [bp+arg_0]
		add	ax, dx
		cmp	ax, [bp+var_4]
		jl	short loc_1EA2_478D
		cmp	ax, [bp+var_2]
		jle	short loc_1EA2_477A
		mov	ax, [bp+var_2]

loc_1EA2_477A:				; CODE XREF: SpritePutpixel+123j
		mov	[di], ax
		mov	[bx+di], ax
		add	si, 2
		add	di, 2
		sub	[bp+var_18], 4
		jge	short loc_1EA2_4745
		jmp	short loc_1EA2_47A0
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_478D:				; CODE XREF: SpritePutpixel+108j
					; SpritePutpixel+11Ej
		inc	[bp+var_14]
		sub	[bp+var_1A], 2
		sub	[bp+var_18], 4
		jge	short loc_1EA2_4745
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_47A0:				; CODE XREF: SpritePutpixel+138j
		xor	dx, dx
		mov	ax, cs:g_pSprite1.dwTop
		sub	ax, [bp+var_14]
		jle	short loc_1EA2_47B9
		sub	[bp+var_1A], ax
		shl	ax, 1
		mov	dx, ax
		mov	ax, cs:g_pSprite1.dwTop
		mov	[bp+var_14], ax

loc_1EA2_47B9:				; CODE XREF: SpritePutpixel+157j
		mov	ax, [bp+var_14]
		add	ax, [bp+var_1A]
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_47C9
		sub	[bp+var_1A], ax

loc_1EA2_47C9:				; CODE XREF: SpritePutpixel+172j
		push	[bp+arg_6]
		push	[bp+var_1A]
		push	[bp+var_14]
		lea	ax, [bp+var_79A]
		add	ax, dx
		push	ax
		lea	ax, [bp+var_3DA]
		add	ax, dx
		push	ax
		call	SpriteOp3
		add	sp, 0Ah
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
SpritePutpixel	endp

; [00000071 BYTES: COLLAPSED FUNCTION InitSprite. PRESS	KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetSprite1Size	proc far		; CODE XREF: LoadIntroRes+679P
					; LoadIntroRes+6B5P ...

arg_0		= word ptr  6
dwWidth		= word ptr  8
arg_4		= word ptr  0Ah
dwHeight	= word ptr  0Ch

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		mov	cs:g_pSprite1.dwLeft2, ax
		mov	cs:g_pSprite1.dwLeft, ax
		mov	ax, [bp+dwWidth]
		mov	cs:g_pSprite1.dwWidthSum, ax ; replacing 320
		mov	cs:g_pSprite1.dwWidth1,	ax ; replacing 320
		mov	ax, [bp+arg_4]
		mov	cs:g_pSprite1.dwTop, ax
		mov	ax, [bp+dwHeight]
		mov	cs:g_pSprite1.dwHeight,	ax ; replacing 200
		pop	bp
		retf
SetSprite1Size	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ClearScreenClr	proc far		; CODE XREF: SetBiosMode3+3P
					; VideoAtExit+28P ...

p_wColorIndex	= word ptr  6

		push	bp
		mov	bp, sp
		push	di
		mov	ax, 0A000h	; A000 = address of video memory
		mov	es, ax
		assume es:nothing
		mov	ax, [bp+p_wColorIndex]
		mov	di, 0
		mov	cx, 0FA00h	; 320 *	200 = 0xFA00 / 64000
		rep stosw
		pop	di
		pop	bp
		retf
ClearScreenClr	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ClearSprite1Col	proc far		; CODE XREF: LoadIntroRes+684P
					; LoadIntroRes+757P ...

cColor		= byte ptr  6

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2 ; Is this 0xA000?
		mov	es, ax
		mov	dx, cs:g_pSprite1.dwHeight ; 200?
		mov	bx, cs:g_pSprite1.dwTop	; 0?
		sub	dx, bx
		jle	short loc_1EA2_48ED
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets	; 5F5C?
		mov	di, cs:[bx]
		add	di, cs:g_pSprite1.dwLeft ; 0
		mov	bx, cs:g_pSprite1.dwWidth1 ; 320
		sub	bx, cs:g_pSprite1.dwLeft
		jle	short loc_1EA2_48ED
		mov	si, cs:g_pSprite1.dwWidth2 ; 320
		sub	si, bx
		mov	al, [bp+cColor]
		mov	ah, al
		shr	bx, 1
		jb	short loc_1EA2_48F1

loc_1EA2_48E4:				; CODE XREF: ClearSprite1Col+4Bj
		mov	cx, bx
		rep stosw
		add	di, si
		dec	dx
		jg	short loc_1EA2_48E4

loc_1EA2_48ED:				; CODE XREF: ClearSprite1Col+17j
					; ClearSprite1Col+32j ...
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_48F1:				; CODE XREF: ClearSprite1Col+42j
		jz	short loc_1EA2_4904
		jl	short loc_1EA2_48ED
		inc	si

loc_1EA2_48F6:				; CODE XREF: ClearSprite1Col+60j
		mov	cx, bx
		rep stosw
		mov	es:[di], al
		add	di, si
		dec	dx
		jg	short loc_1EA2_48F6
		jmp	short loc_1EA2_48ED
; ---------------------------------------------------------------------------

loc_1EA2_4904:				; CODE XREF: ClearSprite1Col:loc_1EA2_48F1j
		inc	si

loc_1EA2_4905:				; CODE XREF: ClearSprite1Col+6Bj
		mov	es:[di], al
		add	di, si
		dec	dx
		jg	short loc_1EA2_4905
		jmp	short loc_1EA2_48ED
ClearSprite1Col	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteFlagOp	proc far

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= byte ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+arg_C]
		mov	g_wSpriteOpFlag, ax
		mov	ax, [bp+arg_A]
		mov	byte ptr word_2B77_4BB0, al
		jmp	short loc_1EA2_4929
SpriteFlagOp	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp6	proc far		; DATA XREF: DeriveSpriteOpReset+3Bo

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= byte ptr  0Eh

		push	bp
		mov	bp, sp
		push	si
		push	di

loc_1EA2_4929:				; CODE XREF: SpriteFlagOp+11j
		cld
		mov	si, [bp+arg_4]
		test	si, 1
		jnz	short loc_1EA2_493B
		mov	ax, g_wSpriteOpFlag
		xchg	ah, al
		mov	g_wSpriteOpFlag, ax

loc_1EA2_493B:				; CODE XREF: SpriteOp6+Dj
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		mov	al, [bp+arg_8]

loc_1EA2_494E:				; CODE XREF: SpriteOp6+6Ej
		mov	bx, [bp+arg_2]
		mov	dx, [bx]
		mov	bx, [bp+arg_0]
		mov	bx, [bx]
		mov	ah, byte ptr g_wSpriteOpFlag
		mov	cl, bl
		and	cl, 7
		rol	ah, cl
		mov	cx, dx
		mov	dl, byte ptr word_2B77_4BB0
		sub	cx, bx
		inc	cx
		jle	short loc_1EA2_497A
		mov	di, cs:[si]
		add	di, bx

loc_1EA2_4973:				; CODE XREF: SpriteOp6+54j
					; SpriteOp6+78j
		rol	ah, 1
		jb	short loc_1EA2_4998
		stosb
		loop	loc_1EA2_4973

loc_1EA2_497A:				; CODE XREF: SpriteOp6+48j
					; SpriteOp6+7Aj
		add	[bp+arg_2], 2
		add	[bp+arg_0], 2
		add	si, 2
		mov	dx, g_wSpriteOpFlag
		xchg	dh, dl
		mov	g_wSpriteOpFlag, dx
		dec	[bp+arg_6]
		jg	short loc_1EA2_494E
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4998:				; CODE XREF: SpriteOp6+51j
		mov	es:[di], dl
		inc	di
		loop	loc_1EA2_4973
		jmp	short loc_1EA2_497A
SpriteOp6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp5	proc far		; CODE XREF: ImageResetRende+32P
					; DATA XREF: sub_1EA2_3519+13o	...

var_E		= byte ptr -0Eh
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	si
		push	di
		mov	si, [bp+arg_0]
		mov	ax, [si]
		mov	dx, [si+2]
		add	ax, 8000h
		adc	dx, 0
		mov	[bp+var_2], ax
		mov	[bp+var_4], dx
		mov	ax, [si+4]
		mov	dx, [si+6]
		add	ax, 8000h
		adc	dx, 0
		mov	[bp+var_6], ax
		mov	[bp+var_8], dx
		mov	al, [si+10h]
		mov	[bp+var_E], al
		mov	ax, [si+0Ch]
		mov	[bp+var_A], ax
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax		; es = 0xA000
		mov	bx, [si+12h]
		shl	bx, 1
		jmp	cs:off_1EA2_49EA[bx]
; ---------------------------------------------------------------------------
off_1EA2_49EA	dw offset loc_1EA2_49FE	; DATA XREF: SpriteOp5+45r
		dw offset loc_1EA2_49FE
		dw offset loc_1EA2_4A38
		dw offset loc_1EA2_4A5C
		dw offset loc_1EA2_4A81
		dw offset loc_1EA2_4AA6
		dw offset loc_1EA2_4AD3
		dw offset loc_1EA2_4B00
		dw offset loc_1EA2_4B2C
		dw offset loc_1EA2_4A1C
; ---------------------------------------------------------------------------

loc_1EA2_49FE:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5:off_1EA2_49EAo ...
		mov	cx, [si+0Eh]
		mov	al, [bp+var_E]
		mov	di, [bp+var_8]
		shl	di, 1
		add	di, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[di]
		add	di, [bp+var_4]
		rep stosb
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4A1C:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+5Co
		mov	al, [bp+var_E]
		mov	di, [bp+var_8]
		shl	di, 1
		add	di, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[di]
		add	di, [bp+var_4]
		mov	es:[di], al
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4A38:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+4Eo
		mov	cx, [si+0Eh]
		mov	al, [bp+var_E]
		mov	bx, [bp+var_4]
		mov	si, [si+6]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets

loc_1EA2_4A4B:				; CODE XREF: SpriteOp5+B4j
		mov	di, cs:[si]
		mov	es:[bx+di], al
		add	si, 2
		loop	loc_1EA2_4A4B
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4A5C:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+50o
		mov	cx, [si+0Eh]
		mov	al, [bp+var_E]
		mov	si, [si+6]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	bx, [bp+var_4]

loc_1EA2_4A6F:				; CODE XREF: SpriteOp5+D9j
		mov	di, cs:[si]
		mov	es:[bx+di], al
		dec	bx
		add	si, 2
		loop	loc_1EA2_4A6F
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4A81:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+52o
		mov	cx, [si+0Eh]
		mov	al, [bp+var_E]
		mov	si, [si+6]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	bx, [bp+var_4]

loc_1EA2_4A94:				; CODE XREF: SpriteOp5+FEj
		mov	di, cs:[si]
		mov	es:[bx+di], al
		inc	bx
		add	si, 2
		loop	loc_1EA2_4A94
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4AA6:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+54o
		mov	cx, [si+0Eh]
		mov	dx, [bp+var_A]
		mov	al, [bp+var_E]
		mov	si, [si+6]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	bx, [bp+var_4]

loc_1EA2_4ABC:				; CODE XREF: SpriteOp5+12Bj
		mov	di, cs:[si]
		mov	es:[bx+di], al
		add	si, 2
		sub	[bp+var_2], dx
		sbb	bx, 0
		loop	loc_1EA2_4ABC
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4AD3:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+56o
		mov	cx, [si+0Eh]
		mov	dx, [bp+var_A]
		mov	al, [bp+var_E]
		mov	si, [si+6]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	bx, [bp+var_4]

loc_1EA2_4AE9:				; CODE XREF: SpriteOp5+158j
		mov	di, cs:[si]
		mov	es:[bx+di], al
		add	si, 2
		add	[bp+var_2], dx
		adc	bx, 0
		loop	loc_1EA2_4AE9
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4B00:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+58o
		mov	cx, [si+0Eh]
		mov	dx, [bp+var_A]
		mov	al, [bp+var_E]
		mov	bx, [bp+var_4]

loc_1EA2_4B0C:				; CODE XREF: SpriteOp5+184j
		mov	si, [bp+var_8]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[si]
		mov	es:[bx+di], al
		dec	bx
		add	[bp+var_6], dx
		adc	[bp+var_8], 0
		loop	loc_1EA2_4B0C
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4B2C:				; CODE XREF: SpriteOp5+45j
					; DATA XREF: SpriteOp5+5Ao
		mov	cx, [si+0Eh]
		mov	dx, [bp+var_A]
		mov	al, [bp+var_E]
		mov	bx, [bp+var_4]

loc_1EA2_4B38:				; CODE XREF: SpriteOp5+1B0j
		mov	si, [bp+var_8]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[si]
		mov	es:[bx+di], al
		inc	bx
		add	[bp+var_6], dx
		adc	[bp+var_8], 0
		loop	loc_1EA2_4B38
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
SpriteOp5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteSizeOp	proc far		; CODE XREF: LoadIntroRes+644P
					; sub_261B_C+2FP ...

arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	dx, cs:g_pSprite1.dwLeft
		mov	ax, dx
		sub	ax, [bp+arg_2]
		jle	short loc_1EA2_4B71
		mov	[bp+arg_2], dx
		sub	[bp+arg_6], ax
		jle	short near ptr JumpPopRetMetho

loc_1EA2_4B71:				; CODE XREF: SpriteSizeOp+Fj
		mov	ax, [bp+arg_2]
		add	ax, [bp+arg_6]
		sub	ax, cs:g_pSprite1.dwWidth1
		jle	short loc_1EA2_4B83
		sub	[bp+arg_6], ax
		jle	short near ptr JumpPopRetMetho

loc_1EA2_4B83:				; CODE XREF: SpriteSizeOp+24j
		mov	ax, cs:g_pSprite1.dwTop
		sub	ax, [bp+arg_4]
		jle	short loc_1EA2_4B98
		sub	[bp+arg_8], ax
		jle	short near ptr JumpPopRetMetho
		mov	ax, cs:g_pSprite1.dwTop
		mov	[bp+arg_4], ax

loc_1EA2_4B98:				; CODE XREF: SpriteSizeOp+32j
		mov	ax, [bp+arg_4]
		add	ax, [bp+arg_8]
		mov	bx, cs:g_pSprite1.dwHeight
		sub	ax, bx
		jle	short loc_1EA2_4BB7
		sub	[bp+arg_8], ax
		jle	short near ptr JumpPopRetMetho
		jmp	short loc_1EA2_4BB7
SpriteSizeOp	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================


JumpPopRetMetho	proc far		; CODE XREF: SpriteSizeOp+17j
					; SpriteSizeOp+29j ...
		jmp	short loc_1EA2_4C02
JumpPopRetMetho	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp	proc far		; CODE XREF: RplyMouseSpriteStuff+28EP
					; RplyMouseSpriteStuff+2A8P ...

var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= byte ptr  0Eh

		push	bp
		mov	bp, sp
		push	si
		push	di

loc_1EA2_4BB7:				; CODE XREF: SpriteSizeOp+4Dj
					; SpriteSizeOp+54j
		cld
		cmp	[bp+arg_4], 0
		jle	short near ptr JumpPopRetMetho
		cmp	[bp+arg_6], 0
		jle	short near ptr JumpPopRetMetho
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		mov	al, [bp+arg_8]
		mov	ah, al
		mov	dx, [bp+arg_0]
		mov	si, [bp+arg_6]
		mov	bx, [bp+arg_2]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+arg_0]
		mov	dx, cs:g_pSprite1.dwWidth2
		sub	dx, [bp+arg_4]
		mov	cx, [bp+arg_4]
		sar	cx, 1
		mov	[bp+arg_4], cx
		jb	short loc_1EA2_4C06
		jle	short loc_1EA2_4C02

loc_1EA2_4BF8:				; CODE XREF: SpriteOp+4Ej
		mov	cx, [bp+arg_4]
		rep stosw
		add	di, dx
		dec	si
		jg	short loc_1EA2_4BF8

loc_1EA2_4C02:				; CODE XREF: JumpPopRetMethoj
					; SpriteOp+44j	...
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4C06:				; CODE XREF: SpriteOp+42j
		jz	short loc_1EA2_4C1A
		jl	short loc_1EA2_4C02
		inc	dx

loc_1EA2_4C0B:				; CODE XREF: SpriteOp+64j
		mov	cx, [bp+arg_4]
		rep stosw
		mov	es:[di], al
		add	di, dx
		dec	si
		jg	short loc_1EA2_4C0B
		jmp	short loc_1EA2_4C02
; ---------------------------------------------------------------------------

loc_1EA2_4C1A:				; CODE XREF: SpriteOp:loc_1EA2_4C06j
		inc	dx

loc_1EA2_4C1B:				; CODE XREF: SpriteOp+6Fj
		mov	es:[di], al
		add	di, dx
		dec	si
		jg	short loc_1EA2_4C1B
		jmp	short loc_1EA2_4C02
; ---------------------------------------------------------------------------
		add	[bp+di], cl
		add	ax, 208h
		or	al, [si]
		pop	es
		assume es:nothing
		add	[bx+di], cx
		add	ax, word ptr g_pcData20Trak2+12h
		add	ax, [bx+si]
		add	al, [bp+di]
		add	[si], ax
		add	dl, [di-75h]
		in	al, dx
		sub	sp, 16h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		assume es:nothing
		mov	ax, [bp+arg_6]
		mov	[bp+var_2], ax
		mov	ax, word ptr [bp+arg_8]
		jmp	short loc_1EA2_4C77
SpriteOp	endp

; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

BitmapOp	proc far		; CODE XREF: MouseStuff+47P

var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pBitmap	= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+p_pBitmap]
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		mov	ax, [si+Shape2D.dwPosX]
		mov	[bp+var_2], ax
		mov	ax, [si+Shape2D.dwPosY]

loc_1EA2_4C77:				; CODE XREF: SpriteOp+A5j
		shl	ax, 1
		add	ax, cs:g_pSprite1.pwLineOffsets
		mov	[bp+var_4], ax
		add	ax, [si+Shape2D.dwHeight]
		add	ax, [si+Shape2D.dwHeight]
		mov	[bp+var_6], ax
		mov	ax, [si]
		mov	[bp+var_8], ax
		mov	bx, 0Ch
		mul	bx
		mov	[bp+var_A], ax
		add	si, 10h
		mov	[bp+var_C], si
		mov	[bp+var_E], 0Bh

loc_1EA2_4CA2:				; CODE XREF: BitmapOp+BFj
		mov	di, [bp+var_E]
		mov	cl, byte ptr cs:unk_2B77_4C26[di]
		xor	ch, ch
		mov	ax, [bp+var_8]
		mul	cx
		mov	[bp+var_10], ax
		shl	cx, 1
		add	cx, [bp+var_4]
		mov	[bp+var_12], cx
		mov	si, [bp+var_C]
		add	si, [bp+var_10]
		mov	bx, [bp+arg_4]
		mov	[bp+var_16], bx

loc_1EA2_4CC8:				; CODE XREF: BitmapOp+B7j
		mov	di, [bp+var_12]
		cmp	di, [bp+var_6]
		jnb	short loc_1EA2_4D13
		mov	di, cs:[di]
		add	di, [bp+var_2]
		mov	cx, [bp+var_8]
		mov	[bp+var_14], si
		xor	ah, ah
		mov	bx, [bp+var_16]

loc_1EA2_4CE1:				; CODE XREF: BitmapOp+A8j
		and	bx, 3
		mov	al, byte ptr cs:unk_2B77_4C32[bx]
		sub	cx, ax
		jle	short loc_1EA2_4D04
		add	si, ax
		add	di, ax
		mov	al, [si]
		mov	es:[di], al
		mov	al, byte ptr cs:unk_2B77_4C36[bx]
		add	si, ax
		add	di, ax
		sub	cx, ax
		inc	bx
		jmp	short loc_1EA2_4CE1
; ---------------------------------------------------------------------------

loc_1EA2_4D04:				; CODE XREF: BitmapOp+91j
		inc	[bp+var_16]
		add	[bp+var_12], 18h
		mov	si, [bp+var_14]
		add	si, [bp+var_A]
		jmp	short loc_1EA2_4CC8
; ---------------------------------------------------------------------------

loc_1EA2_4D13:				; CODE XREF: BitmapOp+74j
		inc	[bp+arg_4]
		dec	[bp+var_E]
		jge	short loc_1EA2_4CA2
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
BitmapOp	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FontTextOp	proc far		; CODE XREF: RunTracksMenu+1C0P
					; RunTracksMenu+1D8P ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	ds
		push	si
		push	di
		mov	ds, g_segFontDef
		mov	ax, [bp+arg_2]
		mov	word ptr aMsRunTimeLibra, ax ; "MS Run-Time Library - Copyright	(c) 198"...
		mov	ax, [bp+arg_4]
		mov	word ptr aMsRunTimeLibra+2, ax
		jmp	short loc_1EA2_4D4B
FontTextOp	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_4D3E	proc far

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	ds
		push	si
		push	di
		mov	ds, g_segFontDef

loc_1EA2_4D4B:				; CODE XREF: FontTextOp+19j
		cld
		mov	es, word ptr cs:g_pSprite1.pBitmap+2

loc_1EA2_4D51:				; CODE XREF: sub_1EA2_4D3E+37j
					; sub_1EA2_4D3E+46j ...
		mov	si, [bp+arg_0]
		mov	bl, ss:[si]
		cmp	bl, 0
		jz	short loc_1EA2_4D86
		mov	al, bl
		inc	[bp+arg_0]
		xor	bh, bh
		shl	bx, 1
		add	bx, offset unk_2B1F_16
		mov	si, [bx]
		cmp	si, 0
		jnz	short loc_1EA2_4D8D
		cmp	al, 0Dh
		jz	short loc_1EA2_4D77
		cmp	al, 0Ah
		jnz	short loc_1EA2_4D51

loc_1EA2_4D77:				; CODE XREF: sub_1EA2_4D3E+33j
		mov	ax, ds:word_2B1F_4
		mov	ds:word_2B1F_8,	ax
		mov	ax, ds:word_2B1F_12
		add	ds:word_2B1F_A,	ax
		jmp	short loc_1EA2_4D51
; ---------------------------------------------------------------------------

loc_1EA2_4D86:				; CODE XREF: sub_1EA2_4D3E+1Cj
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4D8D:				; CODE XREF: sub_1EA2_4D3E+2Fj
		mov	ax, ds:word_2B1F_8
		mov	[bp+var_2], ax
		cmp	ds:byte_2B1F_14, 0
		jz	short loc_1EA2_4DAE
		mov	al, byte ptr ds:word_2B1F_0[si]
		xor	ah, ah
		inc	si
		mov	ds:word_2B1F_10, ax
		add	ax, 7
		shr	ax, 1
		shr	ax, 1
		shr	ax, 1
		mov	ds:byte_2B1F_C,	al

loc_1EA2_4DAE:				; CODE XREF: sub_1EA2_4D3E+5Aj
		mov	al, byte ptr ds:word_2B1F_0
		mov	ah, byte ptr ds:word_2B1F_2
		mov	cx, ds:word_2B1F_E
		mov	[bp+var_4], cx
		mov	bx, ds:word_2B1F_A
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets

loc_1EA2_4DC7:				; CODE XREF: sub_1EA2_4D3E+ACj
		mov	di, cs:word_2B1F_0[bx]
		add	di, [bp+var_2]
		mov	dh, ds:byte_2B1F_C

loc_1EA2_4DD1:				; CODE XREF: sub_1EA2_4D3E+A5j
		mov	cx, 8
		mov	dl, byte ptr ds:word_2B1F_0[si]

loc_1EA2_4DD6:				; CODE XREF: sub_1EA2_4D3E+A0j
		shl	dl, 1
		jnb	short loc_1EA2_4DDD
		mov	es:[di], al

loc_1EA2_4DDD:				; CODE XREF: sub_1EA2_4D3E+9Aj
		inc	di
		loop	loc_1EA2_4DD6
		inc	si
		dec	dh
		jg	short loc_1EA2_4DD1
		inc	bx
		inc	bx
		dec	[bp+var_4]
		jg	short loc_1EA2_4DC7
		mov	ax, ds:word_2B1F_10
		add	ds:word_2B1F_8,	ax
		jmp	loc_1EA2_4D51
sub_1EA2_4D3E	endp


; =============== S U B	R O U T	I N E =======================================


CallBiosMode13h	proc far		; CODE XREF: SetVideoMode:loc_29E1_26AP
		call	AddVideoExitHan
		mov	ax, 40h	; '@'
		mov	es, ax
		assume es:nothing
		mov	ax, es:10h
		and	ax, 0FFCFh
		or	ax, 10h
		mov	es:10h,	ax
		mov	ah, 0Bh
		mov	bx, 0
		int	10h		; - VIDEO - SET	COLOR PALETTE
					; BH = 00h, BL = border	color
					; BH = 01h, BL = palette (0-3)
		mov	ah, 0
		mov	al, 13h
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		xor	ax, ax
		push	ax
		push	ax
		call	ClearScreenClr
		add	sp, 4
		retf
CallBiosMode13h	endp

; [00000005 BYTES: COLLAPSED FUNCTION sub_1EA2_4E28. PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


AltLoad2dShapeR	proc near		; CODE XREF: LoadResource+55P
		jmp	far ptr	loc_2ACD_1C
AltLoad2dShapeR	endp

; [00000005 BYTES: COLLAPSED FUNCTION j_Load2DShapeRes.	PRESS KEYPAD "+" TO EXPAND]
; [00000005 BYTES: COLLAPSED FUNCTION j_Maybe2dShParse.	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


j__Load2DShape_1 proc near		; CODE XREF: RunCarMenu+239P
					; LoadSkybox+44P ...
		jmp	_Load2DShape_1
j__Load2DShape_1 endp


; =============== S U B	R O U T	I N E =======================================


DoLoad2DShape_0	proc far		; CODE XREF: LoadResource+4BP
					; DoLoad2DShape_1+6P
		jmp	_Load2DShape_0
DoLoad2DShape_0	endp

; [00000005 BYTES: COLLAPSED FUNCTION j_Load2DShape. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoMaybePutImageAnd proc	far		; CODE XREF: SetupCarShapes+407P
					; SetupCarShapes+941P

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		sub	ax, [si+4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		sub	ax, [si+6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_4EA9
DoMaybePutImageAnd endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybePutImageAnd proc far		; CODE XREF: UsesMousePos+52P
					; DoTrakdata15_14+114P	...

var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
p_pOfs		= word ptr  6
p_pSeg		= word ptr  8
p_x		= word ptr  0Ah
p_y		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+p_pSeg]
		mov	si, [bp+p_pOfs]
		mov	ax, [bp+p_x]
		mov	[bp+var_2], ax
		mov	ax, [bp+p_y]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_4EA9
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp

loc_1EA2_4E91:
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+p_pSeg]
		mov	si, [bp+p_pOfs]
		mov	ax, [si+Sprite.field_8]
		mov	[bp+var_2], ax
		mov	ax, [si+Sprite.pwLineOffsets]
		mov	[bp+var_4], ax

loc_1EA2_4EA9:				; CODE XREF: DoMaybePutImageAnd+21j
					; MaybePutImageAnd+1Bj
		mov	bx, [bp+var_4]
		mov	cx, word ptr [si+(Sprite.pBitmap+2)]
		lea	dx, [si+Sprite.dwTop]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_4ECF
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_4EF6
		sub	cx, ax
		jg	short loc_1EA2_4EF6

loc_1EA2_4EC8:				; CODE XREF: MaybePutImageAnd+68j
					; MaybePutImageAnd+84j	...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_4ECF:				; CODE XREF: MaybePutImageAnd+49j
		mov	bx, cs:g_pSprite1.dwTop
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_4EC8
		xchg	ax, cx
		sub	ax, cx
		mov	[bp+var_8], dx
		mul	word ptr [si]
		mov	dx, [bp+var_8]
		add	dx, ax
		mov	ax, bx
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_4EF6
		sub	cx, ax
		jle	short loc_1EA2_4EC8

loc_1EA2_4EF6:				; CODE XREF: MaybePutImageAnd+52j
					; MaybePutImageAnd+56j	...
		mov	[bp+var_C], dx
		mov	[bp+var_A], cx
		mov	[bp+var_4], bx
		mov	cx, [si]
		xor	dx, dx
		mov	bx, [bp+var_2]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwLeft
		jl	short loc_1EA2_4F21
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwWidth1
		jl	short loc_1EA2_4F48
		sub	cx, ax
		jle	short loc_1EA2_4EC8
		mov	dx, ax
		jmp	short loc_1EA2_4F48
; ---------------------------------------------------------------------------
		nop

loc_1EA2_4F21:				; CODE XREF: MaybePutImageAnd+9Dj
		mov	bx, cs:g_pSprite1.dwLeft
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_4EC8
		mov	si, cx
		sub	si, ax
		add	[bp+var_C], si
		mov	si, cs:g_pSprite1.dwWidth1
		sub	si, bx
		jle	short loc_1EA2_4EC8
		cmp	ax, si
		jl	short loc_1EA2_4F42
		mov	ax, si

loc_1EA2_4F42:				; CODE XREF: MaybePutImageAnd+CEj
		xchg	cx, dx
		sub	dx, ax
		add	cx, ax

loc_1EA2_4F48:				; CODE XREF: MaybePutImageAnd+A6j
					; MaybePutImageAnd+AEj
		or	cx, cx
		jle	short loc_1EA2_4F91
		mov	[bp+var_6], cx
		mov	[bp+var_8], dx
		mov	[bp+var_2], bx
		cld
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		assume es:nothing
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	si, [bp+var_C]
		mov	dx, [bp+var_A]
		mov	bx, cs:g_pSprite1.dwWidth2
		sub	bx, [bp+var_6]
		cmp	[bp+var_8], 0
		jz	short loc_1EA2_4F94

loc_1EA2_4F7F:				; CODE XREF: MaybePutImageAnd+11Fj
		mov	cx, [bp+var_6]

loc_1EA2_4F82:				; CODE XREF: MaybePutImageAnd+117j
		lodsb
		and	es:[di], al
		inc	di
		loop	loc_1EA2_4F82
		add	si, [bp+var_8]
		add	di, bx
		dec	dx
		jg	short loc_1EA2_4F7F

loc_1EA2_4F91:				; CODE XREF: MaybePutImageAnd+DAj
		jmp	loc_1EA2_4EC8
; ---------------------------------------------------------------------------

loc_1EA2_4F94:				; CODE XREF: MaybePutImageAnd+10Dj
		mov	ax, [bp+var_6]
		shr	ax, 1
		mov	[bp+var_E], ax
		jnb	short loc_1EA2_4FB8
		jz	short loc_1EA2_4FCB
		inc	bx

loc_1EA2_4FA1:				; CODE XREF: MaybePutImageAnd+143j
		mov	cx, [bp+var_E]

loc_1EA2_4FA4:				; CODE XREF: MaybePutImageAnd+13Aj
		lodsw
		and	es:[di], ax
		inc	di
		inc	di
		loop	loc_1EA2_4FA4
		lodsb
		and	es:[di], al
		add	di, bx
		dec	dx
		jg	short loc_1EA2_4FA1
		jmp	loc_1EA2_4EC8
; ---------------------------------------------------------------------------

loc_1EA2_4FB8:				; CODE XREF: MaybePutImageAnd+12Cj
					; MaybePutImageAnd+156j
		mov	cx, [bp+var_E]

loc_1EA2_4FBB:				; CODE XREF: MaybePutImageAnd+151j
		lodsw
		and	es:[di], ax
		inc	di
		inc	di
		loop	loc_1EA2_4FBB
		add	di, bx
		dec	dx
		jg	short loc_1EA2_4FB8
		jmp	loc_1EA2_4EC8
; ---------------------------------------------------------------------------

loc_1EA2_4FCB:				; CODE XREF: MaybePutImageAnd+12Ej
		inc	bx

loc_1EA2_4FCC:				; CODE XREF: MaybePutImageAnd+164j
		lodsb
		and	es:[di], al
		add	di, bx
		inc	bx
		dec	dx
		jg	short loc_1EA2_4FCC
		jmp	loc_1EA2_4EC8
MaybePutImageAnd endp

; ---------------------------------------------------------------------------
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_4FDA. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_4FFE	proc far		; CODE XREF: TrackEditRelate+80EP
					; sub_1A2B_1C06+BDP ...

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [bp+arg_4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_5037
sub_1EA2_4FFE	endp

; ---------------------------------------------------------------------------
		align 2
; [00000083 BYTES: COLLAPSED FUNCTION sub_1EA2_501C. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_50A0. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000001D BYTES: COLLAPSED FUNCTION sub_1EA2_50C4. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybePutImageAnd2 proc far		; CODE XREF: RunGame+549P
					; SetupCarShapes+798P ...

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+Shape2D.dwPosX]
		mov	[bp+var_2], ax
		mov	ax, [si+Shape2D.dwPosY]
		mov	[bp+var_4], ax

loc_1EA2_50FD:				; CODE XREF: sub_1EA2_50A0+21j
					; sub_1EA2_50C4+1Bj
		cld
		lea	ax, [si+(Shape2D.dwWidth+10h)]
		mov	[bp+var_E], ax
		mov	ax, [si+Shape2D.dwWidth]
		mov	[bp+var_6], ax
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	[bp+var_10], bx
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		mov	si, [bp+var_E]
		mov	dx, [bp+var_6]

loc_1EA2_5128:				; CODE XREF: MaybePutImageAnd2+72j
					; MaybePutImageAnd2+94j
		lodsb
		or	al, al
		jg	short loc_1EA2_5136
		jl	short loc_1EA2_5156
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5136:				; CODE XREF: MaybePutImageAnd2+49j
		mov	cl, al
		xor	ch, ch
		lodsb

loc_1EA2_513B:				; CODE XREF: MaybePutImageAnd2:loc_1EA2_5152j
		and	es:[di], al
		inc	di
		dec	dx
		jg	short loc_1EA2_5152
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, [bp+var_6]

loc_1EA2_5152:				; CODE XREF: MaybePutImageAnd2+5Ej
		loop	loc_1EA2_513B
		jmp	short loc_1EA2_5128
; ---------------------------------------------------------------------------

loc_1EA2_5156:				; CODE XREF: MaybePutImageAnd2+4Bj
		neg	al
		mov	cl, al
		xor	ch, ch

loc_1EA2_515C:				; CODE XREF: MaybePutImageAnd2:loc_1EA2_5174j
		lodsb
		and	es:[di], al
		inc	di
		dec	dx
		jg	short loc_1EA2_5174
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, [bp+var_6]

loc_1EA2_5174:				; CODE XREF: MaybePutImageAnd2+80j
		loop	loc_1EA2_515C
		jmp	short loc_1EA2_5128
MaybePutImageAnd2 endp

; [00000023 BYTES: COLLAPSED FUNCTION nopsub_1EA2_5178.	PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoMaybePutImage	proc far		; CODE XREF: LoadIntroRes+629P
					; RunCarMenu+A87P ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_51D5
DoMaybePutImage	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PutImageMaybe	proc far		; CODE XREF: LoadIntroRes+6CDP
					; RunCarMenu+8E0P ...

var_E		= word ptr -0Eh
pBitmapData	= word ptr -0Ch
wLineOffset2	= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
wLineOffset	= word ptr -4
var_2		= word ptr -2
p_pBitmap	= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, word ptr [bp+p_pBitmap+2]
		mov	si, word ptr [bp+p_pBitmap]
		mov	ax, [si+Shape2D.dwPosX]
		mov	[bp+var_2], ax
		mov	ax, [si+Shape2D.dwPosY]
		mov	[bp+wLineOffset], ax

loc_1EA2_51D5:				; CODE XREF: nopsub_1EA2_5178+21j
					; DoMaybePutImage+1Bj
		mov	bx, [bp+wLineOffset]
		mov	cx, [si+Shape2D.dwHeight]
		lea	dx, [si+(Shape2D.dwWidth+10h)] ; point at end of shape2dstruct = bitmap
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_51FB
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_5222
		sub	cx, ax
		jg	short loc_1EA2_5222

loc_1EA2_51F4:				; CODE XREF: PutImageMaybe+4Aj
					; PutImageMaybe+66j ...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_51FB:				; CODE XREF: PutImageMaybe+2Bj
		mov	bx, cs:g_pSprite1.dwTop
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_51F4
		xchg	ax, cx
		sub	ax, cx
		mov	[bp+var_8], dx
		mul	word ptr [si]
		mov	dx, [bp+var_8]
		add	dx, ax
		mov	ax, bx
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_5222
		sub	cx, ax
		jle	short loc_1EA2_51F4

loc_1EA2_5222:				; CODE XREF: PutImageMaybe+34j
					; PutImageMaybe+38j ...
		mov	[bp+pBitmapData], dx
		mov	[bp+wLineOffset2], cx
		mov	[bp+wLineOffset], bx
		mov	cx, word ptr [si+Sprite.pBitmap]
		xor	dx, dx
		mov	bx, [bp+var_2]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwLeft
		jl	short loc_1EA2_524D
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwWidth1
		jl	short loc_1EA2_5274
		sub	cx, ax
		jle	short loc_1EA2_51F4
		mov	dx, ax
		jmp	short loc_1EA2_5274
; ---------------------------------------------------------------------------
		nop

loc_1EA2_524D:				; CODE XREF: PutImageMaybe+7Fj
		mov	bx, cs:g_pSprite1.dwLeft
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_51F4
		mov	si, cx
		sub	si, ax
		add	[bp+pBitmapData], si
		mov	si, cs:g_pSprite1.dwWidth1
		sub	si, bx
		jle	short loc_1EA2_51F4
		cmp	ax, si
		jl	short loc_1EA2_526E
		mov	ax, si

loc_1EA2_526E:				; CODE XREF: PutImageMaybe+B0j
		xchg	cx, dx
		sub	dx, ax
		add	cx, ax

loc_1EA2_5274:				; CODE XREF: PutImageMaybe+88j
					; PutImageMaybe+90j
		or	cx, cx
		jle	short loc_1EA2_52B8
		mov	[bp+var_6], cx
		mov	[bp+var_8], dx
		mov	[bp+var_2], bx
		cld
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		mov	bx, [bp+wLineOffset]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	si, [bp+pBitmapData]
		mov	dx, [bp+wLineOffset2]
		mov	bx, cs:g_pSprite1.dwWidth2
		sub	bx, [bp+var_6]
		cmp	[bp+var_8], 0
		jz	short loc_1EA2_52BB

loc_1EA2_52AB:				; CODE XREF: PutImageMaybe+FCj
		mov	cx, [bp+var_6]
		rep movsb
		add	si, [bp+var_8]
		add	di, bx
		dec	dx
		jg	short loc_1EA2_52AB

loc_1EA2_52B8:				; CODE XREF: PutImageMaybe+BCj
		jmp	loc_1EA2_51F4
; ---------------------------------------------------------------------------

loc_1EA2_52BB:				; CODE XREF: PutImageMaybe+EFj
		mov	ax, [bp+var_6]
		shr	ax, 1
		mov	[bp+var_E], ax
		jnb	short loc_1EA2_52D5
		jz	short loc_1EA2_52E2

loc_1EA2_52C7:				; CODE XREF: PutImageMaybe+116j
		mov	cx, [bp+var_E]
		rep movsw
		movsb
		add	di, bx
		dec	dx
		jg	short loc_1EA2_52C7
		jmp	loc_1EA2_51F4
; ---------------------------------------------------------------------------

loc_1EA2_52D5:				; CODE XREF: PutImageMaybe+109j
					; PutImageMaybe+123j
		mov	cx, [bp+var_E]
		rep movsw
		add	di, bx
		dec	dx
		jg	short loc_1EA2_52D5
		jmp	loc_1EA2_51F4
; ---------------------------------------------------------------------------

loc_1EA2_52E2:				; CODE XREF: PutImageMaybe+10Bj
					; PutImageMaybe+12Dj
		movsb
		add	di, bx
		inc	bx
		dec	dx
		jg	short loc_1EA2_52E2
		jmp	loc_1EA2_51F4
PutImageMaybe	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_52EC	proc far

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [bp+arg_4]
		sub	ax, [si+4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		sub	ax, [si+6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_5349
sub_1EA2_52EC	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_5310	proc far		; CODE XREF: DoTrakdata12+3EP
					; TrackEditRelate+75BP	...

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_5349
sub_1EA2_5310	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_532E	proc far		; CODE XREF: RunIntro+5EP RunIntro+B3P ...

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+8]
		mov	[bp+var_2], ax
		mov	ax, [si+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_5349:				; CODE XREF: sub_1EA2_52EC+21j
					; sub_1EA2_5310+1Bj
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets	; 5F5C
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	es, word ptr cs:g_pSprite1.pBitmap+2 ; 0xA000
		cld
		mov	dx, [si+2]
		mov	bx, cs:g_pSprite1.dwWidth2
		mov	ax, [si]
		sub	bx, ax
		add	si, 10h
		shr	ax, 1
		mov	[bp+var_6], ax
		jnb	short loc_1EA2_5389
		jz	short loc_1EA2_5395

loc_1EA2_5377:				; CODE XREF: sub_1EA2_532E+52j
		mov	cx, [bp+var_6]
		rep movsw
		movsb
		add	di, bx
		dec	dx
		jg	short loc_1EA2_5377

loc_1EA2_5382:				; CODE XREF: sub_1EA2_532E+65j
					; sub_1EA2_532E+6Dj
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5389:				; CODE XREF: sub_1EA2_532E+45j
					; sub_1EA2_532E+63j
		mov	cx, [bp+var_6]
		rep movsw
		add	di, bx
		dec	dx
		jg	short loc_1EA2_5389
		jmp	short loc_1EA2_5382
; ---------------------------------------------------------------------------

loc_1EA2_5395:				; CODE XREF: sub_1EA2_532E+47j
					; sub_1EA2_532E+6Bj
		movsb
		add	di, bx
		dec	dx
		jg	short loc_1EA2_5395
		jmp	short loc_1EA2_5382
sub_1EA2_532E	endp

; ---------------------------------------------------------------------------
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_539E. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_53C2	proc far		; CODE XREF: EndOfGameScores+977P
					; EndOfGameScores+CBBP	...

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_53FB
sub_1EA2_53C2	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RplyManySprite	proc far		; CODE XREF: SetupCarShapes+27BP
					; RplyMouseSpriteStuff+A8P ...

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+8]
		mov	[bp+var_2], ax
		mov	ax, [si+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_53FB:				; CODE XREF: sub_1EA2_539E+21j
					; sub_1EA2_53C2+1Bj
		cld
		lea	ax, [si+10h]
		mov	[bp+var_E], ax
		mov	ax, [si]
		mov	[bp+var_6], ax

loc_1EA2_5407:				; CODE XREF: MaybePutBitmapOn1+D2J
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	[bp+var_10], bx
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		mov	si, [bp+var_E]
		mov	dx, [bp+var_6]

loc_1EA2_5426:				; CODE XREF: RplyManySprite+6Fj
					; RplyManySprite+8Dj
		lodsb
		or	al, al
		jg	short loc_1EA2_5434
		jl	short loc_1EA2_5451
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5434:				; CODE XREF: RplyManySprite+49j
		mov	cl, al
		xor	ch, ch
		lodsb

loc_1EA2_5439:				; CODE XREF: RplyManySprite:loc_1EA2_544Dj
		stosb
		dec	dx
		jg	short loc_1EA2_544D
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, [bp+var_6]

loc_1EA2_544D:				; CODE XREF: RplyManySprite+5Bj
		loop	loc_1EA2_5439
		jmp	short loc_1EA2_5426
; ---------------------------------------------------------------------------

loc_1EA2_5451:				; CODE XREF: RplyManySprite+4Bj
		neg	al
		mov	cl, al
		xor	ch, ch

loc_1EA2_5457:				; CODE XREF: RplyManySprite:loc_1EA2_546Bj
		movsb
		dec	dx
		jg	short loc_1EA2_546B
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, [bp+var_6]

loc_1EA2_546B:				; CODE XREF: RplyManySprite+79j
		loop	loc_1EA2_5457
		jmp	short loc_1EA2_5426
RplyManySprite	endp

; ---------------------------------------------------------------------------
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_5470. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_5494	proc far		; CODE XREF: SetupCarShapes+194P
					; SetupCarShapes+3D7P

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_54CD
sub_1EA2_5494	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybePutBitmapOn1 proc far		; CODE XREF: SetupCarShapes+299P
					; SetupCarShapes+2A9P ...

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
wDashWidth	= word ptr -6
wDashY		= word ptr -4
wDashX		= word ptr -2
p_pDashBitmap	= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, word ptr [bp+p_pDashBitmap+2]
		mov	si, word ptr [bp+p_pDashBitmap]
		mov	ax, [si+Shape2D.dwPosX]
		mov	[bp+wDashX], ax
		mov	ax, [si+Shape2D.dwPosY]
		mov	[bp+wDashY], ax

loc_1EA2_54CD:				; CODE XREF: sub_1EA2_5470+21j
					; sub_1EA2_5494+1Bj
		cld
		lea	ax, [si+10h]	; next bitmap? or bitmap data starting here?
		mov	[bp+var_E], ax
		mov	ax, [si+Shape2D.dwWidth]
		mov	[bp+wDashWidth], ax
		xor	di, di
		xor	dx, dx
		mov	bx, [bp+wDashY]
		mov	cx, [si+Shape2D.dwHeight]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_5501
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_5524
		inc	di
		sub	cx, ax
		jg	short loc_1EA2_5524

loc_1EA2_54FA:				; CODE XREF: MaybePutBitmapOn1+59j
					; MaybePutBitmapOn1+70j ...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5501:				; CODE XREF: MaybePutBitmapOn1+38j
		inc	di
		mov	bx, cs:g_pSprite1.dwTop
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_54FA
		xchg	ax, cx
		sub	ax, cx
		mul	[bp+wDashWidth]
		mov	dx, ax
		mov	ax, bx
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_5524
		sub	cx, ax
		jle	short loc_1EA2_54FA

loc_1EA2_5524:				; CODE XREF: MaybePutBitmapOn1+41j
					; MaybePutBitmapOn1+46j ...
		mov	[bp+var_8], cx
		mov	[bp+wDashY], bx
		mov	[bp+var_A], dx
		xor	dx, dx
		mov	bx, [bp+wDashX]
		mov	ax, bx
		mov	cx, [bp+wDashWidth]
		cmp	ax, cs:g_pSprite1.dwLeft
		jl	short loc_1EA2_5551
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwWidth1
		jle	short loc_1EA2_5577
		sub	cx, ax
		jle	short loc_1EA2_54FA
		inc	di
		mov	dx, ax
		jmp	short loc_1EA2_5577
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_5551:				; CODE XREF: MaybePutBitmapOn1+8Aj
		inc	di
		mov	bx, cs:g_pSprite1.dwLeft
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_54FA
		mov	si, cx
		sub	si, ax
		add	[bp+var_A], si
		mov	si, cs:g_pSprite1.dwWidth1
		sub	si, bx
		cmp	ax, si
		jl	short loc_1EA2_5571
		mov	ax, si

loc_1EA2_5571:				; CODE XREF: MaybePutBitmapOn1+BBj
		xchg	cx, dx
		sub	dx, ax
		add	cx, ax

loc_1EA2_5577:				; CODE XREF: MaybePutBitmapOn1+93j
					; MaybePutBitmapOn1+9Cj
		mov	[bp+wDashWidth], cx
		mov	[bp+var_C], dx
		mov	[bp+wDashX], bx
		or	di, di
		jnz	short loc_1EA2_5589
		jmp	loc_1EA2_5407
; ---------------------------------------------------------------------------

loc_1EA2_5589:				; CODE XREF: MaybePutBitmapOn1+D0j
		mov	bx, [bp+wDashY]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	[bp+var_10], bx
		mov	di, cs:[bx]
		add	di, [bp+wDashX]
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		mov	si, [bp+var_E]
		mov	dx, [bp+var_A]
		or	dx, dx
		jnz	short loc_1EA2_5622

loc_1EA2_55AC:				; CODE XREF: MaybePutBitmapOn1+130j
					; MaybePutBitmapOn1+161j
		mov	dx, [bp+wDashWidth]

loc_1EA2_55AF:				; CODE XREF: MaybePutBitmapOn1+116j
					; MaybePutBitmapOn1+145j
		lodsb
		or	al, al
		jg	short loc_1EA2_55BD
		jl	short loc_1EA2_55EB

loc_1EA2_55B6:				; CODE XREF: MaybePutBitmapOn1+11Bj
					; MaybePutBitmapOn1+14Aj
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_55BD:				; CODE XREF: MaybePutBitmapOn1+100j
		mov	cl, al
		xor	ch, ch
		lodsb

loc_1EA2_55C2:				; CODE XREF: MaybePutBitmapOn1+114j
					; MaybePutBitmapOn1+137j
		stosb
		dec	dx
		jle	short loc_1EA2_55CA
		loop	loc_1EA2_55C2
		jmp	short loc_1EA2_55AF
; ---------------------------------------------------------------------------

loc_1EA2_55CA:				; CODE XREF: MaybePutBitmapOn1+112j
		dec	[bp+var_8]
		jz	short loc_1EA2_55B6
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+wDashX]
		dec	cx
		mov	dx, [bp+var_C]

loc_1EA2_55E0:				; CODE XREF: MaybePutBitmapOn1+183j
		sub	cx, dx
		jz	short loc_1EA2_55AC
		jl	short loc_1EA2_561E
		mov	dx, [bp+wDashWidth]
		jmp	short loc_1EA2_55C2
; ---------------------------------------------------------------------------

loc_1EA2_55EB:				; CODE XREF: MaybePutBitmapOn1+102j
		neg	al
		mov	cl, al
		xor	ch, ch

loc_1EA2_55F1:				; CODE XREF: MaybePutBitmapOn1+143j
					; MaybePutBitmapOn1+168j
		movsb
		dec	dx
		jle	short loc_1EA2_55F9
		loop	loc_1EA2_55F1
		jmp	short loc_1EA2_55AF
; ---------------------------------------------------------------------------

loc_1EA2_55F9:				; CODE XREF: MaybePutBitmapOn1+141j
		dec	[bp+var_8]
		jz	short loc_1EA2_55B6
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+wDashX]
		dec	cx
		mov	dx, [bp+var_C]

loc_1EA2_560F:				; CODE XREF: MaybePutBitmapOn1+18Bj
		add	si, dx
		sub	cx, dx
		jz	short loc_1EA2_55AC
		jl	short loc_1EA2_561C
		mov	dx, [bp+wDashWidth]
		jmp	short loc_1EA2_55F1
; ---------------------------------------------------------------------------

loc_1EA2_561C:				; CODE XREF: MaybePutBitmapOn1+163j
		add	si, cx

loc_1EA2_561E:				; CODE XREF: MaybePutBitmapOn1+132j
		neg	cx
		mov	dx, cx

loc_1EA2_5622:				; CODE XREF: MaybePutBitmapOn1+F8j
		lodsb
		or	al, al
		jg	short loc_1EA2_5630
		jl	short loc_1EA2_5637
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5630:				; CODE XREF: MaybePutBitmapOn1+173j
		mov	cl, al
		xor	ch, ch
		lodsb
		jmp	short loc_1EA2_55E0
; ---------------------------------------------------------------------------

loc_1EA2_5637:				; CODE XREF: MaybePutBitmapOn1+175j
		neg	al
		mov	cl, al
		xor	ch, ch
		jmp	short loc_1EA2_560F
MaybePutBitmapOn1 endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoMaybePutBitmapOr proc	far		; CODE XREF: SetupCarShapes+419P
					; SetupCarShapes+95BP

var_4		= word ptr -4
var_2		= word ptr -2
arg_2		= word ptr  6
arg_4		= word ptr  8
arg_6		= word ptr  0Ah
arg_8		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		sub	ax, [si+4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		sub	ax, [si+6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_569D
DoMaybePutBitmapOr endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybePutImageOr	proc far		; CODE XREF: SetupCarShapes+6B0P
					; SetupCarShapes+6EAP ...

var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [bp+arg_4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_569D
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+8]
		mov	[bp+var_2], ax
		mov	ax, [si+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_569D:				; CODE XREF: DoMaybePutBitmapOr+21j
					; MaybePutImageOr+1Bj
		mov	bx, [bp+var_4]
		mov	cx, [si+2]
		lea	dx, [si+10h]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_56C3
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_56EA
		sub	cx, ax
		jg	short loc_1EA2_56EA

loc_1EA2_56BC:				; CODE XREF: MaybePutImageOr+68j
					; MaybePutImageOr+84j ...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_56C3:				; CODE XREF: MaybePutImageOr+49j
		mov	bx, cs:g_pSprite1.dwTop
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_56BC
		xchg	ax, cx
		sub	ax, cx
		mov	[bp+var_8], dx
		mul	word ptr [si]
		mov	dx, [bp+var_8]
		add	dx, ax
		mov	ax, bx
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_56EA
		sub	cx, ax
		jle	short loc_1EA2_56BC

loc_1EA2_56EA:				; CODE XREF: MaybePutImageOr+52j
					; MaybePutImageOr+56j ...
		mov	[bp+var_C], dx
		mov	[bp+var_A], cx
		mov	[bp+var_4], bx
		mov	cx, [si]
		xor	dx, dx
		mov	bx, [bp+var_2]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwLeft
		jl	short loc_1EA2_5715
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwWidth1
		jl	short loc_1EA2_573C
		sub	cx, ax
		jle	short loc_1EA2_56BC
		mov	dx, ax
		jmp	short loc_1EA2_573C
; ---------------------------------------------------------------------------
		nop

loc_1EA2_5715:				; CODE XREF: MaybePutImageOr+9Dj
		mov	bx, cs:g_pSprite1.dwLeft
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_56BC
		mov	si, cx
		sub	si, ax
		add	[bp+var_C], si
		mov	si, cs:g_pSprite1.dwWidth1
		sub	si, bx
		jle	short loc_1EA2_56BC
		cmp	ax, si
		jl	short loc_1EA2_5736
		mov	ax, si

loc_1EA2_5736:				; CODE XREF: MaybePutImageOr+CEj
		xchg	cx, dx
		sub	dx, ax
		add	cx, ax

loc_1EA2_573C:				; CODE XREF: MaybePutImageOr+A6j
					; MaybePutImageOr+AEj
		or	cx, cx
		jle	short loc_1EA2_5785
		mov	[bp+var_6], cx
		mov	[bp+var_8], dx
		mov	[bp+var_2], bx
		cld
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	si, [bp+var_C]
		mov	dx, [bp+var_A]
		mov	bx, cs:g_pSprite1.dwWidth2
		sub	bx, [bp+var_6]
		cmp	[bp+var_8], 0
		jz	short loc_1EA2_5788

loc_1EA2_5773:				; CODE XREF: MaybePutImageOr+11Fj
		mov	cx, [bp+var_6]

loc_1EA2_5776:				; CODE XREF: MaybePutImageOr+117j
		lodsb
		or	es:[di], al
		inc	di
		loop	loc_1EA2_5776
		add	si, [bp+var_8]
		add	di, bx
		dec	dx
		jg	short loc_1EA2_5773

loc_1EA2_5785:				; CODE XREF: MaybePutImageOr+DAj
		jmp	loc_1EA2_56BC
; ---------------------------------------------------------------------------

loc_1EA2_5788:				; CODE XREF: MaybePutImageOr+10Dj
		mov	ax, [bp+var_6]
		shr	ax, 1
		mov	[bp+var_E], ax
		jnb	short loc_1EA2_57AC
		jz	short loc_1EA2_57BF
		inc	bx

loc_1EA2_5795:				; CODE XREF: MaybePutImageOr+143j
		mov	cx, [bp+var_E]

loc_1EA2_5798:				; CODE XREF: MaybePutImageOr+13Aj
		lodsw
		or	es:[di], ax
		inc	di
		inc	di
		loop	loc_1EA2_5798
		lodsb
		or	es:[di], al
		add	di, bx
		dec	dx
		jg	short loc_1EA2_5795
		jmp	loc_1EA2_56BC
; ---------------------------------------------------------------------------

loc_1EA2_57AC:				; CODE XREF: MaybePutImageOr+12Cj
					; MaybePutImageOr+156j
		mov	cx, [bp+var_E]

loc_1EA2_57AF:				; CODE XREF: MaybePutImageOr+151j
		lodsw
		or	es:[di], ax
		inc	di
		inc	di
		loop	loc_1EA2_57AF
		add	di, bx
		dec	dx
		jg	short loc_1EA2_57AC
		jmp	loc_1EA2_56BC
; ---------------------------------------------------------------------------

loc_1EA2_57BF:				; CODE XREF: MaybePutImageOr+12Ej
		inc	bx

loc_1EA2_57C0:				; CODE XREF: MaybePutImageOr+164j
		lodsb
		or	es:[di], al
		add	di, bx
		inc	bx
		dec	dx
		jg	short loc_1EA2_57C0
		jmp	loc_1EA2_56BC
MaybePutImageOr	endp

; ---------------------------------------------------------------------------
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_57CE. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_57F2	proc far		; CODE XREF: TrackEditRelate+82CP
					; sub_1A2B_1C06+EEP ...

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [bp+arg_4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_582B
sub_1EA2_57F2	endp

; ---------------------------------------------------------------------------
		align 2
; [00000083 BYTES: COLLAPSED FUNCTION sub_1EA2_5810. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_5894. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000001D BYTES: COLLAPSED FUNCTION sub_1EA2_58B8. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybePutImageOr2 proc far		; CODE XREF: RunGame+559P
					; SetupCarShapes:loc_11B7_1966P

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+Shape2D.dwPosX]
		mov	[bp+var_2], ax
		mov	ax, [si+Shape2D.dwPosY]
		mov	[bp+var_4], ax

loc_1EA2_58F1:				; CODE XREF: sub_1EA2_5894+21j
					; sub_1EA2_58B8+1Bj
		cld
		lea	ax, [si+(Shape2D.dwWidth+10h)] ; point at bitmapdata
		mov	[bp+var_E], ax
		mov	ax, [si+Shape2D.dwWidth]
		mov	[bp+var_6], ax
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	[bp+var_10], bx
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		mov	si, [bp+var_E]
		mov	dx, [bp+var_6]

loc_1EA2_591C:				; CODE XREF: MaybePutImageOr2+72j
					; MaybePutImageOr2+94j
		lodsb
		or	al, al
		jg	short loc_1EA2_592A
		jl	short loc_1EA2_594A
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_592A:				; CODE XREF: MaybePutImageOr2+49j
		mov	cl, al
		xor	ch, ch
		lodsb

loc_1EA2_592F:				; CODE XREF: MaybePutImageOr2:loc_1EA2_5946j
		or	es:[di], al
		inc	di
		dec	dx
		jg	short loc_1EA2_5946
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, [bp+var_6]

loc_1EA2_5946:				; CODE XREF: MaybePutImageOr2+5Ej
		loop	loc_1EA2_592F
		jmp	short loc_1EA2_591C
; ---------------------------------------------------------------------------

loc_1EA2_594A:				; CODE XREF: MaybePutImageOr2+4Bj
		neg	al
		mov	cl, al
		xor	ch, ch

loc_1EA2_5950:				; CODE XREF: MaybePutImageOr2:loc_1EA2_5968j
		lodsb
		or	es:[di], al
		inc	di
		dec	dx
		jg	short loc_1EA2_5968
		add	[bp+var_10], 2
		mov	bx, [bp+var_10]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, [bp+var_6]

loc_1EA2_5968:				; CODE XREF: MaybePutImageOr2+80j
		loop	loc_1EA2_5950
		jmp	short loc_1EA2_591C
MaybePutImageOr2 endp

; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_596C. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Sprite1Op2	proc far		; CODE XREF: RunCarMenu+2E7P
					; RunCarMenu+A6FP ...

var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [bp+arg_4]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_59C9
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+8]
		mov	[bp+var_2], ax
		mov	ax, [si+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_59C9:				; CODE XREF: sub_1EA2_596C+21j
					; Sprite1Op2+1Bj
		mov	bx, [bp+var_4]
		mov	cx, [si+2]
		lea	dx, [si+10h]
		mov	ax, bx
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_59EF
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_5A16
		sub	cx, ax
		jg	short loc_1EA2_5A16

loc_1EA2_59E8:				; CODE XREF: Sprite1Op2+68j
					; Sprite1Op2+84j ...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_59EF:				; CODE XREF: Sprite1Op2+49j
		mov	bx, cs:g_pSprite1.dwTop
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_59E8
		xchg	ax, cx
		sub	ax, cx
		mov	[bp+var_C], dx
		mul	word ptr [si]
		mov	dx, [bp+var_C]
		add	dx, ax
		mov	ax, bx
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jle	short loc_1EA2_5A16
		sub	cx, ax
		jle	short loc_1EA2_59E8

loc_1EA2_5A16:				; CODE XREF: Sprite1Op2+52j
					; Sprite1Op2+56j ...
		mov	[bp+var_C], dx
		mov	[bp+var_A], cx
		mov	[bp+var_4], bx
		mov	cx, [si]
		xor	dx, dx
		mov	ax, [bp+var_2]
		mov	bx, ax
		cmp	ax, cs:g_pSprite1.dwLeft
		jl	short loc_1EA2_5A41
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwWidth1
		jl	short loc_1EA2_5A68
		sub	cx, ax
		jle	short loc_1EA2_59E8
		mov	dx, ax
		jmp	short loc_1EA2_5A68
; ---------------------------------------------------------------------------
		nop

loc_1EA2_5A41:				; CODE XREF: Sprite1Op2+9Dj
		mov	bx, cs:g_pSprite1.dwLeft
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_59E8
		mov	si, cx
		sub	si, ax
		add	[bp+var_C], si
		mov	si, cs:g_pSprite1.dwWidth1
		sub	si, bx
		jle	short loc_1EA2_59E8
		cmp	ax, si
		jl	short loc_1EA2_5A62
		mov	ax, si

loc_1EA2_5A62:				; CODE XREF: Sprite1Op2+CEj
		xchg	cx, dx
		sub	dx, ax
		add	cx, ax

loc_1EA2_5A68:				; CODE XREF: Sprite1Op2+A6j
					; Sprite1Op2+AEj
		or	cx, cx
		jle	short loc_1EA2_5ABC
		mov	[bp+var_6], cx
		mov	[bp+var_8], dx
		mov	[bp+var_2], bx
		cld
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	si, [bp+var_C]
		mov	dx, cs:g_pSprite1.dwWidth2
		sub	dx, [bp+var_6]
		xor	bh, bh
		mov	ah, 0FFh

loc_1EA2_5A9A:				; CODE XREF: Sprite1Op2+12Aj
		mov	cx, [bp+var_6]

loc_1EA2_5A9D:				; CODE XREF: Sprite1Op2+11Aj
					; Sprite1Op2+120j
		lodsb
		mov	bl, al
		mov	al, cs:g_arrIncNums[bx]
		cmp	al, ah
		jz	short loc_1EA2_5AAF
		stosb
		loop	loc_1EA2_5A9D
		jmp	short loc_1EA2_5AB2
; ---------------------------------------------------------------------------
		nop

loc_1EA2_5AAF:				; CODE XREF: Sprite1Op2+117j
		inc	di
		loop	loc_1EA2_5A9D

loc_1EA2_5AB2:				; CODE XREF: Sprite1Op2+11Cj
		add	si, [bp+var_8]
		add	di, dx
		dec	[bp+var_A]
		jg	short loc_1EA2_5A9A

loc_1EA2_5ABC:				; CODE XREF: Sprite1Op2+DAj
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
Sprite1Op2	endp

; ---------------------------------------------------------------------------
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION sub_1EA2_5AC4. PRESS KEYPAD "+" TO EXPAND]
		align 2
; [0000001D BYTES: COLLAPSED FUNCTION sub_1EA2_5AE8. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp2	proc far		; CODE XREF: RunOpponentMenu+146P
					; RunOpponentMenu+2ADP	...

var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	ax, [si+8]
		mov	[bp+var_2], ax
		mov	ax, [si+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_5B21:				; CODE XREF: sub_1EA2_5AC4+21j
					; sub_1EA2_5AE8+1Bj
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dx, cs:g_pSprite1.dwWidth2
		mov	ax, [si]
		mov	[bp+var_6], ax
		sub	dx, ax
		mov	ax, [si+2]
		mov	[bp+var_8], ax
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		cld
		add	si, 10h
		xor	bx, bx

loc_1EA2_5B4E:				; CODE XREF: SpriteOp2+65j
		mov	cx, [bp+var_6]

loc_1EA2_5B51:				; CODE XREF: SpriteOp2+58j
					; SpriteOp2+5Ej
		lodsb
		mov	bl, al
		mov	al, cs:g_arrIncNums[bx]
		cmp	al, 0FFh
		jz	short loc_1EA2_5B63
		stosb
		loop	loc_1EA2_5B51
		jmp	short loc_1EA2_5B66
; ---------------------------------------------------------------------------
		db 90h
; ---------------------------------------------------------------------------

loc_1EA2_5B63:				; CODE XREF: SpriteOp2+55j
		inc	di
		loop	loc_1EA2_5B51

loc_1EA2_5B66:				; CODE XREF: SpriteOp2+5Aj
		add	di, dx
		dec	[bp+var_8]
		jg	short loc_1EA2_5B4E
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
SpriteOp2	endp

; [00000027 BYTES: COLLAPSED FUNCTION sub_1EA2_5B74. PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FontSpriteOp	proc far		; CODE XREF: RunGame+818P
					; RplyMouseSpriteStuff+10DP ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	ds
		push	si
		push	di
		mov	ds, g_segFontDef
		mov	ax, [bp+arg_2]
		mov	ds:word_2B1F_8,	ax
		mov	ax, [bp+arg_4]
		mov	ds:word_2B1F_A,	ax
		jmp	short loc_1EA2_5BC5
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_5BB8:
		push	bp
		mov	bp, sp
		sub	sp, 4
		push	ds
		push	si
		push	di
		mov	ds, g_segFontDef

loc_1EA2_5BC5:				; CODE XREF: sub_1EA2_5B74+25j
					; FontSpriteOp+19j
		cld
		mov	es, word ptr cs:g_pSprite1.pBitmap+2

loc_1EA2_5BCB:				; CODE XREF: FontSpriteOp+52j
					; FontSpriteOp+61j ...
		mov	si, [bp+arg_0]
		mov	bl, ss:[si]
		or	bl, bl
		jz	short loc_1EA2_5BFF
		mov	al, bl
		inc	[bp+arg_0]
		xor	bh, bh
		shl	bx, 1
		add	bx, offset unk_2B1F_16
		mov	si, [bx]
		cmp	si, 0
		jnz	short loc_1EA2_5C06
		cmp	al, 0Dh
		jz	short loc_1EA2_5BF0
		cmp	al, 0Ah
		jnz	short loc_1EA2_5BCB

loc_1EA2_5BF0:				; CODE XREF: FontSpriteOp+4Ej
		mov	ax, word_2B77_4
		mov	ds:word_2B1F_8,	ax
		mov	ax, ds:word_2B1F_12
		add	ds:word_2B1F_A,	ax
		jmp	short loc_1EA2_5BCB
; ---------------------------------------------------------------------------

loc_1EA2_5BFF:				; CODE XREF: FontSpriteOp+37j
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5C06:				; CODE XREF: FontSpriteOp+4Aj
		mov	ax, ds:word_2B1F_8
		mov	[bp+var_2], ax
		cmp	ds:byte_2B1F_14, 0
		jz	short loc_1EA2_5C27
		mov	al, [si]
		xor	ah, ah
		inc	si
		mov	ds:word_2B1F_10, ax
		add	ax, 7
		shr	ax, 1
		shr	ax, 1
		shr	ax, 1
		mov	ds:0Ch,	al

loc_1EA2_5C27:				; CODE XREF: FontSpriteOp+75j
		mov	al, byte ptr ds_NULL
		mov	ah, byte ptr word_2B77_2
		mov	cx, ds:word_2B1F_E
		mov	[bp+var_4], cx
		mov	bx, ds:word_2B1F_A
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets

loc_1EA2_5C40:				; CODE XREF: FontSpriteOp+C4j
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		mov	dh, ds:byte_2B1F_C

loc_1EA2_5C4A:				; CODE XREF: FontSpriteOp+BDj
					; FontSpriteOp+D9j
		mov	cx, 8
		mov	dl, [si]

loc_1EA2_5C4F:				; CODE XREF: FontSpriteOp+B8j
					; FontSpriteOp+D4j
		shl	dl, 1
		jnb	short loc_1EA2_5C6C
		stosb
		loop	loc_1EA2_5C4F
		inc	si
		dec	dh
		jg	short loc_1EA2_5C4A

loc_1EA2_5C5B:				; CODE XREF: FontSpriteOp+DBj
		inc	bx
		inc	bx
		dec	[bp+var_4]
		jg	short loc_1EA2_5C40
		mov	ax, ds:word_2B1F_10
		add	ds:word_2B1F_8,	ax
		jmp	loc_1EA2_5BCB
; ---------------------------------------------------------------------------

loc_1EA2_5C6C:				; CODE XREF: FontSpriteOp+B5j
		mov	es:[di], ah
		inc	di
		loop	loc_1EA2_5C4F
		inc	si
		dec	dh
		jg	short loc_1EA2_5C4A
		jmp	short loc_1EA2_5C5B
FontSpriteOp	endp

; ---------------------------------------------------------------------------
		align 2
; [00000008 BYTES: COLLAPSED FUNCTION sub_1EA2_5C7A. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetPalette	proc far		; CODE XREF: LoadPalAndCurso+69P

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		mov	ax, ds

loc_1EA2_5C88:				; CODE XREF: sub_1EA2_5C7A+6j
		mov	es, ax
		assume es:dseg
		mov	bx, [bp+arg_0]
		mov	dx, [bp+arg_4]
		mov	cx, [bp+arg_2]
		mov	ah, 10h
		mov	al, 12h
		int	10h		; - VIDEO - SET	BLOCK OF DAC REGISTERS (EGA, VGA/MCGA)
					; BX = starting	color register,	CX = number of registers to set
					; ES:DX	-> table of 3*CX bytes where each 3 byte group represents one
					; byte each of red, green and blue (0-63)
		pop	bp
		retf
SetPalette	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp3	proc far		; CODE XREF: SpritePutpixel+18EP
					; DATA XREF: DeriveSpriteOp3:loc_1EA2_2DAEo ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		push	di
		cmp	[bp+arg_6], 0
		jz	short loc_1EA2_5CEC
		cld
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		assume es:nothing
		mov	ax, [bp+arg_8]
		mov	ah, al

loc_1EA2_5CC0:				; CODE XREF: SpriteOp3+4Ej
		mov	bx, [bp+arg_2]
		mov	cx, [bx]
		mov	bx, [bp+arg_0]
		mov	bx, [bx]
		sub	cx, bx
		inc	cx
		jle	short loc_1EA2_5CDC
		mov	di, cs:[si]
		add	di, bx
		test	cx, 0FFF8h
		jnz	short loc_1EA2_5CF2
		rep stosb

loc_1EA2_5CDC:				; CODE XREF: SpriteOp3+31j
					; SpriteOp3+62j ...
		add	[bp+arg_2], 2
		add	[bp+arg_0], 2
		add	si, 2
		dec	[bp+arg_6]
		jg	short loc_1EA2_5CC0

loc_1EA2_5CEC:				; CODE XREF: SpriteOp3+Cj
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_5CF2:				; CODE XREF: SpriteOp3+3Cj
		test	di, 1
		jnz	short loc_1EA2_5D05
		shr	cx, 1
		jb	short loc_1EA2_5D00
		rep stosw
		jmp	short loc_1EA2_5CDC
; ---------------------------------------------------------------------------

loc_1EA2_5D00:				; CODE XREF: SpriteOp3+5Ej
		rep stosw
		stosb
		jmp	short loc_1EA2_5CDC
; ---------------------------------------------------------------------------

loc_1EA2_5D05:				; CODE XREF: SpriteOp3+5Aj
		shr	cx, 1
		jb	short loc_1EA2_5D10
		dec	cx
		stosb
		rep stosw
		stosb
		jmp	short loc_1EA2_5CDC
; ---------------------------------------------------------------------------

loc_1EA2_5D10:				; CODE XREF: SpriteOp3+6Bj
		stosb
		rep stosw
		jmp	short loc_1EA2_5CDC
SpriteOp3	endp

; ---------------------------------------------------------------------------
		align 2
; [00000023 BYTES: COLLAPSED FUNCTION nopsub_1EA2_5D16.	PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoClearImageArea proc far		; CODE XREF: RunCarMenu+2FDP
					; RunOpponentMenu+2FDP	...

var_4		= word ptr -4
var_2		= word ptr -2
p_pImgOfs	= word ptr  6
p_pImgSeg	= word ptr  8
p_x		= word ptr  0Ah
p_y		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+p_pImgSeg]
		mov	di, [bp+p_pImgOfs]
		mov	ax, [bp+p_x]
		mov	[bp+var_2], ax
		mov	[di+Shape2D.dwPosX], ax
		mov	ax, [bp+p_y]
		mov	[bp+var_4], ax
		mov	[di+Shape2D.dwPosY], ax
		jmp	short loc_1EA2_5D79
DoClearImageArea endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ClearImageArea	proc far		; CODE XREF: LoadIntroRes+731P

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_2]
		mov	di, [bp+arg_0]
		mov	ax, [di+8]
		mov	[bp+var_2], ax
		mov	ax, [di+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_5D79:				; CODE XREF: nopsub_1EA2_5D16+21j
					; DoClearImageArea+21j
		mov	ax, [di+Shape2D.dwWidth]
		mov	[bp+var_8], ax
		mov	ax, [di+Shape2D.dwHeight]
		mov	[bp+var_A], ax
		mov	bx, [bp+var_4]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	[bp+var_6], bx
		mov	ds, word ptr cs:g_pSprite1.pBitmap+2
		assume ds:nothing
		mov	es, [bp+arg_2]
		assume es:nothing
		add	di, 10h
		cld
		mov	dx, [bp+var_A]

loc_1EA2_5DA0:				; CODE XREF: ClearImageArea+55j
		mov	bx, [bp+var_6]
		mov	si, cs:[bx]
		add	si, [bp+var_2]
		mov	cx, [bp+var_8]
		rep movsb
		add	[bp+var_6], 2
		dec	dx
		jg	short loc_1EA2_5DA0
		pop	di
		pop	si
		pop	ds
		assume ds:dseg
		mov	sp, bp
		pop	bp
		retf
ClearImageArea	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ImageSpriteOp2	proc far		; CODE XREF: UpdateFrame+1FC5P

var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	cx, [bp+arg_6]
		mov	ax, [si+4]
		imul	[bp+arg_0]
		sub	cl, ah
		sbb	ch, dl
		mov	[bp+var_2], cx
		mov	cx, [bp+arg_8]
		mov	ax, [si+6]
		imul	[bp+arg_0]
		sub	cl, ah
		sbb	ch, dl
		mov	[bp+var_4], cx
		jmp	short loc_1EA2_5E2E
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [bp+arg_6]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_8]
		mov	[bp+var_4], ax
		jmp	short loc_1EA2_5E2E
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_5E0C:				; CODE XREF: ImageSpriteOp2+76j
					; ImageSpriteOp2+85j ...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	ds
		push	si
		push	di
		mov	ds, [bp+arg_4]
		mov	si, [bp+arg_2]
		mov	ax, [si+8]
		mov	[bp+var_2], ax
		mov	ax, [si+0Ah]
		mov	[bp+var_4], ax

loc_1EA2_5E2E:				; CODE XREF: ImageSpriteOp2+2Fj
					; ImageSpriteOp2+4Dj
		cmp	[bp+arg_0], 2
		jb	short loc_1EA2_5E0C
		cld
		mov	ax, [si+2]
		mul	[bp+arg_0]
		mov	al, ah
		mov	ah, dl
		or	ax, ax
		jz	short loc_1EA2_5E0C
		mov	[bp+var_8], ax
		mov	ax, [si]
		mov	[bp+var_A], ax
		mul	[bp+arg_0]
		mov	al, ah
		mov	ah, dl
		or	ax, ax
		jz	short loc_1EA2_5E0C
		mov	[bp+var_6], ax
		mov	dx, cs:g_pSprite1.dwWidth2
		sub	dx, ax
		mov	[bp+var_C], dx
		add	si, 10h
		mov	dx, 1
		xor	ax, ax
		mov	[bp+var_12], ax
		mov	[bp+var_14], ax
		div	[bp+arg_0]
		mov	[bp+var_10], ax
		mov	al, ah
		xor	ah, ah
		shr	ax, 1
		jz	short loc_1EA2_5E88
		add	si, ax
		mov	cx, ax

loc_1EA2_5E83:				; CODE XREF: ImageSpriteOp2+CAj
		add	si, [bp+var_A]
		loop	loc_1EA2_5E83

loc_1EA2_5E88:				; CODE XREF: ImageSpriteOp2+C1j
		mov	cx, [bp+var_6]
		mov	ax, [bp+var_2]
		mov	bx, cs:g_pSprite1.dwLeft2
		cmp	ax, bx
		jge	short loc_1EA2_5EB6
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_5F19
		mov	[bp+var_2], bx
		mov	[bp+var_6], ax
		xchg	ax, cx
		sub	ax, cx
		mul	[bp+var_10]
		xchg	al, dl
		xor	dh, dh
		mov	[bp+var_14], dx
		xchg	al, ah
		add	si, ax
		mov	ax, bx

loc_1EA2_5EB6:				; CODE XREF: ImageSpriteOp2+D9j
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwWidthSum
		jl	short loc_1EA2_5EC6
		sub	cx, ax
		jle	short loc_1EA2_5F19
		mov	[bp+var_6], cx

loc_1EA2_5EC6:				; CODE XREF: ImageSpriteOp2+101j
		mov	ax, cs:g_pSprite1.dwWidth2
		sub	ax, cx
		mov	[bp+var_C], ax
		mov	cx, [bp+var_8]
		mov	ax, [bp+var_4]
		mov	bx, cs:g_pSprite1.dwTop
		cmp	ax, bx
		jge	short loc_1EA2_5F00
		add	ax, cx
		sub	ax, bx
		jle	short loc_1EA2_5F19
		mov	[bp+var_8], ax
		mov	[bp+var_4], bx
		xchg	ax, cx
		sub	ax, cx
		mul	[bp+var_10]
		xchg	al, dl
		xor	dh, dh
		mov	[bp+var_12], dx
		xchg	al, ah
		mul	[bp+var_A]
		add	si, ax
		mov	ax, bx

loc_1EA2_5F00:				; CODE XREF: ImageSpriteOp2+120j
		add	ax, cx
		sub	ax, cs:g_pSprite1.dwHeight
		jl	short loc_1EA2_5F10
		sub	cx, ax
		jle	short loc_1EA2_5F19
		mov	[bp+var_8], cx

loc_1EA2_5F10:				; CODE XREF: ImageSpriteOp2+14Bj
		mov	dx, [bp+var_10]
		mov	[bp+var_E], si
		jmp	loc_1EA2_74B9
; ---------------------------------------------------------------------------

loc_1EA2_5F19:				; CODE XREF: ImageSpriteOp2+DFj
					; ImageSpriteOp2+105j ...
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
ImageSpriteOp2	endp

; ---------------------------------------------------------------------------
g_pSprite1	Sprite <0A0000000h, 0, 0, 0, offset g_wLineOffsets, 0, 140h, 0,	0C8h, \
					; DATA XREF: GetSprite1And2+6o
					; CopyToSprite1_2+Do ...
			140h, 0, 140h, 0, 140h>
g_pSprite2	Sprite <0A0000000h, 0, 0, 0, offset g_wLineOffsets, 0, 140h, 0,	0C8h, \
					; DATA XREF: SetSprite2As1_2o
					; SetSprite2Clearo ...
			140h, 0, 140h, 0, 140h>
g_wLineOffsets	dw 0, 140h, 280h, 3C0h,	500h, 640h, 780h, 8C0h,	0A00h
					; DATA XREF: seg012:g_pSprite1o
					; seg012:g_pSprite2o
		dw 0B40h, 0C80h, 0DC0h,	0F00h, 1040h, 1180h, 12C0h, 1400h
		dw 1540h, 1680h, 17C0h,	1900h, 1A40h, 1B80h, 1CC0h, 1E00h
		dw 1F40h, 2080h, 21C0h,	2300h, 2440h, 2580h, 26C0h, 2800h
		dw 2940h, 2A80h, 2BC0h,	2D00h, 2E40h, 2F80h, 30C0h, 3200h
		dw 3340h, 3480h, 35C0h,	3700h, 3840h, 3980h, 3AC0h, 3C00h
		dw 3D40h, 3E80h, 3FC0h,	4100h, 4240h, 4380h, 44C0h, 4600h
		dw 4740h, 4880h, 49C0h,	4B00h, 4C40h, 4D80h, 4EC0h, 5000h
		dw 5140h, 5280h, 53C0h,	5500h, 5640h, 5780h, 58C0h, 5A00h
		dw 5B40h, 5C80h, 5DC0h,	5F00h, 6040h, 6180h, 62C0h, 6400h
		dw 6540h, 6680h, 67C0h,	6900h, 6A40h, 6B80h, 6CC0h, 6E00h
		dw 6F40h, 7080h, 71C0h,	7300h, 7440h, 7580h, 76C0h, 7800h
		dw 7940h, 7A80h, 7BC0h,	7D00h, 7E40h, 7F80h, 80C0h, 8200h
		dw 8340h, 8480h, 85C0h,	8700h, 8840h, 8980h, 8AC0h, 8C00h
		dw 8D40h, 8E80h, 8FC0h,	9100h, 9240h, 9380h, 94C0h, 9600h
		dw 9740h, 9880h, 99C0h,	9B00h, 9C40h, 9D80h, 9EC0h, 0A000h
		dw 0A140h, 0A280h, 0A3C0h, 0A500h, 0A640h, 0A780h, 0A8C0h
		dw 0AA00h, 0AB40h, 0AC80h, 0ADC0h, 0AF00h, 0B040h, 0B180h
		dw 0B2C0h, 0B400h, 0B540h, 0B680h, 0B7C0h, 0B900h, 0BA40h
		dw 0BB80h, 0BCC0h, 0BE00h, 0BF40h, 0C080h, 0C1C0h, 0C300h
		dw 0C440h, 0C580h, 0C6C0h, 0C800h, 0C940h, 0CA80h, 0CBC0h
		dw 0CD00h, 0CE40h, 0CF80h, 0D0C0h, 0D200h, 0D340h, 0D480h
		dw 0D5C0h, 0D700h, 0D840h, 0D980h, 0DAC0h, 0DC00h, 0DD40h
		dw 0DE80h, 0DFC0h, 0E100h, 0E240h, 0E380h, 0E4C0h, 0E600h
		dw 0E740h, 0E880h, 0E9C0h, 0EB00h, 0EC40h, 0ED80h, 0EEC0h
		dw 0F000h, 0F140h, 0F280h, 0F3C0h, 0F500h, 0F640h, 0F780h
		dw 0F8C0h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetTwoFontBytes	proc far		; CODE XREF: RunTracksMenu+1A8P
					; MainTextResFont+1ABP	...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	es, g_segFontDef
		mov	ax, [bp+arg_2]
		xor	ah, ah
		mov	es:2, ax
		mov	ax, [bp+arg_0]
		xor	ah, ah
		mov	es:0, ax
		pop	bp
		retf
SetTwoFontBytes	endp

; [00000017 BYTES: COLLAPSED FUNCTION sub_1EA2_6107. PRESS KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION sub_1EA2_611E. PRESS KEYPAD "+" TO EXPAND]
; [0000001C BYTES: COLLAPSED FUNCTION sub_1EA2_6140. PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetFontDefSeg	proc far		; CODE XREF: SetFontDefImpl+9P

arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_2]
		mov	g_segFontDef, ax
		pop	bp
		retf
SetFontDefSeg	endp

; ---------------------------------------------------------------------------
		align 2
; [0000000E BYTES: COLLAPSED FUNCTION sub_1EA2_6168. PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SpriteOp4	proc far		; DATA XREF: DeriveSpriteOp4+34o

var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= byte ptr  0Eh

		push	bp
		mov	bp, sp
		push	si
		push	di

loc_1EA2_617B:				; CODE XREF: sub_1EA2_6168+Bj
		cld
		mov	si, [bp+arg_4]
		test	si, 1
		jnz	short loc_1EA2_618D
		mov	ax, g_wSpriteOpFlag
		xchg	ah, al
		mov	g_wSpriteOpFlag, ax

loc_1EA2_618D:				; CODE XREF: SpriteOp4+Dj
		mov	si, [bp+arg_4]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		assume es:nothing
		mov	al, [bp+arg_8]

loc_1EA2_61A0:				; CODE XREF: SpriteOp4+6Aj
		mov	bx, [bp+arg_2]
		mov	dx, [bx]
		mov	bx, [bp+arg_0]
		mov	bx, [bx]
		mov	ah, byte ptr g_wSpriteOpFlag
		mov	cl, bl
		and	cl, 7
		rol	ah, cl
		mov	cx, dx
		sub	cx, bx
		inc	cx
		jle	short loc_1EA2_61C8
		mov	di, cs:[si]
		add	di, bx

loc_1EA2_61C1:				; CODE XREF: SpriteOp4+50j
					; SpriteOp4+71j
		rol	ah, 1
		jnb	short loc_1EA2_61E6
		stosb
		loop	loc_1EA2_61C1

loc_1EA2_61C8:				; CODE XREF: SpriteOp4+44j
					; SpriteOp4+73j
		add	[bp+arg_2], 2
		add	[bp+arg_0], 2
		add	si, 2
		mov	dx, g_wSpriteOpFlag
		xchg	dh, dl
		mov	g_wSpriteOpFlag, dx
		dec	[bp+arg_6]
		jg	short loc_1EA2_61A0
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_61E6:				; CODE XREF: SpriteOp4+4Dj
		inc	di
		loop	loc_1EA2_61C1
		jmp	short loc_1EA2_61C8
; ---------------------------------------------------------------------------
		align 2
SpriteOp4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MakeWndSprite	proc far		; CODE XREF: RunIntroInLoop+3EP
					; RunIntroInLoop+A6P ...

wWidth		= word ptr -8
wResSize	= word ptr -6
pCurWndDef	= word ptr -4
dwAllocResSeg	= word ptr -2
p_width		= word ptr  6
p_height	= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	ds
		push	si
		push	di
		mov	ax, [bp+p_width]
		mov	[bp+wWidth], ax
		mov	bx, [bp+p_height]
		imul	bx
		add	ax, 10h
		mov	cx, 4
		shr	ax, cl
		inc	ax
		mov	bx, ax
		mov	[bp+wResSize], ax
		push	ax
		mov	ax, offset aMcgaWindow ; "MCGA WINDOW"
		push	ax
		call	AllocResPages	; Returns offset to buffer in dx:ax, ax	is always 0
		add	sp, 4
		mov	[bp+dwAllocResSeg], dx


		mov	ds, dx		; the buffer we	alloced	is in dx:ax, we	treat this as a	Shape2D
		xor	bx, bx
		mov	ax, [bp+wWidth]
		mov	[bx+Shape2D.dwWidth], ax ; write wWidth	to new res dest0
		mov	ax, [bp+p_height]
		mov	[bx+Shape2D.dwHeight], ax ; write height to dest2
		xor	ax, ax
		mov	[bx+Shape2D.dwPosX], ax	; write	0 to dest8
		mov	[bx+Shape2D.dwPosY], ax	; write	0 to desta
		mov	[bx+Shape2D.dwUnk1], ax	; ... etc
		mov	[bx+Shape2D.dwUnk2], ax
		mov	ax, 0Fh
		add	ax, [bp+p_height]
		shl	ax, 1
		mov	bx, cs:g_ppNextWndDef
		mov	[bp+pCurWndDef], bx
		add	ax, bx		; ax = (15 + height) <<	1) + curwnddef
		cmp	ax, offset SetSprite1 ;	SetSprite1 happens to be the end of the	buffer.. see below this	func
		jnb	short loc_1EA2_62B6 ; is ax out	of range?


		mov	cs:g_ppNextWndDef, ax
		mov	word ptr cs:[bx+Sprite.pBitmap], 0 ; write 0 to	old wnddef+0
		mov	ax, [bp+dwAllocResSeg]
		mov	word ptr cs:[bx+(Sprite.pBitmap+2)], ax	; write	var2 to	old wnddef+2
		lea	ax, [bx+1Eh]	; get offset to	end of images, which is	to the line offsets in the same	chunk as the 15	image-words
		mov	cs:[bx+Sprite.pwLineOffsets], ax ; and write it	to olddef+a
		mov	cs:[bx+Sprite.dwLeft], 0
		mov	cs:[bx+Sprite.dwLeft2],	0
		mov	ax, [bp+wWidth]
		mov	cs:[bx+Sprite.dwWidth1], ax
		mov	cs:[bx+Sprite.dwWidth2], ax
		mov	cs:[bx+Sprite.dwTop], 0
		mov	ax, [bp+p_height]
		mov	cs:[bx+Sprite.dwHeight], ax
		mov	ax, [bp+p_width]
		mov	cs:[bx+Sprite.dwWidth3], ax

loc_1EA2_6294:
		mov	cs:[bx+Sprite.dwWidthSum], ax
		mov	cx, [bp+p_height]
		mov	ax, 10h

loc_1EA2_629E:				; CODE XREF: MakeWndSprite+BCj
		mov	cs:[bx+1Eh], ax	; point	at end-of-image	offset
		add	bx, 2
		add	ax, [bp+wWidth]
		loop	loc_1EA2_629E	; loop height times


		mov	dx, cs
		mov	ax, [bp+pCurWndDef] ; returns pointer to a Sprite which	points to a Shape2D in its pTargetSeg:pTargetOfs
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_62B6:				; CODE XREF: MakeWndSprite+64j
		mov	ax, ss
		mov	ds, ax
		mov	ax, offset aWindowdefOutOf ; "windowdef	- OUT OF ROW TABLE SPACE\r"
		push	ax
		call	far ptr	ErrorMessage
		nop
MakeWndSprite	endp

; ---------------------------------------------------------------------------
g_ppNextWndDef	dw offset g_arrWndDefs	; DATA XREF: ReleaseWindow+1Fr
					; ReleaseWindow+2Aw ...
g_arrWndDefs	db 0E10h dup(0)		; DATA XREF: seg012:g_ppNextWndDefo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetSprite1	proc far		; CODE XREF: EndOfGameScores+CA9P
					; EndOfGameScores+1117P ...

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	ds
		push	si
		push	di
		cld
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	cx, 0Fh
		mov	ax, cs
		mov	es, ax
		assume es:seg012
		mov	di, offset g_pSprite1
		rep movsw		; ds:si	-> es:di
		pop	di
		pop	si
		pop	ds
		pop	bp
		retf
SetSprite1	endp


; =============== S U B	R O U T	I N E =======================================


SetSprite2As1	proc far		; CODE XREF: SetupCarShapes+19CP
					; RplyMouseSpriteStuff:loc_11B7_246AP ...
		mov	ax, seg	seg012
		push	ax
		mov	ax, offset g_pSprite2 ;	on cs /	seg12
		push	ax
		call	SetSprite1
		add	sp, 4
		retf
SetSprite2As1	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PutPixel	proc far		; CODE XREF: RunCarMenu+6F0P
					; sub_9F1_3F96+15DP ...

dwX		= word ptr  6
dwY		= word ptr  8
dwColor		= word ptr  0Ah

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	ax, [bp+dwX]
		cmp	ax, cs:g_pSprite1.dwLeft
		jl	short loc_1EA2_712D
		cmp	ax, cs:g_pSprite1.dwWidth1
		jge	short loc_1EA2_712D
		mov	ax, [bp+dwY]
		cmp	ax, cs:g_pSprite1.dwTop
		jl	short loc_1EA2_712D
		cmp	ax, cs:g_pSprite1.dwHeight
		jl	short loc_1EA2_7136

loc_1EA2_712D:				; CODE XREF: PutPixel+Dj PutPixel+14j	...
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		push	si
		push	di

loc_1EA2_7136:				; CODE XREF: PutPixel+25j
		mov	di, [bp+dwX]
		mov	si, [bp+dwY]
		shl	si, 1
		add	si, cs:g_pSprite1.pwLineOffsets
		add	di, cs:[si]
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		assume es:nothing
		mov	ax, [bp+dwColor]
		mov	es:[di], al
		pop	di
		pop	si
		pop	bp
		retf
PutPixel	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Sprite1Op	proc far		; CODE XREF: sub_2702_E+31P
					; sub_2702_E+49P ...

p_x		= word ptr  6
p_y		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= byte ptr  0Eh

		push	bp
		mov	bp, sp
		push	si
		push	di
		mov	dx, cs:g_pSprite1.dwLeft
		mov	ax, dx
		sub	ax, [bp+p_x]
		jle	short loc_1EA2_716F
		mov	[bp+p_x], dx
		sub	[bp+arg_4], ax
		jle	short loc_1EA2_71AD

loc_1EA2_716F:				; CODE XREF: Sprite1Op+Fj
		mov	ax, [bp+p_x]
		add	ax, [bp+arg_4]
		sub	ax, cs:g_pSprite1.dwWidth1
		jle	short loc_1EA2_7181
		sub	[bp+arg_4], ax
		jle	short loc_1EA2_71AD

loc_1EA2_7181:				; CODE XREF: Sprite1Op+24j
		mov	ax, cs:g_pSprite1.dwTop
		sub	ax, [bp+p_y]
		jle	short loc_1EA2_7196
		sub	[bp+arg_6], ax
		jle	short loc_1EA2_71AD
		mov	ax, cs:g_pSprite1.dwTop
		mov	[bp+p_y], ax

loc_1EA2_7196:				; CODE XREF: Sprite1Op+32j
		mov	ax, [bp+p_y]
		add	ax, [bp+arg_6]
		mov	bx, cs:g_pSprite1.dwHeight
		sub	ax, bx
		jle	short loc_1EA2_71B5
		sub	[bp+arg_6], ax
		jle	short loc_1EA2_71AD
		jmp	short loc_1EA2_71B5
; ---------------------------------------------------------------------------
		nop

loc_1EA2_71AD:				; CODE XREF: Sprite1Op+17j
					; Sprite1Op+29j ...
		jmp	short loc_1EA2_7205
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		push	si
		push	di

loc_1EA2_71B5:				; CODE XREF: Sprite1Op+4Dj
					; Sprite1Op+54j
		cld
		cmp	[bp+arg_4], 0
		jle	short loc_1EA2_71AD
		cmp	[bp+arg_6], 0
		jle	short loc_1EA2_71AD
		mov	es, word ptr cs:g_pSprite1.pBitmap+2
		mov	al, [bp+arg_8]
		mov	ah, al
		mov	dx, [bp+p_x]
		mov	si, [bp+arg_6]
		mov	bx, [bp+p_y]
		shl	bx, 1
		add	bx, cs:g_pSprite1.pwLineOffsets
		mov	di, cs:[bx]
		add	di, [bp+p_x]
		mov	dx, cs:g_pSprite1.dwWidth2
		sub	dx, [bp+arg_4]
		mov	cx, [bp+arg_4]
		sar	cx, 1
		mov	[bp+arg_4], cx
		jb	short loc_1EA2_7209
		jle	short loc_1EA2_7205

loc_1EA2_71F6:				; CODE XREF: Sprite1Op+ADj
		mov	cx, [bp+arg_4]

loc_1EA2_71F9:				; CODE XREF: Sprite1Op+A8j
		xor	es:[di], ax
		inc	di
		inc	di
		loop	loc_1EA2_71F9
		add	di, dx
		dec	si
		jg	short loc_1EA2_71F6

loc_1EA2_7205:				; CODE XREF: Sprite1Op:loc_1EA2_71ADj
					; Sprite1Op+9Ej ...
		pop	di
		pop	si
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_7209:				; CODE XREF: Sprite1Op+9Cj
		jz	short loc_1EA2_7222
		jl	short loc_1EA2_7205
		inc	dx

loc_1EA2_720E:				; CODE XREF: Sprite1Op+C8j
		mov	cx, [bp+arg_4]

loc_1EA2_7211:				; CODE XREF: Sprite1Op+C0j
		xor	es:[di], ax
		inc	di
		inc	di
		loop	loc_1EA2_7211
		xor	es:[di], al
		add	di, dx
		dec	si
		jg	short loc_1EA2_720E
		jmp	short loc_1EA2_7205
; ---------------------------------------------------------------------------

loc_1EA2_7222:				; CODE XREF: Sprite1Op:loc_1EA2_7209j
		inc	dx

loc_1EA2_7223:				; CODE XREF: Sprite1Op+D3j
		xor	es:[di], al
		add	di, dx
		dec	si
		jg	short loc_1EA2_7223
		jmp	short loc_1EA2_7205
Sprite1Op	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Sprite1_2Op	proc far		; CODE XREF: SetupIntro+526P
					; RunGame+747P

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		push	di
		push	ds
		cld
		mov	ax, word ptr cs:g_pSprite1.pBitmap+2
		mov	es, ax
		mov	ax, word ptr cs:g_pSprite2.pBitmap+2
		mov	ds, ax
		assume ds:nothing
		mov	ax, [bp+arg_0]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_4]
		mov	ax, [bp+arg_2]
		shl	ax, 1
		mov	cx, ax
		add	ax, cs:g_pSprite2.pwLineOffsets
		mov	[bp+var_4], ax
		add	cx, cs:g_pSprite1.pwLineOffsets
		mov	ax, [bp+arg_8]
		mov	bx, ax
		add	ax, [bp+arg_0]
		cwd
		idiv	cs:g_pSprite1.dwWidth3
		sub	dx, [bp+arg_0]
		shl	ax, 1
		add	cx, ax
		add	[bp+var_2], dx
		mov	[bp+var_6], cx
		mov	dx, [bp+arg_6]

loc_1EA2_727F:				; CODE XREF: Sprite1_2Op+71j
		mov	cx, [bp+arg_4]
		mov	bx, [bp+var_4]
		mov	si, cs:[bx]
		add	si, [bp+arg_0]
		mov	bx, [bp+var_6]
		mov	di, cs:[bx]
		add	di, [bp+var_2]
		rep movsb
		add	[bp+var_4], 2
		add	[bp+var_6], 2
		dec	dx
		jg	short loc_1EA2_727F
		pop	ds
		assume ds:dseg
		pop	di
		pop	si
		mov	sp, bp
		pop	bp
		retf
Sprite1_2Op	endp

; ---------------------------------------------------------------------------
g_arrIncNums	db 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: Sprite1Op2+110r
					; SpriteOp2+4Er ...
		db 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		db 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		db 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		db 30h,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 3Ah
		db 3Bh,	3Ch, 3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h,	44h, 45h
		db 46h,	47h, 48h, 49h, 4Ah, 4Bh, 4Ch, 4Dh, 4Eh,	4Fh, 50h
		db 51h,	52h, 53h, 54h, 55h, 56h, 57h, 58h, 59h,	5Ah, 5Bh
		db 5Ch,	5Dh, 5Eh, 5Fh, 60h, 61h, 62h, 63h, 64h,	65h, 66h
		db 67h,	68h, 69h, 6Ah, 6Bh, 6Ch, 6Dh, 6Eh, 6Fh,	70h, 71h
		db 72h,	73h, 74h, 75h, 76h, 77h, 78h, 79h, 7Ah,	7Bh, 7Ch
		db 7Dh,	7Eh, 7Fh, 80h, 81h, 82h, 83h, 84h, 85h,	86h, 87h
		db 88h,	89h, 8Ah, 8Bh, 8Ch, 8Dh, 8Eh, 8Fh, 90h,	91h, 92h
		db 93h,	94h, 95h, 96h, 97h, 98h, 99h, 9Ah, 9Bh,	9Ch, 9Dh
		db 9Eh,	9Fh, 0A0h, 0A1h, 0A2h, 0A3h, 0A4h, 0A5h, 0A6h
		db 0A7h, 0A8h, 0A9h, 0AAh, 0ABh, 0ACh, 0ADh, 0AEh, 0AFh
		db 0B0h, 0B1h, 0B2h, 0B3h, 0B4h, 0B5h, 0B6h, 0B7h, 0B8h
		db 0B9h, 0BAh, 0BBh, 0BCh, 0BDh, 0BEh, 0BFh, 0C0h, 0C1h
		db 0C2h, 0C3h, 0C4h, 0C5h, 0C6h, 0C7h, 0C8h, 0C9h, 0CAh
		db 0CBh, 0CCh, 0CDh, 0CEh, 0CFh, 0D0h, 0D1h, 0D2h, 0D3h
		db 0D4h, 0D5h, 0D6h, 0D7h, 0D8h, 0D9h, 0DAh, 0DBh, 0DCh
		db 0DDh, 0DEh, 0DFh, 0E0h, 0E1h, 0E2h, 0E3h, 0E4h, 0E5h
		db 0E6h, 0E7h, 0E8h, 0E9h, 0EAh, 0EBh, 0ECh, 0EDh, 0EEh
		db 0EFh, 0F0h, 0F1h, 0F2h, 0F3h, 0F4h, 0F5h, 0F6h, 0F7h
		db 0F8h, 0F9h, 0FAh, 0FBh, 0FCh, 0FDh, 0FEh, 0FFh
; [0000001E BYTES: COLLAPSED FUNCTION nopsub_1EA2_73A8.	PRESS KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION nopsub_1EA2_73C6.	PRESS KEYPAD "+" TO EXPAND]
; [00000057 BYTES: COLLAPSED FUNCTION nopsub_1EA2_73E8.	PRESS KEYPAD "+" TO EXPAND]
; [000000E8 BYTES: COLLAPSED FUNCTION nopsub_1EA2_743F.	PRESS KEYPAD "+" TO EXPAND]
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_7528	proc far		; CODE XREF: Load2DShape+2A9P

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		mov	es, [bp+arg_2]
		assume es:nothing
		mov	di, [bp+arg_0]
		mov	si, [bp+arg_4]
		mov	cx, es:[di+4]
		mov	[bp+var_2], cx
		xor	ax, ax
		mov	[bp+var_4], ax

loc_1EA2_7545:				; CODE XREF: sub_1EA2_7528+57j
		mov	ax, [bp+var_4]
		cmp	ax, [bp+var_2]
		jl	short loc_1EA2_7553
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_7553:				; CODE XREF: sub_1EA2_7528+23j
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4Scaled
		add	sp, 6
		mov	es, dx
		mov	di, ax
		mov	ax, es:[di]
		mul	word ptr es:[di+2]
		mov	cx, ax
		add	di, 10h
		xor	bx, bx

loc_1EA2_7574:				; CODE XREF: sub_1EA2_7528+52j
		mov	bl, es:[di]
		mov	al, [bx+si]
		stosb
		loop	loc_1EA2_7574
		inc	[bp+var_4]
		jmp	short loc_1EA2_7545
sub_1EA2_7528	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_7582	proc far		; CODE XREF: Load2DShape+277P

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	di
		push	si
		push	ds
		mov	ds, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	es, [bp+arg_6]
		mov	di, [bp+arg_4]
		mov	cx, [si+4]
		mov	[bp+var_2], cx
		shl	cx, 1
		add	cx, 1
		add	si, 4
		add	di, 4
		rep movsw
		xor	ax, ax
		mov	[bp+var_4], ax
		mov	[bp+var_6], di
		mov	es:[di], ax
		mov	es:[di+2], ax

loc_1EA2_75B9:				; CODE XREF: sub_1EA2_7582+150j
		mov	ax, [bp+var_4]
		cmp	ax, [bp+var_2]
		jl	short loc_1EA2_75C8
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_75C8:				; CODE XREF: sub_1EA2_7582+3Dj
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		mov	ax, ss
		mov	ds, ax
		call	GetWord4Scaled
		add	sp, 6
		mov	ds, dx
		mov	si, ax
		mov	[bp+var_A], dx
		mov	[bp+var_C], ax
		mov	es, [bp+arg_6]
		mov	di, [bp+var_6]
		mov	bx, es:[di]
		mov	cx, es:[di+2]
		add	di, 4
		mov	[bp+var_6], di
		mov	ax, [si]
		mul	word ptr [si+2]
		mov	[bp+var_E], ax
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		add	ax, 10h
		add	ax, bx
		adc	dx, cx
		mov	bx, [bp+var_4]
		inc	bx
		cmp	bx, [bp+var_2]
		jge	short loc_1EA2_7620
		mov	es:[di], ax
		mov	es:[di+2], dx
		jmp	short loc_1EA2_763B
; ---------------------------------------------------------------------------
		align 2

loc_1EA2_7620:				; CODE XREF: sub_1EA2_7582+92j
		mov	bx, [bp+var_2]
		shl	bx, 1
		shl	bx, 1
		shl	bx, 1
		add	bx, 6
		add	ax, bx
		adc	dx, 0
		mov	di, [bp+arg_4]
		mov	es:[di], ax
		mov	es:[di+2], dx

loc_1EA2_763B:				; CODE XREF: sub_1EA2_7582+9Bj
		push	[bp+var_4]
		push	[bp+arg_6]
		push	[bp+arg_4]
		mov	ax, ss
		mov	ds, ax
		call	GetWord4Scaled
		add	sp, 6
		mov	es, dx
		mov	di, ax
		mov	[bp+var_10], ax
		mov	ds, [bp+var_A]
		mov	cx, 6
		rep movsw
		mov	si, [bp+var_C]
		mov	di, [bp+var_10]
		mov	ax, [si]
		shl	ax, 1
		shl	ax, 1
		shl	ax, 1
		mov	es:[di], ax
		mov	al, [si+0Dh]
		shr	al, 1
		shr	al, 1
		shr	al, 1
		shr	al, 1
		mov	ah, al
		add	di, 10h
		mov	cx, [bp+var_E]
		cmp	cx, 0
		jle	short loc_1EA2_76CF
		cmp	cx, 1F40h
		jg	short loc_1EA2_76CF
		shl	cx, 1
		shl	cx, 1
		rep stosw
		add	si, 10h
		mov	[bp+var_8], si
		xor	bx, bx

loc_1EA2_769C:				; CODE XREF: sub_1EA2_7582+14Bj
		mov	si, [bp+var_C]
		mov	ah, [bx+si+0Ch]
		and	ah, 0Fh
		jz	short loc_1EA2_76CF
		mov	di, [bp+var_10]
		add	di, 10h
		mov	si, [bp+var_8]
		mov	dx, [bp+var_E]

loc_1EA2_76B3:				; CODE XREF: sub_1EA2_7582+140j
		lodsb
		mov	cx, 8

loc_1EA2_76B7:				; CODE XREF: sub_1EA2_7582+13Dj
		shl	al, 1
		jnb	short loc_1EA2_76BE
		or	es:[di], ah

loc_1EA2_76BE:				; CODE XREF: sub_1EA2_7582+137j
		inc	di
		loop	loc_1EA2_76B7
		dec	dx
		jg	short loc_1EA2_76B3
		mov	[bp+var_8], si
		shl	ah, 1
		inc	bx
		cmp	bx, 4
		jl	short loc_1EA2_769C

loc_1EA2_76CF:				; CODE XREF: sub_1EA2_7582+104j
					; sub_1EA2_7582+10Aj ...
		inc	[bp+var_4]
		jmp	loc_1EA2_75B9
sub_1EA2_7582	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1EA2_76D6	proc far		; CODE XREF: Load2DShape+1A5P

var_14		= byte ptr -14h
var_12		= byte ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 14h
		push	ds
		push	si
		push	di
		mov	ax, [bp+arg_2]
		mov	ds, ax
		mov	ax, [bp+arg_0]
		mov	si, ax
		mov	bx, [si+4]
		mov	[bp+var_2], bx
		mov	[bp+var_4], 0

loc_1EA2_76F4:				; CODE XREF: sub_1EA2_76D6+5Ej
		push	[bp+var_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		mov	ax, seg	dseg
		mov	ds, ax
		call	GetWord4Scaled
		add	sp, 6
		mov	[bp+var_6], ax
		mov	[bp+var_8], dx
		mov	si, ax
		mov	ds, dx
		mov	al, [si+0Fh]
		and	al, 0F0h
		jnz	short loc_1EA2_772E
		mov	bl, [si+0Eh]
		shr	bl, 1
		shr	bl, 1
		shr	bl, 1
		shr	bl, 1
		and	bl, 0Fh
		mov	[bp+var_14], bl
		jnz	short loc_1EA2_773D

loc_1EA2_772E:				; CODE XREF: sub_1EA2_76D6+43j
					; sub_1EA2_76D6+C4j
		inc	[bp+var_4]
		dec	[bp+var_2]
		jg	short loc_1EA2_76F4
		pop	di
		pop	si
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_1EA2_773D:				; CODE XREF: sub_1EA2_76D6+56j
		mov	ax, [si]
		mov	[bp+var_A], ax
		mov	dx, [si+2]
		mov	[bp+var_C], dx
		mul	dx
		mov	[bp+var_E], ax
		add	si, 10h
		mov	[bp+var_10], si
		mov	[bp+var_12], 4

loc_1EA2_7757:				; CODE XREF: sub_1EA2_76D6+C2j
		shr	[bp+var_14], 1
		jnb	short loc_1EA2_778F
		mov	es, [bp+arg_6]
		mov	di, [bp+arg_4]
		mov	ds, [bp+var_8]
		xor	dx, dx
		mov	bx, [bp+var_C]

loc_1EA2_776A:				; CODE XREF: sub_1EA2_76D6+A6j
		mov	si, [bp+var_10]
		add	si, dx
		mov	cx, [bp+var_A]

loc_1EA2_7772:				; CODE XREF: sub_1EA2_76D6+A1j
		mov	al, [si]
		stosb
		add	si, bx
		loop	loc_1EA2_7772
		inc	dx
		cmp	dx, bx
		jnz	short loc_1EA2_776A
		mov	es, [bp+var_8]
		mov	di, [bp+var_10]
		mov	ds, [bp+arg_6]
		mov	si, [bp+arg_4]
		mov	cx, [bp+var_E]
		rep movsb

loc_1EA2_778F:				; CODE XREF: sub_1EA2_76D6+84j
		mov	ax, [bp+var_E]
		add	[bp+var_10], ax
		dec	[bp+var_12]
		jnz	short loc_1EA2_7757
		jmp	short loc_1EA2_772E
sub_1EA2_76D6	endp

seg012		ends

; ===========================================================================

; Segment type:	Pure code
seg013		segment	byte public 'CODE' use16
		assume cs:seg013
		;org 0Ch
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_261B_C	proc far		; CODE XREF: RplyMouseSpriteStuff+2C6P
					; RplyMouseSpriteStuff+45CP ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 4
		mov	ax, [bp+arg_4]
		sub	ax, [bp+arg_0]
		inc	ax
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		sub	ax, [bp+arg_2]
		mov	[bp+var_4], ax
		cmp	[bp+var_2], 0
		jle	short loc_261B_5B
		push	[bp+arg_8]
		mov	ax, 1
		push	ax
		push	[bp+var_2]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	SpriteSizeOp
		add	sp, 0Ah
		push	[bp+arg_8]
		mov	ax, 1
		push	ax
		push	[bp+var_2]
		push	[bp+arg_6]
		push	[bp+arg_0]
		call	SpriteSizeOp
		add	sp, 0Ah

loc_261B_5B:				; CODE XREF: sub_261B_C+1Dj
		cmp	[bp+var_4], 0
		jle	short loc_261B_91
		push	[bp+arg_8]
		push	[bp+var_4]
		mov	ax, 1
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	SpriteSizeOp
		add	sp, 0Ah
		push	[bp+arg_8]
		push	[bp+var_4]
		mov	ax, 1
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_4]
		call	SpriteSizeOp
		add	sp, 0Ah

loc_261B_91:				; CODE XREF: sub_261B_C+53j
		mov	sp, bp
		pop	bp
		retf
sub_261B_C	endp

seg013		ends

; ===========================================================================

; Segment type:	Pure code
seg014		segment	byte public 'CODE' use16
		assume cs:seg014
		;org 5
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2624_6	proc far		; CODE XREF: sub_26B1_6+87P
					; sub_26B1_6+9AP

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		mov	bx, [bp+arg_0]
		mov	si, [bx]
		mov	ax, [bx+4]
		sub	ax, si
		mov	bx, [bp+arg_2]
		mov	[bx], ax
		mov	bx, [bp+arg_0]
		mov	ax, [bx+6]
		sub	ax, [bx+2]
		mov	bx, [bp+arg_2]
		mov	[bx+2],	ax
		mov	bx, [bp+arg_0]
		mov	ax, [bx+8]
		sub	ax, si
		mov	bx, [bp+arg_2]
		mov	[bx+10h], ax
		mov	bx, [bp+arg_0]
		mov	ax, [bx+0Ah]
		sub	ax, [bx+2]
		mov	bx, [bp+arg_2]
		mov	[bx+12h], ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+10h]
		add	ax, [bx]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+8],	ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+2]
		add	ax, [bx+12h]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+0Ah], ax
		mov	si, [bx+10h]
		sar	si, 1
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx]
		add	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+4],	ax
		mov	di, [bx+12h]
		sar	di, 1
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+2]
		add	ax, di
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+6],	ax
		mov	ax, [bx]
		sar	ax, 1
		mov	[bp+var_4], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+10h]
		add	ax, [bp+var_4]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+0Ch], ax
		mov	ax, [bx+2]
		sar	ax, 1
		mov	[bp+var_6], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+12h]
		add	ax, [bp+var_6]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+0Eh], ax
		mov	ax, [bx]
		neg	ax
		mov	[bp+var_8], ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+10h]
		add	ax, [bp+var_8]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+18h], ax
		mov	ax, [bx+2]
		neg	ax
		mov	[bp+var_A], ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+12h]
		add	ax, [bp+var_A]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+1Ah], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bp+var_8]
		add	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+1Ch], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bp+var_A]
		add	ax, di
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+1Eh], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+10h]
		sub	ax, [bp+var_4]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+14h], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+12h]
		sub	ax, [bp+var_6]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+16h], ax
		mov	[bp+var_2], 0

loc_2624_19C:				; CODE XREF: sub_2624_6+1C4j
		mov	si, [bp+var_2]
		mov	cl, 2
		shl	si, cl
		add	si, [bp+arg_2]
		mov	bx, [bp+arg_0]
		mov	di, [bx]
		mov	ax, di
		sub	ax, [si]
		mov	[si+20h], ax
		mov	ax, [bx+2]
		sub	ax, [si+2]
		mov	[si+22h], ax
		add	[si], di
		mov	ax, [bx+2]
		add	[si+2],	ax
		inc	[bp+var_2]
		cmp	[bp+var_2], 8
		jl	short loc_2624_19C
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_2624_6	endp

seg014		ends

; ===========================================================================

; Segment type:	Pure code
seg015		segment	byte public 'CODE' use16
		assume cs:seg015
		;org 2
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2641_2	proc far		; CODE XREF: sub_26BB_E+EP

var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 1Ah
		push	di
		push	si
		mov	bx, [bp+arg_0]
		mov	si, [bx]
		mov	ax, [bx+4]
		sub	ax, si
		mov	bx, [bp+arg_2]
		mov	[bx], ax
		mov	bx, [bp+arg_0]
		mov	ax, [bx+6]
		sub	ax, [bx+2]
		mov	bx, [bp+arg_2]
		mov	[bx+2],	ax
		mov	bx, [bp+arg_0]
		mov	ax, [bx+8]
		sub	ax, si
		mov	bx, [bp+arg_2]
		mov	[bx+20h], ax
		mov	bx, [bp+arg_0]
		mov	ax, [bx+0Ah]
		sub	ax, [bx+2]
		mov	bx, [bp+arg_2]
		mov	[bx+22h], ax
		mov	ax, [bx]
		sar	ax, 1
		mov	[bp+var_2], ax
		sar	ax, 1
		mov	[bp+var_A], ax
		mov	ax, [bp+var_2]
		add	ax, [bp+var_A]
		mov	[bp+var_6], ax
		mov	ax, [bx+2]
		sar	ax, 1
		mov	[bp+var_4], ax
		sar	ax, 1
		mov	[bp+var_C], ax
		mov	ax, [bp+var_4]
		add	ax, [bp+var_C]
		mov	[bp+var_8], ax
		mov	ax, [bx+20h]
		sar	ax, 1
		mov	[bp+var_10], ax
		sar	ax, 1
		mov	[bp+var_18], ax
		mov	ax, [bp+var_10]
		add	ax, [bp+var_18]
		mov	[bp+var_14], ax
		mov	ax, [bx+22h]
		sar	ax, 1
		mov	[bp+var_12], ax
		sar	ax, 1
		mov	[bp+var_1A], ax
		mov	ax, [bp+var_12]
		add	ax, [bp+var_1A]
		mov	[bp+var_16], ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+20h]
		add	ax, [bx]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+10h], ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+2]
		add	ax, [bx+22h]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+12h], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx]
		add	ax, [bp+var_10]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+8],	ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+2]
		add	ax, [bp+var_12]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+0Ah], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+20h]
		add	ax, [bp+var_2]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+18h], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+22h]

loc_2641_11E:
		add	ax, [bp+var_4]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+1Ah], ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bx]
		add	ax, [bp+var_18]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+4],	ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bx+2]
		add	ax, [bp+var_1A]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+6],	ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bx+20h]
		add	ax, [bp+var_A]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+1Ch], ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bx+22h]
		add	ax, [bp+var_C]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+1Eh], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bx]
		add	ax, [bp+var_14]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+0Ch], ax
		mov	ax, 3333h
		push	ax

loc_2641_1AF:
		mov	ax, [bx+2]
		add	ax, [bp+var_16]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+0Eh], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bx+20h]
		add	ax, [bp+var_6]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+14h], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bx+22h]
		add	ax, [bp+var_8]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+16h], ax
		mov	ax, [bx]
		neg	ax
		mov	si, ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+20h]
		add	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+30h], ax
		mov	ax, [bx+2]
		neg	ax
		mov	di, ax
		mov	ax, 2D41h
		push	ax
		mov	ax, [bx+22h]
		add	ax, di
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+32h], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bp+var_10]
		add	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+38h], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bp+var_12]
		add	ax, di
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+3Ah], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+20h]
		sub	ax, [bp+var_2]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+28h], ax
		mov	ax, 393Eh
		push	ax
		mov	ax, [bx+22h]
		sub	ax, [bp+var_4]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+2Ah], ax
		mov	ax, [bx]
		neg	ax
		mov	si, ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bp+var_18]
		add	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+3Ch], ax
		mov	ax, [bx+2]
		neg	ax
		mov	di, ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bp+var_1A]
		add	ax, di
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+3Eh], ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bx+20h]
		sub	ax, [bp+var_A]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+24h], ax
		mov	ax, 3E17h
		push	ax
		mov	ax, [bx+22h]
		sub	ax, [bp+var_C]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+26h], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bp+var_14]
		add	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+34h], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bp+var_16]
		add	ax, di
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+36h], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bx+20h]
		sub	ax, [bp+var_6]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+2Ch], ax
		mov	ax, 3333h
		push	ax
		mov	ax, [bx+22h]
		sub	ax, [bp+var_8]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_2]
		mov	[bx+2Eh], ax
		mov	[bp+var_E], 0

loc_2641_36B:				; CODE XREF: sub_2641_2+397j
		mov	si, [bp+var_E]
		mov	cl, 2
		shl	si, cl
		add	si, [bp+arg_2]
		mov	bx, [bp+arg_0]
		mov	di, [bx]
		mov	ax, di
		sub	ax, [si]

loc_2641_37E:
		mov	[si+40h], ax
		mov	ax, [bx+2]
		sub	ax, [si+2]
		mov	[si+42h], ax
		add	[si], di
		mov	ax, [bx+2]
		add	[si+2],	ax
		inc	[bp+var_E]
		cmp	[bp+var_E], 10h
		jl	short loc_2641_36B
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_2641_2	endp

seg015		ends

; ===========================================================================

; Segment type:	Pure code
seg016		segment	byte public 'CODE' use16
		assume cs:seg016
		;org 1
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LocateManyResou	proc far		; CODE XREF: LoadIntroRes+2AP
					; RunOpponentMenu+4AP ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		jmp	short loc_267B_29
; ---------------------------------------------------------------------------
		align 2

loc_267B_8:				; CODE XREF: LocateManyResou+2Dj
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	LocateShape
		add	sp, 6
		mov	bx, [bp+arg_6]
		add	[bp+arg_6], 4
		mov	[bx], ax
		mov	[bx+2],	dx
		add	[bp+arg_4], 4

loc_267B_29:				; CODE XREF: LocateManyResou+3j
		mov	bx, [bp+arg_4]
		cmp	byte ptr [bx], 0
		jnz	short loc_267B_8
		pop	bp
		retf
LocateManyResou	endp

; ---------------------------------------------------------------------------
		align 2
; [00000042 BYTES: COLLAPSED FUNCTION sub_267B_34. PRESS KEYPAD	"+" TO EXPAND]
; [00000042 BYTES: COLLAPSED FUNCTION sub_267B_76. PRESS KEYPAD	"+" TO EXPAND]
; [00000042 BYTES: COLLAPSED FUNCTION sub_267B_B8. PRESS KEYPAD	"+" TO EXPAND]
; ===========================================================================

; Segment type:	Pure code
seg017		segment	byte public 'CODE' use16
		assume cs:seg017
		;org 0Ah
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetMousePixRati	proc far		; CODE XREF: InitMouse+77p

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	g_pRegs86, 0Fh
		mov	ax, [bp+arg_0]
		mov	g_pRegs86+4, ax
		mov	ax, [bp+arg_2]
		mov	g_pRegs86+6, ax
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33,f = set mouse mickey pixel ratio
		push	ax
		call	_int86
		add	sp, 6
		pop	bp
		retf
SetMousePixRati	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitMouse	proc far		; CODE XREF: SetVideoMode+246P

var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 2
		mov	g_pRegs86, 0C201h
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 15h		; int 15,c201 =	enable ps2 pointing device
		push	ax
		call	_int86
		add	sp, 6
		mov	g_pRegs86, 0
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h
		push	ax		; int 33,0 = mouse reset/get mouse installed
		call	_int86
		add	sp, 6
		mov	ax, g_pRegs86
		mov	[bp+var_2], ax
		mov	ax, g_pRegs86+2
		mov	m_wMouseBut, ax
		cmp	[bp+var_2], 0
		jz	short loc_268A_B5
		cmp	[bp+arg_0], 140h
		jnz	short loc_268A_88
		mov	g_wMouseHorScal, 1
		jmp	short loc_268A_8E
; ---------------------------------------------------------------------------
		align 2

loc_268A_88:				; CODE XREF: InitMouse+4Bj
		mov	g_wMouseHorScal, 0

loc_268A_8E:				; CODE XREF: InitMouse+53j
		mov	ax, [bp+arg_2]
		dec	ax
		push	ax
		mov	ax, [bp+arg_0]
		dec	ax
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	cs
		call	near ptr SetMouseMinMax
		add	sp, 8
		mov	ax, 10h
		push	ax
		push	ax
		push	cs
		call	near ptr SetMousePixRati
		add	sp, 4
		mov	word_2B77_4BA8,	0FFFFh

loc_268A_B5:				; CODE XREF: InitMouse+44j
		mov	ax, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
InitMouse	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetMouseMinMax	proc far		; CODE XREF: MouseMinMaxPos+18P
					; MouseMinMaxPos+3EP ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		mov	g_pRegs86, 7
		mov	ax, [bp+arg_0]
		mov	cl, byte ptr g_wMouseHorScal
		shl	ax, cl
		mov	g_pRegs86+4, ax
		mov	ax, [bp+arg_4]
		shl	ax, cl
		mov	g_pRegs86+6, ax
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33,7 = set mouse hor min/max
		push	ax
		call	_int86
		add	sp, 6
		mov	g_pRegs86, 8
		mov	ax, [bp+arg_2]
		mov	g_pRegs86+4, ax
		mov	ax, [bp+arg_6]
		mov	g_pRegs86+6, ax
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33, 8 = set mouse	vert min/max
		push	ax
		call	_int86
		add	sp, 6
		pop	bp
		retf
SetMouseMinMax	endp

; ---------------------------------------------------------------------------
		align 2
		mov	g_pRegs86, 3
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33,3 = get mouse pos/but status
		push	ax
		call	_int86
		add	sp, 6
		mov	ax, g_pRegs86+2
		mov	m_wMouseBut, ax
		mov	ax, g_pRegs86+4
		mov	cl, byte ptr g_wMouseHorScal
		shr	ax, cl
		mov	g_wMouseX, ax
		mov	ax, g_pRegs86+6
		mov	g_wMouseY, ax
		mov	ax, m_wMouseBut
		retf
; ---------------------------------------------------------------------------
		align 2
		inc	m_wShowMouseCur
		cmp	m_wShowMouseCur, 1
		jl	short locret_268A_16C
		mov	m_wShowMouseCur, 1
		mov	g_pRegs86, 1
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33,1 = show mouse	cursor
		push	ax
		call	_int86
		add	sp, 6

locret_268A_16C:			; CODE XREF: seg017:014Dj
		retf
; ---------------------------------------------------------------------------
		align 2
		dec	m_wShowMouseCur
		jnz	short locret_268A_18B
		mov	g_pRegs86, 2
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33,2 = hide mouse	cursor
		push	ax
		call	_int86
		add	sp, 6

locret_268A_18B:			; CODE XREF: seg017:0172j
		retf

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetMousePositio	proc far		; CODE XREF: MouseMinMaxPos+28P

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		mov	g_pRegs86, 4
		mov	ax, [bp+arg_0]
		mov	g_wMouseX, ax
		mov	cl, byte ptr g_wMouseHorScal
		shl	ax, cl
		mov	g_pRegs86+4, ax
		mov	ax, [bp+arg_2]
		mov	g_pRegs86+6, ax
		mov	g_wMouseY, ax
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33, 4 = set mouse	cursor
		push	ax
		call	_int86
		add	sp, 6
		pop	bp
		retf
SetMousePositio	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetMouseState	proc far		; CODE XREF: RunGame+6E9P
					; RecordReplay+B1P ...

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		mov	g_pRegs86, 3
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33, 3 = get mouse	position and button
		push	ax
		call	_int86
		add	sp, 6
		mov	bx, [bp+arg_0]
		mov	ax, g_pRegs86+2	; bx = button status
		mov	[bx], ax
		mov	bx, [bp+arg_2]
		mov	ax, g_pRegs86+4	; cx = horiz pos (0..639)
		mov	cl, byte ptr g_wMouseHorScal
		shr	ax, cl
		mov	[bx], ax
		mov	bx, [bp+arg_4]
		mov	ax, g_pRegs86+6	; dx = vertical	pos (0..199)
		mov	[bx], ax
		pop	bp
		retf
; ---------------------------------------------------------------------------
; The code below seems to be no-ops?
		push	bp
		mov	bp, sp
		mov	g_pRegs86, 7
		mov	ax, [bp+arg_0]
		mov	cl, byte ptr g_wMouseHorScal
		sar	ax, cl
		mov	g_pRegs86+4, ax
		mov	ax, [bp+arg_2]
		sar	ax, cl
		mov	g_pRegs86+6, ax
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33,7 = set hor min max
		push	ax
		call	_int86
		add	sp, 6
		pop	bp
		retf
; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		mov	g_pRegs86, 8
		mov	ax, [bp+arg_0]
		mov	g_pRegs86+4, ax
		mov	ax, [bp+arg_2]
		mov	g_pRegs86+6, ax
		mov	ax, offset g_pRegs86
		push	ax
		push	ax
		mov	ax, 33h		; int 33, 8 = set vert min/max
		push	ax
		call	_int86
		add	sp, 6
		pop	bp
		retf
GetMouseState	endp

seg017		ends

; ---------------------------------------------------------------------------
; ===========================================================================

; Segment type:	Pure code
seg018		segment	byte public 'CODE' use16
		assume cs:seg018
		;org 2
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

locret_26AF_2:				; DATA XREF: DoReadline+11o
		retf
; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


DoKbChecking	proc far		; CODE XREF: _main+589P
		mov	ax, 40h	; '@'
		mov	es, ax
		assume es:nothing
		or	byte ptr es:17h, 20h
		call	KbChecking
		retf
DoKbChecking	endp


; =============== S U B	R O U T	I N E =======================================


DoKbChecking2	proc far		; CODE XREF: SetVideoMode+DP
		mov	ax, 40h	; '@'
		mov	es, ax
		and	byte ptr es:17h, 0DFh
		call	KbChecking
		retf
DoKbChecking2	endp

seg018		ends

; ===========================================================================

; Segment type:	Pure code
seg019		segment	byte public 'CODE' use16
		assume cs:seg019
		;org 6
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_26B1_6	proc far		; CODE XREF: sub_26EC_0+10P

var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		mov	bx, [bp+arg_0]
		mov	ax, [bx]
		mov	dx, [bx+2]
		mov	[bp+var_C], ax
		mov	[bp+var_A], dx
		mov	si, ax
		push	[bp+arg_4]
		mov	ax, [bx+4]
		sub	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, si
		mov	[bp+var_8], ax
		push	[bp+arg_4]
		mov	bx, [bp+arg_0]
		mov	ax, [bx+6]
		sub	ax, [bx+2]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_0]
		mov	cx, [bx+2]
		add	cx, ax
		mov	[bp+var_6], cx
		push	[bp+arg_4]
		mov	ax, [bx+8]
		sub	ax, si
		push	ax
		call	ScaleValue
		add	sp, 4
		add	ax, si
		mov	[bp+var_4], ax
		push	[bp+arg_4]
		mov	bx, [bp+arg_0]
		mov	ax, [bx+0Ah]
		sub	ax, [bx+2]
		push	ax
		call	ScaleValue
		add	sp, 4
		mov	bx, [bp+arg_0]
		mov	cx, [bx+2]
		add	cx, ax
		mov	[bp+var_2], cx
		push	[bp+arg_2]
		push	bx
		call	sub_2624_6
		add	sp, 4
		mov	ax, [bp+arg_2]
		add	ax, 40h	; '@'
		push	ax
		lea	ax, [bp+var_C]
		push	ax
		call	sub_2624_6
		add	sp, 4
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_26B1_6	endp

seg019		ends

; ===========================================================================

; Segment type:	Pure code
seg020		segment	byte public 'CODE' use16
		assume cs:seg020
		;org 0Dh
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_26BB_E	proc far		; CODE XREF: SpritePutpixel+C4P

var_80		= byte ptr -80h
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 80h
		lea	ax, [bp+var_80]
		push	ax
		push	[bp+arg_0]
		call	sub_2641_2
		add	sp, 4
		lea	ax, [bp+var_80]
		push	ax
		mov	ax, 20h	; ' '
		push	ax
		push	[bp+arg_2]
		call	DeriveSpriteOp3
		mov	sp, bp
		pop	bp
		retf
sub_26BB_E	endp

seg020		ends

; ===========================================================================

; Segment type:	Pure code
seg021		segment	byte public 'CODE' use16
		assume cs:seg021
		;org 8
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_26BE_8	proc far		; CODE XREF: UpdateFrame+1DD4P
					; sub_14D6_1DEA+47P

var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	di
		push	si
		mov	ax, [bp+arg_0]
		cwd
		sub	ax, dx
		sar	ax, 1
		jmp	short loc_26BE_8B
; ---------------------------------------------------------------------------

loc_26BE_1A:				; CODE XREF: sub_26BE_8+61j
		mov	si, [bp+var_8]
		shl	si, 1
		mov	bx, [bp+arg_2]
		mov	ax, [bx+si]
		mov	[bp+var_2], ax
		mov	di, [bp+var_8]
		add	di, [bp+var_4]
		shl	di, 1
		mov	ax, [bx+di]
		mov	[bx+si], ax
		mov	ax, [bp+var_2]
		mov	[bx+di], ax
		mov	bx, [bp+arg_4]
		mov	ax, [bx+si]
		mov	[bp+var_2], ax
		mov	ax, [bx+di]
		mov	[bx+si], ax
		mov	ax, [bp+var_2]
		mov	[bx+di], ax
		mov	ax, [bp+var_4]
		sub	[bp+var_8], ax

loc_26BE_4F:				; CODE XREF: sub_26BE_8+77j
		cmp	[bp+var_8], 0
		jl	short loc_26BE_6B
		mov	bx, [bp+var_8]
		shl	bx, 1
		mov	si, [bp+arg_2]
		mov	ax, [bx+si]
		mov	bx, [bp+var_8]
		add	bx, [bp+var_4]
		shl	bx, 1
		cmp	[bx+si], ax
		jg	short loc_26BE_1A

loc_26BE_6B:				; CODE XREF: sub_26BE_8+4Bj
		inc	[bp+var_6]

loc_26BE_6E:				; CODE XREF: sub_26BE_8+8Dj
		mov	ax, [bp+arg_0]
		cmp	[bp+var_6], ax
		jge	short loc_26BE_82
		mov	ax, [bp+var_6]
		sub	ax, [bp+var_4]
		mov	[bp+var_8], ax
		jmp	short loc_26BE_4F
; ---------------------------------------------------------------------------
		align 2

loc_26BE_82:				; CODE XREF: sub_26BE_8+6Cj
		mov	cx, 2
		mov	ax, [bp+var_4]
		cwd
		idiv	cx

loc_26BE_8B:				; CODE XREF: sub_26BE_8+10j
		mov	[bp+var_4], ax
		or	ax, ax
		jle	short loc_26BE_98
		mov	[bp+var_6], ax
		jmp	short loc_26BE_6E
; ---------------------------------------------------------------------------
		align 2

loc_26BE_98:				; CODE XREF: sub_26BE_8+88j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_26BE_8	endp

seg021		ends

; ===========================================================================

; Segment type:	Pure code
seg022		segment	byte public 'CODE' use16
		assume cs:seg022
		;org 0Eh
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_26C7_E	proc far		; CODE XREF: sub_14D6_1296+1C2P

var_11A		= word ptr -11Ah
var_118		= word ptr -118h
var_116		= word ptr -116h
var_114		= word ptr -114h
var_112		= word ptr -112h
var_110		= word ptr -110h
var_10E		= word ptr -10Eh
var_10C		= word ptr -10Ch
var_10A		= byte ptr -10Ah
var_D2		= byte ptr -0D2h
var_CE		= byte ptr -0CEh
var_92		= byte ptr -92h
var_8E		= word ptr -8Eh
var_8C		= word ptr -8Ch
var_4E		= byte ptr -4Eh
var_A		= byte ptr -0Ah
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 11Ah
		push	si
		push	[bp+arg_2]
		lea	ax, [bp+var_10E]
		push	ax
		push	[bp+arg_0]
		call	sub_26EC_0
		add	sp, 6
		lea	ax, [bp+var_10E]
		mov	[bp+var_2], ax
		mov	[bp+var_110], 0

loc_26C7_36:				; CODE XREF: sub_26C7_E+62j
		mov	bx, [bp+var_2]
		push	word ptr [bx+82h]
		push	word ptr [bx+80h]
		push	word ptr [bx+86h]
		push	word ptr [bx+84h]
		push	word ptr [bx+6]
		push	word ptr [bx+4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		mov	ax, 4
		push	ax
		push	[bp+arg_4]
		call	SpriteOp7
		add	sp, 14h
		add	[bp+var_2], 4
		inc	[bp+var_110]
		cmp	[bp+var_110], 0Fh
		jl	short loc_26C7_36
		mov	bx, [bp+var_2]
		push	word ptr [bx+82h]
		push	word ptr [bx+80h]
		push	[bp+var_8C]
		push	[bp+var_8E]
		push	[bp+var_10C]
		push	[bp+var_10E]
		push	word ptr [bx+2]
		push	word ptr [bx]
		mov	ax, 4
		push	ax
		push	[bp+arg_4]
		call	SpriteOp7
		add	sp, 14h
		lea	ax, [bp+var_10A]
		mov	[bp+var_4], ax
		mov	ax, [bp+var_10C]
		mov	[bp+var_118], ax
		mov	[bp+var_11A], 0
		mov	[bp+var_110], 1

loc_26C7_BC:				; CODE XREF: sub_26C7_E+D6j
		mov	bx, [bp+var_4]
		mov	ax, [bp+var_118]
		cmp	[bx+2],	ax
		jge	short loc_26C7_D7
		mov	ax, [bx+2]
		mov	[bp+var_118], ax
		mov	ax, [bp+var_110]
		mov	[bp+var_11A], ax

loc_26C7_D7:				; CODE XREF: sub_26C7_E+B8j
		add	[bp+var_4], 4
		inc	[bp+var_110]
		cmp	[bp+var_110], 10h
		jl	short loc_26C7_BC
		mov	si, [bp+var_11A]
		mov	cl, 2
		shl	si, cl
		add	si, bp
		lea	ax, [si-10Eh]
		mov	[bp+var_4], ax
		lea	ax, [si-0CEh]
		mov	[bp+var_114], ax
		lea	ax, [bp+var_4E]
		mov	[bp+var_6], ax
		lea	ax, [bp+var_A]
		mov	[bp+var_116], ax
		mov	ax, [bp+var_11A]
		mov	[bp+var_112], ax
		mov	[bp+var_110], 0
		jmp	short loc_26C7_132
; ---------------------------------------------------------------------------

loc_26C7_11C:				; CODE XREF: sub_26C7_E+156j
		add	[bp+var_4], 4
		add	[bp+var_114], 4

loc_26C7_125:				; CODE XREF: sub_26C7_E+16Dj
		add	[bp+var_6], 4
		sub	[bp+var_116], 4
		inc	[bp+var_110]

loc_26C7_132:				; CODE XREF: sub_26C7_E+10Cj
		cmp	[bp+var_110], 8
		jg	short loc_26C7_17E
		mov	bx, [bp+var_6]
		mov	si, [bp+var_4]
		mov	ax, [si]
		mov	[bx], ax
		mov	ax, [si+2]
		mov	[bx+2],	ax
		mov	bx, [bp+var_116]
		mov	si, [bp+var_114]
		mov	ax, [si]
		mov	[bx], ax
		mov	ax, [si+2]
		mov	[bx+2],	ax
		inc	[bp+var_112]
		cmp	[bp+var_112], 10h
		jl	short loc_26C7_11C
		lea	ax, [bp+var_10E]
		mov	[bp+var_4], ax
		lea	ax, [bp+var_CE]
		mov	[bp+var_114], ax
		mov	[bp+var_112], 0
		jmp	short loc_26C7_125
; ---------------------------------------------------------------------------
		align 2

loc_26C7_17E:				; CODE XREF: sub_26C7_E+129j
		lea	ax, [bp+var_4E]
		push	ax
		mov	ax, 12h
		push	ax
		push	[bp+arg_6]
		call	DeriveSpriteOp3
		add	sp, 6
		mov	si, [bp+var_11A]
		mov	cl, 2
		shl	si, cl
		add	si, bp
		lea	ax, [si-10Eh]
		mov	[bp+var_4], ax
		lea	ax, [si-0CEh]
		mov	[bp+var_114], ax
		lea	ax, [bp+var_4E]
		mov	[bp+var_6], ax
		lea	ax, [bp+var_A]
		mov	[bp+var_116], ax
		mov	ax, [bp+var_11A]
		mov	[bp+var_112], ax
		mov	[bp+var_110], 0
		jmp	short loc_26C7_1DE
; ---------------------------------------------------------------------------
		align 2

loc_26C7_1C8:				; CODE XREF: sub_26C7_E+1FDj
		sub	[bp+var_4], 4
		sub	[bp+var_114], 4

loc_26C7_1D1:				; CODE XREF: sub_26C7_E+214j
		add	[bp+var_6], 4
		sub	[bp+var_116], 4
		inc	[bp+var_110]

loc_26C7_1DE:				; CODE XREF: sub_26C7_E+1B7j
		cmp	[bp+var_110], 9
		jge	short loc_26C7_224
		mov	bx, [bp+var_6]
		mov	si, [bp+var_4]
		mov	ax, [si]
		mov	[bx], ax
		mov	ax, [si+2]
		mov	[bx+2],	ax
		mov	bx, [bp+var_116]
		mov	si, [bp+var_114]
		mov	ax, [si]

loc_26C7_1FF:
		mov	[bx], ax
		mov	ax, [si+2]
		mov	[bx+2],	ax
		dec	[bp+var_112]
		jns	short loc_26C7_1C8
		lea	ax, [bp+var_D2]
		mov	[bp+var_4], ax
		lea	ax, [bp+var_92]
		mov	[bp+var_114], ax

loc_26C7_21C:
		mov	[bp+var_112], 10h
		jmp	short loc_26C7_1D1
; ---------------------------------------------------------------------------

loc_26C7_224:				; CODE XREF: sub_26C7_E+1D5j
		lea	ax, [bp+var_4E]
		push	ax
		mov	ax, 12h
		push	ax
		push	[bp+arg_6]
		call	DeriveSpriteOp3
		add	sp, 6
		lea	ax, [bp+var_CE]
		push	ax
		mov	ax, 10h
		push	ax
		push	[bp+arg_8]
		call	DeriveSpriteOp3
		add	sp, 6
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_26C7_E	endp

seg022		ends

; ===========================================================================

; Segment type:	Pure code
seg023		segment	byte public 'CODE' use16
		assume cs:seg023
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_26EC_0	proc far		; CODE XREF: sub_26C7_E+13P

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	si
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	sub_26B1_6
		add	sp, 6
		mov	bx, [bp+arg_0]
		mov	ax, [bx+0Ch]
		sub	ax, [bx]
		mov	[bp+var_8], ax
		mov	ax, [bx+0Eh]
		sub	ax, [bx+2]
		mov	[bp+var_A], ax
		mov	ax, [bp+arg_2]
		mov	[bp+var_2], ax
		add	ax, 80h	; '€'
		mov	[bp+var_4], ax
		mov	[bp+var_6], 0

loc_26EC_3D:				; CODE XREF: sub_26EC_0+62j
		mov	bx, [bp+var_4]
		mov	si, [bp+var_2]
		mov	ax, [si]
		add	ax, [bp+var_8]
		mov	[bx], ax
		mov	ax, [si+2]
		add	ax, [bp+var_A]
		mov	[bx+2],	ax
		add	[bp+var_2], 4
		add	[bp+var_4], 4
		inc	[bp+var_6]
		cmp	[bp+var_6], 10h
		jl	short loc_26EC_3D
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_26EC_0	endp

seg023		ends

; ===========================================================================

; Segment type:	Pure code
seg024		segment	byte public 'CODE' use16
		assume cs:seg024
		;org 9
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatRotateX	proc far		; CODE XREF: TrkPlanSimd+13BAP
					; MatRotateZXY+34P

var_4		= word ptr -4
var_2		= word ptr -2
p_pMat		= word ptr  6
p_dwAngle	= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	[bp+p_dwAngle]
		call	LookupCos
		add	sp, 2
		mov	[bp+var_2], ax
		push	[bp+p_dwAngle]
		call	LookupSine
		mov	[bp+var_4], ax
		mov	bx, [bp+p_pMat]
		mov	[bx+Matrix._11], 4000h
		mov	[bx+Matrix._21], 0
		mov	[bx+Matrix._31], 0
		mov	[bx+Matrix._12], 0
		mov	ax, [bp+var_2]
		mov	[bx+Matrix._22], ax
		mov	ax, [bp+var_4]
		mov	[bx+Matrix._32], ax
		mov	[bx+Matrix._13], 0
		neg	ax
		mov	[bx+Matrix._23], ax
		mov	ax, [bp+var_2]
		mov	[bx+Matrix._33], ax
		mov	sp, bp
		pop	bp
		retf
MatRotateX	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatRotateY	proc far		; CODE XREF: TrkPlanSimd+553P
					; TrkPlanSimd+12F8P ...

wLookedUpNum2	= word ptr -4
wLookedUpNum	= word ptr -2
p_pMat		= word ptr  6
p_wAngle	= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	[bp+p_wAngle]	; e.g 0x0204, 2	is lookup method, 4 is index
		call	LookupCos
		add	sp, 2
		mov	[bp+wLookedUpNum], ax
		push	[bp+p_wAngle]
		call	LookupSine
		mov	[bp+wLookedUpNum2], ax
		mov	bx, [bp+p_pMat]
		mov	ax, [bp+wLookedUpNum]
		mov	[bx+Matrix._11], ax
		mov	[bx+Matrix._21], 0
		mov	ax, [bp+wLookedUpNum2]
		neg	ax
		mov	[bx+Matrix._31], ax
		mov	[bx+Matrix._12], 0
		mov	[bx+Matrix._22], 4000h
		mov	[bx+Matrix._32], 0
		mov	ax, [bp+wLookedUpNum2]
		mov	[bx+Matrix._13], ax
		mov	[bx+Matrix._23], 0
		mov	ax, [bp+wLookedUpNum]
		mov	[bx+Matrix._33], ax
		mov	sp, bp
		pop	bp
		retf
MatRotateY	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MatRotateZ	proc far		; CODE XREF: MatRotateZXY+1BP

var_4		= word ptr -4
var_2		= word ptr -2
p_pMat		= word ptr  6
p_wAngle	= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	[bp+p_wAngle]
		call	LookupCos
		add	sp, 2
		mov	[bp+var_2], ax
		push	[bp+p_wAngle]

loc_26F2_CF:
		call	LookupSine
		mov	[bp+var_4], ax
		mov	bx, [bp+p_pMat]
		mov	ax, [bp+var_2]
		mov	[bx+Matrix._11], ax
		mov	ax, [bp+var_4]
		mov	[bx+Matrix._21], ax
		mov	[bx+Matrix._31], 0
		neg	ax
		mov	[bx+Matrix._12], ax
		mov	ax, [bp+var_2]
		mov	[bx+Matrix._22], ax
		mov	[bx+Matrix._32], 0
		mov	[bx+Matrix._13], 0
		mov	[bx+Matrix._23], 0
		mov	[bx+Matrix._33], 4000h
		mov	sp, bp
		pop	bp
		retf
MatRotateZ	endp

seg024		ends

; ===========================================================================

; Segment type:	Pure code
seg025		segment	byte public 'CODE' use16
		assume cs:seg025
		;org 0Dh
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2702_E	proc far		; CODE XREF: TrackEditRelate+C3BP
					; TrackEditRelate+100BP

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		mov	ax, [bp+arg_4]
		sub	ax, [bp+arg_0]
		inc	ax
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_6]
		sub	ax, [bp+arg_2]
		dec	ax
		mov	[bp+var_4], ax
		cmp	[bp+var_2], 0
		jle	short loc_2702_5F
		push	[bp+arg_8]
		mov	ax, 1
		push	ax
		push	[bp+var_2]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	Sprite1Op
		add	sp, 0Ah
		push	[bp+arg_8]
		mov	ax, 1
		push	ax
		push	[bp+var_2]
		push	[bp+arg_6]
		push	[bp+arg_0]
		call	Sprite1Op
		add	sp, 0Ah

loc_2702_5F:				; CODE XREF: sub_2702_E+1Fj
		cmp	[bp+var_4], 0
		jle	short loc_2702_95
		mov	si, [bp+arg_2]
		inc	si
		push	[bp+arg_8]
		push	[bp+var_4]
		mov	ax, 1
		push	ax
		push	si
		push	[bp+arg_0]
		call	Sprite1Op
		add	sp, 0Ah
		push	[bp+arg_8]
		push	[bp+var_4]
		mov	ax, 1
		push	ax
		push	si
		push	[bp+arg_4]
		call	Sprite1Op
		add	sp, 0Ah

loc_2702_95:				; CODE XREF: sub_2702_E+55j
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_2702_E	endp

seg025		ends

; ===========================================================================

; Segment type:	Pure code
seg026		segment	byte public 'CODE' use16
		assume cs:seg026
		;org 0Ah
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270B_A	proc far		; CODE XREF: sub_29AD_4+4FP
					; sub_29AD_4+63P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		cmp	[bp+arg_0], 61h	; 'a'
		jl	short loc_270B_1D
		cmp	[bp+arg_0], 7Ah	; 'z'
		jg	short loc_270B_1D
		sub	[bp+arg_0], 20h	; ' '

loc_270B_1D:				; CODE XREF: sub_270B_A+7j
					; sub_270B_A+Dj
		mov	ax, [bp+arg_0]
		pop	bp
		retf
sub_270B_A	endp

seg026		ends

; ===========================================================================

; Segment type:	Pure code
seg027		segment	byte public 'CODE' use16
		assume cs:seg027
		;org 2
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoInitAudioRese	proc far		; CODE XREF: InitSfxEngine+D3P
					; InitSfxEngine+100P ...

var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	[bp+arg_8]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr [bp+var_C], ax
		mov	word ptr [bp+var_C+2], dx
		or	dx, ax
		jnz	short loc_270D_2A

loc_270D_23:				; CODE XREF: DoInitAudioRese+42j
		sub	ax, ax
		cwd
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_270D_2A:				; CODE XREF: DoInitAudioRese+1Fj
		mov	ax, offset aHdr1_1 ; "hdr1"
		push	ax
		push	word ptr [bp+var_C+2]
		push	word ptr [bp+var_C]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		or	ax, dx
		jz	short loc_270D_23
		les	bx, [bp+var_4]
		cmp	byte ptr es:[bx+5], 1
		jz	short loc_270D_A2
		push	[bp+arg_6]
		push	[bp+arg_4]
		push	word ptr [bp+var_C+2]
		push	word ptr [bp+var_C]
		push	cs
		call	near ptr LoadVce
		add	sp, 8
		push	word ptr [bp+var_C+2]
		push	word ptr [bp+var_C]
		push	cs
		call	near ptr DoHdr1AudioStuf
		add	sp, 4
		les	bx, [bp+var_4]
		mov	byte ptr es:[bx+5], 1
		les	bx, [bp+var_C]
		mov	al, es:[bx+4]
		sub	ah, ah
		mov	cl, 3
		shl	ax, cl
		add	ax, bx
		mov	dx, es
		inc	ax
		mov	[bp+var_8], ax
		mov	[bp+var_6], dx
		lea	ax, [bp+var_8]
		push	ss
		push	ax
		push	word ptr [bp+var_4+2]
		push	word ptr [bp+var_4]
		push	cs
		call	near ptr Copy4Bytes
		add	sp, 8

loc_270D_A2:				; CODE XREF: DoInitAudioRese+4Cj
		mov	ax, word ptr [bp+var_4]
		mov	dx, word ptr [bp+var_4+2]
		mov	sp, bp
		pop	bp
		retf
DoInitAudioRese	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadAudioFinali	proc far		; CODE XREF: LoadAudioResour+4DP

var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		mov	g_wLockSeg28_0,	1
		push	cs
		call	near ptr sub_270D_29A
		mov	ax, word ptr [bp+arg_0]
		or	ax, word ptr [bp+arg_0+2]
		jz	short loc_270D_13F
		les	bx, [bp+arg_0]
		cmp	byte ptr es:[bx+4], 0
		jnz	short loc_270D_13F
		cmp	byte ptr es:[bx+5], 1
		jnz	short loc_270D_13F
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 18h
		mov	word ptr [bp+var_6+2], dx
		mov	word ptr [bp+var_6], ax
		call	[bp+var_6]
		mov	word_2B77_95D8,	0
		mov	g_wAudioWord, 80h ; '€'
		les	bx, [bp+arg_0]
		mov	al, es:[bx+6]
		sub	ah, ah
		shl	ax, 1
		shl	ax, 1
		add	ax, 7
		mov	[bp+var_2], ax
		mov	bx, ax
		inc	[bp+var_2]
		mov	si, word ptr [bp+arg_0]
		mov	al, es:[bx+si]
		mov	g_cAudioFlag, al
		mov	ax, 20h	; ' '
		push	ax
		mov	al, g_cAudioByte2
		sub	ah, ah
		push	ax
		push	[bp+var_2]
		push	es
		push	si
		mov	al, g_cAudioFlag
		dec	ax
		push	ax
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr DoInit4cBytes
		add	sp, 0Eh
		mov	g_cDrvFlag1, 1
		mov	g_wLockSeg28_0,	0

loc_270D_13F:				; CODE XREF: LoadAudioFinali+17j
					; LoadAudioFinali+21j ...
		pop	si
		mov	sp, bp
		pop	bp
		retf
LoadAudioFinali	endp

; ---------------------------------------------------------------------------
		nop
		nop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DrvFuncMany	proc far		; CODE XREF: RunGame+28EP
					; DoJoyResText+12P ...

var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	di
		push	si
		mov	g_cDrvFlag3, 1
		mov	g_wLockSeg28_0,	1
		cmp	g_cDrvFlag7, 0
		jnz	short loc_270D_192
		sub	si, si
		mov	di, (offset g_p24Chunkx76+28h)

loc_270D_165:				; CODE XREF: DrvFuncMany+44j
		cmp	g_cDrvFlag6, 1
		jz	short loc_270D_171
		cmp	si, 10h
		jge	short loc_270D_183

loc_270D_171:				; CODE XREF: DrvFuncMany+24j
		mov	al, [di]
		mov	byte_2B77_714E[si], al
		sub	ax, ax
		push	ax
		push	si
		call	AudioDrvFunc12
		add	sp, 4

loc_270D_183:				; CODE XREF: DrvFuncMany+29j
		add	di, 4Ch	; 'L'
		inc	si
		cmp	si, 18h
		jl	short loc_270D_165
		mov	[bp+var_2], si
		jmp	short loc_270D_1B6
; ---------------------------------------------------------------------------
		align 2

loc_270D_192:				; CODE XREF: DrvFuncMany+18j
		mov	g_bDrvFlag8, 0
		mov	ax, offset unk_2B77_4EC6
		push	ds
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3Fh	; '?'
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 6

loc_270D_1B6:				; CODE XREF: DrvFuncMany+49j
		cmp	g_cDrvFlag7, 0
		jnz	short loc_270D_217
		mov	[bp+var_2], 10h
		mov	di, offset g_drvData2
		mov	[bp+var_C], 10h

loc_270D_1CA:				; CODE XREF: DrvFuncMany+B2j
		mov	si, di
		push	word ptr [si+12h]
		push	word ptr [si+10h]
		push	word ptr [si+2Ah]
		push	si
		mov	al, [si+2Ch]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 27h	; '''
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 0Ah
		add	di, 2Eh	; '.'
		dec	[bp+var_C]
		jnz	short loc_270D_1CA
		mov	[bp+var_4], si
		mov	ax, offset g_drvData2
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 30h	; '0'
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 2

loc_270D_217:				; CODE XREF: DrvFuncMany+75j
		mov	g_wLockSeg28_0,	0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DrvFuncMany	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_224	proc far		; CODE XREF: RunGame:loc_11B7_2D9P
					; DoJoyResText+253P ...

var_6		= dword	ptr -6
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		mov	g_cDrvFlag3, 1
		mov	g_wLockSeg28_0,	1
		cmp	g_cDrvFlag7, 0
		jnz	short loc_270D_266
		sub	si, si

loc_270D_23F:				; CODE XREF: sub_270D_224+3Bj
		cmp	g_cDrvFlag6, 1
		jz	short loc_270D_24B
		cmp	si, 10h
		jge	short loc_270D_25B

loc_270D_24B:				; CODE XREF: sub_270D_224+20j
		mov	al, byte_2B77_714E[si]
		sub	ah, ah
		push	ax
		push	si
		call	AudioDrvFunc12
		add	sp, 4

loc_270D_25B:				; CODE XREF: sub_270D_224+25j
		inc	si
		cmp	si, 18h
		jl	short loc_270D_23F
		mov	[bp+var_2], si
		jmp	short loc_270D_28A
; ---------------------------------------------------------------------------

loc_270D_266:				; CODE XREF: sub_270D_224+17j
		mov	g_bDrvFlag8, 64h ; 'd'
		mov	ax, offset unk_2B77_4EC6
		push	ds
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3Fh	; '?'
		mov	word ptr [bp+var_6+2], dx
		mov	word ptr [bp+var_6], ax
		call	[bp+var_6]
		add	sp, 6

loc_270D_28A:				; CODE XREF: sub_270D_224+40j
		mov	g_wLockSeg28_0,	0
		mov	g_cDrvFlag3, 0
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_270D_224	endp


; =============== S U B	R O U T	I N E =======================================


sub_270D_29A	proc far		; CODE XREF: LoadAudioFinali+Ep
					; AudioDrvFunc3f+B5p
		mov	g_wLockSeg28_0,	1
		mov	g_cDrvFlag1, 0
		mov	ax, 0Fh
		push	ax
		sub	ax, ax
		push	ax
		call	AudioDrv1E
		add	sp, 4
		sub	ax, ax
		push	ax
		mov	al, g_cAudioByte2
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		mov	ax, 0Fh
		push	ax
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr DoInit4cBytes
		add	sp, 0Eh
		mov	g_cAudioFlag, 0
		call	AudioDrvF_C_30
		mov	g_wLockSeg28_0,	0
		retf
sub_270D_29A	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


SetDrvFlag2To1	proc far		; CODE XREF: ToggleDrvFlag2+Fp
		mov	g_cDrvFlag2, 1
		retf
SetDrvFlag2To1	endp


; =============== S U B	R O U T	I N E =======================================


SetDrvFlag2To0	proc far		; CODE XREF: ToggleDrvFlag2+8p
		mov	g_cDrvFlag2, 0
		mov	g_wLockSeg28_0,	1
		cmp	g_cAudioFlag, 0
		jz	short loc_270D_30C
		mov	al, g_cAudioFlag
		sub	ah, ah
		dec	ax
		push	ax
		sub	ax, ax
		push	ax
		call	AudioDrv1E
		add	sp, 4

loc_270D_30C:				; CODE XREF: SetDrvFlag2To0+10j
		call	AudioDrvF_C_30
		mov	g_wLockSeg28_0,	0
		retf
SetDrvFlag2To0	endp


; =============== S U B	R O U T	I N E =======================================


ToggleDrvFlag2	proc far		; CODE XREF: DoMofTextRes+AP
					; SetVideoMode+279P
		cmp	g_cDrvFlag2, 1
		jnz	short loc_270D_326
		push	cs
		call	near ptr SetDrvFlag2To0
		sub	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_270D_326:				; CODE XREF: ToggleDrvFlag2+5j
		push	cs
		call	near ptr SetDrvFlag2To1
		mov	ax, 1
		retf
ToggleDrvFlag2	endp

; ---------------------------------------------------------------------------
		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		cmp	g_cDrvFlag3, 1
		jz	short loc_270D_344
		cmp	g_cDrvFlag2, 0
		jnz	short loc_270D_34E

loc_270D_344:				; CODE XREF: seg027:033Bj seg027:035Aj ...
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_270D_34E:				; CODE XREF: seg027:0342j
		mov	word ptr [bp-2], 0
		mov	al, g_cAudioFlag
		sub	ah, ah
		or	ax, ax
		jz	short loc_270D_344
		mov	di, ax
		mov	si, 81FCh
		mov	cx, [bp-2]

loc_270D_364:				; CODE XREF: seg027:037Ej
		mov	ax, [si]
		or	ax, [si+2]
		jz	short loc_270D_376
		sub	ax, ax
		mov	[bp-2],	cx
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_270D_376:				; CODE XREF: seg027:0369j
		add	si, 4Ch	; 'L'
		inc	cx
		mov	ax, cx
		cmp	ax, di
		jb	short loc_270D_364
		mov	[bp-2],	cx
		jmp	short loc_270D_344
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		mov	ax, 40h	; '@'
		push	ax
		mov	ax, 0FFFFh
		push	ax
		push	word ptr [bp+8]
		push	word ptr [bp+6]
		push	cs
		call	near ptr sub_270D_42A
		add	sp, 8
		pop	bp
		retf

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_3A0	proc far		; CODE XREF: InitSfxEngine+230P

var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= byte ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		cmp	[bp+arg_0], 0FFFFh
		jnz	short loc_270D_3FE
		mov	si, 10h
		mov	di, 86BCh
		mov	cx, [bp+arg_0]

loc_270D_3B7:				; CODE XREF: sub_270D_3A0+33j
		cmp	cx, 0FFFFh
		jnz	short loc_270D_3D5
		mov	ax, [di]
		or	ax, [di+2]
		jnz	short loc_270D_3CC
		cmp	byte ptr [si-59D6h], 0
		jnz	short loc_270D_3CC
		mov	cx, si

loc_270D_3CC:				; CODE XREF: sub_270D_3A0+21j
					; sub_270D_3A0+28j
		add	di, 4Ch	; 'L'
		inc	si
		cmp	si, 17h
		jle	short loc_270D_3B7

loc_270D_3D5:				; CODE XREF: sub_270D_3A0+1Aj
		mov	[bp+var_2], si
		mov	[bp+arg_0], cx
		cmp	cx, 0FFFFh
		jz	short loc_270D_3F5
		mov	bx, cx
		mov	byte ptr [bx-59D6h], 1
		mov	ax, 4Ch	; 'L'
		imul	cx

loc_270D_3EC:				; CODE XREF: sub_270D_3A0+6Bj
		mov	bx, ax
		mov	al, [bp+arg_2]
		mov	[bx-7DE0h], al

loc_270D_3F5:				; CODE XREF: sub_270D_3A0+3Ej
		mov	ax, [bp+arg_0]
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_270D_3FE:				; CODE XREF: sub_270D_3A0+Cj
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx-59D6h], 1
		mov	ax, 4Ch	; 'L'
		imul	bx
		jmp	short loc_270D_3EC
sub_270D_3A0	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_40E	proc far		; CODE XREF: DelAudDrvTimer+EP

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		cmp	[bp+arg_0], 0FFFFh
		jle	short loc_270D_427
		mov	bx, [bp+arg_0]
		mov	byte ptr g_arrAudio[bx], 0
		push	bx
		push	cs
		call	near ptr MaybeInit4cChun
		add	sp, 2

loc_270D_427:				; CODE XREF: sub_270D_40E+7j
		pop	bp
		retf
sub_270D_40E	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_42A	proc far		; CODE XREF: seg027:0398p

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= byte ptr  0Ch

		push	bp
		mov	bp, sp
		mov	al, g_cDrvFlag6Flag
		sub	ah, ah
		push	ax
		mov	al, [bp+arg_6]
		push	ax
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioFuncIfFlag
		add	sp, 0Ah
		pop	bp
		retf
sub_270D_42A	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioFuncIfFlag	proc far		; CODE XREF: nopsub_16BA_680+28P
					; WrapAudioFunc2+28P ...

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= dword	ptr  6
arg_4		= word ptr  0Ah
arg_6		= byte ptr  0Ch
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	di
		push	si
		cmp	g_cDrvFlag6, 0
		jnz	short loc_270D_462

loc_270D_459:				; CODE XREF: AudioFuncIfFlag+1Ej
					; AudioFuncIfFlag+28j ...
		mov	ax, 0FFFFh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_270D_462:				; CODE XREF: AudioFuncIfFlag+Dj
		mov	ax, word ptr [bp+arg_0]
		or	ax, word ptr [bp+arg_0+2]
		jz	short loc_270D_459
		les	bx, [bp+arg_0]
		cmp	byte ptr es:[bx+5], 1
		jnz	short loc_270D_459
		cmp	g_cDrvFlag6Flag, 0
		jz	short loc_270D_498
		mov	al, g_cDrvFlag6Flag

loc_270D_47E:
		sub	ah, ah
		mov	cx, ax
		mov	ax, [bp+arg_8]
		mov	dx, cx
		mov	cl, 7
		shl	ax, cl
		mov	cx, dx
		sub	dx, dx
		div	cx		; ax = flag6 / (var8 <<	7)
		dec	ax
		mov	[bp+arg_8], ax
		jmp	short loc_270D_49D
; ---------------------------------------------------------------------------
		align 2

loc_270D_498:				; CODE XREF: AudioFuncIfFlag+2Fj
		mov	[bp+arg_8], 0

loc_270D_49D:				; CODE XREF: AudioFuncIfFlag+4Bj
		cmp	[bp+arg_4], 0FFFFh
		jz	short loc_270D_4A6
		jmp	loc_270D_539
; ---------------------------------------------------------------------------

loc_270D_4A6:				; CODE XREF: AudioFuncIfFlag+57j
		mov	si, 10h
		mov	di, offset byte_2B77_86BC
		mov	cx, [bp+arg_4]

loc_270D_4AF:				; CODE XREF: AudioFuncIfFlag+81j
		cmp	cx, 0FFFFh
		jnz	short loc_270D_4CD
		mov	ax, [di]
		or	ax, [di+2]
		jnz	short loc_270D_4C4
		cmp	byte ptr g_arrAudio[si], 0
		jnz	short loc_270D_4C4
		mov	cx, si

loc_270D_4C4:				; CODE XREF: AudioFuncIfFlag+6Fj
					; AudioFuncIfFlag+76j
		add	di, 4Ch	; 'L'
		inc	si
		cmp	si, 17h
		jle	short loc_270D_4AF

loc_270D_4CD:				; CODE XREF: AudioFuncIfFlag+68j
		mov	[bp+var_4], si
		mov	[bp+arg_4], cx
		cmp	cx, 0FFFFh
		jnz	short loc_270D_539
		mov	cx, 0FFh
		mov	di, 10h
		mov	si, (offset byte_2B77_86BC+24h)
		mov	dx, [bp+arg_4]

loc_270D_4E4:				; CODE XREF: AudioFuncIfFlag+B8j
		mov	al, [si]
		sub	ah, ah
		cmp	ax, cx
		ja	short loc_270D_4FB
		mov	ax, offset g_arrAudio
		or	ax, ax
		jnz	short loc_270D_4FB
		mov	al, [si]
		sub	ah, ah
		mov	cx, ax
		mov	dx, di

loc_270D_4FB:				; CODE XREF: AudioFuncIfFlag+A0j
					; AudioFuncIfFlag+A7j
		add	si, 4Ch	; 'L'
		inc	di
		cmp	di, 17h
		jl	short loc_270D_4E4
		mov	[bp+var_4], di
		mov	[bp+arg_4], dx
		mov	[bp+var_6], cx
		cmp	dx, 0FFFFh
		jz	short loc_270D_539
		mov	ax, 4Ch	; 'L'
		imul	dx
		mov	bx, ax
		mov	al, [bp+arg_6]
		cmp	(g_p24Chunkx76+24h)[bx], al
		ja	short loc_270D_539
		mov	bx, [bp+arg_4]
		cmp	byte ptr g_arrAudio[bx], 0
		jz	short loc_270D_531
		mov	byte ptr g_arrAudio[bx], 0

loc_270D_531:				; CODE XREF: AudioFuncIfFlag+E0j
		push	bx
		push	cs
		call	near ptr MaybeInit4cChun
		add	sp, 2

loc_270D_539:				; CODE XREF: AudioFuncIfFlag+59j
					; AudioFuncIfFlag+8Cj ...
		cmp	[bp+arg_4], 0FFFFh
		jnz	short loc_270D_542
		jmp	loc_270D_459
; ---------------------------------------------------------------------------

loc_270D_542:				; CODE XREF: AudioFuncIfFlag+F3j
		les	bx, [bp+arg_0]
		mov	al, es:[bx+6]
		sub	ah, ah
		shl	ax, 1
		shl	ax, 1
		add	ax, 8
		mov	[bp+var_2], ax
		mov	al, [bp+arg_6]
		sub	ah, ah
		push	ax
		push	[bp+arg_8]
		push	[bp+var_2]
		push	es
		push	bx
		push	[bp+arg_4]
		push	[bp+arg_4]
		push	cs
		call	near ptr DoInit4cBytes
		add	sp, 0Eh
		mov	ax, [bp+arg_4]
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioFuncIfFlag	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

MaybeInit4cChun	proc far		; CODE XREF: AudioDrvTimer+144P
					; AudioOp+25P ...

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		cmp	[bp+arg_0], 10h
		jl	short loc_270D_5C4
		cmp	[bp+arg_0], 17h
		jg	short loc_270D_5C4
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		sub	ax, ax
		mov	word ptr (g_p24Chunkx76+2)[bx],	ax
		mov	word ptr g_p24Chunkx76[bx], ax
		push	[bp+arg_0]
		push	[bp+arg_0]
		call	AudioDrv1E
		add	sp, 4
		sub	ax, ax
		push	ax
		mov	al, g_cDrvFlag6Flag
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	[bp+arg_0]
		push	[bp+arg_0]
		push	cs
		call	near ptr DoInit4cBytes
		add	sp, 0Eh

loc_270D_5C4:				; CODE XREF: MaybeInit4cChun+7j
					; MaybeInit4cChun+Dj
		pop	bp
		retf
MaybeInit4cChun	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetDrvFlag6To1	proc far		; CODE XREF: ToggleDrvFlag6+Fp

var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		cmp	g_cDrvFlag6, 1
		jz	short loc_270D_5F5
		mov	si, 10h

loc_270D_5D7:				; CODE XREF: SetDrvFlag6To1+25j
		mov	al, byte ptr unk_2B77_7166[si]
		sub	ah, ah
		push	ax
		push	si
		call	AudioDrvFunc12
		add	sp, 4
		inc	si
		cmp	si, 18h
		jl	short loc_270D_5D7
		mov	[bp+var_2], si
		mov	g_cDrvFlag6, 1

loc_270D_5F5:				; CODE XREF: SetDrvFlag6To1+Cj
		pop	si
		mov	sp, bp
		pop	bp
		retf
SetDrvFlag6To1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetDrvFlag6To0	proc far		; CODE XREF: ToggleDrvFlag6+8p

var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		cmp	g_cDrvFlag6, 0
		jz	short loc_270D_632
		mov	si, 10h
		mov	di, (offset byte_2B77_86BC+28h)

loc_270D_60F:				; CODE XREF: SetDrvFlag6To0+2Ej
		mov	al, [di]
		mov	byte ptr unk_2B77_7166[si], al
		sub	ax, ax
		push	ax
		push	si
		call	AudioDrvFunc12
		add	sp, 4
		add	di, 4Ch	; 'L'
		inc	si
		cmp	si, 18h
		jl	short loc_270D_60F
		mov	[bp+var_2], si
		mov	g_cDrvFlag6, 0

loc_270D_632:				; CODE XREF: SetDrvFlag6To0+Dj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetDrvFlag6To0	endp


; =============== S U B	R O U T	I N E =======================================


ToggleDrvFlag6	proc far		; CODE XREF: DoSonSofTextRes+AP
					; SetVideoMode+27EP
		cmp	g_cDrvFlag6, 1
		jnz	short loc_270D_646
		push	cs
		call	near ptr SetDrvFlag6To0
		sub	ax, ax
		retf
; ---------------------------------------------------------------------------

loc_270D_646:				; CODE XREF: ToggleDrvFlag6+5j
		push	cs
		call	near ptr SetDrvFlag6To1
		mov	ax, 1
		retf
ToggleDrvFlag6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_64E	proc far		; CODE XREF: AudioDrvTimer+14EP
					; nopsub_16BA_8E9+16P

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		cmp	g_cDrvFlag6, 0
		jnz	short loc_270D_65E

loc_270D_658:				; CODE XREF: sub_270D_64E+14j
					; sub_270D_64E+1Aj ...
		mov	ax, 1
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_270D_65E:				; CODE XREF: sub_270D_64E+8j
		cmp	[bp+arg_0], 10h
		jl	short loc_270D_658
		cmp	[bp+arg_0], 17h
		jg	short loc_270D_658
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		mov	ax, [bx-7E04h]
		or	ax, [bx-7E02h]
		jz	short loc_270D_658
		sub	ax, ax
		pop	bp
		retf
sub_270D_64E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_680	proc far

arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		mov	ax, 4Ch	; 'L'
		mul	[bp+arg_0]
		mov	bx, ax
		mov	ax, [bp+arg_2]
		mov	dx, [bp+arg_4]
		mov	word ptr (g_p24Chunkx76+48h)[bx], ax
		mov	word ptr (g_p24Chunkx76+4Ah)[bx], dx
		pop	bp
		retf
sub_270D_680	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvFunc3f	proc far		; CODE XREF: UnloadAudioReso+4P

var_A		= dword	ptr -0Ah
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	si
		cmp	g_cDrvFlag7, 0
		jnz	short loc_270D_6F6
		mov	al, g_cAudioByte2
		sub	ah, ah
		mov	[bp+var_2], ax
		or	ax, ax
		jg	short loc_270D_6B9
		jmp	loc_270D_750
; ---------------------------------------------------------------------------

loc_270D_6B9:				; CODE XREF: AudioDrvFunc3f+18j
		mov	ax, [bp+arg_0]
		cwd
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx
		mov	si, [bp+var_2]

loc_270D_6C6:				; CODE XREF: AudioDrvFunc3f+56j
		mov	g_wLockSeg28_0,	1
		push	si
		push	cs
		call	near ptr sub_270D_798
		add	sp, 2
		mov	g_wLockSeg28_0,	0
		push	[bp+var_4]
		push	[bp+var_6]
		call	CopyTimerCounte
		add	sp, 4
		call	WaitDXIsTimerCo
		sub	si, 2
		or	si, si
		jg	short loc_270D_6C6
		jmp	short loc_270D_74D
; ---------------------------------------------------------------------------

loc_270D_6F6:				; CODE XREF: AudioDrvFunc3f+Cj
		mov	si, 64h	; 'd'
		mov	ax, [bp+arg_0]
		cwd
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx

loc_270D_703:				; CODE XREF: AudioDrvFunc3f+AFj
		mov	g_wLockSeg28_0,	1
		mov	ax, si
		mov	g_bDrvFlag8, al
		mov	ax, offset unk_2B77_4EC6
		push	ds
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3Fh	; '?'
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 6
		mov	g_wLockSeg28_0,	0
		push	[bp+var_4]
		push	[bp+var_6]
		call	CopyTimerCounte
		add	sp, 4
		call	WaitDXIsTimerCo
		sub	si, 2
		or	si, si
		jg	short loc_270D_703

loc_270D_74D:				; CODE XREF: AudioDrvFunc3f+58j
		mov	[bp+var_2], si

loc_270D_750:				; CODE XREF: AudioDrvFunc3f+1Aj
		push	cs
		call	near ptr sub_270D_29A
		cmp	g_cDrvFlag7, 0
		jz	short loc_270D_792
		mov	ax, 32h	; '2'
		cwd
		push	dx
		push	ax
		call	CopyTimerCounte
		add	sp, 4
		call	WaitDXIsTimerCo
		mov	g_bDrvFlag8, 64h ; 'd'
		mov	ax, offset unk_2B77_4EC6
		push	ds
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3Fh	; '?'
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 6

loc_270D_792:				; CODE XREF: AudioDrvFunc3f+BDj
		pop	si
		mov	sp, bp
		pop	bp
		retf
AudioDrvFunc3f	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_798	proc far		; CODE XREF: AudioDrvFunc3f+32p
					; sub_270D_7C8+Dp

var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		sub	si, si
		mov	di, [bp+arg_0]
		jmp	short loc_270D_7B3
; ---------------------------------------------------------------------------
		align 2

loc_270D_7A8:				; CODE XREF: sub_270D_798+25j
		push	di
		push	si
		call	AudioDrvFunc12
		add	sp, 4
		inc	si

loc_270D_7B3:				; CODE XREF: sub_270D_798+Dj
		mov	ax, si
		mov	cl, g_cAudioFlag
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_270D_7A8
		mov	[bp+var_2], si
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_270D_798	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_7C8	proc far

arg_0		= byte ptr  6

		push	bp
		mov	bp, sp
		mov	al, [bp+arg_0]
		mov	g_cAudioByte2, al
		push	word ptr [bp+arg_0]
		push	cs
		call	near ptr sub_270D_798
		add	sp, 2
		pop	bp
		retf
sub_270D_7C8	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_7DE	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_0]
		mov	al, byte ptr unk_2B77_9596[bx]
		sub	ah, ah
		pop	bp
		retf
sub_270D_7DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_7EC	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	bx, [bp+arg_0]
		mov	al, byte ptr g_arrDrum[bx]
		sub	ah, ah
		pop	bp
		retf
sub_270D_7EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadAudioDriver	proc far		; CODE XREF: SetVideoMode+256P

var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	di
		push	si
		cmp	[bp+arg_4], 473Ah
		jnz	short loc_270D_80E
		mov	g_cDrvFlag9, 1

loc_270D_80E:				; CODE XREF: LoadAudioDriver+Dj
		mov	ax, word ptr g_pDrvBinary
		or	ax, word ptr g_pDrvBinary+2
		jz	short loc_270D_81E
		push	cs
		call	near ptr AudioDrvAtExit
		jmp	short loc_270D_82E
; ---------------------------------------------------------------------------
		nop

loc_270D_81E:				; CODE XREF: LoadAudioDriver+1Bj
		mov	ax, offset AudioDrvAtExit
		mov	dx, seg	seg027
		push	dx
		push	ax
		call	AddExitHandler
		add	sp, 4

loc_270D_82E:				; CODE XREF: LoadAudioDriver+21j
		sub	ax, ax
		mov	word ptr g_pDrvBinary+2, ax
		mov	word ptr g_pDrvBinary, ax
		push	ds
		pop	es
		assume es:dseg
		mov	di, [bp+arg_0]
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		dec	cx
		mov	[bp+var_8], cx
		or	cx, cx
		jz	short loc_270D_862
		mov	dx, [bp+arg_0]

loc_270D_84F:				; CODE XREF: LoadAudioDriver+63j
		mov	bx, cx
		mov	si, dx
		cmp	byte ptr [bx+si], 5Ch ;	'\'
		jz	short loc_270D_85F
		cmp	byte ptr [bx+si], 3Ah ;	':'
		jz	short loc_270D_85F
		loop	loc_270D_84F

loc_270D_85F:				; CODE XREF: LoadAudioDriver+5Cj
					; LoadAudioDriver+61j
		mov	[bp+var_8], cx

loc_270D_862:				; CODE XREF: LoadAudioDriver+50j
		cmp	[bp+var_8], 0
		jz	short loc_270D_86B
		inc	[bp+var_8]

loc_270D_86B:				; CODE XREF: LoadAudioDriver+6Cj
		mov	si, [bp+var_8]
		add	si, [bp+arg_0]
		mov	al, [si]
		mov	g_cAudioByte, al
		mov	al, [si+1]
		mov	byte_2B77_763F,	al
		mov	byte_2B77_7640,	0
		mov	ax, offset unk_2B77_4ECE
		push	ax
		mov	ax, offset aDrv	; "drv"
		push	ax
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		mov	[bp+var_6], ax
		push	ax
		call	LoadRes0_1Type
		add	sp, 2
		mov	word ptr g_pDrvBinary, ax
		mov	word ptr g_pDrvBinary+2, dx
		mov	g_cAudioByte2, 7Fh ; ''
		mov	g_cDrvFlag6Flag, 7Fh ; ''
		or	ax, dx
		jnz	short loc_270D_8B8
		jmp	loc_270D_982
; ---------------------------------------------------------------------------

loc_270D_8B8:				; CODE XREF: LoadAudioDriver+B9j
		call	g_pDrvBinary
		mov	g_cDrvResult, al
		or	al, al
		jz	short loc_270D_8C7
		cmp	al, 0FFh
		jnz	short loc_270D_8D2

loc_270D_8C7:				; CODE XREF: LoadAudioDriver+C7j
		mov	ax, 2
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_270D_8D2:				; CODE XREF: LoadAudioDriver+CBj
		cmp	g_cDrvResult, 7Fh ; ''
		jbe	short loc_270D_8E8 ; if	<= 7f, goto mt32.plb
		mov	g_cDrvResult, 10h
		mov	g_cDrvFlag7, 1
		mov	g_cDrvFlag9, 0

loc_270D_8E8:				; CODE XREF: LoadAudioDriver+DDj
		push	cs
		call	near ptr DoSkidslctDrv
		mov	ax, offset _AudioDrvTimer
		mov	dx, seg	seg028
		push	dx
		push	ax
		call	AddTimerFunc
		add	sp, 4
		cmp	g_cDrvFlag7, 0
		jz	short loc_270D_965
		mov	ax, offset aMt32_plb ; "mt32.plb"
		push	ax
		call	LoadRes0_1Type
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_270D_965
		push	dx
		push	[bp+var_4]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 42h	; 'B'
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 4
		push	[bp+var_2]
		push	[bp+var_4]
		call	SetResField10To0
		add	sp, 4
		mov	g_bDrvFlag8, 64h ; 'd'
		mov	ax, offset unk_2B77_4EC6
		push	ds
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3Fh	; '?'
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 6

loc_270D_965:				; CODE XREF: LoadAudioDriver+107j
					; LoadAudioDriver+11Dj
		mov	g_cDrvFlag3, 0
		mov	g_cDrvFlag2, 1
		mov	g_cDrvFlag1, 0
		mov	g_cDrvFlag6, 1
		sub	ax, ax
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_270D_982:				; CODE XREF: LoadAudioDriver+BBj
		mov	ax, offset aCanTFindDriver ; "Can't find driver!\n"
		push	ax
		call	far ptr	ErrorMessage
		add	sp, 2
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
LoadAudioDriver	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvAtExit	proc far		; CODE XREF: _main+57FP
					; LoadAudioDriver+1Ep
					; DATA XREF: ...

var_4		= dword	ptr -4

		push	bp
		mov	bp, sp
		sub	sp, 4
		mov	g_wLockSeg28_0,	1
		mov	ax, word ptr g_pDrvBinary
		or	ax, word ptr g_pDrvBinary+2
		jnz	short loc_270D_9AC
		jmp	loc_270D_A39
; ---------------------------------------------------------------------------

loc_270D_9AC:				; CODE XREF: AudioDrvAtExit+13j
		mov	ax, offset _AudioDrvTimer
		mov	dx, seg	seg028
		push	dx
		push	ax
		call	RemoveTimerFunc
		add	sp, 4
		mov	g_cDrvFlag2, 0
		mov	g_cDrvFlag6, 0
		cmp	g_cDrvFlag7, 0
		jz	short loc_270D_9F1
		mov	g_bDrvFlag8, 64h ; 'd'
		mov	ax, offset unk_2B77_4EC6
		push	ds
		push	ax
		mov	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3Fh	; '?'
		mov	word ptr [bp+var_4+2], dx
		mov	word ptr [bp+var_4], ax
		call	[bp+var_4]
		add	sp, 6

loc_270D_9F1:				; CODE XREF: AudioDrvAtExit+37j
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 6
		mov	word ptr [bp+var_4+2], dx
		mov	word ptr [bp+var_4], ax
		call	[bp+var_4]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 3
		mov	word ptr [bp+var_4+2], dx
		mov	word ptr [bp+var_4], ax
		call	[bp+var_4]
		push	word ptr g_pDrvBinary+2
		push	word ptr g_pDrvBinary
		call	SetResField10To0
		add	sp, 4
		sub	ax, ax
		mov	word ptr g_pDrvBinary+2, ax
		mov	word ptr g_pDrvBinary, ax
		mov	g_cDrvFlag7, 0
		mov	g_cDrvFlag9, 0

loc_270D_A39:				; CODE XREF: AudioDrvAtExit+15j
		mov	g_wLockSeg28_0,	0
		mov	sp, bp
		pop	bp
		retf
AudioDrvAtExit	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadSfxGe	proc far		; CODE XREF: LoadSfxFile+21p
					; LoadSfxFile+41p ...

var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		push	ax
		call	LoadRes0_1Type
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_270D_A78

loc_270D_A6E:				; CODE XREF: LoadSfxGe+6Dj
					; LoadSfxGe+92j ...
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_270D_A78:				; CODE XREF: LoadSfxGe+28j
		mov	[bp+var_8], 50h	; 'P'
		mov	bx, [bp+arg_2]
		mov	al, [bx]
		mov	[bp+var_7], al
		mov	al, [bx+1]
		mov	[bp+var_6], al
		mov	[bp+var_5], 0
		push	[bp+arg_4]
		lea	ax, [bp+var_8]
		push	ax
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		push	ax
		call	AltUncompressFi
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_270D_A6E
		mov	ax, offset aGe	; "ge"
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		push	ax
		call	LoadRes0_1Type
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_270D_A6E
		mov	ax, offset aGe_0 ; "ge"
		push	ax
		lea	ax, [bp+var_8]
		push	ax
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		push	ax
		call	AltUncompressFi
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_270D_B01
		jmp	loc_270D_A6E
; ---------------------------------------------------------------------------

loc_270D_B01:				; CODE XREF: LoadSfxGe+B8j
		mov	ax, offset g_afterGe
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		push	ax
		call	LoadRes0_1Type
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_270D_B29
		jmp	loc_270D_A6E
; ---------------------------------------------------------------------------

loc_270D_B29:				; CODE XREF: LoadSfxGe+E0j
		mov	ax, offset g_afterGe2
		push	ax
		lea	ax, [bp+var_8]
		push	ax
		push	[bp+arg_0]
		call	GetAString
		add	sp, 6
		push	ax
		call	AltUncompressFi
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_270D_B52
		jmp	loc_270D_A6E
; ---------------------------------------------------------------------------

loc_270D_B52:				; CODE XREF: LoadSfxGe+109j
		push	[bp+arg_0]
		call	LoadRes0_1Type
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jmp	loc_270D_A6E
LoadSfxGe	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_B68	proc far

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, [bp+arg_0]
		mov	word_2B77_4ECC,	ax
		pop	bp
		retf
sub_270D_B68	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadSfxFile	proc far		; CODE XREF: LoadResource+73P

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		sub	ax, ax
		mov	[bp+var_2], ax
		mov	[bp+var_4], ax
		cmp	g_cDrvFlag9, 0
		jz	short loc_270D_BA1
		mov	ax, offset g_cAudioByte
		push	ax
		mov	ax, offset aDsf	; "dsf"
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr LoadSfxGe
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_270D_BA1:				; CODE XREF: LoadSfxFile+13j
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jnz	short loc_270D_BC1
		mov	ax, offset g_cAudioByte
		push	ax
		mov	ax, offset aSfx	; "sfx"
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr LoadSfxGe
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_270D_BC1:				; CODE XREF: LoadSfxFile+33j
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jnz	short loc_270D_BDF
		cmp	word_2B77_4ECC,	0
		jz	short loc_270D_BDF
		push	[bp+arg_0]
		mov	ax, offset aCannotLoadSfxF ; "cannot load sfx file %s"
		push	ax
		call	far ptr	ErrorMessage
		add	sp, 4

loc_270D_BDF:				; CODE XREF: LoadSfxFile+53j
					; LoadSfxFile+5Aj
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
LoadSfxFile	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadSongFile	proc far		; CODE XREF: LoadResource+5FP

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		sub	ax, ax
		mov	[bp+var_2], ax
		mov	[bp+var_4], ax
		mov	ax, offset g_cAudioByte
		push	ax
		mov	ax, offset aKms	; "kms"
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr LoadSfxGe
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_270D_C2A
		cmp	word_2B77_4ECC,	0
		jz	short loc_270D_C2A
		push	[bp+arg_0]
		mov	ax, offset aCannotLoadSong ; "cannot load song file %s"
		push	ax
		call	far ptr	ErrorMessage
		add	sp, 4

loc_270D_C2A:				; CODE XREF: LoadSongFile+28j
					; LoadSongFile+2Fj
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
LoadSongFile	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadVoiceFile	proc far		; CODE XREF: LoadResource+69P

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		sub	ax, ax
		mov	[bp+var_2], ax
		mov	[bp+var_4], ax
		cmp	g_cDrvFlag9, 0
		jz	short loc_270D_C61
		mov	ax, offset g_cAudioByte
		push	ax
		mov	ax, offset aDvc	; "dvc"
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr LoadSfxGe
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_270D_C61:				; CODE XREF: LoadVoiceFile+13j
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jnz	short loc_270D_C81
		mov	ax, offset g_cAudioByte
		push	ax
		mov	ax, offset aVce	; "vce"
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr LoadSfxGe
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx

loc_270D_C81:				; CODE XREF: LoadVoiceFile+33j
		mov	ax, [bp+var_4]
		or	ax, [bp+var_2]
		jnz	short loc_270D_C9F
		cmp	word_2B77_4ECC,	0
		jz	short loc_270D_C9F
		push	[bp+arg_0]
		mov	ax, offset aCannotLoadVoic ; "cannot load voice	file %s"
		push	ax
		call	far ptr	ErrorMessage
		add	sp, 4

loc_270D_C9F:				; CODE XREF: LoadVoiceFile+53j
					; LoadVoiceFile+5Aj
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		sub	sp, 4
		mov	ax, offset g_cAudioByte
		push	ax
		mov	ax, offset aSlb	; "slb"
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr LoadSfxGe
		add	sp, 6
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_270D_CE2
		cmp	word_2B77_4ECC,	0
		jz	short loc_270D_CE2
		push	[bp+arg_0]
		mov	ax, offset aCannotLoadSamp ; "cannot load sample file %s"
		push	ax
		call	far ptr	ErrorMessage
		add	sp, 4

loc_270D_CE2:				; CODE XREF: LoadVoiceFile+96j
					; LoadVoiceFile+9Dj
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
LoadVoiceFile	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoInit4cBytes	proc far		; CODE XREF: LoadAudioFinali+82p
					; sub_270D_29A+30p ...

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= byte ptr  10h
arg_C		= byte ptr  12h

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		mov	ax, [bp+arg_0]
		mov	[bp+var_6], ax
		mov	ax, [bp+arg_2]
		cmp	[bp+var_6], ax
		jle	short loc_270D_D05
		jmp	loc_270D_DEA
; ---------------------------------------------------------------------------

loc_270D_D05:				; CODE XREF: DoInit4cBytes+14j
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_A], ax
		mov	di, [bp+var_6]

loc_270D_D14:				; CODE XREF: DoInit4cBytes+F5j
		mov	si, [bp+var_A]
		sub	ax, ax
		mov	[si+4Ah], ax
		mov	[si+48h], ax
		mov	byte ptr [si+22h], 7Fh ; ''
		mov	ax, di
		mov	[si+23h], al
		mov	byte ptr [si+16h], 0Fh
		mov	byte ptr unk_2B77_9596[di], 0
		mov	byte ptr g_arrDrum[di],	0
		mov	byte ptr [si+32h], 0
		mov	byte ptr [si+4], 0
		mov	al, [bp+arg_C]
		mov	[si+24h], al
		mov	byte ptr [si+15h], 0
		sub	ax, ax
		mov	[si+1Ah], ax
		mov	[si+18h], ax
		mov	byte ptr [si+1Ch], 0
		mov	[si+20h], ax
		mov	[si+1Eh], ax
		mov	al, [bp+arg_A]
		mov	[si+28h], al
		mov	byte ptr [si+25h], 0
		mov	word ptr [si+26h], 0
		mov	byte ptr [si+29h], 0
		mov	byte ptr [si+2Ah], 0
		mov	byte ptr [si+2Bh], 0
		mov	byte ptr [si+2Ch], 0
		mov	byte ptr [si+47h], 0FFh
		mov	ax, [bp+arg_4]
		or	ax, [bp+arg_6]
		jz	short loc_270D_DD0
		mov	ax, [bp+arg_8]
		add	ax, [bp+arg_4]
		mov	dx, [bp+arg_6]
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		push	dx
		push	ax
		push	cs
		call	near ptr ReadLongFromPtr
		add	sp, 4
		add	ax, 4
		mov	[si+5],	ax
		mov	[si+7],	dx
		push	[bp+var_2]
		push	[bp+var_4]
		push	cs
		call	near ptr ReadLongFromPtr
		add	sp, 4
		add	ax, 4
		mov	[si], ax
		mov	[si+2],	dx
		add	[bp+arg_8], 5
		mov	ax, [bp+arg_4]
		mov	dx, [bp+arg_6]
		add	ax, 7
		mov	[si+2Eh], ax
		mov	[si+30h], dx
		jmp	short loc_270D_DD7
; ---------------------------------------------------------------------------

loc_270D_DD0:				; CODE XREF: DoInit4cBytes+97j
		sub	ax, ax
		mov	[si+2],	ax
		mov	[si], ax

loc_270D_DD7:				; CODE XREF: DoInit4cBytes+E2j
		add	[bp+var_A], 4Ch	; 'L'
		inc	di
		cmp	di, [bp+arg_2]
		jg	short loc_270D_DE4
		jmp	loc_270D_D14
; ---------------------------------------------------------------------------

loc_270D_DE4:				; CODE XREF: DoInit4cBytes+F3j
		mov	[bp+var_6], di
		mov	[bp+var_8], si

loc_270D_DEA:				; CODE XREF: DoInit4cBytes+16j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoInit4cBytes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadVce		proc far		; CODE XREF: DoInitAudioRese+5Bp

var_22		= word ptr -22h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= word ptr -1Ch
var_1A		= word ptr -1Ah
var_16		= dword	ptr -16h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah
var_6		= byte ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 22h
		push	di
		push	si
		mov	[bp+var_6], 0
		mov	ax, offset aHdr1 ; "hdr1"
		push	ax
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr [bp+var_16], ax
		mov	word ptr [bp+var_16+2],	dx
		or	ax, dx
		jnz	short loc_270D_E1B
		jmp	loc_270D_F66
; ---------------------------------------------------------------------------

loc_270D_E1B:				; CODE XREF: LoadVce+26j
		mov	[bp+var_10], 0
		les	bx, [bp+var_16]
		assume es:nothing
		mov	al, es:[bx+6]
		sub	ah, ah
		or	ax, ax
		jnz	short loc_270D_E30
		jmp	loc_270D_EB7
; ---------------------------------------------------------------------------

loc_270D_E30:				; CODE XREF: LoadVce+3Bj
		mov	[bp+var_1C], ax
		mov	[bp+var_1E], 0
		mov	ax, bx
		add	ax, 7
		mov	[bp+var_22], ax
		mov	[bp+var_20], dx

loc_270D_E43:				; CODE XREF: LoadVce+C5j
		mov	[bp+var_12], 0
		mov	di, [bp+var_1E]
		sub	cx, cx
		mov	[bp+var_1A], ds
		lds	si, [bp+var_16]

loc_270D_E53:				; CODE XREF: LoadVce+76j
		mov	bx, di
		add	bx, cx
		mov	al, [bx+si+7]
		mov	bx, cx
		add	bx, bp
		mov	ss:[bx+var_A], al
		inc	cx
		cmp	cx, 4
		jl	short loc_270D_E53
		mov	ds, [bp+var_1A]
		mov	[bp+var_12], cx
		mov	ax, [bp+var_22]
		mov	dx, [bp+var_20]
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		lea	ax, [bp+var_A]
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	[bp+var_E], ax
		mov	[bp+var_C], dx
		lea	ax, [bp+var_E]
		push	ss
		push	ax
		push	[bp+var_2]
		push	[bp+var_4]
		push	cs
		call	near ptr Copy4Bytes
		add	sp, 8
		add	[bp+var_1E], 4
		add	[bp+var_22], 4
		inc	[bp+var_10]
		mov	ax, [bp+var_1C]
		cmp	[bp+var_10], ax
		jb	short loc_270D_E43

loc_270D_EB7:				; CODE XREF: LoadVce+3Dj
		mov	ax, offset aBasd ; "BASD"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwBasdVce, ax
		mov	word ptr g_dwBasdVce+2,	dx
		mov	ax, offset aSnar ; "SNAR"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwSnarVce, ax
		mov	word ptr g_dwSnarVce+2,	dx
		mov	ax, offset aTomm ; "TOMM"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwTommVce, ax
		mov	word ptr g_dwTommVce+2,	dx
		mov	ax, offset aRide ; "RIDE"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwRideVce, ax
		mov	word ptr g_dwRideVce+2,	dx
		mov	ax, offset aCrsh ; "CRSH"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwCrshVce, ax
		mov	word ptr g_dwCrshVce+2,	dx
		mov	ax, offset aChht ; "CHHT"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwChhtVce, ax
		mov	word ptr g_dwChhtVce+2,	dx
		mov	ax, offset aOhht ; "OHHT"
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr g_dwOhhtVce, ax
		mov	word ptr g_dwOhhtVce+2,	dx

loc_270D_F66:				; CODE XREF: LoadVce+28j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
LoadVce		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_F6C	proc far

var_22		= word ptr -22h
var_20		= word ptr -20h
var_1C		= word ptr -1Ch
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah
var_4		= dword	ptr -4
arg_0		= dword	ptr  6
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 22h
		push	di
		push	si
		mov	ax, [bp+arg_4]
		or	ax, [bp+arg_6]
		jnz	short loc_270D_F7F
		jmp	loc_270D_107F
; ---------------------------------------------------------------------------

loc_270D_F7F:				; CODE XREF: sub_270D_F6C+Ej
		mov	ax, word ptr [bp+arg_0]
		or	ax, word ptr [bp+arg_0+2]
		jnz	short loc_270D_F8A
		jmp	loc_270D_107F
; ---------------------------------------------------------------------------

loc_270D_F8A:				; CODE XREF: sub_270D_F6C+19j
		les	bx, [bp+arg_0]
		mov	al, es:[bx+4]
		sub	ah, ah
		mov	[bp+var_22], ax
		mov	[bp+var_14], ax
		mov	[bp+var_16], 0
		or	ax, ax
		jnz	short loc_270D_FA5
		jmp	loc_270D_107F
; ---------------------------------------------------------------------------

loc_270D_FA5:				; CODE XREF: sub_270D_F6C+34j
		mov	[bp+var_20], 0

loc_270D_FAA:				; CODE XREF: sub_270D_F6C+110j
		mov	[bp+var_18], 0
		mov	di, [bp+var_20]
		sub	cx, cx
		mov	[bp+var_1C], ds
		lds	si, [bp+arg_0]

loc_270D_FBA:				; CODE XREF: sub_270D_F6C+61j
		mov	bx, di
		add	bx, cx
		mov	al, [bx+si+6]
		mov	bx, cx
		add	bx, bp
		mov	ss:[bx+var_A], al
		inc	cx
		cmp	cx, 4
		jl	short loc_270D_FBA
		mov	ds, [bp+var_1C]
		mov	[bp+var_18], cx
		lea	ax, [bp+var_A]
		push	ax
		push	word ptr [bp+arg_0+2]
		push	word ptr [bp+arg_0]
		call	InitAudioRes
		add	sp, 6
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		les	bx, [bp+var_4]
		cmp	byte ptr es:[bx+5], 3
		jz	short loc_270D_FFE
		cmp	byte ptr es:[bx+5], 6
		jnz	short loc_270D_1067

loc_270D_FFE:				; CODE XREF: sub_270D_F6C+89j
		cmp	byte ptr es:[bx+0Ah], 0
		jnz	short loc_270D_1067
		mov	[bp+var_18], 0
		mov	ax, bx
		mov	dx, es
		add	ax, 6
		mov	cx, 2
		lea	di, [bp+var_A]
		mov	si, ax
		push	ss
		pop	es
		push	ds
		mov	ds, dx
		repne movsw
		pop	ds
		mov	[bp+var_18], 4
		mov	ax, bx
		add	ax, 6
		mov	[bp+var_E], ax
		mov	[bp+var_C], dx
		lea	ax, [bp+var_A]
		push	ax
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	LocateShape0
		add	sp, 6
		mov	[bp+var_12], ax
		mov	[bp+var_10], dx
		or	ax, dx
		jz	short loc_270D_1067
		lea	ax, [bp+var_12]
		push	ss
		push	ax
		push	[bp+var_C]
		push	[bp+var_E]
		push	cs
		call	near ptr Copy4Bytes
		add	sp, 8
		les	bx, [bp+var_4]
		mov	byte ptr es:[bx+0Ah], 0FFh

loc_270D_1067:				; CODE XREF: sub_270D_F6C+90j
					; sub_270D_F6C+97j ...
		add	[bp+var_20], 4
		inc	[bp+var_16]
		les	bx, [bp+arg_0]
		mov	al, es:[bx+4]
		sub	ah, ah
		cmp	ax, [bp+var_16]
		jbe	short loc_270D_107F
		jmp	loc_270D_FAA
; ---------------------------------------------------------------------------

loc_270D_107F:				; CODE XREF: sub_270D_F6C+10j
					; sub_270D_F6C+1Bj ...
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_270D_F6C	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoDrvData2	proc far		; CODE XREF: AudioFunction2+1EP

var_2		= word ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 2
		mov	ax, 2Eh	; '.'
		imul	[bp+arg_0]
		add	ax, offset g_drvData2
		mov	[bp+var_2], ax
		mov	bx, ax
		mov	word ptr [bx+0Ch], 1
		mov	word ptr [bx+0Eh], 0
		mov	sp, bp
		pop	bp
		retf
DoDrvData2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoSkidslctDrv	proc far		; CODE XREF: DoAudioCvx:loc_471_4221P
					; LoadAudioDriver+EFp

var_10		= dword	ptr -10h
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 10h
		push	di
		push	si
		mov	g_wLockSeg28_0,	1
		sub	ax, ax
		push	ax
		mov	ax, offset aSkidslct ; "skidslct"
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		mov	ax, 17h
		push	ax
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr DoInit4cBytes
		add	sp, 0Eh
		mov	[bp+var_2], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jz	short loc_270D_1151
		mov	di, offset g_drvData

loc_270D_10E1:
		mov	[bp+var_6], offset g_drvData2
		mov	[bp+var_8], offset g_drvData3
		mov	[bp+var_A], offset g_drvData4
		mov	[bp+var_C], offset g_drvData5
		mov	si, [bp+var_2]

loc_270D_10F8:				; CODE XREF: DoSkidslctDrv+A4j
		push	si
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 1Eh
		mov	word ptr [bp+var_10+2],	dx
		mov	word ptr [bp+var_10], ax
		call	[bp+var_10]
		add	sp, 2
		mov	byte ptr [di], 0
		mov	bx, [bp+var_6]
		mov	byte ptr [bx], 0FFh
		mov	bx, [bp+var_8]
		mov	byte ptr [bx], 0
		mov	bx, [bp+var_A]
		sub	ax, ax
		mov	[bx+2],	ax
		mov	[bx], ax
		mov	bx, [bp+var_C]
		mov	byte ptr [bx], 0FFh
		add	di, 2Eh	; '.'   ; was up with 46?
		add	[bp+var_6], 2Eh	; '.'
		add	[bp+var_8], 2Eh	; '.'
		add	[bp+var_A], 2Eh	; '.'
		add	[bp+var_C], 2Eh	; '.'
		inc	si
		mov	ax, si
		mov	cl, g_cDrvResult
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_270D_10F8
		mov	[bp+var_2], si

loc_270D_1151:				; CODE XREF: DoSkidslctDrv+34j
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 18h
		mov	word ptr [bp+var_10+2],	dx
		mov	word ptr [bp+var_10], ax
		call	[bp+var_10]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 6
		mov	word ptr [bp+var_10+2],	dx

loc_270D_1171:
		mov	word ptr [bp+var_10], ax
		call	[bp+var_10]
		mov	g_wLockSeg28_0,	0
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoSkidslctDrv	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoHdr1AudioStuf	proc far		; CODE XREF: DoInitAudioRese+68p

var_32		= word ptr -32h
var_30		= word ptr -30h
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= byte ptr -24h
var_22		= word ptr -22h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= word ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= dword	ptr -14h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= byte ptr -0Ch
var_8		= byte ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 32h
		push	di
		push	si
		mov	[bp+var_8], 0
		mov	ax, [bp+arg_0]
		mov	dx, [bp+arg_2]
		add	ax, 4
		push	dx
		push	ax
		push	cs
		call	near ptr ReadWordFromPtr
		add	sp, 4
		mov	[bp+var_16], ax
		mov	ax, [bp+arg_0]
		mov	dx, [bp+arg_2]
		add	ax, 6
		mov	[bp+var_28], ax
		mov	[bp+var_26], dx
		mov	ax, [bp+var_16]
		shl	ax, 1
		shl	ax, 1
		add	ax, [bp+var_28]
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx
		mov	ax, [bp+var_16]
		mov	cl, 3
		shl	ax, cl
		add	ax, [bp+arg_0]
		add	ax, 6
		mov	[bp+var_22], ax
		mov	[bp+var_20], dx
		mov	[bp+var_2A], 0
		jmp	loc_270D_12F9
; ---------------------------------------------------------------------------
		align 2

loc_270D_11E0:				; CODE XREF: DoHdr1AudioStuf+66j
		inc	word ptr [bp+var_14]

loc_270D_11E3:				; CODE XREF: DoHdr1AudioStuf+105j
		les	bx, [bp+var_14]
		test	byte ptr es:[bx], 80h
		jnz	short loc_270D_11E0
		inc	word ptr [bp+var_14]
		mov	bx, word ptr [bp+var_14]
		mov	al, es:[bx]
		sub	ah, ah
		sub	ax, 0D9h ; 'Ù'
		cmp	ax, 11h
		jbe	short loc_270D_1202
		jmp	loc_270D_12AE
; ---------------------------------------------------------------------------

loc_270D_1202:				; CODE XREF: DoHdr1AudioStuf+79j
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_270D_12D0[bx]

loc_270D_120A:				; DATA XREF: DoHdr1AudioStuf+166o
		add	word ptr [bp+var_14], 2
		mov	ax, 4
		push	ax
		lea	ax, [bp+var_C]
		push	ss
		push	ax
		push	es
		push	word ptr [bp+var_14]
		call	sub_29AD_1B4
		add	sp, 0Ah
		push	[bp+var_26]
		push	[bp+var_28]
		lea	ax, [bp+var_C]
		push	ax
		push	[bp+var_16]
		sub	ax, ax
		push	ax
		call	sub_29AD_8A
		add	sp, 0Ah
		mov	[bp+var_2E], ax
		cmp	ax, 0FFFFh
		jz	short loc_270D_127A
		shl	ax, 1
		shl	ax, 1
		add	ax, [bp+var_6]
		mov	dx, [bp+var_4]
		push	dx
		push	ax
		push	cs
		call	near ptr ReadLongFromPtr
		add	sp, 4
		mov	[bp+var_1E], ax
		mov	[bp+var_1C], dx
		add	ax, [bp+var_22]
		mov	dx, [bp+var_20]
		mov	[bp+var_10], ax
		mov	[bp+var_E], dx
		lea	ax, [bp+var_10]
		push	ss
		push	ax
		push	word ptr [bp+var_14+2]
		push	word ptr [bp+var_14]
		push	cs
		call	near ptr Copy4Bytes
		add	sp, 8

loc_270D_127A:				; CODE XREF: DoHdr1AudioStuf+BDj
		add	word ptr [bp+var_14], 4

loc_270D_127E:				; CODE XREF: DoHdr1AudioStuf+10Cj
					; DoHdr1AudioStuf+112j	...
		mov	ax, [bp+var_1A]
		mov	dx, [bp+var_18]
		cmp	word ptr [bp+var_14], ax
		jnb	short loc_270D_12F6
		jmp	loc_270D_11E3
; ---------------------------------------------------------------------------

loc_270D_128C:				; CODE XREF: DoHdr1AudioStuf+81j
					; DATA XREF: DoHdr1AudioStuf+152o ...
		add	word ptr [bp+var_14], 2
		jmp	short loc_270D_127E
; ---------------------------------------------------------------------------

loc_270D_1292:				; CODE XREF: DoHdr1AudioStuf+81j
					; DATA XREF: DoHdr1AudioStuf+158o ...
		add	word ptr [bp+var_14], 3
		jmp	short loc_270D_127E
; ---------------------------------------------------------------------------

loc_270D_1298:				; CODE XREF: DoHdr1AudioStuf+81j
					; DATA XREF: DoHdr1AudioStuf+168o ...
		inc	word ptr [bp+var_14]
		les	bx, [bp+var_14]
		inc	word ptr [bp+var_14]
		mov	al, es:[bx]
		mov	[bp+var_2], al
		sub	ah, ah
		add	word ptr [bp+var_14], ax
		jmp	short loc_270D_127E
; ---------------------------------------------------------------------------

loc_270D_12AE:				; CODE XREF: DoHdr1AudioStuf+7Bj
		mov	bx, word ptr [bp+var_14]
		mov	al, es:[bx]
		sub	ah, ah
		cmp	ax, 80h	; '€'
		jb	short loc_270D_12BE
		inc	word ptr [bp+var_14]

loc_270D_12BE:				; CODE XREF: DoHdr1AudioStuf+135j
					; DoHdr1AudioStuf+144j
		inc	word ptr [bp+var_14]
		mov	bx, word ptr [bp+var_14]
		test	byte ptr es:[bx], 80h
		jnz	short loc_270D_12BE

loc_270D_12CA:				; CODE XREF: DoHdr1AudioStuf+81j
					; DATA XREF: DoHdr1AudioStuf:off_270D_12D0o ...
		inc	word ptr [bp+var_14]
		jmp	short loc_270D_127E
; ---------------------------------------------------------------------------
		align 2
off_270D_12D0	dw offset loc_270D_12CA	; DATA XREF: DoHdr1AudioStuf+81r
		dw offset loc_270D_12CA
		dw offset loc_270D_12CA
		dw offset loc_270D_128C
		dw offset loc_270D_128C
		dw offset loc_270D_128C
		dw offset loc_270D_1292
		dw offset loc_270D_128C
		dw offset loc_270D_128C
		dw offset loc_270D_128C
		dw offset loc_270D_12CA
		dw offset loc_270D_128C
		dw offset loc_270D_1292
		dw offset loc_270D_120A
		dw offset loc_270D_1298
		dw offset loc_270D_1298
		dw offset loc_270D_128C
		dw offset loc_270D_128C
; ---------------------------------------------------------------------------
		jmp	short loc_270D_127E
; ---------------------------------------------------------------------------

loc_270D_12F6:				; CODE XREF: DoHdr1AudioStuf+103j
					; DoHdr1AudioStuf+215j	...
		inc	[bp+var_2A]

loc_270D_12F9:				; CODE XREF: DoHdr1AudioStuf+58j
		mov	ax, [bp+var_16]
		cmp	[bp+var_2A], ax
		jl	short loc_270D_1304
		jmp	loc_270D_1424
; ---------------------------------------------------------------------------

loc_270D_1304:				; CODE XREF: DoHdr1AudioStuf+17Bj
		mov	ax, [bp+var_2A]
		shl	ax, 1
		shl	ax, 1
		mov	[bp+var_32], ax
		add	ax, [bp+var_6]
		mov	dx, [bp+var_4]
		push	dx
		push	ax
		push	cs
		call	near ptr ReadLongFromPtr
		add	sp, 4
		add	ax, [bp+var_22]
		mov	dx, [bp+var_20]
		mov	word ptr [bp+var_14], ax
		mov	word ptr [bp+var_14+2],	dx
		lea	ax, [bp+var_14]
		push	ss
		push	ax
		push	cs
		call	near ptr ReadLongFromPtr
		add	sp, 4
		add	ax, word ptr [bp+var_14]
		mov	dx, word ptr [bp+var_14+2]
		mov	[bp+var_1A], ax
		mov	[bp+var_18], dx

loc_270D_1341:
		add	word ptr [bp+var_14], 4
		mov	ax, 4
		push	ax
		mov	ax, offset aHdr1_0 ; "hdr1"
		push	ds
		push	ax
		mov	ax, [bp+var_32]
		add	ax, [bp+var_28]
		mov	dx, [bp+var_26]
		push	dx
		push	ax
		sub	ax, ax
		push	ax
		call	sub_29AD_4
		add	sp, 0Ch
		or	ax, ax
		jnz	short loc_270D_136B
		jmp	loc_270D_127E
; ---------------------------------------------------------------------------

loc_270D_136B:				; CODE XREF: DoHdr1AudioStuf+1E2j
		add	word ptr [bp+var_14], 2
		les	bx, [bp+var_14]
		mov	al, es:[bx]
		mov	[bp+var_24], al
		sub	ah, ah
		shl	ax, 1
		shl	ax, 1
		inc	ax
		add	word ptr [bp+var_14], ax
		mov	bx, word ptr [bp+var_14]
		mov	al, es:[bx]
		mov	[bp+var_24], al
		inc	word ptr [bp+var_14]
		mov	[bp+var_2C], 0
		sub	ah, ah
		or	ax, ax
		jnz	short loc_270D_139C
		jmp	loc_270D_12F6
; ---------------------------------------------------------------------------

loc_270D_139C:				; CODE XREF: DoHdr1AudioStuf+213j
		mov	[bp+var_30], ax
		mov	di, [bp+var_2C]

loc_270D_13A2:				; CODE XREF: DoHdr1AudioStuf+295j
		mov	ax, 4
		push	ax
		lea	ax, [bp+var_C]
		push	ss
		push	ax
		push	word ptr [bp+var_14+2]
		push	word ptr [bp+var_14]
		call	sub_29AD_1B4
		add	sp, 0Ah
		push	[bp+var_26]
		push	[bp+var_28]
		lea	ax, [bp+var_C]
		push	ax
		push	[bp+var_16]
		sub	ax, ax
		push	ax
		call	sub_29AD_8A
		add	sp, 0Ah
		mov	si, ax
		cmp	si, 0FFFFh
		jz	short loc_270D_140F
		shl	ax, 1
		shl	ax, 1
		add	ax, [bp+var_6]
		mov	dx, [bp+var_4]
		push	dx
		push	ax
		push	cs
		call	near ptr ReadLongFromPtr
		add	sp, 4
		mov	[bp+var_1E], ax
		mov	[bp+var_1C], dx
		add	ax, [bp+var_22]
		mov	dx, [bp+var_20]
		mov	[bp+var_10], ax
		mov	[bp+var_E], dx
		lea	ax, [bp+var_10]
		push	ss
		push	ax
		push	word ptr [bp+var_14+2]
		push	word ptr [bp+var_14]
		push	cs
		call	near ptr Copy4Bytes
		add	sp, 8

loc_270D_140F:				; CODE XREF: DoHdr1AudioStuf+252j
		add	word ptr [bp+var_14], 5
		inc	di
		mov	ax, di
		cmp	ax, [bp+var_30]
		jb	short loc_270D_13A2
		mov	[bp+var_2C], di
		mov	[bp+var_2E], si
		jmp	loc_270D_12F6
; ---------------------------------------------------------------------------

loc_270D_1424:				; CODE XREF: DoHdr1AudioStuf+17Dj
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoHdr1AudioStuf	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ReadLongFromPtr	proc far		; CODE XREF: DoInit4cBytes+ABp
					; DoInit4cBytes+C1p ...

var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		les	bx, [bp+arg_0]
		mov	ax, es:[bx]
		mov	dx, es:[bx+2]
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		mov	sp, bp
		pop	bp
		retf
ReadLongFromPtr	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ReadWordFromPtr	proc far		; CODE XREF: DoHdr1AudioStuf+18p
					; sub_2863_E2A+134P

var_2		= word ptr -2
arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 2
		les	bx, [bp+arg_0]
		mov	ax, es:[bx]
		mov	[bp+var_2], ax
		mov	sp, bp
		pop	bp
		retf
ReadWordFromPtr	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Copy4Bytes	proc far		; CODE XREF: DoInitAudioRese+9Ap
					; LoadVce+AEp ...

arg_0		= dword	ptr  6
arg_4		= dword	ptr  0Ah

		push	bp
		mov	bp, sp
		les	bx, [bp+arg_4]
		inc	word ptr [bp+arg_4]
		mov	al, es:[bx]
		les	bx, [bp+arg_0]
		inc	word ptr [bp+arg_0]
		mov	es:[bx], al
		les	bx, [bp+arg_4]
		inc	word ptr [bp+arg_4]
		mov	al, es:[bx]
		les	bx, [bp+arg_0]
		inc	word ptr [bp+arg_0]
		mov	es:[bx], al
		les	bx, [bp+arg_4]
		inc	word ptr [bp+arg_4]
		mov	al, es:[bx]
		les	bx, [bp+arg_0]
		inc	word ptr [bp+arg_0]
		mov	es:[bx], al
		les	bx, [bp+arg_4]
		mov	al, es:[bx]
		les	bx, [bp+arg_0]
		mov	es:[bx], al
		pop	bp
		retf
Copy4Bytes	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_270D_14A0	proc far

var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 8
		push	di
		push	si
		mov	al, g_cDrvFlag6
		sub	ah, ah
		push	ax
		mov	al, g_cDrvFlag1
		push	ax
		mov	al, g_cDrvFlag2
		push	ax
		mov	al, g_cDrvFlag3
		push	ax
		mov	ax, offset aSwpauseDSwsong ; "swPause =	%d, swSong = %d, bSong = %d,s"...
		push	ax
		call	sub_1EA2_377D
		add	sp, 0Ah
		mov	al, g_cDrvFlag6Flag
		sub	ah, ah
		push	ax
		mov	al, g_cAudioByte2
		push	ax
		mov	ax, 4FD5h
		push	ax
		call	sub_1EA2_377D
		add	sp, 6
		sub	si, si
		mov	di, 8214h
		mov	[bp+var_6], 81FCh

loc_270D_14E6:				; CODE XREF: sub_270D_14A0+6Bj
		push	word ptr [di+2]
		push	word ptr [di]
		mov	bx, [bp+var_6]
		push	word ptr [bx+2]
		push	word ptr [bx]
		push	si
		mov	ax, 4FFBh
		push	ax
		call	sub_1EA2_377D
		add	sp, 0Ch
		add	di, 4Ch	; 'L'
		add	[bp+var_6], 4Ch	; 'L'
		inc	si
		cmp	si, 18h
		jl	short loc_270D_14E6
		mov	[bp+var_2], si
		mov	ax, 5010h
		push	ax
		call	sub_1EA2_377D
		add	sp, 2
		call	DoCallReadCharCBRep
		sub	si, si
		mov	di, 0A2C2h
		mov	[bp+var_4], 0A2BEh
		mov	[bp+var_8], 0A2B7h

loc_270D_1530:				; CODE XREF: sub_270D_14A0+C1j
		push	word ptr [di+2]
		push	word ptr [di]
		mov	bx, [bp+var_4]
		push	word ptr [bx+2]
		push	word ptr [bx]
		mov	bx, [bp+var_8]
		mov	al, [bx]
		sub	ah, ah
		push	ax
		push	si
		mov	ax, 501Dh
		push	ax
		call	sub_1EA2_377D
		add	sp, 0Eh
		add	di, 2Eh	; '.'
		add	[bp+var_4], 2Eh	; '.'
		add	[bp+var_8], 2Eh	; '.'
		inc	si
		cmp	si, 10h
		jl	short loc_270D_1530
		mov	[bp+var_2], si
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_270D_14A0	endp

seg027		ends

; ---------------------------------------------------------------------------
; ===========================================================================

; Segment type:	Pure code
seg028		segment	byte public 'CODE' use16
		assume cs:seg028
		;org 0Ch
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

_AudioDrvTimer:				; DATA XREF: LoadAudioDriver+F2o
					; AudioDrvAtExit:loc_270D_9ACo
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, word ptr g_pDrvBinary
		or	ax, word ptr g_pDrvBinary+2
		jz	short loc_2863_58
		cmp	g_wLockSeg28_0,	0
		jnz	short loc_2863_58
		cmp	g_wAudDrvCounte, 0
		jnz	short loc_2863_58
		inc	g_wAudDrvCounte
		push	cs
		call	near ptr AudioDrvF_C_30
		cmp	g_cDrvFlag1, 1
		jnz	short loc_2863_4C
		cmp	g_cDrvFlag2, 1
		jnz	short loc_2863_4C
		cmp	g_cDrvFlag3, 0
		jnz	short loc_2863_4C
		push	cs
		call	near ptr sub_2863_5A
		jmp	short loc_2863_50
; ---------------------------------------------------------------------------

loc_2863_4C:				; CODE XREF: seg028:0036j seg028:003Dj ...
		push	cs
		call	near ptr DoAudioDrvC

loc_2863_50:				; CODE XREF: seg028:004Aj
		push	cs
		call	near ptr WrapMore4cAudio
		dec	g_wAudDrvCounte

loc_2863_58:				; CODE XREF: seg028:0019j seg028:0020j ...
		pop	ds
		retf

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2863_5A	proc far		; CODE XREF: seg028:0047p

var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		add	word_2B77_95D8,	80h ; '€'
		jmp	short loc_2863_86
; ---------------------------------------------------------------------------

loc_2863_6E:				; CODE XREF: sub_2863_5A+2Aj
		mov	al, [bp+var_2]
		sub	ah, ah
		push	ax
		push	cs
		call	near ptr DoMore4cAudio
		add	sp, 2
		inc	[bp+var_2]

loc_2863_7E:				; CODE XREF: sub_2863_5A+44j
		mov	al, g_cAudioFlag
		cmp	[bp+var_2], al
		jb	short loc_2863_6E

loc_2863_86:				; CODE XREF: sub_2863_5A+12j
		mov	ax, g_wAudioWord
		cmp	word_2B77_95D8,	ax
		jb	short loc_2863_A0
		push	cs
		call	near ptr DoAudioDrvC
		mov	ax, g_wAudioWord
		sub	word_2B77_95D8,	ax
		mov	[bp+var_2], 0
		jmp	short loc_2863_7E
; ---------------------------------------------------------------------------

loc_2863_A0:				; CODE XREF: sub_2863_5A+33j
		pop	ds
		mov	sp, bp
		pop	bp
		retf
sub_2863_5A	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

WrapMore4cAudio	proc far		; CODE XREF: seg028:0051p

var_2		= byte ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	[bp+var_2], 10h

loc_2863_B6:				; CODE XREF: WrapMore4cAudio+24j
		mov	al, [bp+var_2]
		sub	ah, ah
		push	ax
		push	cs
		call	near ptr DoMore4cAudio
		add	sp, 2
		inc	[bp+var_2]
		cmp	[bp+var_2], 17h
		jb	short loc_2863_B6
		pop	ds
		mov	sp, bp
		pop	bp
		retf
WrapMore4cAudio	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoMore4cAudio	proc far		; CODE XREF: sub_2863_5A+1Bp
					; WrapMore4cAudio+17p

var_E		= byte ptr -0Eh
pDrvFunc	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= word ptr -4
var_2		= byte ptr -2
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	[bp+var_2], 0
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_4], ax
		mov	bx, ax
		mov	ax, [bx+18h]
		or	ax, [bx+1Ah]
		jz	short loc_2863_FD
		jmp	loc_2863_468
; ---------------------------------------------------------------------------

loc_2863_FD:				; CODE XREF: DoMore4cAudio+26j
		mov	ax, [bx]
		or	ax, [bx+2]
		jnz	short loc_2863_107
		jmp	loc_2863_470
; ---------------------------------------------------------------------------

loc_2863_107:				; CODE XREF: DoMore4cAudio+30j
					; DoMore4cAudio+36Fj ...
		mov	ax, [bx+18h]
		or	ax, [bx+1Ah]
		jz	short loc_2863_112
		jmp	loc_2863_468
; ---------------------------------------------------------------------------

loc_2863_112:				; CODE XREF: DoMore4cAudio+3Bj
		mov	ax, [bx]
		or	ax, [bx+2]
		jnz	short loc_2863_11C
		jmp	loc_2863_468
; ---------------------------------------------------------------------------

loc_2863_11C:				; CODE XREF: DoMore4cAudio+45j
		push	word ptr [bx+2]
		push	word ptr [bx]
		mov	ax, offset g_audioUnk
		push	ax
		push	cs
		call	near ptr sub_2863_E2A
		add	sp, 6
		mov	bx, [bp+var_4]
		mov	al, g_cAudioByte3
		sub	ah, ah
		add	[bx], ax
		cmp	g_wAudioWord3, 0D9h ; 'Ù'
		jnb	short loc_2863_140
		jmp	loc_2863_414
; ---------------------------------------------------------------------------

loc_2863_140:				; CODE XREF: DoMore4cAudio+69j
		mov	al, g_wAudioByte
		mov	[bp+var_2], al
		mov	al, g_wAudioWord3
		sub	ax, 0D9h ; 'Ù'
		cmp	ax, 11h
		jbe	short loc_2863_154
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_154:				; CODE XREF: DoMore4cAudio+7Dj
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_2863_3EE[bx]

loc_2863_15C:				; DATA XREF: DoMore4cAudio:off_2863_3EEo
		mov	bx, [bp+var_4]
		cmp	byte ptr [bx+4], 0
		jz	short loc_2863_182
		mov	si, [bx+4]
		and	si, 0FFh
		shl	si, 1
		shl	si, 1
		mov	ax, [bx+si+5]
		mov	dx, [bx+si+7]
		mov	[bx], ax
		mov	[bx+2],	dx
		dec	byte ptr [bx+4]
		jmp	loc_2863_437
; ---------------------------------------------------------------------------
algn_2863_181:
		align 2

loc_2863_182:				; CODE XREF: DoMore4cAudio+91j
		mov	ax, [bx+48h]
		mov	dx, [bx+4Ah]
		mov	word ptr [bp+var_8], ax
		mov	word ptr [bp+var_8+2], dx
		sub	ax, ax
		mov	[bx+2],	ax
		mov	[bx], ax
		push	[bp+arg_0]
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioDrv1E
		add	sp, 4

loc_2863_1A2:				; CODE XREF: DoMore4cAudio+181j
		mov	ax, word ptr [bp+var_8]
		or	ax, word ptr [bp+var_8+2]
		jnz	short loc_2863_1AD
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_1AD:				; CODE XREF: DoMore4cAudio+D6j
		push	[bp+arg_0]
		call	[bp+var_8]
		add	sp, 2
		jmp	loc_2863_437
; ---------------------------------------------------------------------------
		align 2

loc_2863_1BA:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+33Ao
		mov	ax, offset unk_2B77_717E
		push	ax
		mov	al, g_cAudioByte3
		sub	ah, ah
		sub	ax, 4
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 39h	; '9'
		mov	word ptr [bp+pDrvFunc+2], dx
		mov	word ptr [bp+pDrvFunc],	ax
		call	[bp+pDrvFunc]	; call ofs 0x39	in audio drv
		jmp	loc_2863_434
; ---------------------------------------------------------------------------
		align 2

loc_2863_1DE:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+33Eo
		mov	bx, [bp+arg_0]
		mov	al, [bp+var_2]
		mov	byte ptr unk_2B77_9596[bx], al
		jmp	loc_2863_437
; ---------------------------------------------------------------------------
		align 2

loc_2863_1EC:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+336o
		mov	bx, [bp+var_4]
		inc	byte ptr [bx+4]
		mov	ax, [bx]
		mov	dx, [bx+2]
		mov	si, [bx+4]
		and	si, 0FFh
		shl	si, 1
		shl	si, 1
		mov	[bx+si+5], ax
		mov	[bx+si+7], dx
		mov	ax, word ptr g_wAudioWord2
		mov	dx, word ptr g_wAudioWord2+2
		add	ax, 4
		jmp	short loc_2863_269
; ---------------------------------------------------------------------------

loc_2863_214:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+31Eo
		mov	bx, [bp+var_4]
		sub	ax, ax
		mov	[bx+2],	ax
		mov	[bx], ax
		mov	ax, [bx+48h]
		mov	dx, [bx+4Ah]
		mov	word ptr [bp+var_8], ax
		mov	word ptr [bp+var_8+2], dx
		push	[bp+arg_0]
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioDrv1E
		add	sp, 4
		sub	ax, ax
		push	ax
		mov	al, g_cAudioByte2
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		push	ax
		push	ax
		push	[bp+arg_0]
		push	[bp+arg_0]
		call	DoInit4cBytes
		add	sp, 0Eh
		jmp	loc_2863_1A2
; ---------------------------------------------------------------------------

loc_2863_256:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+320o
		mov	bx, [bp+var_4]
		mov	byte ptr [bx+4], 0
		mov	byte ptr [bx+32h], 0
		mov	si, bx
		mov	ax, [si+5]
		mov	dx, [si+7]

loc_2863_269:				; CODE XREF: DoMore4cAudio+140j
		mov	[bx], ax
		mov	[bx+2],	dx
		jmp	loc_2863_437
; ---------------------------------------------------------------------------
algn_2863_271:
		align 2

loc_2863_272:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+322o
		push	[bp+var_4]
		mov	al, [bp+var_2]
		sub	ah, ah
		push	ax
		push	cs
		call	near ptr PeekLongInArg2
		add	sp, 4
		mov	bx, [bp+var_4]
		mov	[bx+1Eh], ax
		mov	[bx+20h], dx
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_295
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_295:				; CODE XREF: DoMore4cAudio+1BEj
		les	bx, [bx+1Eh]
		mov	al, es:[bx+43h]
		mov	[bp+var_E], al
		cmp	al, 10h
		jnb	short loc_2863_2A8
		mov	bx, [bp+var_4]
		jmp	short loc_2863_2B2
; ---------------------------------------------------------------------------

loc_2863_2A8:				; CODE XREF: DoMore4cAudio+1CFj
		mov	bx, [bp+var_4]
		mov	al, byte ptr [bp+arg_0]
		and	al, 0Fh
		inc	al

loc_2863_2B2:				; CODE XREF: DoMore4cAudio+1D4j
		mov	[bx+47h], al
		mov	al, [bx+28h]
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		mov	al, [bx+47h]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 12h
		mov	word ptr [bp+pDrvFunc+2], dx
		mov	word ptr [bp+pDrvFunc],	ax
		call	[bp+pDrvFunc]	; call ofs 0x12	of audio drv
		add	sp, 6
		mov	bx, [bp+var_4]
		push	word ptr [bx+20h]
		push	word ptr [bx+1Eh]
		push	bx
		sub	ax, ax
		push	ax
		mov	al, [bx+47h]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 21h	; '!'
		mov	word ptr [bp+pDrvFunc+2], dx
		mov	word ptr [bp+pDrvFunc],	ax
		call	[bp+pDrvFunc]	; call offset 0x21h in audio drv
		add	sp, 0Ah
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_306:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+324o
		cmp	[bp+arg_0], 10h
		jl	short loc_2863_30F
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_30F:				; CODE XREF: DoMore4cAudio+238j
		mov	al, [bp+var_2]
		sub	ah, ah
		mov	cx, ax
		mov	ax, 7D00h
		cwd
		div	cx
		mov	g_wAudioWord, ax
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_322:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+326o
		mov	al, [bp+var_2]
		sub	ah, ah
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioDrvFunc12
		jmp	loc_2863_434
; ---------------------------------------------------------------------------

loc_2863_332:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+328o
		push	word ptr g_wAudioWord2
		mov	al, [bp+var_2]
		sub	ah, ah
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioDrvFunc15
		add	sp, 6
		jmp	loc_2863_437
; ---------------------------------------------------------------------------
		align 2

loc_2863_34A:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+32Ao
		mov	bx, [bp+var_4]
		mov	al, [bp+var_2]
		mov	[bx+16h], al
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_356:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+32Co
		mov	bx, [bp+var_4]
		mov	al, [bp+var_2]
		mov	[bx+24h], al
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_362:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+32Eo
		mov	bx, [bp+var_4]
		mov	ax, [bx]
		mov	dx, [bx+2]
		mov	si, [bx+32h]
		and	si, 0FFh
		shl	si, 1
		shl	si, 1
		mov	[bx+si+33h], ax
		mov	[bx+si+35h], dx
		mov	si, [bx+32h]

loc_2863_37E:
		and	si, 0FFh
		mov	al, [bp+var_2]
		dec	al
		mov	[bx+si+43h], al
		inc	byte ptr [bx+32h]
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_390:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+330o
		mov	bx, [bp+var_4]
		cmp	byte ptr [bx+32h], 0
		jnz	short loc_2863_39C
		jmp	loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_39C:				; CODE XREF: DoMore4cAudio+2C5j
		mov	al, [bx+32h]
		sub	ah, ah
		mov	si, ax
		mov	di, bx
		mov	bx, si
		shl	bx, 1
		shl	bx, 1
		mov	ax, [bx+di+2Fh]
		mov	dx, [bx+di+31h]
		mov	bx, di
		mov	[bx], ax
		mov	[bx+2],	dx
		mov	al, [bx+si+42h]
		dec	byte ptr [bx+si+42h]
		or	al, al
		jnz	short loc_2863_437
		dec	byte ptr [bx+32h]
		jmp	short loc_2863_437
; ---------------------------------------------------------------------------
		align 2

loc_2863_3C8:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+332o
		mov	bx, [bp+var_4]
		mov	al, [bp+var_2]
		mov	[bx+22h], al
		jmp	short loc_2863_437
; ---------------------------------------------------------------------------
		align 2

loc_2863_3D4:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+33Co
		mov	bx, [bp+var_4]
		mov	al, [bp+var_2]
		mov	[bx+47h], al
		jmp	short loc_2863_437
; ---------------------------------------------------------------------------
		align 2

loc_2863_3E0:				; CODE XREF: DoMore4cAudio+85j
					; DATA XREF: DoMore4cAudio+334o
		push	word ptr g_wAudioWord2
		push	[bp+arg_0]
		push	cs
		call	near ptr AudioDrvFunc1b
		jmp	short loc_2863_434
; ---------------------------------------------------------------------------
		align 2
off_2863_3EE	dw offset loc_2863_15C	; DATA XREF: DoMore4cAudio+85r
		dw offset loc_2863_214
		dw offset loc_2863_256
		dw offset loc_2863_272
		dw offset loc_2863_306
		dw offset loc_2863_322
		dw offset loc_2863_332
		dw offset loc_2863_34A
		dw offset loc_2863_356
		dw offset loc_2863_362
		dw offset loc_2863_390
		dw offset loc_2863_3C8
		dw offset loc_2863_3E0
		dw offset loc_2863_1EC
		dw offset loc_2863_437
		dw offset loc_2863_1BA
		dw offset loc_2863_3D4
		dw offset loc_2863_1DE
; ---------------------------------------------------------------------------
		jmp	short loc_2863_437
; ---------------------------------------------------------------------------

loc_2863_414:				; CODE XREF: DoMore4cAudio+6Bj
		cmp	g_wAudioWord3, 80h ; '€'
		jnb	short loc_2863_424
		mov	bx, [bp+var_4]
		mov	al, [bx+22h]
		mov	g_wAudioByte, al

loc_2863_424:				; CODE XREF: DoMore4cAudio+347j
		and	g_wAudioWord3, 7Fh
		push	[bp+arg_0]
		mov	ax, offset g_audioUnk
		push	ax
		push	cs
		call	near ptr DrumOp

loc_2863_434:				; CODE XREF: DoMore4cAudio+108j
					; DoMore4cAudio+25Dj ...
		add	sp, 4

loc_2863_437:				; CODE XREF: DoMore4cAudio+7Fj
					; DoMore4cAudio+85j ...
		mov	bx, [bp+var_4]
		mov	ax, [bx]
		or	ax, [bx+2]
		jnz	short loc_2863_444
		jmp	loc_2863_107
; ---------------------------------------------------------------------------

loc_2863_444:				; CODE XREF: DoMore4cAudio+36Dj
		push	word ptr [bx+2]
		push	word ptr [bx]
		mov	ax, offset g_wAudioWord4
		push	ax
		push	cs
		call	near ptr sub_2863_E2A
		add	sp, 6
		mov	bx, [bp+var_4]
		mov	ax, g_wAudioWord4
		mov	dx, word_2B77_7284
		mov	[bx+18h], ax
		mov	[bx+1Ah], dx
		jmp	loc_2863_107
; ---------------------------------------------------------------------------
		align 2

loc_2863_468:				; CODE XREF: DoMore4cAudio+28j
					; DoMore4cAudio+3Dj ...
		sub	word ptr [bx+18h], 1
		sbb	word ptr [bx+1Ah], 0

loc_2863_470:				; CODE XREF: DoMore4cAudio+32j
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoMore4cAudio	endp

; ---------------------------------------------------------------------------
		align 2
		push	bp
		mov	bp, sp
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 4Ch	; 'L'
		imul	word ptr [bp+6]
		mov	bx, ax
		mov	al, [bp+8]
		mov	(g_p24Chunkx76+47h)[bx], al
		pop	ds
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

PeekLongInArg2	proc far		; CODE XREF: DoMore4cAudio+1AAp

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	si, [bp+arg_0]
		and	si, 0FFh
		shl	si, 1
		shl	si, 1
		mov	bx, [bp+arg_2]
		les	bx, [bx+2Eh]
		mov	ax, es:[bx+si]
		mov	dx, es:[bx+si+2]
		pop	ds
		pop	si
		pop	bp
		retf
PeekLongInArg2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvFunc15	proc far		; CODE XREF: DoMore4cAudio+26Ep

var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_A		= word ptr -0Ah
var_8		= dword	ptr -8
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= byte ptr  8
arg_4		= byte ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 12h
		push	di

loc_2863_4C1:
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_4], ax
		cmp	[bp+arg_2], 40h	; '@'
		jnz	short loc_2863_4E2
		mov	bx, ax
		mov	al, [bp+arg_4]

loc_2863_4DF:
		mov	[bx+25h], al

loc_2863_4E2:				; CODE XREF: AudioDrvFunc15+1Ej
		cmp	g_cDrvFlag7, 0
		jz	short loc_2863_514
		push	word ptr [bp+arg_4]
		mov	al, [bp+arg_2]
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		mov	bx, [bp+var_4]
		mov	al, [bx+47h]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 15h
		mov	word ptr [bp+var_8+2], dx
		mov	word ptr [bp+var_8], ax
		call	[bp+var_8]
		add	sp, 8

loc_2863_514:				; CODE XREF: AudioDrvFunc15+2Dj
		mov	[bp+var_2], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jnz	short loc_2863_525
		jmp	loc_2863_5B3
; ---------------------------------------------------------------------------

loc_2863_525:				; CODE XREF: AudioDrvFunc15+66j
		mov	al, [bp+arg_2]
		mov	[bp+var_A], ax
		mov	si, offset g_drvData2
		mov	[bp+var_E], offset g_drvData
		mov	[bp+var_10], si
		mov	[bp+var_12], offset unk_2B77_A2CC
		mov	di, [bp+var_2]

loc_2863_53E:				; CODE XREF: AudioDrvFunc15+F4j
		mov	bx, [bp+var_4]
		mov	al, [si]
		cmp	[bx+23h], al
		jnz	short loc_2863_56D
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_56D
		push	word ptr [bp+arg_4]
		push	[bp+var_A]
		push	si
		push	di
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 15h
		mov	word ptr [bp+var_8+2], dx
		mov	word ptr [bp+var_8], ax
		call	[bp+var_8]
		add	sp, 8

loc_2863_56D:				; CODE XREF: AudioDrvFunc15+8Cj
					; AudioDrvFunc15+93j
		cmp	[bp+arg_2], 40h	; '@'
		jnz	short loc_2863_594
		cmp	word ptr [bp+arg_4], 0
		jnz	short loc_2863_594
		mov	bx, [bp+var_E]
		cmp	byte ptr [bx], 2
		jnz	short loc_2863_594

loc_2863_581:
		mov	bx, [bp+var_10]
		mov	al, [bx]
		mov	bx, [bp+var_4]
		cmp	[bx+23h], al
		jnz	short loc_2863_594
		mov	bx, [bp+var_12]
		mov	byte ptr [bx], 4

loc_2863_594:				; CODE XREF: AudioDrvFunc15+B7j
					; AudioDrvFunc15+BDj ...
		add	si, 2Eh	; '.'
		add	[bp+var_E], 2Eh	; '.'
		add	[bp+var_10], 2Eh ; '.'
		add	[bp+var_12], 2Eh ; '.'
		inc	di
		mov	ax, di
		mov	cl, g_cDrvResult
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_2863_53E

loc_2863_5B0:
		mov	[bp+var_2], di

loc_2863_5B3:				; CODE XREF: AudioDrvFunc15+68j
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioDrvFunc15	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvFunc1b	proc far		; CODE XREF: DoMore4cAudio+316p

var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_2], ax
		test	[bp+arg_2], 100h
		jz	short loc_2863_5DD
		or	byte ptr [bp+arg_2], 80h

loc_2863_5DD:				; CODE XREF: AudioDrvFunc1b+1Dj
		mov	al, byte ptr [bp+arg_2]
		cbw
		mov	cx, [bp+arg_2]
		sub	cl, cl
		shr	cx, 1
		add	cx, ax
		sub	cx, 2000h
		mov	[bp+arg_2], cx
		mov	bx, [bp+var_2]
		mov	ax, cx
		mov	[bx+26h], ax
		mov	al, [bx+47h]
		sub	ah, ah
		push	ax
		push	cx
		push	bx
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 1Bh
		mov	word ptr [bp+var_6+2], dx
		mov	word ptr [bp+var_6], ax
		call	[bp+var_6]
		add	sp, 6
		pop	ds
		mov	sp, bp
		pop	bp
		retf
AudioDrvFunc1b	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvFunc12	proc far		; CODE XREF: AudioFunction+6CP
					; AudioDrvTimer+7FP ...

var_C		= dword	ptr -0Ch
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= byte ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	di
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_4], ax
		mov	bx, ax
		mov	al, [bp+arg_2]
		mov	[bx+28h], al

loc_2863_63E:
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_698
		mov	[bp+var_2], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jz	short loc_2863_6C0
		mov	al, [bp+arg_2]
		mov	[bp+var_6], ax
		mov	si, offset g_drvData2
		mov	di, [bp+var_2]

loc_2863_65F:				; CODE XREF: AudioDrvFunc12+75j
		mov	al, [si]
		sub	ah, ah
		cmp	ax, [bp+arg_0]
		jnz	short loc_2863_683
		push	[bp+var_6]
		push	si
		push	di
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 12h
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 6

loc_2863_683:				; CODE XREF: AudioDrvFunc12+4Aj
		add	si, 2Eh	; '.'
		inc	di
		mov	ax, di
		mov	cl, g_cDrvResult
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_2863_65F
		mov	[bp+var_2], di
		jmp	short loc_2863_6C0
; ---------------------------------------------------------------------------

loc_2863_698:				; CODE XREF: AudioDrvFunc12+27j
		mov	al, [bp+arg_2]
		sub	ah, ah
		push	ax
		sub	ax, ax
		push	ax
		mov	bx, [bp+var_4]
		mov	al, [bx+47h]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 12h
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 6

loc_2863_6C0:				; CODE XREF: AudioDrvFunc12+35j
					; AudioDrvFunc12+7Aj
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioDrvFunc12	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Access4cChunk	proc far		; CODE XREF: AudioFunction:loc_16BA_37EP

var_A		= dword	ptr -0Ah
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= dword	ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	di
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		mov	ax, word ptr [bp+arg_2]
		mov	dx, word ptr [bp+arg_2+2]
		mov	word ptr (g_p24Chunkx76+1Eh)[si], ax
		mov	word ptr (g_p24Chunkx76+20h)[si], dx
		les	bx, [bp+arg_2]
		cmp	byte ptr es:[bx+43h], 10h
		jnb	short loc_2863_700
		mov	al, es:[bx+43h]
		mov	(g_p24Chunkx76+47h)[si], al
		jmp	short loc_2863_713
; ---------------------------------------------------------------------------

loc_2863_700:				; CODE XREF: Access4cChunk+2Cj
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	bx, ax
		mov	al, byte ptr [bp+arg_0]
		and	al, 0Fh
		inc	al
		mov	(g_p24Chunkx76+47h)[bx], al

loc_2863_713:				; CODE XREF: Access4cChunk+36j
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_77C
		mov	[bp+var_2], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jnz	short loc_2863_72B
		jmp	loc_2863_7AE
; ---------------------------------------------------------------------------

loc_2863_72B:				; CODE XREF: Access4cChunk+5Ej
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_4], ax
		mov	si, offset g_drvData2
		mov	di, [bp+var_2]

loc_2863_73D:				; CODE XREF: Access4cChunk+ADj
		mov	al, [si]
		sub	ah, ah
		cmp	ax, [bp+arg_0]
		jnz	short loc_2863_767
		push	word ptr [bp+arg_2+2]
		push	word ptr [bp+arg_2]
		push	[bp+var_4]
		push	si
		push	di
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 21h	; '!'
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 0Ah

loc_2863_767:				; CODE XREF: Access4cChunk+7Cj
		add	si, 2Eh	; '.'
		inc	di
		mov	ax, di
		mov	cl, g_cDrvResult
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_2863_73D
		mov	[bp+var_2], di
		jmp	short loc_2863_7AE
; ---------------------------------------------------------------------------

loc_2863_77C:				; CODE XREF: Access4cChunk+50j
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		push	word ptr [bp+arg_2+2]
		push	word ptr [bp+arg_2]
		add	ax, offset g_p24Chunkx76
		push	ax
		sub	ax, ax
		push	ax
		mov	al, (g_p24Chunkx76+47h)[si]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 21h	; '!'
		mov	word ptr [bp+var_A+2], dx
		mov	word ptr [bp+var_A], ax
		call	[bp+var_A]
		add	sp, 0Ah

loc_2863_7AE:				; CODE XREF: Access4cChunk+60j
					; Access4cChunk+B2j
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
Access4cChunk	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DrumOp		proc far		; CODE XREF: DoMore4cAudio+35Fp
					; DoDrumOp+2Ep

var_12		= dword	ptr -12h
var_E		= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 12h
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_2]
		add	ax, offset g_p24Chunkx76
		mov	[bp+var_8], ax
		mov	bx, ax
		mov	ax, [bx+1Eh]
		mov	dx, [bx+20h]
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		les	bx, [bp+var_4]
		cmp	byte ptr es:[bx+5], 5
		jz	short loc_2863_7EA
		jmp	loc_2863_86E
; ---------------------------------------------------------------------------

loc_2863_7EA:				; CODE XREF: DrumOp+2Fj
		mov	bx, [bp+arg_0]
		mov	al, [bx+4]
		sub	ah, ah
		sub	ax, 18h
		cmp	ax, 0Fh
		ja	short loc_2863_844
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_2863_84E[bx]

loc_2863_802:				; DATA XREF: DrumOp:off_2863_84Eo
		mov	ax, word ptr g_dwBasdVce
		mov	dx, word ptr g_dwBasdVce+2

loc_2863_809:				; CODE XREF: DrumOp+63j DrumOp+6Dj ...
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		jmp	short loc_2863_86E
; ---------------------------------------------------------------------------
		align 2

loc_2863_812:				; CODE XREF: DrumOp+47j
					; DATA XREF: DrumOp+9Co
		mov	ax, word ptr g_dwSnarVce
		mov	dx, word ptr g_dwSnarVce+2
		jmp	short loc_2863_809
; ---------------------------------------------------------------------------
		align 2

loc_2863_81C:				; CODE XREF: DrumOp+47j
					; DATA XREF: DrumOp+B2o
		mov	ax, word ptr g_dwRideVce
		mov	dx, word ptr g_dwRideVce+2
		jmp	short loc_2863_809
; ---------------------------------------------------------------------------
		align 2

loc_2863_826:				; CODE XREF: DrumOp+47j
					; DATA XREF: DrumOp+B6o
		mov	ax, word ptr g_dwCrshVce
		mov	dx, word ptr g_dwCrshVce+2
		jmp	short loc_2863_809
; ---------------------------------------------------------------------------
		align 2

loc_2863_830:				; CODE XREF: DrumOp+47j
					; DATA XREF: DrumOp+A4o
		mov	ax, word ptr g_dwChhtVce
		mov	dx, word ptr g_dwChhtVce+2
		jmp	short loc_2863_809
; ---------------------------------------------------------------------------
		align 2

loc_2863_83A:				; CODE XREF: DrumOp+47j
					; DATA XREF: DrumOp+A8o ...
		mov	ax, word ptr g_dwOhhtVce
		mov	dx, word ptr g_dwOhhtVce+2
		jmp	short loc_2863_809
; ---------------------------------------------------------------------------
		align 2

loc_2863_844:				; CODE XREF: DrumOp+42j DrumOp+47j
					; DATA XREF: ...
		mov	ax, word ptr g_dwTommVce
		mov	dx, word ptr g_dwTommVce+2
		jmp	short loc_2863_809
; ---------------------------------------------------------------------------
		align 2
off_2863_84E	dw offset loc_2863_802	; DATA XREF: DrumOp+47r
		dw offset loc_2863_844
		dw offset loc_2863_812
		dw offset loc_2863_844
		dw offset loc_2863_844
		dw offset loc_2863_844
		dw offset loc_2863_830
		dw offset loc_2863_844
		dw offset loc_2863_83A
		dw offset loc_2863_844
		dw offset loc_2863_83A
		dw offset loc_2863_844
		dw offset loc_2863_844
		dw offset loc_2863_81C
		dw offset loc_2863_844
		dw offset loc_2863_826
; ---------------------------------------------------------------------------

loc_2863_86E:				; CODE XREF: DrumOp+31j DrumOp+59j
		mov	ax, word ptr [bp+var_4]
		or	ax, word ptr [bp+var_4+2]
		jnz	short loc_2863_880

loc_2863_876:				; CODE XREF: DrumOp+E0j
		mov	ax, 0FFFFh
		pop	ds
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_2863_880:				; CODE XREF: DrumOp+BEj
		push	[bp+var_8]
		push	word ptr [bp+var_4+2]
		push	word ptr [bp+var_4]
		push	cs
		call	loc_2863_A98
		add	sp, 6

loc_2863_890:
		mov	[bp+var_6], ax
		cmp	ax, 0FFFFh
		jz	short loc_2863_876
		mov	ax, 2Eh	; '.'
		imul	[bp+var_6]
		add	ax, offset g_drvData2
		mov	[bp+var_A], ax
		mov	bx, ax
		mov	ax, word ptr [bp+var_4]
		mov	dx, word ptr [bp+var_4+2]
		cmp	[bx+10h], ax
		jnz	short loc_2863_8B6
		cmp	[bx+12h], dx
		jz	short loc_2863_8E8

loc_2863_8B6:				; CODE XREF: DrumOp+F9j
		mov	ax, word ptr [bp+var_4]
		mov	dx, word ptr [bp+var_4+2]
		mov	[bx+10h], ax
		mov	[bx+12h], dx
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_8E8
		push	dx
		push	ax
		push	[bp+var_8]
		push	bx
		push	[bp+var_6]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 21h	; '!'
		mov	word ptr [bp+var_E+2], dx
		mov	word ptr [bp+var_E], ax
		call	[bp+var_E]
		add	sp, 0Ah

loc_2863_8E8:				; CODE XREF: DrumOp+FEj DrumOp+111j
		mov	bx, [bp+var_A]
		mov	al, byte ptr [bp+arg_2]
		mov	[bx], al

loc_2863_8F0:
		mov	ax, [bp+var_8]
		mov	[bx+2Ah], ax
		mov	byte ptr [bx+1], 1
		mov	byte ptr [bx+16h], 1
		mov	si, bx
		les	si, [si+10h]
		mov	ax, es:[si+1Ch]
		mov	[bx+14h], ax
		mov	si, [bp+var_8]
		mov	al, [si+24h]
		mov	[bx+2],	al
		sub	ax, ax
		mov	[bx+0Ah], ax
		mov	[bx+8],	ax
		mov	si, [bp+arg_0]
		mov	ax, [si+6]
		mov	dx, [si+8]
		sub	ax, 1
		sbb	dx, 0
		mov	[bx+0Ch], ax
		mov	[bx+0Eh], dx
		les	si, [bp+var_4]
		mov	ax, es:[si+2Ah]
		mov	[bx+18h], ax
		mov	ax, es:[si+2Ch]
		mov	[bx+1Ah], ax
		mov	ax, es:[si+30h]
		mov	[bx+24h], ax
		mov	word ptr [bx+1Ch], 0
		mov	al, es:[si+34h]
		mov	[bx+26h], al
		mov	byte ptr [bx+27h], 0
		mov	ax, es:[si+36h]
		mov	[bx+1Eh], ax
		mov	ax, es:[si+38h]
		mov	[bx+20h], ax
		mov	byte ptr [bx+28h], 0
		mov	byte ptr [bx+22h], 0
		mov	byte ptr [bx+29h], 0
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_97E
		mov	al, byte ptr [bp+var_6]
		jmp	short loc_2863_984
; ---------------------------------------------------------------------------

loc_2863_97E:				; CODE XREF: DrumOp+1C1j
		mov	si, [bp+var_8]
		mov	al, [si+47h]

loc_2863_984:				; CODE XREF: DrumOp+1C6j
		mov	[bx+2Ch], al
		mov	bx, [bp+arg_0]
		cmp	byte ptr [bx+4], 0FFh
		jnz	short loc_2863_9C2
		push	word ptr [bx]
		push	[bp+var_A]
		mov	bx, [bp+var_A]
		mov	al, [bx+2Ch]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 24h	; '$'
		mov	word ptr [bp+var_E+2], dx
		mov	word ptr [bp+var_E], ax
		call	[bp+var_E]
		add	sp, 6
		cmp	g_cDrvFlag7, 0
		jz	short loc_2863_9C2
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx+4], 3Ch ; '<'

loc_2863_9C2:				; CODE XREF: DrumOp+1D8j DrumOp+203j
		push	word ptr [bp+var_4+2]
		push	word ptr [bp+var_4]
		mov	bx, [bp+arg_0]
		mov	al, [bx+5]
		sub	ah, ah
		push	ax
		les	bx, [bp+var_4]
		mov	al, es:[bx+10h]
		cbw
		mov	bx, [bp+arg_0]
		mov	cx, ax
		mov	al, [bx+4]
		cbw
		add	ax, cx
		push	ax
		push	[bp+var_8]
		push	[bp+var_A]
		mov	bx, [bp+var_A]
		mov	al, [bx+2Ch]

loc_2863_9F1:
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 9
		mov	word ptr [bp+var_12+2],	dx
		mov	word ptr [bp+var_12], ax
		call	[bp+var_12]
		add	sp, 0Eh
		mov	bx, [bp+arg_2]
		mov	si, [bp+arg_0]
		mov	al, [si+4]
		mov	byte ptr g_arrDrum[bx],	al
		mov	ax, [bp+var_6]
		pop	ds
		pop	si
		mov	sp, bp
		pop	bp
		retf
DrumOp		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoDrumOp	proc far		; CODE XREF: AudioFunction+54P

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	g_wDrumByte, 0FFh
		mov	ax, [bp+arg_0]
		mov	g_wDrumWord, ax
		mov	g_wDrumWord2, 0
		mov	g_wDrumWord3, 0FFE0h
		mov	g_wDrumWord4, 0FFFFh
		push	[bp+arg_2]
		mov	ax, offset g_wDrumWord
		push	ax
		push	cs
		call	near ptr DrumOp
		add	sp, 4
		pop	ds
		pop	bp
		retf
DoDrumOp	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvFunc24	proc far		; CODE XREF: AudioDrvTimer+126P

var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, 2Eh	; '.'
		imul	[bp+arg_0]
		mov	si, ax
		push	[bp+arg_2]
		add	ax, offset g_drvData2
		push	ax
		mov	al, byte ptr g_drvData5[si]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary

loc_2863_A7E:
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 24h	; '$'
		mov	word ptr [bp+var_4+2], dx
		mov	word ptr [bp+var_4], ax
		call	[bp+var_4]
		add	sp, 6
		pop	ds
		pop	si
		mov	sp, bp
		pop	bp
		retf
AudioDrvFunc24	endp

; ---------------------------------------------------------------------------
		align 2

loc_2863_A98:				; CODE XREF: DrumOp+D4p
		push	bp
		mov	bp, sp
		sub	sp, 1Ah
		push	di
		push	si
		push	ds

loc_2863_AA1:
		mov	ax, seg	dseg
		mov	ds, ax
		mov	word ptr [bp-10h], 0FFFFh
		mov	word ptr [bp-0Eh], 0FFFFh
		sub	ax, ax
		mov	[bp-8],	ax
		mov	[bp-0Ah], ax
		mov	[bp-2],	ax
		mov	[bp-4],	ax
		les	bx, [bp+6]
		cmp	es:[bx+0Ch], ax
		jnz	short loc_2863_ACE

loc_2863_AC7:				; CODE XREF: seg028:0B6Aj seg028:0CE4j ...
		mov	ax, 0FFFFh
		jmp	loc_2863_E22
; ---------------------------------------------------------------------------
		align 2

loc_2863_ACE:				; CODE XREF: seg028:0AC5j
		cmp	g_cDrvFlag7, 0
		jnz	short loc_2863_AD8
		jmp	loc_2863_BC0
; ---------------------------------------------------------------------------

loc_2863_AD8:				; CODE XREF: seg028:0AD3j
		sub	si, si
		mov	di, 0A2B6h

loc_2863_ADD:				; CODE XREF: seg028:0B4Fj
		mov	cx, di
		mov	bx, cx
		cmp	byte ptr [bx+1], 0
		jnz	short loc_2863_AF2

loc_2863_AE7:				; CODE XREF: seg028:0D51j
		mov	ax, si
		mov	[bp-6],	si
		mov	[bp-0Ch], cx
		jmp	loc_2863_E22
; ---------------------------------------------------------------------------

loc_2863_AF2:				; CODE XREF: seg028:0AE5j
		mov	bx, cx
		cmp	byte ptr [bx+1], 1
		jnz	short loc_2863_B1D
		mov	ax, [bp-0Ah]
		mov	dx, [bp-8]
		cmp	[bx+0Ah], dx
		jb	short loc_2863_B1D
		ja	short loc_2863_B0C
		cmp	[bx+8],	ax
		jbe	short loc_2863_B1D

loc_2863_B0C:				; CODE XREF: seg028:0B05j
		mov	bx, cx
		mov	ax, [bx+8]
		mov	dx, [bx+0Ah]
		mov	[bp-0Ah], ax
		mov	[bp-8],	dx
		mov	[bp-10h], si

loc_2863_B1D:				; CODE XREF: seg028:0AF8j seg028:0B03j ...
		mov	bx, cx
		cmp	byte ptr [bx+1], 2
		jnz	short loc_2863_B48
		mov	ax, [bp-4]
		mov	dx, [bp-2]
		cmp	[bx+0Ah], dx
		jb	short loc_2863_B48
		ja	short loc_2863_B37
		cmp	[bx+8],	ax
		jbe	short loc_2863_B48

loc_2863_B37:				; CODE XREF: seg028:0B30j
		mov	bx, cx
		mov	ax, [bx+8]
		mov	dx, [bx+0Ah]
		mov	[bp-4],	ax
		mov	[bp-2],	dx
		mov	[bp-0Eh], si

loc_2863_B48:				; CODE XREF: seg028:0B23j seg028:0B2Ej ...
		add	di, 2Eh	; '.'
		inc	si
		cmp	si, 10h
		jl	short loc_2863_ADD
		mov	[bp-6],	si
		mov	[bp-0Ch], cx
		cmp	word ptr [bp-0Eh], 0FFFFh
		jz	short loc_2863_B64

loc_2863_B5D:				; CODE XREF: seg028:0CDBj
		mov	ax, [bp-0Eh]
		jmp	loc_2863_E22
; ---------------------------------------------------------------------------
		align 2

loc_2863_B64:				; CODE XREF: seg028:0B5Bj
		cmp	word ptr [bp-10h], 0FFFFh
		jnz	short loc_2863_B6D
		jmp	loc_2863_AC7
; ---------------------------------------------------------------------------

loc_2863_B6D:				; CODE XREF: seg028:0B68j
		mov	ax, 2Eh	; '.'
		imul	word ptr [bp-10h]
		mov	si, ax
		add	ax, 0A2B6h
		push	ax
		mov	al, [si-5D1Eh]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Ch
		mov	[bp-14h], dx
		mov	[bp-16h], ax
		call	dword ptr [bp-16h]
		add	sp, 4
		mov	ax, si
		add	ax, 0A2B6h
		push	ax
		mov	al, [si-5D1Eh]
		sub	ah, ah
		push	ax

loc_2863_BA3:				; CODE XREF: seg028:0D11j
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Fh
		mov	[bp-14h], dx
		mov	[bp-16h], ax
		call	dword ptr [bp-16h]
		add	sp, 4
		mov	ax, [bp-10h]
		jmp	loc_2863_E22
; ---------------------------------------------------------------------------
		align 2

loc_2863_BC0:				; CODE XREF: seg028:0AD5j
		mov	bx, [bp+0Ah]
		mov	si, bx
		mov	al, [si+16h]
		cmp	[bx+15h], al
		jnb	short loc_2863_BD0
		jmp	loc_2863_D14
; ---------------------------------------------------------------------------

loc_2863_BD0:				; CODE XREF: seg028:0BCBj
		mov	word ptr [bp-6], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jnz	short loc_2863_BE1
		jmp	loc_2863_C95
; ---------------------------------------------------------------------------

loc_2863_BE1:				; CODE XREF: seg028:0BDCj
		mov	[bp-12h], ax
		mov	word ptr [bp-18h], 4E9Eh
		mov	word ptr [bp-1Ah], 0A2B6h
		mov	di, [bp-6]
		mov	si, [bp-0Ch]
		mov	cx, bx

loc_2863_BF6:				; CODE XREF: seg028:0C8Cj
		mov	bx, [bp-18h]
		mov	ax, [bx]
		les	bx, [bp+6]
		test	es:[bx+0Ch], ax
		jz	short loc_2863_C7C
		mov	si, [bp-1Ah]
		mov	bx, cx
		mov	al, [si]
		cmp	[bx+23h], al
		jnz	short loc_2863_C7C
		cmp	byte ptr [si+1], 0
		jnz	short loc_2863_C24
		inc	byte ptr [bx+15h]
		mov	ax, di
		mov	[bp-6],	di
		mov	[bp-0Ch], si
		jmp	loc_2863_E22
; ---------------------------------------------------------------------------

loc_2863_C24:				; CODE XREF: seg028:0C14j
		mov	bx, cx
		mov	al, [si+2]
		cmp	[bx+24h], al
		jb	short loc_2863_C7C
		cmp	byte ptr [si+1], 1
		jnz	short loc_2863_C55
		mov	ax, [bp-0Ah]
		mov	dx, [bp-8]
		cmp	[si+0Ah], dx
		jb	short loc_2863_C55
		ja	short loc_2863_C46
		cmp	[si+8],	ax
		jbe	short loc_2863_C55

loc_2863_C46:				; CODE XREF: seg028:0C3Fj
		mov	ax, [si+8]
		mov	dx, [si+0Ah]
		mov	[bp-0Ah], ax
		mov	[bp-8],	dx
		mov	[bp-10h], di

loc_2863_C55:				; CODE XREF: seg028:0C32j seg028:0C3Dj ...
		cmp	byte ptr [si+1], 2
		jnz	short loc_2863_C7C
		mov	ax, [bp-4]
		mov	dx, [bp-2]
		cmp	[si+0Ah], dx
		jb	short loc_2863_C7C
		ja	short loc_2863_C6D
		cmp	[si+8],	ax
		jbe	short loc_2863_C7C

loc_2863_C6D:				; CODE XREF: seg028:0C66j
		mov	ax, [si+8]
		mov	dx, [si+0Ah]
		mov	[bp-4],	ax
		mov	[bp-2],	dx
		mov	[bp-0Eh], di

loc_2863_C7C:				; CODE XREF: seg028:0C02j seg028:0C0Ej ...
		add	word ptr [bp-18h], 2
		add	word ptr [bp-1Ah], 2Eh ; '.'
		inc	di
		mov	ax, di
		cmp	ax, [bp-12h]
		jnb	short loc_2863_C8F
		jmp	loc_2863_BF6
; ---------------------------------------------------------------------------

loc_2863_C8F:				; CODE XREF: seg028:0C8Aj
		mov	[bp-6],	di
		mov	[bp-0Ch], si

loc_2863_C95:				; CODE XREF: seg028:0BDEj
		cmp	word ptr [bp-0Eh], 0FFFFh
		jz	short loc_2863_CDE

loc_2863_C9B:				; CODE XREF: seg028:0DE8j seg028:0DF4j
		mov	ax, 2Eh	; '.'
		imul	word ptr [bp-0Eh]
		mov	si, ax
		add	si, offset g_drvData2
		push	si
		push	word ptr [bp-0Eh]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Ch
		mov	[bp-14h], dx
		mov	[bp-16h], ax
		call	dword ptr [bp-16h]
		add	sp, 4
		push	si
		push	word ptr [bp-0Eh]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Fh
		mov	[bp-14h], dx
		mov	[bp-16h], ax
		call	dword ptr [bp-16h]
		add	sp, 4
		jmp	loc_2863_B5D
; ---------------------------------------------------------------------------

loc_2863_CDE:				; CODE XREF: seg028:0C99j
					; DATA XREF: __setenvp+1Br
		cmp	word ptr [bp-10h], 0FFFFh
		jnz	short loc_2863_CE7
		jmp	loc_2863_AC7
; ---------------------------------------------------------------------------

loc_2863_CE7:				; CODE XREF: seg028:0CE2j seg028:0E12j ...
		mov	ax, 2Eh	; '.'
		imul	word ptr [bp-10h]
		mov	si, ax
		add	si, offset g_drvData2
		push	si
		push	word ptr [bp-10h]
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Ch
		mov	[bp-14h], dx
		mov	[bp-16h], ax
		call	dword ptr [bp-16h]
		add	sp, 4
		push	si
		push	word ptr [bp-10h]
		jmp	loc_2863_BA3
; ---------------------------------------------------------------------------

loc_2863_D14:				; CODE XREF: seg028:0BCDj
		mov	word ptr [bp-6], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jnz	short loc_2863_D25
		jmp	loc_2863_DD1
; ---------------------------------------------------------------------------

loc_2863_D25:				; CODE XREF: seg028:0D20j
		mov	[bp-1Ah], ax
		mov	di, offset g_drvData2
		mov	word ptr [bp-12h], offset unk_2B77_4E9E
		mov	si, [bp-6]

loc_2863_D33:				; CODE XREF: seg028:0DC8j
		mov	cx, di
		mov	bx, [bp-12h]
		mov	ax, [bx]
		les	bx, [bp+6]
		test	es:[bx+0Ch], ax
		jz	short loc_2863_DB9
		mov	bx, cx
		cmp	byte ptr [bx+1], 0
		jnz	short loc_2863_D56
		mov	bx, [bp+0Ah]
		inc	byte ptr [bx+15h]
		jmp	loc_2863_AE7
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_2863_D56:				; CODE XREF: seg028:0D49j
		mov	bx, cx
		mov	al, [bx+2]
		mov	bx, [bp+0Ah]
		cmp	[bx+24h], al
		jb	short loc_2863_DB9
		mov	bx, cx
		cmp	byte ptr [bx+1], 1
		jnz	short loc_2863_D8E
		mov	ax, [bp-0Ah]
		mov	dx, [bp-8]
		cmp	[bx+0Ah], dx
		jb	short loc_2863_D8E
		ja	short loc_2863_D7D
		cmp	[bx+8],	ax
		jbe	short loc_2863_D8E

loc_2863_D7D:				; CODE XREF: seg028:0D76j
		mov	bx, cx
		mov	ax, [bx+8]
		mov	dx, [bx+0Ah]
		mov	[bp-0Ah], ax
		mov	[bp-8],	dx
		mov	[bp-10h], si

loc_2863_D8E:				; CODE XREF: seg028:0D69j seg028:0D74j ...
		mov	bx, cx
		cmp	byte ptr [bx+1], 2
		jnz	short loc_2863_DB9
		mov	ax, [bp-4]
		mov	dx, [bp-2]
		cmp	[bx+0Ah], dx
		jb	short loc_2863_DB9
		ja	short loc_2863_DA8
		cmp	[bx+8],	ax
		jbe	short loc_2863_DB9

loc_2863_DA8:				; CODE XREF: seg028:0DA1j
		mov	bx, cx
		mov	ax, [bx+8]
		mov	dx, [bx+0Ah]
		mov	[bp-4],	ax
		mov	[bp-2],	dx
		mov	[bp-0Eh], si

loc_2863_DB9:				; CODE XREF: seg028:0D41j seg028:0D61j ...
		add	di, 2Eh	; '.'
		add	word ptr [bp-12h], 2
		inc	si
		mov	ax, si
		cmp	ax, [bp-1Ah]
		jnb	short loc_2863_DCB
		jmp	loc_2863_D33
; ---------------------------------------------------------------------------

loc_2863_DCB:				; CODE XREF: seg028:0DC6j
		mov	[bp-6],	si
		mov	[bp-0Ch], cx

loc_2863_DD1:				; CODE XREF: seg028:0D22j
		cmp	word ptr [bp-0Eh], 0FFFFh
		jz	short loc_2863_DF8
		mov	ax, 2Eh	; '.'
		imul	word ptr [bp-0Eh]
		mov	bx, ax
		mov	si, word ptr unk_2B77_A2E0[bx]
		cmp	[bp+0Ah], si
		jnz	short loc_2863_DEB
		jmp	loc_2863_C9B
; ---------------------------------------------------------------------------

loc_2863_DEB:				; CODE XREF: seg028:0DE6j
		dec	byte ptr [si+15h]
		mov	bx, [bp+0Ah]
		inc	byte ptr [bx+15h]
		jmp	loc_2863_C9B
; ---------------------------------------------------------------------------
		align 2

loc_2863_DF8:				; CODE XREF: seg028:0DD5j
		cmp	word ptr [bp-10h], 0FFFFh
		jnz	short loc_2863_E01
		jmp	loc_2863_AC7
; ---------------------------------------------------------------------------

loc_2863_E01:				; CODE XREF: seg028:0DFCj
		mov	ax, 2Eh	; '.'
		imul	word ptr [bp-10h]
		mov	bx, ax
		mov	si, word ptr unk_2B77_A2E0[bx]
		cmp	[bp+0Ah], si
		jnz	short loc_2863_E15
		jmp	loc_2863_CE7
; ---------------------------------------------------------------------------

loc_2863_E15:				; CODE XREF: seg028:0E10j
		dec	byte ptr [si+15h]
		mov	bx, [bp+0Ah]
		inc	byte ptr [bx+15h]
		jmp	loc_2863_CE7
; ---------------------------------------------------------------------------
		align 2

loc_2863_E22:				; CODE XREF: seg028:0ACAj seg028:0AEFj ...
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2863_E2A	proc far		; CODE XREF: DoMore4cAudio+54p
					; DoMore4cAudio+37Cp

var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= byte ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= dword	ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	di
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	ax, word ptr [bp+arg_2]
		mov	dx, word ptr [bp+arg_2+2]
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx
		mov	bx, [bp+arg_0]
		sub	ax, ax
		mov	[bx+2],	ax
		mov	[bx], ax
		mov	si, bx

loc_2863_E50:				; CODE XREF: sub_2863_E2A+57j
		les	bx, [bp+arg_2]
		mov	al, es:[bx]
		sub	ah, ah
		and	ax, 7Fh
		sub	dx, dx
		mov	cx, [si]
		mov	bx, [si+2]
		mov	di, cx
		mov	cl, 7

loc_2863_E66:				; CODE XREF: sub_2863_E2A+42j
		shl	di, 1
		rcl	bx, 1
		dec	cl
		jnz	short loc_2863_E66
		add	ax, di
		adc	dx, bx
		mov	[si], ax
		mov	[si+2],	dx
		les	bx, [bp+arg_2]
		inc	word ptr [bp+arg_2]
		test	byte ptr es:[bx], 80h
		jnz	short loc_2863_E50
		mov	bx, [bp+arg_0]
		mov	si, word ptr [bp+arg_2]
		inc	word ptr [bp+arg_2]
		mov	al, es:[si]
		mov	[bx+4],	al
		mov	[bp+var_8], al
		sub	ah, ah
		sub	ax, 0D9h ; 'Ù'
		cmp	ax, 11h
		jbe	short loc_2863_EA2
		jmp	loc_2863_F9C
; ---------------------------------------------------------------------------

loc_2863_EA2:				; CODE XREF: sub_2863_E2A+73j
		add	ax, ax
		xchg	ax, bx
		jmp	cs:off_2863_F78[bx]

loc_2863_EAA:				; DATA XREF: sub_2863_E2A+16Co
		mov	[bp+var_2], 0
		mov	bx, word ptr [bp+arg_2]
		mov	al, es:[bx]
		sub	ah, ah
		or	ax, ax
		jz	short loc_2863_EE8
		mov	[bp+var_A], ax
		mov	[bp+var_C], ax
		mov	bx, [bp+var_2]
		mov	ax, bx
		add	ax, word ptr [bp+arg_2]
		mov	dx, es
		inc	ax
		mov	cx, [bp+var_C]
		shr	cx, 1
		lea	di, unk_2B77_717E[bx]
		mov	si, ax
		push	ds
		pop	es
		assume es:dseg
		push	ds
		mov	ds, dx
		repne movsw
		jnb	short loc_2863_EE1
		movsb

loc_2863_EE1:				; CODE XREF: sub_2863_E2A+B4j
		pop	ds
		mov	ax, [bp+var_C]
		add	[bp+var_2], ax

loc_2863_EE8:				; CODE XREF: sub_2863_E2A+7Bj
					; sub_2863_E2A+8Fj
					; DATA XREF: ...
		les	bx, [bp+arg_2]
		assume es:nothing
		mov	al, es:[bx]
		sub	ah, ah
		add	word ptr [bp+arg_2], ax
		inc	word ptr [bp+arg_2]
		jmp	loc_2863_F9C
; ---------------------------------------------------------------------------
		align 2

loc_2863_EFA:				; CODE XREF: sub_2863_E2A+7Bj
					; DATA XREF: sub_2863_E2A+168o
		mov	bx, [bp+arg_0]
		mov	si, word ptr [bp+arg_2]
		inc	word ptr [bp+arg_2]
		mov	al, es:[si]
		mov	[bx+5],	al
		push	es
		push	word ptr [bp+arg_2]
		call	ReadLongFromPtr
		add	sp, 4
		mov	bx, [bp+arg_0]
		mov	[bx+6],	ax
		mov	[bx+8],	dx
		add	word ptr [bp+arg_2], 4
		jmp	short loc_2863_F9C
; ---------------------------------------------------------------------------

loc_2863_F24:				; CODE XREF: sub_2863_E2A+7Bj
					; DATA XREF: sub_2863_E2A+154o	...
		mov	bx, [bp+arg_0]
		les	si, [bp+arg_2]
		inc	word ptr [bp+arg_2]
		mov	al, es:[si]
		mov	[bx+5],	al
		jmp	short loc_2863_F9C
; ---------------------------------------------------------------------------
		align 2

loc_2863_F36:				; CODE XREF: sub_2863_E2A+7Bj
					; DATA XREF: sub_2863_E2A+15Ao
		mov	bx, [bp+arg_0]
		mov	si, word ptr [bp+arg_2]
		inc	word ptr [bp+arg_2]
		mov	al, es:[si]
		mov	[bx+5],	al
		mov	si, word ptr [bp+arg_2]
		inc	word ptr [bp+arg_2]
		mov	al, es:[si]
		sub	ah, ah
		mov	[bx+6],	ax
		mov	word ptr [bx+8], 0
		jmp	short loc_2863_F9C
; ---------------------------------------------------------------------------

loc_2863_F5A:				; CODE XREF: sub_2863_E2A+7Bj
					; DATA XREF: sub_2863_E2A+166o
		push	es
		push	word ptr [bp+arg_2]
		call	ReadWordFromPtr
		add	sp, 4
		mov	bx, [bp+arg_0]
		mov	[bx+6],	ax
		mov	word ptr [bx+8], 0
		add	word ptr [bp+arg_2], 2
		jmp	short loc_2863_F9C
; ---------------------------------------------------------------------------
		align 2
off_2863_F78	dw offset loc_2863_F9C	; DATA XREF: sub_2863_E2A+7Br
		dw offset loc_2863_F9C
		dw offset loc_2863_F9C
		dw offset loc_2863_F24
		dw offset loc_2863_F24
		dw offset loc_2863_F24
		dw offset loc_2863_F36
		dw offset loc_2863_F24
		dw offset loc_2863_F24
		dw offset loc_2863_F24
		dw offset loc_2863_F9C
		dw offset loc_2863_F24
		dw offset loc_2863_F5A
		dw offset loc_2863_EFA
		dw offset loc_2863_EE8
		dw offset loc_2863_EAA
		dw offset loc_2863_F24
		dw offset loc_2863_F24
; ---------------------------------------------------------------------------

loc_2863_F9C:				; CODE XREF: sub_2863_E2A+75j
					; sub_2863_E2A+7Bj ...
		cmp	[bp+var_8], 0D9h ; 'Ù'
		jnb	short loc_2863_FF9
		cmp	[bp+var_8], 80h	; '€'
		jbe	short loc_2863_FB7
		mov	bx, [bp+arg_0]
		les	si, [bp+arg_2]
		inc	word ptr [bp+arg_2]
		mov	al, es:[si]
		mov	[bx+5],	al

loc_2863_FB7:				; CODE XREF: sub_2863_E2A+17Cj
		mov	bx, [bp+arg_0]
		sub	ax, ax
		mov	[bx+8],	ax
		mov	[bx+6],	ax
		mov	si, bx

loc_2863_FC4:				; CODE XREF: sub_2863_E2A+1CDj
		les	bx, [bp+arg_2]
		mov	al, es:[bx]
		sub	ah, ah
		and	ax, 7Fh
		sub	dx, dx
		mov	cx, [si+6]
		mov	bx, [si+8]
		mov	di, cx
		mov	cl, 7

loc_2863_FDB:				; CODE XREF: sub_2863_E2A+1B7j
		shl	di, 1
		rcl	bx, 1
		dec	cl
		jnz	short loc_2863_FDB
		add	ax, di
		adc	dx, bx
		mov	[si+6],	ax
		mov	[si+8],	dx
		les	bx, [bp+arg_2]
		inc	word ptr [bp+arg_2]
		test	byte ptr es:[bx], 80h
		jnz	short loc_2863_FC4

loc_2863_FF9:				; CODE XREF: sub_2863_E2A+176j
		mov	bx, [bp+arg_0]
		mov	ax, word ptr [bp+arg_2]
		sub	ax, [bp+var_6]
		mov	[bx+0Ah], al
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_2863_E2A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoAudioDrvC	proc far		; CODE XREF: seg028:004Dp
					; sub_2863_5A+36p

var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	[bp+var_2], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jz	short loc_2863_1053
		mov	di, offset g_drvData2

loc_2863_102B:				; CODE XREF: DoAudioDrvC+42j
		mov	si, di
		cmp	byte ptr [si+1], 0
		jz	short loc_2863_1040
		cmp	byte ptr [si], 10h
		jnb	short loc_2863_1040
		push	si
		push	cs
		call	near ptr AudioDrvC
		add	sp, 2

loc_2863_1040:				; CODE XREF: DoAudioDrvC+25j
					; DoAudioDrvC+2Aj
		add	di, 2Eh	; '.'
		inc	[bp+var_2]
		mov	al, g_cDrvResult
		sub	ah, ah
		cmp	[bp+var_2], ax
		jb	short loc_2863_102B
		mov	[bp+var_4], si

loc_2863_1053:				; CODE XREF: DoAudioDrvC+1Aj
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
DoAudioDrvC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvC	proc far		; CODE XREF: DoAudioDrvC+2Ep
					; AudioDrvF_C_30+1F5p

var_4		= dword	ptr -4
arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	bx, [bp+arg_0]
		add	word ptr [bx+8], 1
		adc	word ptr [bx+0Ah], 0
		mov	ax, [bx+0Ch]
		or	ax, [bx+0Eh]
		jnz	short loc_2863_10C2
		push	bx
		mov	al, [bx+2Ch]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Ch
		mov	word ptr [bp+var_4+2], dx
		mov	word ptr [bp+var_4], ax
		call	[bp+var_4]
		add	sp, 4
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx+1], 2
		mov	al, 4Ch	; 'L'
		mul	byte ptr [bx]
		mov	bx, ax
		cmp	(g_p24Chunkx76+25h)[bx], 0
		jz	short loc_2863_10B6
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx+16h], 3
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_2863_10B6:				; CODE XREF: AudioDrvC+4Ej
		mov	bx, [bp+arg_0]
		mov	byte ptr [bx+16h], 4
		pop	ds
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_2863_10C2:				; CODE XREF: AudioDrvC+1Dj
		sub	word ptr [bx+0Ch], 1
		sbb	word ptr [bx+0Eh], 0
		pop	ds
		mov	sp, bp
		pop	bp
		retf
AudioDrvC	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrvF_C_30	proc far		; CODE XREF: sub_270D_29A+3BP
					; SetDrvFlag2To0:loc_270D_30CP	...

var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		mov	[bp+var_2], 0
		jmp	loc_2863_12A0
; ---------------------------------------------------------------------------
		align 2

loc_2863_10E6:				; CODE XREF: AudioDrvF_C_30+238j
		mov	bx, [bp+var_8]
		mov	byte ptr [bx+16h], 2

loc_2863_10ED:				; CODE XREF: AudioDrvF_C_30+210j
					; AudioDrvF_C_30+226j ...
		cmp	byte ptr [bx+16h], 2
		jnz	short loc_2863_110D
		les	si, [bp+var_6]
		mov	ax, es:[si+22h]
		sub	[bx+14h], ax
		mov	ax, es:[si+24h]
		cmp	[bx+14h], ax
		jg	short loc_2863_110D
		mov	byte ptr [bx+16h], 3
		mov	[bx+14h], ax

loc_2863_110D:				; CODE XREF: AudioDrvF_C_30+21j
					; AudioDrvF_C_30+34j
		cmp	byte ptr [bx+16h], 3
		jnz	short loc_2863_1124
		les	bx, [bp+var_6]
		cmp	word ptr es:[bx+24h], 0
		jnz	short loc_2863_1124
		mov	bx, [bp+var_8]
		mov	byte ptr [bx+16h], 4

loc_2863_1124:				; CODE XREF: AudioDrvF_C_30+41j
					; AudioDrvF_C_30+4Bj
		mov	bx, [bp+var_8]
		cmp	byte ptr [bx+16h], 4
		jnz	short loc_2863_1181
		les	si, [bp+var_6]
		mov	ax, es:[si+26h]
		sub	[bx+14h], ax
		cmp	word ptr [bx+14h], 0
		jg	short loc_2863_1181
		mov	word ptr [bx+14h], 0
		mov	byte ptr [bx+16h], 0
		mov	byte ptr [bx+1], 0
		mov	al, 4Ch	; 'L'
		mul	byte ptr [bx]
		mov	bx, ax
		dec	byte ptr [bx-7DEFh]
		push	[bp+var_8]
		mov	bx, [bp+var_8]
		mov	al, [bx+2Ch]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 0Fh
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 4
		mov	bx, [bp+var_8]
		mov	bl, [bx]
		sub	bh, bh
		mov	byte ptr g_arrDrum[bx],	bh

loc_2863_1181:				; CODE XREF: AudioDrvF_C_30+5Bj
					; AudioDrvF_C_30+6Bj
		les	bx, [bp+var_6]
		cmp	byte ptr es:[bx+28h], 0
		jnz	short loc_2863_118E
		jmp	loc_2863_1223
; ---------------------------------------------------------------------------

loc_2863_118E:				; CODE XREF: AudioDrvF_C_30+B9j
		mov	bx, [bp+var_8]
		cmp	word ptr [bx+18h], 0
		jz	short loc_2863_119E
		dec	word ptr [bx+18h]
		jmp	loc_2863_1223
; ---------------------------------------------------------------------------
		align 2

loc_2863_119E:				; CODE XREF: AudioDrvF_C_30+C5j
		cmp	word ptr [bx+1Ah], 0
		jz	short loc_2863_1223
		cmp	word ptr [bx+1Ah], 7FFFh
		jz	short loc_2863_11AE
		dec	word ptr [bx+1Ah]

loc_2863_11AE:				; CODE XREF: AudioDrvF_C_30+D9j
		cmp	byte ptr [bx+27h], 0
		jnz	short loc_2863_1220
		les	si, [bp+var_6]
		mov	al, es:[si+29h]
		mov	[bx+27h], al
		cmp	byte ptr [bx+26h], 2
		jnz	short loc_2863_11F8
		mov	si, bx
		mov	ax, [si+24h]
		sub	[bx+1Ch], ax
		mov	ax, [bx+1Ch]
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	bx, word ptr [bp+var_6]
		cmp	es:[bx+2Eh], ax
		ja	short loc_2863_1223
		test	byte ptr es:[bx+34h], 1
		jz	short loc_2863_11EE
		mov	bx, si
		mov	byte ptr [bx+26h], 1
		jmp	short loc_2863_1223
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_2863_11EE:				; CODE XREF: AudioDrvF_C_30+112j
					; AudioDrvF_C_30+146j
		mov	bx, [bp+var_8]
		mov	word ptr [bx+1Ch], 0
		jmp	short loc_2863_1223
; ---------------------------------------------------------------------------

loc_2863_11F8:				; CODE XREF: AudioDrvF_C_30+F2j
		mov	si, bx
		mov	ax, [si+24h]
		add	[bx+1Ch], ax
		mov	ax, [bx+1Ch]
		cwd
		xor	ax, dx
		sub	ax, dx
		mov	bx, word ptr [bp+var_6]
		cmp	es:[bx+2Eh], ax
		ja	short loc_2863_1223
		test	byte ptr es:[bx+34h], 2
		jz	short loc_2863_11EE
		mov	bx, si
		mov	byte ptr [bx+26h], 2
		jmp	short loc_2863_1223
; ---------------------------------------------------------------------------

loc_2863_1220:				; CODE XREF: AudioDrvF_C_30+E2j
		dec	byte ptr [bx+27h]

loc_2863_1223:				; CODE XREF: AudioDrvF_C_30+BBj
					; AudioDrvF_C_30+CAj ...
		les	bx, [bp+var_6]
		cmp	byte ptr es:[bx+35h], 0
		jz	short loc_2863_1274
		mov	bx, [bp+var_8]
		cmp	word ptr [bx+1Eh], 0
		jz	short loc_2863_123C
		dec	word ptr [bx+1Eh]
		jmp	short loc_2863_1274
; ---------------------------------------------------------------------------
		align 2

loc_2863_123C:				; CODE XREF: AudioDrvF_C_30+164j
		cmp	word ptr [bx+20h], 0
		jz	short loc_2863_1274
		dec	word ptr [bx+20h]
		cmp	byte ptr [bx+28h], 0
		jz	short loc_2863_1250
		dec	byte ptr [bx+28h]
		jmp	short loc_2863_1274
; ---------------------------------------------------------------------------

loc_2863_1250:				; CODE XREF: AudioDrvF_C_30+179j
		les	si, [bp+var_6]
		mov	al, es:[si+3Ah]
		mov	[bx+28h], al
		mov	al, [bx+29h]
		inc	byte ptr [bx+29h]
		sub	ah, ah
		mov	si, ax
		and	si, 7
		mov	bx, word ptr [bp+var_6]
		mov	al, es:[bx+si+3Bh]
		mov	bx, [bp+var_8]
		mov	[bx+22h], al

loc_2863_1274:				; CODE XREF: AudioDrvF_C_30+15Bj
					; AudioDrvF_C_30+169j ...
		mov	bx, [bp+var_8]
		push	word ptr [bx+12h]
		push	word ptr [bx+10h]
		push	word ptr [bx+2Ah]
		push	bx
		mov	al, [bx+2Ch]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 27h	; '''
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 0Ah

loc_2863_129D:				; CODE XREF: AudioDrvF_C_30+1ECj
		inc	[bp+var_2]

loc_2863_12A0:				; CODE XREF: AudioDrvF_C_30+12j
		mov	al, g_cDrvResult
		sub	ah, ah
		cmp	[bp+var_2], ax
		jnb	short loc_2863_1316
		mov	ax, 2Eh	; '.'
		imul	[bp+var_2]
		add	ax, offset g_drvData2
		mov	[bp+var_8], ax
		mov	bx, ax
		cmp	byte ptr [bx+1], 0
		jz	short loc_2863_129D
		cmp	byte ptr [bx], 0Fh
		jbe	short loc_2863_12CB
		push	ax
		push	cs
		call	near ptr AudioDrvC
		add	sp, 2

loc_2863_12CB:				; CODE XREF: AudioDrvF_C_30+1F1j
		mov	bx, [bp+var_8]
		mov	ax, [bx+10h]
		mov	dx, [bx+12h]
		mov	word ptr [bp+var_6], ax
		mov	word ptr [bp+var_6+2], dx
		cmp	byte ptr [bx+16h], 1
		jz	short loc_2863_12E3
		jmp	loc_2863_10ED
; ---------------------------------------------------------------------------

loc_2863_12E3:				; CODE XREF: AudioDrvF_C_30+20Ej
		les	si, [bp+var_6]
		mov	ax, es:[si+20h]
		add	[bx+14h], ax
		mov	ax, es:[si+1Eh]
		cmp	[bx+14h], ax
		jge	short loc_2863_12F9
		jmp	loc_2863_10ED
; ---------------------------------------------------------------------------

loc_2863_12F9:				; CODE XREF: AudioDrvF_C_30+224j
		mov	[bx+14h], ax
		mov	bx, si
		mov	ax, es:[bx+1Eh]
		cmp	es:[bx+24h], ax
		jge	short loc_2863_130B
		jmp	loc_2863_10E6
; ---------------------------------------------------------------------------

loc_2863_130B:				; CODE XREF: AudioDrvF_C_30+236j
		mov	bx, [bp+var_8]
		mov	byte ptr [bx+16h], 3
		jmp	loc_2863_10ED
; ---------------------------------------------------------------------------
		align 2

loc_2863_1316:				; CODE XREF: AudioDrvF_C_30+1D8j
		mov	ax, offset g_drvData2
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 30h	; '0'
		mov	word ptr [bp+var_C+2], dx
		mov	word ptr [bp+var_C], ax
		call	[bp+var_C]
		add	sp, 2
		pop	ds
		pop	si
		mov	sp, bp
		pop	bp
		retf
AudioDrvF_C_30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AudioDrv1E	proc far		; CODE XREF: sub_270D_29A+12P
					; SetDrvFlag2To0+1CP ...

var_16		= dword	ptr -16h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 16h
		push	di
		push	si
		push	ds
		mov	ax, seg	dseg
		mov	ds, ax
		cmp	g_cDrvFlag7, 0
		jz	short loc_2863_134E
		jmp	loc_2863_13D4
; ---------------------------------------------------------------------------

loc_2863_134E:				; CODE XREF: AudioDrv1E+13j
		mov	[bp+var_2], 0
		mov	al, g_cDrvResult
		sub	ah, ah
		or	ax, ax
		jnz	short loc_2863_135F
		jmp	loc_2863_146E
; ---------------------------------------------------------------------------

loc_2863_135F:				; CODE XREF: AudioDrv1E+24j
		mov	si, offset g_drvData2
		mov	[bp+var_8], offset g_drvData
		mov	[bp+var_A], offset g_drvData4
		mov	[bp+var_C], offset g_drvData3
		mov	di, [bp+var_2]

loc_2863_1374:				; CODE XREF: AudioDrv1E+96j
		mov	al, [si]
		sub	ah, ah
		cmp	ax, [bp+arg_2]
		ja	short loc_2863_13B2
		cmp	ax, [bp+arg_0]
		jb	short loc_2863_13B2
		push	di
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 1Eh
		mov	word ptr [bp+var_10+2],	dx
		mov	word ptr [bp+var_10], ax
		call	[bp+var_10]
		add	sp, 2
		mov	bx, [bp+var_8]
		mov	byte ptr [bx], 0
		mov	bx, [bp+var_A]
		sub	ax, ax
		mov	[bx+2],	ax
		mov	[bx], ax
		mov	byte ptr [si], 0FFh
		mov	bx, [bp+var_C]
		mov	byte ptr [bx], 0

loc_2863_13B2:				; CODE XREF: AudioDrv1E+45j
					; AudioDrv1E+4Aj
		add	si, 2Eh	; '.'
		add	[bp+var_8], 2Eh	; '.'
		add	[bp+var_A], 2Eh	; '.'
		add	[bp+var_C], 2Eh	; '.'
		inc	di
		mov	ax, di
		mov	cl, g_cDrvResult
		sub	ch, ch
		cmp	ax, cx
		jb	short loc_2863_1374
		mov	[bp+var_2], di
		jmp	loc_2863_146E
; ---------------------------------------------------------------------------

loc_2863_13D4:				; CODE XREF: AudioDrv1E+15j
		mov	ax, [bp+arg_0]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_2]
		cmp	[bp+var_2], ax
		jle	short loc_2863_13E5
		jmp	loc_2863_146E
; ---------------------------------------------------------------------------

loc_2863_13E5:				; CODE XREF: AudioDrv1E+AAj
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		add	ax, (offset g_p24Chunkx76+47h)
		mov	[bp+var_12], ax

loc_2863_13F1:				; CODE XREF: AudioDrv1E+136j
		mov	bx, [bp+var_12]
		cmp	byte ptr [bx], 10h
		jnb	short loc_2863_145F
		mov	al, [bx]
		sub	ah, ah
		push	ax
		mov	ax, word ptr g_pDrvBinary
		mov	dx, word ptr g_pDrvBinary+2
		add	ax, 1Eh
		mov	word ptr [bp+var_16+2],	dx
		mov	word ptr [bp+var_16], ax
		call	[bp+var_16]
		add	sp, 2
		mov	[bp+var_4], 10h
		mov	si, offset g_drvData2
		mov	di, offset g_drvData
		mov	[bp+var_A], offset g_drvData4
		mov	[bp+var_8], offset g_drvData3
		mov	[bp+var_6], 10h
		mov	cx, 10h

loc_2863_1431:				; CODE XREF: AudioDrv1E+127j
		mov	al, [si]
		sub	ah, ah
		cmp	[bp+var_2], ax
		jnz	short loc_2863_144F
		mov	[di], ah
		mov	bx, [bp+var_A]
		sub	ax, ax
		mov	[bx+2],	ax
		mov	[bx], ax
		mov	byte ptr [si], 0FFh
		mov	bx, [bp+var_8]
		mov	byte ptr [bx], 0

loc_2863_144F:				; CODE XREF: AudioDrv1E+102j
		add	si, 2Eh	; '.'
		add	di, 2Eh	; '.'
		add	[bp+var_A], 2Eh	; '.'
		add	[bp+var_8], 2Eh	; '.'
		loop	loc_2863_1431

loc_2863_145F:				; CODE XREF: AudioDrv1E+C1j
		add	[bp+var_12], 4Ch ; 'L'
		inc	[bp+var_2]
		mov	ax, [bp+arg_2]
		cmp	[bp+var_2], ax
		jle	short loc_2863_13F1

loc_2863_146E:				; CODE XREF: AudioDrv1E+26j
					; AudioDrv1E+9Bj ...
		mov	ax, [bp+arg_0]
		mov	[bp+var_2], ax
		mov	ax, [bp+arg_2]
		cmp	[bp+var_2], ax
		jg	short loc_2863_149A
		mov	ax, 4Ch	; 'L'
		imul	[bp+arg_0]
		mov	si, ax
		add	si, (offset g_p24Chunkx76+15h)
		mov	cx, [bp+arg_2]
		sub	cx, [bp+arg_0]
		inc	cx
		add	[bp+var_2], cx

loc_2863_1492:				; CODE XREF: AudioDrv1E+162j
		mov	byte ptr [si], 0
		add	si, 4Ch	; 'L'
		loop	loc_2863_1492

loc_2863_149A:				; CODE XREF: AudioDrv1E+144j
		pop	ds
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
AudioDrv1E	endp

seg028		ends

; ===========================================================================

; Segment type:	Pure code
seg029		segment	byte public 'CODE' use16
		assume cs:seg029
		;org 1
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_29AD_4	proc far		; CODE XREF: DoHdr1AudioStuf+1D8P
					; sub_29AD_8A+55p

var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= dword	ptr  8
arg_6		= dword	ptr  0Ch
arg_A		= word ptr  10h

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		cmp	[bp+arg_A], 0
		jz	short loc_29AD_80
		mov	di, [bp+arg_0]
		mov	si, [bp+arg_A]

loc_29AD_18:				; CODE XREF: sub_29AD_4+77j
		les	bx, [bp+arg_2]
		cmp	byte ptr es:[bx], 0
		jz	short loc_29AD_7D
		les	bx, [bp+arg_6]
		cmp	byte ptr es:[bx], 0
		jz	short loc_29AD_7D
		or	di, di
		jz	short loc_29AD_46
		mov	al, es:[bx]
		les	bx, [bp+arg_2]
		cmp	es:[bx], al
		jz	short loc_29AD_46

loc_29AD_39:				; CODE XREF: sub_29AD_4+6Ej
		sub	ax, ax
		mov	[bp+arg_A], si
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		db 2 dup(90h)
; ---------------------------------------------------------------------------

loc_29AD_46:				; CODE XREF: sub_29AD_4+28j
					; sub_29AD_4+33j
		or	di, di
		jnz	short loc_29AD_74
		les	bx, [bp+arg_6]
		mov	al, es:[bx]
		sub	ah, ah
		push	ax
		call	sub_270B_A
		add	sp, 2
		les	bx, [bp+arg_2]
		mov	cl, es:[bx]
		sub	ch, ch
		push	cx
		mov	[bp+var_2], ax
		call	sub_270B_A
		add	sp, 2
		cmp	ax, [bp+var_2]
		jnz	short loc_29AD_39

loc_29AD_74:				; CODE XREF: sub_29AD_4+44j
		inc	word ptr [bp+arg_2]
		inc	word ptr [bp+arg_6]
		dec	si
		jnz	short loc_29AD_18

loc_29AD_7D:				; CODE XREF: sub_29AD_4+1Bj
					; sub_29AD_4+24j
		mov	[bp+arg_A], si

loc_29AD_80:				; CODE XREF: sub_29AD_4+Cj
		mov	ax, 1
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_29AD_4	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_29AD_8A	proc far		; CODE XREF: DoHdr1AudioStuf+AFP
					; DoHdr1AudioStuf+245P	...

var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= byte ptr -6
var_2		= byte ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= dword	ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	di
		push	si
		mov	[bp+var_2], 0
		mov	[bp+var_8], 0
		cmp	[bp+arg_2], 0
		jle	short loc_29AD_103
		mov	ax, [bp+arg_4]
		mov	[bp+var_E], ax
		mov	[bp+var_C], ds
		mov	si, [bp+var_8]

loc_29AD_AD:				; CODE XREF: sub_29AD_8A+74j
		sub	cx, cx
		les	di, [bp+arg_6]

loc_29AD_B2:				; CODE XREF: sub_29AD_8A+37j
		mov	bx, cx
		add	bx, bp
		mov	al, es:[di]
		mov	[bx-6],	al
		inc	di
		inc	cx
		cmp	cx, 4
		jl	short loc_29AD_B2
		mov	word ptr [bp+arg_6], di
		mov	word ptr [bp+arg_6+2], es
		mov	[bp+var_A], cx
		mov	ax, 4
		push	ax
		push	[bp+var_C]
		push	[bp+var_E]
		lea	ax, [bp+var_6]
		push	ss
		push	ax
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr sub_29AD_4
		add	sp, 0Ch
		or	ax, ax
		jz	short loc_29AD_F4
		mov	ax, si
		mov	[bp+var_8], si
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_29AD_F4:				; CODE XREF: sub_29AD_8A+5Dj
		mov	ax, [bp+arg_0]
		add	word ptr [bp+arg_6], ax
		inc	si
		cmp	si, [bp+arg_2]
		jl	short loc_29AD_AD
		mov	[bp+var_8], si

loc_29AD_103:				; CODE XREF: sub_29AD_8A+15j
		mov	ax, 0FFFFh
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_29AD_8A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

InitAudioRes	proc far		; CODE XREF: DoInitAudioRese+FP
					; DoInitAudioRese+32P ...

var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 10h
		sub	ax, ax
		mov	[bp+var_8], ax
		mov	[bp+var_A], ax
		mov	ax, 4
		cwd
		add	ax, [bp+arg_0]
		adc	dx, 0
		mov	cx, 0Ch
		shl	dx, cl
		add	dx, [bp+arg_2]
		mov	es, dx
		mov	bx, ax
		mov	ax, es:[bx]
		mov	[bp+var_2], ax
		mov	ax, 6
		cwd
		add	ax, [bp+arg_0]
		adc	dx, 0
		shl	dx, cl
		add	dx, [bp+arg_2]
		push	dx
		push	ax
		push	[bp+arg_4]	; e.g "hdr1", "BASD", "SNAR", "TOMM"..
					; audio	related	stuff
		push	[bp+var_2]
		sub	ax, ax
		push	ax
		push	cs
		call	near ptr sub_29AD_8A
		add	sp, 0Ah
		mov	[bp+var_10], ax
		or	ax, ax
		jl	short loc_29AD_1AA
		mov	ax, [bp+arg_0]
		mov	dx, [bp+arg_2]
		mov	cx, [bp+var_2]
		shl	cx, 1
		shl	cx, 1
		add	ax, cx
		mov	cx, [bp+var_10]
		shl	cx, 1
		shl	cx, 1
		add	ax, cx
		add	ax, 6
		mov	[bp+var_6], ax
		mov	[bp+var_4], dx
		push	dx
		push	ax
		call	ReadLongFromPtr
		add	sp, 4
		mov	[bp+var_E], ax
		mov	[bp+var_C], dx
		mov	ax, [bp+arg_0]
		mov	dx, [bp+arg_2]
		mov	bx, [bp+var_2]
		mov	cl, 3
		shl	bx, cl
		add	ax, bx
		add	ax, [bp+var_E]
		add	ax, 6
		mov	[bp+var_A], ax
		mov	[bp+var_8], dx

loc_29AD_1AA:				; CODE XREF: InitAudioRes+50j
		mov	ax, [bp+var_A]
		mov	dx, [bp+var_8]
		mov	sp, bp
		pop	bp
		retf
InitAudioRes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_29AD_1B4	proc far		; CODE XREF: DoHdr1AudioStuf+97P
					; DoHdr1AudioStuf+22DP

var_6		= word ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  6
arg_4		= dword	ptr  0Ah
arg_8		= word ptr  0Eh

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	di
		push	si
		mov	[bp+var_2], 0
		cmp	[bp+arg_8], 0
		jle	short loc_29AD_1F4
		mov	cx, [bp+arg_8]
		mov	ax, cx
		add	[bp+var_2], ax
		les	di, [bp+arg_4]
		mov	[bp+var_6], ds
		lds	si, [bp+arg_0]

loc_29AD_1D8:				; CODE XREF: sub_29AD_1B4+2Fj
		mov	al, [si]
		mov	es:[di], al
		mov	ax, si
		mov	dx, ds
		inc	si
		inc	di
		loop	loc_29AD_1D8
		mov	word ptr [bp+arg_0], si
		mov	word ptr [bp+arg_0+2], ds
		mov	ds, [bp+var_6]
		mov	word ptr [bp+arg_4], di
		mov	word ptr [bp+arg_4+2], es

loc_29AD_1F4:				; CODE XREF: sub_29AD_1B4+11j
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
sub_29AD_1B4	endp

seg029		ends

; ===========================================================================

; Segment type:	Pure code
seg030		segment	byte public 'CODE' use16
		assume cs:seg030
		;org 0Ah
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		db 2 dup(90h), 2 dup(0)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetAString	proc far		; CODE XREF: LoadAudioDriver+92P
					; LoadSfxGe+FP	...

var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	di
		push	si
		mov	si, offset g_pcTempStr
		push	ds
		pop	es
		assume es:dseg
		mov	di, [bp+arg_0]
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		sub	di, cx
		xchg	di, si
		shr	cx, 1
		repne movsw
		adc	cx, cx
		repne movsb
		mov	ax, 5Ch	; '\'
		push	ax
		mov	ax, offset g_pcTempStr
		push	ax
		call	_strrchr
		add	sp, 4
		mov	[bp+var_2], ax
		or	ax, ax
		jz	short loc_29CC_56
		inc	[bp+var_2]
		mov	bx, [bp+var_2]
		mov	byte ptr [bx], 0
		jmp	short loc_29CC_5B
; ---------------------------------------------------------------------------
		align 2

loc_29CC_56:				; CODE XREF: GetAString+3Aj
		mov	g_pcTempStr, 0

loc_29CC_5B:				; CODE XREF: GetAString+45j
		mov	si, offset g_pcTempStr
		push	ds
		pop	es
		mov	di, [bp+arg_4]
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		sub	di, cx
		mov	bx, cx
		xchg	di, si
		mov	cx, 0FFFFh
		repne scasb
		dec	di
		mov	cx, bx
		shr	cx, 1
		repne movsw
		adc	cx, cx
		repne movsb
		mov	ax, 5Ch	; '\'
		push	ax
		push	[bp+arg_0]
		call	_strrchr
		add	sp, 4
		mov	[bp+var_2], ax
		or	ax, ax
		jz	short loc_29CC_AA
		inc	[bp+var_2]
		mov	bx, [bp+var_2]
		mov	di, bx
		mov	si, offset g_pcTempStr
		mov	ax, ds
		mov	es, ax
		jmp	short loc_29CC_B2
; ---------------------------------------------------------------------------
		align 2

loc_29CC_AA:				; CODE XREF: GetAString+88j
		mov	si, offset g_pcTempStr
		push	ds
		pop	es
		mov	di, [bp+arg_0]

loc_29CC_B2:				; CODE XREF: GetAString+99j
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		sub	di, cx
		mov	bx, cx
		xchg	di, si
		mov	cx, 0FFFFh
		repne scasb
		dec	di
		mov	cx, bx
		shr	cx, 1
		repne movsw
		adc	cx, cx
		repne movsb
		mov	di, offset g_pcTempStr
		mov	ax, ds
		mov	es, ax
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		dec	cx
		mov	bx, cx
		cmp	g_cIniEng1Flag3[bx], 2Eh ; '.'
		jnz	short loc_29CC_FF
		mov	di, offset g_pcTempStr
		mov	ax, ds
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		dec	cx
		cmp	cx, 4
		ja	short loc_29CC_14B

loc_29CC_FF:				; CODE XREF: GetAString+DBj
		mov	di, offset unk_2B77_503C
		mov	si, offset g_pcTempStr
		mov	ax, ds
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		sub	di, cx
		mov	bx, cx
		xchg	di, si
		mov	cx, 0FFFFh
		repne scasb
		dec	di
		mov	cx, bx
		shr	cx, 1
		repne movsw
		adc	cx, cx
		repne movsb
		mov	si, offset g_pcTempStr
		mov	di, [bp+arg_2]
		mov	cx, 0FFFFh
		xor	ax, ax
		repne scasb
		not	cx
		sub	di, cx
		mov	bx, cx
		xchg	di, si
		mov	cx, 0FFFFh
		repne scasb
		dec	di
		mov	cx, bx
		shr	cx, 1
		repne movsw
		adc	cx, cx
		repne movsb

loc_29CC_14B:				; CODE XREF: GetAString+EFj
		mov	ax, offset g_pcTempStr
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
GetAString	endp

seg030		ends

; ===========================================================================

; Segment type:	Pure code
seg031		segment	byte public 'CODE' use16
		assume cs:seg031
		;org 4
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

DoLoad2DShape_1	proc far		; CODE XREF: LoadResource+7DP

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		push	[bp+arg_0]
		call	DoLoad2DShape_0
		add	sp, 2
		pop	bp
		retf
DoLoad2DShape_1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

FindFileFromPat	proc far		; CODE XREF: RunCarMenu+5BP
					; TakesTrackNames+175P

var_50		= byte ptr -50h
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah

		push	bp
		mov	bp, sp
		sub	sp, 50h
		lea	ax, [bp+var_50]
		push	ax
		push	[bp+arg_4]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	CombineFilePath
		add	sp, 8
		lea	ax, [bp+var_50]
		push	ax
		call	FindFileName
		mov	sp, bp
		pop	bp
		retf
FindFileFromPat	endp


; =============== S U B	R O U T	I N E =======================================


DoFindNext	proc far		; CODE XREF: RunCarMenu:loc_0_1CE1P
					; TakesTrackNames:loc_174B_BF8P
		call	FindNext
		retf
DoFindNext	endp


; =============== S U B	R O U T	I N E =======================================


nullsub_1	proc far		; CODE XREF: RunCarMenu+6BP
					; RunCarMenu:loc_0_1D44P ...
		retf
nullsub_1	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


nullsub_2	proc far		; CODE XREF: RunCarMenu+2CCP
					; RunCarMenu+A51P ...
		retf
nullsub_2	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

SetVideoMode	proc far		; CODE XREF: _main+EP

pcCmdArg	= word ptr -1Eh
wTimerDelta3	= word ptr -1Ch
var_1A		= word ptr -1Ah
var_18		= word ptr -18h
cSetMode4	= byte ptr -12h
wTimerDelta2	= word ptr -10h
p_cArgNosound	= byte ptr -0Eh
wTimerDelta	= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
p_cArgNd	= byte ptr -2
p_argv		= word ptr  6
p_argc		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 1Eh
		push	di
		push	si
		call	SetupSomeHandlers
		call	DoKbChecking2
		call	CallReadCharCB
		mov	ax, offset DoMrlTextRes
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 7
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoJoyResText	; Calibrate joystick
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 0Ah
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoKeyResText	; Keyboard on
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 0Bh
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoMofTextRes	; Music	off
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 3200h
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoPauTextRes	; Pause
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 10h
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoPauTextRes	; Pause
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 70h
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoDosTextRes	; Exit to dos
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 11h
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoSonSofTextRes ; Sound fx on/off
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 13h
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6
		mov	ax, offset DoDosTextRes	; Exit to dos
		mov	dx, seg	seg008
		push	dx
		push	ax
		mov	ax, 18h
		push	ax
		call	RegSomeFuncPtr
		add	sp, 6

loc_29E1_111:
		mov	g_wSetHandlers,	1

loc_29E1_117:
		mov	g_wVideoFlag1, 1
		mov	g_wVideoFlag2, 0FFFFh
		mov	g_wVideoFlag3, 1
		call	AllocResMemA000
		mov	g_wVideoFlag4, 0
		mov	g_wVideoFlag5, 1
		mov	g_wVideoFlag6, 65h ; 'e'
		mov	[bp+cSetMode4],	0
		mov	[bp+p_cArgNosound], 0
		mov	[bp+p_cArgNd], 0
		mov	si, 1
		jmp	short loc_29E1_153
; ---------------------------------------------------------------------------

loc_29E1_14E:				; CODE XREF: SetVideoMode+131j
		mov	[bp+cSetMode4],	1 ; only where when /h

lblNextCmdArg:				; CODE XREF: SetVideoMode+128j
					; SetVideoMode+13Ej ...
		inc	si

loc_29E1_153:				; CODE XREF: SetVideoMode+106j
		cmp	[bp+p_argv], si
		jg	short loc_29E1_15B ; any command line arguments?
		jmp	loc_29E1_26A
; ---------------------------------------------------------------------------

loc_29E1_15B:				; CODE XREF: SetVideoMode+110j
		mov	bx, [bp+p_argc]
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	ax, ds_NULL[bx]
		mov	[bp+pcCmdArg], ax
		mov	bx, ax
		cmp	byte ptr [bx], '/'
		jnz	short lblNextCmdArg
		mov	al, [bx+1]
		cbw
		cmp	ax, 'h'
		jz	short loc_29E1_14E
		cmp	ax, 'n'
		jnz	short loc_29E1_181
		jmp	loc_29E1_236
; ---------------------------------------------------------------------------

loc_29E1_181:				; CODE XREF: SetVideoMode+136j
		cmp	ax, 's'
		jnz	short lblNextCmdArg
		mov	bx, [bp+p_argc]	; got here from	/s
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	ax, ds_NULL[bx]
		mov	[bp+pcCmdArg], ax
		mov	bx, ax
		mov	al, [bx+2]
		cbw
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_29E1_1B8
		mov	bx, [bp+p_argc]
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	bx, [bx]
		mov	al, [bx+2]
		cbw
		add	ax, 20h	; ' '
		jmp	short loc_29E1_1C7
; ---------------------------------------------------------------------------
		align 2

loc_29E1_1B8:				; CODE XREF: SetVideoMode+15Bj
		mov	bx, [bp+p_argc]	; /s
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	bx, [bx]
		mov	al, [bx+2]
		cbw

loc_29E1_1C7:				; CODE XREF: SetVideoMode+16Fj
		cmp	ax, 's'
		jnz	short loc_29E1_212
		mov	bx, [bp+pcCmdArg]
		mov	al, [bx+3]
		cbw
		mov	bx, ax
		test	byte ptr g_arrSlashS[bx], 1
		jz	short loc_29E1_1F0
		mov	bx, [bp+p_argc]
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	bx, [bx]
		mov	al, [bx+3]
		cbw
		add	ax, 20h	; ' '
		jmp	short loc_29E1_1FF
; ---------------------------------------------------------------------------

loc_29E1_1F0:				; CODE XREF: SetVideoMode+194j
		mov	bx, [bp+p_argc]
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	bx, [bx]
		mov	al, [bx+3]
		cbw

loc_29E1_1FF:				; CODE XREF: SetVideoMode+1A8j
		cmp	ax, 'b'         ; if /ssb, replace the two first bytes in "pc15" so it becomes "ad15"
		jnz	short loc_29E1_212
		mov	byte ptr g_pcAudioDriver, 'a' ; "pc15"
		mov	byte ptr g_pcAudioDriver+1, 'd'
		jmp	lblNextCmdArg
; ---------------------------------------------------------------------------
		align 2

loc_29E1_212:				; CODE XREF: SetVideoMode+184j
					; SetVideoMode+1BCj
		mov	ax, [bp+p_argc]	; got here from	/sNN, where NN will be replaced	with pc	in "pc15"
		mov	cx, si
		shl	cx, 1
		add	ax, cx
		mov	[bp+pcCmdArg], ax
		mov	bx, ax
		mov	bx, [bx]
		mov	al, [bx+2]
		mov	byte ptr g_pcAudioDriver, al ; "pc15"
		mov	bx, [bp+pcCmdArg]
		mov	bx, [bx]
		mov	al, [bx+3]
		mov	byte ptr g_pcAudioDriver+1, al
		jmp	lblNextCmdArg
; ---------------------------------------------------------------------------

loc_29E1_236:				; CODE XREF: SetVideoMode+138j
		mov	bx, [bp+p_argc]	; got here from	/n
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	bx, [bx]
		cmp	byte ptr [bx+2], 's'
		jnz	short loc_29E1_24E
		mov	[bp+p_cArgNosound], 1
		jmp	lblNextCmdArg
; ---------------------------------------------------------------------------

loc_29E1_24E:				; CODE XREF: SetVideoMode+1FFj
		mov	bx, [bp+p_argc]
		mov	ax, si
		shl	ax, 1
		add	bx, ax
		mov	bx, [bx]
		cmp	byte ptr [bx+2], 'd'
		jz	short loc_29E1_262
		jmp	lblNextCmdArg
; ---------------------------------------------------------------------------

loc_29E1_262:				; CODE XREF: SetVideoMode+217j
		mov	[bp+p_cArgNd], 1
		jmp	lblNextCmdArg
; ---------------------------------------------------------------------------
		align 2
; end of command line handling

loc_29E1_26A:				; CODE XREF: SetVideoMode+112j
		call	CallBiosMode13h
		cmp	[bp+cSetMode4],	0
		jz	short loc_29E1_27A
		call	SetBiosMode4

loc_29E1_27A:				; CODE XREF: SetVideoMode+22Dj
		call	SetupTimerCallb
		call	SetSprite2Clear
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	InitMouse
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		mov	ax, offset g_pcAudioDriver ; "pc15"
		push	ax
		call	LoadAudioDriver
		add	sp, 6
		or	ax, ax
		jz	short loc_29E1_2B9
		call	StopSoundMaybe
		mov	ax, 1
		push	ax
		call	far ptr	libsub_1CC5_19C	; jumps	into the run time start	method?
		add	sp, 2

loc_29E1_2B9:				; CODE XREF: SetVideoMode+260j
		cmp	[bp+p_cArgNosound], 0
		jz	short loc_29E1_2C9
		call	ToggleDrvFlag2
		call	ToggleDrvFlag6

loc_29E1_2C9:				; CODE XREF: SetVideoMode+277j
		mov	ax, offset DoDeaTextRes
		mov	dx, seg	seg008
		push	dx
		push	ax
		call	SetCritErrHandl
		add	sp, 4
		push	cs
		call	near ptr LoadPalAndCurso
		call	SetSprite2As1
		mov	ax, 78h		; 120
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		call	DoGetTimerDelta
		sub	si, si

loc_29E1_2FF:				; CODE XREF: SetVideoMode+2C8j
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		inc	si
		cmp	si, 0Fh
		jl	short loc_29E1_2FF
		call	DoGetTimerDelta
		mov	[bp+wTimerDelta], ax
		mov	ax, 3Ch		; 60
		push	ax
		sub	ax, ax
		push	ax
		mov	ax, 140h	; 320
		push	ax
		sub	ax, ax
		push	ax
		call	SetSprite1Size
		add	sp, 8
		sub	si, si

loc_29E1_330:				; CODE XREF: SetVideoMode+32Cj
		mov	[bp+var_A], 0
		mov	[bp+var_8], 0
		mov	[bp+var_6], 0
		mov	[bp+var_4], 0
		sub	di, di

loc_29E1_346:				; CODE XREF: SetVideoMode+31Bj
		mov	[bp+var_1A], di
		mov	[bp+var_18], di
		lea	ax, [bp+var_A]
		push	ax
		lea	ax, [bp+var_1A]
		push	ax
		call	RectOp
		add	sp, 4
		inc	di
		cmp	di, 190h	; 400
		jl	short loc_29E1_346
		sub	ax, ax
		push	ax
		call	ClearSprite1Col
		add	sp, 2
		inc	si
		cmp	si, 0Fh
		jl	short loc_29E1_330

; a loop of 0xf	seems to end here
; now follows some timer delta comparisons
		call	DoGetTimerDelta
		mov	[bp+wTimerDelta2], ax
		sub	si, si
		jmp	short loc_29E1_39B
; ---------------------------------------------------------------------------

loc_29E1_380:				; CODE XREF: SetVideoMode+351j
		inc	di

loc_29E1_381:				; CODE XREF: SetVideoMode+35Dj
		cmp	di, 0FFh
		jge	short loc_29E1_39A
		lea	ax, [bp+var_A]
		push	ax
		lea	ax, [bp+var_1A]
		push	ax
		call	RectOp
		add	sp, 4
		jmp	short loc_29E1_380
; ---------------------------------------------------------------------------
		align 2

loc_29E1_39A:				; CODE XREF: SetVideoMode+33Fj
		inc	si

loc_29E1_39B:				; CODE XREF: SetVideoMode+338j
		cmp	si, 92h	; '’'
		jge	short loc_29E1_3A6
		sub	di, di
		jmp	short loc_29E1_381
; ---------------------------------------------------------------------------
		align 2

loc_29E1_3A6:				; CODE XREF: SetVideoMode+359j
		call	DoGetTimerDelta
		mov	[bp+wTimerDelta3], ax
		mov	ax, [bp+wTimerDelta]
		cmp	[bp+wTimerDelta2], ax
		jle	short loc_29E1_3BE
		mov	g_wTimerFlag1, 0
		jmp	short loc_29E1_3C4
; ---------------------------------------------------------------------------

loc_29E1_3BE:				; CODE XREF: SetVideoMode+36Ej
		mov	g_wTimerFlag1, 1

loc_29E1_3C4:				; CODE XREF: SetVideoMode+376j
		cmp	[bp+wTimerDelta3], 4Bh ; 'K'
		jge	short loc_29E1_3D2
		mov	g_wFramesPerSec2, 14h
		jmp	short loc_29E1_3D8
; ---------------------------------------------------------------------------

loc_29E1_3D2:				; CODE XREF: SetVideoMode+382j
		mov	g_wFramesPerSec2, 0Ah

loc_29E1_3D8:				; CODE XREF: SetVideoMode+38Aj
		cmp	[bp+wTimerDelta3], 23h ; '#'
		jge	short loc_29E1_3E6
		mov	g_wTimerFlag3, 0
		jmp	short loc_29E1_41B
; ---------------------------------------------------------------------------
		align 2

loc_29E1_3E6:				; CODE XREF: SetVideoMode+396j
		cmp	[bp+wTimerDelta3], 37h ; '7'
		jge	short loc_29E1_3F4
		mov	g_wTimerFlag3, 1
		jmp	short loc_29E1_41B
; ---------------------------------------------------------------------------
		align 2

loc_29E1_3F4:				; CODE XREF: SetVideoMode+3A4j
		cmp	[bp+wTimerDelta3], 4Bh ; 'K'
		jge	short loc_29E1_402
		mov	g_wTimerFlag3, 2
		jmp	short loc_29E1_41B
; ---------------------------------------------------------------------------
		align 2

loc_29E1_402:				; CODE XREF: SetVideoMode+3B2j
		cmp	[bp+wTimerDelta3], 64h ; 'd'
		jl	short loc_29E1_40F
		cmp	g_wTimerFlag1, 0
		jnz	short loc_29E1_416

loc_29E1_40F:				; CODE XREF: SetVideoMode+3C0j
		mov	g_wTimerFlag3, 3
		jmp	short loc_29E1_41B
; ---------------------------------------------------------------------------

loc_29E1_416:				; CODE XREF: SetVideoMode+3C7j
		mov	g_wTimerFlag3, 4

loc_29E1_41B:				; CODE XREF: SetVideoMode+39Dj
					; SetVideoMode+3ABj ...
		mov	ax, g_wFramesPerSec2
		mov	g_wFramesPerSec, ax
		mov	ax, g_wTimerFlag1
		mov	g_wTimerFlag5, ax
		push	cs
		call	near ptr RandomWait
		sub	ax, ax
		push	ax
		push	g_wVideoConst4
		push	g_wVideoConst3
		push	g_wVideoConst2
		push	g_wVideoConst1
		call	SetVideoValues
		add	sp, 0Ah
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
SetVideoMode	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

RandomWait	proc far		; CODE XREF: _main:_lblSecCheck1P
					; SetVideoMode+3E2p
		push	bp
		mov	bp, sp
		sub	sp, 4
		push	di
		push	si
		call	GetVideoStatus
		mov	si, ax
		sub	di, di
		jmp	short loc_29E1_467
; ---------------------------------------------------------------------------
		nop

loc_29E1_460:				; CODE XREF: RandomWait+22j
		cmp	di, 2EE0h	; 2ee0 = 12000.. wait for video	status to become the same again	up to 12000 times
		jge	short loc_29E1_470
		inc	di

loc_29E1_467:				; CODE XREF: RandomWait+11j
		call	GetVideoStatus
		cmp	ax, si
		jz	short loc_29E1_460

loc_29E1_470:				; CODE XREF: RandomWait+18j
		cmp	di, 400h
		jnz	short loc_29E1_48A
		mov	bx, 46Ch
		mov	al, [bx]
		cbw
		mov	di, ax
		jmp	short loc_29E1_48A
; ---------------------------------------------------------------------------

loc_29E1_480:				; CODE XREF: RandomWait+43j
		call	_rand
		call	GetRandomKevin

loc_29E1_48A:				; CODE XREF: RandomWait+28j
					; RandomWait+32j
		mov	ax, di
		dec	di
		or	ax, ax
		jnz	short loc_29E1_480
		and	di, 0FFh
		jmp	short loc_29E1_4A2
; ---------------------------------------------------------------------------
		nop

loc_29E1_498:				; CODE XREF: RandomWait+5Bj
		call	GetRandomKevin
		call	_rand

loc_29E1_4A2:				; CODE XREF: RandomWait+49j
		mov	ax, di
		dec	di
		or	ax, ax
		jnz	short loc_29E1_498
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
RandomWait	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

LoadPalAndCurso	proc far		; CODE XREF: SetVideoMode+294p

dwWidth		= word ptr -312h
pSmouRes	= dword	ptr -310h
pSdmain1	= dword	ptr -30Ch
dwCounter	= word ptr -308h
dwHeight	= word ptr -306h
pPalRes		= dword	ptr -304h
pPalette	= byte ptr -300h

		push	bp
		mov	bp, sp
		sub	sp, 312h
		push	si
		mov	ax, offset aSdmain ; "sdmain"
		push	ax
		call	far ptr	j__Load2DShape_1
		add	sp, 2
		mov	word ptr [bp+pSdmain1],	ax
		mov	word ptr [bp+pSdmain1+2], dx
		mov	ax, offset aPal	; "!pal"
		push	ax
		push	dx
		push	word ptr [bp+pSdmain1]
		call	LocateShape
		add	sp, 6
		mov	word ptr [bp+pPalRes], ax
		mov	word ptr [bp+pPalRes+2], dx
		add	word ptr [bp+pPalRes], 10h
		mov	[bp+dwCounter],	0

loc_29E1_4F0:				; CODE XREF: LoadPalAndCurso+5Bj
		mov	bx, [bp+dwCounter]
		les	si, [bp+pPalRes]
		mov	al, es:[bx+si]
		mov	si, bx
		mov	[bp+si+pPalette], al
		inc	[bp+dwCounter]
		cmp	[bp+dwCounter],	300h ; 0x300 = 3*0x100 rgb values
		jl	short loc_29E1_4F0
		lea	ax, [bp+pPalette]
		push	ax
		mov	ax, 100h
		push	ax
		sub	ax, ax
		push	ax
		call	SetPalette
		add	sp, 6
		mov	ax, offset aSmou ; "smou"
		push	ax
		push	word ptr [bp+pSdmain1+2]
		push	word ptr [bp+pSdmain1]
		call	LocateShape
		add	sp, 6
		mov	word ptr [bp+pSmouRes],	ax
		mov	word ptr [bp+pSmouRes+2], dx
		les	bx, [bp+pSmouRes]
		mov	ax, es:[bx]	; Maybe	extract	width?
		imul	g_wVideoFlag1
		mov	[bp+dwWidth], ax
		mov	ax, es:[bx+2]	; Maybe	extract	height?
		mov	[bp+dwHeight], ax
		push	word ptr [bp+pSdmain1+2]
		push	word ptr [bp+pSdmain1]
		call	UnloadResource
		add	sp, 4
		mov	ax, 0Fh
		push	ax
		push	[bp+dwHeight]
		push	[bp+dwWidth]
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_dwMouSprite,	ax
		mov	word ptr g_dwMouSprite+2, dx
		mov	ax, 0Fh
		push	ax
		push	[bp+dwHeight]
		push	[bp+dwWidth]
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_dwMouSprite2, ax
		mov	word ptr g_dwMouSprite2+2, dx
		mov	ax, 0Fh
		push	ax
		push	[bp+dwHeight]
		mov	ax, [bp+dwWidth]
		add	ax, g_wVideoFlag1
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_dwMouSprite3, ax
		mov	word ptr g_dwMouSprite3+2, dx
		mov	ax, offset aSdmain_0 ; "sdmain"
		push	ax
		call	far ptr	j__Load2DShape_1
		add	sp, 2
		mov	word ptr [bp+pSdmain1],	ax
		mov	word ptr [bp+pSdmain1+2], dx
		push	word ptr g_dwMouSprite+2
		push	word ptr g_dwMouSprite
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		mov	ax, offset aSmou_0 ; "smou"
		push	ax
		push	word ptr [bp+pSdmain1+2]
		push	word ptr [bp+pSdmain1]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_5310
		add	sp, 8
		push	word ptr g_dwMouSprite2+2
		push	word ptr g_dwMouSprite2
		call	SetSprite1
		add	sp, 4
		sub	ax, ax
		push	ax
		push	ax
		mov	ax, offset aMmou ; "mmou"
		push	ax
		push	word ptr [bp+pSdmain1+2]
		push	word ptr [bp+pSdmain1]
		call	LocateShape
		add	sp, 6
		push	dx
		push	ax
		call	sub_1EA2_5310
		add	sp, 8
		push	word ptr [bp+pSdmain1+2]
		push	word ptr [bp+pSdmain1]
		call	UnloadResource
		add	sp, 4
		call	SetSprite2As1_2
		pop	si
		mov	sp, bp
		pop	bp
		retf
LoadPalAndCurso	endp


; =============== S U B	R O U T	I N E =======================================


Get0		proc far		; CODE XREF: SetupIntro+509P
					; RunGame+725P
		sub	ax, ax
		retf
Get0		endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

AllocResBytes	proc far		; CODE XREF: _main+102P _main+3ADP ...

p_pcResName	= word ptr  6
p_dwBytes	= dword	ptr  8

		push	bp
		mov	bp, sp
		mov	ax, 10h
		cwd
		push	dx
		push	ax
		push	word ptr [bp+p_dwBytes+2]
		push	word ptr [bp+p_dwBytes]
		call	__aFldiv
		inc	ax
		push	ax
		push	[bp+p_pcResName]
		call	AllocResPages
		add	sp, 4
		pop	bp
		retf
AllocResBytes	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================


GetResDiffScale	proc far		; CODE XREF: LoadGame3dShpes+15P
					; SetupCarGameEtc+275P	...
		call	GetResDiff
		sub	dx, dx
		mov	cl, 4

loc_29E1_67D:				; CODE XREF: GetResDiffScale+Fj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_29E1_67D
		retf
GetResDiffScale	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ResourceSizeCha	proc far		; CODE XREF: LoadCarShapes+23AP

arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetResourceSize
		add	sp, 4
		sub	dx, dx
		mov	cl, 4

loc_29E1_69B:				; CODE XREF: ResourceSizeCha+1Bj
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jnz	short loc_29E1_69B
		pop	bp
		retf
ResourceSizeCha	endp

seg031		ends

; ===========================================================================

; Segment type:	Pure code
seg032		segment	byte public 'CODE' use16
		assume cs:seg032
		;org 5
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ReadLine	proc far		; CODE XREF: DoReadline+3BP

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= byte ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch
arg_8		= word ptr  0Eh
arg_A		= word ptr  10h
arg_C		= word ptr  12h
arg_E		= dword	ptr  14h
arg_12		= word ptr  18h
arg_14		= word ptr  1Ah

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	si
		call	SetSprite2As1
		mov	ax, [bp+arg_A]
		mov	g_wReadline4, ax
		mov	ax, [bp+arg_C]
		mov	g_wReadline5, ax
		mov	ax, [bp+arg_2]
		mov	g_wReadline2, ax
		mov	ax, [bp+arg_8]
		mov	g_wReadline6, ax
		mov	bx, [bp+arg_6]
		mov	si, [bp+arg_2]
		mov	byte ptr [bx+si], 0
		test	[bp+arg_0], 1
		jz	short loc_2A4B_3E
		mov	bx, si
		mov	byte ptr [bx], 0

loc_2A4B_3E:				; CODE XREF: ReadLine+31j
		test	[bp+arg_0], 2
		jz	short loc_2A4B_4C
		mov	g_wReadline3, 0
		jmp	short loc_2A4B_5A
; ---------------------------------------------------------------------------

loc_2A4B_4C:				; CODE XREF: ReadLine+3Cj
		push	[bp+arg_2]
		call	_strlen
		add	sp, 2
		mov	g_wReadline3, ax

loc_2A4B_5A:				; CODE XREF: ReadLine+44j
		push	[bp+arg_2]
		call	_strlen
		add	sp, 2
		mov	[bp+var_6], ax
		jmp	short loc_2A4B_76
; ---------------------------------------------------------------------------

loc_2A4B_6A:				; CODE XREF: ReadLine+76j
		mov	bx, [bp+var_6]
		inc	[bp+var_6]
		mov	si, [bp+arg_2]
		mov	byte ptr [bx+si], 20h ;	' '

loc_2A4B_76:				; CODE XREF: ReadLine+62j
		mov	ax, [bp+arg_6]
		cmp	[bp+var_6], ax
		jl	short loc_2A4B_6A
		push	cs
		call	near ptr ReadlineHelper2
		mov	g_wReadline7, 1
		mov	g_wReadline, 1
		mov	[bp+var_A], 0
		push	cs
		call	near ptr ReadlineHelper
		push	[bp+arg_14]
		push	[bp+arg_12]
		call	CopyTimerCounte
		add	sp, 4
		mov	ax, 4
		cwd
		push	dx
		push	ax
		call	SetAddValue
		add	sp, 4
		mov	[bp+var_2], 1

loc_2A4B_B8:				; CODE XREF: ReadLine+122j
					; ReadLine+12Bj ...
		cmp	[bp+arg_4], 0
		jz	short loc_2A4B_CF
		mov	ax, [bp+arg_4]
		mov	[bp+var_8], ax
		mov	[bp+arg_4], 0
		jmp	short loc_2A4B_E9
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_CC:				; CODE XREF: ReadLine+DCj
		call	[bp+arg_E]

loc_2A4B_CF:				; CODE XREF: ReadLine+B6j
		call	CallReadCharCB
		mov	[bp+var_8], ax
		or	ax, ax
		jnz	short loc_2A4B_E9
		call	GetValueIf
		or	ax, ax
		jz	short loc_2A4B_CC
		mov	[bp+var_8], 0

loc_2A4B_E9:				; CODE XREF: ReadLine+C3j ReadLine+D3j
		cmp	[bp+var_8], 0
		jnz	short loc_2A4B_140
		mov	ax, 4
		cwd
		push	dx
		push	ax
		call	SetAddValue
		add	sp, 4
		mov	ax, g_wReadline
		mov	[bp+var_4], ax
		mov	g_wReadline, 1
		push	cs
		call	near ptr ReadlineHelper
		cmp	[bp+var_4], 0
		jz	short loc_2A4B_11C
		mov	g_wReadline, 0
		jmp	short loc_2A4B_122
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_11C:				; CODE XREF: ReadLine+10Bj
		mov	g_wReadline, 1

loc_2A4B_122:				; CODE XREF: ReadLine+113j
		mov	ax, [bp+arg_12]
		or	ax, [bp+arg_14]
		jz	short loc_2A4B_B8
		call	CompareDXTimerC
		or	ax, ax
		jz	short loc_2A4B_B8

loc_2A4B_133:				; CODE XREF: ReadLine+14Cj
					; ReadLine+152j ...
		push	cs
		call	near ptr ReadlineHelper
		mov	ax, [bp+var_8]
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_140:				; CODE XREF: ReadLine+E7j
		push	[bp+arg_14]
		push	[bp+arg_12]
		call	CopyTimerCounte
		add	sp, 4
		cmp	[bp+var_8], 0Dh
		jz	short loc_2A4B_133
		cmp	[bp+var_8], 1Bh
		jz	short loc_2A4B_133
		cmp	[bp+var_8], 4800h
		jz	short loc_2A4B_133
		cmp	[bp+var_8], 5000h
		jnz	short loc_2A4B_16E
		test	[bp+arg_0], 8
		jz	short loc_2A4B_133

loc_2A4B_16E:				; CODE XREF: ReadLine+160j
		cmp	[bp+var_8], 9
		jnz	short loc_2A4B_17A
		test	[bp+arg_0], 10h
		jz	short loc_2A4B_133

loc_2A4B_17A:				; CODE XREF: ReadLine+16Cj
		cmp	[bp+var_8], 4D00h
		jnz	short loc_2A4B_198

loc_2A4B_181:
		push	cs
		call	near ptr ReadlineHelper
		mov	ax, g_wReadline3
		cmp	[bp+arg_6], ax
		jg	short loc_2A4B_190
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------

loc_2A4B_190:				; CODE XREF: ReadLine+185j
		inc	g_wReadline3
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_198:				; CODE XREF: ReadLine+179j
		cmp	[bp+var_8], 4B00h
		jnz	short loc_2A4B_1B4
		push	cs
		call	near ptr ReadlineHelper
		cmp	g_wReadline3, 0
		jnz	short loc_2A4B_1AD
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------

loc_2A4B_1AD:				; CODE XREF: ReadLine+1A2j
		dec	g_wReadline3
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------

loc_2A4B_1B4:				; CODE XREF: ReadLine+197j
		cmp	[bp+var_8], 4700h
		jnz	short loc_2A4B_1C8
		push	cs
		call	near ptr ReadlineHelper
		mov	g_wReadline3, 0
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------

loc_2A4B_1C8:				; CODE XREF: ReadLine+1B3j
		cmp	[bp+var_8], 4F00h
		jnz	short loc_2A4B_1E4
		push	cs
		call	near ptr ReadlineHelper
		push	[bp+arg_2]
		call	_strlen
		add	sp, 2
		mov	g_wReadline3, ax
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------

loc_2A4B_1E4:				; CODE XREF: ReadLine+1C7j
		cmp	[bp+var_8], 5200h
		jnz	short loc_2A4B_212
		push	cs
		call	near ptr ReadlineHelper
		cmp	[bp+var_A], 0
		jnz	short loc_2A4B_204
		mov	[bp+var_A], 1
		mov	g_wReadline7, 8
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_204:				; CODE XREF: ReadLine+1EDj
		mov	[bp+var_A], 0
		mov	g_wReadline7, 1
		jmp	loc_2A4B_339
; ---------------------------------------------------------------------------

loc_2A4B_212:				; CODE XREF: ReadLine+1E3j
		cmp	[bp+var_8], 5300h
		jnz	short loc_2A4B_260
		mov	ax, g_wReadline3
		cmp	[bp+arg_6], ax
		jg	short loc_2A4B_224
		jmp	loc_2A4B_33D
; ---------------------------------------------------------------------------

loc_2A4B_224:				; CODE XREF: ReadLine+219j
		mov	bx, [bp+arg_2]
		mov	si, ax
		cmp	byte ptr [bx+si], 0
		jnz	short loc_2A4B_231
		jmp	loc_2A4B_33D
; ---------------------------------------------------------------------------

loc_2A4B_231:				; CODE XREF: ReadLine+226j
		push	cs
		call	near ptr ReadlineHelper
		mov	ax, g_wReadline3
		mov	[bp+var_6], ax
		jmp	short loc_2A4B_24C
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_23E:				; CODE XREF: ReadLine+24Cj
		mov	si, [bp+var_6]
		add	si, [bp+arg_2]
		mov	al, [si+1]
		mov	[si], al
		inc	[bp+var_6]

loc_2A4B_24C:				; CODE XREF: ReadLine+235j
		mov	ax, [bp+arg_6]
		cmp	[bp+var_6], ax
		jl	short loc_2A4B_23E

loc_2A4B_254:				; CODE XREF: ReadLine+290j
		mov	si, ax
		mov	bx, [bp+arg_2]
		mov	byte ptr [bx+si-1], 20h	; ' '
		jmp	loc_2A4B_335
; ---------------------------------------------------------------------------

loc_2A4B_260:				; CODE XREF: ReadLine+211j
		cmp	[bp+var_8], 8
		jnz	short loc_2A4B_298
		cmp	g_wReadline3, 0
		jnz	short loc_2A4B_270
		jmp	loc_2A4B_33D
; ---------------------------------------------------------------------------

loc_2A4B_270:				; CODE XREF: ReadLine+265j
		push	cs
		call	near ptr ReadlineHelper
		dec	g_wReadline3
		mov	ax, g_wReadline3
		mov	[bp+var_6], ax
		jmp	short loc_2A4B_28E
; ---------------------------------------------------------------------------

loc_2A4B_280:				; CODE XREF: ReadLine+28Ej
		mov	si, [bp+var_6]
		add	si, [bp+arg_2]
		mov	al, [si+1]
		mov	[si], al
		inc	[bp+var_6]

loc_2A4B_28E:				; CODE XREF: ReadLine+278j
		mov	ax, [bp+arg_6]
		cmp	[bp+var_6], ax
		jl	short loc_2A4B_280
		jmp	short loc_2A4B_254
; ---------------------------------------------------------------------------

loc_2A4B_298:				; CODE XREF: ReadLine+25Ej
		cmp	[bp+var_8], 20h	; ' '
		jge	short loc_2A4B_2A1
		jmp	loc_2A4B_33D
; ---------------------------------------------------------------------------

loc_2A4B_2A1:				; CODE XREF: ReadLine+296j
		cmp	[bp+var_8], 7Ah	; 'z'
		jle	short loc_2A4B_2AA
		jmp	loc_2A4B_33D
; ---------------------------------------------------------------------------

loc_2A4B_2AA:				; CODE XREF: ReadLine+29Fj
		mov	ax, g_wReadline3
		cmp	[bp+arg_6], ax
		jg	short loc_2A4B_2B5
		jmp	loc_2A4B_33D
; ---------------------------------------------------------------------------

loc_2A4B_2B5:				; CODE XREF: ReadLine+2AAj
		push	cs
		call	near ptr ReadlineHelper
		cmp	[bp+var_2], 0
		jz	short loc_2A4B_2E6
		test	[bp+arg_0], 4
		jnz	short loc_2A4B_2E6
		mov	g_wReadline3, 0
		mov	[bp+var_6], 0
		jmp	short loc_2A4B_2DE
; ---------------------------------------------------------------------------

loc_2A4B_2D2:				; CODE XREF: ReadLine+2DEj
		mov	bx, [bp+var_6]
		mov	si, [bp+arg_2]
		mov	byte ptr [bx+si], 20h ;	' '
		inc	[bp+var_6]

loc_2A4B_2DE:				; CODE XREF: ReadLine+2CAj
		mov	ax, [bp+arg_6]
		cmp	[bp+var_6], ax
		jl	short loc_2A4B_2D2

loc_2A4B_2E6:				; CODE XREF: ReadLine+2B7j
					; ReadLine+2BDj
		mov	si, [bp+arg_2]
		add	si, g_wReadline3
		cmp	byte ptr [si], 0
		jnz	short loc_2A4B_2F6
		mov	byte ptr [si+1], 0

loc_2A4B_2F6:				; CODE XREF: ReadLine+2EAj
		cmp	[bp+var_A], 0
		jz	short loc_2A4B_31E
		mov	ax, [bp+arg_6]
		sub	ax, 2
		mov	[bp+var_6], ax
		jmp	short loc_2A4B_316
; ---------------------------------------------------------------------------
		align 2

loc_2A4B_308:				; CODE XREF: ReadLine+316j
		mov	si, [bp+var_6]
		add	si, [bp+arg_2]
		mov	al, [si]
		mov	[si+1],	al
		dec	[bp+var_6]

loc_2A4B_316:				; CODE XREF: ReadLine+2FFj
		mov	ax, g_wReadline3
		cmp	[bp+var_6], ax
		jge	short loc_2A4B_308

loc_2A4B_31E:				; CODE XREF: ReadLine+2F4j
		mov	bx, [bp+arg_2]
		mov	si, g_wReadline3
		mov	al, byte ptr [bp+var_8]
		mov	[bx+si], al
		mov	ax, si
		cmp	[bp+arg_6], ax
		jle	short loc_2A4B_335
		inc	g_wReadline3

loc_2A4B_335:				; CODE XREF: ReadLine+257j
					; ReadLine+329j
		push	cs
		call	near ptr ReadlineHelper2

loc_2A4B_339:				; CODE XREF: ReadLine+187j
					; ReadLine+18Ej ...
		push	cs
		call	near ptr ReadlineHelper

loc_2A4B_33D:				; CODE XREF: ReadLine+21Bj
					; ReadLine+228j ...
		mov	[bp+var_2], 0
		jmp	loc_2A4B_B8
ReadLine	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ReadlineHelper	proc far		; CODE XREF: ReadLine+8Ep
					; ReadLine+104p ...

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 6
		cmp	g_wReadline, 0
		jnz	short loc_2A4B_356
		jmp	loc_2A4B_3E1
; ---------------------------------------------------------------------------

loc_2A4B_356:				; CODE XREF: ReadlineHelper+Bj
		push	g_wReadline2
		call	_strlen
		add	sp, 2
		cmp	ax, g_wReadline3
		jge	short loc_2A4B_377
		push	g_wReadline2
		call	_strlen
		add	sp, 2
		mov	g_wReadline3, ax

loc_2A4B_377:				; CODE XREF: ReadlineHelper+20j
		mov	ax, 1
		push	ax
		mov	ax, g_wReadline3

loc_2A4B_37E:
		add	ax, g_wReadline2
		push	ax
		call	WrapStrWidth
		add	sp, 4
		mov	[bp+var_2], ax
		or	ax, ax
		jnz	short loc_2A4B_3A1
		mov	ax, offset asc_2B77_53CA ; " "
		push	ax
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_2], ax

loc_2A4B_3A1:				; CODE XREF: ReadlineHelper+4Aj
		push	g_wReadline3
		push	g_wReadline2
		call	WrapStrWidth
		add	sp, 4
		add	ax, g_wReadline4
		mov	[bp+var_4], ax
		les	bx, dword ptr unk_2B77_4E8E
		mov	ax, es:[bx+12h]
		add	ax, g_wReadline5
		sub	ax, g_wReadline7
		mov	[bp+var_6], ax
		push	word ptr es:[bx]
		push	g_wReadline7
		push	[bp+var_2]
		push	ax
		push	[bp+var_4]
		call	Sprite1Op
		add	sp, 0Ah

loc_2A4B_3E1:				; CODE XREF: ReadlineHelper+Dj
		mov	sp, bp
		pop	bp
		retf
ReadlineHelper	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

ReadlineHelper2	proc far		; CODE XREF: ReadLine+79p
					; ReadLine+330p

var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2

		push	bp
		mov	bp, sp
		sub	sp, 6
		push	si
		cmp	g_wReadline6, 0
		jz	short loc_2A4B_42E
		jmp	short loc_2A4B_41C
; ---------------------------------------------------------------------------

loc_2A4B_3F6:				; CODE XREF: ReadlineHelper2+46j
		push	g_wReadline2
		call	_strlen
		add	sp, 2
		or	ax, ax
		jz	short loc_2A4B_42E
		push	g_wReadline2
		call	_strlen
		add	sp, 2
		mov	si, ax
		mov	bx, g_wReadline2
		mov	byte ptr [bx+si-1], 0

loc_2A4B_41C:				; CODE XREF: ReadlineHelper2+Ej
		push	g_wReadline2
		call	MaybeGetStrWidt
		add	sp, 2
		cmp	ax, g_wReadline6
		jg	short loc_2A4B_3F6

loc_2A4B_42E:				; CODE XREF: ReadlineHelper2+Cj
					; ReadlineHelper2+1Ej
		push	g_wReadline2
		call	_strlen
		add	sp, 2
		mov	[bp+var_2], ax
		mov	ax, g_wReadline3
		cmp	[bp+var_2], ax
		jge	short loc_2A4B_44B
		mov	ax, [bp+var_2]
		mov	g_wReadline3, ax

loc_2A4B_44B:				; CODE XREF: ReadlineHelper2+5Dj
		push	g_wReadline5
		push	g_wReadline4
		push	g_wReadline2
		call	FontSpriteOp
		add	sp, 6
		cmp	g_wReadline6, 0
		jz	short loc_2A4B_4A3
		push	g_wReadline2
		call	MaybeGetStrWidt
		add	sp, 2
		mov	[bp+var_6], ax
		mov	ax, g_wReadline6
		sub	ax, [bp+var_6]
		mov	[bp+var_4], ax
		or	ax, ax
		jle	short loc_2A4B_4A3
		les	bx, dword ptr unk_2B77_4E8E
		push	word ptr es:[bx+2]
		push	word ptr es:[bx+12h]
		push	ax
		push	g_wReadline5
		mov	ax, [bp+var_6]
		add	ax, g_wReadline4
		push	ax
		call	SpriteSizeOp
		add	sp, 0Ah

loc_2A4B_4A3:				; CODE XREF: ReadlineHelper2+7Ej
					; ReadlineHelper2+9Aj
		pop	si
		mov	sp, bp
		pop	bp
		retf
ReadlineHelper2	endp

seg032		ends

; ===========================================================================

; Segment type:	Pure code
seg033		segment	byte public 'CODE' use16
		assume cs:seg033
		;org 8
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


SetupMcgaWnd1	proc far		; CODE XREF: SetupIntro+416P
					; SetupIntro+533P ...
		mov	ax, word ptr g_pMcgaSprite
		or	ax, word ptr g_pMcgaSprite+2
		jnz	short loc_2A95_2C ; dont create	if it already exists
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pMcgaSprite,	ax
		mov	word ptr g_pMcgaSprite+2, dx

loc_2A95_2C:				; CODE XREF: SetupMcgaWnd1+7j
		mov	ax, offset g_pSprite2
		mov	dx, seg	seg012
		push	dx
		push	ax
		call	SetSprite1
		add	sp, 4
		les	bx, g_pMcgaSprite
		push	word ptr es:[bx+2]
		push	word ptr es:[bx]
		call	PutImageMaybe
		add	sp, 4
		retf
SetupMcgaWnd1	endp


; =============== S U B	R O U T	I N E =======================================


SetupMcgaWnd2	proc far		; CODE XREF: RunCarMenu+2ADP
					; RunOpponentMenu:loc_0_2A48P ...
		mov	ax, word ptr g_pMcgaSprite
		or	ax, word ptr g_pMcgaSprite+2
		jnz	short loc_2A95_74
		mov	ax, 0Fh
		push	ax
		mov	ax, 0C8h	; 200
		push	ax
		mov	ax, 140h	; 320
		push	ax
		call	MakeWndSprite
		add	sp, 6
		mov	word ptr g_pMcgaSprite,	ax
		mov	word ptr g_pMcgaSprite+2, dx

loc_2A95_74:				; CODE XREF: SetupMcgaWnd2+7j
		push	word ptr g_pMcgaSprite+2
		push	word ptr g_pMcgaSprite
		call	SetSprite1
		add	sp, 4
		retf
SetupMcgaWnd2	endp

seg033		ends

; ===========================================================================

; Segment type:	Pure code
seg034		segment	byte public 'CODE' use16
		assume cs:seg034
		;org 5
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_Load2DShape_1	proc far		; CODE XREF: j__Load2DShape_1J

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		mov	ax, 1
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr Load2DShape
		add	sp, 4
		pop	bp
		retf
_Load2DShape_1	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_Load2DShape_0	proc far		; CODE XREF: DoLoad2DShape_0J

arg_0		= word ptr  6

		push	bp
		mov	bp, sp
		sub	ax, ax
		push	ax
		push	[bp+arg_0]
		push	cs
		call	near ptr Load2DShape
		add	sp, 4
		pop	bp
		retf
_Load2DShape_0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Load2DShape	proc far		; CODE XREF: j_Load2DShapeJ
					; _Load2DShape_1+Bp ...

var_80		= byte ptr -80h
var_7E		= word ptr -7Eh
var_7C		= byte ptr -7Ch
var_18		= word ptr -18h
var_16		= word ptr -16h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= word ptr -0Ch
var_A		= byte ptr -0Ah
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 80h
		push	si
		push	[bp+arg_0]
		lea	ax, [bp+var_7C]
		push	ax
		call	_strcpy
		add	sp, 4
		lea	ax, [bp+var_7C]
		mov	[bp+var_C], ax
		jmp	short loc_2A9D_55
; ---------------------------------------------------------------------------
		align 2

loc_2A9D_4C:				; CODE XREF: Load2DShape+33j
		cmp	[bp+var_80], 2Eh ; '.'
		jz	short loc_2A9D_61
		inc	[bp+var_C]

loc_2A9D_55:				; CODE XREF: Load2DShape+1Dj
		mov	bx, [bp+var_C]
		mov	al, [bx]
		mov	[bp+var_80], al
		or	al, al
		jnz	short loc_2A9D_4C

loc_2A9D_61:				; CODE XREF: Load2DShape+24j
		mov	bx, [bp+var_C]
		cmp	byte ptr [bx], 0
		jnz	short loc_2A9D_C2
		mov	[bp+var_14], 0
		jmp	short loc_2A9D_83
; ---------------------------------------------------------------------------

loc_2A9D_70:				; CODE XREF: Load2DShape+89j
		lea	ax, [bp+var_7C]
		push	ax
		call	FindFileName
		add	sp, 2
		or	ax, ax
		jnz	short loc_2A9D_D8
		inc	[bp+var_14]

loc_2A9D_83:				; CODE XREF: Load2DShape+42j
		mov	bx, [bp+var_14]
		shl	bx, 1
		mov	si, word ptr unk_2B77_5466[bx]
		cmp	byte ptr [si], 0
		jz	short loc_2A9D_D8
		mov	ax, [bp+var_C]
		mov	[bp+var_12], ax
		push	si
		push	ax
		call	_strcpy
		add	sp, 4
		lea	ax, [bp+var_7C]
		push	ax
		call	GetResSomething
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	dx, ax
		jz	short loc_2A9D_70

loc_2A9D_B7:				; CODE XREF: Load2DShape+AAj
					; Load2DShape+E6j ...
		mov	ax, [bp+var_4]
		mov	dx, [bp+var_2]
		pop	si
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------

loc_2A9D_C2:				; CODE XREF: Load2DShape+3Bj
		lea	ax, [bp+var_7C]
		push	ax
		call	GetResSomething
		add	sp, 2
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	dx, ax
		jnz	short loc_2A9D_B7

loc_2A9D_D8:				; CODE XREF: Load2DShape+52j
					; Load2DShape+63j
		push	[bp+var_C]
		lea	ax, [bp+var_A]
		push	ax
		call	_strcpy
		add	sp, 4
		mov	ax, offset a_pvs_0 ; ".PVS"
		push	ax
		lea	ax, [bp+var_A]
		push	ax
		call	_stricmp
		add	sp, 4
		or	ax, ax
		jnz	short loc_2A9D_154
		push	[bp+arg_2]
		lea	ax, [bp+var_7C]
		push	ax
		call	LoadPvs
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_2A9D_B7
		push	dx
		push	[bp+var_4]
		call	GetUnflipSize
		add	sp, 4
		push	ax
		mov	ax, offset aUnflip ; "UNFLIP"
		push	ax
		call	AllocResPages
		add	sp, 4
		mov	word ptr [bp+var_10], ax
		mov	word ptr [bp+var_10+2],	dx
		push	dx
		push	ax
		push	[bp+var_2]
		push	[bp+var_4]
		call	sub_1EA2_40C2
		add	sp, 8
		push	word ptr [bp+var_10+2]
		push	word ptr [bp+var_10]
		call	SetResField10To0
		add	sp, 4
		jmp	loc_2A9D_B7
; ---------------------------------------------------------------------------

loc_2A9D_154:				; CODE XREF: Load2DShape+CDj
		mov	ax, offset a_xvs_0 ; ".XVS"
		push	ax
		lea	ax, [bp+var_A]
		push	ax
		call	_stricmp
		add	sp, 4
		or	ax, ax
		jnz	short loc_2A9D_180
		push	[bp+arg_2]
		lea	ax, [bp+var_7C]
		push	ax
		call	LoadPvs

loc_2A9D_174:				; CODE XREF: Load2DShape+260j
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		jmp	loc_2A9D_B7
; ---------------------------------------------------------------------------

loc_2A9D_180:				; CODE XREF: Load2DShape+13Aj
		mov	ax, offset a_pes_0 ; ".PES"
		push	ax
		lea	ax, [bp+var_A]
		push	ax
		call	_stricmp
		add	sp, 4
		or	ax, ax
		jz	short loc_2A9D_197
		jmp	loc_2A9D_24C
; ---------------------------------------------------------------------------

loc_2A9D_197:				; CODE XREF: Load2DShape+166j
		push	[bp+arg_2]
		lea	ax, [bp+var_7C]
		push	ax
		call	LoadPvs
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_2A9D_1B3
		jmp	loc_2A9D_B7
; ---------------------------------------------------------------------------

loc_2A9D_1B3:				; CODE XREF: Load2DShape+182j
		mov	ax, 3E8h
		push	ax
		mov	ax, offset aUnflip_0 ; "UNFLIP"
		push	ax
		call	AllocResPages
		add	sp, 4
		mov	word ptr [bp+var_10], ax
		mov	word ptr [bp+var_10+2],	dx
		push	dx
		push	ax
		push	[bp+var_2]
		push	[bp+var_4]
		call	sub_1EA2_76D6
		add	sp, 8
		push	word ptr [bp+var_10+2]
		push	word ptr [bp+var_10]
		call	SetResField10To0
		add	sp, 4

loc_2A9D_1E7:				; CODE XREF: Load2DShape+24Dj
		push	[bp+var_2]
		push	[bp+var_4]
		call	sub_2B12_A
		add	sp, 4
		mov	[bp+var_7E], ax
		mov	ax, offset aMga	; "!MGA"
		push	ax
		push	[bp+var_2]
		push	[bp+var_4]
		call	LocateShape0
		add	sp, 6
		mov	[bp+var_18], ax
		mov	[bp+var_16], dx
		or	ax, dx
		jz	short loc_2A9D_223
		mov	ax, [bp+var_18]
		add	ax, 10h
		push	dx
		push	ax
		push	cs
		call	near ptr sub_2A9D_2E0
		add	sp, 4

loc_2A9D_223:				; CODE XREF: Load2DShape+1E6j
		push	[bp+var_7E]
		lea	ax, [bp+var_7C]
		push	ax
		call	AllocResPages
		add	sp, 4
		mov	word ptr [bp+var_10], ax
		mov	word ptr [bp+var_10+2],	dx
		les	bx, [bp+var_10]
		mov	ax, [bp+var_7E]
		sub	dx, dx
		mov	cl, 4

loc_2A9D_242:				; CODE XREF: Load2DShape+21Ej
		shl	ax, 1
		rcl	dx, 1
		dec	cl
		jz	short loc_2A9D_290
		jmp	short loc_2A9D_242
; ---------------------------------------------------------------------------

loc_2A9D_24C:				; CODE XREF: Load2DShape+168j
		mov	ax, offset a_esh_0 ; ".ESH"
		push	ax
		lea	ax, [bp+var_A]
		push	ax
		call	_stricmp
		add	sp, 4
		or	ax, ax
		jnz	short loc_2A9D_280
		push	[bp+arg_2]
		lea	ax, [bp+var_7C]
		push	ax
		call	LoadRes01Alt
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jz	short loc_2A9D_27C
		jmp	loc_2A9D_1E7
; ---------------------------------------------------------------------------

loc_2A9D_27C:				; CODE XREF: Load2DShape+24Bj
		jmp	loc_2A9D_B7
; ---------------------------------------------------------------------------
		align 2

loc_2A9D_280:				; CODE XREF: Load2DShape+232j
		push	[bp+arg_2]
		lea	ax, [bp+var_7C]
		push	ax
		call	LoadRes01Alt
		jmp	loc_2A9D_174
; ---------------------------------------------------------------------------
		align 2

loc_2A9D_290:				; CODE XREF: Load2DShape+21Cj
		mov	es:[bx], ax
		mov	es:[bx+2], dx
		push	word ptr [bp+var_10+2]
		push	word ptr [bp+var_10]
		push	[bp+var_2]
		push	[bp+var_4]
		call	sub_1EA2_7582
		add	sp, 8
		push	[bp+var_2]
		push	[bp+var_4]
		call	SetResField10To0
		add	sp, 4
		push	word ptr [bp+var_10+2]
		push	word ptr [bp+var_10]
		call	ResourceOp
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		mov	ax, offset g_arrShapeNums
		push	ax
		push	dx
		push	[bp+var_4]
		call	sub_1EA2_7528
		add	sp, 6
		jmp	loc_2A9D_B7
Load2DShape	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2A9D_2E0	proc far		; CODE XREF: Load2DShape+1F1p

var_2		= word ptr -2
arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 2
		push	si
		mov	[bp+var_2], 0

loc_2A9D_2EC:				; CODE XREF: sub_2A9D_2E0+20j
		mov	bx, [bp+var_2]
		les	si, [bp+arg_0]
		mov	al, es:[bx+si]
		mov	g_arrShapeNums[bx], al
		inc	[bp+var_2]
		cmp	[bp+var_2], 10h
		jl	short loc_2A9D_2EC
		pop	si
		mov	sp, bp
		pop	bp
		retf
sub_2A9D_2E0	endp

seg034		ends

; ===========================================================================

; Segment type:	Pure code
seg035		segment	byte public 'CODE' use16
		assume cs:seg035
		;org 7
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
		align 2

loc_2ACD_8:				; CODE XREF: sub_1EA2_4E28J
		push	bp
		mov	bp, sp
		mov	ax, 1
		push	ax
		push	word ptr [bp+6]
		push	cs
		call	near ptr Load2DShapeRes
		add	sp, 4
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_2ACD_1C:				; CODE XREF: AltLoad2dShapeRJ
		push	bp
		mov	bp, sp
		sub	ax, ax
		push	ax
		push	word ptr [bp+6]
		push	cs
		call	near ptr Load2DShapeRes
		add	sp, 4
		pop	bp
		retf

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Load2DShapeRes	proc far		; CODE XREF: j_Load2DShapeResJ
					; seg035:0013p	...

var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= word ptr -4
var_2		= word ptr -2
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ah
		push	[bp+arg_0]
		call	LastColonSlash
		add	sp, 2
		push	ax
		call	GetResSomething
		add	sp, 2
		mov	[bp+var_8], ax
		mov	[bp+var_6], dx
		or	ax, dx
		jz	short loc_2ACD_5A
		mov	ax, [bp+var_8]
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_2ACD_5A:				; CODE XREF: Load2DShapeRes+22j
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	Load2DShape
		add	sp, 4
		mov	[bp+var_4], ax
		mov	[bp+var_2], dx
		or	ax, dx
		jnz	short loc_2ACD_7A
		mov	ax, [bp+var_4]
		mov	sp, bp
		pop	bp
		retf
; ---------------------------------------------------------------------------
		align 2

loc_2ACD_7A:				; CODE XREF: Load2DShapeRes+42j
		push	[bp+var_2]
		push	[bp+var_4]
		call	GetResourceSize
		add	sp, 4
		mov	[bp+var_A], ax
		push	ax
		push	[bp+arg_0]
		call	AllocResPages
		add	sp, 4
		mov	[bp+var_8], ax
		mov	[bp+var_6], dx
		push	dx
		push	ax
		push	[bp+var_2]
		push	[bp+var_4]
		push	cs
		call	near ptr Maybe2dShParse
		add	sp, 8
		push	[bp+var_2]
		push	[bp+var_4]
		call	SetResField10To0
		add	sp, 4
		push	[bp+var_6]
		push	[bp+var_8]
		call	ResourceOp
		add	sp, 4
		mov	sp, bp
		pop	bp
		retf
Load2DShapeRes	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

Maybe2dShParse	proc far		; CODE XREF: j_Maybe2dShParseJ
					; Load2DShapeRes+78p

var_38		= dword	ptr -38h
var_34		= word ptr -34h
var_32		= word ptr -32h
var_30		= word ptr -30h
var_2E		= dword	ptr -2Eh
var_2A		= word ptr -2Ah
var_28		= word ptr -28h
var_26		= word ptr -26h
var_24		= word ptr -24h
var_1E		= word ptr -1Eh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= word ptr -0Eh
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8
arg_4		= word ptr  0Ah
arg_6		= word ptr  0Ch

		push	bp
		mov	bp, sp
		sub	sp, 38h
		push	di
		push	si
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4FromArg
		add	sp, 4
		mov	[bp+var_28], ax
		shl	ax, 1
		shl	ax, 1
		add	ax, [bp+arg_4]
		mov	dx, [bp+arg_6]
		add	ax, 6
		mov	word ptr [bp+var_18], ax
		mov	word ptr [bp+var_18+2],	dx
		mov	ax, [bp+arg_4]
		mov	word ptr [bp+var_1C], ax
		mov	word ptr [bp+var_1C+2],	dx
		mov	ax, [bp+arg_0]
		mov	dx, [bp+arg_2]
		mov	word ptr [bp+var_38], ax
		mov	word ptr [bp+var_38+2],	dx
		mov	[bp+var_2A], 0
		jmp	short loc_2ACD_129
; ---------------------------------------------------------------------------

loc_2ACD_114:				; CODE XREF: Maybe2dShParse+6Aj
		les	bx, [bp+var_38]
		inc	word ptr [bp+var_38]
		mov	al, es:[bx]
		les	bx, [bp+var_1C]
		inc	word ptr [bp+var_1C]
		mov	es:[bx], al
		inc	[bp+var_2A]

loc_2ACD_129:				; CODE XREF: Maybe2dShParse+46j
		mov	ax, [bp+var_28]
		shl	ax, 1
		shl	ax, 1
		add	ax, 6
		cmp	ax, [bp+var_2A]
		jg	short loc_2ACD_114
		mov	ax, [bp+var_28]
		mov	cl, 3
		shl	ax, cl
		add	ax, [bp+arg_4]
		mov	dx, [bp+arg_6]
		add	ax, 6
		mov	word ptr [bp+var_8], ax
		mov	word ptr [bp+var_8+2], dx
		mov	[bp+var_26], ax
		mov	[bp+var_24], dx
		mov	[bp+var_2A], 0
		jmp	loc_2ACD_28B
; ---------------------------------------------------------------------------

loc_2ACD_15C:				; CODE XREF: Maybe2dShParse+1AFj
		push	word ptr [bp+var_2E+2]
		push	word ptr [bp+var_2E]
		push	cs
		call	near ptr sub_2ACD_3BC
		add	sp, 4
		mov	[bp+var_10], ax
		cmp	ax, 3
		jg	short loc_2ACD_17C
		mov	ax, [bp+var_1E]
		cmp	[bp+var_E], ax
		jnb	short loc_2ACD_17C
		jmp	loc_2ACD_26F
; ---------------------------------------------------------------------------

loc_2ACD_17C:				; CODE XREF: Maybe2dShParse+A3j
					; Maybe2dShParse+ABj ...
		cmp	[bp+var_E], 7Fh	; ''
		jg	short loc_2ACD_1A4
		cmp	[bp+var_E], 0
		jz	short loc_2ACD_1F9
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	ax, [bp+var_E]
		neg	ax
		mov	es:[bx], al
		mov	ax, [bp+var_E]
		sub	[bp+var_1E], ax
		mov	[bp+var_30], 0
		jmp	short loc_2ACD_1F1
; ---------------------------------------------------------------------------
		align 2

loc_2ACD_1A4:				; CODE XREF: Maybe2dShParse+B4j
		sub	[bp+var_E], 7Fh	; ''
		sub	[bp+var_1E], 7Fh ; ''
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	byte ptr es:[bx], 81h ;	''
		mov	[bp+var_30], 0
		jmp	short loc_2ACD_1C1
; ---------------------------------------------------------------------------
		align 2

loc_2ACD_1BE:				; CODE XREF: Maybe2dShParse+10Dj
		inc	[bp+var_30]

loc_2ACD_1C1:				; CODE XREF: Maybe2dShParse+EFj
		cmp	[bp+var_30], 7Fh ; ''
		jge	short loc_2ACD_17C
		les	bx, [bp+var_4]
		inc	word ptr [bp+var_4]
		mov	al, es:[bx]
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	es:[bx], al
		jmp	short loc_2ACD_1BE
; ---------------------------------------------------------------------------
		align 2

loc_2ACD_1DC:				; CODE XREF: Maybe2dShParse+12Bj
		les	bx, [bp+var_4]
		inc	word ptr [bp+var_4]
		mov	al, es:[bx]
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	es:[bx], al
		inc	[bp+var_30]

loc_2ACD_1F1:				; CODE XREF: Maybe2dShParse+D5j
		mov	ax, [bp+var_E]
		cmp	[bp+var_30], ax
		jl	short loc_2ACD_1DC

loc_2ACD_1F9:				; CODE XREF: Maybe2dShParse+BAj
		mov	ax, [bp+var_1E]
		cmp	[bp+var_10], ax
		jbe	short loc_2ACD_22B
		mov	[bp+var_10], ax
		jmp	short loc_2ACD_22B
; ---------------------------------------------------------------------------

loc_2ACD_206:				; CODE XREF: Maybe2dShParse+163j
		sub	[bp+var_10], 7Fh ; ''
		sub	[bp+var_1E], 7Fh ; ''
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	byte ptr es:[bx], 7Fh ;	''
		les	bx, [bp+var_2E]
		mov	al, es:[bx]
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	es:[bx], al
		add	word ptr [bp+var_2E], 7Fh ; ''

loc_2ACD_22B:				; CODE XREF: Maybe2dShParse+133j
					; Maybe2dShParse+138j
		cmp	[bp+var_10], 7Fh ; ''
		jg	short loc_2ACD_206
		cmp	[bp+var_10], 3
		jle	short loc_2ACD_25E
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	al, byte ptr [bp+var_10]
		mov	es:[bx], al
		mov	ax, [bp+var_10]
		sub	[bp+var_1E], ax
		les	bx, [bp+var_2E]
		mov	al, es:[bx]
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	es:[bx], al
		mov	ax, [bp+var_10]
		add	word ptr [bp+var_2E], ax

loc_2ACD_25E:				; CODE XREF: Maybe2dShParse+169j
		mov	ax, word ptr [bp+var_2E]
		mov	dx, word ptr [bp+var_2E+2]
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		mov	[bp+var_E], 0

loc_2ACD_26F:				; CODE XREF: Maybe2dShParse+ADj
		inc	word ptr [bp+var_2E]
		inc	[bp+var_E]

loc_2ACD_275:				; CODE XREF: Maybe2dShParse+281j
		cmp	[bp+var_1E], 0
		jz	short loc_2ACD_27E
		jmp	loc_2ACD_15C
; ---------------------------------------------------------------------------

loc_2ACD_27E:				; CODE XREF: Maybe2dShParse+1ADj
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	byte ptr es:[bx], 0
		inc	[bp+var_2A]

loc_2ACD_28B:				; CODE XREF: Maybe2dShParse+8Dj
		mov	ax, [bp+var_28]
		cmp	[bp+var_2A], ax
		jl	short loc_2ACD_296
		jmp	loc_2ACD_350
; ---------------------------------------------------------------------------

loc_2ACD_296:				; CODE XREF: Maybe2dShParse+1C5j
		push	[bp+var_2A]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4Scaled
		add	sp, 6
		mov	word ptr [bp+var_C], ax
		mov	word ptr [bp+var_C+2], dx
		push	word ptr [bp+var_8+2]
		push	word ptr [bp+var_8]
		call	ShlALot
		add	sp, 4
		mov	[bp+var_14], ax
		mov	[bp+var_12], dx
		push	dx
		push	ax
		call	ShrALot
		add	sp, 4
		mov	word ptr [bp+var_8], ax
		mov	word ptr [bp+var_8+2], dx
		push	[bp+var_24]
		push	[bp+var_26]
		call	ShlALot
		add	sp, 4
		push	word ptr [bp+var_8+2]
		push	word ptr [bp+var_8]
		mov	si, ax
		mov	di, dx
		call	ShlALot
		add	sp, 4
		sub	ax, si
		sbb	dx, di
		les	bx, [bp+var_18]
		add	word ptr [bp+var_18], 4
		mov	es:[bx], ax
		mov	es:[bx+2], dx
		mov	ax, word ptr [bp+var_C]
		mov	dx, word ptr [bp+var_C+2]
		mov	word ptr [bp+var_2E], ax
		mov	word ptr [bp+var_2E+2],	dx
		mov	[bp+var_30], 0

loc_2ACD_314:				; CODE XREF: Maybe2dShParse+261j
		les	bx, [bp+var_2E]
		inc	word ptr [bp+var_2E]
		mov	al, es:[bx]
		les	bx, [bp+var_8]
		inc	word ptr [bp+var_8]
		mov	es:[bx], al
		inc	[bp+var_30]
		cmp	[bp+var_30], 10h
		jl	short loc_2ACD_314
		mov	ax, word ptr [bp+var_2E]
		mov	dx, word ptr [bp+var_2E+2]
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		mov	[bp+var_E], 0
		les	bx, [bp+var_C]
		mov	ax, es:[bx+2]
		imul	word ptr es:[bx]
		mov	[bp+var_1E], ax
		jmp	loc_2ACD_275
; ---------------------------------------------------------------------------

loc_2ACD_350:				; CODE XREF: Maybe2dShParse+1C7j
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	ShlALot
		add	sp, 4
		push	word ptr [bp+var_8+2]
		push	word ptr [bp+var_8]
		mov	si, ax
		mov	di, dx
		call	ShlALot
		add	sp, 4
		sub	ax, si
		sbb	dx, di
		mov	[bp+var_34], ax
		mov	[bp+var_32], dx
		test	byte ptr [bp+var_34], 0Fh
		jz	short loc_2ACD_398
		mov	cl, 4

loc_2ACD_382:				; CODE XREF: Maybe2dShParse+2BCj
		sar	dx, 1
		rcr	ax, 1
		dec	cl
		jnz	short loc_2ACD_382
		add	ax, 1
		adc	dx, 0
		mov	[bp+var_34], ax
		mov	[bp+var_32], dx
		jmp	short loc_2ACD_3A4
; ---------------------------------------------------------------------------

loc_2ACD_398:				; CODE XREF: Maybe2dShParse+2B2j
		mov	al, 4
		push	ax
		lea	ax, [bp+var_34]
		push	ax
		call	lib_Flshr

loc_2ACD_3A4:				; CODE XREF: Maybe2dShParse+2CAj
		push	[bp+var_34]
		push	[bp+arg_6]
		push	[bp+arg_4]
		call	ResizeMemory
		add	sp, 6
		pop	si
		pop	di
		mov	sp, bp
		pop	bp
		retf
Maybe2dShParse	endp

; ---------------------------------------------------------------------------
		align 2

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2ACD_3BC	proc far		; CODE XREF: Maybe2dShParse+97p

var_4		= byte ptr -4
var_2		= word ptr -2
arg_0		= dword	ptr  6

		push	bp
		mov	bp, sp
		sub	sp, 4
		les	bx, [bp+arg_0]
		mov	al, es:[bx]
		mov	[bp+var_4], al
		mov	[bp+var_2], 0
		jmp	short loc_2ACD_3D5
; ---------------------------------------------------------------------------

loc_2ACD_3D2:				; CODE XREF: sub_2ACD_3BC+25j
		inc	[bp+var_2]

loc_2ACD_3D5:				; CODE XREF: sub_2ACD_3BC+14j
		les	bx, [bp+arg_0]
		inc	word ptr [bp+arg_0]
		mov	al, [bp+var_4]
		cmp	es:[bx], al
		jz	short loc_2ACD_3D2
		mov	ax, [bp+var_2]
		mov	sp, bp
		pop	bp
		retf
sub_2ACD_3BC	endp

seg035		ends

; ===========================================================================

; Segment type:	Pure code
seg036		segment	byte public 'CODE' use16
		assume cs:seg036
		;org 0Ah
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

GetUnflipSize	proc far		; CODE XREF: Load2DShape+ECP

var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Ch
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4FromArg
		add	sp, 4
		mov	[bp+var_A], ax
		mov	[bp+var_6], 0
		mov	[bp+var_8], 0
		jmp	short loc_2B0B_6B
; ---------------------------------------------------------------------------
		align 2

loc_2B0B_2E:				; CODE XREF: GetUnflipSize+67j
		push	[bp+var_8]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4Scaled
		add	sp, 6
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		les	bx, [bp+var_4]
		mov	ax, es:[bx+2]
		imul	word ptr es:[bx]
		add	ax, 20h	; ' '
		mov	[bp+var_C], ax
		mov	cl, 4
		shr	[bp+var_C], cl
		mov	ax, [bp+var_6]
		cmp	[bp+var_C], ax
		jbe	short loc_2B0B_68
		mov	ax, [bp+var_C]
		mov	[bp+var_6], ax

loc_2B0B_68:				; CODE XREF: GetUnflipSize+56j
		inc	[bp+var_8]

loc_2B0B_6B:				; CODE XREF: GetUnflipSize+21j
		mov	ax, [bp+var_A]
		cmp	[bp+var_8], ax
		jl	short loc_2B0B_2E
		mov	ax, [bp+var_6]
		mov	sp, bp
		pop	bp
		retf
GetUnflipSize	endp

seg036		ends

; ===========================================================================

; Segment type:	Pure code
seg037		segment	byte public 'CODE' use16
		assume cs:seg037
		;org 0Ah
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_2B12_A	proc far		; CODE XREF: Load2DShape+1C1P

var_E		= word ptr -0Eh
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= word ptr  6
arg_2		= word ptr  8

		push	bp
		mov	bp, sp
		sub	sp, 0Eh
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4FromArg
		add	sp, 4
		mov	[bp+var_A], ax
		mov	cl, 3
		shl	ax, cl
		add	ax, 10h
		cwd
		mov	[bp+var_E], ax
		mov	[bp+var_C], dx
		mov	[bp+var_8], 0
		jmp	short loc_2B12_71
; ---------------------------------------------------------------------------

loc_2B12_36:				; CODE XREF: sub_2B12_A+6Dj
		push	[bp+var_8]
		push	[bp+arg_2]
		push	[bp+arg_0]
		call	GetWord4Scaled
		add	sp, 6
		mov	word ptr [bp+var_4], ax
		mov	word ptr [bp+var_4+2], dx
		les	bx, [bp+var_4]
		mov	ax, es:[bx+2]
		imul	word ptr es:[bx]
		mov	cl, 3
		shl	ax, cl
		mov	[bp+var_6], ax
		sub	dx, dx
		add	[bp+var_E], ax
		adc	[bp+var_C], dx
		add	[bp+var_E], 10h
		adc	[bp+var_C], 0
		inc	[bp+var_8]

loc_2B12_71:				; CODE XREF: sub_2B12_A+2Aj
		mov	ax, [bp+var_A]
		cmp	[bp+var_8], ax
		jl	short loc_2B12_36
		add	[bp+var_E], 10h
		adc	[bp+var_C], 0
		mov	al, 4
		push	ax
		lea	ax, [bp+var_E]
		push	ax
		call	lib_Flshr
		mov	ax, [bp+var_E]
		mov	sp, bp
		pop	bp
		retf
sub_2B12_A	endp

; ---------------------------------------------------------------------------
		align 10h
seg037		ends

; ===========================================================================

; Segment type:	Regular
seg038		segment	byte public 'UNK' use16
		assume cs:seg038
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
g_pPlanMemRes	db    0			; DATA XREF: InitPlanTrak+1Ao
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db  20h
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
seg038		ends

; ===========================================================================

; Segment type:	Regular
seg039		segment	byte public 'UNK' use16
		assume cs:seg039
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
word_2B1F_0	dw 3			; DATA XREF: sub_1EA2_4D3E+5Cr
					; sub_1EA2_4D3E:loc_1EA2_4DAEr	...
word_2B1F_2	dw 0			; DATA XREF: sub_1EA2_4D3E+73r
word_2B1F_4	dw 0			; DATA XREF: sub_1EA2_4D3E:loc_1EA2_4D77r
		db    0
		db    0
word_2B1F_8	dw 0			; DATA XREF: sub_1EA2_4D3E+3Cw
					; sub_1EA2_4D3E:loc_1EA2_4D8Dr	...
word_2B1F_A	dw 0			; DATA XREF: sub_1EA2_4D3E+42w
					; sub_1EA2_4D3E+7Er ...
byte_2B1F_C	db 1			; DATA XREF: sub_1EA2_4D3E+6Dw
					; sub_1EA2_4D3E+8Fr ...
		db    0
word_2B1F_E	dw 8			; DATA XREF: sub_1EA2_4D3E+77r
					; FontSpriteOp+92r
word_2B1F_10	dw 8			; DATA XREF: sub_1EA2_4D3E+61w
					; sub_1EA2_4D3E+AEr ...
word_2B1F_12	dw 8			; DATA XREF: sub_1EA2_4D3E+3Fr
					; FontSpriteOp+5Ar
byte_2B1F_14	db 0			; DATA XREF: sub_1EA2_4D3E+55r
					; FontSpriteOp+70r
		db    0
unk_2B1F_16	db    0			; DATA XREF: sub_1EA2_4D3E+27o
					; FontSpriteOp+42o
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		dw offset g_unk8Array
		dw offset g_unk8Array.field_0+8
		dw offset g_unk8Array.field_0+10h
		dw offset g_unk8Array.field_0+18h
		dw offset g_unk8Array.field_0+20h
		dw offset g_unk8Array.field_0+28h
		dw offset g_unk8Array.field_0+30h
		dw offset g_unk8Array.field_0+38h
		dw offset g_unk8Array.field_0+40h
		dw offset g_unk8Array.field_0+48h
		dw offset g_unk8Array.field_0+50h
		dw offset g_unk8Array.field_0+58h
		dw offset g_unk8Array.field_0+60h
		dw offset g_unk8Array.field_0+68h
		dw offset g_unk8Array.field_0+70h
		dw offset g_unk8Array.field_0+78h
		dw offset g_unk8Array.field_0+80h
		dw offset g_unk8Array.field_0+88h
		dw offset g_unk8Array.field_0+90h
		dw offset g_unk8Array.field_0+98h
		dw offset g_unk8Array.field_0+0A0h
		dw offset g_unk8Array.field_0+0A8h
		dw offset g_unk8Array.field_0+0B0h
		dw offset g_unk8Array.field_0+0B8h
		dw offset g_unk8Array.field_0+0C0h
		dw offset g_unk8Array.field_0+0C8h
		dw offset g_unk8Array.field_0+0D0h
		dw offset g_unk8Array.field_0+0D8h
		dw offset g_unk8Array.field_0+0E0h
		dw offset g_unk8Array.field_0+0E8h
		dw offset g_unk8Array.field_0+0F0h
		dw offset g_unk8Array.field_0+0F8h
		dw offset g_unk8Array.field_0+100h
		dw offset g_unk8Array.field_0+108h
		dw offset g_unk8Array.field_0+110h
		dw offset g_unk8Array.field_0+118h
		dw offset g_unk8Array.field_0+120h
		dw offset g_unk8Array.field_0+128h
		dw offset g_unk8Array.field_0+130h
		dw offset g_unk8Array.field_0+138h
		dw offset g_unk8Array.field_0+140h
		dw offset g_unk8Array.field_0+148h
		dw offset g_unk8Array.field_0+150h
		dw offset g_unk8Array.field_0+158h
		dw offset g_unk8Array.field_0+160h
		dw offset g_unk8Array.field_0+168h
		dw offset g_unk8Array.field_0+170h
		dw offset g_unk8Array.field_0+178h
		dw offset g_unk8Array.field_0+180h
		dw offset g_unk8Array.field_0+188h
		dw offset g_unk8Array.field_0+190h
		dw offset g_unk8Array.field_0+198h
		dw offset g_unk8Array.field_0+1A0h
		dw offset g_unk8Array.field_0+1A8h
		dw offset g_unk8Array.field_0+1B0h
		dw offset g_unk8Array.field_0+1B8h
		dw offset g_unk8Array.field_0+1C0h
		dw offset g_unk8Array.field_0+1C8h
		dw offset g_unk8Array.field_0+1D0h
		dw offset g_unk8Array.field_0+1D8h
		dw offset g_unk8Array.field_0+1E0h
		dw offset g_unk8Array.field_0+1E8h
		dw offset g_unk8Array.field_0+1F0h
		dw offset g_unk8Array.field_0+1F8h
		dw offset g_unk8Array.field_0+200h
		dw offset g_unk8Array.field_0+208h
		dw offset g_unk8Array.field_0+210h
		dw offset g_unk8Array.field_0+218h
		dw offset g_unk8Array.field_0+220h
		dw offset g_unk8Array.field_0+228h
		dw offset g_unk8Array.field_0+230h
		dw offset g_unk8Array.field_0+238h
		dw offset g_unk8Array.field_0+240h
		dw offset g_unk8Array.field_0+248h
		dw offset g_unk8Array.field_0+250h
		dw offset g_unk8Array.field_0+258h
		dw offset g_unk8Array.field_0+260h
		dw offset g_unk8Array.field_0+268h
		dw offset g_unk8Array.field_0+270h
		dw offset g_unk8Array.field_0+278h
		dw offset g_unk8Array.field_0+280h
		dw offset g_unk8Array.field_0+288h
		dw offset g_unk8Array.field_0+290h
		dw offset g_unk8Array.field_0+298h
		dw offset g_unk8Array.field_0+2A0h
		dw offset g_unk8Array.field_0+2A8h
		dw offset g_unk8Array.field_0+2B0h
		dw offset g_unk8Array.field_0+2B8h
		dw offset g_unk8Array.field_0+2C0h
		dw offset g_unk8Array.field_0+2C8h
		dw offset g_unk8Array.field_0+2D0h
		dw offset g_unk8Array.field_0+2D8h
		dw offset g_unk8Array.field_0+2E0h
		dw offset g_unk8Array.field_0+2E8h
		dw offset g_unk8Array.field_0+2F0h
		dw offset g_unk8Array.field_0+2F8h
		dw offset g_unk8Array.field_0+300h
		dw offset g_unk8Array.field_0+308h
		dw offset g_unk8Array.field_0+310h
		dw offset g_unk8Array.field_0+318h
		dw offset g_unk8Array.field_0+320h
		dw offset g_unk8Array.field_0+328h
		dw offset g_unk8Array.field_0+330h
		dw offset g_unk8Array.field_0+338h
		dw offset g_unk8Array.field_0+340h
		dw offset g_unk8Array.field_0+348h
		dw offset g_unk8Array.field_0+350h
		dw offset g_unk8Array.field_0+358h
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
g_unk8Array	Unknown8 <0, 0,	0, 0>	; DATA XREF: seg039:0056o seg039:0058o
		Unknown8 <7830h, 3078h,	30h, 30h>
		Unknown8 <6C6Ch, 6Ch, 0, 0>
		Unknown8 <6C6Ch, 6CFEh,	6CFEh, 6Ch>
		Unknown8 <7C30h, 78C0h,	0F80Ch,	30h>
		Unknown8 <0C600h, 18CCh, 6630h,	0C6h>
		Unknown8 <6C38h, 7638h,	0CCDCh,	76h>
		Unknown8 <6060h, 0C0h, 0, 0>
		Unknown8 <3018h, 6060h,	3060h, 18h>
		Unknown8 <3060h, 1818h,	3018h, 60h>
		Unknown8 <6600h, 0FF3Ch, 663Ch,	0>
		Unknown8 <3000h, 0FC30h, 3030h,	0>
		Unknown8 <0, 0,	3000h, 6030h>
		Unknown8 <0, 0FC00h, 0,	0>
		Unknown8 <0, 0,	3000h, 30h>
		Unknown8 <0C06h, 3018h,	0C060h,	80h>
		Unknown8 <0C67Ch, 0C6C6h, 0C6C6h, 7Ch>
		Unknown8 <7030h, 3030h,	3030h, 0FCh>
		Unknown8 <0CC78h, 380Ch, 0CC60h, 0FCh>
		Unknown8 <0CC78h, 380Ch, 0CC0Ch, 78h>
		Unknown8 <3C1Ch, 0CC6Ch, 0CFEh,	1Eh>
		Unknown8 <0C0FCh, 0CF8h, 0CC0Ch, 78h>
		Unknown8 <6038h, 0F8C0h, 0CCCCh, 78h>
		Unknown8 <0CCFCh, 180Ch, 3030h,	30h>
		Unknown8 <0CC78h, 78CCh, 0CCCCh, 78h>
		Unknown8 <0CC78h, 7CCCh, 180Ch,	70h>
		Unknown8 <3000h, 30h, 3000h, 30h>
		Unknown8 <3000h, 30h, 3000h, 6030h>
		Unknown8 <3018h, 0C060h, 3060h,	18h>
		Unknown8 <0, 0FCh, 0FC00h, 0>
		Unknown8 <3060h, 0C18h,	3018h, 60h>
		Unknown8 <0CC78h, 180Ch, 30h, 30h>
		Unknown8 <0C67Ch, 0DEDEh, 0C0DEh, 78h>
		Unknown8 <7830h, 0CCCCh, 0CCFCh, 0CCh>
		Unknown8 <66FCh, 7C66h,	6666h, 0FCh>
		Unknown8 <663Ch, 0C0C0h, 66C0h,	3Ch>
		Unknown8 <6CF8h, 6666h,	6C66h, 0F8h>
		Unknown8 <62FEh, 7868h,	6268h, 0FEh>
		Unknown8 <62FEh, 7868h,	6068h, 0F0h>
		Unknown8 <663Ch, 0C0C0h, 66CEh,	3Eh>
		Unknown8 <0CCCCh, 0FCCCh, 0CCCCh, 0CCh>
		Unknown8 <3078h, 3030h,	3030h, 78h>
		Unknown8 <0C1Eh, 0C0Ch,	0CCCCh,	78h>
		Unknown8 <66E6h, 786Ch,	666Ch, 0E6h>
		Unknown8 <60F0h, 6060h,	6662h, 0FEh>
		Unknown8 <0EEC6h, 0FEFEh, 0C6D6h, 0C6h>
		Unknown8 <0E6C6h, 0DEF6h, 0C6CEh, 0C6h>
		Unknown8 <6C38h, 0C6C6h, 6CC6h,	38h>
		Unknown8 <66FCh, 7C66h,	6060h, 0F0h>
		Unknown8 <0CC78h, 0CCCCh, 78DCh, 1Ch>
		Unknown8 <66FCh, 7C66h,	666Ch, 0E6h>
		Unknown8 <0CC78h, 70E0h, 0CC1Ch, 78h>
		Unknown8 <0B4FCh, 3030h, 3030h,	78h>
		Unknown8 <0CCCCh, 0CCCCh, 0CCCCh, 0FCh>
		Unknown8 <0CCCCh, 0CCCCh, 78CCh, 30h>
		Unknown8 <0C6C6h, 0D6C6h, 0EEFEh, 0C6h>
		Unknown8 <0C6C6h, 386Ch, 6C38h,	0C6h>
		Unknown8 <0CCCCh, 78CCh, 3030h,	78h>
		Unknown8 <0C6FEh, 188Ch, 6632h,	0FEh>
		Unknown8 <6078h, 6060h,	6060h, 78h>
		Unknown8 <60C0h, 1830h,	60Ch, 2>
		Unknown8 <1878h, 1818h,	1818h, 78h>
		Unknown8 <3810h, 0C66Ch, 0, 0>
		Unknown8 <0, 0,	0, 0FF00h>
		Unknown8 <3030h, 18h, 0, 0>
		Unknown8 <0, 0C78h, 0CC7Ch, 76h>
		Unknown8 <60E0h, 7C60h,	6666h, 0DCh>
		Unknown8 <0, 0CC78h, 0CCC0h, 78h>
		Unknown8 <0C1Ch, 7C0Ch,	0CCCCh,	76h>
		Unknown8 <0, 0CC78h, 0C0FCh, 78h>
		Unknown8 <6C38h, 0F060h, 6060h,	0F0h>
		Unknown8 <0, 0CC76h, 7CCCh, 0F80Ch>
		Unknown8 <60E0h, 766Ch,	6666h, 0E6h>
		Unknown8 <30h, 3070h, 3030h, 78h>
		Unknown8 <0Ch, 0C0Ch, 0CC0Ch, 78CCh>
		Unknown8 <60E0h, 6C66h,	6C78h, 0E6h>
		Unknown8 <3070h, 3030h,	3030h, 78h>
		Unknown8 <0, 0FECCh, 0D6FEh, 0C6h>
		Unknown8 <0, 0CCF8h, 0CCCCh, 0CCh>
		Unknown8 <0, 0CC78h, 0CCCCh, 78h>
		Unknown8 <0, 66DCh, 7C66h, 0F060h>
		Unknown8 <0, 0CC76h, 7CCCh, 1E0Ch>
		Unknown8 <0, 76DCh, 6066h, 0F0h>
		Unknown8 <0, 0C07Ch, 0C78h, 0F8h>
		Unknown8 <3010h, 307Ch,	3430h, 18h>
		Unknown8 <0, 0CCCCh, 0CCCCh, 76h>
		Unknown8 <0, 0CCCCh, 78CCh, 30h>
		Unknown8 <0, 0D6C6h, 0FEFEh, 6Ch>
		Unknown8 <0, 6CC6h, 6C38h, 0C6h>
		Unknown8 <0, 0CCCCh, 7CCCh, 0F80Ch>
		Unknown8 <0, 98FCh, 6430h, 0FCh>
		Unknown8 <301Ch, 0E030h, 3030h,	1Ch>
		Unknown8 <1818h, 18h, 1818h, 18h>
		Unknown8 <30E0h, 1C30h,	3030h, 0E0h>
		Unknown8 <0DC76h, 0, 0,	0>
		Unknown8 <1000h, 6C38h,	0C6C6h,	0FEh>
		Unknown8 <200h,	4804h, 2050h, 0>
		Unknown8 <3018h, 0FE60h, 3060h,	18h>
		Unknown8 <1830h, 0FE0Ch, 180Ch,	30h>
		Unknown8 <3810h, 0D67Ch, 1010h,	10h>
		Unknown8 <1010h, 0D610h, 387Ch,	10h>
		Unknown8 <0, 0FF00h, 0,	0>
		Unknown8 <1010h, 1010h,	1010h, 1010h>
		Unknown8 <2408h, 9292h,	824h, 0>
		Unknown8 <667Ch, 9292h,	7CC6h, 0>
		Unknown8 <200h,	4804h, 2050h, 0>
		Unknown8 <2000h, 0FE60h, 60FEh,	20h>
		Unknown8 <0, 0,	0, 0FF00h>
		Unknown8 <1818h, 1818h,	1818h, 1818h>
		db    0
		db    0
seg039		ends

; ===========================================================================

; Segment type:	Pure data
dseg		segment	para public 'DATA' use16
		assume cs:dseg
ds_NULL		dw 0			; DATA XREF: TrkTerrainWall:loc_E1A_100o
					; TakesTrackNames+DBo ...
word_2B77_2	dw 0			; DATA XREF: start+54w
					; FontSpriteOp+8Er
word_2B77_4	dw 0			; DATA XREF: FontSpriteOp:loc_1EA2_5BF0r
		db    0
		db    0
aMsRunTimeLibra	db 'MS Run-Time Library - Copyright (c) 1988, Microsoft Corp'
					; DATA XREF: FontTextOp+10w
					; sub_1EA2_5B74+1Cw ...
		db  11h
		db    0
aMain		db 'main',0             ; DATA XREF: _main+ADo
aFontdef_fnt	db 'fontdef.fnt',0      ; DATA XREF: _main+C0o
aFontn_fnt	db 'fontn.fnt',0        ; DATA XREF: _main+D6o
aTrakdata	db 'trakdata',0         ; DATA XREF: _main+FEo
aDefault	db 'DEFAULT',0          ; DATA XREF: _main+274o
a_trk		db '.trk',0             ; DATA XREF: _main+405o
aSlct		db 'SLCT',0             ; DATA XREF: _main+453o
aSkidms_0	db 'skidms',0           ; DATA XREF: _main+457o
					; LoadIntroRes+5AEo ...
aSkidslct	db 'skidslct',0         ; DATA XREF: _main+45Bo
					; DoSkidslctDrv+11o
aTedit__0	db 'tedit.*',0          ; DATA XREF: _main:_lblFindTedito
aCvx		db 'cvx',0              ; DATA XREF: _main+3A9o
aDos		db 'dos',0              ; DATA XREF: _main+547o
g_prcMegaPoly2	dw 0			; DATA XREF: UpdateFrame+20w
					; UpdateFrame+34w ...
g_prcMegaPoly1	dw 0			; DATA XREF: UpdateFrame+26w
					; UpdateFrame:loc_9F1_212w ...
g_pcData20Trak1	db 52h dup(0)		; DATA XREF: _main+34Ar _main+40Do ...
g_pcData20Trak2	db 52h dup(0)		; DATA XREF: _main+357r _main+512w ...
aDefault_0	db 'DEFAULT',0          ; DATA XREF: LoadIntroRes+672o
					; LoadIntroRes+6AEo ...
		db    0
		db    0
aDesert		db 'desert',0           ; DATA XREF: LoadSkybox+40o
		db    0
		db    0
aTropical	db 'tropical',0
aAlpine		db 'alpine',0
		db    0
		db    0
aCity		db 'city',0
		db    0
		db    0
g_pHiScoreRel	db    0			; DATA XREF: DoHighScore+DFo
					; HiscoreRelated+6Ao
		db    0
aCountry	db 'country',0
		db    0
		db    0
word_2B77_178	dw 0			; DATA XREF: TrkPlanSimd+19BCr
					; InitGameState+121r ...
word_2B77_17A	dw 1C2h			; DATA XREF: DoSomeTrakData+1D2r
					; UpdateFrame+DDFr ...
word_2B77_17C	dw 0D2h			; DATA XREF: UpdateFrame+1B2r
					; RplyMouseSpriteStuff:loc_11B7_2718r ...
word_2B77_17E	dw 1D0h			; DATA XREF: UpdateFrame+1BEr
					; RplyMouseSpriteStuff:loc_11B7_26BAw ...
word_2B77_180	dw 50h			; DATA XREF: UpdateFrame+1C3r
					; RplyMouseSpriteStuff:loc_11B7_26D2r ...
byte_2B77_182	db 0			; DATA XREF: RunOptionMenu:loc_0_304Er
					; RunGame+135r	...
g_bLoadedAudio	db 0			; DATA XREF: _main+44Cr
					; LoadAudioResour+52w ...
byte_2B77_184	db 0			; DATA XREF: sub_11B7_88A:_lblToggleHw
g_cCameraMode	db 0			; DATA XREF: DoAudioCvx:loc_471_4321r
					; UpdateFrame+127r ...
byte_2B77_186	db 0			; DATA XREF: LoadSkybox:loc_9F1_38A6r
					; LoadSkybox+30w ...
g_cKbMouUnk	db 0			; DATA XREF: InputsChecking+12Br
					; DoUseMousePosw ...
g_cKbOrMouse	db 0			; DATA XREF: _main+2A3w
					; RunGame:_lblSetupCarGameDonew ...
					; 0 == kb, 1 ==	mouse
m_cDirtyMouse	db 0			; DATA XREF: InputsChecking+132r
					; InputsChecking+165r ...
g_wTimerFlag3	db 0			; DATA XREF: sub_9F1_4+38r
					; UpdateFrame:loc_9F1_675r ...
g_bSaveDelFlag	db 0			; DATA XREF: DoHighScore+45w
					; DoHighScore+68w ...
byte_2B77_18C	db 0			; DATA XREF: Trakdata12SpriteOp+74r
					; Trakdata12SpriteOp+86r ...
		align 2
aKevin		db 'kevin',0            ; DATA XREF: _main+268o
aOpp1		db 'opp1',0             ; DATA XREF: RunOpponentMenu+BCo
					; EndOfGameScores+36o ...
		db    0
aCarcoun	db 'carcoun'            ; DATA XREF: RunCarMenu+3D2o
					; SetupCarGameEtc+42o ...
		align 2
aTitl		db 'TITL',0             ; DATA XREF: RunIntroInLoop+7o
aSkidms		db 'skidms',0           ; DATA XREF: RunIntroInLoop+Bo
aSkidtitl	db 'skidtitl',0         ; DATA XREF: RunIntroInLoop+Fo
aSdtitl		db 'sdtitl',0           ; DATA XREF: RunIntroInLoop+1Bo
aSdcred		db 'sdcred',0           ; DATA XREF: RunIntroInLoop+83o
aProd		db 'prod',0             ; DATA XREF: RunIntro+1Bo
aProd_0		db 'prod',0             ; DATA XREF: RunIntro:loc_0_6E4o
aTitl_0		db 'titl',0             ; DATA XREF: RunIntro+9Do
aCred		db 'cred',0             ; DATA XREF: LoadIntroRes+8o
aArowarrwarw1ar	db 'arowarrwarw1arw2arw3arw4arw5arw6arw7arw8type',0
					; DATA XREF: LoadIntroRes+1Eo
aCre		db 'cre',0              ; DATA XREF: LoadIntroRes+5Fo
aGds0		db 'gds0',0             ; DATA XREF: LoadIntroRes+9Ao
aGds1		db 'gds1',0             ; DATA XREF: LoadIntroRes+D6o
aDes		db 'des',0              ; DATA XREF: LoadIntroRes+112o
aGdon		db 'gdon',0             ; DATA XREF: LoadIntroRes+14Eo
aGkev		db 'gkev',0             ; DATA XREF: LoadIntroRes+18Ao
aGbra		db 'gbra',0             ; DATA XREF: LoadIntroRes+1C6o
aGrob		db 'grob',0             ; DATA XREF: LoadIntroRes+202o
aGsta		db 'gsta',0             ; DATA XREF: LoadIntroRes+23Eo
aMus		db 'mus',0              ; DATA XREF: LoadIntroRes+27Ao
aGmsy		db 'gmsy',0             ; DATA XREF: LoadIntroRes+2B6o
aGkri		db 'gkri',0             ; DATA XREF: LoadIntroRes+2F2o
aGbri		db 'gbri',0             ; DATA XREF: LoadIntroRes+32Eo
aPro		db 'pro',0              ; DATA XREF: LoadIntroRes+36Ao
aGkev_0		db 'gkev',0             ; DATA XREF: LoadIntroRes+3A6o
aOpr		db 'opr',0              ; DATA XREF: LoadIntroRes+3E2o
aGbra_0		db 'gbra',0             ; DATA XREF: LoadIntroRes+41Eo
aGric		db 'gric',0             ; DATA XREF: LoadIntroRes+45Ao
aArt		db 'art',0              ; DATA XREF: LoadIntroRes+496o
aGmsm		db 'gmsm',0             ; DATA XREF: LoadIntroRes+4D2o
aGdav		db 'gdav',0             ; DATA XREF: LoadIntroRes+50Eo
aGnic		db 'gnic',0             ; DATA XREF: LoadIntroRes+54Ao
aGkev_1		db 'gkev',0             ; DATA XREF: LoadIntroRes+586o
aSdmsel		db 'sdmsel',0           ; DATA XREF: RunMenu+38o
aScrn		db 'scrn',0             ; DATA XREF: RunMenu+53o
		align 2
		db    1
		db    2
		db    4
		db    0
		db    3
		db    0
		db    3
		db    0
		db    1
		db    4
		db    2
		db    0
unk_2B77_28C	db  69h	; i		; DATA XREF: RunMenu+C7o RunMenu+F3o
		db    0
		db  42h	; B
		db    0
		db    5
		db    0
		db 0BEh	; ¾
		db    0
		db 0FFh
		db    0
unk_2B77_296	db 0D0h	; Ð		; DATA XREF: RunMenu+C3o RunMenu+EFo
		db    0
		db  6Bh	; k
		db    0
		db  43h	; C
		db    0
		db 0FDh	; ý
		db    0
		db  38h	; 8
		db    1
unk_2B77_2A0	db  77h	; w		; DATA XREF: RunMenu+BFo RunMenu+EBo
		db    0
		db  4Dh	; M
		db    0
		db  72h	; r
		db    0
		db  4Ch	; L
		db    0
		db  74h	; t
		db    0
unk_2B77_2AA	db 0C5h	; Å		; DATA XREF: RunMenu+BBo RunMenu+E7o
		db    0
		db  78h	; x
		db    0
		db 0AAh	; ª
		db    0
		db  7Ah	; z
		db    0
		db 0A6h	; ¦
		db    0
unk_2B77_2B4	db  27h	; '             ; DATA XREF: RunTracksMenu+C4o
		db    0
unk_2B77_2B6	db  27h	; '             ; DATA XREF: RunTracksMenu+E4o
		db    0
aHs0		db 'hs0',0              ; DATA XREF: RunTracksMenu:loc_0_1210o
aTedit		db 'tedit',0            ; DATA XREF: RunTracksMenu:loc_0_12E5o
aBmt		db 'bmt',0              ; DATA XREF: RunTracksMenu+246o
aBet		db 'bet',0              ; DATA XREF: RunTracksMenu+27Fo
aBmm_0		db 'bmm',0              ; DATA XREF: RunTracksMenu+2BAo
aTrk		db 'trk',0              ; DATA XREF: RunTracksMenu:loc_0_14E2o
a_trk_1		db '.trk',0             ; DATA XREF: RunTracksMenu+428o
a_trk_2		db '.trk',0             ; DATA XREF: RunTracksMenu+443o
unk_2B77_2DC	db  10h			; DATA XREF: RunTracksMenu+329o
					; RunTracksMenu+36Do
		db    0
		db  70h	; p
		db    0
		db 0D0h	; Ð
		db    0
unk_2B77_2E2	db  70h	; p		; DATA XREF: RunTracksMenu+325o
					; RunTracksMenu+369o
		db    0
		db 0D0h	; Ð
		db    0
		db  30h	; 0
		db    1
unk_2B77_2E8	db 0ABh	; «		; DATA XREF: RunTracksMenu+321o
					; RunTracksMenu+365o
		db    0
		db 0ABh	; «
		db    0
		db 0ABh	; «
		db    0
unk_2B77_2EE	db 0C5h	; Å		; DATA XREF: RunTracksMenu+31Do
					; RunTracksMenu+361o
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
a_hig_0		db '.hig',0             ; DATA XREF: DoHighScore+2Bo
a_____________0	db '....................',0 ; DATA XREF: DoHighScore:loc_0_160Ao
a______________	db '.......................',0 ; DATA XREF: DoHighScore+92o
a______		db '../....',0          ; DATA XREF: DoHighScore+A6o
aHs1		db 'hs1',0              ; DATA XREF: MainTextResFont+Bo
asc_2B77_332	db ' ',27h,0            ; DATA XREF: MainTextResFont+2Do
unk_2B77_335	db  27h	; '             ; DATA XREF: MainTextResFont+4Do
		db    0
aHs2		db 'hs2',0              ; DATA XREF: MainTextResFont+81o
aHs3		db 'hs3',0              ; DATA XREF: MainTextResFont+BEo
aHs5		db 'hs5',0              ; DATA XREF: MainTextResFont+FBo
aHs4		db 'hs4',0              ; DATA XREF: MainTextResFont+138o
asc_2B77_347	db '(',0                ; DATA XREF: Trakdata11StringOp+A0o
asc_2B77_349	db ')',0                ; DATA XREF: Trakdata11StringOp+C7o
asc_2B77_34B	db ' ',0                ; DATA XREF: EnterHiscore:loc_0_1AE6o
a_hig		db '.hig',0             ; DATA XREF: HiscoreRelated+51o
a_res_0		db '.res',0             ; DATA XREF: RunCarMenu+50o
aCar		db 'car*',0             ; DATA XREF: RunCarMenu+54o
aSdcsel		db 'sdcsel',0           ; DATA XREF: RunCarMenu+235o
aMisc_3		db 'misc',0             ; DATA XREF: RunCarMenu+24Do
aGrap		db 'grap',0             ; DATA XREF: RunCarMenu+476o
a150		db '150',0              ; DATA XREF: RunCarMenu+4B9o
a100		db '100',0              ; DATA XREF: RunCarMenu+4CDo
a50		db ' 50',0              ; DATA XREF: RunCarMenu+4E1o
a0		db '  0',0              ; DATA XREF: RunCarMenu+4F5o
a02040		db '0  20  40',0        ; DATA XREF: RunCarMenu+509o
aBdo_0		db 'bdo',0              ; DATA XREF: RunCarMenu+53Bo
aBnx_0		db 'bnx',0              ; DATA XREF: RunCarMenu+57Ao
aBla_0		db 'bla',0              ; DATA XREF: RunCarMenu+5B9o
aBau		db 'bau',0              ; DATA XREF: RunCarMenu+5DFo
aBma		db 'bma',0              ; DATA XREF: RunCarMenu:loc_0_2226o
aBco		db 'bco',0              ; DATA XREF: RunCarMenu+64Co
aDes_1		db 'des',0              ; DATA XREF: RunCarMenu+718o
aStop_1		db 'stop',0             ; DATA XREF: RunCarMenu+9DEo
aBau_0		db 'bau',0              ; DATA XREF: RunCarMenu+C35o
aBma_0		db 'bma',0              ; DATA XREF: RunCarMenu:loc_0_287Co
g_pwUnk8_3	dw 0, 140h, 0, 5Fh	; DATA XREF: RunCarMenu+80Ao
					; RunCarMenu+817o
word_2B77_3B8	dw 0E5h			; DATA XREF: RunCarMenu+536r
					; RunCarMenu+575r ...
		db 0E5h	; å
		db    0
		db 0E5h	; å
		db    0
		db 0E5h	; å
		db    0
		db 0E5h	; å
		db    0
word_2B77_3C2	dw 13Ch			; DATA XREF: RunCarMenu+8B8r
					; RunCarMenu+914o ...
		db  3Ch	; <
		db    1
		db  3Ch	; <
		db    1
		db  3Ch	; <
		db    1
		db  3Ch	; <
		db    1
word_2B77_3CC	dw 6Bh			; DATA XREF: RunCarMenu+531r
					; RunCarMenu+8B4r ...
word_2B77_3CE	dw 7Dh			; DATA XREF: RunCarMenu+570r
word_2B77_3D0	dw 8Fh			; DATA XREF: RunCarMenu+5AFr
word_2B77_3D2	dw 0A1h			; DATA XREF: RunCarMenu+615r
					; RunCarMenu+C6Br ...
word_2B77_3D4	dw 0B3h			; DATA XREF: RunCarMenu+642r
unk_2B77_3D6	db  7Ch	; |		; DATA XREF: RunCarMenu+90Co
					; RunCarMenu+950o
		db    0
		db  8Eh	; Ž
		db    0
		db 0A0h	;  
		db    0
		db 0B2h	; ²
		db    0
word_2B77_3DE	dw 0C4h			; DATA XREF: RunCarMenu+8AFr
aLnam		db 'lnam',0
		db    0
unk_2B77_3E6	db    0			; DATA XREF: RunCarMenu:loc_0_24ACo
		db    0
word_2B77_3E8	dw 140h			; DATA XREF: RunCarMenu:loc_0_1EABw
					; RunCarMenu:loc_0_1F4Aw
		db    0
		db    0
word_2B77_3EC	dw 0			; DATA XREF: RunCarMenu+85Bw
					; RunCarMenu:loc_0_24A6w
unk_2B77_3EE	db    0			; DATA XREF: RunCarMenu+Do
		db    0
word_2B77_3F0	dw 0FCB8h		; DATA XREF: RunCarMenu+7E5r
word_2B77_3F2	dw 0B40h		; DATA XREF: RunCarMenu:loc_0_2423r
aMisc		db 'misc',0             ; DATA XREF: RunOpponentMenu+13o
aSdosel		db 'sdosel',0           ; DATA XREF: RunOpponentMenu+26o
aOpp0opp1opp2op	db 'opp0opp1opp2opp3opp4opp5opp6',0 ; DATA XREF: RunOpponentMenu+41o
aScrn_0		db 'scrn',0             ; DATA XREF: RunOpponentMenu+130o
aBla		db 'bla',0              ; DATA XREF: RunOpponentMenu+16Eo
aBnx		db 'bnx',0              ; DATA XREF: RunOpponentMenu+1ACo
aBcl		db 'bcl',0              ; DATA XREF: RunOpponentMenu+1EAo
aBca		db 'bca',0              ; DATA XREF: RunOpponentMenu+228o
aBdo		db 'bdo',0              ; DATA XREF: RunOpponentMenu+266o
aClip		db 'clip',0             ; DATA XREF: RunOpponentMenu+2C9o
aDes_0		db 'des',0              ; DATA XREF: RunOpponentMenu+311o
aRac		db 'rac',0              ; DATA XREF: RunOpponentMenu:loc_0_2C5Ao
		align 2
		db  14h
		db    0
		db  4Ch	; L
		db    0
		db  84h	; „
		db    0
		db 0BCh	; ¼
		db    0
		db 0F4h	; ô
		db    0
		db  4Ch	; L
		db    0
		db  84h	; „
		db    0
		db 0BCh	; ¼
		db    0
		db 0F4h	; ô
		db    0
		db  2Ch	; ,
		db    1
unk_2B77_458	db 0B1h	; ±		; DATA XREF: RunOpponentMenu+165r
					; RunOpponentMenu+1A3r	...
		db    0
		db 0B1h	; ±
		db    0
		db 0B1h	; ±
		db    0
		db 0B1h	; ±
		db    0
		db 0B1h	; ±
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
aMisc_1		db 'misc',0             ; DATA XREF: RunOptionMenu+6o
aGstu		db 'gstu',0             ; DATA XREF: RunOptionMenu+2Ao
aGver		db 'gver',0             ; DATA XREF: RunOptionMenu+70o
aMop		db 'mop',0              ; DATA XREF: RunOptionMenu+C7o
aMid		db 'mid',0              ; DATA XREF: RunOptionMenu+135o
aRep		db 'rep',0              ; DATA XREF: RunOptionMenu:loc_0_30E2o
a_rpl		db '.rpl',0             ; DATA XREF: RunOptionMenu+1AEo
aMisc_2		db 'misc',0             ; DATA XREF: EndOfGameScores+15o
aElt		db 'elt',0              ; DATA XREF: EndOfGameScores+DFo
aCon		db 'con',0              ; DATA XREF: EndOfGameScores+138o
aPpt		db 'ppt',0              ; DATA XREF: EndOfGameScores:loc_0_330Do
aDnf		db 'dnf',0              ; DATA XREF: EndOfGameScores:loc_0_3354o
aOlt		db 'olt',0              ; DATA XREF: EndOfGameScores+244o
aDnf_0		db 'dnf',0              ; DATA XREF: EndOfGameScores+264o
aOwt		db 'owt',0              ; DATA XREF: EndOfGameScores:loc_0_341Co
aOlt_0		db 'olt',0              ; DATA XREF: EndOfGameScores:loc_0_3466o
aVict		db 'VICT',0             ; DATA XREF: EndOfGameScores+36Ao
aSkidms_1	db 'skidms',0           ; DATA XREF: EndOfGameScores+36Eo
aSkidvict	db 'skidvict',0         ; DATA XREF: EndOfGameScores+372o
aOver		db 'OVER',0             ; DATA XREF: EndOfGameScores:loc_0_34F0o
aSkidms_2	db 'skidms',0           ; DATA XREF: EndOfGameScores+37Co
aSkidover	db 'skidover',0         ; DATA XREF: EndOfGameScores+380o
aAvs		db 'avs',0              ; DATA XREF: EndOfGameScores:loc_0_351Do
aMph		db 'mph',0              ; DATA XREF: EndOfGameScores+418o
aImp		db 'imp',0              ; DATA XREF: EndOfGameScores:loc_0_35EDo
aMph_0		db 'mph',0              ; DATA XREF: EndOfGameScores+4C0o
aTop		db 'top',0              ; DATA XREF: EndOfGameScores:loc_0_368Bo
aMph_1		db 'mph',0              ; DATA XREF: EndOfGameScores+55Eo
aJum		db 'jum',0              ; DATA XREF: EndOfGameScores+5B8o
aWinn		db 'winn',0             ; DATA XREF: EndOfGameScores+6F7o
aLose_0		db 'lose',0             ; DATA XREF: EndOfGameScores+75Co
a_trk_0		db '.trk',0             ; DATA XREF: EndOfGameScores+78Fo
aIhd		db 'ihd',0              ; DATA XREF: EndOfGameScores+7CAo
aD4a		db 'd4a',0              ; DATA XREF: EndOfGameScores+9C4o
aBct		db 'bct',0              ; DATA XREF: EndOfGameScores+BC2o
aInh		db 'inh',0              ; DATA XREF: EndOfGameScores+DAEo
aInh_0		db 'inh',0              ; DATA XREF: EndOfGameScores+DE3o
aHna		db 'hna',0              ; DATA XREF: EndOfGameScores+E17o
aBev		db 'bev',0              ; DATA XREF: EndOfGameScores+E96o
aBhi		db 'bhi',0              ; DATA XREF: EndOfGameScores:loc_0_4014o
aBrp		db 'brp',0              ; DATA XREF: EndOfGameScores+F05o
aBra		db 'bra',0              ; DATA XREF: EndOfGameScores+F27o
aBdr		db 'bdr',0              ; DATA XREF: EndOfGameScores:loc_0_40A4o
aBmm		db 'bmm',0              ; DATA XREF: EndOfGameScores+F9Ao
		db    2
		db    0
		db    1
		db    0
		db    2
		db    0
		db    3
		db    0
		db    4
		db    0
		db    1
		db    0
		db    4
		db    0
		db    0
		db    0
		db    5
		db    0
		db    0
		db    0
		db    0
		db    0
		db    6
		db    0
		db    5
		db    0
		db    6
unk_2B77_551	db    0
		db    5
		db    0
		db    1
		db    0
		db    1
		db    0
		db    2
		db    0
		db    3
		db    0
		db    5
		db    0
		db    0
		db    0
		db    6
		db    0
		db    2
		db    0
		db    3
		db    0
		db    4
		db    0
		db    4
		db    0
		db    0
		db    0
		db    6
		db    0
g_array201	dw 2, 0, 1		; DATA XREF: EndOfGameScores+661r
					; EndOfGameScores+682r
g_array103	dw 1, 0, 3		; DATA XREF: EndOfGameScores+6CCr
		db    2
		db    0
unk_2B77_57C	db    4			; DATA XREF: EndOfGameScores+C1Fo
					; EndOfGameScores+ECFr
		db    0
unk_2B77_57E	db  54h	; T		; DATA XREF: EndOfGameScores+EFFr
		db    0
unk_2B77_580	db 0A4h	; ¤		; DATA XREF: EndOfGameScores+F63r
		db    0
unk_2B77_582	db 0F4h	; ô		; DATA XREF: EndOfGameScores+F94r
		db    0
		db  80h	; €
		db    0
unk_2B77_586	db  4Bh	; K		; DATA XREF: EndOfGameScores+C1Bo
		db    0
		db  9Bh	; ›
		db    0
		db 0EBh	; ë
		db    0
		db  3Bh	; ;
		db    1
		db 0C7h	; Ç
		db    0
word_2B77_590	dw 0AEh			; DATA XREF: EndOfGameScores+C17o
					; EndOfGameScores+D84r	...
unk_2B77_592	db 0AEh	; ®		; DATA XREF: EndOfGameScores+11CFo
		db    0
		db 0AEh	; ®
		db    0
		db 0AEh	; ®
		db    0
		db 0AEh	; ®
		db    0
word_2B77_59A	dw 0C5h			; DATA XREF: EndOfGameScores+C13o
					; EndOfGameScores+D7Fr	...
unk_2B77_59C	db 0C5h	; Å		; DATA XREF: EndOfGameScores:loc_0_4343o
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
		db 0C5h	; Å
		db    0
aOpp2win	db 'opp2win',0          ; DATA XREF: EndOfGameScores+6E1o
					; EndOfGameScores+6DEw
aOpp2		db 'opp2'               ; DATA XREF: EndOfGameScores+746o
					; EndOfGameScores+743w
aLose		db 'lose',0
		align 2
aOp01		db 'op01',0             ; DATA XREF: EndOfGameScores+8D8o
					; EndOfGameScores+963o	...
aMisc_0		db 'misc',0             ; DATA XREF: SecurityCheck+19o
aCop		db 'cop',0              ; DATA XREF: SecurityCheck+2Do
a0123456789abcd	db '0123456789abcdefghij',0 ; DATA XREF: SecurityCheck+Br
					; SecurityCheck+12r
		db    0
aQ00		db 'q00',0              ; DATA XREF: SecurityCheck+4Do
					; SecurityCheck+Fw
aA00		db 'a00',0              ; DATA XREF: SecurityCheck+125o
					; SecurityCheck+16w
		db  0Ah
		db    0
		db  32h	; 2
		db    0
		db  0Ah
		db    0
		db  14h
		db    0
g_ptCollide2	Point2D	<5, 28h>	; DATA XREF: TrkPlanSimd+1918o
		Point2D	<5, 0Ah>
g_ptCollide3	Point2D	<6, 79h>	; DATA XREF: TrkPlanSimd+19F7o
					; TrkPlanSimd+1A78o
		Point2D	<6, 9>
g_ptCollide1	Point2D	2 dup(<1, 0Ah>)	; DATA XREF: TrkPlanSimd+1883o
unk_2B77_602	db  15h			; DATA XREF: TrkPlanSimd+8ACr
					; TrkPlanSimd+8E0r
		db    0
		db  15h
		db    0
		db  0Fh
		db    0
		db  0Fh
		db    0
unk_2B77_60A	db    0			; DATA XREF: InitGameState:loc_471_244Co
		db    8
		db 0F8h	; ø
		db    0
		db    0
		db    7
		db 0F9h	; ù
		db    0
		db    0
		db    6
		db 0FAh	; ú
		db    0
		db    0
		db    5
		db 0FBh	; û
		db    0
		db    0
		db    4
		db 0FCh	; ü
		db    0
		db    0
		db    4
		db 0FCh	; ü
		db    0
		db    0
		db    3
		db 0FDh	; ý
		db    0
		db    0
		db    3
		db 0FDh	; ý
		db    0
		db    0
		db    2
		db 0FEh	; þ
		db    0
		db    0
		db    2
		db 0FEh	; þ
		db    0
		db    0
		db    2
		db 0FEh	; þ
		db    0
		db    0
		db    1
		db 0FFh
		db    0
		db    0
		db    1
		db 0FFh
		db    0
		db    0
		db    1
		db 0FFh
		db    0
		db    0
		db    1
		db 0FFh
		db    0
		db    0
		db    1
		db 0FFh
		db    0
unk_2B77_64A	db    0			; DATA XREF: InitGameState+52o
		db  10h
		db 0F0h	; ð
		db    0
		db    0
		db  0Eh
		db 0F2h	; ò
		db    0
		db    0
		db  0Ch
		db 0F4h	; ô
		db    0
		db    0
		db  0Ah
		db 0F6h	; ö
		db    0
		db    0
		db    8
		db 0F8h	; ø
		db    0
		db    0
		db    8
		db 0F8h	; ø
		db    0
		db    0
		db    6
		db 0FAh	; ú
		db    0
		db    0
		db    6
		db 0FAh	; ú
		db    0
		db    0
		db    4
		db 0FCh	; ü
		db    0
		db    0
		db    4
		db 0FCh	; ü
		db    0
		db    0
		db    4
		db 0FCh	; ü
		db    0
		db    0
		db    2
		db 0FEh	; þ
		db    0
		db    0
		db    2
		db 0FEh	; þ
		db    0
		db    0
		db    1
		db 0FFh
		db    0
		db    0
		db    1
		db 0FFh
		db    0
		db    0
		db    1
g_pwBrakeDivTab	dw 0FFh, 100h, 0C0h, 80h, 40h ;	DATA XREF: CvxOpSimdTrack+66r
unk_2B77_692	db 0FFh			; DATA XREF: DoAudioCvx:loc_471_4215r
					; DoAudioCvx+42Bw
		db    0
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    1
		db    0
word_2B77_6A4	dw 270Fh		; DATA XREF: PlaneRotateOp+135r
					; PlaneRotateOp+153w
unk_2B77_6A6	db  0Fh			; DATA XREF: PlaneRotateOp+B7r
					; PlaneRotateOp+CEw
		db  27h	; '
aSimd		db 'simd',0             ; DATA XREF: SetupAeroTrakdata:loc_471_55A3o
aGnam		db 'gnam',0             ; DATA XREF: SetupAeroTrakdata+7Ao
aSimd_0		db 'simd',0             ; DATA XREF: SetupAeroTrakdata:loc_471_5626o
aGsna		db 'gsna',0             ; DATA XREF: SetupAeroTrakdata+FDo
g_pOldInt0	dd 0			; DATA XREF: SetDivZeroHandl+Bw
					; SetDivZeroHandl+7w
word_2B77_6C0	dw 0			; DATA XREF: seg002:0115w
word_2B77_6C2	dw 0			; DATA XREF: seg002:011Bw
word_2B77_6C4	dw 1Eh			; DATA XREF: UpdateFrame+4CBr
		dw 0C8h
		dw 140h
		dw 190h
		dw 212h
		dw 2BCh
		dw 370h
		dw 3C0h
g_arr8GameShapes dw offset g_pGame3DShapes.wNumVerts+420h ; DATA XREF: UpdateFrame+54Dr
					; all the +420/40a/3f4 etc are divisable by 16h, ie sizeof(internal3dshape)
		dw offset g_pGame3DShapes.wNumVerts+40Ah
		dw offset g_pGame3DShapes.wNumVerts+3F4h
		dw offset g_pGame3DShapes.wNumVerts+420h
		dw offset g_pGame3DShapes.wNumVerts+40Ah
		dw offset g_pGame3DShapes.wNumVerts+3F4h
		dw offset g_pGame3DShapes.wNumVerts+420h
		dw offset g_pGame3DShapes.wNumVerts+40Ah
stru_2B77_6E4	db 0FEh, 0FCh, 2, 0FFh,	0FCh, 2, 0, 0FCh, 2, 1,	0FCh, 2	dup(2);	field_0
					; DATA XREF: dseg:0922o
		db 0FCh, 2, 0FEh, 0FDh,	1, 0FFh, 0FDh, 1, 0, 0FDh, 2 dup(1); field_0
		db 0FDh, 1, 2, 0FDh, 1,	2 dup(0FEh), 1,	0FFh, 0FEh, 2 dup(0); field_0
		db 0FEh, 0, 1, 0FEh, 0,	2, 0FEh, 1, 0FEh, 0FFh,	0, 2 dup(0FFh);	field_0
		db 2 dup(0), 0FFh, 0, 1, 0FFh, 0, 2, 0FFh, 0, 0FFh, 2 dup(0); field_0
		db 1, 6	dup(0)		; field_0
stru_2B77_72A	db 2, 0FCh, 2, 1, 0FCh,	2, 0, 0FCh, 2, 0FFh, 0FCh, 2, 0FEh; field_0
					; DATA XREF: dseg:g_pUnk46Tableo
		db 0FCh, 2 dup(2), 0FDh, 2 dup(1), 0FDh, 1, 0, 0FDh, 1;	field_0
		db 0FFh, 0FDh, 1, 0FEh,	0FDh, 1, 2, 0FEh, 2 dup(1), 0FEh; field_0
		db 2 dup(0), 0FEh, 0, 0FFh, 0FEh, 0, 2 dup(0FEh), 1, 2;	field_0
		db 0FFh, 0, 1, 0FFh, 2 dup(0), 0FFh, 0,	2 dup(0FFh), 0;	field_0
		db 0FEh, 0FFh, 0, 1, 2 dup(0), 0FFh, 6 dup(0); field_0
stru_2B77_770	db 4, 0FEh, 2, 4, 0FFh,	2, 4, 0, 2, 4, 1, 2, 4,	2 dup(2); field_0
					; DATA XREF: dseg:0916o
		db 3, 0FEh, 1, 3, 0FFh,	1, 3, 0, 1, 3, 2 dup(1), 3, 2; field_0
		db 1, 2, 0FEh, 1, 2, 0FFh, 0, 2, 2 dup(0), 2, 1, 0, 2 dup(2); field_0
		db 2 dup(1), 0FEh, 0, 1, 0FFh, 0, 1, 2 dup(0), 2 dup(1); field_0
		db 0, 2	dup(2),	2 dup(0), 0FFh,	2 dup(0), 1, 5 dup(0); field_0
stru_2B77_7B6	db 4, 2	dup(2),	4, 1, 2, 4, 0, 2, 4, 0FFh, 2, 4, 0FEh; field_0
					; DATA XREF: dseg:0918o
		db 2, 3, 2, 1, 3, 2 dup(1), 3, 0, 1, 3,	0FFh, 1, 3, 0FEh; field_0
		db 1, 2	dup(2),	1, 2, 1, 0, 2, 2 dup(0), 2, 0FFh, 0, 2;	field_0
		db 0FEh, 2 dup(1), 2, 0, 2 dup(1), 0, 1, 2 dup(0), 1, 0FFh; field_0
		db 0, 1, 0FEh, 2 dup(0), 1, 2 dup(0), 0FFh, 5 dup(0); field_0
stru_2B77_7FC	db 2, 4, 2, 1, 4, 2, 0,	4, 2, 0FFh, 4, 2, 0FEh,	4, 2 dup(2); field_0
					; DATA XREF: dseg:091Ao
		db 3, 2	dup(1),	3, 1, 0, 3, 1, 0FFh, 3,	1, 0FEh, 3, 1; field_0
		db 2 dup(2), 0,	1, 2, 2	dup(0),	2, 0, 0FFh, 2, 0, 0FEh;	field_0
		db 2, 1, 2, 1, 0, 2 dup(1), 2 dup(0), 1, 0, 0FFh, 1, 0;	field_0
		db 0FEh, 1, 0, 1, 2 dup(0), 0FFh, 6 dup(0); field_0
stru_2B77_842	db 0FEh, 4, 2, 0FFh, 4,	2, 0, 4, 2, 1, 4, 2 dup(2), 4; field_0
					; DATA XREF: dseg:091Co
		db 2, 0FEh, 3, 1, 0FFh,	3, 1, 0, 3, 2 dup(1), 3, 1, 2; field_0
		db 3, 1, 0FEh, 2, 1, 0FFh, 2, 2	dup(0),	2, 0, 1, 2, 0; field_0
		db 2 dup(2), 1,	0FEh, 1, 0, 0FFh, 1, 2 dup(0), 1, 0, 2 dup(1); field_0
		db 0, 2, 1, 0, 0FFh, 2 dup(0), 1, 6 dup(0); field_0
stru_2B77_888	db 0FCh, 2 dup(2), 0FCh, 1, 2, 0FCh, 0,	2, 0FCh, 0FFh; field_0
					; DATA XREF: dseg:091Eo
		db 2, 0FCh, 0FEh, 2, 0FDh, 2, 1, 0FDh, 2 dup(1), 0FDh; field_0
		db 0, 1, 0FDh, 0FFh, 1,	0FDh, 0FEh, 1, 0FEh, 2,	1, 0FEh; field_0
		db 1, 0, 0FEh, 2 dup(0), 0FEh, 0FFh, 0,	2 dup(0FEh), 1;	field_0
		db 0FFh, 2, 0, 0FFh, 1,	0, 0FFh, 2 dup(0), 2 dup(0FFh);	field_0
		db 0, 0FFh, 0FEh, 2 dup(0), 1, 2 dup(0), 0FFh, 5 dup(0); field_0
stru_2B77_8CE	db 0FCh, 0FEh, 2, 0FCh,	0FFh, 2, 0FCh, 0, 2, 0FCh, 1, 2; field_0
					; DATA XREF: dseg:0920o
		db 0FCh, 2 dup(2), 0FDh, 0FEh, 1, 0FDh,	0FFh, 1, 0FDh; field_0
		db 0, 1, 0FDh, 2 dup(1), 0FDh, 2, 1, 2 dup(0FEh), 1, 0FEh; field_0
		db 0FFh, 0, 0FEh, 2 dup(0), 0FEh, 1, 0,	0FEh, 2, 1, 0FFh; field_0
		db 0FEh, 0, 2 dup(0FFh), 0, 0FFh, 2 dup(0), 0FFh, 1, 0;	field_0
		db 0FFh, 2, 2 dup(0), 0FFh, 2 dup(0), 1, 5 dup(0); field_0
g_pUnk46Table	dw offset stru_2B77_72A	; DATA XREF: UpdateFrame+428r
		dw offset stru_2B77_770
		dw offset stru_2B77_7B6
		dw offset stru_2B77_7FC
		dw offset stru_2B77_842
		dw offset stru_2B77_888
		dw offset stru_2B77_8CE
		dw offset stru_2B77_6E4
g_rc		Rectangle <0, 140h, 0, 0C8h> ; DATA XREF: sub_9F1_186+13o
					; sub_9F1_186+21o
unk_2B77_92C	db    2			; DATA XREF: UpdateFrame+5BBr
		db    2
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    2
		db    0
		db    0
		db    0
		db 0FEh	; þ
		db    0
		db    2
		db    0
		db    0
		db    0
		db 0FEh	; þ
		db    0
		db    0
		db    0
		db 0FEh	; þ
		db    0
		db    2
		db    0
		db 0FEh	; þ
		db    0
		db 0FEh	; þ
		db    0
		db    2
		db    0
		db    2
		db    0
		db    2
		db    0
		db 0FEh	; þ
byte_2B77_956	db 0, 0, 0, 0, 1, 1, 1,	1, 2, 2, 2, 2, 3, 3, 3,	3
					; DATA XREF: UpdateFrame+3F7r
g_wRotArray	dw 0			; DATA XREF: UpdateFrame+D58r
		db    0
		db    0
		db    0
		db    1
		db    0
		db    1
		db    0
		db    2
		db    0
		db    2
		db    0
		db    3
		db    0
		db    3
unk_2B77_976	db 0D6h	; Ö		; DATA XREF: UpdateFrame:loc_9F1_E8Fr
		db 0D7h	; ×
		db 0D6h	; Ö
		db 0D7h	; ×
		db 0D6h	; Ö
		db 0D7h	; ×
		db 0D6h	; Ö
		db 0D7h	; ×
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db    1
		db    0
		db    0
		db    0
		db    1
		db    0
unk_2B77_98C	db    0			; DATA XREF: SkyBoxOp+40Ar
					; SkyBoxOp+444r
		db    1
		db    1
		db    1
		db  80h	; €
		db    0
		db  80h	; €
		db    1
		db  80h	; €
		db    2
		db  80h	; €
		db    3
word_2B77_998	dw 3C00h		; DATA XREF: DoTransformShpTrk+13r
					; DoTransformShpTrk+1A8r ...
word_2B77_99A	dw 4EE8h		; DATA XREF: DoTransformShpTrk+27r
					; DoTransformShpTrk+1B3r ...
word_2B77_99C	dw 0F510h		; DATA XREF: DoTransformShpTrk+Br
					; DoTransformShpTrk+1C8r ...
word_2B77_99E	dw 3C00h		; DATA XREF: DoTransformShpTrk+10r
word_2B77_9A0	dw 0AF0h		; DATA XREF: DoTransformShpTrk+24r
word_2B77_9A2	dw 2AD0h		; DATA XREF: DoTransformShpTrk+8r
g_vec		Vector3D <0, 0D88Ch, 4178h> ; DATA XREF: DoTransformShpTrk+54o
g_rc2		Rectangle <0, 140h, 0, 0C8h> ; DATA XREF: DoTransformShpTrk+12Eo
aDm1		db 'dm1',0              ; DATA XREF: DrawIngameText:loc_9F1_323Eo
aDm2		db 'dm2',0              ; DATA XREF: DrawIngameText+77o
aPre		db 'pre',0              ; DATA XREF: DrawIngameText+C9o
aSe1		db 'se1',0              ; DATA XREF: DrawIngameText:loc_9F1_3324o
aSe2		db 'se2',0              ; DATA XREF: DrawIngameText+15Do
aWww		db 'www',0              ; DATA XREF: DrawIngameText:loc_9F1_343Ao
aOpp		db 'opp',0              ; DATA XREF: DrawIngameText+296o
aOpp_0		db 'opp',0
aPen		db 'pen',0              ; DATA XREF: DrawIngameText:loc_9F1_351Co
aRpl		db 'rpl',0              ; DATA XREF: DrawIngameText+39Do
aF		db '”',0
		db 0ACh	; ¬
		db    0
		db  5Dh	; ]
		db    0
		db  6Ch	; l
		db    0
unk_2B77_9E2	db  44h	; D		; DATA XREF: DrawIngameText+286o
		db    0
		db  5Ch	; \
		db    0
		db  71h	; q
		db    0
		db  80h	; €
		db    0
		db 0E4h	; ä
		db    0
		db 0FCh	; ü
		db    0
		db  71h	; q
		db    0
		db  80h	; €
		db    0
aCrak		db 'crak',0             ; DATA XREF: DoCracCinfRes+8o
aCinf		db 'cinf',0             ; DATA XREF: DoCracCinfRes+22o
aScensce2sce3sc	db 'scensce2sce3sce4',0 ; DATA XREF: LoadSkybox+57o
aSdgame2	db 'sdgame2',0          ; DATA XREF: LoadSdgame2Shap+8o
aEx01ex02ex03le	db 'ex01ex02ex03leftrigh',0 ; DATA XREF: LoadSdgame2Shap+23o
aTitle		db 'title',0            ; DATA XREF: SetupIntro+Do
aLogolog2brav	db 'logolog2brav',0     ; DATA XREF: SetupIntro+25o
		db    0
aCarcoun_0	db 'carcoun',0          ; DATA XREF: SetupIntro+11Eo
g_pwUnk8_4	dw 0, 140h, 0, 0C8h	; DATA XREF: sub_9F1_3F96+1Bo
					; sub_9F1_3F96+1D2r ...
word_2B77_A4E	dw 1			; DATA XREF: sub_9F1_3F96+25Er
					; sub_9F1_3F96:loc_9F1_4234w ...
aBarn		db 'barn',0             ; DATA XREF: LoadGame3dShpes+60o
					; LoadGame3dShpes+89o
aZbrn		db 'zbrn',0
aBrid		db 'brid',0
aZbri		db 'zbri',0
aBtur		db 'btur',0
aZbtu		db 'zbtu',0
aChi1		db 'chi1',0
aZch1		db 'zch1',0
aChi2		db 'chi2',0
aZch2		db 'zch2',0
aElrd		db 'elrd',0
aZelr		db 'zelr',0
aFini		db 'fini',0
aZfin		db 'zfin',0
aGass		db 'gass',0
aZgas		db 'zgas',0
aLban		db 'lban',0
aZlba		db 'zlba',0
aLoop		db 'loop',0
aZloo		db 'zloo',0
aOffi		db 'offi',0
aZoff		db 'zoff',0
aPipe		db 'pipe',0
aZpip		db 'zpip',0
aRamp		db 'ramp',0
aZram		db 'zram',0
aRban		db 'rban',0
aZrba		db 'zrba',0
aRdup		db 'rdup',0
aZrdu		db 'zrdu',0
aRoad		db 'road',0
aZroa		db 'zroa',0
aStur		db 'stur',0
aZstu		db 'zstu',0
aTenn		db 'tenn',0
aZten		db 'zten',0
aTunn		db 'tunn',0
aZtun		db 'ztun',0
aTurn		db 'turn',0
aZtur		db 'ztur',0
aGoui		db 'goui',0
aGouo		db 'gouo',0
aGoup		db 'goup',0
aHigh		db 'high',0
aLakc		db 'lakc',0
aLake		db 'lake',0
aCld1		db 'cld1',0
aCld2		db 'cld2',0
aCld3		db 'cld3',0
aSigl		db 'sigl',0
aSigr		db 'sigr',0
aTree		db 'tree',0
aInte		db 'inte',0
aZint		db 'zint',0
aOffl		db 'offl',0
aZofl		db 'zofl',0
aOffr		db 'offr',0
aZofr		db 'zofr',0
aPalm		db 'palm',0
aZpal		db 'zpal',0
aBank		db 'bank',0
aZban		db 'zban',0
aSofl		db 'sofl',0
aZsol		db 'zsol',0
aSofr		db 'sofr',0
aZsor		db 'zsor',0
aSram		db 'sram',0
aZsra		db 'zsra',0
aSelr		db 'selr',0
aZser		db 'zser',0
aElsp		db 'elsp',0
aZesp		db 'zesp',0
aCact		db 'cact',0
aCact_0		db 'cact',0
aSpip		db 'spip',0
aZspi		db 'zspi',0
aSest		db 'sest',0
aZses		db 'zses',0
aWroa		db 'wroa',0
aZwro		db 'zwro',0
aBarr		db 'barr',0
aZbar		db 'zbar',0
aLco0		db 'lco0',0
aZlco		db 'zlco',0
aRco0		db 'rco0',0
aZrco		db 'zrco',0
aGwro		db 'gwro',0
aZgwr		db 'zgwr',0
aLco1		db 'lco1',0
aRco1		db 'rco1',0
aLoo1		db 'loo1',0
aHig1		db 'hig1',0
aHig2		db 'hig2',0
aHig3		db 'hig3',0
aWind		db 'wind',0
aZwin		db 'zwin',0
aBoat		db 'boat',0
aZboa		db 'zboa',0
aRest		db 'rest',0
aZres		db 'zres',0
aHpip		db 'hpip',0
aZhpi		db 'zhpi',0
aVcor		db 'vcor',0
aZvco		db 'zvco',0
aTun2		db 'tun2',0
aPip2		db 'pip2',0
aFenc		db 'fenc',0
aZfen		db 'zfen',0
aCfen		db 'cfen',0
aZcfe		db 'zcfe',0
aFlag		db 'flag',0
aTruk		db 'truk',0
aExp0		db 'exp0',0
aExp1		db 'exp1',0
aExp2		db 'exp2',0
aExp3		db 'exp3',0
g_shpArr42	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
					; dseg:stru_2B77_1CC4o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 0C8h, 0, 0, 0,	0, 0, 0C8h, 0, 0, 0, 0B2h
		db 0FEh, 38h, 0FFh, 0, 0, 4Eh, 1
g_shpArr42_2	db 88h,	0FFh, 0FFh, 0FFh, 80h, 0, 78h, 0, 0FFh,	0FFh, 80h
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0, 88h, 0FFh, 0FFh, 0FFh, 4Eh, 1, 78h, 0, 0FFh, 0FFh
		db 4Eh,	1, 0C8h, 0, 0, 0, 0, 0,	0C8h, 0, 0, 0, 0B2h, 0FEh
		db 38h,	0FFh, 0, 0, 4Eh, 1
g_shpArr30	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 78h, 0, 0A5h, 0, 0, 0
g_shpArr42_3	db 0ACh, 0FFh, 0FFh, 0FFh, 0B2h, 0FEh, 54h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0B2h, 0FEh, 0ACh, 0FFh, 0FFh, 0FFh, 4Eh, 1, 54h, 0
		db 0FFh, 0FFh, 4Eh, 1, 73h, 0, 0B4h, 0,	0, 0, 0C8h, 0
		db 0, 0, 0B2h, 0FEh, 38h, 0FFh,	0, 0, 4Eh, 1
g_shpArr17	db 0ACh, 0FFh, 23h, 0, 0B2h, 0FEh, 8Dh,	0FFh, 58h, 0, 0B2h
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0FEh, 0ACh, 0FFh, 23h, 0, 4Eh
g_shpArr25	db 1, 8Dh, 0FFh, 58h, 0, 4Eh, 1, 73h, 0, 0B4h, 0, 0, 0
		db 0C8h, 0, 0, 0, 0B2h,	0FEh, 38h, 0FFh, 0, 0, 4Eh, 1
g_shpArr42_4	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 0C8h, 0, 0, 0,	0C8h, 0, 0C8h, 0, 0, 0
		db 0B2h, 0FEh, 38h, 0FFh, 0, 0,	4Eh, 1
g_shpArr54	db 88h,	1, 0FFh, 0FFh, 64h, 0FDh, 78h, 2, 0FFh,	0FFh, 64h
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0FDh, 88h, 1, 0FFh, 0FFh, 0,	0, 78h,	2, 0FFh, 0FFh
		db 0, 0, 88h, 1, 0FFh, 0FFh, 9Ch, 2, 78h, 2, 0FFh, 0FFh
		db 9Ch,	2, 2Ch,	1, 0, 0, 0C8h, 0, 0C8h,	2, 0, 0, 64h, 0FDh
		db 0C8h, 0FEh, 0, 0, 9Ch, 2
g_shpArr54_2	db 88h,	0FDh, 0FFh, 0FFh, 64h, 0FDh, 78h, 0FEh,	0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1CC4o
					; dseg:stru_2B77_1F80o
		db 64h,	0FDh, 88h, 0FDh, 0FFh, 0FFh, 0,	0, 78h,	0FEh, 0FFh
		db 0FFh, 0, 0, 88h, 0FDh, 0FFh,	0FFh, 9Ch, 2, 78h, 0FEh
		db 0FFh, 0FFh, 9Ch, 2, 0D4h, 0FEh, 0, 0, 0C8h, 0, 0C8h
		db 0FEh, 0, 0, 64h, 0FDh, 38h, 0FDh, 0,	0, 9Ch,	2
g_shpArr66	db 7Bh,	0FFh, 0FFh, 0FFh, 64h, 0FEh, 63h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
					; dseg:stru_2B77_1CC4o
		db 0A1h, 0FEh, 54h, 0FFh, 0FFh,	0FFh, 0C3h, 0FEh, 24h
		db 0, 0FFh, 0FFh, 3Bh, 0FFh, 15h, 0FFh,	0FFh, 0FFh, 15h
		db 0FFh, 0BFh, 0FFh, 0FFh, 0FFh, 0BFh, 0FFh, 0C5h, 0FEh
		db 0FFh, 0FFh, 53h, 0FFh, 3Eh, 0FFh, 0FFh, 0FFh, 22h, 0
		db 66h,	0FEh, 0FFh, 0FFh, 7Ah, 0FFh, 0A5h, 0FEh, 0FFh
		db 0FFh, 62h, 0, 38h, 0FFh, 0, 0, 0C8h,	0
g_shpArr66_2	db 9Dh,	0FFh, 0FFh, 0FFh, 0A1h,	0FEh, 85h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 64h,	0FEh, 0DCh, 0FFh, 0FFh,	0FFh, 3Bh, 0FFh, 0ACh
		db 0, 0FFh, 0FFh, 0C3h,	0FEh, 41h, 0, 0FFh, 0FFh, 0BFh
		db 0FFh, 0EBh, 0, 0FFh,	0FFh, 15h, 0FFh, 0C2h, 0, 0FFh
		db 0FFh, 22h, 0, 3Bh, 1, 0FFh, 0FFh, 53h, 0FFh,	5Bh, 1
		db 0FFh, 0FFh, 62h, 0, 9Ah, 1, 0FFh, 0FFh, 7Ah,	0FFh, 0C8h
		db 0, 0, 0, 0C8h, 0
g_shpArr210	db 83h,	1, 0FFh, 0FFh, 7Ah, 0FCh, 72h, 2, 0FFh,	0FFh, 8Eh
					; DATA XREF: dseg:stru_2B77_1A08o
					; dseg:stru_2B77_1CC4o
		db 0FCh, 73h, 1, 0FFh, 0FFh, 0F2h, 0FCh, 60h, 2, 0FFh
		db 0FFh, 1Bh, 0FDh, 59h, 1, 0FFh, 0FFh,	69h, 0FDh, 41h
		db 2, 0FFh, 0FFh, 0A6h,	0FDh, 35h, 1, 0FFh, 0FFh, 0DDh
		db 0FDh, 17h, 2, 0FFh, 0FFh, 2Eh, 0FEh,	4, 1, 0FFh, 0FFh
		db 56h,	0FEh, 0DDh, 1, 0FFh, 0FFh, 0BBh, 0FEh, 0CCh, 0
		db 0FFh, 0FFh, 0C1h, 0FEh, 9Ch,	1, 0FFh, 0FFh, 39h, 0FFh
		db 8Bh,	0, 0FFh, 0FFh, 28h, 0FFh, 50h, 1, 0FFh,	0FFh, 0B1h
		db 0FFh, 41h, 0, 0FFh, 0FFh, 89h, 0FFh,	0FAh, 0, 0FFh
		db 0FFh, 22h, 0, 0E9h, 0FFh, 0FFh, 0FFh, 0E9h, 0FFh, 93h
		db 0, 0FFh, 0FFh, 93h, 0, 90h, 0FFh, 0FFh, 0FFh, 3Ch, 0
		db 2Ah,	0, 0FFh, 0FFh, 0F3h, 0,	2Fh, 0FFh, 0FFh, 0FFh
		db 86h,	0, 0BAh, 0FFh, 0FFh, 0FFh, 4Ah,	1, 0C9h, 0FEh
		db 0FFh, 0FFh, 0C7h, 0,	42h, 0FFh, 0FFh, 0FFh, 97h, 1
		db 5Dh,	0FEh, 0FFh, 0FFh, 0, 1,	0C4h, 0FEh, 0FFh, 0FFh
		db 0D9h, 1, 0E5h, 0FDh,	0FFh, 0FFh, 32h, 1, 37h, 0FEh
		db 0FFh, 0FFh, 14h, 2, 71h, 0FDh, 0FFh,	0FFh, 57h, 1, 0B0h
		db 0FDh, 0FFh, 0FFh, 3Fh, 2, 0FBh, 0FCh, 0FFh, 0FFh, 72h
		db 1, 25h, 0FDh, 0FFh, 0FFh, 5Eh, 2, 82h, 0FCh,	0FFh, 0FFh
		db 82h,	1, 98h,	0FCh, 0FFh, 0FFh, 71h, 2, 2Ch, 1, 0, 0
		db 0C8h, 0
g_shpArr210_2	db 8Eh,	0FDh, 0FFh, 0FFh, 8Eh, 0FCh, 7Dh, 0FEh,	0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1CC4o
					; dseg:stru_2B77_1F80o
		db 7Ah,	0FCh, 0A0h, 0FDh, 0FFh,	0FFh, 1Bh, 0FDh, 8Dh, 0FEh
		db 0FFh, 0FFh, 0F2h, 0FCh, 0BFh, 0FDh, 0FFh, 0FFh, 0A6h
		db 0FDh, 0A7h, 0FEh, 0FFh, 0FFh, 69h, 0FDh, 0E9h, 0FDh
		db 0FFh, 0FFh, 2Eh, 0FEh, 0CBh,	0FEh, 0FFh, 0FFh, 0DDh
		db 0FDh, 23h, 0FEh, 0FFh, 0FFh,	0BBh, 0FEh, 0FCh, 0FEh
		db 0FFh, 0FFh, 56h, 0FEh, 64h, 0FEh, 0FFh, 0FFh, 39h, 0FFh
		db 34h,	0FFh, 0FFh, 0FFh, 0C1h,	0FEh, 0B0h, 0FEh, 0FFh
		db 0FFh, 0B1h, 0FFh, 75h, 0FFh,	0FFh, 0FFh, 28h, 0FFh
		db 6, 0FFh, 0FFh, 0FFh,	22h, 0,	0BFh, 0FFh, 0FFh, 0FFh
		db 89h,	0FFh, 6Dh, 0FFh, 0FFh, 0FFh, 93h, 0, 17h, 0, 0FFh
		db 0FFh, 0E9h, 0FFh, 0D6h, 0FFh, 0FFh, 0FFh, 0F3h, 0, 70h
		db 0, 0FFh, 0FFh, 3Ch, 0, 46h, 0, 0FFh,	0FFh, 4Ah, 1, 0D1h
		db 0, 0FFh, 0FFh, 86h, 0, 0BEh,	0, 0FFh, 0FFh, 97h, 1
		db 37h,	1, 0FFh, 0FFh, 0C7h, 0,	3Ch, 1,	0FFh, 0FFh, 0D9h
		db 1, 0A3h, 1, 0FFh, 0FFh, 0, 1, 0C9h, 1, 0FFh,	0FFh, 14h
		db 2, 1Bh, 2, 0FFh, 0FFh, 32h, 1, 50h, 2, 0FFh,	0FFh, 3Fh
		db 2, 8Fh, 2, 0FFh, 0FFh, 57h, 1, 0DBh,	2, 0FFh, 0FFh
		db 5Eh,	2, 5, 3, 0FFh, 0FFh, 72h, 1, 68h, 3, 0FFh, 0FFh
		db 71h,	2, 7Eh,	3, 0FFh, 0FFh, 82h, 1, 0D4h, 0FEh, 0, 0
		db 0C8h, 0
g_shpArr42_5	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 78h, 0, 0C2h, 1, 0, 0,	8Ch, 0,	0C2h, 1
		db 0B2h, 0FEh, 74h, 0FFh, 0C2h,	1, 4Eh,	1
g_shpArr42_6	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 78h, 0, 0C2h, 1, 0C8h,	0, 8Ch,	0, 0C2h
		db 1, 0B2h, 0FEh, 74h, 0FFh, 0C2h, 1, 4Eh, 1
g_shpArr210_3	db 83h,	1, 0FFh, 0FFh, 7Ah, 0FCh, 72h, 2, 0FFh,	0FFh, 8Eh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0FCh, 73h, 1, 0FFh, 0FFh, 0F2h, 0FCh, 60h, 2, 0FFh
		db 0FFh, 1Bh, 0FDh, 59h, 1, 0FFh, 0FFh,	69h, 0FDh, 41h
		db 2, 0FFh, 0FFh, 0A6h,	0FDh, 35h, 1, 0FFh, 0FFh, 0DDh
		db 0FDh, 17h, 2, 0FFh, 0FFh, 2Eh, 0FEh,	4, 1, 0FFh, 0FFh
		db 56h,	0FEh, 0DDh, 1, 0FFh, 0FFh, 0BBh, 0FEh, 0CCh, 0
		db 0FFh, 0FFh, 0C1h, 0FEh, 9Ch,	1, 0FFh, 0FFh, 39h, 0FFh
		db 8Bh,	0, 0FFh, 0FFh, 28h, 0FFh, 50h, 1, 0FFh,	0FFh, 0B1h
		db 0FFh, 41h, 0, 0FFh, 0FFh, 89h, 0FFh,	0FAh, 0, 0FFh
		db 0FFh, 22h, 0, 0E9h, 0FFh, 0FFh, 0FFh, 0E9h, 0FFh, 93h
		db 0, 0FFh, 0FFh, 93h, 0, 90h, 0FFh, 0FFh, 0FFh, 3Ch, 0
		db 2Ah,	0, 0FFh, 0FFh, 0F3h, 0,	2Fh, 0FFh, 0FFh, 0FFh
		db 86h,	0, 0BAh, 0FFh, 0FFh, 0FFh, 4Ah,	1, 0C9h, 0FEh
		db 0FFh, 0FFh, 0C7h, 0,	42h, 0FFh, 0FFh, 0FFh, 97h, 1
		db 5Dh,	0FEh, 0FFh, 0FFh, 0, 1,	0C4h, 0FEh, 0FFh, 0FFh
		db 0D9h, 1, 0E5h, 0FDh,	0FFh, 0FFh, 32h, 1, 37h, 0FEh
		db 0FFh, 0FFh, 14h, 2, 71h, 0FDh, 0FFh,	0FFh, 57h, 1, 0B0h
		db 0FDh, 0FFh, 0FFh, 3Fh, 2, 0FBh, 0FCh, 0FFh, 0FFh, 72h
		db 1, 25h, 0FDh, 0FFh, 0FFh, 5Eh, 2, 82h, 0FCh,	0FFh, 0FFh
		db 82h,	1, 98h,	0FCh, 0FFh, 0FFh, 71h, 2, 0A0h,	0, 0C2h
		db 1, 0A0h, 0
g_shpArr210_4	db 6Fh,	1, 0FFh, 0FFh, 6Dh, 0FCh, 58h, 2, 0FFh,	0FFh, 7Eh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0FCh, 55h, 1, 0FFh, 0FFh, 0D8h, 0FCh, 37h, 2, 0FFh
		db 0FFh, 0FAh, 0FCh, 37h, 1, 0FFh, 0FFh, 41h, 0FDh, 12h
		db 2, 0FFh, 0FFh, 74h, 0FDh, 13h, 1, 0FFh, 0FFh, 0A6h
		db 0FDh, 0E8h, 1, 0FFh,	0FFh, 0EAh, 0FDh, 0E8h,	0, 0FFh
		db 0FFh, 6, 0FEh, 0B6h,	1, 0FFh, 0FFh, 5Bh, 0FEh, 0A5h
		db 0, 0FFh, 0FFh, 78h, 0FEh, 6Ah, 1, 0FFh, 0FFh, 0E2h
		db 0FEh, 58h, 0, 0FFh, 0FFh, 0E2h, 0FEh, 14h, 1, 0FFh
		db 0FFh, 62h, 0FFh, 3, 0, 0FFh,	0FFh, 48h, 0FFh, 0B6h
		db 0, 0FFh, 0FFh, 0DDh,	0FFh, 0ABh, 0FFh, 0FFh,	0FFh, 0ABh
		db 0FFh, 55h, 0, 0FFh, 0FFh, 55h, 0, 4Ah, 0FFh,	0FFh, 0FFh
		db 23h,	0, 0FDh, 0FFh, 0FFh, 0FFh, 0B8h, 0, 0ECh, 0FEh
		db 0FFh, 0FFh, 9Eh, 0, 0A8h, 0FFh, 0FFh, 0FFh, 1Eh, 1
		db 96h,	0FEh, 0FFh, 0FFh, 1Eh, 1, 5Bh, 0FFh, 0FFh, 0FFh
		db 88h,	1, 4Ah,	0FEh, 0FFh, 0FFh, 0A5h,	1, 18h,	0FFh, 0FFh
		db 0FFh, 0FAh, 1, 18h, 0FEh, 0FFh, 0FFh, 16h, 2, 0EDh
		db 0FEh, 0FFh, 0FFh, 5Ah, 2, 0EEh, 0FDh, 0FFh, 0FFh, 8Ch
		db 2, 0C9h, 0FEh, 0FFh,	0FFh, 0BFh, 2, 0C9h, 0FDh, 0FFh
		db 0FFh, 6, 3, 0ABh, 0FEh, 0FFh, 0FFh, 28h, 3, 0A8h, 0FDh
		db 0FFh, 0FFh, 82h, 3, 91h, 0FEh, 0FFh,	0FFh, 93h, 3, 7Dh
		db 0, 0, 0, 7Dh, 0
g_shpArr210_5	db 0A8h, 0FDh, 0FFh, 0FFh, 7Eh,	0FCh, 91h, 0FEh, 0FFh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0FFh, 6Dh, 0FCh, 0C9h, 0FDh,	0FFh, 0FFh, 0FAh, 0FCh
		db 0ABh, 0FEh, 0FFh, 0FFh, 0D8h, 0FCh, 0EEh, 0FDh, 0FFh
		db 0FFh, 74h, 0FDh, 0C9h, 0FEh,	0FFh, 0FFh, 41h, 0FDh
		db 18h,	0FEh, 0FFh, 0FFh, 0EAh,	0FDh, 0EDh, 0FEh, 0FFh
		db 0FFh, 0A6h, 0FDh, 4Ah, 0FEh,	0FFh, 0FFh, 5Bh, 0FEh
		db 18h,	0FFh, 0FFh, 0FFh, 6, 0FEh, 96h,	0FEh, 0FFh, 0FFh
		db 0E2h, 0FEh, 5Bh, 0FFh, 0FFh,	0FFh, 78h, 0FEh, 0ECh
		db 0FEh, 0FFh, 0FFh, 62h, 0FFh,	0A8h, 0FFh, 0FFh, 0FFh
		db 0E2h, 0FEh, 4Ah, 0FFh, 0FFh,	0FFh, 0DDh, 0FFh, 0FDh
		db 0FFh, 0FFh, 0FFh, 48h, 0FFh,	0ABh, 0FFh, 0FFh, 0FFh
		db 55h,	0, 55h,	0, 0FFh, 0FFh, 0ABh, 0FFh, 3, 0, 0FFh
		db 0FFh, 0B8h, 0, 0B6h,	0, 0FFh, 0FFh, 23h, 0, 58h, 0
		db 0FFh, 0FFh, 1Eh, 1, 14h, 1, 0FFh, 0FFh, 9Eh,	0, 0A5h
		db 0, 0FFh, 0FFh, 88h, 1, 6Ah, 1, 0FFh,	0FFh, 1Eh, 1, 0E8h
		db 0, 0FFh, 0FFh, 0FAh,	1, 0B6h, 1, 0FFh, 0FFh,	0A5h, 1
		db 13h,	1, 0FFh, 0FFh, 5Ah, 2, 0E8h, 1,	0FFh, 0FFh, 16h
		db 2, 37h, 1, 0FFh, 0FFh, 0BFh,	2, 12h,	2, 0FFh, 0FFh
		db 8Ch,	2, 55h,	1, 0FFh, 0FFh, 28h, 3, 37h, 2, 0FFh, 0FFh
		db 6, 3, 6Fh, 1, 0FFh, 0FFh, 93h, 3, 58h, 2, 0FFh, 0FFh
		db 82h,	3, 7Dh,	0, 0, 0, 83h, 0FFh
g_shpArr42_7	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 78h, 0, 0C2h, 1, 0F4h,	1, 8Ch,	0, 51h
		db 0, 0B2h, 0FEh, 74h, 0FFh, 77h, 1, 4Eh, 1
g_shpArr294	db 52h,	0FFh, 0, 0, 9Ch, 0FCh, 64h, 0, 0, 0, 9Ch, 0FCh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 1Eh,	0FFh, 0, 0, 40h, 0FDh, 50h, 0, 0, 0, 40h, 0FDh
		db 0ECh, 0FEh, 0, 0, 0E8h, 0FDh, 3Ch, 0, 0, 0, 0E8h, 0FDh
		db 0C0h, 0FEh, 0, 0, 98h, 0FEh,	28h, 0,	0, 0, 98h, 0FEh
		db 97h,	0FEh, 0, 0, 4Eh, 0FFh, 14h, 0, 0, 0, 4Eh, 0FFh
		db 70h,	0FEh, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 70h, 0FEh
		db 87h,	0, 0E0h, 0, 0, 0, 87h, 0, 0E0h,	0, 0A0h, 0FEh
		db 2Bh,	1, 85h,	1, 2Eh,	0, 2Bh,	1, 85h,	1, 0D0h, 0FEh
		db 0Ch,	2, 0C1h, 1, 5Fh, 0, 0Ch, 2, 0C1h, 1, 0F2h, 0FEh
		db 0EDh, 2, 85h, 1, 81h, 0, 0EDh, 2, 85h, 1, 15h, 0FFh
		db 92h,	3, 0E1h, 0, 0A4h, 0, 92h, 3, 0E1h, 0, 38h, 0FFh
		db 0CFh, 3, 0, 0, 0C8h,	0, 0CFh, 3, 0, 0, 5Ch, 0FFh, 92h
		db 3, 1Fh, 0FFh, 0EBh, 0, 92h, 3, 1Fh, 0FFh, 7Fh, 0FFh
		db 0EDh, 2, 7Bh, 0FEh, 0Eh, 1, 0EDh, 2,	7Bh, 0FEh, 0A1h
		db 0FFh, 0Ch, 2, 3Fh, 0FEh, 30h, 1, 0Ch, 2, 3Fh, 0FEh
		db 0D2h, 0FFh, 2Bh, 1, 7Bh, 0FEh, 60h, 1, 2Bh, 1, 7Bh
		db 0FEh, 0, 0, 87h, 0, 20h, 0FFh, 90h, 1, 87h, 0, 20h
		db 0FFh, 0, 0, 0, 0, 0,	0, 90h,	1, 0, 0, 0, 0, 0ECh, 0FFh
		db 0, 0, 0B2h, 0, 69h, 1, 0, 0,	0B2h, 0, 0D8h, 0FFh, 0
		db 0, 68h, 1, 40h, 1, 0, 0, 68h, 1, 0C4h, 0FFh,	0, 0, 18h
		db 2, 14h, 1, 0, 0, 18h, 2, 0B0h, 0FFh,	0, 0, 0C0h, 2
		db 0E2h, 0, 0, 0, 0C0h,	2, 9Ch,	0FFh, 0, 0, 64h, 3, 0AEh
		db 0, 0, 0, 64h, 3, 0E0h, 1, 0,	0, 0, 0, 0C8h, 0, 0, 0
		db 64h,	0FDh, 38h, 0FFh, 0, 0, 9Ch, 2
g_shpArr174	db 0E1h, 0FFh, 0, 0, 7Eh, 0FCh,	1Fh, 0,	0, 0, 7Eh, 0FCh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 1Fh,	0, 0, 0, 13h, 0FDh, 54h, 0, 23h, 0, 13h, 0FDh
		db 54h,	0, 23h,	0, 0A8h, 0FDh, 73h, 0, 58h, 0, 0A8h, 0FDh
		db 73h,	0, 58h,	0, 3Dh,	0FEh, 73h, 0, 97h, 0, 3Dh, 0FEh
		db 73h,	0, 97h,	0, 0D4h, 0FEh, 54h, 0, 0CCh, 0,	0D4h, 0FEh
		db 54h,	0, 0CCh, 0, 67h, 0FFh, 1Fh, 0, 0EBh, 0,	67h, 0FFh
		db 1Fh,	0, 0EBh, 0, 0, 0, 0E1h,	0FFh, 0EBh, 0, 0, 0, 0E1h
		db 0FFh, 0EBh, 0, 99h, 0, 0ACh,	0FFh, 0CCh, 0, 99h, 0
		db 0ACh, 0FFh, 0CCh, 0,	2Ch, 1,	8Dh, 0FFh, 97h,	0, 2Ch
		db 1, 8Dh, 0FFh, 97h, 0, 0C3h, 1, 8Dh, 0FFh, 58h, 0, 0C3h
		db 1, 8Dh, 0FFh, 58h, 0, 58h, 2, 0ACh, 0FFh, 23h, 0, 58h
		db 2, 0ACh, 0FFh, 23h, 0, 0EDh,	2, 0E1h, 0FFh, 0, 0, 0EDh
		db 2, 0E1h, 0FFh, 0, 0,	82h, 3,	1Fh, 0,	0, 0, 82h, 3, 0E0h
		db 1, 0, 0, 0, 0, 0C8h,	0, 0, 0, 64h, 0FDh, 38h, 0FFh
		db 0, 0, 9Ch, 2
g_shpArr42_8	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 38h, 0FFh, 0, 0, 0, 0,	78h, 0,	82h, 0
		db 0B2h, 0FEh, 74h, 0FFh, 0, 0,	4Eh, 1
g_shpArr42_9	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 38h, 0FFh, 0, 0, 0, 0,	78h, 0,	82h, 0
		db 0B2h, 0FEh, 74h, 0FFh, 0, 0,	4Eh, 1
g_shpArr42_10	db 88h,	0FFh, 0FFh, 0FFh, 0B2h,	0FEh, 78h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1A08o
		db 0B2h, 0FEh, 88h, 0FFh, 0FFh,	0FFh, 4Eh, 1, 78h, 0, 0FFh
		db 0FFh, 4Eh, 1, 0C8h, 0, 0, 0,	0, 0, 8Ch, 0, 0, 0, 0B2h
		db 0FEh, 88h, 0FFh, 7Bh, 0, 4Eh, 1
g_shpArr210_6	db 83h,	1, 0FFh, 0FFh, 7Ah, 0FCh, 72h, 2, 0FFh,	0FFh, 8Eh
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0FCh, 73h, 1, 0FFh, 0FFh, 0F2h, 0FCh, 60h, 2, 0FFh
		db 0FFh, 1Bh, 0FDh, 59h, 1, 0FFh, 0FFh,	69h, 0FDh, 41h
		db 2, 0FFh, 0FFh, 0A6h,	0FDh, 35h, 1, 0FFh, 0FFh, 0DDh
		db 0FDh, 17h, 2, 0FFh, 0FFh, 2Eh, 0FEh,	4, 1, 0FFh, 0FFh
		db 56h,	0FEh, 0DDh, 1, 0FFh, 0FFh, 0BBh, 0FEh, 0CCh, 0
		db 0FFh, 0FFh, 0C1h, 0FEh, 9Ch,	1, 0FFh, 0FFh, 39h, 0FFh
		db 8Bh,	0, 0FFh, 0FFh, 28h, 0FFh, 50h, 1, 0FFh,	0FFh, 0B1h
		db 0FFh, 41h, 0, 0FFh, 0FFh, 89h, 0FFh,	0FAh, 0, 0FFh
		db 0FFh, 22h, 0, 0E9h, 0FFh, 0FFh, 0FFh, 0E9h, 0FFh, 93h
		db 0, 0FFh, 0FFh, 93h, 0, 90h, 0FFh, 0FFh, 0FFh, 3Ch, 0
		db 2Ah,	0, 0FFh, 0FFh, 0F3h, 0,	2Fh, 0FFh, 0FFh, 0FFh
		db 86h,	0, 0BAh, 0FFh, 0FFh, 0FFh, 4Ah,	1, 0C9h, 0FEh
		db 0FFh, 0FFh, 0C7h, 0,	42h, 0FFh, 0FFh, 0FFh, 97h, 1
		db 5Dh,	0FEh, 0FFh, 0FFh, 0, 1,	0C4h, 0FEh, 0FFh, 0FFh
		db 0D9h, 1, 0E5h, 0FDh,	0FFh, 0FFh, 32h, 1, 37h, 0FEh
		db 0FFh, 0FFh, 14h, 2, 71h, 0FDh, 0FFh,	0FFh, 57h, 1, 0B0h
		db 0FDh, 0FFh, 0FFh, 3Fh, 2, 0FBh, 0FCh, 0FFh, 0FFh, 72h
		db 1, 25h, 0FDh, 0FFh, 0FFh, 5Eh, 2, 82h, 0FCh,	0FFh, 0FFh
		db 82h,	1, 98h,	0FCh, 0FFh, 0FFh, 71h, 2, 0D4h,	0FEh, 0
		db 0, 38h, 0FFh
g_shpArr354	db 88h,	0FDh, 0, 0, 0B2h, 0FCh,	78h, 0FEh, 0, 0, 0B2h
					; DATA XREF: dseg:stru_2B77_1F80o
		db 0FCh, 88h, 0FDh, 0, 0, 0B2h,	0FEh, 78h, 0FEh, 0, 0
		db 0B2h, 0FEh, 88h, 0FDh, 0, 0,	0, 0, 78h, 0FEh, 0, 0
		db 0, 0, 9Dh, 0FDh, 13h, 0, 0A1h, 0, 85h, 0FEh,	13h, 0
		db 64h,	0, 0DCh, 0FDh, 26h, 0, 3Bh, 1, 0ACh, 0FEh, 26h
		db 0, 0C3h, 0, 41h, 0FEh, 39h, 0, 0BFh,	1, 0EBh, 0FEh
		db 39h,	0, 15h,	1, 0C2h, 0FEh, 4Ch, 0, 22h, 2, 3Bh, 0FFh
		db 4Ch,	0, 53h,	1, 5Bh,	0FFh, 5Fh, 0, 62h, 2, 9Ah, 0FFh
		db 5Fh,	0, 7Ah,	1, 0, 0, 72h, 0, 78h, 2, 0, 0, 72h, 0
		db 88h,	1, 0A1h, 0, 85h, 0, 63h, 2, 64h, 0, 85h, 0, 7Bh
		db 1, 3Bh, 1, 98h, 0, 24h, 2, 0C3h, 0, 98h, 0, 54h, 1
		db 0BFh, 1, 0ABh, 0, 0BFh, 1, 15h, 1, 0ABh, 0, 15h, 1
		db 22h,	2, 0BEh, 0, 3Eh, 1, 53h, 1, 0BEh, 0, 0C5h, 0, 62h
		db 2, 0D1h, 0, 0A5h, 0,	7Ah, 1,	0D1h, 0, 66h, 0, 78h, 2
		db 0E4h, 0, 0, 0, 88h, 1, 0E4h,	0, 0, 0, 63h, 2, 0F7h
		db 0, 5Fh, 0FFh, 7Bh, 1, 0F7h, 0, 9Ch, 0FFh, 24h, 2, 0Ah
		db 1, 0C5h, 0FEh, 54h, 1, 0Ah, 1, 3Dh, 0FFh, 0BFh, 1, 1Dh
		db 1, 41h, 0FEh, 15h, 1, 1Dh, 1, 0EBh, 0FEh, 3Eh, 1, 30h
		db 1, 0DEh, 0FDh, 0C5h,	0, 30h,	1, 0ADh, 0FEh, 0A5h, 0
		db 43h,	1, 9Eh,	0FDh, 66h, 0, 43h, 1, 86h, 0FEh, 0, 0
		db 56h,	1, 88h,	0FDh, 0, 0, 56h, 1, 78h, 0FEh, 5Fh, 0FFh
		db 69h,	1, 9Dh,	0FDh, 9Ch, 0FFh, 69h, 1, 85h, 0FEh, 0C5h
		db 0FEh, 7Ch, 1, 0DCh, 0FDh, 3Dh, 0FFh,	7Ch, 1,	0ACh, 0FEh
		db 41h,	0FEh, 8Fh, 1, 41h, 0FEh, 0EBh, 0FEh, 8Fh, 1, 0EBh
		db 0FEh, 0DEh, 0FDh, 0A2h, 1, 0C2h, 0FEh, 0ADh,	0FEh, 0A2h
		db 1, 3Bh, 0FFh, 9Eh, 0FDh, 0B5h, 1, 5Bh, 0FFh,	86h, 0FEh
		db 0B5h, 1, 9Ah, 0FFh, 88h, 0FDh, 0C2h,	1, 0, 0, 78h, 0FEh
		db 0C2h, 1, 0, 0, 88h, 0FDh, 0C2h, 1, 4Eh, 1, 78h, 0FEh
		db 0C2h, 1, 4Eh, 1, 88h, 0FDh, 0C2h, 1,	4Eh, 3,	78h, 0FEh
		db 0C2h, 1, 4Eh, 3, 0, 0, 0C2h,	1, 0, 0
g_shpArr354_2	db 88h,	1, 0, 0, 0B2h, 0FCh, 78h, 2, 0,	0, 0B2h, 0FCh
					; DATA XREF: dseg:stru_2B77_1F80o
		db 88h,	1, 0, 0, 0B2h, 0FEh, 78h, 2, 0,	0, 0B2h, 0FEh
		db 88h,	1, 0, 0, 0, 0, 78h, 2, 0, 0, 0,	0, 7Bh,	1, 13h
		db 0, 64h, 0, 63h, 2, 13h, 0, 0A1h, 0, 54h, 1, 26h, 0
		db 0C3h, 0, 24h, 2, 26h, 0, 3Bh, 1, 15h, 1, 39h, 0, 15h
		db 1, 0BFh, 1, 39h, 0, 0BFh, 1,	0C5h, 0, 4Ch, 0, 53h, 1
		db 3Eh,	1, 4Ch,	0, 22h,	2, 66h,	0, 5Fh,	0, 7Ah,	1, 0A5h
		db 0, 5Fh, 0, 62h, 2, 0, 0, 72h, 0, 88h, 1, 0, 0, 72h
		db 0, 78h, 2, 9Ch, 0FFh, 85h, 0, 7Bh, 1, 5Fh, 0FFh, 85h
		db 0, 63h, 2, 3Dh, 0FFh, 98h, 0, 54h, 1, 0C5h, 0FEh, 98h
		db 0, 24h, 2, 0EBh, 0FEh, 0ABh,	0, 15h,	1, 41h,	0FEh, 0ABh
		db 0, 0BFh, 1, 0ADh, 0FEh, 0BEh, 0, 0C5h, 0, 0DEh, 0FDh
		db 0BEh, 0, 3Eh, 1, 86h, 0FEh, 0D1h, 0,	66h, 0,	9Eh, 0FDh
		db 0D1h, 0, 0A5h, 0, 78h, 0FEh,	0E4h, 0, 0, 0, 88h, 0FDh
		db 0E4h, 0, 0, 0, 85h, 0FEh, 0F7h, 0, 9Ch, 0FFh, 9Dh, 0FDh
		db 0F7h, 0, 5Fh, 0FFh, 0ACh, 0FEh, 0Ah,	1, 3Dh,	0FFh, 0DCh
		db 0FDh, 0Ah, 1, 0C5h, 0FEh, 0EBh, 0FEh, 1Dh, 1, 0EBh
		db 0FEh, 41h, 0FEh, 1Dh, 1, 41h, 0FEh, 3Bh, 0FFh, 30h
		db 1, 0ADh, 0FEh, 0C2h,	0FEh, 30h, 1, 0DEh, 0FDh, 9Ah
		db 0FFh, 43h, 1, 86h, 0FEh, 5Bh, 0FFh, 43h, 1, 9Eh, 0FDh
		db 0, 0, 56h, 1, 78h, 0FEh, 0, 0, 56h, 1, 88h, 0FDh, 64h
		db 0, 69h, 1, 85h, 0FEh, 0A1h, 0, 69h, 1, 9Dh, 0FDh, 0C3h
		db 0, 7Ch, 1, 0ACh, 0FEh, 3Bh, 1, 7Ch, 1, 0DCh,	0FDh, 15h
		db 1, 8Fh, 1, 0EBh, 0FEh, 0BFh,	1, 8Fh,	1, 41h,	0FEh, 53h
		db 1, 0A2h, 1, 3Bh, 0FFh, 22h, 2, 0A2h,	1, 0C2h, 0FEh
		db 7Ah,	1, 0B5h, 1, 9Ah, 0FFh, 62h, 2, 0B5h, 1,	5Bh, 0FFh
		db 88h,	1, 0C2h, 1, 0, 0, 78h, 2, 0C2h,	1, 0, 0, 88h, 1
		db 0C2h, 1, 4Eh, 1, 78h, 2, 0C2h, 1, 4Eh, 1, 88h, 1, 0C2h
		db 1, 4Eh, 3, 78h, 2, 0C2h, 1, 4Eh, 3, 0, 0, 0C2h, 1, 0
		db 0
g_shpArr84	db 0B8h, 0FFh, 0FFh, 0FFh, 0B2h, 0FEh, 0A8h, 0,	0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1F80o
		db 0B2h, 0FEh, 0, 0, 0FFh, 0FFh, 0A8h, 0, 38h, 1, 0FFh
		db 0FFh, 0A8h, 0, 78h, 0, 0FFh,	0FFh, 4Eh, 1, 68h, 1, 0FFh
		db 0FFh, 4Eh, 1, 0, 0, 0, 0, 0B4h, 0, 48h, 0, 0FFh, 0FFh
		db 0B2h, 0FEh, 58h, 0FFh, 0FFh,	0FFh, 0B2h, 0FEh, 0, 0
		db 0FFh, 0FFh, 0A8h, 0,	0C8h, 0FEh, 0FFh, 0FFh,	0A8h, 0
		db 98h,	0FEh, 0FFh, 0FFh, 4Eh, 1, 88h, 0FFh, 0FFh, 0FFh
		db 4Eh,	1, 0, 0, 0, 0, 0B4h, 0
g_shpArr84_2	db 78h,	0, 0FFh, 0FFh, 0B2h, 0FEh, 68h,	1, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1F80o
		db 0B2h, 0FEh, 78h, 0, 0FFh, 0FFh, 4Eh,	1, 68h,	1, 0FFh
		db 0FFh, 4Eh, 1, 90h, 1, 0, 0, 0, 0, 90h, 1, 0,	0, 0B2h
		db 0FEh, 90h, 1, 0, 0, 0B2h, 0FEh, 88h,	0FFh, 0FFh, 0FFh
		db 0B2h, 0FEh, 98h, 0FEh, 0FFh,	0FFh, 0B2h, 0FEh, 88h
		db 0FFh, 0FFh, 0FFh, 4Eh, 1, 98h, 0FEh,	0FFh, 0FFh, 4Eh
		db 1, 70h, 0FEh, 0, 0, 0, 0, 70h, 0FEh,	0, 0, 0B2h, 0FEh
		db 70h,	0FEh, 0, 0, 0B2h, 0FEh
g_shpArr21	db 88h,	0FFh, 0FFh, 0FFh, 0FBh,	0FEh, 17h, 0, 0FFh, 0FFh
					; DATA XREF: dseg:stru_2B77_1F80o
		db 0FBh, 0FEh, 0C4h, 0FFh, 0FFh, 0FFh, 0, 0, 3Ch, 0, 0FFh
g_shpArr33	db 0FFh, 0, 0, 0E9h, 0FFh, 0FFh, 0FFh, 5, 1, 78h, 0, 0FFh
		db 0FFh, 5, 1, 0C8h, 0,	0, 0, 0, 0, 0C8h, 0, 0,	0, 0B2h
		db 0FEh, 38h, 0FFh, 0, 0, 4Eh, 1
g_shpArr54_3	db 8Dh,	0FFh, 58h, 0, 0B2h, 0FEh, 8Dh, 0FFh, 97h, 0, 0B2h
					; DATA XREF: dseg:stru_2B77_1CC4o
		db 0FEh, 8Dh, 0FFh, 58h, 0, 0, 0, 8Dh, 0FFh, 97h, 0, 0
		db 0, 8Dh, 0FFh, 58h, 0, 4Eh, 1, 8Dh, 0FFh, 97h, 0, 4Eh
		db 1, 73h, 0, 0B4h, 0, 0, 0, 0C8h, 0, 0, 0, 0B2h, 0FEh
		db 38h,	0FFh, 0, 0, 4Eh, 1
stru_2B77_1A08	Unknown0Eh <0B01h, 1, 0D00h, 0,	offset g_shpArr174, 0, 0F00h>
					; DATA XREF: dseg:stru_2B77_2354o
					; dseg:stru_2B77_2354o
		Unknown0Eh <401h, 8, 0D00h, 100h, offset g_shpArr174, 0, 0F00h>
		Unknown0Eh <201h, 1, 200h, 0, offset g_shpArr42_2, 0, 0>
		Unknown0Eh <401h, 3, 200h, 100h, offset	g_shpArr42_2, 0, 0>
		Unknown0Eh <101h, 2, 200h, 200h, offset	g_shpArr42_2, 0, 0>
		Unknown0Eh <301h, 4, 200h, 300h, offset	g_shpArr42_2, 0, 0>
		Unknown0Eh <201h, 1, 200h, 0, offset g_shpArr42, 0, 0>
		Unknown0Eh <301h, 4, 200h, 300h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <201h, 1, 200h, 0, offset g_shpArr30, 0, 0FFh>
		Unknown0Eh <301h, 4, 200h, 300h, offset	g_shpArr30, 0, 0FFh>
		Unknown0Eh <102h, 2, 200h, 200h, offset	g_shpArr42_4, 0, 0>
		Unknown0Eh <300h, 4, 200h, 300h, offset	g_shpArr42_4, 0, 0>
		Unknown0Eh <301h, 2, 500h, 300h, offset	g_shpArr66, 0, 301h>
		Unknown0Eh <201h, 4, 500h, 0, offset g_shpArr66, 0, 301h>
		Unknown0Eh <101h, 3, 500h, 200h, offset	g_shpArr66, 0, 301h>
		Unknown0Eh <401h, 1, 500h, 100h, offset	g_shpArr66, 0, 301h>
		Unknown0Eh <801h, 0Bh, 1100h, 300h, offset g_shpArr210,	0, 601h>
		Unknown0Eh <0C01h, 4, 1100h, 0,	offset g_shpArr210, 0, 601h>
		Unknown0Eh <101h, 9, 1100h, 200h, offset g_shpArr210, 0, 601h>
		Unknown0Eh <601h, 5, 1100h, 100h, offset g_shpArr210, 0, 601h>
		Unknown0Eh <101h, 102h,	201h, 200h, offset g_shpArr42_5, 0, 0>
		Unknown0Eh <301h, 104h,	201h, 300h, offset g_shpArr42_5, 0, 0>
		Unknown0Eh <102h, 102h,	201h, 200h, offset g_shpArr42_6, 0, 0>
		Unknown0Eh <300h, 4, 200h, 300h, offset	g_shpArr42_4, 0, 0>
		Unknown0Eh <302h, 104h,	201h, 300h, offset g_shpArr42_6, 0, 0>
		Unknown0Eh <100h, 2, 200h, 200h, offset	g_shpArr42_4, 0, 0>
		Unknown0Eh <801h, 10Bh,	1101h, 300h, offset g_shpArr210_3, 0, 6FFh>
		Unknown0Eh <0C01h, 104h, 1101h,	0, offset g_shpArr210_3, 0, 6FFh>
		Unknown0Eh <101h, 109h,	1101h, 200h, offset g_shpArr210_3, 0, 6FFh>
		Unknown0Eh <601h, 105h,	1101h, 100h, offset g_shpArr210_3, 0, 6FFh>
		Unknown0Eh <101h, 2, 200h, 200h, offset	g_shpArr42_7, 0, 0>
		Unknown0Eh <301h, 4, 200h, 300h, offset	g_shpArr42_7, 0, 0>
		Unknown0Eh <201h, 1, 200h, 0, offset g_shpArr42_7, 0, 0>
		Unknown0Eh <401h, 3, 200h, 100h, offset	g_shpArr42_7, 0, 0>
		Unknown0Eh <101h, 2, 201h, 200h, offset	g_shpArr42_7, 0, 0A00h>
		Unknown0Eh <201h, 1, 201h, 0, offset g_shpArr42_7, 0, 0A00h>
		Unknown0Eh <301h, 4, 201h, 300h, offset	g_shpArr42_7, 0, 0A00h>
		Unknown0Eh <401h, 3, 201h, 100h, offset	g_shpArr42_7, 0, 0A00h>
		Unknown0Eh <101h, 2, 201h, 200h, offset	g_shpArr42_5, 0, 0A00h>
		Unknown0Eh <201h, 1, 201h, 0, offset g_shpArr42_5, 0, 0A00h>
		Unknown0Eh <301h, 4, 201h, 300h, offset	g_shpArr42_5, 0, 0A00h>
		Unknown0Eh <401h, 3, 201h, 100h, offset	g_shpArr42_5, 0, 0A00h>
		Unknown0Eh <101h, 2, 202h, 200h, offset	g_shpArr42_10, 0, 0>
		Unknown0Eh <301h, 4, 203h, 300h, offset	g_shpArr42_10, 0, 0>
		Unknown0Eh <201h, 1, 203h, 0, offset g_shpArr42_10, 0, 0>
		Unknown0Eh <401h, 3, 202h, 100h, offset	g_shpArr42_10, 0, 0>
		Unknown0Eh <101h, 2, 203h, 200h, offset	g_shpArr42_9, 0, 0>
		Unknown0Eh <301h, 4, 202h, 300h, offset	g_shpArr42_9, 0, 0>
		Unknown0Eh <201h, 1, 202h, 0, offset g_shpArr42_9, 0, 0>
		Unknown0Eh <401h, 3, 203h, 100h, offset	g_shpArr42_9, 0, 0>
stru_2B77_1CC4	Unknown0Eh <201h, 201h,	202h, 0, offset	g_shpArr42_8, 0, 0>
					; DATA XREF: dseg:22F2o
					; dseg:stru_2B77_2354o
		Unknown0Eh <401h, 303h,	203h, 100h, offset g_shpArr42_8, 0, 0>
		Unknown0Eh <101h, 302h,	203h, 200h, offset g_shpArr42_8, 0, 0>
		Unknown0Eh <301h, 204h,	202h, 300h, offset g_shpArr42_8, 0, 0>
		Unknown0Eh <801h, 20Bh,	1103h, 300h, offset g_shpArr210_6, 0, 9FFh>
		Unknown0Eh <0C01h, 204h, 1102h,	0, offset g_shpArr210_6, 0, 9FFh>
		Unknown0Eh <101h, 309h,	1103h, 200h, offset g_shpArr210_6, 0, 9FFh>
		Unknown0Eh <601h, 305h,	1102h, 100h, offset g_shpArr210_6, 0, 9FFh>
		Unknown0Eh <0B01h, 1, 1700h, 0,	offset g_shpArr294, 0, 0E00h>
		Unknown0Eh <401h, 8, 1700h, 100h, offset g_shpArr294, 0, 0E00h>
		Unknown0Eh <201h, 401h,	204h, 0, offset	g_shpArr17, 0, 0F00h>
		Unknown0Eh <301h, 404h,	204h, 300h, offset g_shpArr17, 0, 0F00h>
		Unknown0Eh <201h, 401h,	304h, 0, offset	g_shpArr54_3, 0, 0F00h>
		Unknown0Eh <301h, 404h,	304h, 300h, offset g_shpArr54_3, 0, 0F00h>
		Unknown0Eh <101h, 2, 204h, 200h, offset	g_shpArr42_3, 0, 0F00h>
		Unknown0Eh <201h, 1, 204h, 0, offset g_shpArr42_3, 0, 0F00h>
		Unknown0Eh <301h, 4, 204h, 300h, offset	g_shpArr42_3, 0, 0F00h>
		Unknown0Eh <401h, 3, 204h, 100h, offset	g_shpArr42_3, 0, 0F00h>
		Unknown0Eh <0B01h, 5, 1100h, 0,	offset g_shpArr210_5, 0, 0DFFh>
		Unknown0Eh <601h, 8, 1100h, 100h, offset g_shpArr210_4,	0, 0DFFh>
		Unknown0Eh <0C01h, 1, 1100h, 0,	offset g_shpArr210_4, 0, 0DFFh>
		Unknown0Eh <401h, 9, 1100h, 100h, offset g_shpArr210_5,	0, 0DFFh>
		Unknown0Eh <202h, 1, 200h, 0, offset g_shpArr42, 0, 0>
		Unknown0Eh <200h, 4, 500h, 0, offset g_shpArr66, 0, 301h>
		Unknown0Eh <302h, 4, 200h, 300h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <300h, 2, 500h, 300h, offset	g_shpArr66, 0, 301h>
		Unknown0Eh <102h, 2, 200h, 200h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <100h, 3, 500h, 200h, offset	g_shpArr66, 0, 301h>
		Unknown0Eh <402h, 3, 200h, 100h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <400h, 1, 500h, 100h, offset	g_shpArr66, 0, 301h>
		Unknown0Eh <202h, 1, 200h, 0, offset g_shpArr42, 0, 0>
		Unknown0Eh <200h, 3, 500h, 0, offset g_shpArr66_2, 0, 302h>
		Unknown0Eh <302h, 4, 200h, 300h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <300h, 1, 500h, 300h, offset	g_shpArr66_2, 0, 302h>
		Unknown0Eh <102h, 2, 200h, 200h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <100h, 4, 500h, 200h, offset	g_shpArr66_2, 0, 302h>
		Unknown0Eh <402h, 3, 200h, 100h, offset	g_shpArr42, 0, 0>
		Unknown0Eh <400h, 2, 500h, 100h, offset	g_shpArr66_2, 0, 302h>
		Unknown0Eh <0C02h, 5, 300h, 0, offset g_shpArr54, 0, 0>
		Unknown0Eh <0C00h, 4, 1100h, 0,	offset g_shpArr210, 0, 601h>
		Unknown0Eh <802h, 4, 300h, 300h, offset	g_shpArr54, 0, 0>
		Unknown0Eh <800h, 0Bh, 1100h, 300h, offset g_shpArr210,	0, 601h>
		Unknown0Eh <102h, 0Bh, 300h, 200h, offset g_shpArr54, 0, 0>
		Unknown0Eh <100h, 9, 1100h, 200h, offset g_shpArr210, 0, 601h>
		Unknown0Eh <602h, 9, 300h, 100h, offset	g_shpArr54, 0, 0>
		Unknown0Eh <600h, 5, 1100h, 100h, offset g_shpArr210, 0, 601h>
		Unknown0Eh <0B02h, 1, 300h, 0, offset g_shpArr54_2, 0, 0>
		Unknown0Eh <0B00h, 8, 1100h, 0,	offset g_shpArr210_2, 0, 602h>
		Unknown0Eh <902h, 6, 300h, 300h, offset	g_shpArr54_2, 0, 0>
		Unknown0Eh <900h, 1, 1100h, 300h, offset g_shpArr210_2,	0, 602h>
stru_2B77_1F80	Unknown0Eh <502h, 0Ch, 300h, 200h, offset g_shpArr54_2,	0, 0>
					; DATA XREF: dseg:25AEo
		Unknown0Eh <500h, 6, 1100h, 200h, offset g_shpArr210_2,	0, 602h>
		Unknown0Eh <402h, 8, 300h, 100h, offset	g_shpArr54_2, 0, 0>
		Unknown0Eh <400h, 0Ch, 1100h, 100h, offset g_shpArr210_2, 0, 602h>
		Unknown0Eh <201h, 501h,	205h, 0, offset	g_shpArr84_2, 1972h, 0>
		Unknown0Eh <301h, 504h,	205h, 300h, offset g_shpArr84_2, 1972h,	0>
		Unknown0Eh <101h, 2, 305h, 200h, offset	g_shpArr84, 191Eh, 0D00h>
		Unknown0Eh <201h, 1, 305h, 0, offset g_shpArr84, 191Eh,	0D00h>
		Unknown0Eh <301h, 4, 305h, 300h, offset	g_shpArr84, 191Eh, 0D00h>
		Unknown0Eh <401h, 3, 305h, 100h, offset	g_shpArr84, 191Eh, 0D00h>
		Unknown0Eh <201h, 1, 300h, 0, offset g_shpArr21, 0, 0B00h>
		Unknown0Eh <301h, 4, 300h, 300h, offset	g_shpArr21, 0, 0B00h>
		Unknown0Eh <0B01h, 1, 1D01h, 0,	offset g_shpArr354, 0, 0C00h>
		Unknown0Eh <901h, 6, 1D01h, 300h, offset g_shpArr354, 0, 0C00h>
		Unknown0Eh <501h, 0Ch, 1D01h, 200h, offset g_shpArr354,	0, 0C00h>
		Unknown0Eh <401h, 8, 1D01h, 100h, offset g_shpArr354, 0, 0C00h>
		Unknown0Eh <0C01h, 5, 1D01h, 0,	offset g_shpArr354_2, 0, 0C00h>
		Unknown0Eh <801h, 4, 1D01h, 300h, offset g_shpArr354_2,	0, 0C00h>
		Unknown0Eh <101h, 0Bh, 1D01h, 200h, offset g_shpArr354_2, 0, 0C00h>
		Unknown0Eh <601h, 9, 1D01h, 100h, offset g_shpArr354_2,	0, 0C00h>
g_sceneShapes	SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+294h, \
					; DATA XREF: DoSomeTrakData+3Ao
					; UpdateFrame+CBDo ...
			      offset g_pGame3DShapes.wNumVerts+294h, 0,	0, 0, 0, 40h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1Ch, 0, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 4,	0, 0, 0, 0, 0>
		SceneShape3D <0, 0, offset g_pCar1Shape, offset	g_pCar2Shape, 0, 0, 0,\
			      0, 40h, 0>
		SceneShape3D <0, 0, offset g_pOppCar1Shape, offset g_pOppCar2Shape, 0,\
			      0, 0, 0, 40h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+54h, 0, \
			      offset g_pGame3DShapes.wNumVerts+294h, \
			      offset g_pGame3DShapes.wNumVerts+2AAh, 0,	0, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+62h, 100h, \
			      offset g_pGame3DShapes.wNumVerts+294h, \
			      offset g_pGame3DShapes.wNumVerts+2AAh, 0,	0, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0A8h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	0, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0B6h, 0, \
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	0, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0C4h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	0, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0D2h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	0, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0E0h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	0, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0EEh, 0, \
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	0, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0FCh, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	0, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+10Ah, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	0, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+54h, 0, \
			      offset g_pGame3DShapes.wNumVerts+294h, \
			      offset g_pGame3DShapes.wNumVerts+2AAh, 0,	1, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+62h, 100h, \
			      offset g_pGame3DShapes.wNumVerts+294h, \
			      offset g_pGame3DShapes.wNumVerts+2AAh, 0,	1, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0A8h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	1, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0B6h, 0, \
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	1, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0C4h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	1, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0D2h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	1, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0E0h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	1, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0EEh, 0, \
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	1, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0FCh, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	1, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+10Ah, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	1, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+54h, 0, \
			      offset g_pGame3DShapes.wNumVerts+294h, \
			      offset g_pGame3DShapes.wNumVerts+2AAh, 0,	2, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+62h, 100h, \
			      offset g_pGame3DShapes.wNumVerts+294h, \
			      offset g_pGame3DShapes.wNumVerts+2AAh, 0,	2, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0A8h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	2, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0B6h, 0, \
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	2, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0C4h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	2, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0D2h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+344h, \
			      offset g_pGame3DShapes.wNumVerts+35Ah, 0,	2, 1, 0, 2, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0E0h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	2, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0EEh, 0, \
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	2, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0FCh, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	2, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+10Ah, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+2C0h, \
			      offset g_pGame3DShapes.wNumVerts+2D6h, 0,	2, 1, 3, 3, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+118h, 0, \
			      offset g_pGame3DShapes.wNumVerts+0DCh, \
			      offset g_pGame3DShapes.wNumVerts+0F2h, 0,	0, 0, 0, 12h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+126h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+0DCh, \
			      offset g_pGame3DShapes.wNumVerts+0F2h, 0,	0, 0, 0, 12h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+206h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+210h, \
			      offset g_pGame3DShapes.wNumVerts+226h, 0,	0, 0, 0, 10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1F8h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+210h, \
			      offset g_pGame3DShapes.wNumVerts+226h, 0,	0, 0, 0, 10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1EAh, 0, \
			      offset g_pGame3DShapes.wNumVerts+210h, \
			      offset g_pGame3DShapes.wNumVerts+226h, 0,	0, 0, 0, 10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1DCh, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+210h, \
			      offset g_pGame3DShapes.wNumVerts+226h, 0,	0, 0, 0, 10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+268h, 0, \
			      offset g_pGame3DShapes.wNumVerts+23Ch, \
			      offset g_pGame3DShapes.wNumVerts+252h, 0,	0, 0, 0, 18h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+276h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+23Ch, \
			      offset g_pGame3DShapes.wNumVerts+252h, 0,	0, 0, 0, 18h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+24Ch, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+23Ch, \
			      offset g_pGame3DShapes.wNumVerts+252h, 0,	0, 0, 0, 18h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+25Ah, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+23Ch, \
			      offset g_pGame3DShapes.wNumVerts+252h, 0,	0, 0, 0, 18h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+2A0h, 0, \
			      offset g_pGame3DShapes.wNumVerts+160h, \
			      offset g_pGame3DShapes.wNumVerts+176h, 0,	0, 0, 0, 17h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+2AEh, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+160h, \
			      offset g_pGame3DShapes.wNumVerts+176h, 0,	0, 0, 0, 17h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+284h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+160h, \
			      offset g_pGame3DShapes.wNumVerts+176h, 0,	0, 0, 0, 17h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+292h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+160h, \
			      offset g_pGame3DShapes.wNumVerts+176h, 0,	0, 0, 0, 17h, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1Ch, 200h, \
			      offset stru_2B77_7A98.wNumVerts+0DCh, \
			      offset stru_2B77_7A98.wNumVerts+0F2h, 0, 0, 0, 0,	19h, 0>
		SceneShape3D <offset stru_2B77_1CC4, 0,	\
			      offset stru_2B77_7A98.wNumVerts+0DCh, \
			      offset stru_2B77_7A98.wNumVerts+0F2h, 0, 0, 0, 0,	19h, 0>
stru_2B77_2354	SceneShape3D <offset stru_2B77_1CC4.field_0+2Ah, 300h, \
			      offset stru_2B77_7A98.wNumVerts+0DCh, \
			      offset stru_2B77_7A98.wNumVerts+0F2h, 0, 0, 0, 0,	19h, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0Eh, 100h, \
			      offset stru_2B77_7A98.wNumVerts+0DCh, \
			      offset stru_2B77_7A98.wNumVerts+0F2h, 0, 0, 0, 0,	19h, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+38h, 300h, \
			      offset g_pGame3DShapes.wNumVerts+58h, \
			      offset g_pGame3DShapes.wNumVerts+6Eh, 0, 0, 0, 3,	1Ah, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+46h, 0, \
			      offset g_pGame3DShapes.wNumVerts+58h, \
			      offset g_pGame3DShapes.wNumVerts+6Eh, 0, 0, 0, 3,	1Ah, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+54h, 200h, \
			      offset g_pGame3DShapes.wNumVerts+58h, \
			      offset g_pGame3DShapes.wNumVerts+6Eh, 0, 0, 0, 3,	1Ah, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+62h, 100h, \
			      offset g_pGame3DShapes.wNumVerts+58h, \
			      offset g_pGame3DShapes.wNumVerts+6Eh, 0, 0, 0, 3,	1Ah, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+206h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+2Ch, \
			      offset g_pGame3DShapes.wNumVerts+42h, 0, 0, 0, 0,	10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1F8h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+2Ch, \
			      offset g_pGame3DShapes.wNumVerts+42h, 0, 0, 0, 0,	10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1EAh, 0, \
			      offset g_pGame3DShapes.wNumVerts+2Ch, \
			      offset g_pGame3DShapes.wNumVerts+42h, 0, 0, 0, 0,	10h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1DCh, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+2Ch, \
			      offset g_pGame3DShapes.wNumVerts+42h, 0, 0, 0, 0,	10h, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0FCh, 0, \
			      offset g_pGame3DShapes.wNumVerts+0B0h, \
			      offset g_pGame3DShapes.wNumVerts+0C6h, 0,	0, 1, 3, 5, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+10Ah, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+84h, \
			      offset g_pGame3DShapes.wNumVerts+9Ah, 0, 0, 1, 3,	4, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+118h, 0, \
			      offset g_pGame3DShapes.wNumVerts+84h, \
			      offset g_pGame3DShapes.wNumVerts+9Ah, 0, 0, 1, 3,	4, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+126h, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+0B0h, \
			      offset g_pGame3DShapes.wNumVerts+0C6h, 0,	0, 1, 3, 5, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+70h, 0, \
			      offset g_pGame3DShapes.wNumVerts+18Ch, \
			      offset g_pGame3DShapes.wNumVerts+1A2h, 0CEh, 0, 0, 1, \
			      1Bh, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+7Eh, 100h, \
			      offset g_pGame3DShapes.wNumVerts+18Ch, \
			      offset g_pGame3DShapes.wNumVerts+1A2h, 0CFh, 0, 0, 2, \
			      1Bh, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+70h, 0, \
			      offset g_pGame3DShapes.wNumVerts+318h, \
			      offset g_pGame3DShapes.wNumVerts+32Eh, 0D0h, 0, 0, 0, \
			      1Ch, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+7Eh, 300h, \
			      offset g_pGame3DShapes.wNumVerts+318h, \
			      offset g_pGame3DShapes.wNumVerts+32Eh, 0D1h, 0, 0, 0, \
			      1Ch, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+8Ch, 0, \
			      offset g_pGame3DShapes.wNumVerts+1E4h, \
			      offset g_pGame3DShapes.wNumVerts+1FAh, 0D2h, 0, 0, 0, \
			      1Eh, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+9Ah, 100h, \
			      offset g_pGame3DShapes.wNumVerts+1E4h, \
			      offset g_pGame3DShapes.wNumVerts+1FAh, 0D3h, 0, 0, 0, \
			      1Eh, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0D2h, 0, \
			      offset stru_2B77_7A98.wNumVerts+210h, \
			      offset stru_2B77_7A98.wNumVerts+226h, 0, 0, 0, 0,	1Dh, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0C4h, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+210h, \
			      offset stru_2B77_7A98.wNumVerts+226h, 0, 0, 0, 0,	1Dh, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0E0h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+210h, \
			      offset stru_2B77_7A98.wNumVerts+226h, 0, 0, 0, 0,	1Dh, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0EEh, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+210h, \
			      offset stru_2B77_7A98.wNumVerts+226h, 0, 0, 0, 0,	1Dh, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+8Ch, 0, \
			      offset stru_2B77_7A98.wNumVerts+2Ch, \
			      offset stru_2B77_7A98.wNumVerts+42h, 0, 0, 0, 0, 0Ch, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+134h, 0, \
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 0, 0, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+150h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 0, 0, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+16Ch, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 0, 0, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+188h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 0, 0, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1A4h, 0, \
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 0, 0, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1C0h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 0, 0, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1DCh, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 0, 0, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1F8h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 0, 0, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0A8h, 0, \
			      offset stru_2B77_7EE4, \
			      offset stru_2B77_7EE4.wNumVerts+16h, 0D2h, 0, 0, 0, 1Fh,\
			      0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+0B6h, 100h,	\
			      offset stru_2B77_7EE4, \
			      offset stru_2B77_7EE4.wNumVerts+16h, 0D3h, 0, 0, 0, 1Fh,\
			      0>
		SceneShape3D <offset stru_2B77_1A08, 0,	\
			      offset stru_2B77_7EE4.wNumVerts+2Ch, \
			      offset stru_2B77_7EE4.wNumVerts+42h, 0, 0, 0, 1, 23h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+0Eh, 100h, \
			      offset stru_2B77_7EE4.wNumVerts+2Ch, \
			      offset stru_2B77_7EE4.wNumVerts+42h, 0, 0, 0, 2, 23h, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+214h, 0, \
			      offset stru_2B77_7A98.wNumVerts+108h, \
			      offset stru_2B77_7A98.wNumVerts+11Eh, 0, 0, 1, 3,	8, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+230h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+108h, \
			      offset stru_2B77_7A98.wNumVerts+11Eh, 0, 0, 1, 3,	8, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+24Ch, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+108h, \
			      offset stru_2B77_7A98.wNumVerts+11Eh, 0, 0, 1, 3,	8, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+268h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+108h, \
			      offset stru_2B77_7A98.wNumVerts+11Eh, 0, 0, 1, 3,	8, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+284h, 0, \
			      offset stru_2B77_7A98.wNumVerts+134h, \
			      offset stru_2B77_7A98.wNumVerts+14Ah, 0, 0, 1, 3,	9, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+2A0h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+134h, \
			      offset stru_2B77_7A98.wNumVerts+14Ah, 0, 0, 1, 3,	9, 0>
		SceneShape3D <offset stru_2B77_1F80, 200h, \
			      offset stru_2B77_7A98.wNumVerts+134h, \
			      offset stru_2B77_7A98.wNumVerts+14Ah, 0, 0, 1, 3,	9, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+1Ch, 100h, \
			      offset stru_2B77_7A98.wNumVerts+134h, \
			      offset stru_2B77_7A98.wNumVerts+14Ah, 0, 0, 1, 3,	9, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+206h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+160h, \
			      offset stru_2B77_7A98.wNumVerts+176h, 0, 0, 0, 0,	11h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1F8h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+160h, \
			      offset stru_2B77_7A98.wNumVerts+176h, 0, 0, 0, 0,	11h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1EAh, 0, \
			      offset stru_2B77_7A98.wNumVerts+160h, \
			      offset stru_2B77_7A98.wNumVerts+176h, 0, 0, 0, 0,	11h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1DCh, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+160h, \
			      offset stru_2B77_7A98.wNumVerts+176h, 0, 0, 0, 0,	11h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+118h, 0, \
			      offset stru_2B77_7A98.wNumVerts+18Ch, \
			      offset stru_2B77_7A98.wNumVerts+1A2h, 0, 0, 0, 0,	14h, 0>
stru_2B77_2610	SceneShape3D <offset stru_2B77_1A08.field_0+126h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+18Ch, \
			      offset stru_2B77_7A98.wNumVerts+1A2h, 0, 0, 0, 0,	14h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+134h, 0, \
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 5, 0, 0, 0,	16h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+150h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 4, 0, 0, 0,	16h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+118h, 0, \
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 0, 0, 0, 0,	13h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+126h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 0, 0, 0, 0,	13h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+16Ch, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+23Ch, \
			      offset stru_2B77_7A98.wNumVerts+252h, 0, 0, 0, 3,	15h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+17Ah, 0, \
			      offset stru_2B77_7A98.wNumVerts+23Ch, \
			      offset stru_2B77_7A98.wNumVerts+252h, 0, 0, 0, 3,	15h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+188h, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+23Ch, \
			      offset stru_2B77_7A98.wNumVerts+252h, 0, 0, 0, 3,	15h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+196h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+23Ch, \
			      offset stru_2B77_7A98.wNumVerts+252h, 0, 0, 0, 3,	15h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+38h, 0, \
			      offset stru_2B77_7A98.wNumVerts+268h, \
			      offset stru_2B77_7A98.wNumVerts+27Eh, 0, 0, 0, 0,	0Bh, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+46h, 300h, \
			      offset stru_2B77_7A98.wNumVerts+268h, \
			      offset stru_2B77_7A98.wNumVerts+27Eh, 0, 0, 0, 0,	0Bh, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+62h, 0, \
			      offset stru_2B77_7A98.wNumVerts+318h, \
			      offset stru_2B77_7A98.wNumVerts+32Eh, 0, 0FFh, 0,	0, \
			      0Ah, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+7Eh, 100h, \
			      offset stru_2B77_7A98.wNumVerts+318h, \
			      offset stru_2B77_7A98.wNumVerts+32Eh, 0, 0FFh, 0,	0, \
			      0Ah, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+54h, 200h, \
			      offset stru_2B77_7A98.wNumVerts+318h, \
			      offset stru_2B77_7A98.wNumVerts+32Eh, 0, 0FFh, 0,	0, \
			      0Ah, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+70h, 300h, \
			      offset stru_2B77_7A98.wNumVerts+318h, \
			      offset stru_2B77_7A98.wNumVerts+32Eh, 0, 0FFh, 0,	0, \
			      0Ah, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+8Ch, 0, \
			      offset stru_2B77_7A98.wNumVerts+294h, \
			      offset stru_2B77_7A98.wNumVerts+2AAh, 4, 0, 0, 0,	22h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+9Ah, 300h, \
			      offset stru_2B77_7A98.wNumVerts+294h, \
			      offset stru_2B77_7A98.wNumVerts+2AAh, 5, 0, 0, 0,	22h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0A8h, 0, \
			      offset stru_2B77_7A98.wNumVerts+2C0h, \
			      offset stru_2B77_7A98.wNumVerts+2D6h, 0C6h, 0, 0,	3, \
			      20h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0B6h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+2C0h, \
			      offset stru_2B77_7A98.wNumVerts+2D6h, 0C7h, 0, 0,	3, \
			      20h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0C4h, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+2C0h, \
			      offset stru_2B77_7A98.wNumVerts+2D6h, 0C8h, 0, 0,	3, \
			      20h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0D2h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+2C0h, \
			      offset stru_2B77_7A98.wNumVerts+2D6h, 0C9h, 0, 0,	3, \
			      20h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0E0h, 0, \
			      offset stru_2B77_7A98.wNumVerts+2ECh, \
			      offset stru_2B77_7A98.wNumVerts+302h, 0CAh, 0, 0,	3, \
			      21h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0EEh, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+2ECh, \
			      offset stru_2B77_7A98.wNumVerts+302h, 0CBh, 0, 0,	3, \
			      21h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+0FCh, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+2ECh, \
			      offset stru_2B77_7A98.wNumVerts+302h, 0CCh, 0, 0,	3, \
			      21h, 0>
		SceneShape3D <offset stru_2B77_1F80.field_0+10Ah, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+2ECh, \
			      offset stru_2B77_7A98.wNumVerts+302h, 0CDh, 0, 0,	3, \
			      21h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+8Ch, 0, \
			      offset stru_2B77_7A98.wNumVerts+2Ch, \
			      offset stru_2B77_7A98.wNumVerts+42h, 0, 1, 1, 0, 0Ch, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+134h, 0, \
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 1, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+150h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 1, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+16Ch, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 1, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+188h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 1, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1A4h, 0, \
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 1, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1C0h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 1, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1DCh, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 1, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1F8h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 1, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1Ch, 0, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 0Eh, 1, 0,	0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+38h, 200h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 0Eh, 1, 0,	0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+2Ah, 100h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 0Fh, 1, 0,	0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+46h, 300h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 0Fh, 1, 0,	0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+8Ch, 0, \
			      offset stru_2B77_7A98.wNumVerts+2Ch, \
			      offset stru_2B77_7A98.wNumVerts+42h, 0, 2, 1, 0, 0Ch, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+134h, 0, \
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 2, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+150h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 2, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+16Ch, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 2, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+188h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+58h, \
			      offset stru_2B77_7A98.wNumVerts+6Eh, 0, 2, 1, 0, 6, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1A4h, 0, \
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 2, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1C0h, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 2, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1DCh, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 2, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1CC4.field_0+1F8h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+84h, \
			      offset stru_2B77_7A98.wNumVerts+9Ah, 0, 2, 1, 0, 7, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1Ch, 0, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 18h, 2, 0,	0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+38h, 200h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 18h, 2, 0,	0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+2Ah, 100h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 19h, 2, 0,	0, 0, 0>
stru_2B77_28CC	SceneShape3D <offset stru_2B77_1A08.field_0+46h, 300h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 19h, 2, 0,	0, 0, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+0B0h, \
			      offset stru_2B77_7A98.wNumVerts+0C6h, 0, 0, 0, 0,	4Ah, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+1E4h, \
			      offset stru_2B77_7A98.wNumVerts+1FAh, 0, 0, 0, 0,	48h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+16h, \
			      offset stru_2B77_7A98.wNumVerts+16h, 0, 0, 0, 0, 47h, 0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+2ECh, \
			      offset g_pGame3DShapes.wNumVerts+302h, 0,	0, 0, 0, 49h, 0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+134h, \
			      offset g_pGame3DShapes.wNumVerts+14Ah, 0,	0, 0, 0, 42h, 0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes.wNumVerts+134h, \
			      offset g_pGame3DShapes.wNumVerts+14Ah, 0,	0, 0, 0, 42h, 0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes.wNumVerts+134h, \
			      offset g_pGame3DShapes.wNumVerts+14Ah, 0,	0, 0, 0, 42h, 0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes.wNumVerts+134h, \
			      offset g_pGame3DShapes.wNumVerts+14Ah, 0,	0, 0, 0, 42h, 0>
		SceneShape3D <0, 0, offset g_pGame3DShapes, \
			      offset g_pGame3DShapes.wNumVerts+16h, 0, 0, 0, 0,	41h, 0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes, \
			      offset g_pGame3DShapes.wNumVerts+16h, 0, 0, 0, 0,	41h, 0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes, \
			      offset g_pGame3DShapes.wNumVerts+16h, 0, 0, 0, 0,	41h, 0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes, \
			      offset g_pGame3DShapes.wNumVerts+16h, 0, 0, 0, 0,	41h, 0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+1B8h, \
			      offset g_pGame3DShapes.wNumVerts+1CEh, 0,	0, 0, 0, 44h, 0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes.wNumVerts+1B8h, \
			      offset g_pGame3DShapes.wNumVerts+1CEh, 0,	0, 0, 0, 44h, 0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes.wNumVerts+1B8h, \
			      offset g_pGame3DShapes.wNumVerts+1CEh, 0,	0, 0, 0, 44h, 0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes.wNumVerts+1B8h, \
			      offset g_pGame3DShapes.wNumVerts+1CEh, 0,	0, 0, 0, 44h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+3C8h, \
			      offset stru_2B77_7A98.wNumVerts+3DEh, 0, 0FFh, 0,	0, \
			      45h, 0>
		SceneShape3D <0, 200h, offset stru_2B77_7A98.wNumVerts+3C8h, \
			      offset stru_2B77_7A98.wNumVerts+3DEh, 0, 0FFh, 0,	0, \
			      45h, 0>
		SceneShape3D <0, 300h, offset stru_2B77_7A98.wNumVerts+3C8h, \
			      offset stru_2B77_7A98.wNumVerts+3DEh, 0, 0FFh, 0,	0, \
			      45h, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7A98.wNumVerts+3C8h, \
			      offset stru_2B77_7A98.wNumVerts+3DEh, 0, 0FFh, 0,	0, \
			      45h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+3F4h, \
			      offset stru_2B77_7A98.wNumVerts+40Ah, 0, 0, 0, 0,	46h, 0>
		SceneShape3D <0, 200h, offset stru_2B77_7A98.wNumVerts+3F4h, \
			      offset stru_2B77_7A98.wNumVerts+40Ah, 0, 0, 0, 0,	46h, 0>
		SceneShape3D <0, 300h, offset stru_2B77_7A98.wNumVerts+3F4h, \
			      offset stru_2B77_7A98.wNumVerts+40Ah, 0, 0, 0, 0,	46h, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7A98.wNumVerts+3F4h, \
			      offset stru_2B77_7A98.wNumVerts+40Ah, 0, 0, 0, 0,	46h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+420h, \
			      offset stru_2B77_7A98.wNumVerts+436h, 0, 0FFh, 0,	0, \
			      43h, 0>
		SceneShape3D <0, 200h, offset stru_2B77_7A98.wNumVerts+420h, \
			      offset stru_2B77_7A98.wNumVerts+436h, 0, 0FFh, 0,	0, \
			      43h, 0>
		SceneShape3D <0, 300h, offset stru_2B77_7A98.wNumVerts+420h, \
			      offset stru_2B77_7A98.wNumVerts+436h, 0, 0FFh, 0,	0, \
			      43h, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7A98.wNumVerts+420h, \
			      offset stru_2B77_7A98.wNumVerts+436h, 0, 0FFh, 0,	0, \
			      43h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+38h, 200h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 4,	0, 0, 0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+2Ah, 100h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 5,	0, 0, 0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+46h, 300h, \
			      offset g_pGame3DShapes.wNumVerts+108h, \
			      offset g_pGame3DShapes.wNumVerts+11Eh, 5,	0, 0, 0, 0, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1C0h, 0, \
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	0, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1B2h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	0, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1A4h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	0, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1CEh, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	0, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1C0h, 0, \
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	1, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1B2h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	1, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1A4h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	1, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1CEh, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	1, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1C0h, 0, \
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	2, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1B2h, 300h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	2, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1A4h, 200h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	2, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+1CEh, 100h,	\
			      offset g_pGame3DShapes.wNumVerts+268h, \
			      offset g_pGame3DShapes.wNumVerts+27Eh, 0,	2, 1, 0, 1, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+214h, 0, \
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 0DEh, 0, 0,	0, \
			      13h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+23Eh, 300h,	\
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 0DFh, 0, 0,	0, \
			      13h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+222h, 200h,	\
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 0E0h, 0, 0,	0, \
			      13h, 0>
		SceneShape3D <offset stru_2B77_1A08.field_0+230h, 100h,	\
			      offset stru_2B77_7A98.wNumVerts+1B8h, \
			      offset stru_2B77_7A98.wNumVerts+1CEh, 0E1h, 0, 0,	0, \
			      13h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+344h, 0, 0,	0, 1, \
			      3, 20h, 0>
		SceneShape3D <0, 300h, offset stru_2B77_7A98.wNumVerts+344h, 0,	0, 0, \
			      1, 3, 20h, 0>
g_sceneShapes1	SceneShape3D <0, 200h, offset stru_2B77_7A98.wNumVerts+344h, 0,	0, 0, \
			      1, 3, 20h, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7A98.wNumVerts+344h, 0,	0, 0, \
			      1, 3, 20h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+35Ah, 0, 0,	0, 1, \
			      3, 21h, 0>
		SceneShape3D <0, 300h, offset stru_2B77_7A98.wNumVerts+35Ah, 0,	0, 0, \
			      1, 3, 21h, 0>
		SceneShape3D <0, 200h, offset stru_2B77_7A98.wNumVerts+35Ah, 0,	0, 0, \
			      1, 3, 21h, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7A98.wNumVerts+35Ah, 0,	0, 0, \
			      1, 3, 21h, 0>
		SceneShape3D <0, 0, offset stru_2B77_7A98.wNumVerts+370h, 0, 0,	0, 1, \
			      1, 1Bh, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7A98.wNumVerts+370h, 0,	0, 0, \
			      1, 2, 1Bh, 0>
		SceneShape3D <0, 0, offset stru_2B77_7EE4.wNumVerts+58h, 0, 0, 0, 1, 0,\
			      1Ch, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7EE4.wNumVerts+58h, 0, 0, 0, \
			      1, 0, 1Ch, 0>
		SceneShape3D <0, 0, offset stru_2B77_7EE4.wNumVerts+6Eh, 0, 0, 0, 0, 0,\
			      1Eh, 0>
		SceneShape3D <0, 100h, offset stru_2B77_7EE4.wNumVerts+6Eh, 0, 0, 0, 0,\
			      0, 1Eh, 0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+436h, \
			      offset g_pGame3DShapes.wNumVerts+436h, 0,	0, 0, 0, 0FFh,\
			      0>
		SceneShape3D <0, 0, offset stru_2B77_7A98, offset stru_2B77_7A98, 0, 0,\
			      0, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset stru_2B77_7EE4.wNumVerts+84h, \
			      offset stru_2B77_7EE4.wNumVerts+9Ah, 0, 0, 0, 0, 0FFh, 0>
g_sceneShapes2	SceneShape3D <0, 0, offset stru_2B77_7EE4.wNumVerts+0B0h, \
					; DATA XREF: UpdateFrame+E0Co
					; UpdateFrame+ECEo ...
			      offset stru_2B77_7EE4.wNumVerts+0C6h, 0, 0, 0, 0,	0FFh, 0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+3DEh, \
			      offset g_pGame3DShapes.wNumVerts+3DEh, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+3C8h, \
			      offset g_pGame3DShapes.wNumVerts+3C8h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes.wNumVerts+3C8h, \
			      offset g_pGame3DShapes.wNumVerts+3C8h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes.wNumVerts+3C8h, \
			      offset g_pGame3DShapes.wNumVerts+3C8h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes.wNumVerts+3C8h, \
			      offset g_pGame3DShapes.wNumVerts+3C8h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+3B2h, \
			      offset g_pGame3DShapes.wNumVerts+3B2h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+39Ch, \
			      offset g_pGame3DShapes.wNumVerts+39Ch, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes.wNumVerts+39Ch, \
			      offset g_pGame3DShapes.wNumVerts+39Ch, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes.wNumVerts+39Ch, \
			      offset g_pGame3DShapes.wNumVerts+39Ch, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes.wNumVerts+39Ch, \
			      offset g_pGame3DShapes.wNumVerts+39Ch, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+386h, \
			      offset g_pGame3DShapes.wNumVerts+386h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes.wNumVerts+386h, \
			      offset g_pGame3DShapes.wNumVerts+386h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes.wNumVerts+386h, \
			      offset g_pGame3DShapes.wNumVerts+386h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes.wNumVerts+386h, \
			      offset g_pGame3DShapes.wNumVerts+386h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 0, offset g_pGame3DShapes.wNumVerts+370h, \
			      offset g_pGame3DShapes.wNumVerts+370h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 300h, offset g_pGame3DShapes.wNumVerts+370h, \
			      offset g_pGame3DShapes.wNumVerts+370h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 200h, offset g_pGame3DShapes.wNumVerts+370h, \
			      offset g_pGame3DShapes.wNumVerts+370h, 0,	0, 1, 0, 0FFh,\
			      0>
		SceneShape3D <0, 100h, offset g_pGame3DShapes.wNumVerts+370h, \
			      offset g_pGame3DShapes.wNumVerts+370h, 0,	0, 1, 0, 0FFh,\
			      0>
g_sceneShapes3	SceneShape3D <0, 0, offset m_p3DShapes.wNumVerts+16h, \
					; DATA XREF: UpdateFrame+13F2o
					; UpdateFrame+16A0o ...
			      offset m_p3DShapes.wNumVerts+16h,	0, 0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset m_p3DShapes.wNumVerts+2Ch, \
			      offset m_p3DShapes.wNumVerts+2Ch,	0, 0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset m_p3DShapes.wNumVerts+42h, \
			      offset m_p3DShapes.wNumVerts+42h,	0, 0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset m_p3DShapes.wNumVerts+58h, \
			      offset m_p3DShapes.wNumVerts+58h,	0, 0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pExp0Shape, offset	g_pExp0Shape, 0, 0, 1,\
			      0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pExp1Shape, offset	g_pExp1Shape, 0, 0, 1,\
			      0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pExp2Shape, offset	g_pExp2Shape, 0, 0, 1,\
			      0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pExp3Shape, offset	g_pExp3Shape, 0, 0, 1,\
			      0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pOppExp0Shape, offset g_pOppExp0Shape, 0,\
			      0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pOppExp1Shape, offset g_pOppExp1Shape, 0,\
			      0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pOppExp2Shape, offset g_pOppExp2Shape, 0,\
			      0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset g_pOppExp3Shape, offset g_pOppExp3Shape, 0,\
			      0, 1, 0, 0FFh, 0>
		SceneShape3D <0, 0, offset stru_2B77_7EE4.wNumVerts+0DCh, \
			      offset stru_2B77_7EE4.wNumVerts+0DCh, 0, 0, 1, 0,	0FFh, 0>
unk_2B77_2E1A	db    0			; DATA XREF: TrkTerrainWall+B05r
					; TrkTerrainWall+B0Cr ...
		db    0
unk_2B77_2E1C	db 0E0h	; à		; DATA XREF: TrkTerrainWall+AAAr
					; TrkTerrainWall+B01r ...
		db    0
		db  85h	; …
		db    1
unk_2B77_2E20	db 0C1h	; Á		; DATA XREF: TrkTerrainWall+A7Br
					; TrkTerrainWall+A84r ...
		db    1
		db  85h	; …
		db    1
		db 0E0h	; à
		db    0
		db    0
		db    0
unk_2B77_2E28	db  70h	; p		; DATA XREF: TrkTerrainWall+AD0r
					; TrkTerrainWall+AF1r ...
		db 0FEh	; þ
unk_2B77_2E2A	db  70h	; p		; DATA XREF: TrkTerrainWall:loc_E1A_AD9r
					; TrkTerrainWall+AEBr ...
		db 0FEh	; þ
		db 0A0h	;  
		db 0FEh	; þ
		db 0D0h	; Ð
		db 0FEh	; þ
		db 0F2h	; ò
		db 0FEh	; þ
		db  15h
		db 0FFh
		db  38h	; 8
		db 0FFh
		db    0
		db    0
		db  87h	; ‡
		db    0
		db  2Bh	; +
		db    1
		db  0Ch
		db    2
		db 0EDh	; í
		db    2
		db  92h	; ’
		db    3
		db 0CFh	; Ï
		db    3
unk_2B77_2E44	db    0			; DATA XREF: TrkTerrainWall+C28r
					; TrkTerrainWall+C32r ...
		db    0
unk_2B77_2E46	db 0B2h	; ²		; DATA XREF: TrkTerrainWall+C1Ar
					; TrkTerrainWall+C24r ...
		db    0
		db  68h	; h
		db    1
		db  18h
		db    2
		db 0C0h	; À
		db    2
		db  64h	; d
		db    3
		db 0D0h	; Ð
		db    7
unk_2B77_2E52	db    0			; DATA XREF: TrkTerrainWall+C3Dr
					; TrkTerrainWall+C50r
		db    0
unk_2B77_2E54	db 0ECh	; ì		; DATA XREF: TrkTerrainWall+C39r
		db 0FFh
		db 0D8h	; Ø
		db 0FFh
		db 0C4h	; Ä
		db 0FFh
		db 0B0h	; °
		db 0FFh
		db  9Ch	; œ
		db 0FFh
		db  88h	; ˆ
		db 0FFh
unk_2B77_2E60	db  90h	; 		; DATA XREF: TrkTerrainWall+C70r
					; TrkTerrainWall+C83r
		db    1
unk_2B77_2E62	db  69h	; i		; DATA XREF: TrkTerrainWall+C6Cr
		db    1
		db  40h	; @
		db    1
		db  14h
		db    1
		db 0E2h	; â
		db    0
		db 0AEh	; ®
		db    0
		db  78h	; x
		db    0
unk_2B77_2E6E	db    5			; DATA XREF: TrkTerrainWall+965r
		db 0FFh
		db 0ACh	; ¬
		db 0FFh
		db  54h	; T
		db    0
		db 0FBh	; û
		db    0
unk_2B77_2E76	db    0			; DATA XREF: TrkTerrainWall+1103r
		db    0
		db 0A2h	; ¢
		db 0FFh
		db  45h	; E
		db 0FFh
		db 0E8h	; è
		db 0FEh	; þ
		db  8Bh	; ‹
		db 0FEh	; þ
		db  2Eh	; .
		db 0FEh	; þ
		db 0D1h	; Ñ
		db 0FDh	; ý
		db  74h	; t
		db 0FDh	; ý
		db  17h
		db 0FDh	; ý
		db 0BAh	; º
		db 0FCh	; ü
		db  5Dh	; ]
		db 0FCh	; ü
		db    0
		db 0FCh	; ü
unk_2B77_2E8E	db    0			; DATA XREF: TrkTerrainWall+1109r
		db    0
		db    0
		db    4
		db 0A3h	; £
		db    3
		db  46h	; F
		db    3
		db 0E9h	; é
		db    2
		db  8Ch	; Œ
		db    2
		db  2Fh	; /
		db    2
unk_2B77_2E9C	db 0D2h	; Ò		; DATA XREF: seg012:1763o
		db    1
		db  75h	; u
		db    1
		db  18h
		db    1
		db 0BBh	; »
		db    0
		db  5Eh	; ^
		db    0
unk_2B77_2EA6	db    0			; DATA XREF: TrkTerrainWall+562r
					; TrkTerrainWall+56Cr ...
		db 0FEh	; þ
unk_2B77_2EA8	db 0B2h	; ²		; DATA XREF: TrkTerrainWall+546r
					; TrkTerrainWall+55Er ...
		db 0FEh	; þ
		db  58h	; X
		db 0FFh
		db    0
		db    0
		db 0A8h	; ¨
		db    0
		db  4Eh	; N
		db    1
		db 0E8h	; è
		db    3
unk_2B77_2EB4	db    0			; DATA XREF: TrkTerrainWall+550r
					; TrkTerrainWall+577r ...
		db    0
unk_2B77_2EB6	db    0			; DATA XREF: TrkTerrainWall+554r
					; TrkTerrainWall+573r
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db  78h	; x
		db    0
		db  78h	; x
		db    0
unk_2B77_2EC2	db  78h	; x		; DATA XREF: TrkTerrainWall+595r
					; TrkTerrainWall+5BCr ...
		db    0
unk_2B77_2EC4	db 0A8h	; ¨		; DATA XREF: TrkTerrainWall+599r
					; TrkTerrainWall+5B8r
		db    0
		db 0D8h	; Ø
		db    0
		db    8
		db    1
		db  38h	; 8
		db    1
		db  68h	; h
		db    1
		db  68h	; h
		db    1
unk_2B77_2ED0	db    0			; DATA XREF: ZXTrakdata14Shape+1FFo
		db    0
		db    0
		db    0
		db    0
		db    0
unk_2B77_2ED6	db  88h	; ˆ		; DATA XREF: ZXTrakdata14Shape+209o
		db 0FFh
		db    0
		db    0
		db 0E7h	; ç
		db 0FEh	; þ
		db  88h	; ˆ
		db 0FFh
		db    0
		db    0
		db  19h
		db 0FFh
		db  88h	; ˆ
		db 0FFh
		db    0
		db    0
		db  19h
		db    1
		db  88h	; ˆ
		db 0FFh
		db    0
		db    0
		db 0E7h	; ç
		db    0
		db  78h	; x
		db    0
		db    0
		db    0
		db 0E7h	; ç
		db 0FEh	; þ
		db  78h	; x
		db    0
		db    0
		db    0
		db  19h
		db 0FFh
		db  78h	; x
		db    0
		db    0
		db    0
		db  19h
		db    1
		db  78h	; x
		db    0
		db    0
		db    0
		db 0E7h	; ç
		db    0
unk_2B77_2F06	db 0C4h	; Ä		; DATA XREF: ZXTrakdata14Shape+1D1o
		db 0FFh
		db    0
		db    0
		db    0
		db 0FEh	; þ
		db  3Ch	; <
		db    0
		db    0
		db    0
		db    0
		db    2
unk_2B77_2F12	db  78h	; x		; DATA XREF: ZXTrakdata14Shape+1E1o
		db 0FEh	; þ
		db    0
		db    0
		db    0
		db    0
		db  88h	; ˆ
		db 0FDh	; ý
		db    0
		db    0
		db    0
		db    0
unk_2B77_2F1E	db  88h	; ˆ		; DATA XREF: ZXTrakdata14Shape+1EBo
		db    1
		db    0
		db    0
		db    0
		db    0
		db  78h	; x
		db    2
		db    0
		db    0
		db    0
		db    0
unk_2B77_2F2A	db  17h			; DATA XREF: ZXTrakdata14Shape+1F5o
		db    0
		db    0
		db    0
		db    1
		db 0FFh
		db  61h	; a
		db    0
		db    0
		db    0
		db    1
		db 0FFh
		db  9Fh	; Ÿ
		db 0FFh
		db    0
		db    0
		db 0FFh
		db    0
		db 0E9h	; é
		db 0FFh
		db    0
		db    0
		db 0FFh
		db    0
aGame1		db 'game1',0            ; DATA XREF: LoadGame3dShpes:loc_E1A_1D22o
aGame2		db 'game2',0            ; DATA XREF: LoadGame3dShpes+41o
aCar0		db 'car0',0             ; DATA XREF: LoadCarShapes+39o
aCar1		db 'car1',0             ; DATA XREF: LoadCarShapes+58o
aCar2		db 'car2',0             ; DATA XREF: LoadCarShapes+158o
aExp0_0		db 'exp0',0             ; DATA XREF: LoadCarShapes+17Ao
aExp1_0		db 'exp1',0             ; DATA XREF: LoadCarShapes+19Co
aExp2_0		db 'exp2',0             ; DATA XREF: LoadCarShapes+1BEo
aExp3_0		db 'exp3',0             ; DATA XREF: LoadCarShapes+1E0o
aCar2_0		db 'car2',0             ; DATA XREF: LoadCarShapes+24Ao
aCar0_0		db 'car0',0             ; DATA XREF: LoadCarShapes+2C9o
aCar1_0		db 'car1',0             ; DATA XREF: LoadCarShapes+2EBo
aCar2_1		db 'car2',0             ; DATA XREF: LoadCarShapes+3EBo
aExp0_1		db 'exp0',0             ; DATA XREF: LoadCarShapes+40Do
aExp1_1		db 'exp1',0             ; DATA XREF: LoadCarShapes+42Fo
aExp2_1		db 'exp2',0             ; DATA XREF: LoadCarShapes+451o
aExp3_1		db 'exp3',0             ; DATA XREF: LoadCarShapes+473o
		db    0
aStxxx		db 'stxxx'              ; DATA XREF: LoadCarShapes+22o
					; LoadCarShapes+2B2o ...
byte_2B77_2F9F	db 0			; DATA XREF: LoadCarShapes+1Fw
					; LoadCarShapes+2AFw
unk_2B77_2FA0	db    0			; DATA XREF: UnloadCurCar+15o
					; UnloadCurCar+4Bo
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
aTcomp		db 'tcomp',0            ; DATA XREF: SetupTrack+Fo
unk_2B77_2FAE	db    0			; DATA XREF: SetupTrack+ACFr
		db    0
		db    1
		db    0
		db    1
		db    0
unk_2B77_2FB4	db    0			; DATA XREF: SetupTrack+AC1r
		db    1
		db    0
		db    0
		db    1
		db    0
g_arrTrak15	db 0, 0, 0, 0, 0, 0, 1,	2, 1, 3, 0, 2, 3, 0, 0,	1, 1, 3
					; DATA XREF: SetupTrack+AAr
		db 2, 0
g_arrTrak15_2	db 0, 0, 0, 0, 0, 0, 1,	2, 0, 3, 1, 0, 0, 3, 2,	2, 3, 1
					; DATA XREF: SetupTrack+6Er
		db 1, 0
g_arrTrak15_3	db 0, 0, 0, 0, 0, 0, 1,	1, 5, 0, 4, 5, 0, 0, 4,	1, 5, 4
					; DATA XREF: SetupTrack+12Cr
		db 1, 0
g_arrTrak15_4	db 0, 0, 0, 0, 0, 0, 1,	0, 5, 1, 4, 0, 5, 4, 0,	5, 1, 1
					; DATA XREF: SetupTrack+F0r
		db 4
aNam		db 'nam',0              ; DATA XREF: SetupOppTrakdata+25o
aPath		db 'path',0             ; DATA XREF: SetupOppTrakdata+44o
aSped		db 'sped',0             ; DATA XREF: SetupOppTrakdata+60o
		db    0
aEngi		db 'ENGI',0             ; DATA XREF: dseg:3094o
aEngi_0		db 'ENGI',0             ; DATA XREF: dseg:3098o
aStar		db 'STAR',0             ; DATA XREF: dseg:309Co
aStop		db 'STOP',0             ; DATA XREF: dseg:30A0o
aBlow		db 'BLOW',0             ; DATA XREF: dseg:30A4o
aCras		db 'CRAS',0             ; DATA XREF: dseg:30A8o
aSkid		db 'SKID',0             ; DATA XREF: dseg:30ACo
aSki2		db 'SKI2',0             ; DATA XREF: dseg:30B0o
aBump		db 'BUMP',0             ; DATA XREF: dseg:30B4o
aScra		db 'SCRA',0             ; DATA XREF: dseg:30B8o
aEngi_1		db 'ENGI',0             ; DATA XREF: dseg:30C4o
aEngi_2		db 'ENGI',0             ; DATA XREF: dseg:30C8o
aStar_0		db 'STAR',0             ; DATA XREF: dseg:30CCo
aStop_0		db 'STOP',0             ; DATA XREF: dseg:30D0o
aBlow_0		db 'BLOW',0             ; DATA XREF: dseg:30D4o
aCras_0		db 'CRAS',0             ; DATA XREF: dseg:30D8o
aSkid_0		db 'SKID',0             ; DATA XREF: dseg:30DCo
aSki2_0		db 'SKI2',0             ; DATA XREF: dseg:30E0o
aBump_0		db 'BUMP',0             ; DATA XREF: dseg:30E4o
aScra_0		db 'SCRA',0             ; DATA XREF: dseg:30E8o
aDefault_1	db 'default',0          ; DATA XREF: RunGame+55o
aRbf		db 'rbf',0              ; DATA XREF: RunGame+2A0o
aCop_0		db 'cop',0              ; DATA XREF: RunGame+79Eo
g_pAudTimEng1	db 0F4h			; DATA XREF: SetupCarGameEtc+120o
		db    1
		db  10h
		db  27h	; '
		db  28h	; (
		db  23h	; #
		db    0
		db    0
		dd aEngi		; "ENGI"
		dd aEngi_0		; "ENGI"
		dd aStar		; "STAR"
		dd aStop		; "STOP"
		dd aBlow		; "BLOW"
		dd aCras		; "CRAS"
		dd aSkid		; "SKID"
		dd aSki2		; "SKI2"
		dd aBump		; "BUMP"
		dd aScra		; "SCRA"
g_pAudTimOppEng	db 0F4h			; DATA XREF: SetupCarGameEtc+15Ao
		db    1
		db  10h
		db  27h	; '
		db  28h	; (
		db  23h	; #
		db    0
		db    0
		dd aEngi_1		; "ENGI"
		dd aEngi_2		; "ENGI"
		dd aStar_0		; "STAR"
		dd aStop_0		; "STOP"
		dd aBlow_0		; "BLOW"
		dd aCras_0		; "CRAS"
		dd aSkid_0		; "SKID"
		dd aSki2_0		; "SKI2"
		dd aBump_0		; "BUMP"
		dd aScra_0		; "SCRA"
g_pSomeCurve	db 6 dup(0), 4,	8, 0Ch,	10h, 14h, 18h, 1Ch, 20h, 24h, 28h
					; DATA XREF: RecordReplay+111r
					; RecordReplay+127r
		db 2Ch,	30h, 34h, 38h, 3Ch, 40h, 44h, 48h, 4Ch,	54h, 5Ah
		db 62h,	6Ah, 72h, 79h, 3 dup(7Fh)
a_rpl_2		db '.rpl',0             ; DATA XREF: LoadReplayFile+9o
aWhl1whl2whl3in	db 'whl1whl2whl3ins2gboxins1ins3inm1inm3',0 ; DATA XREF: SetupCarShapes+90o
aGnobgnabdotDot	db 'gnobgnabdot dotadot1dot2',0 ; DATA XREF: SetupCarShapes+A8o
aDig0dig1dig2di	db 'dig0dig1dig2dig3dig4dig5dig6dig7dig8dig9',0
					; DATA XREF: SetupCarShapes+C7o
aDash_0		db 'dash',0             ; DATA XREF: SetupCarShapes+144o
aRoof_1		db 'roof',0             ; DATA XREF: SetupCarShapes+1ABo
aRoof_2		db 'roof',0             ; DATA XREF: SetupCarShapes+1C3o
aDast		db 'dast',0             ; DATA XREF: SetupCarShapes:loc_11B7_13A8o
aDasm		db 'dasm',0             ; DATA XREF: SetupCarShapes+21Bo
aRoof		db 'roof',0             ; DATA XREF: SetupCarShapes+24Do
aRoof_0		db 'roof',0             ; DATA XREF: SetupCarShapes+265o
aDash		db 'dash',0             ; DATA XREF: SetupCarShapes:loc_11B7_1441o
aStda		db 'stda'               ; DATA XREF: SetupCarShapes+5Eo
aXxxx_0		db 'xxxx'               ; DATA XREF: SetupCarShapes+31w
					; SetupCarShapes+37w ...
		align 4
aStdb		db 'stdb'               ; DATA XREF: SetupCarShapes+75o
aXxxx		db 'xxxx',0             ; DATA XREF: SetupCarShapes+49w
					; SetupCarShapes+4Fw ...
aEng1		db 'eng1',0             ; DATA XREF: SetupCarGameEtc+DDo
aEng		db 'eng',0              ; DATA XREF: SetupCarGameEtc+F4o
aFontled_fnt	db 'fontled.fnt',0      ; DATA XREF: SetupCarGameEtc+180o
aSdgame		db 'sdgame',0           ; DATA XREF: SetupCarGameEtc+1B9o
aGame		db 'game',0             ; DATA XREF: SetupCarGameEtc:loc_11B7_1D6Eo
aPlan		db 'plan',0             ; DATA XREF: SetupCarGameEtc+1EFo
aWall		db 'wall',0             ; DATA XREF: SetupCarGameEtc+207o
aRplyrpicrpacrp	db 'rplyrpicrpacrpmcrptcbof6bof5bof4bof3bof2bof1bof0zoompannbon6bon5b'
					; DATA XREF: RplyMouseSpriteStuff+28o
		db 'on4bon3bon2bon1bof0zoompann',0
aMen		db 'men',0              ; DATA XREF: RplyMouseSpriteStuff+88Eo
aCon_0		db 'con',0              ; DATA XREF: RplyMouseSpriteStuff+924o
aRep_0		db 'rep',0              ; DATA XREF: RplyMouseSpriteStuff+9C8o
a_rpl_0		db '.rpl',0             ; DATA XREF: RplyMouseSpriteStuff+9DEo
aRep_1		db 'rep',0              ; DATA XREF: RplyMouseSpriteStuff:loc_11B7_2AD2o
a_rpl_1		db '.rpl',0             ; DATA XREF: RplyMouseSpriteStuff+B27o
aFex		db 'fex',0              ; DATA XREF: RplyMouseSpriteStuff+B61o
aSer		db 'ser',0              ; DATA XREF: RplyMouseSpriteStuff+BD3o
aMdo		db 'mdo',0              ; DATA XREF: RplyMouseSpriteStuff+C59o
aWai_1		db 'wai',0              ; DATA XREF: RplyMouseSpriteStuff+E29o
aWai_0		db 'wai',0              ; DATA XREF: RplyMouseSpriteStuff:loc_11B7_2FDFo
byte_2B77_326B	db 6			; DATA XREF: RplyMouseSpriteStuff+1D8r
					; RplyMouseSpriteStuff+1E3w ...
		db    1
		db    7
		db    3
		db    4
		db    5
		db    6
		db    7
		db    8
		db    8
		db    0
		db    0
		db    0
		db    2
		db    2
		db    3
		db    4
		db    5
		db    1
		db    7
		db    0
		db    2
		db    6
		db    2
		db    3
		db    4
		db    5
		db    6
		db    7
		db    8
		db    0
		db    0
		db    1
		db    0
		db    0
		db    1
		db    1
		db    1
		db    7
		db    8
		db    0
g_pcCamTable	db 6, 6, 8, 7		; DATA XREF: RplyMouseSpriteStuff+1D1r
					; RplyMouseSpriteStuff+472r ...
unk_2B77_3298	db  10h			; DATA XREF: RplyMouseSpriteStuff+458r
					; RplyMouseSpriteStuff+4BFo
		db    1
		db  6Dh	; m
		db    0
		db  12h
		db    1
		db 0E8h	; è
		db    0
		db 0BEh	; ¾
		db    0
		db  97h	; —
		db    0
		db  6Ch	; l
		db    0
		db  42h	; B
		db    0
word_2B77_32A8	dw 0Ah			; DATA XREF: RplyMouseSpriteStuff+547r
unk_2B77_32AA	db  3Ah	; :		; DATA XREF: RplyMouseSpriteStuff+450r
					; RplyMouseSpriteStuff+4BBo
		db    1
		db  97h	; —
		db    0
		db  3Ah	; :
		db    1
		db  12h
		db    1
		db 0E8h	; è
		db    0
		db 0BEh	; ¾
		db    0
		db  97h	; —
		db    0
		db  5Bh	; [
		db    0
word_2B77_32BA	dw 2Fh			; DATA XREF: RplyMouseSpriteStuff+54Br
unk_2B77_32BC	db 0B0h	; °		; DATA XREF: RplyMouseSpriteStuff+454r
					; RplyMouseSpriteStuff+4B7o
		db    0
		db 0B0h	; °
		db    0
		db  9Ch	; œ
		db    0
		db  9Ch	; œ
		db    0
		db  9Ch	; œ
		db    0
		db  9Ch	; œ
		db    0
		db  9Ch	; œ
		db    0
word_2B77_32CA	dw 9Ch			; DATA XREF: RplyMouseSpriteStuff+516r
word_2B77_32CC	dw 9Ch			; DATA XREF: RplyMouseSpriteStuff:loc_11B7_2512r
unk_2B77_32CE	db 0C1h	; Á		; DATA XREF: RplyMouseSpriteStuff+44Cr
					; RplyMouseSpriteStuff+4B3o
		db    0
		db 0C1h	; Á
		db    0
		db 0ADh	; ­
		db    0
		db 0ADh	; ­
		db    0
		db 0ADh	; ­
		db    0
		db 0ADh	; ­
		db    0
		db 0ADh	; ­
		db    0
word_2B77_32DC	dw 0C1h			; DATA XREF: RplyMouseSpriteStuff+519r
word_2B77_32DE	dw 0C1h			; DATA XREF: RplyMouseSpriteStuff+539r
unk_2B77_32E0	db    0			; DATA XREF: RplyMouseSpriteStuff+598o
		db    0
unk_2B77_32E2	db  68h	; h		; DATA XREF: RplyMouseSpriteStuff+594o
		db    0
unk_2B77_32E4	db  97h	; —		; DATA XREF: RplyMouseSpriteStuff+590o
		db    0
unk_2B77_32E6	db 0C8h	; È		; DATA XREF: RplyMouseSpriteStuff:loc_11B7_2568o
		db    0
aPolyinfo	db 'polyinfo',0         ; DATA XREF: InitPolyInfo+6o
		db    0
g_pcVertCountTab db 0, 1, 2, 3,	4, 5, 6, 7, 8, 9, 0Ah, 2, 6, 3,	2 dup(0)
					; DATA XREF: TransformedShapeOp+39Er
					; TransformedShapeOp+3F3r ...
g_pcPrimTypeTab	db 0, 5, 1, 8 dup(0), 2, 3, 4, 2 dup(0)	; DATA XREF: TransformedShapeOp+3FAr
unk_2B77_3312	db    0			; DATA XREF: TransformedShapeOp+1EFr
		db    0
unk_2B77_3314	db    0			; DATA XREF: TransformedShapeOp+1F3r
		db  80h	; €
		db    0
		db    0
		db    0
		db  40h	; @
		db    0
		db    0
		db    0
		db  20h
		db    0
		db    0
		db    0
		db  10h
		db    0
		db    0
		db    0
		db    8
		db    0
		db    0
		db    0
		db    4
		db    0
		db    0
		db    0
		db    2
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db  80h	; €
		db    0
		db    0
		db    0
		db  40h	; @
		db    0
		db    0
		db    0
		db  20h
		db    0
		db    0
		db    0
		db  10h
		db    0
		db    0
		db    0
		db    8
		db    0
		db    0
		db    0
		db    4
		db    0
		db    0
		db    0
		db    2
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db  80h	; €
		db    0
		db    0
		db    0
		db  40h	; @
		db    0
		db    0
		db    0
		db  20h
		db    0
		db    0
		db    0
		db  10h
		db    0
		db    0
		db    0
		db    8
		db    0
		db    0
		db    0
		db    4
		db    0
		db    0
		db    0
		db    2
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db  80h	; €
		db    0
		db    0
		db    0
		db  40h	; @
		db    0
		db    0
		db    0
		db  20h
		db    0
		db    0
		db    0
		db  10h
		db    0
		db    0
		db    0
		db    8
		db    0
		db    0
		db    0
		db    4
		db    0
		db    0
		db    0
		db    2
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db    0
g_wTempY	dw 0FFFFh		; DATA XREF: MatRotateZXY+4Dr
					; MatRotateZXY+82w
g_rc1		Rectangle <270Fh, 0FFFFh, 270Fh, 0FFFFh> ; DATA	XREF: RunCarMenu+800o
					; sub_9F1_186+38o ...
aInitengineAllH	db 'InitEngine: All handles used.',0 ; DATA XREF: InitSfxEngine:_InitErroro
g_wAudioFlag	dw 0			; DATA XREF: AudioDrvTimer:loc_16BA_417w
					; AudioDrvTimer+18r ...
aStartengineNew	db 'startengine() - new handle = %d',0Ah,0 ; DATA XREF: nopsub_16BA_680+34o
		align 2
aId1		db 'id1',0              ; DATA XREF: dseg:3410o
aId2		db 'id2',0              ; DATA XREF: dseg:3412o
aId3		db 'id3',0              ; DATA XREF: dseg:3414o
aId4		db 'id4',0              ; DATA XREF: dseg:g_ppFilenameso
aSetup_exe	db 'setup.exe',0        ; DATA XREF: dseg:3418o
aSdtitl_	db 'sdtitl.*',0         ; DATA XREF: dseg:341Ao
aTedit_		db 'tedit.*',0          ; DATA XREF: dseg:341Co
aOpp1_		db 'opp1.*',0           ; DATA XREF: dseg:341Eo
					; EnsureFileExists+18r
		dw offset aId1		; "id1"
		dw offset aId2		; "id2"
		dw offset aId3		; "id3"
g_ppFilenames	dw offset aId4		; DATA XREF: EnsureFileExists+47r
					; "id4"
		dw offset aSetup_exe	; "setup.exe"
		dw offset aSdtitl_	; "sdtitl.*"
		dw offset aTedit_	; "tedit.*"
		dw offset aOpp1_	; "opp1.*"
word_2B77_3420	dw 0			; DATA XREF: DoDialog+1D2w
					; DoDialog+61Br ...
aLoa		db 'loa',0              ; DATA XREF: TakesTrackNames+1Ao
asc_2B77_3426	db '*',0                ; DATA XREF: TakesTrackNames+16Eo
aLsu		db 'lsu',0              ; DATA XREF: TakesTrackNames+2FFo
aLsd		db 'lsd',0              ; DATA XREF: TakesTrackNames+33Bo
asc_2B77_3430	db '        ',0         ; DATA XREF: TakesTrackNames+429o
asc_2B77_3439	db '\',0                ; DATA XREF: CombineFilePath+47o
aSav		db 'sav',0              ; DATA XREF: SavResRender+18o
		db    0
g_wInputTime2	dw 0			; DATA XREF: InputsChecking+1Dw
					; InputsChecking+1ADw ...
g_wOldInpTime	dw 0			; DATA XREF: InputsChecking+23w
					; InputsChecking+C7w ...
g_wJoyFlags	dw 0			; DATA XREF: InputsChecking+48r
					; InputsChecking:loc_174B_1365r ...
g_wInFlagDiff	dw 0			; DATA XREF: InputsChecking+58w
					; InputsChecking:loc_174B_1373r ...
g_dwOldMouX	dw 0			; DATA XREF: InputsChecking+FCr
					; InputsChecking+117w
g_dwOldMouY	dw 0			; DATA XREF: InputsChecking+105r
					; InputsChecking+11Dw
g_dwOldMouStatu	dw 0			; DATA XREF: InputsChecking+10Er
					; InputsChecking+177r ...
g_wInTimer2	dw 0			; DATA XREF: InputsChecking+125w
					; InputsChecking+14Ew ...
g_wInResultFlag	dw 0			; DATA XREF: InputsChecking+66w
					; InputsChecking+77w ...
g_wButFlags	dw 0			; DATA XREF: InputsChecking+18Dw
					; InputsChecking+19Dw ...
g_wInputTime	dw 0			; DATA XREF: InputsChecking+Bw
					; InputsChecking+Fr ...
a_res		db '.res',0             ; DATA XREF: LoadResFile+15o
a_pre		db '.pre',0             ; DATA XREF: LoadResFile+4Do
aWai		db 'wai',0              ; DATA XREF: ShowWaiting+10o
asc_2B77_3464	db ':',0                ; DATA XREF: FormatString+59o
a_		db '.',0                ; DATA XREF: FormatString+91o
g_cKbRelIndex	db 0			; DATA XREF: PushInputStatus+1r
					; PushInputStatus+15w ...
aJoy		db 'joy',0              ; DATA XREF: DoJoyResText+27o
aJox		db 'jox',0              ; DATA XREF: DoJoyResText+220o
aKey		db 'key',0              ; DATA XREF: DoKeyResText+1Co
aMou		db 'mou',0              ; DATA XREF: DoMouResText+21o
aPau		db 'pau',0              ; DATA XREF: DoPauTextRes+1Co
aMon		db 'mon',0
aMof		db 'mof',0              ; DATA XREF: DoMofTextRes+33o
aSon		db 'son',0              ; DATA XREF: DoSonSofTextRes+20o
aSof		db 'sof',0              ; DATA XREF: DoSonSofTextRes+33o
aDos_0		db 'dos',0              ; DATA XREF: DoDosTextRes+1Co
aMrl		db 'mrl',0              ; DATA XREF: DoMrlTextRes:loc_174B_2B29o
aMrs		db 'mrs',0              ; DATA XREF: DoMrlTextRes+12Co
aDea		db 'dea',0              ; DATA XREF: DoDeaTextRes+1Eo
aDer		db 'der',0              ; DATA XREF: DoDeaTextRes+5Do
aMer		db 'mer',0              ; DATA XREF: DoMerTextRes+Do
a_p3s		db '.p3s',0             ; DATA XREF: Load3DShape+15o
a_3sh		db '.3sh',0             ; DATA XREF: Load3DShape+4Do
		db    0
aSdtedit	db 'sdtedit',0          ; DATA XREF: TrackEditRelate+9o
aTedit_0	db 'tedit',0            ; DATA XREF: TrackEditRelate+EBo
aPbox		db 'pbox',0             ; DATA XREF: TrackEditRelate+118o
aSnam		db 'snam',0             ; DATA XREF: TrackEditRelate+131o
aMnam		db 'mnam',0             ; DATA XREF: TrackEditRelate+149o
aTnam		db 'tnam',0             ; DATA XREF: TrackEditRelate+161o
aBti		db 'bti',0              ; DATA XREF: TrackEditRelate+2DAo
aBsc		db 'bsc',0              ; DATA XREF: TrackEditRelate+35Co
aBlo		db 'blo',0              ; DATA XREF: TrackEditRelate+397o
aBsa		db 'bsa',0              ; DATA XREF: TrackEditRelate+3D2o
aBcl_0		db 'bcl',0              ; DATA XREF: TrackEditRelate+40Do
aBex		db 'bex',0              ; DATA XREF: TrackEditRelate+448o
aMss		db 'mss',0              ; DATA XREF: TrackEditRelate+12C9o
aMen_0		db 'men',0              ; DATA XREF: TrackEditRelate+132Bo
aChl		db 'chl',0              ; DATA XREF: TrackEditRelate+13E5o
aTrk_0		db 'trk',0              ; DATA XREF: TrackEditRelate+141Do
a_trk_3		db '.trk',0             ; DATA XREF: TrackEditRelate+1433o
a_trk_4		db '.trk',0             ; DATA XREF: TrackEditRelate+144Eo
aTrk_1		db 'trk',0              ; DATA XREF: TrackEditRelate+14C0o
a_trk_5		db '.trk',0             ; DATA XREF: TrackEditRelate+14EEo
aFex_0		db 'fex',0              ; DATA XREF: TrackEditRelate+1524o
aSer_0		db 'ser',0              ; DATA XREF: TrackEditRelate+159Ao
aChx		db 'chx',0              ; DATA XREF: TrackEditRelate+15FCo
		db    0
aEokenseieemsee	db 'eokenseieemseedewwefuenpestejsejdeteewaefteat',0
					; DATA XREF: TrackEditRelate+B55o
					; TrackEditRelate+114Bo
aTer0		db 'ter0',0             ; DATA XREF: TrackEditRelate+1379o
					; TrackEditRelate+1376w
		db    0
g_arrBigVals12	dw 3B00h, 3C00h, 3D00h,	3E00h, 3F00h, 4000h, 4100h, 4200h
					; DATA XREF: TrackEditRelate+10B2r
		dw 4300h, 4400h, 0, 0
word_2B77_3566	dw 9			; DATA XREF: TrackEditRelate+C75o
		dw 0CAh
		dw 0DCh
		dw 8
		dw 0DCh
word_2B77_3570	dw 0C7h			; DATA XREF: TrackEditRelate+C71o
		dw 0CEh
		dw 13Bh
		dw 0C7h
		dw 13Bh
word_2B77_357A	dw 0B5h			; DATA XREF: TrackEditRelate+C6Do
		dw 4
		dw 84h
		dw 4
		dw 24h
word_2B77_3584	dw 0BBh			; DATA XREF: TrackEditRelate+C69o
		dw 0B3h
		dw 8Bh
		dw 0B3h
		dw 0BBh
unk_2B77_358E	db  1Eh			; DATA XREF: TrackEditRelate+1B02r
					; TrackEditRelate+1B29r
		db    6
unk_2B77_3590	db  1Dh			; DATA XREF: TrackEditRelate+1954r
		db    9
aFlatlakelak1la	db 'flatlakelak1lak2lak3lak4highgoungouwgousgouegou1gou2gou3gou4gou5g'
					; DATA XREF: TrackEditRelate+1Fo
		db 'ou6gou7gou8',0
		db    0
aCrs0crs1crs2cr	db 'crs0crs1crs2crs3',0 ; DATA XREF: TrackEditRelate+33o
		db    0
aUcr0ucr1ucr2uc	db 'ucr0ucr1ucr2ucr3',0 ; DATA XREF: TrackEditRelate+49o
		db    0
word_2B77_3604	dw 0			; DATA XREF: start+4Ew	__myalloc+8r ...
word_2B77_3606	dw 0			; DATA XREF: start+42w
off_2B77_3608	dw offset libsub_1CC5_1B3 ; DATA XREF: start+AAw start+C1r
word_2B77_360A	dw 0			; DATA XREF: start+3Dw	__myalloc+2r ...
		dw seg dseg
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
off_2B77_365A	dw offset word_2B77_360A ; DATA	XREF: _brkctl:loc_1CC5_15F1r
					; _brkctl+61w
aC_file_info	db ';C_FILE_INFO',0
dword_2B77_3669	dd 0			; DATA XREF: start+D2w
					; libsub_1CC5_1FA+Er ...
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_3675	dw 0			; DATA XREF: libsub_1CC5_56C+26w
		db    0
		db    0
		db    0
		db    0
word_2B77_367B	dw 0			; DATA XREF: start+62w	start+ECr ...
byte_2B77_367D	db 0			; DATA XREF: __setargv+Br
					; libsub_1CC5_56C+7r
		align 4
byte_2B77_3680	db 0			; DATA XREF: libsub_1CC5_56Cw
		align 2
word_2B77_3682	dw 14h			; DATA XREF: _lseek+9r	_write+9r ...
		db  81h	; 
		db  81h	; 
		db  81h	; 
		db    1
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_3698	dw 0			; DATA XREF: start+93r	__setargv+C2w
word_2B77_369A	dw 0			; DATA XREF: start+8Fr	__setargv+D4w
word_2B77_369C	dw 0			; DATA XREF: start+8Br	__setenvp+44w
word_2B77_369E	dw 36A2h		; DATA XREF: __setargv+2Dw
					; __setargv+E2r
seg_2B77_36A0	dw seg dseg		; DATA XREF: __setargv+1Aw
		db  43h	; C
		db    0
word_2B77_36A4	dw 0			; DATA XREF: seg010:1B01r
byte_2B77_36A6	db 0			; DATA XREF: libsub_1CC5_1FA+18r
byte_2B77_36A7	db 0			; DATA XREF: libsub_1CC5_1FA+20r
dword_2B77_36A8	dd 0			; DATA XREF: libsub_1CC5_1FA+23r
unk_2B77_36AC	db    0			; DATA XREF: seg010:024Dr
		db    0
word_2B77_36AE	dw 0			; DATA XREF: seg010:0246r
dword_2B77_36B0	dd 0FFFFFFFFh		; DATA XREF: __chkstk:loc_1CC5_277r
					; __chkstk+20r
word_2B77_36B4	dw 0AE20h		; DATA XREF: __chkstk+8r
					; _stackavail+2r
dword_2B77_36B6	dd 0			; DATA XREF: __setargvw __setargv+18Er ...
		db    0
		db  16h
		db    2
		db    2
		db  18h
		db  0Dh
		db    9
		db  0Ch
		db  0Ch
		db  0Ch
		db    7
		db    8
		db  16h
		db  16h
		db 0FFh
		db  12h
		db  0Dh
		db  12h
		db    2
		db 0FFh
word_2B77_36CE	dw 0			; DATA XREF: __flsbuf+92w __stbuf+Aw
		db  76h	; v
		db  93h	; “
		db    0
		db    0
		db  76h	; v
		db  93h	; “
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    2
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    2
		db    2
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db  84h	; „
		db    3
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    2
		db    4
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db    2
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_37E8	dw 3768h		; DATA XREF: _flushall:loc_1CC5_5C0r
aNull		db '(null)',0
aNull_0		db '(null)',0
		db '+- #',0
		align 2
word_2B77_37FE	dw 0			; DATA XREF: unknown_libname_2+1Fw
word_2B77_3800	dw 0			; DATA XREF: unknown_libname_2+22w
		align 4
word_2B77_3804	dw 0			; DATA XREF: unknown_libname_2+32w
		align 4
word_2B77_3808	dw 0			; DATA XREF: __amalloc+A2r
		align 4
word_2B77_380C	dw 0			; DATA XREF: __amalloc+4Fw
					; __amalloc+D6w
word_2B77_380E	dw 2000h		; DATA XREF: __amexpand:loc_1CC5_1564r
		db    0
		db    0
byte_2B77_3812	db 0			; DATA XREF: __amalloc:loc_1CC5_14C9w
					; __amalloc:loc_1CC5_1504w
		align 2
off_2B77_3814	dd loc_1CC5_25E		; DATA XREF: libsub_1CC5_EC0+53r
off_2B77_3818	dd loc_1CC5_25E		; DATA XREF: libsub_1CC5_EC0+6Br
		dd loc_1CC5_25E
off_2B77_3820	dd loc_1CC5_25E		; DATA XREF: libsub_1CC5_EC0+84r
off_2B77_3824	dd loc_1CC5_25E		; DATA XREF: libsub_1CC5_EC0+A2r
word_2B77_3828	dw 0			; DATA XREF: _signal:loc_1CC5_1A78r
					; _signal+5Aw ...
word_2B77_382A	dw 0			; DATA XREF: _signal+5Ew seg010:1B35r
		db    1
		db    0
		db    0
g_arrSlashS	db  20h			; DATA XREF: DoDialog+58Br
					; DoDialog+592r ...
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  28h	; (
		db  28h	; (
		db  28h	; (
		db  28h	; (
		db  28h	; (
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  48h	; H
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  84h	; „
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  81h	; 
		db  81h	; 
		db  81h	; 
		db  81h	; 
		db  81h	; 
		db  81h	; 
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db    1
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  10h
		db  82h	; ‚
		db  82h	; ‚
		db  82h	; ‚
		db  82h	; ‚
		db  82h	; ‚
		db  82h	; ‚
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db    2
		db  10h
		db  10h
		db  10h
		db  10h
		db  20h
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_3930	dw 1			; DATA XREF: _srand+6w	_rand+Cr ...
word_2B77_3932	dw 0			; DATA XREF: _srand+9w	_rand+8r ...
word_2B77_3934	dw 0			; DATA XREF: seg010:1B08r seg010:1B58w
word_2B77_3936	dw 0			; DATA XREF: seg010:1B0Br seg010:1B5Bw
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
dword_2B77_394C	dd 0			; DATA XREF: seg010:loc_1CC5_1B49w
					; seg010:1B63r	...
byte_2B77_3950	db 0, 1, 1, 2, 3, 3, 4,	4, 5, 6, 6, 7, 8, 8, 9,	0Ah, 0Ah
					; DATA XREF: GetAngleFromXZ+36r
		db 0Bh,	0Bh, 0Ch, 0Dh, 0Dh, 0Eh, 0Fh, 0Fh, 10h,	10h, 11h
		db 12h,	12h, 13h, 14h, 14h, 15h, 16h, 16h, 17h,	17h, 18h
		db 19h,	19h, 1Ah, 1Bh, 1Bh, 1Ch, 1Ch, 1Dh, 1Eh,	1Eh, 1Fh
		db 1Fh,	20h, 21h, 21h, 22h, 22h, 23h, 24h, 24h,	25h, 26h
		db 26h,	27h, 27h, 28h, 29h, 29h, 2Ah, 2Ah, 2Bh,	2Ch, 2Ch
		db 2Dh,	2Dh, 2Eh, 2Eh, 2Fh, 30h, 30h, 31h, 31h,	32h, 33h
		db 33h,	34h, 34h, 35h, 35h, 36h, 37h, 37h, 38h,	38h, 39h
		db 39h,	3Ah, 3Ah, 3Bh, 3Ch, 3Ch, 3Dh, 3Dh, 3Eh,	3Eh, 3Fh
		db 3Fh,	40h, 41h, 41h, 42h, 42h, 43h, 43h, 44h,	44h, 45h
		db 45h,	46h, 46h, 47h, 47h, 48h, 48h, 49h, 4Ah,	4Ah, 4Bh
		db 4Bh,	4Ch, 4Ch, 4Dh, 4Dh, 4Eh, 4Eh, 4Fh, 4Fh,	50h, 50h
		db 51h,	51h, 52h, 52h, 53h, 53h, 54h, 54h, 54h,	55h, 55h
		db 56h,	56h, 57h, 57h, 58h, 58h, 59h, 59h, 5Ah,	5Ah, 5Bh
		db 5Bh,	5Bh, 5Ch, 5Ch, 5Dh, 5Dh, 5Eh, 5Eh, 5Fh,	5Fh, 60h
		db 60h,	60h, 61h, 61h, 62h, 62h, 63h, 63h, 63h,	64h, 64h
		db 65h,	65h, 66h, 66h, 66h, 67h, 67h, 68h, 68h,	68h, 69h
		db 69h,	6Ah, 6Ah, 6Ah, 6Bh, 6Bh, 6Ch, 6Ch, 6Ch,	6Dh, 6Dh
		db 6Eh,	6Eh, 6Eh, 6Fh, 6Fh, 70h, 70h, 70h, 71h,	71h, 71h
		db 72h,	72h, 73h, 73h, 73h, 74h, 74h, 74h, 75h,	75h, 76h
		db 76h,	76h, 77h, 77h, 77h, 78h, 78h, 78h, 79h,	79h, 79h
		db 7Ah,	7Ah, 7Ah, 7Bh, 7Bh, 7Bh, 7Ch, 7Ch, 7Ch,	7Dh, 7Dh
		db 7Dh,	7Eh, 7Eh, 7Eh, 7Fh, 7Fh, 7Fh, 80h, 80h,	0
g_wAddedValue1	dw 0			; DATA XREF: SetAddValue+Ew
					; seg012:00E0r	...
g_wAddedValue2	dw 0			; DATA XREF: SetAddValue+11w
					; seg012:00DAr	...
		db    0
		db    0
		dw 3
		dw 0Ch
		dw 0Fh
		dw 30h
		dw 33h
		dw 3Ch
		dw 3Fh
		dw 0C0h
		dw 0C3h
		dw 0CCh
		dw 0CFh
		dw 0F0h
		dw 0F3h
		dw 0FCh
		dw 0FFh
		dw 300h
		dw 303h
		dw 30Ch
		dw 30Fh
		dw 330h
		dw 333h
		dw 33Ch
		dw 33Fh
		dw 3C0h
		dw 3C3h
		dw 3CCh
		dw 3CFh
		dw 3F0h
		dw 3F3h
		dw 3FCh
		dw 3FFh
		dw 0C00h
g_pwTripleTable	dw 0C03h		; DATA XREF: SkyBoxOp+44o
		dw 0C0Ch
		dw 0C0Fh
		dw 0C30h
		dw 0C33h
		dw 0C3Ch
		dw 0C3Fh
		dw 0CC0h
		dw 0CC3h
		dw 0CCCh
		dw 0CCFh
		dw 0CF0h
		dw 0CF3h
		dw 0CFCh
		dw 0CFFh
		dw 0F00h
		dw 0F03h
		dw 0F0Ch
		dw 0F0Fh
		dw 0F30h
		dw 0F33h
		dw 0F3Ch
		dw 0F3Fh
		dw 0FC0h
		dw 0FC3h
		dw 0FCCh
		dw 0FCFh
		dw 0FF0h
		dw 0FF3h
		dw 0FFCh
		dw 0FFFh
		dw 3000h
		dw 3003h
		dw 300Ch
		dw 300Fh
		dw 3030h
		dw 3033h
		dw 303Ch
		dw 303Fh
		dw 30C0h
		dw 30C3h
		dw 30CCh
		dw 30CFh
		dw 30F0h
		dw 30F3h
		dw 30FCh
		dw 30FFh
		dw 3300h
		dw 3303h
		dw 330Ch
		dw 330Fh
		dw 3330h
		dw 3333h
		dw 333Ch
		dw 333Fh
		dw 33C0h
		dw 33C3h
		dw 33CCh
		dw 33CFh
		dw 33F0h
		dw 33F3h
		dw 33FCh
		dw 33FFh
		dw 3C00h
		dw 3C03h
		dw 3C0Ch
		dw 3C0Fh
		dw 3C30h
		dw 3C33h
		dw 3C3Ch
		dw 3C3Fh
		dw 3CC0h
		dw 3CC3h
		dw 3CCCh
		dw 3CCFh
		dw 3CF0h
		dw 3CF3h
		dw 3CFCh
		dw 3CFFh
		dw 3F00h
		dw 3F03h
		dw 3F0Ch
		dw 3F0Fh
		dw 3F30h
		dw 3F33h
		dw 3F3Ch
		dw 3F3Fh
		dw 3FC0h
		dw 3FC3h
		dw 3FCCh
		dw 3FCFh
		dw 3FF0h
		dw 3FF3h
		dw 3FFCh
		dw 3FFFh
		dw 0C000h
		dw 0C003h
		dw 0C00Ch
		dw 0C00Fh
		dw 0C030h
		dw 0C033h
		dw 0C03Ch
		dw 0C03Fh
		dw 0C0C0h
		dw 0C0C3h
		dw 0C0CCh
		dw 0C0CFh
		dw 0C0F0h
		dw 0C0F3h
		dw 0C0FCh
		dw 0C0FFh
		dw 0C300h
		dw 0C303h
		dw 0C30Ch
		dw 0C30Fh
		dw 0C330h
		dw 0C333h
		dw 0C33Ch
		dw 0C33Fh
		dw 0C3C0h
		dw 0C3C3h
		dw 0C3CCh
		dw 0C3CFh
		dw 0C3F0h
		dw 0C3F3h
		dw 0C3FCh
		dw 0C3FFh
		dw 0CC00h
		dw 0CC03h
		dw 0CC0Ch
		dw 0CC0Fh
		dw 0CC30h
		dw 0CC33h
		dw 0CC3Ch
		dw 0CC3Fh
		dw 0CCC0h
		dw 0CCC3h
		dw 0CCCCh
		dw 0CCCFh
		dw 0CCF0h
		dw 0CCF3h
		dw 0CCFCh
		dw 0CCFFh
		dw 0CF00h
		dw 0CF03h
		dw 0CF0Ch
		dw 0CF0Fh
		dw 0CF30h
		dw 0CF33h
		dw 0CF3Ch
		dw 0CF3Fh
		dw 0CFC0h
		dw 0CFC3h
		dw 0CFCCh
		dw 0CFCFh
		dw 0CFF0h
		dw 0CFF3h
		dw 0CFFCh
		dw 0CFFFh
		dw 0F000h
		dw 0F003h
		dw 0F00Ch
		dw 0F00Fh
		dw 0F030h
		dw 0F033h
		dw 0F03Ch
		dw 0F03Fh
		dw 0F0C0h
		dw 0F0C3h
		dw 0F0CCh
		dw 0F0CFh
		dw 0F0F0h
		dw 0F0F3h
		dw 0F0FCh
		dw 0F0FFh
		dw 0F300h
		dw 0F303h
		dw 0F30Ch
		dw 0F30Fh
		dw 0F330h
		dw 0F333h
		dw 0F33Ch
		dw 0F33Fh
		dw 0F3C0h
		dw 0F3C3h
		dw 0F3CCh
		dw 0F3CFh
		dw 0F3F0h
		dw 0F3F3h
		dw 0F3FCh
		dw 0F3FFh
		dw 0FC00h
		dw 0FC03h
		dw 0FC0Ch
		dw 0FC0Fh
		dw 0FC30h
		dw 0FC33h
		dw 0FC3Ch
		dw 0FC3Fh
		dw 0FCC0h
		dw 0FCC3h
		dw 0FCCCh
		dw 0FCCFh
		dw 0FCF0h
		dw 0FCF3h
		dw 0FCFCh
		dw 0FCFFh
		dw 0FF00h
		dw 0FF03h
		dw 0FF0Ch
		dw 0FF0Fh
		dw 0FF30h
		dw 0FF33h
		dw 0FF3Ch
		dw 0FF3Fh
		dw 0FFC0h
		dw 0FFC3h
		dw 0FFCCh
		dw 0FFCFh
		dw 0FFF0h
		dw 0FFF3h
		dw 0FFFCh
		dw 0FFFFh
		dw 28h			; 28h =	40, number of following	offsets	+ numbers
g_pIncSizeTbls	dw offset byte_2B77_3CA8 ; DATA	XREF: SpritePutpixel+D8r
		dw offset byte_2B77_3CA8
		dw offset byte_2B77_3CA9
		dw offset byte_2B77_3CAB
		dw offset byte_2B77_3CAE
		dw offset byte_2B77_3CB2
		dw offset byte_2B77_3CB7
		dw offset byte_2B77_3CBD
		dw offset byte_2B77_3CC4
		dw offset byte_2B77_3CCC
		dw offset byte_2B77_3CD5
		dw offset byte_2B77_3CDF
		dw offset byte_2B77_3CEA
		dw offset byte_2B77_3CF6
		dw offset byte_2B77_3D03
		dw offset byte_2B77_3D11
		dw offset byte_2B77_3D20
		dw offset byte_2B77_3D30
		dw offset byte_2B77_3D41
		dw offset byte_2B77_3D53
		dw offset byte_2B77_3D66
		dw offset byte_2B77_3D7A
		dw offset byte_2B77_3D8F
		dw offset byte_2B77_3DA5
		dw offset byte_2B77_3DBC
		dw offset byte_2B77_3DD4
		dw offset byte_2B77_3DED
		dw offset byte_2B77_3E07
		dw offset byte_2B77_3E22
		dw offset byte_2B77_3E3E
		dw offset byte_2B77_3E5B
		dw offset byte_2B77_3E79
		dw offset byte_2B77_3E98
		dw offset byte_2B77_3EB8
		dw offset byte_2B77_3ED9
		dw offset byte_2B77_3EFB
		dw offset byte_2B77_3F1E
		dw offset byte_2B77_3F42
		dw offset byte_2B77_3F67
		dw offset byte_2B77_3F8D
byte_2B77_3CA8	db 1			; DATA XREF: dseg:g_pIncSizeTblso
					; dseg:3C5Ao
byte_2B77_3CA9	db 2, 3			; DATA XREF: dseg:3C5Co
byte_2B77_3CAB	db 3, 4, 4		; DATA XREF: dseg:3C5Eo
byte_2B77_3CAE	db 3, 4, 5, 5		; DATA XREF: dseg:3C60o
byte_2B77_3CB2	db 4, 5, 6, 6, 6	; DATA XREF: dseg:3C62o
byte_2B77_3CB7	db 4, 6, 6, 7, 7, 8	; DATA XREF: dseg:3C64o
byte_2B77_3CBD	db 5, 6, 7, 8, 8, 9, 9	; DATA XREF: dseg:3C66o
byte_2B77_3CC4	db 5, 7, 8, 9, 9, 0Ah, 0Ah, 0Ah	; DATA XREF: dseg:3C68o
byte_2B77_3CCC	db 5, 7, 8, 9, 0Ah, 0Bh, 0Bh, 0Bh, 0Bh ; DATA XREF: dseg:3C6Ao
byte_2B77_3CD5	db 5, 8, 9, 0Ah, 0Bh, 0Bh, 0Ch,	0Ch, 0Ch, 0Dh ;	DATA XREF: dseg:3C6Co
byte_2B77_3CDF	db 6, 8, 9, 0Bh, 0Ch, 0Ch, 0Dh,	0Dh, 0Eh, 0Eh, 0Eh ; DATA XREF:	dseg:3C6Eo
byte_2B77_3CEA	db 6, 8, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh, 0Eh, 0Fh, 0Fh, 0Fh, 0Fh
					; DATA XREF: dseg:3C70o
byte_2B77_3CF6	db 6, 9, 0Ah, 0Ch, 0Dh,	0Eh, 0Eh, 0Fh, 0Fh, 10h, 10h, 10h
					; DATA XREF: dseg:3C72o
		db 10h
byte_2B77_3D03	db 6, 9, 0Bh, 0Ch, 0Dh,	0Eh, 0Fh, 10h, 10h, 11h, 11h, 11h
					; DATA XREF: dseg:3C74o
		db 11h,	12h
byte_2B77_3D11	db 7, 9, 0Bh, 0Dh, 0Eh,	0Fh, 10h, 11h, 11h, 12h, 12h, 12h
					; DATA XREF: dseg:3C76o
		db 13h,	13h, 13h
byte_2B77_3D20	db 7, 0Ah, 0Ch,	0Dh, 0Fh, 10h, 11h, 11h, 12h, 13h, 13h
					; DATA XREF: dseg:3C78o
		db 13h,	14h, 14h, 14h, 14h
byte_2B77_3D30	db 7, 0Ah, 0Ch,	0Eh, 0Fh, 10h, 11h, 12h, 13h, 13h, 14h
					; DATA XREF: dseg:3C7Ao
		db 14h,	15h, 15h, 15h, 15h, 15h
byte_2B77_3D41	db 7, 0Ah, 0Ch,	0Eh, 10h, 11h, 12h, 2 dup(13h),	14h, 2 dup(15h)
					; DATA XREF: dseg:3C7Co
		db 5 dup(16h), 17h
byte_2B77_3D53	db 8, 0Bh, 0Dh,	0Fh, 10h, 11h, 12h, 13h, 14h, 15h, 2 dup(16h)
					; DATA XREF: dseg:3C7Eo
		db 4 dup(17h), 3 dup(18h)
byte_2B77_3D66	db 8, 0Bh, 0Dh,	0Fh, 11h, 12h, 13h, 14h, 15h, 2	dup(16h)
					; DATA XREF: dseg:3C80o
		db 2 dup(17h), 3 dup(18h), 4 dup(19h)
byte_2B77_3D7A	db 8, 0Bh, 0Eh,	0Fh, 11h, 12h, 14h, 15h, 2 dup(16h), 17h
					; DATA XREF: dseg:3C82o
		db 2 dup(18h), 3 dup(19h), 5 dup(1Ah)
byte_2B77_3D8F	db 8, 0Bh, 0Eh,	10h, 11h, 13h, 14h, 15h, 16h, 17h, 2 dup(18h)
					; DATA XREF: dseg:3C84o
		db 19h,	3 dup(1Ah), 5 dup(1Bh),	1Ch
byte_2B77_3DA5	db 8, 0Ch, 0Eh,	10h, 12h, 13h, 15h, 16h, 17h, 18h, 2 dup(19h)
					; DATA XREF: dseg:3C86o
		db 2 dup(1Ah), 2 dup(1Bh), 3 dup(1Ch), 4 dup(1Dh)
byte_2B77_3DBC	db 9, 0Ch, 0Fh,	11h, 12h, 14h, 15h, 16h, 17h, 18h, 19h
					; DATA XREF: dseg:3C88o
		db 1Ah,	2 dup(1Bh), 2 dup(1Ch),	3 dup(1Dh), 5 dup(1Eh)
byte_2B77_3DD4	db 9, 0Ch, 0Fh,	11h, 13h, 14h, 16h, 17h, 18h, 19h, 1Ah
					; DATA XREF: dseg:3C8Ao
		db 2 dup(1Bh), 1Ch, 2 dup(1Dh),	3 dup(1Eh), 6 dup(1Fh)
byte_2B77_3DED	db 9, 0Dh, 0Fh,	11h, 13h, 15h, 16h, 17h, 19h, 1Ah, 2 dup(1Bh)
					; DATA XREF: dseg:3C8Co
		db 1Ch,	2 dup(1Dh), 2 dup(1Eh),	2 dup(1Fh), 6 dup(20h)
		db 21h
byte_2B77_3E07	db 9, 0Dh, 0Fh,	12h, 14h, 15h, 17h, 18h, 19h, 1Ah, 1Bh
					; DATA XREF: dseg:3C8Eo
		db 1Ch,	1Dh, 2 dup(1Eh), 2 dup(1Fh), 2 dup(20h), 4 dup(21h)
		db 4 dup(22h)
byte_2B77_3E22	db 9, 0Dh, 10h,	12h, 14h, 16h, 17h, 18h, 1Ah, 1Bh, 1Ch
					; DATA XREF: dseg:3C90o
		db 1Dh,	2 dup(1Eh), 1Fh, 2 dup(20h), 2 dup(21h), 4 dup(22h)
		db 5 dup(23h)
byte_2B77_3E3E	db 9, 0Dh, 10h,	12h, 14h, 16h, 18h, 19h, 1Ah, 1Bh, 1Ch
					; DATA XREF: dseg:3C92o
		db 1Dh,	1Eh, 1Fh, 2 dup(20h), 21h, 3 dup(22h), 3 dup(23h)
		db 6 dup(24h)
byte_2B77_3E5B	db 0Ah,	0Dh, 10h, 13h, 15h, 17h, 18h, 19h, 1Bh,	1Ch, 1Dh
					; DATA XREF: dseg:3C94o
		db 1Eh,	1Fh, 2 dup(20h), 21h, 2	dup(22h), 2 dup(23h), 3	dup(24h)
		db 6 dup(25h), 26h
byte_2B77_3E79	db 0Ah,	0Eh, 11h, 13h, 15h, 17h, 19h, 1Ah, 1Bh,	1Dh, 1Eh
					; DATA XREF: dseg:3C96o
		db 1Fh,	2 dup(20h), 21h, 22h, 2	dup(23h), 2 dup(24h), 3	dup(25h)
		db 4 dup(26h), 4 dup(27h)
byte_2B77_3E98	db 0Ah,	0Eh, 11h, 13h, 15h, 17h, 19h, 1Ah, 1Ch,	1Dh, 1Eh
					; DATA XREF: dseg:3C98o
		db 1Fh,	20h, 21h, 22h, 2 dup(23h), 24h,	2 dup(25h), 3 dup(26h)
		db 3 dup(27h), 6 dup(28h)
byte_2B77_3EB8	db 0Ah,	0Eh, 11h, 14h, 16h, 18h, 19h, 1Bh, 1Ch,	1Eh, 1Fh
					; DATA XREF: dseg:3C9Ao
		db 20h,	21h, 22h, 2 dup(23h), 24h, 2 dup(25h), 2 dup(26h)
		db 2 dup(27h), 3 dup(28h), 7 dup(29h)
byte_2B77_3ED9	db 0Ah,	0Eh, 11h, 14h, 16h, 18h, 1Ah, 1Bh, 1Dh,	1Eh, 1Fh
					; DATA XREF: dseg:3C9Co
		db 20h,	21h, 22h, 23h, 24h, 25h, 2 dup(26h), 2 dup(27h)
		db 2 dup(28h), 3 dup(29h), 7 dup(2Ah), 2Bh
byte_2B77_3EFB	db 0Ah,	0Fh, 12h, 14h, 17h, 18h, 1Ah, 1Ch, 1Dh,	1Fh, 20h
					; DATA XREF: dseg:3C9Eo
		db 21h,	22h, 23h, 24h, 25h, 2 dup(26h),	27h, 2 dup(28h)
		db 2 dup(29h), 3 dup(2Ah), 5 dup(2Bh), 4 dup(2Ch)
byte_2B77_3F1E	db 0Bh,	0Fh, 12h, 15h, 17h, 19h, 1Bh, 1Ch, 1Eh,	1Fh, 20h
					; DATA XREF: dseg:3CA0o
		db 22h,	23h, 24h, 2 dup(25h), 26h, 27h,	2 dup(28h), 2 dup(29h)
		db 2 dup(2Ah), 2 dup(2Bh), 4 dup(2Ch), 6 dup(2Dh)
byte_2B77_3F42	db 0Bh,	0Fh, 12h, 15h, 17h, 19h, 1Bh, 1Dh, 1Eh,	20h, 21h
					; DATA XREF: dseg:3CA2o
		db 22h,	23h, 24h, 25h, 26h, 27h, 2 dup(28h), 29h, 2 dup(2Ah)
		db 2 dup(2Bh), 2 dup(2Ch), 4 dup(2Dh), 7 dup(2Eh)
byte_2B77_3F67	db 0Bh,	0Fh, 12h, 15h, 18h, 1Ah, 1Bh, 1Dh, 1Fh,	20h, 21h
					; DATA XREF: dseg:3CA4o
		db 23h,	24h, 25h, 26h, 27h, 2 dup(28h),	29h, 2 dup(2Ah)
		db 2Bh,	2 dup(2Ch), 3 dup(2Dh),	3 dup(2Eh), 7 dup(2Fh)
		db 30h
byte_2B77_3F8D	db 0Bh,	0Fh, 13h, 16h, 18h, 1Ah, 1Ch, 1Eh, 1Fh,	21h, 22h
					; DATA XREF: dseg:3CA6o
		db 23h,	24h, 25h, 26h, 27h, 28h, 29h, 2Ah, 2 dup(2Bh)
		db 2 dup(2Ch), 2Dh, 3 dup(2Eh),	3 dup(2Fh), 5 dup(30h)
		db 4 dup(31h)
g_arrFuncs	dw 16h dup(0)		; DATA XREF: AddExitHandler+9o
					; CallExitHandls+Dr ...
aExitListOverfl	db 'EXIT LIST OVERFLOW',0Dh,0Ah,0 ; DATA XREF: AddExitHandler+23o
		db    0
aSFileError_1	db '%s FILE ERROR',0    ; DATA XREF: _AltFileSize:loc_1EA2_14ADo
					; Read4BytesFromF:loc_1EA2_15A4o
g_pcFoundFile	db 57h dup(0)		; DATA XREF: FindFileName+18o
					; FindFileName+4Eo
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
p_ppcFoundFileP	dw 0			; DATA XREF: FindFileName+1Bw
					; FindFileName:loc_1EA2_15EBw ...
g_pcDtaBuffer	dw 0Fh dup(0)		; DATA XREF: FindFileName+6o
					; FindNext+6o
g_pcFoundFilePa	db 8 dup(0)		; DATA XREF: FindFileName+41o
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
byte_2B77_40EA	db 0			; DATA XREF: SetBiosMode4+1w
					; SetBiosMode7+1r
		align 2
g_arrVideoThing	db 35h,	28h, 2Ch, 7, 79h, 2, 64h, 6Eh, 2 dup(2), 2 dup(0)
					; DATA XREF: SetBiosMode4+37r
		db  61h	; a
		db  50h	; P
		db  52h	; R
		db  0Fh
		db  19h
		db    6
		db  19h
		db  19h
		db    2
		db  0Dh
		db  0Bh
		db  0Ch
g_dwOldTimerInt	dd 0			; DATA XREF: SetupTimerCallb+8Ew
					; StopSoundMaybe+20r ...
g_dwTimerCounte	dd 0			; DATA XREF: seg012:1947w
					; GetTimerCounter+1r ...
g_wOrigValue1	dw 0			; DATA XREF: GetValue+1r seg012:191Fw
g_wOrigValue2	dw 0			; DATA XREF: GetValue+4r seg012:1925w
g_cTimerFlag	db 0			; DATA XREF: seg012:1778w
					; SetupTimerCallb+10w ...
g_cTimerFlag2	db 0			; DATA XREF: SetupTimerCallb+15w
					; SetupTimerCallb+36w ...
g_cTimerFlag3	dw 0			; DATA XREF: seg012:1772w
					; SetupTimerCallb+52w ...
word_2B77_4114	dw 0			; DATA XREF: seg012:1766w
					; SetupTimerCallb+4w ...
word_2B77_4116	dw 0			; DATA XREF: seg012:176Cw
					; SetupTimerCallb+Aw ...
word_2B77_4118	dw 0			; DATA XREF: seg012:1979r seg012:197Fw
word_2B77_411A	dw 0			; DATA XREF: seg012:loc_1EA2_1972w
					; seg012:1976r	...
byte_2B77_411C	db 0			; DATA XREF: SetupTimerCallb+5Ew
					; seg012:1954r	...
		db    3
g_wIsInputMetho	dw 0			; DATA XREF: RunGame+2D4w
					; DoJoyResText+Cw ...
g_wTimerIntr	dw 0Eh dup(0)		; DATA XREF: SetupTimerCallb+63w
					; AddTimerFunc+6o ...
aNoRoomLeftOnTi	db 'NO ROOM LEFT ON TIMER INTERRUPT ROUTINE LIST',0Dh,0
					; DATA XREF: AddTimerFunc+14o
g_pcFuncPtrFlag	db 80h dup(0)		; DATA XREF: ParseKbKey+21r
					; RegSomeFuncPtr+3Bw
g_pcFuncPtrFlg2	db 84h dup(0)		; DATA XREF: ParseKbKey:loc_1EA2_1A2Er
					; RegSomeFuncPtr+4Bw
		db    0
		db    0
g_bIsParsingKey	db 0			; DATA XREF: ParseKbKey+4r
					; ParseKbKey:loc_1EA2_19F2w ...
		db    0
g_pFuncOfs	db 100h	dup(0)		; DATA XREF: ParseKbKey+2Er
					; RegSomeFuncPtr+9o
		db    0
		db    0
		db    0
		db  48h	; H
		db    0
		db  50h	; P
		db    0
		db    0
		db    0
		db  4Dh	; M
		db    0
		db  49h	; I
		db    0
		db  51h	; Q
		db    0
		db    0
		db    0
		db  4Bh	; K
		db    0
		db  47h	; G
		db    0
		db  4Fh	; O
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_4392	dw 0			; DATA XREF: seg012:loc_1EA2_1AD6r
					; seg012:1AEBw
word_2B77_4394	dw 0			; DATA XREF: seg012:loc_1EA2_1ADFr
					; seg012:1AF4w
byte_2B77_4396	db 0			; DATA XREF: seg012:1AE5w
					; seg012:loc_1EA2_1AEFw
		align 2
g_pKbScanCodes	db 39h,	1Ch, 47h, 48h, 49h, 4Dh, 51h, 50h, 4Fh,	4Bh
					; DATA XREF: GetKbOrJoyFlags+4r
					; seg012:1BACr	...
g_wJoyFlag1	dw 0			; DATA XREF: GetJoystickFlag+18w
					; GetJoystickFlag:loc_1EA2_1C2Fw ...
g_wJoyFlag2	dw 0			; DATA XREF: GetJoystickFlag+1Ew
					; GetJoystickFlag+47w ...
g_bJoyButton	db 0			; DATA XREF: GetJoystickFlag+13w
					; GetJoystickFlag+19Fr
g_bJoyInput	db 0			; DATA XREF: GetJoystickFlag:loc_1EA2_1BE6w
					; GetJoystickFlag+F5w ...
word_2B77_43A8	dw 50h			; DATA XREF: GetJoystickFlag+60r
					; GetJoystickFlag+7Cw ...
word_2B77_43AA	dw 0			; DATA XREF: GetJoystickFlag+6Cr
					; GetJoystickFlag+72w ...
word_2B77_43AC	dw 0			; DATA XREF: GetJoystickFlag+80r
					; GetJoystickFlag:loc_1EA2_1C91r ...
word_2B77_43AE	dw 0			; DATA XREF: GetJoystickFlag+C1r
					; GetJoystickFlag+C7w ...
word_2B77_43B0	dw 14h			; DATA XREF: GetJoystickFlag+66w
					; GetJoystickFlag+BBw ...
word_2B77_43B2	dw 0			; DATA XREF: GetJoystickFlag+ACw
					; GetJoystickFlag:loc_1EA2_1CC5r
word_2B77_43B4	dw 0			; DATA XREF: GetJoystickFlag+A5w
					; GetJoystickFlag+EFr
word_2B77_43B6	dw 50h			; DATA XREF: GetJoystickFlag+FDr
					; GetJoystickFlag+119w	...
word_2B77_43B8	dw 0			; DATA XREF: GetJoystickFlag+109r
					; GetJoystickFlag+10Fw	...
word_2B77_43BA	dw 0			; DATA XREF: GetJoystickFlag+11Dr
					; GetJoystickFlag:loc_1EA2_1D35r ...
word_2B77_43BC	dw 0			; DATA XREF: GetJoystickFlag+165r
					; GetJoystickFlag+16Bw	...
word_2B77_43BE	dw 14h			; DATA XREF: GetJoystickFlag+103w
					; GetJoystickFlag+15Fw	...
word_2B77_43C0	dw 0			; DATA XREF: GetJoystickFlag+149w
					; GetJoystickFlag:loc_1EA2_1D69r
word_2B77_43C2	dw 0			; DATA XREF: GetJoystickFlag+142w
					; GetJoystickFlag+193r
word_2B77_43C4	dw 0			; DATA XREF: GetJoystickFlag+91w
					; CheckJoyFlag:loc_1EA2_1DCEr
word_2B77_43C6	dw 0			; DATA XREF: GetJoystickFlag+12Ew
					; nopsub_1EA2_1DDA:loc_1EA2_1DE5r
g_pcArray	db 0, 1, 5, 0, 3, 2, 4,	3, 7, 8, 6, 7, 0, 1, 5,	0
					; DATA XREF: LookupArray+9r
word_2B77_43D8	dw 0			; DATA XREF: SetupSomeHandlers+18w
					; StopIntsModPsp+Cr
word_2B77_43DA	dw 0			; DATA XREF: SetupSomeHandlers+21w
					; StopIntsModPsp+19r
word_2B77_43DC	dw 0			; DATA XREF: SetupSomeHandlers+36w
					; StopIntsModPsp+22r
word_2B77_43DE	dw 0			; DATA XREF: SetupSomeHandlers+3Fw
					; StopIntsModPsp+2Br
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_4460	dw 0			; DATA XREF: SomeIntrHandler:loc_1EA2_1F15r
					; SomeIntrHandler:loc_1EA2_1F29w ...
word_2B77_4462	dw 0			; DATA XREF: SomeIntrHandler+9Bw
					; SomeIntrHandler2+26r	...
word_2B77_4464	dw 2			; DATA XREF: SomeIntrHandler+7Br
					; SomeIntrHandler+8Er ...
word_2B77_4466	dw 0			; DATA XREF: SomeIntrHandler+87r
					; SomeIntrHandler:loc_1EA2_1F44w ...
word_2B77_4468	dw 0			; DATA XREF: SomeIntrHandler:loc_1EA2_1EDFw
g_pKbInput	db 5Ah dup(0)		; DATA XREF: GetKbOrJoyFlags+8r
					; GetKbOrJoyFlags+15r ...
		db    0
a1234567890Qwer	db 1Bh,'1234567890-=',8,9,'qwertyuiop[]',0Dh,0
aAsdfghjkl	db 'asdfghjkl;',27h,'`',0
aZxcvbnm_	db '\zxcvbnm,./',0
		db '*',0
		db ' ',0
		db 0BBh	; »
		db '¼½¾¿ÀÁÂÃÄ',0
		db    0
		db 0C7h	; Ç
		db 0C8h	; È
		db 0C9h	; É
		db  2Dh	; -
		db 0CBh	; Ë
		db 0CCh	; Ì
		db 0CDh	; Í
		db  2Bh	; +
		db 0CFh	; Ï
		db 0D0h	; Ð
		db 0D1h	; Ñ
		db 0D2h	; Ò
		db 0D3h	; Ó
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
a@_Pqwertyuiop	db 1Bh,'!@#$%^&*()_+',8,'QWERTYUIOP{}',0Dh,0
aAsdfghjkl_0	db 'ASDFGHJKL:"~',0
aZxcvbnm?	db '|ZXCVBNM<>?',0
		db    0
		db    0
		db  20h
		db    0
		db 0D4h	; Ô
		db 0D5h	; Õ
		db 0D6h	; Ö
		db 0D7h	; ×
		db 0D8h	; Ø
		db 0D9h	; Ù
		db 0DAh	; Ú
		db 0DBh	; Û
		db 0DCh	; Ü
		db 0DDh	; Ý
		db    0
		db    0
		db 0C7h	; Ç
		db 0C8h	; È
		db 0C9h	; É
		db  2Dh	; -
		db 0CBh	; Ë
		db 0CCh	; Ì
		db 0CDh	; Í
		db  2Bh	; +
		db 0CFh	; Ï
		db 0D0h	; Ð
		db 0D1h	; Ñ
		db 0D2h	; Ò
		db 0D3h	; Ó
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
a1234567890Pqwe	db 1Bh,'1234567890-=',8,'QWERTYUIOP[]',0Dh,0
aAsdfghjkl_1	db 'ASDFGHJKL;',27h,'`',0
aZxcvbnm__0	db '\ZXCVBNM,./',0
		db    0
		db    0
		db  20h
		db    0
		db 0D4h	; Ô
		db 0D5h	; Õ
		db 0D6h	; Ö
		db 0D7h	; ×
		db 0D8h	; Ø
		db 0D9h	; Ù
		db 0DAh	; Ú
		db 0DBh	; Û
		db 0DCh	; Ü
		db 0DDh	; Ý
		db    0
		db    0
		db 0C7h	; Ç
		db 0C8h	; È
		db 0C9h	; É
		db  2Dh	; -
		db 0CBh	; Ë
		db 0CCh	; Ì
		db 0CDh	; Í
		db  2Bh	; +
		db 0CFh	; Ï
		db 0D0h	; Ð
		db 0D1h	; Ñ
		db 0D2h	; Ò
		db 0D3h	; Ó
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db  1Bh
		db  21h	; !
		db    0
		db  23h	; #
		db  24h	; $
		db  25h	; %
		db  1Eh
		db  26h	; &
		db  2Ah	; *
		db  28h	; (
		db  29h	; )
		db  1Fh
		db  2Bh	; +
		db  7Fh	; 
		db    9
		db  11h
		db  17h
		db    5
		db  12h
		db  14h
		db  19h
		db  15h
		db    9
		db  0Fh
		db  10h
		db  1Bh
		db  1Dh
		db  0Dh
		db    0
		db    1
		db  13h
		db    4
		db    6
		db    7
		db    8
		db  0Ah
		db  0Bh
		db  0Ch
		db  3Bh	; ;
		db  2Ch	; ,
		db  60h	; `
		db    0
		db  1Ch
		db  1Ah
		db  18h
		db    3
		db  16h
		db    2
		db  0Eh
		db 0B2h	; ²
		db  3Ch	; <
		db  3Eh	; >
		db  3Fh	; ?
		db    0
		db    0
		db    0
		db  20h
		db    0
		db 0DEh	; Þ
		db 0DFh	; ß
		db 0E0h	; à
		db 0E1h	; á
		db 0E2h	; â
		db 0E3h	; ã
		db 0E4h	; ä
		db 0E5h	; å
		db 0E6h	; æ
		db 0E7h	; ç
		db    0
		db    0
		db 0C7h	; Ç
		db 0C8h	; È
		db 0C9h	; É
		db  2Dh	; -
		db 0CBh	; Ë
		db 0CCh	; Ì
		db 0CDh	; Í
		db  2Bh	; +
		db 0CFh	; Ï
		db 0D0h	; Ð
		db 0D1h	; Ñ
		db 0D2h	; Ò
		db 0D3h	; Ó
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
a@_Prstufxccss	db 1Bh,'!@#$%^&*()_+',8,'‘’“”•–—˜™{}',0Dh,0
aUqabvgdej	db 'žŸ ¡¢£¤¥¦:"~',0
aMnop?		db '|¬­®¯°±²<>?',0
		db    0
		db    0
		db  20h
		db    0
		db 0F8h	; ø
		db 0F9h	; ù
		db 0FAh	; ú
		db 0FBh	; û
		db 0FCh	; ü
		db 0FDh	; ý
		db 0FEh	; þ
		db 0FFh
		db  80h	; €
		db  81h	; 
		db    0
		db    0
		db 0C7h	; Ç
		db 0C8h	; È
		db 0C9h	; É
		db  2Dh	; -
		db 0CBh	; Ë
		db 0CCh	; Ì
		db 0CDh	; Í
		db  2Bh	; +
		db 0CFh	; Ï
		db 0D0h	; Ð
		db 0D1h	; Ñ
		db 0D2h	; Ò
		db 0D3h	; Ó
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
g_pReadCharFunc	dw offset ReadKbChar	; DATA XREF: CallReadCharCBr
					; KbChecking+15w ...
seg_2B77_468E	dw seg seg012		; DATA XREF: KbChecking+1Bw
					; KbChecking+23r
g_bSkipJoystick	db 0			; DATA XREF: RunOptionMenu:loc_0_305Cr
					; RunGame+211r	...
		align 2
aSFileError	db '%s FILE ERROR',0Dh,0 ; DATA XREF: LoadBinaryFile:loc_1EA2_2132o
aSNotPackedFile	db '%s NOT PACKED FILE',0Dh,0
aSInvalidPackTy	db '%s INVALID PACK TYPE',0Dh,0 ; DATA XREF: UncompressFileR+11Fo
		align 2
aLocateshape4_4	db 'locateshape - %-4.4s SHAPE NOT FOUND',0Dh,0Ah
					; DATA XREF: LocateSound+5Do
aLocatesound4_4	db 'locatesound - %-4.4s SOUND NOT FOUND',0Dh,0Ah
					; DATA XREF: LocateSound:loc_1EA2_25ECo
aReservememor_0	db 'reservememory - OUT OF MEMORY RESERVING %s P=%x HW=%x',0Dh,0Ah,0
					; DATA XREF: AllocResPages+ACo
aReservememoryO	db 'reservememory - OUT OF MEMORY SLOTS RESERVING %s',0Dh,0Ah,0
					; DATA XREF: AllocResPages+71o
aMemoryManagerB	db 'memory manager - BLOCK NOT FOUND at SEG= %x',0Dh,0Ah,0
					; DATA XREF: UnloadResource+1Fo
aResizememoryCa	db 'resizememory - CANNOT EXPAND BLOCK NOT AT TOP',0Dh,0Ah,0
					; DATA XREF: ResizeMemory:loc_1EA2_2CD4o
aResizememoryNo	db 'resizememory - NO MEMORY LEFT TO EXPAND HW=%x',0Dh,0Ah,0
					; DATA XREF: ResizeMemory+87o
		align 2
word_2B77_4812	dw 0			; DATA XREF: AllocResMem+1Cr
					; AllocResMem+50w ...
word_2B77_4814	dw 0			; DATA XREF: AllocResMem+31w
					; AllocResMem+44r ...
g_wMaxResSize	dw 0			; DATA XREF: AllocResPages+4Br
					; AllocResPages+51w ...
g_wPspOfs	dw 0			; DATA XREF: AllocResMem:loc_1EA2_266Ew
					; seg012:2702w
g_wPspSeg	dw 0			; DATA XREF: AllocResMem+18w
					; seg012:2706w
g_pcFirstRes	db 0Ch dup(20h)		; pcName ; DATA	XREF: dseg:g_ppcFirstRes1o
					; dseg:g_ppcFirstRes2o
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 2			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 0			; field_10
		db 0Ch dup(20h)		; pcName
		dw 0			; dwSize
		dw 0			; dwOffset
		dw 1			; field_10
g_ppcFirstRes1	dw offset g_pcFirstRes	; DATA XREF: AllocResMem+2Ar
					; AllocResMem+5Br ...
g_ppcFirstRes2	dw offset g_pcFirstRes	; DATA XREF: AllocResMem+5Fw
					; seg012:273Er	...
g_ppcLastRes1	dw offset g_pcFirstRes.pcName+372h ; DATA XREF:	AllocResMem+57w
					; seg012:2737r	...
g_ppcLastRes2	dw offset g_pcFirstRes.pcName+372h ; DATA XREF:	AllocResMem+49r
					; AllocResMem:loc_1EA2_26ADr ...
word_2B77_4BA8	dw 0			; DATA XREF: InitMouse+7Dw
g_wMouseHorScal	dw 0			; DATA XREF: InitMouse+4Dw
					; InitMouse:loc_268A_88w ...
m_wShowMouseCur	dw 0			; DATA XREF: seg017:0144w seg017:0148r ...
g_wSpriteOpFlag	dw 0			; DATA XREF: DeriveSpriteOpReset+26w
					; DeriveSpriteOp4+25w ...
word_2B77_4BB0	dw 0			; DATA XREF: DeriveSpriteOpReset+2Cw
					; SpriteFlagOp+Ew ...
g_wSpriteFuncOf	dw 0			; DATA XREF: DeriveSpriteOpReset+3Ew
					; DeriveSpriteOp3+10w ...
		dw seg seg012
g_wImageFuncOfs	dw 0			; DATA XREF: DeriveSpriteOpReset+44w
					; DeriveSpriteOp3+16w ...
		dw seg seg012
byte_2B77_4BBA	db 0			; DATA XREF: sub_1EA2_374C+3r
					; sub_1EA2_374C+15r ...
byte_2B77_4BBB	db 0			; DATA XREF: sub_1EA2_377D+14w
					; sub_1EA2_377D:loc_1EA2_37DDr	...
byte_2B77_4BBC	db 7			; DATA XREF: sub_1EA2_377D+30r
					; sub_1EA2_377D+11Dw
		align 2
word_2B77_4BBE	dw 0F00h		; DATA XREF: sub_1EA2_377D+19r
					; sub_1EA2_377D+6Aw
word_2B77_4BC0	dw 0			; DATA XREF: sub_1EA2_377D+1Cw
					; sub_1EA2_377D+40r ...
word_2B77_4BC2	dw 0			; DATA XREF: sub_1EA2_377D+1w
					; sub_1EA2_377D+23r ...
word_2B77_4BC4	dw 0			; DATA XREF: sub_1EA2_377D+5w
					; sub_1EA2_377D:loc_1EA2_379Cr	...
unk_2B77_4BC6	db    0			; DATA XREF: sub_1EA2_377D+8o
					; sub_1EA2_377D+2Do ...
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
unk_2B77_4C26	db    0			; DATA XREF: BitmapOp+4Br
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
unk_2B77_4C32	db    0			; DATA XREF: BitmapOp+8Ar
		db    0
		db    0
		db    0
unk_2B77_4C36	db    0			; DATA XREF: BitmapOp+9Cr
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
word_2B77_4C3E	dw 0A0h			; DATA XREF: sub_1EA2_377D+12Cr
					; sub_1EA2_38D3+46w ...
word_2B77_4C40	dw 64h			; DATA XREF: sub_1EA2_377D+139r
					; sub_1EA2_38D3+55w ...
word_2B77_4C42	dw 0			; DATA XREF: sub_1EA2_377D+129w
					; sub_1EA2_38D3+49r
word_2B77_4C44	dw 0			; DATA XREF: sub_1EA2_377D+136w
					; sub_1EA2_38D3+58r
g_wVecOp2Adder	dw 0A0h			; DATA XREF: sub_1EA2_377D+130w
					; sub_1EA2_38D3+4Dw ...
g_wVecOp2Adder2	dw 64h			; DATA XREF: sub_1EA2_377D+13Dw
					; sub_1EA2_38D3+5Cw ...
g_wVecOp2XMultiplier dw	0		; DATA XREF: sub_1EA2_38D3+87w
					; VectorOp2+18r ...
g_wVecOp2YMultiplier dw	0		; DATA XREF: sub_1EA2_38D3+BAw
					; sub_1EA2_38D3+CFw ...
word_2B77_4C4E	dw 0			; DATA XREF: sub_1EA2_377D+14Aw
					; sub_1EA2_38D3+20w ...
word_2B77_4C50	dw 0			; DATA XREF: sub_1EA2_377D+150w
					; sub_1EA2_38D3+3Ew ...
aWindowReleased	db 'Window Released Out of Order',0Dh,0Ah,0 ; DATA XREF: ReleaseWindow+46o
		align 2
aSFileError_0	db '%s FILE ERROR',0Dh,0 ; DATA XREF: SaveAndDelFile+87o
		align 2
g_cVideoMode	db 0			; DATA XREF: AddVideoExitHanr
					; AddVideoExitHan+Bw ...
g_cVideoMode2	db 0			; DATA XREF: AddVideoExitHan+17w
					; VideoAtExit+5r ...
; this reproduces the exact same table as in g_pQuartSineTab below:

; for (int i = 0; i < 257; i++)	{
;   float f = sin(((float)i / 256.0f) *	M_PI / 2);
;   unsigned short s = floor((f	* 0x4000 + 0.5f));
;   cout << std::hex <<	s << endl;
; }

g_pwQuarterSineTab dw 0, 65h, 0C9h, 12Eh, 192h,	1F7h, 25Bh, 2C0h, 324h,	388h
					; DATA XREF: LookupSine+20r
					; LookupSine+2Dr ...
		dw 3EDh, 451h, 4B5h, 51Ah, 57Eh, 5E2h, 646h, 6AAh, 70Eh	; log table?
		dw 772h, 7D6h, 839h, 89Dh, 901h, 964h, 9C7h, 0A2Bh, 0A8Eh
		dw 0AF1h, 0B54h, 0BB7h,	0C1Ah, 0C7Ch, 0CDFh, 0D41h, 0DA4h
		dw 0E06h, 0E68h, 0ECAh,	0F2Bh, 0F8Dh, 0FEEh, 1050h, 10B1h
		dw 1112h, 1173h, 11D3h,	1234h, 1294h, 12F4h, 1354h, 13B4h
		dw 1413h, 1473h, 14D2h,	1531h, 1590h, 15EEh, 164Ch, 16ABh
		dw 1709h, 1766h, 17C4h,	1821h, 187Eh, 18DBh, 1937h, 1993h
		dw 19EFh, 1A4Bh, 1AA7h,	1B02h, 1B5Dh, 1BB8h, 1C12h, 1C6Ch
		dw 1CC6h, 1D20h, 1D79h,	1DD3h, 1E2Bh, 1E84h, 1EDCh, 1F34h
		dw 1F8Ch, 1FE3h, 203Ah,	2091h, 20E7h, 213Dh, 2193h, 21E8h
		dw 223Dh, 2292h, 22E7h,	233Bh, 238Eh, 23E2h, 2435h, 2488h
		dw 24DAh, 252Ch, 257Eh,	25CFh, 2620h, 2671h, 26C1h, 2711h
		dw 2760h, 27AFh, 27FEh,	284Ch, 289Ah, 28E7h, 2935h, 2981h
		dw 29CEh, 2A1Ah, 2A65h,	2AB0h, 2AFBh, 2B45h, 2B8Fh, 2BD8h
		dw 2C21h, 2C6Ah, 2CB2h,	2CFAh, 2D41h, 2D88h, 2DCFh, 2E15h
		dw 2E5Ah, 2E9Fh, 2EE4h,	2F28h, 2F6Ch, 2FAFh, 2FF2h, 3034h
		dw 3076h, 30B8h, 30F9h,	3139h, 3179h, 31B9h, 31F8h, 3236h
		dw 3274h, 32B2h, 32EFh,	332Ch, 3368h, 33A3h, 33DFh, 3419h
		dw 3453h, 348Dh, 34C6h,	34FFh, 3537h, 356Eh, 35A5h, 35DCh
		dw 3612h, 3648h, 367Dh,	36B1h, 36E5h, 3718h, 374Bh, 377Eh
		dw 37B0h, 37E1h, 3812h,	3842h, 3871h, 38A1h, 38CFh, 38FDh
		dw 392Bh, 3958h, 3984h,	39B0h, 39DBh, 3A06h, 3A30h, 3A59h
		dw 3A82h, 3AABh, 3AD3h,	3AFAh, 3B21h, 3B47h, 3B6Dh, 3B92h
		dw 3BB6h, 3BDAh, 3BFDh,	3C20h, 3C42h, 3C64h, 3C85h, 3CA5h
		dw 3CC5h, 3CE4h, 3D03h,	3D21h, 3D3Fh, 3D5Bh, 3D78h, 3D93h
		dw 3DAFh, 3DC9h, 3DE3h,	3DFCh, 3E15h, 3E2Dh, 3E45h, 3E5Ch
		dw 3E72h, 3E88h, 3E9Dh,	3EB1h, 3EC5h, 3ED8h, 3EEBh, 3EFDh
		dw 3F0Fh, 3F20h, 3F30h,	3F40h, 3F4Fh, 3F5Dh, 3F6Bh, 3F78h
		dw 3F85h, 3F91h, 3F9Ch,	3FA7h, 3FB1h, 3FBBh, 3FC4h, 3FCCh
		dw 3FD4h, 3FDBh, 3FE1h,	3FE7h, 3FECh, 3FF1h, 3FF5h, 3FF8h
		dw 3FFBh, 3FFDh, 3FFFh,	4000h, 4000h
g_wTimerCounter	dd 0			; DATA XREF: DoGetTimerKb2+17r
					; CopyTimerCounte+Ew ...
g_dwLastTimerCo	dd 0			; DATA XREF: GetTimerDeltar
					; GetTimerDelta+11w ...
unk_2B77_4E8E	db    0			; DATA XREF: ReadlineHelper+72r
					; ReadlineHelper2+9Cr
		db    0
g_segFontDef	dw seg seg039		; DATA XREF: MaybeGetStrWidt:loc_1EA2_3E2Ar
					; FontTextOp+9r ...
		dw 0Ah
aHdr1_1		db 'hdr1',0             ; DATA XREF: DoInitAudioRese:loc_270D_2Ao
		db    0
g_pDrvBinary	dd 0			; DATA XREF: LoadAudioFinali+2Ar
					; DrvFuncMany+5Ar ...
unk_2B77_4E9E	db    1			; DATA XREF: seg028:0D2Bo
		db    0
		db    2
		db    0
		db    4
		db    0
		db    8
		db    0
		db  10h
		db    0
		db  20h
		db    0
		db  40h	; @
		db    0
		db  80h	; €
		db    0
		db    0
		db    1
		db    0
		db    2
		db    0
		db    4
		db    0
		db    8
		db    0
		db  10h
		db    0
		db  20h
		db    0
		db  40h	; @
		db    0
		db  80h	; €
		db    0
		db    0
g_cDrvFlag3	db 0			; DATA XREF: DrvFuncMany+8w
					; sub_270D_224+7w ...
g_cDrvFlag2	db 1			; DATA XREF: SetDrvFlag2To1w
					; SetDrvFlag2To0w ...
g_cDrvFlag1	db 0			; DATA XREF: LoadAudioFinali+88w
					; sub_270D_29A+6w ...
g_cDrvFlag6	db 1			; DATA XREF: AudioDrvTimer:loc_16BA_43Cr
					; DrvFuncMany:loc_270D_165r ...
g_cDrvFlag7	db 0			; DATA XREF: AudioDrvTimer+1Fr
					; DrvFuncMany+13r ...
g_cDrvFlag9	db 0			; DATA XREF: LoadAudioDriver+Fw
					; LoadAudioDriver+E9w ...
unk_2B77_4EC6	db  10h			; DATA XREF: DrvFuncMany+51o
					; sub_270D_224+47o ...
		db    0
		db  16h
g_bDrvFlag8	db 0			; DATA XREF: DrvFuncMany:loc_270D_192w
					; sub_270D_224:loc_270D_266w ...
g_wLockSeg28_0	dw 1			; DATA XREF: LoadAudioFinali+7w
					; LoadAudioFinali+8Dw ...
word_2B77_4ECC	dw 0			; DATA XREF: sub_270D_B68+6w
					; LoadSfxFile+55r ...
unk_2B77_4ECE	db    0			; DATA XREF: LoadAudioDriver+87o
aDrv		db 'drv',0              ; DATA XREF: LoadAudioDriver+8Bo
aMt32_plb	db 'mt32.plb',0         ; DATA XREF: LoadAudioDriver+109o
aCanTFindDriver	db 'Can',27h,'t find driver!',0Ah,0
					; DATA XREF: LoadAudioDriver:loc_270D_982o
aGe		db 'ge',0               ; DATA XREF: LoadSfxGe+6Fo
aGe_0		db 'ge',0               ; DATA XREF: LoadSfxGe+94o
g_afterGe	db    0			; DATA XREF: LoadSfxGe:loc_270D_B01o
g_afterGe2	db    0			; DATA XREF: LoadSfxGe:loc_270D_B29o
aDsf		db 'dsf',0              ; DATA XREF: LoadSfxFile+19o
aSfx		db 'sfx',0              ; DATA XREF: LoadSfxFile+39o
aCannotLoadSfxF	db 'cannot load sfx file %s',0 ; DATA XREF: LoadSfxFile+5Fo
aKms		db 'kms',0              ; DATA XREF: LoadSongFile+12o
aCannotLoadSong	db 'cannot load song file %s',0 ; DATA XREF: LoadSongFile+34o
aDvc		db 'dvc',0              ; DATA XREF: LoadVoiceFile+19o
aVce		db 'vce',0              ; DATA XREF: LoadVoiceFile+39o
aCannotLoadVoic	db 'cannot load voice file %s',0 ; DATA XREF: LoadVoiceFile+5Fo
aSlb		db 'slb',0              ; DATA XREF: LoadVoiceFile+80o
aCannotLoadSamp	db 'cannot load sample file %s',0 ; DATA XREF: LoadVoiceFile+A2o
aHdr1		db 'hdr1',0             ; DATA XREF: LoadVce+Co
aBasd		db 'BASD',0             ; DATA XREF: LoadVce:loc_270D_EB7o
aSnar		db 'SNAR',0             ; DATA XREF: LoadVce+E0o
aTomm		db 'TOMM',0             ; DATA XREF: LoadVce+F9o
aRide		db 'RIDE',0             ; DATA XREF: LoadVce+112o
aCrsh		db 'CRSH',0             ; DATA XREF: LoadVce+12Bo
aChht		db 'CHHT',0             ; DATA XREF: LoadVce+144o
aOhht		db 'OHHT',0             ; DATA XREF: LoadVce+15Do
aHdr1_0		db 'hdr1',0             ; DATA XREF: DoHdr1AudioStuf+1C5o
aSwpauseDSwsong	db 'swPause = %d, swSong = %d, bSong = %d,swSFX = %d',0Ah,0
					; DATA XREF: sub_270D_14A0+1Ao
aUbmusicvolumeD	db 'ubMusicVolume = %d, ubSfxVolume = %d',0Ah,0
aT02xNdLxDlLd	db 'T%02x-ND=%lx,DL=%ld',0Ah,0
aPressAKey	db 'Press a Key',0Ah,0
aH02xStDTpLxTlL	db 'H%02x - ST=%d,TP=%lx,TL=%lx',0Ah,0
g_wAudDrvCounte	dw 0			; DATA XREF: seg028:0022r seg028:0029w ...
unk_2B77_503C	db  2Eh	; .		; DATA XREF: GetAString:loc_29CC_FFo
		db    0
		db    1
		db    0
		db    2
		db    0
		db    3
		db    0
		db    4
		db    0
		db    5
		db    0
		db    6
		db    0
		db    7
		db    0
		db    8
		db    0
		db    9
		db    0
		db  0Ah
		db    0
		db  0Bh
		db    0
		db  0Ch
		db    0
		db  0Dh
		db    0
		db  0Eh
		db    0
g_wFontFlag	dw 0Fh			; DATA XREF: RunTracksMenu+F7r
					; RunTracksMenu+165r ...
word_2B77_505C	dw 10h			; DATA XREF: sub_9F1_3F96+2A2r
word_2B77_505E	dw 5			; DATA XREF: RunMenu+B7r
					; RunTracksMenu+319r ...
word_2B77_5060	dw 0Eh			; DATA XREF: RunMenu:loc_0_FEFr
					; RunTracksMenu:loc_0_13E5r ...
word_2B77_5062	dw 8			; DATA XREF: EndOfGameScores+914r
word_2B77_5064	dw 0Fh			; DATA XREF: LoadIntroRes+BEr
					; LoadIntroRes+FAr ...
word_2B77_5066	dw 8			; DATA XREF: LoadIntroRes+BAr
					; LoadIntroRes+F6r ...
word_2B77_5068	dw 0Bh			; DATA XREF: LoadIntroRes+83r
word_2B77_506A	dw 3			; DATA XREF: LoadIntroRes+7Fr
word_2B77_506C	dw 0Ch			; DATA XREF: LoadIntroRes+136r
word_2B77_506E	dw 4			; DATA XREF: LoadIntroRes+132r
word_2B77_5070	dw 9			; DATA XREF: LoadIntroRes+38Er
					; LoadIntroRes+406r
word_2B77_5072	dw 1			; DATA XREF: LoadIntroRes+38Ar
					; LoadIntroRes+402r
word_2B77_5074	dw 0Ah			; DATA XREF: LoadIntroRes+4BAr
word_2B77_5076	dw 2			; DATA XREF: LoadIntroRes+4B6r
word_2B77_5078	dw 0Dh			; DATA XREF: LoadIntroRes+29Er
word_2B77_507A	dw 5			; DATA XREF: LoadIntroRes+29Ar
word_2B77_507C	dw 0Bh			; DATA XREF: TrackEditRelate+2FEr
					; TrackEditRelate+321r
word_2B77_507E	dw 9			; DATA XREF: TrackEditRelate+2FAr
					; TrackEditRelate+31Dr
word_2B77_5080	dw 1			; DATA XREF: TrackEditRelate+2F6r
					; TrackEditRelate+319r
word_2B77_5082	dw 0Ch			; DATA XREF: TrackEditRelate:loc_1A2B_C26r
					; TrackEditRelate:loc_1A2B_FF6r
word_2B77_5084	dw 0Fh			; DATA XREF: RunTracksMenu+232r
					; RunTracksMenu+26Br ...
word_2B77_5086	dw 8			; DATA XREF: RunTracksMenu+22Er
					; RunTracksMenu+267r ...
word_2B77_5088	dw 7			; DATA XREF: RunTracksMenu+22Ar
					; RunTracksMenu+263r ...
word_2B77_508A	dw 9			; DATA XREF: RunOptionMenu+1Er
word_2B77_508C	dw 1			; DATA XREF: RplyMouseSpriteStuff+27Ar
word_2B77_508E	dw 4			; DATA XREF: RplyMouseSpriteStuff+2B0r
					; RplyMouseSpriteStuff+446r
g_wDialogArg1	dw 1			; DATA XREF: RunCarMenu+6E8r
					; RunOptionMenu+12Cr ...
g_wDialogArg2	dw 4			; DATA XREF: _main+53Er
					; MainTextResFont:loc_0_18C1r ...
		db    0
		db    0
		db    1
		db    0
		db    2
		db    0
		db    3
		db    0
		db    4
		db    0
		db    5
		db    0
		db    6
		db    0
		db    7
		db    0
		db    8
		db    0
		db    9
		db    0
		db  0Ah
		db    0
		db  0Bh
		db    0
		db  0Ch
		db    0
		db  0Dh
		db    0
		db  0Eh
		db    0
		db  0Fh
		db    0
		db  6Ch	; l
		db    0
		db  74h	; t
		db    0
		db  0Fh
		db    0
		db  1Ch
		db    0
		db  1Dh
		db    0
		db  0Eh
		db    0
		db  1Ch
		db    0
		db  1Fh
		db    0
		db  0Eh
		db    0
		db 0C8h	; È
		db    0
		db 0C6h	; Æ
		db    0
		db 0C4h	; Ä
		db    0
		db  70h	; p
		db    0
		db  72h	; r
		db    0
		db  74h	; t
		db    0
		db 0C2h	; Â
		db    0
		db 0C5h	; Å
		db    0
		db 0C8h	; È
		db    0
		db  92h	; ’
		db    0
		db  25h	; %
		db    0
		db  23h	; #
		db    0
		db 0B5h	; µ
		db    0
		db  1Dh
		db    0
		db  1Fh
		db    0
		db  13h
		db    0
		db    3
		db    0
		db  0Bh
		db    0
		db  1Bh
		db    0
		db    0
		db    0
		db    4
		db    0
		db    4
		db    0
		db  0Ch
		db    0
		db  9Ch	; œ
		db    0
		db  9Ah	; š
		db    0
		db  98h	; ˜
		db    0
		db  96h	; –
		db    0
		db  2Ah	; *
		db    0
		db  28h	; (
		db    0
		db  26h	; &
		db    0
		db  25h	; %
		db    0
		db  1Bh
		db    0
		db  1Ah
		db    0
		db  19h
		db    0
		db  18h
		db    0
		db  48h	; H
		db    0
		db  46h	; F
		db    0
		db  44h	; D
		db    0
		db  42h	; B
		db    0
		db  7Bh	; {
		db    0
		db  79h	; y
		db    0
		db  78h	; x
		db    0
		db  75h	; u
		db    0
		db  5Ch	; \
		db    0
		db  5Ah	; Z
		db    0
		db  58h	; X
		db    0
		db  57h	; W
		db    0
		db 0ADh	; ­
		db    0
		db 0ABh	; «
		db    0
		db 0A9h	; ©
		db    0
		db 0A7h	; §
		db    0
		db  14h
		db    0
		db  13h
		db    0
		db  12h
		db    0
		db  11h
		db    0
		db  4Dh	; M
		db    0
		db  4Ch	; L
		db    0
		db  4Ah	; J
		db    0
		db  49h	; I
		db    0
		db  2Dh	; -
		db    0
		db  2Ch	; ,
		db    0
		db  2Ah	; *
		db    0
		db  29h	; )
		db    0
		db  9Fh	; Ÿ
		db    0
		db 0AFh	; ¯
		db    0
		db 0AEh	; ®
		db    0
		db 0ACh	; ¬
		db    0
		db  1Dh
		db    0
		db  1Ch
		db    0
		db  12h
		db    0
		db  5Ah	; Z
		db    0
		db  0Fh
		db    0
		db    7
		db    0
		db 0C8h	; È
		db    0
		db 0DBh	; Û
		db    0
		db  88h	; ˆ
		db    0
		db  63h	; c
		db    0
		db  65h	; e
		db    0
		db  67h	; g
		db    0
		db  68h	; h
		db    0
		db  6Ah	; j
		db    0
		db  11h
		db    0
		db  14h
		db    0
		db  3Ch	; <
		db    0
		db  4Dh	; M
		db    0
		db  2Eh	; .
		db    0
		db  3Dh	; =
		db    0
		db  2Dh	; -
		db    0
		db 0CAh	; Ê
		db    0
		db 0BEh	; ¾
		db    0
		db 0BAh	; º
		db    0
		db 0B7h	; ·
		db    0
		db 0B4h	; ´
		db    0
		db    0
		db    0
		db  1Ch
		db    0
		db  1Eh
		db    0
		db  10h
		db    0
		db  14h
		db    0
		db  44h	; D
		db    0
		db  36h	; 6
		db    0
		db  27h	; '
		db    0
		db  2Bh	; +
		db    0
		db  0Ch
		db    0
		db  11h
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    1
		db    0
		db    0
		db    0
		db    0
		db    0
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db    0
		db    0
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0DDh	; Ý
		db  77h	; w
		db  77h	; w
		db 0DDh	; Ý
		db 0DDh	; Ý
		db  77h	; w
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0DDh	; Ý
		db  77h	; w
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db 0DDh	; Ý
		db  77h	; w
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db 0FFh
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db  33h	; 3
		db 0CCh	; Ì
		db 0CCh	; Ì
		db  33h	; 3
		db  6Dh	; m
		db 0B6h	; ¶
		db  92h	; ’
		db  49h	; I
		db  6Dh	; m
		db 0B6h	; ¶
		db  92h	; ’
		db  49h	; I
		db  6Dh	; m
		db 0B6h	; ¶
		db  92h	; ’
		db  49h	; I
		db    0
		db    0
		db    0
		db    0
g_wVideoConst1	dw 5094h		; DATA XREF: LoadSkybox:loc_9F1_397Er
					; SetVideoMode+3F4r
g_wVideoConst2	dw 5094h		; DATA XREF: SetVideoMode+3F0r
g_wVideoConst3	dw 5196h		; DATA XREF: SetVideoMode+3ECr
g_wVideoConst4	dw 5298h		; DATA XREF: SetVideoMode+3E8r
g_pcAudioDriver	db 'pc15',0             ; DATA XREF: SetVideoMode+1BEw
					; SetVideoMode+1DFw ...
aSdmain		db 'sdmain',0           ; DATA XREF: LoadPalAndCurso+8o
aPal		db '!pal',0             ; DATA XREF: LoadPalAndCurso+1Co
aSmou		db 'smou',0             ; DATA XREF: LoadPalAndCurso+71o
aSdmain_0	db 'sdmain',0           ; DATA XREF: LoadPalAndCurso+10Ao
aSmou_0		db 'smou',0             ; DATA XREF: LoadPalAndCurso+132o
aMmou		db 'mmou',0             ; DATA XREF: LoadPalAndCurso+164o
		db    0
asc_2B77_53CA	db ' ',0                ; DATA XREF: ReadlineHelper+4Co
		db    3
		db    0
		db    0
		db    0
aCopyrightCUnli	db 'Copyright (C) Unlimited Software Inc. 1989,1990.  All rights rese'
		db 'rved.'
byte_2B77_5416	db 0			; DATA XREF: sub_1EA2_5B74+Cw
					; sub_1EA2_5B74+Fo
		db    0
		db    0
		db    0
		db    0
		db    0
aMcgaWindow	db 'MCGA WINDOW',0      ; DATA XREF: MakeWndSprite+23o
aWindowdefOutOf	db 'windowdef - OUT OF ROW TABLE SPACE',0Dh,0 ; DATA XREF: MakeWndSprite+CEo
a_pvs		db '.PVS',0
a_xvs		db '.XVS',0
a_vsh		db '.VSH',0
a_pes		db '.PES',0
a_esh		db '.ESH',0
		db    0
unk_2B77_5466	db  4Ch	; L		; DATA XREF: Load2DShape+5Cr
		db  54h	; T
		db  51h	; Q
		db  54h	; T
		db  56h	; V
		db  54h	; T
		db  5Bh	; [
		db  54h	; T
		db  60h	; `
		db  54h	; T
		db  65h	; e
		db  54h	; T
g_arrShapeNums	db 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: Load2DShape+2A1o
					; sub_2A9D_2E0+15w
		db 0Fh
a_pvs_0		db '.PVS',0             ; DATA XREF: Load2DShape+BBo
aUnflip		db 'UNFLIP',0           ; DATA XREF: Load2DShape+F5o
a_xvs_0		db '.XVS',0             ; DATA XREF: Load2DShape:loc_2A9D_154o
a_pes_0		db '.PES',0             ; DATA XREF: Load2DShape:loc_2A9D_180o
aUnflip_0	db 'UNFLIP',0           ; DATA XREF: Load2DShape+18Bo
a_esh_0		db '.ESH',0             ; DATA XREF: Load2DShape:loc_2A9D_24Co
aMga		db '!MGA',0             ; DATA XREF: Load2DShape+1CCo
		db    0
		db    0
		db    0
		db    0
		db    0
dword_2B77_54AE	dd 0			; DATA XREF: start+FDr	start+113r ...
dword_2B77_54B2	dd 0			; DATA XREF: start+F5r
dword_2B77_54B6	dd 0			; DATA XREF: start:loc_1CC5_11Br
					; _raise+77r ...
off_2B77_54BA	dd _flushall		; DATA XREF: start+177o start+17Ao ...
aNmsg		db '<<NMSG>>',0
		align 2
aR6000StackOver	db 'R6000',0Dh,0Ah
		db '- stack overflow',0Dh,0Ah,0
		db    3
		db    0
aR6003IntegerDi	db 'R6003',0Dh,0Ah
		db '- integer divide by 0',0Dh,0Ah,0
		db    9
		db    0
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
		db 0FCh	; ü
		db    0
		db  0Dh
		db  0Ah
		db    0
		db 0FFh
		db    0
aRunTimeError	db 'run-time error ',0
		db    2
		db    0
aR6002FloatingP	db 'R6002',0Dh,0Ah
		db '- floating point not loaded',0Dh,0Ah,0
		db    1
		db    0
aR6001NullPoint	db 'R6001',0Dh,0Ah
		db '- null pointer assignment',0Dh,0Ah,0
		db  0Ah
		db    0
		db  0Ah
aAbnormalProgra	db 'Abnormal program termination',0Ah,0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db 0FFh
		db    0
word_2B77_55CA	dw 0			; DATA XREF: EndOfGameScores+638w
					; EndOfGameScores+656r
word_2B77_55CC	dw 0			; DATA XREF: EndOfGameScores+63Ew
					; EndOfGameScores+6C1r
word_2B77_55CE	dw 0			; DATA XREF: EndOfGameScores+644w
					; EndOfGameScores+677r
word_2B77_55D0	dw ?			; DATA XREF: EndOfGameScores:loc_0_37ADr
					; EndOfGameScores+652w	...
word_2B77_55D2	dw ?			; DATA XREF: EndOfGameScores+63Br
					; EndOfGameScores:loc_0_3835w ...
word_2B77_55D4	dw ?			; DATA XREF: EndOfGameScores+641r
					; EndOfGameScores+673w	...
g_mat2		Matrix <?>		; DATA XREF: PlaneRotateOp+144o
					; PlaneRotateOp+15Ao
g_mat1		Matrix <?>		; DATA XREF: PlaneRotateOp+C2o
					; PlaneRotateOp+D6o
g_wCurveIndex	db ?			; DATA XREF: RecordReplay+E3w
					; RecordReplay+107w ...
		db    ?	;
word_2B77_55FC	dw ?			; DATA XREF: SetupCarShapes+2F7w
					; SetupCarShapes+5C0r ...
		dw ?
word_2B77_5600	dw ?			; DATA XREF: SetupCarShapes+38Ar
					; SetupCarShapes+3F2w
		dw ?
word_2B77_5604	dw ?			; DATA XREF: SetupCarShapes+393r
					; SetupCarShapes+3F9w
		dw ?
word_2B77_5608	dw ?			; DATA XREF: SetupCarShapes+2F0w
					; SetupCarShapes+5BAr ...
		dw ?
g_dwStdaRes	dd ?			; DATA XREF: SetupCarShapes+6Ew
					; SetupCarShapes+98r ...
g_dwWinDefRes1	dd ?			; DATA XREF: SetupCarShapes+F7w
					; SetupCarShapes+61Fr ...
g_dwStdbRes	dd ?			; DATA XREF: SetupCarShapes+85w
					; SetupCarShapes+B0r ...
g_wDigMultiRes	dw 0Ah dup(?)		; DATA XREF: SetupCarShapes+C3o
					; SetupCarShapes+6ACr ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wWhlMultiRes	dw 9 dup(?)		; DATA XREF: SetupCarShapes+8Co
					; SetupCarShapes+524r ...
unk_2B77_5652	db    ?	;		; DATA XREF: SetupCarShapes+3CFr
		db    ?	;
g_pShape2D4	dd ?			; DATA XREF: SetupCarShapes+7A4r
					; SetupCarShapes+7A0r
g_pShape2D3	dd ?			; DATA XREF: SetupCarShapes+7D2r
					; SetupCarShapes+7CEr
g_pShape2D2	dd ?			; DATA XREF: SetupCarShapes+794r
					; SetupCarShapes:loc_11B7_194Er
g_pShape2D	dd ?			; DATA XREF: SetupCarShapes+7C2r
					; SetupCarShapes:loc_11B7_197Cr
g_wGnobMultiRes	dw 6 dup(?)		; DATA XREF: SetupCarShapes+A4o
					; SetupCarShapes+415r ...
word_2B77_5670	dw ?			; DATA XREF: SetupCarShapes+93Dr
word_2B77_5672	dw ?			; DATA XREF: SetupCarShapes+939r
g_arrpShape2D	dd 2 dup(?)		; DATA XREF: SetupCarShapes+4EDr
					; SetupCarShapes+5FDr ...
g_dwWinDefRes2	dd ?			; DATA XREF: SetupCarShapes+11Aw
					; SetupCarShapes+3B4r ...
word_2B77_5680	dw ?			; DATA XREF: SetupCarShapes+2E1w
					; SetupCarShapes+4A9r ...
word_2B77_5682	dw ?			; DATA XREF: SetupCarShapes+4DBr
					; SetupCarShapes+5EBr ...
		dw ?
word_2B77_5686	dw ?			; DATA XREF: SetupCarShapes+2D8w
					; SetupCarShapes+4D0r ...
		dw ?
word_2B77_568A	dw ?			; DATA XREF: SetupCarShapes+2CAw
					; SetupCarShapes+316r ...
g_dwWinDefRes3	dd ?			; DATA XREF: SetupCarShapes+13Dw
					; SetupCarShapes+162r ...
word_2B77_5690	dw ?			; DATA XREF: SetupCarShapes+2E9w
					; SetupCarShapes+81Dr ...
		db    ?	;
		db    ?	;
unk_2B77_5694	db    ?	;		; DATA XREF: RplyMouseSpriteStuff+259r
					; RplyMouseSpriteStuff+276w
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_5698	db    ?	;		; DATA XREF: RplyMouseSpriteStuff+7Dw
					; RplyMouseSpriteStuff+1EAo ...
		db    ?	;
unk_2B77_569A	db    ?	;		; DATA XREF: RplyMouseSpriteStuff+BBw
					; RplyMouseSpriteStuff+12Ao
		db    ?	;
		db    ?	;
		db    ?	;
g_wRplyManyRes	dw 1Eh dup(?)		; DATA XREF: RplyMouseSpriteStuff:loc_11B7_2000o
					; RplyMouseSpriteStuff+A4r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_56FA	db    ?	;		; DATA XREF: RplyMouseSpriteStuff:loc_11B7_201Fw
					; RplyMouseSpriteStuff+51w ...
		db    ?	;
byte_2B77_56FC	db ?			; DATA XREF: RplyMouseSpriteStuff+62Er
byte_2B77_56FD	db ?			; DATA XREF: RplyMouseSpriteStuff+627r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_5704	db    ?	;		; DATA XREF: RplyMouseSpriteStuff+75w
					; RplyMouseSpriteStuff+197r ...
		db    ?	;
unk_2B77_5706	db    ?	;		; DATA XREF: RplyMouseSpriteStuff+C4w
					; RplyMouseSpriteStuff+1A6w ...
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_570A	db    ?	;		; DATA XREF: RplyMouseSpriteStuff+90w
					; RplyMouseSpriteStuff+304r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_matY200	Matrix <?>		; DATA XREF: InitPolyInfo+3Co
					; MatRotateZXY:loc_14D6_1538o
g_wMatY100	Matrix <?>		; DATA XREF: InitPolyInfo+2Co
					; MatRotateZXY:loc_14D6_1522o
g_rcCurRect	Rectangle <?>		; DATA XREF: SelectRectRotate+2Fo
					; sub_14D6_1182:loc_14D6_11ACr	...
g_wMatY300	Matrix <?>		; DATA XREF: InitPolyInfo+4Co
					; MatRotateZXY:loc_14D6_153Eo
g_dwPolyBuf1	dd ?			; DATA XREF: TransformedShapeOp+40Cw
					; TransformedShapeOp:loc_14D6_710r ...
g_wTrnsfrmShpOpFlag dw ?		; DATA XREF: ResetTrnsfrmOpVars+Cw
					; TransformedShapeOp+9r ...
g_pToRect	dw ?			; DATA XREF: SelectRectRotate+3Dw
					; TransformedShapeOp+2E5r ...
g_pwPolyBuffer	dd ?			; DATA XREF: InitPolyInfo+12w
					; TransformedShapeOp+404r ...
unk_2B77_5766	db    ?	;		; DATA XREF: sub_14D6_10C4+14r
					; sub_14D6_10C4+24r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wTrnsfrmShpOp4 dw ?			; DATA XREF: ResetTrnsfrmOpVars+12w
g_pPolybufTab	dd ?			; DATA XREF: TransformedShapeOp+41Bw
					; sub_14D6_10C4+3Br ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		dw ?
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		dw ?
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_matY0		Matrix <?>		; DATA XREF: InitPolyInfo+1Co
					; MatRotateZXY:loc_14D6_1544o
g_wTrnsfrmShpOp3 dw ?			; DATA XREF: ResetTrnsfrmOpVars+6w
					; TransformedShapeOp+401r ...
g_wSelNumPaints	dw ?			; DATA XREF: TransformedShapeOp+55w
					; TransformedShapeOp+89r ...
g_pwTrnsfrmTab	dw ?			; DATA XREF: TransformedShapeOp+26Br
					; TransformedShapeOp+287r ...
word_2B77_60E6	dw ?			; DATA XREF: TransformedShapeOp+AABr
					; TransformedShapeOp+ADAr ...
word_2B77_60E8	dw ?			; DATA XREF: TransformedShapeOp+B23r
word_2B77_60EA	dw ?			; DATA XREF: TransformedShapeOp+B38r
					; TransformedShapeOp+B64r
word_2B77_60EC	dw ?			; DATA XREF: TransformedShapeOp+B79r
word_2B77_60EE	dw ?			; DATA XREF: TransformedShapeOp+B8Er
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_pCurPrimitive	dd ?			; DATA XREF: TransformedShapeOp+3B1w
					; TransformedShapeOp:loc_14D6_AA1r ...
g_cSelShapeFlags db ?			; DATA XREF: TransformedShapeOp+97w
					; TransformedShapeOp+9Ar ...
		align 2
g_pPrimitives	dd ?			; DATA XREF: TransformedShapeOp+31w
					; TransformedShapeOp+38Ew ...
g_pCurPrimitive2 dd ?			; DATA XREF: TransformedShapeOp+457w
					; TransformedShapeOp:loc_14D6_5D5r ...
g_pSelRect	dw ?			; DATA XREF: TransformedShapeOp+A4w
					; TransformedShapeOp+90Ar ...
g_cSelMaterial	db ?			; DATA XREF: TransformedShapeOp+86w
					; TransformedShapeOp+8Fw ...
		align 2
g_wNumVerts	dw ?			; DATA XREF: TransformedShapeOp+22w
					; TransformedShapeOp+B4r ...
g_pVertices	dd ?			; DATA XREF: TransformedShapeOp+44w
					; TransformedShapeOp+235r ...
byte_2B77_6112	db ?			; DATA XREF: TransformedShapeOp+435w
					; TransformedShapeOp+EB8r ...
		align 2
g_dwCos80	dd ?			; DATA XREF: VectorOp+51r VectorOp+8Br ...
g_dwSin80	dd ?			; DATA XREF: VectorOp+4Ar VectorOp+78r ...
g_dwCos80_2	dd ?			; DATA XREF: SetSinCos80+49w
					; SetSinCos80+4Cw
g_dwSin80_2	dd ?			; DATA XREF: SetSinCos80+35w
					; SetSinCos80+38w
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		dw ?
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_pcAudioTimers	db 76Ch	dup(?)		; DATA XREF: InitSfxEngine+Do
					; InitSfxEngine+35o ...
					; 25 x 76 bytes
g_wAudioTimerFl	dw ?			; DATA XREF: AddAudioDrvTime:loc_16BA_19o
					; AddAudioDrvTime+11w ...
g_dwPaddedId	dd ?			; DATA XREF: PadId+Ew
					; PadId:loc_16BA_82r ...
g_bPadFlag	db ?			; DATA XREF: PadId+15w
		align 2
word_2B77_6AD8	dw ?			; DATA XREF: FontByteTextOp2+14w
					; FontByteTextOp2+6Bo
word_2B77_6ADA	dw ?			; DATA XREF: FontByteTextOp2+26w
word_2B77_6ADC	dw ?			; DATA XREF: FontByteTextOp2+6w
word_2B77_6ADE	dw ?			; DATA XREF: FontByteTextOp2+Ew
word_2B77_6AE0	dw ?			; DATA XREF: FontByteTextOp+19w
					; FontByteTextOp+AFo
word_2B77_6AE2	dw ?			; DATA XREF: FontByteTextOp+2Bw
word_2B77_6AE4	dw ?			; DATA XREF: FontByteTextOp+7w
word_2B77_6AE6	dw ?			; DATA XREF: FontByteTextOp+12w
unk_2B77_6AE8	db    ?	;		; DATA XREF: TrackEditRelate+1E6w
					; TrackEditRelate+828r	...
		db    ?	;
unk_2B77_6AEA	db    ?	;		; DATA XREF: TrackEditRelate+1EAw
					; TrackEditRelate+824r	...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
word_2B77_6DD0	dw ?			; DATA XREF: TrackEditRelate+12Aw
					; TrackEditRelate+5D8r	...
word_2B77_6DD2	dw ?			; DATA XREF: TrackEditRelate+12Dw
					; TrackEditRelate+5DCr	...
unk_2B77_6DD4	db    ?	;		; DATA XREF: TrackEditRelate+80Ar
					; sub_1A2B_1C06+B9r ...
		db    ?	;
unk_2B77_6DD6	db    ?	;		; DATA XREF: TrackEditRelate+806r
					; sub_1A2B_1C06+B5r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
dword_2B77_70BC	dd ?			; DATA XREF: TrackEditRelate+2Fo
					; TrackEditRelate+5Fr ...
dword_2B77_70C0	dd ?			; DATA XREF: TrackEditRelate+83r
dword_2B77_70C4	dd ?			; DATA XREF: TrackEditRelate+A7r
dword_2B77_70C8	dd ?			; DATA XREF: TrackEditRelate+CBr
word_2B77_70CC	dw ?			; DATA XREF: TrackEditRelate+1Bo
					; sub_1A2B_1C06+33r ...
word_2B77_70CE	dw ?			; DATA XREF: sub_1A2B_1C06+2Fr
					; sub_1A2B_1C06+84r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_7118	db    ?	;		; DATA XREF: TrackEditRelate+45o
					; TrackEditRelate+BABr	...
		db    ?	;
unk_2B77_711A	db    ?	;		; DATA XREF: TrackEditRelate+BA7r
					; TrackEditRelate+BE5r	...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
word_2B77_7128	dw ?			; DATA XREF: __output+57w
					; __output:loc_1CC5_A04w ...
word_2B77_712A	dw ?			; DATA XREF: __output+20w
					; __output+2C8r ...
word_2B77_712C	dw ?			; DATA XREF: __output+54w
					; __output:loc_1CC5_B20w ...
word_2B77_712E	dw ?			; DATA XREF: __output+45w
					; __output:loc_1CC5_ACEw ...
word_2B77_7130	dw ?			; DATA XREF: __output+4Bw
					; __output+116w ...
word_2B77_7132	dw ?			; DATA XREF: __output+42w __output+77w ...
word_2B77_7134	dw ?			; DATA XREF: __output+5Aw __output+A1w ...
word_2B77_7136	dw ?			; DATA XREF: __output+1Aw
					; __output:loc_1CC5_AEEr ...
word_2B77_7138	dw ?			; DATA XREF: __output+51w __output+7Bw ...
word_2B77_713A	dw ?			; DATA XREF: __output+4Ew __output+DBw ...
word_2B77_713C	dw ?			; DATA XREF: __output+48w
					; __output:loc_1CC5_B02w ...
word_2B77_713E	dw ?			; DATA XREF: __output+29w
					; __output+186r ...
word_2B77_7140	dw ?			; DATA XREF: __output+23w
					; __output:loc_1CC5_C72r ...
word_2B77_7142	dw ?			; DATA XREF: __output:loc_1CC5_9A8w
					; __output+EEr	...
word_2B77_7144	dw ?			; DATA XREF: __output+1C1w
					; __output:loc_1CC5_B38w ...
word_2B77_7146	dw ?			; DATA XREF: __output+14w
					; libsub_1CC5_C9A+79r ...
word_2B77_7148	dw ?			; DATA XREF: __output+C3r __output+CEr ...
word_2B77_714A	dw ?			; DATA XREF: libsub_1CC5_C9A:loc_1CC5_D10w
					; libsub_1CC5_EC0+90w ...
word_2B77_714C	dw ?			; DATA XREF: __output+5Dw __output+6Aw ...
byte_2B77_714E	db 18h dup(?)		; DATA XREF: DrvFuncMany+2Dw
					; sub_270D_224:loc_270D_24Br
unk_2B77_7166	db    ?	;		; DATA XREF: SetDrvFlag6To1:loc_270D_5D7r
					; SetDrvFlag6To0+17w
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_717E	db    ?	;		; DATA XREF: DoMore4cAudio:loc_2863_1BAo
					; sub_2863_E2A+A7r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wAudioWord4	dw ?			; DATA XREF: DoMore4cAudio+377o
					; DoMore4cAudio+385r
word_2B77_7284	dw ?			; DATA XREF: DoMore4cAudio+388r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_audioUnk	db    ?	;		; DATA XREF: DoMore4cAudio+4Fo
					; DoMore4cAudio+35Ao
		db    ?	;
		db    ?	;
		db    ?	;
g_wAudioWord3	db ?			; DATA XREF: DoMore4cAudio+64r
					; DoMore4cAudio+74r ...
g_wAudioByte	db ?			; DATA XREF: DoMore4cAudio:loc_2863_140r
					; DoMore4cAudio+34Fw
g_wAudioWord2	dd ?			; DATA XREF: DoMore4cAudio+136r
					; DoMore4cAudio:loc_2863_332r ...
g_cAudioByte3	db ?			; DATA XREF: DoMore4cAudio+5Dr
					; DoMore4cAudio+ECr
		align 2
g_wDrumWord	dw ?			; DATA XREF: DoDrumOp+11w DoDrumOp+29o
g_wDrumWord2	dw ?			; DATA XREF: DoDrumOp+14w
g_wDrumByte	db ?			; DATA XREF: DoDrumOp+9w
		align 2
g_wDrumWord3	dw ?			; DATA XREF: DoDrumOp+1Aw
g_wDrumWord4	dw ?			; DATA XREF: DoDrumOp+20w
		db    ?	;
		db    ?	;
g_wReadline7	dw ?			; DATA XREF: ReadLine+7Cw
					; ReadLine+1F4w ...
g_wReadline4	dw ?			; DATA XREF: nopsub_1EA2_73A8+13o
					; ReadLine+Fw ...
g_wReadline5	dw ?			; DATA XREF: ReadLine+15w
					; ReadlineHelper+7Ar ...
g_wReadline	dw ?			; DATA XREF: ReadLine+82w ReadLine+F7r ...
g_wReadline2	dw ?			; DATA XREF: ReadLine+1Bw
					; ReadlineHelper:loc_2A4B_356r	...
g_wReadline6	dw ?			; DATA XREF: ReadLine+21w
					; ReadlineHelper2+7r ...
g_wReadline3	dw ?			; DATA XREF: ReadLine+3Ew ReadLine+51w ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_ppTrakdata10	dd ?			; DATA XREF: _main+196w
					; TrkPlanSimd+18E0r ...
g_dwBasdVce	dd ?			; DATA XREF: LoadVce+D9w
					; DrumOp:loc_2863_802r	...
byte_2B77_72C8	db ?			; DATA XREF: RunGame+339r RunGame+360w
		align 2
g_transshp1	TransformedShape3D <?>	; DATA XREF: UpdateFrame+52Ao
					; UpdateFrame+55Co ...
g_transshp2	TransformedShape3D <?>	; DATA XREF: UpdateFrame+11FEo
					; UpdateFrame+125Eo ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wTerrainCenPo	db 3Ch dup(?)		; DATA XREF: _main+7Aw
					; TrkTerrainWall+90r ...
g_wCarXSum	dw ?			; DATA XREF: UpdateFrame+182Eo
					; LoadCarShapes+99w ...
		db    ?	;
		db    ?	;
g_wCar1Z1	dw ?			; DATA XREF: LoadCarShapes+8Dw
					; LoadCarShapes+CEr
g_wCar1XSum2	dw ?			; DATA XREF: LoadCarShapes+ADw
					; LoadCarShapes+E7r
		db    ?	;
		db    ?	;
g_wCar1Z2	dw ?			; DATA XREF: LoadCarShapes+A0w
					; LoadCarShapes+F5r
g_wMoreTrackPos	dw 1Eh dup(?)		; DATA XREF: _main+95w
					; TrkTerrainWall+1E8r ...
g_wMainFlgCp	dw ?			; DATA XREF: RestoreGameState+B8w
					; UpdateFrame+20ECr ...
g_wCar2XSum	dw ?			; DATA XREF: UpdateFrame+1ADAo
					; LoadCarShapes+32Cw ...
		db    ?	;
		db    ?	;
g_wCar2Z	dw ?			; DATA XREF: LoadCarShapes+320w
					; LoadCarShapes+361r
g_wCar2XSum2	dw ?			; DATA XREF: LoadCarShapes+340w
					; LoadCarShapes+37Ar
		db    ?	;
		db    ?	;
g_wCar2Z2	dw ?			; DATA XREF: LoadCarShapes+333w
					; LoadCarShapes+388r
unk_2B77_75A0	db    ?	;		; DATA XREF: Trakdata12SpriteOp+7Ew
					; Trakdata12SpriteOp+F5r ...
		db    ?	;
unk_2B77_75A2	db    ?	;		; DATA XREF: Trakdata12SpriteOp+82w
					; DoTrakdata12+A6r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_dwCopySomeX	dw ?			; DATA XREF: TrkPlanSimd+4EFr
					; TrkPlanSimd+51Br ...
g_ppTrakdata	dd ?			; DATA XREF: _main+110w PlayerOp+14Cr	...
g_cIniEng1Flag2	db ?			; DATA XREF: DoAudioCvx+1Fr
					; DoAudioCvx:loc_471_41C6r ...
		db    ?	;
g_wKevinRandom	dw ?			; DATA XREF: UpdateFrame+4D2r
					; RunGame+2Cw
g_cIniEng1Flag3	db ?			; DATA XREF: DoAudioCvx+4Cr
					; DoAudioCvx:loc_471_41F3r ...
		db    ?	;
g_dwCopySomeZ	dw ?			; DATA XREF: TrkPlanSimd+500r
					; TrkPlanSimd+53Dr ...
g_pcTempStr	db 80h dup(?)		; DATA XREF: GetAString+8o
					; GetAString+29o ...
g_cAudioByte	db ?			; DATA XREF: LoadAudioDriver+79w
					; LoadSfxFile+15o ...
byte_2B77_763F	db ?			; DATA XREF: LoadAudioDriver+7Fw
byte_2B77_7640	db ?			; DATA XREF: LoadAudioDriver+82w
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_pGame3DShapes	Shape3D	32h dup(<?>)	; DATA XREF: LoadGame3dShpes+A9o
					; dseg:stru_2B77_28CCo
stru_2B77_7A98	Shape3D	32h dup(<?>)	; DATA XREF: dseg:2C3Eo
stru_2B77_7EE4	Shape3D	0Bh dup(<?>)	; DATA XREF: dseg:stru_2B77_2354o
m_p3DShapes	Shape3D	5 dup(<?>)	; DATA XREF: UpdateFrame+1D43o
					; UpdateFrame+1BFFr ...
g_pExp0Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+176o
					; dseg:g_sceneShapes3o
g_pExp1Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+198o
					; dseg:g_sceneShapes3o
g_pExp2Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+1BAo
					; dseg:g_sceneShapes3o
g_pExp3Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+1DCo
					; dseg:g_sceneShapes3o
g_pOppExp0Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+409o
					; dseg:g_sceneShapes3o
g_pOppExp1Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+42Bo
					; dseg:g_sceneShapes3o
g_pOppExp2Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+44Do
					; dseg:g_sceneShapes3o
g_pOppExp3Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+46Fo
					; dseg:g_sceneShapes3o
g_pCar0Shape	Shape3D	<?>		; DATA XREF: RunCarMenu+16o
					; LoadCarShapes+35o ...
g_pOppCar0Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes:loc_E1A_20B7o
g_pCar1Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+54o
					; dseg:g_sceneShapeso ...
g_pOppCar1Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+2E7o
					; dseg:g_sceneShapeso ...
g_pCar2Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+154o
					; dseg:g_sceneShapeso
g_pOppCar2Shape	Shape3D	<?>		; DATA XREF: LoadCarShapes+3E7o
					; dseg:g_sceneShapeso
g_ppTrakdata2	dd ?			; DATA XREF: _main+11Fw PlayerOp+158r	...
g_wTrackPos	dw 1Eh dup(?)		; DATA XREF: _main+52w
					; InitGameState+171r ...
					; bottom-top lookup positions
g_dwChhtVce	dd ?			; DATA XREF: LoadVce+156w
					; DrumOp:loc_2863_830r	...
byte_2B77_81BC	db ?			; DATA XREF: TrkPlanSimd+AA9r
					; TrkPlanSimd+B4Cw ...
		align 2
g_pMcgaSprite	dd ?			; DATA XREF: SetupMcgaWnd1r
					; SetupMcgaWnd1+1Dw ...
g_wCurSkybox	dw ?			; DATA XREF: SkyboxRect+18r
					; DoTransformShpTrk+82r ...
word_2B77_81C4	dw ?			; DATA XREF: RunGame+Cw
					; RunGame:loc_11B7_4F4o ...
word_2B77_81C6	dw ?			; DATA XREF: RunGame+12w
word_2B77_81C8	dw ?			; DATA XREF: RunGame+3E5w
word_2B77_81CA	dw ?			; DATA XREF: RunGame+3EBw
byte_2B77_81CC	db ?			; DATA XREF: UpdateGameState+FCr
					; UpdateGameState:loc_471_2A0Br ...
g_cUnk14MatMulVecOp db ?		; DATA XREF: TransformedShapeOp+1E5w
g_dwSnarVce	dd ?			; DATA XREF: LoadVce+F2w
					; DrumOp:loc_2863_812r	...
g_ppTrakdata3	dd ?			; DATA XREF: _main+12Ew
					; OpponentOp+16Cr ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_dwTommVce	dd ?			; DATA XREF: LoadVce+10Bw
					; DrumOp:loc_2863_844r	...
g_wTrnsfrmOp	dw ?			; DATA XREF: TransformedShapeOp+208w
					; sub_14D6_10C4:loc_14D6_10DEr
byte_2B77_81E0	db ?			; DATA XREF: RunGame+D1w
					; RunGame:loc_11B7_10Dw ...
		db    ?	;
g_matTempRotZ	db 12h dup(?)		; DATA XREF: MatRotateZXY+17o
					; MatRotateZXY+E4o ...
g_wSfxEng1Resul	dw ?			; DATA XREF: TrkPlanSimd:loc_471_1B3Ar
					; DoAudioCvx+26r ...
g_wMainFlag	db ?			; DATA XREF: _main:_lblDoGameFlag1w
					; _main:loc_0_49Ew ...
g_pcCarShortNam	db 5 dup(?)		; DATA XREF: EnterHiscore+C0o
					; SetupAeroTrakdata+111o
g_p24Chunkx76	db 4Ch dup(?)		; DATA XREF: MaybeInit4cChun+1Dw
					; DoInit4cBytes+1Fo ...
		db 4Ch dup(?)
		db 4Ch dup(?)
byte_2B77_82E0	db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
byte_2B77_83C4	db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
byte_2B77_86BC	db 4Ch dup(?)		; DATA XREF: AudioFuncIfFlag+5Fo
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
		db 4Ch dup(?)
g_wSfxOppEngResul dw ?			; DATA XREF: TrkPlanSimd+14A1r
					; DoAudioCvx+53r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wTrkTerrSomeCode dw ?			; DATA XREF: TrkPlanSimd+4B8r
					; TrkPlanSimd:loc_471_1684w ...
g_cAudioFlag	db ?			; DATA XREF: LoadAudioFinali+67w
					; LoadAudioFinali+79r ...
		db    ?	;
byte_2B77_8B22	db 40h dup(?)		; DATA XREF: RecordReplay+144w
					; UpdateTrakdata16Or:loc_11B7_1F41r
g_mat3		Matrix <?>		; DATA XREF: TrkPlanSimd+D2o
					; TrkPlanSimd+104o ...
byte_2B77_8B74	db ?			; DATA XREF: DoAddTimerFunc+16w
					; TimerFunc:loc_11B7_A32r ...
		align 2
g_wTrnsfrmShpOp2 dw ?			; DATA XREF: ResetTrnsfrmOpVarsw
					; TransformedShapeOp+413r ...
g_wMouButStatus	dw ?			; DATA XREF: RunGame+6E5o RunGame+6F1r ...
byte_2B77_8B7A	db 40h dup(?)		; DATA XREF: RecordReplay+148w
					; UpdateTrakdata16Or+Fr ...
byte_2B77_8BBA	db ?			; DATA XREF: RunGame+C7w RunGame+30Bw	...
		align 2
g_dwCrshVce	dd ?			; DATA XREF: LoadVce+13Dw
					; DrumOp:loc_2863_826r	...
g_pLogo3d	Shape3D	<?>		; DATA XREF: SetupIntro+36o
					; sub_9F1_3F96+36o
byte_2B77_8BD6	db ?			; DATA XREF: RunGame+C2w RunGame+308r	...
		align 2
word_2B77_8BD8	dw ?			; DATA XREF: EndOfGameScores+3DDr
					; CvxSfxOp+19Ao
word_2B77_8BDA	dw ?			; DATA XREF: EndOfGameScores+3D9r
g_wDrvNameTime	dw ?			; DATA XREF: EndOfGameScores+71Br
					; EndOfGameScores+72Dr	...
word_2B77_8BDE	dw ?			; DATA XREF: EndOfGameScores+FFr
					; EndOfGameScores+10Dr	...
word_2B77_8BE0	dw ?			; DATA XREF: EndOfGameScores:loc_0_33B5r
					; EndOfGameScores+29Er	...
word_2B77_8BE2	dw ?			; DATA XREF: EndOfGameScores+398r
					; EndOfGameScores+3C5r	...
word_2B77_8BE4	dw ?			; DATA XREF: EndOfGameScores+39Br
word_2B77_8BE6	dw ?			; DATA XREF: EndOfGameScores+110r
					; EndOfGameScores+18Br	...
word_2B77_8BE8	dw ?			; DATA XREF: EndOfGameScores+46Br
					; EndOfGameScores+49Cr
word_2B77_8BEA	dw ?			; DATA XREF: EndOfGameScores+53Ar
word_2B77_8BEC	dw ?			; DATA XREF: EndOfGameScores+5B1r
					; EndOfGameScores+5DFr
g_wPoly2Code	dw ?			; DATA XREF: TrkPlanSimd+62w
					; TrkPlanSimd+B7r ...
g_dwSongRes	dd ?			; DATA XREF: LoadAudioResour+29w
					; UnloadAudioReso+10r ...
g_dwMouSprite2	dd ?			; DATA XREF: UsesMousePos+47r
					; LoadPalAndCurso+E3w ...
g_dwOhhtVce	dd ?			; DATA XREF: LoadVce+16Fw
					; DrumOp:loc_2863_83Ar	...
p_pLog23d	Shape3D	<?>		; DATA XREF: SetupIntro+48o
					; sub_9F1_3F96:loc_9F1_3FD4o
g_wWaitFlag	dw ?			; DATA XREF: RunIntro+3Aw
					; RunIntro:loc_0_6DEw ...
g_pcCarScoreNam	db 28h dup(?)		; DATA XREF: EnterHiscore+8Fo
					; SetupAeroTrakdata+8Eo
g_wTerrainRows	dw 1Eh dup(?)		; DATA XREF: _main+41w
					; CvxOpSimdTrack+282r ...
					; top-bottom terrain lookup rows
g_pCar1_5Zeros	dw 5 dup(?)		; DATA XREF: UpdateFrame+1836o
					; LoadCarShapes+148w ...
g_wTrnsfrmShpOp	dw ?			; DATA XREF: ResetTrnsfrmOpVars+18w
					; TransformedShapeOp:loc_14D6_343r ...
g_wIniEng2Flag3	dw ?			; DATA XREF: TimerFunc:loc_11B7_A4Aw
					; TimerFunc+2Br ...
g_ppTrakdata20	dd ?			; DATA XREF: _main+22Bw _main+336r ...
g_pCar1_6Vecs	Vector3D 6 dup(<?>)	; DATA XREF: UpdateFrame+1832o
					; LoadCarShapes+C7w ...
g_pCar1_6Vecs2	Vector3D 6 dup(<?>)	; DATA XREF: LoadCarShapes+EEw
					; LoadCarShapes+107w ...
g_pCar1_6Vecs3	Vector3D 6 dup(<?>)	; DATA XREF: LoadCarShapes+113r
g_pCar1_6Vecs4	Vector3D 6 dup(<?>)	; DATA XREF: LoadCarShapes+12Ar
g_pCar2_5Zeros	dw 5 dup(?)		; DATA XREF: UpdateFrame+1AE2o
					; LoadCarShapes+3DBw ...
gameState	GameState <?>		; DATA XREF: RestoreGameState+98o
					; UpdateGameState+68o ...
g_pCar2_6Vecs	Vector3D 6 dup(<?>)	; DATA XREF: UpdateFrame+1ADEo
					; LoadCarShapes+35Aw ...
g_pCar2_6Vecs2	Vector3D 6 dup(<?>)	; DATA XREF: LoadCarShapes+381w
					; LoadCarShapes+39Aw ...
g_pCar2_6Vecs3	Vector3D 6 dup(<?>)	; DATA XREF: LoadCarShapes+3A6r
g_pCar2_6Vecs4	Vector3D 6 dup(<?>)	; DATA XREF: LoadCarShapes+3BDr
g_wTimerFlag5	dw ?			; DATA XREF: RunCarMenu+2Dw
					; RunCarMenu+7F5r ...
					; same as wTimerFlag1, 0 or 1
g_wTrkPlanAngle	dw ?			; DATA XREF: TrkPlanSimd+59w
					; TrkPlanSimd+BDr ...
word_2B77_9218	dw ?			; DATA XREF: TrkPlanSimd:loc_471_B54r
					; TrkTerrainWall+1Aw ...
g_pRegs86	dw 7 dup(?)		; DATA XREF: SetMousePixRati+3w
					; SetMousePixRati+15o ...
g_wSomeAngle	dw ?			; DATA XREF: TrkPlanSimd+50w
					; TrkPlanSimd+C3r ...
g_cStartCol2	db ?			; DATA XREF: OpponentOp+609r
					; TrkPlanSimd:loc_471_2000r ...
byte_2B77_922B	db ?			; DATA XREF: TrkPlanSimd+19B4r
					; InitGameState+119r ...
g_w64hDivFps	dw ?			; DATA XREF: InitGameState+74w
					; SetupIntro:loc_9F1_3BDEr ...
g_cStartRow2	db ?			; DATA XREF: OpponentOp:loc_471_5D1r
					; TrkPlanSimd:loc_471_200Fr ...
g_wFpsMul4	db ?			; DATA XREF: PlayerOp+8r PlayerOp+Fw ...
g_dwGameRes	dd ?			; DATA XREF: DrawIngameText+28r
					; DrawIngameText+7Fr ...
; here comes a 26 byte car struct, which is also found at the start of rpl files
g_gameInfo	GameInfo <?>		; DATA XREF: _main+309o _main+321o ...
g_dwXCounter	dd ?			; DATA XREF: TrkPlanSimd+11w
					; TrkPlanSimd+2F0r ...
g_dwMouSprite	dd ?			; DATA XREF: UsesMousePos+62r
					; LoadPalAndCurso+C8w ...
g_dwYCounter	dd ?			; DATA XREF: TrkPlanSimd+27w
					; TrkPlanSimd+306r ...
g_dwZCounter	dd ?			; DATA XREF: TrkPlanSimd+3Dw
					; TrkPlanSimd+31Dr ...
byte_2B77_925E	db ?			; DATA XREF: DoHighScore+8w
					; MainTextResFont+228r	...
		align 2
g_wFramesPerSec	dw ?			; DATA XREF: Trakdata11StringOp+F0r
					; Trakdata11StringOp+F6w ...
		align 4
g_ppTrakdata17	dd ?			; DATA XREF: _main+1FEw
					; Trakdata1_2_17_21_22+140r ...
word_2B77_9268	dw ?			; DATA XREF: RunGame+410w RunGame+4E5w ...
word_2B77_926A	dw ?			; DATA XREF: UpdateGameState+8Fr
					; UpdateGameState+B1w ...
g_pTrakdata9	dd ?			; DATA XREF: _main+187w
					; DoAudioCvx+2DDr ...
g_dwSomeX	dw ?			; DATA XREF: TrkPlanSimd+984r
					; PlaneOriginOp+4Dr ...
byte_2B77_9272	db ?			; DATA XREF: RunGame+369w RunGame+415r ...
		align 2
g_wIniEng2Flag2	dw ?			; DATA XREF: DoAudioCvx+19r
					; DoAudioCvx+1E1r ...
byte_2B77_9276	db ?			; DATA XREF: RunGame+AFw TimerFunc+BFr ...
		align 2
g_wCvxTimerFlag	dw ?			; DATA XREF: InitGameState+52w
					; InitGameState:loc_471_244Cw ...
word_2B77_927A	dw ?			; DATA XREF: RunGame+1Dw RunGame+3ADr	...
g_dwSomeY	dw ?			; DATA XREF: TrkPlanSimd+990r
					; PlaneOriginOp+33r ...
g_ppTrakdata12	dd ?			; DATA XREF: _main+1B4w
					; Trakdata12SpriteOp+B1r ...
g_wCurTimeDelta	dw ?			; DATA XREF: RunMenu+110w RunMenu+114r ...
g_cNumPolyVerts	db ?			; DATA XREF: TransformedShapeOp+221w
					; TransformedShapeOp+22Bw ...
		align 2
g_dwSomeZ	dw ?			; DATA XREF: TrkPlanSimd+99Cr
					; PlaneOriginOp+58r ...
g_pBarnShape	dd ?			; DATA XREF: LoadGame3dShpes+74w
					; LoadGame3dShpes+9Dw ...
unk_2B77_928C	db    ?	;		; DATA XREF: UpdateFrame+21F3w
					; SkyBoxOp+5FAw ...
		db    ?	;
word_2B77_928E	dw ?			; DATA XREF: sub_9F1_4+42w
					; sub_9F1_4+48r ...
word_2B77_9290	dw ?			; DATA XREF: RunCarMenu+2C8r
					; RunCarMenu+A4Dr ...
word_2B77_9292	dw ?			; DATA XREF: RunCarMenu+2C4r
					; RunCarMenu+A49r ...
g_rcIntro	Rectangle <?>		; DATA XREF: UpdateFrame+46o
					; UpdateFrame+2046o ...
g_rcIntroCopy	Rectangle <?>		; DATA XREF: UpdateFrame+D39o
					; UpdateFrame:loc_9F1_1037o ...
g_rcUnk		Rectangle <?>		; DATA XREF: UpdateFrame:loc_9F1_11C4o
					; UpdateFrame+1176o ...
g_rcUnk2	Rectangle <?>		; DATA XREF: UpdateFrame+1861o
					; UpdateFrame:loc_9F1_21CFo
g_rcUnk3	Rectangle <?>		; DATA XREF: UpdateFrame+1B0Do
					; UpdateFrame:loc_9F1_20E0o
g_rcSomeRect	Rectangle <?>		; DATA XREF: SkyBoxOp+1C1w
					; SkyBoxOp+52Ew ...
unk_2B77_92C4	db    ?	;		; DATA XREF: UpdateFrame+2114o
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
stru_2B77_92CC	Rectangle <?>		; DATA XREF: UpdateFrame:loc_9F1_67Fo
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_dwVoiceRes	dd ?			; DATA XREF: LoadAudioResour+14w
					; LoadAudioResour+37r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wProbColor	dw ?			; DATA XREF: RunTracksMenu+8Er
					; SkyboxRect+15Fr ...
byte_2B77_931A	db ?			; DATA XREF: InitSomeVars+7w
					; TimerFunc:loc_11B7_ACEw ...
		align 2
g_wTrkTerrnSomeCode2 dw	?		; DATA XREF: TrkPlanSimd:loc_471_B60r
					; TrkTerrainWall+14w ...
g_wTerrainPos	db 3Ch dup(?)		; DATA XREF: _main+6Dw
					; TrkTerrainWall:loc_E1A_265r ...
g_arrDrum	db    ?	;		; DATA XREF: sub_270D_7EC+6r
					; DoInit4cBytes+45w ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_cTimerOverrun	db ?			; DATA XREF: _main+366r
					; _main:loc_0_42Dw ...
		db    ?	;
g_wSetHandlers	dw ?			; DATA XREF: LoadIntroRes+51r
					; EndOfGameScores+8F6r	...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_ppTrakdata11	dd ?			; DATA XREF: _main+1A5w
					; RunTracksMenu+132r ...
g_wTimerFlag1	dw ?			; DATA XREF: RunCarMenu+2Ar
					; SetupIntro+164r ...
g_wMainRes1	dw ?			; DATA XREF: _main+B9w	_main+54Fr ...
g_wMainRes2	dw ?			; DATA XREF: _main+BCw	_main+54Br ...
g_pBrav3d	Shape3D	<?>		; DATA XREF: SetupIntro+5Ao
					; sub_9F1_3F96+E6o
unk_2B77_9596	db    ?	;		; DATA XREF: sub_270D_7DE+6r
					; DoInit4cBytes+40w ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wIniEng2Flag1	dw ?			; DATA XREF: DoAudioCvx+1Cw
					; TimerFunc+34r ...
word_2B77_95B0	dw ?			; DATA XREF: DoAudioCvx+2F8r
					; UpdateFrame+3CBr ...
g_dwFontnRes	dd ?			; DATA XREF: _main+E5w
					; RunTracksMenu+18Ar ...
g_pWndSprite	dd ?			; DATA XREF: RunIntroInLoop+46w
					; RunIntroInLoop+57r ...
g_matTempRotY	Matrix <?>		; DATA XREF: MatRotateZXY:loc_14D6_14EDo
					; MatRotateZXY+70o
g_wMouseX	dw ?			; DATA XREF: seg017:0136w
					; SetMousePositio+Cw
g_ppTrakdata4	dd ?			; DATA XREF: _main+13Dw
					; SetupAeroTrakdata+35r ...
g_ppTrakdata14	dd ?			; DATA XREF: _main+1D1w
					; _main:loc_0_32Fr ...
byte_2B77_95D6	db ?			; DATA XREF: TrkTerrainWall+20w
					; TrkTerrainWall+1132w	...
byte_2B77_95D7	db ?			; DATA XREF: TrkPlanSimd+443r
					; TrkPlanSimd+FF8w ...
word_2B77_95D8	dw ?			; DATA XREF: LoadAudioFinali+3Dw
					; sub_2863_5A+Cw ...
g_ppTrakdata5	dd ?			; DATA XREF: _main+14Cw
					; SetupAeroTrakdata+B8r ...
g_wFramesPerSec2 dw ?			; DATA XREF: RunGame+10Dr RunGame+113r ...
byte_2B77_95E0	db 10h dup(?)		; DATA XREF: UpdateCarState+3FEr
					; DoSomeTrakData+B1r ...
word_2B77_95F0	dw ?			; DATA XREF: LoadSkybox+10Aw
					; SetupCarShapes+735r ...
g_wMouseY	dw ?			; DATA XREF: seg017:013Cw
					; SetMousePositio+1Ew
g_pTrkWallTerrainPla dd	?		; DATA XREF: TrkPlanSimd+B45w
					; TrkPlanSimd+100Aw ...
g_pcFullTrackPa	db 5Eh dup(?)		; DATA XREF: _main+401o _main+421o ...
g_wPlanIndex	dw ?			; DATA XREF: TrkPlanSimd+4AAr
					; TrkPlanSimd+929r ...
g_wVideoFlag1	dw ?			; DATA XREF: RunCarMenu+8BBr
					; MinMaxRect+5Cr ...
word_2B77_965A	dw ?			; DATA XREF: UpdateGameState:loc_471_29FEr
					; UpdateGameState+10Ew	...
g_wIntroTimeCou	dw ?			; DATA XREF: SetupIntro+1AAw
					; SetupIntro+1B5w ...
unk_2B77_965E	db    ?	;		; DATA XREF: sub_9F1_4+7Co
					; sub_9F1_4+AAo ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
vec_2B77_97C6	Vector3D <?>		; DATA XREF: TrkPlanSimd:loc_471_86Cw
					; TrkPlanSimd:loc_471_1172w ...
g_vecPlaneRotOpResul Vector3D <?>	; DATA XREF: TrkPlanSimd+221r
					; TrkPlanSimd+B0Cr ...
g_wSomeAngleYZ	dw ?			; DATA XREF: TrkPlanSimd+53w
					; PlaneRotateOp+33r ...
g_wSomeAngleXY	dw ?			; DATA XREF: TrkPlanSimd+5Cw
					; PlaneRotateOp+2Ar ...
word_2B77_97D6	dw ?			; DATA XREF: TrkPlanSimd+65w
					; PlaneRotateOp+3Br ...
g_wSomePi3Code	dw ?			; DATA XREF: TrkPlanSimd:loc_471_89Cw
					; TrkPlanSimd+216r ...
g_wSomePlanIndex dw ?			; DATA XREF: TrkPlanSimd+1E6w
					; TrkPlanSimd+AF5w ...
unk_2B77_97DC	db    ?	;		; DATA XREF: DoAudioCvx+1E5o
					; TimerFunc+45o
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wDashBmp2Ofs	dd ?			; DATA XREF: RunGame+555r
					; SetupCarShapes+214w ...
g_pDasmBmpOfs	dw ?			; DATA XREF: RunGame+545r
					; SetupCarShapes+22Fw
g_pDasmBmpSeg	dw ?			; DATA XREF: RunGame:loc_11B7_54Br
					; SetupCarShapes+232w
byte_2B77_9D34	db ?			; DATA XREF: sub_9F1_4+17r
					; SkyBoxOp+1D2r ...
		align 2
g_dwEng1Res	dd ?			; DATA XREF: SetupCarGameEtc+EDw
					; SetupCarGameEtc+11Cr	...
g_dwCurCarShpFi	dd ?			; DATA XREF: LoadCarShapes+2Ew
					; LoadCarShapes+3Er ...
word_2B77_9D3E	dw ?			; DATA XREF: RunGame:loc_11B7_3A9w
					; RunGame+3B0r	...
g_dwCurCarShpF2	dd ?			; DATA XREF: LoadCarShapes+256w
					; LoadCarShapes+28Er ...
g_pTrakdata7	dd ?			; DATA XREF: _main+16Aw
					; SetupTrack+E7Cr ...
g_cGameFlag2	db ?			; DATA XREF: TrkPlanSimd:loc_471_1B26r
					; DoAudioCvx+8r ...
		align 2
g_wAudioWord	dw ?			; DATA XREF: LoadAudioFinali+43w
					; sub_2863_5A:loc_2863_86r ...
g_ppTrakdata15	dd ?			; DATA XREF: _main+1E0w
					; DoSomeTrakData+1C8r ...
g_wKbOrJoyFlag	dw ?			; DATA XREF: RplyMouseSpriteStuff+675r
					; RplyMouseSpriteStuff:loc_11B7_2D84r ...
g_dwPlanRes	dd ?			; DATA XREF: TrkPlanSimd+96Fr
					; TrkPlanSimd+B3Er ...
g_dwFontDefRes	dd ?			; DATA XREF: _main+CFw	SetFontDef+4r ...
g_dwRideVce	dd ?			; DATA XREF: LoadVce+124w
					; DrumOp:loc_2863_81Cr	...
word_2B77_9D5E	dw ?			; DATA XREF: SkyboxRect:loc_9F1_2476r
					; SkyBoxOp:loc_9F1_275Er ...
g_pTrakdata6	dd ?			; DATA XREF: _main+15Bw
					; SetupTrack+ED5r ...
g_wVideoFlag2	dw ?			; DATA XREF: RunCarMenu+8BFr
					; SkyBoxOp+3A7r ...
g_ppTrakdata18	dd ?			; DATA XREF: _main+20Dw
					; DoSomeTrakData+15r ...
g_pwUnk14ZTable	db    ?	;		; DATA XREF: UpdateFrame+1DCBo
					; NextTransShape+3Dw
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
byte_2B77_9DA4	db ?			; DATA XREF: RunCarMenu+230w
					; UpdateFrame:loc_9F1_1FCFw ...
		align 2
g_wUseTrkInRpl	dw ?			; DATA XREF: OpponentOp+5F2r
					; OpponentOp+62Cr ...
					; is 0x0 for .trk-based	tracks,	the track in the built-in replay, "hell5", has this set	to 200h
g_pSkybox1	dw ?			; DATA XREF: SkyboxRect+A6r
					; SkyboxRect+116r ...
g_pSkybox2	dw ?			; DATA XREF: SkyboxRect+BFr
					; LoadSkybox+7Bw ...
g_pSkybox3	dw ?			; DATA XREF: SkyboxRect+DCr
					; DoTransformShpTrk+BEr ...
g_pSkybox4	dw ?			; DATA XREF: SkyboxRect+F9r
					; DoTransformShpTrk+D9r ...
unk_2B77_9DB0	db    ?	;		; DATA XREF: sub_9F1_4:loc_9F1_31w
					; sub_9F1_4+8Fo ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_cRectCmpFlag	db ?			; DATA XREF: sub_9F1_4+72w
					; SkyBoxOp+22Dw ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
byte_2B77_9DBF	db ?			; DATA XREF: InitSomeVars+Cw
					; TimerFunc:loc_11B7_AF6w ...
g_pcCarInfoCopy	db 0Dh dup(?)		; DATA XREF: _main+31Eo _main+4D7o
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wTrnsfrmOp3	dw ?			; DATA XREF: TransformedShapeOp+20Ew
					; sub_14D6_10C4+28r ...
g_arrRcMegapoly	Rectangle 0Fh dup(<?>)	; DATA XREF: sub_9F1_4+8Bo
					; sub_9F1_4+166r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_dwMouSprite3	dd ?			; DATA XREF: RenderMouSpr3+17r
					; UsesMousePos+2Cr ...
g_pMiscRes2	dw ?			; DATA XREF: RunCarMenu+259w
					; RunCarMenu+543r ...
g_pMiscRes1	dw ?			; DATA XREF: RunCarMenu+25Cw
					; RunCarMenu+53Fr ...
g_wSomeClrColor	dw ?			; DATA XREF: SkyboxRect+51r
					; SkyBoxOp:loc_9F1_25ECr ...
byte_2B77_9E62	db ?			; DATA XREF: RunGame+327r RunGame+354w
		db    ?	;
unk_2B77_9E64	db    ?	;		; DATA XREF: sub_9F1_4+A6o
					; sub_9F1_4+C8r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_ppTrakdata16	dd ?			; DATA XREF: _main+1EFw
					; UpdateGameState+Cr ...
g_wVidConstCp1	dw ?			; DATA XREF: SetVideoValues+6w
					; sub_14D6_1296+EDr ...
byte_2B77_9EC4	db ?			; DATA XREF: RunGame+330r RunGame+35Aw ...
byte_2B77_9EC5	db ?			; DATA XREF: SetupTrack+2ADw
					; SetupTrack:loc_E1A_2EF4r ...
unk_2B77_9EC6	db    ?	;		; DATA XREF: UpdateFrame+1F90r
					; LoadSdgame2Shap+47w
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_pTrakdata21	dd ?			; DATA XREF: _main+23Aw
					; Trakdata1_2_17_21_22+17Ar ...
g_pCarInfoSimd2	CarInfoSimd <?>		; DATA XREF: OpponentOp:loc_471_4EAo
					; OpponentOp+503o ...
g_cDrvFlag6Flag	db ?			; DATA XREF: sub_270D_42A+3r
					; AudioFuncIfFlag+2Ar ...
		db    ?	;
g_pcKevinSeed	db 6 dup(?)		; DATA XREF: SetKevinRndSeed+9w
					; GetKevinRndSeed+7r ...
g_cAudioByte2	db ?			; DATA XREF: LoadAudioFinali+6Er
					; sub_270D_29A+1Dr ...
		db    ?	;
g_rcIntroCp2	dw 4 dup(?)		; DATA XREF: SetupIntro+18Eo
					; SetupIntro+462o ...
g_arrRcMegapol2	Rectangle 0Fh dup(<?>)	; DATA XREF: sub_9F1_4+87o
					; sub_9F1_4+16Ar ...
g_cDrvResult	db ?			; DATA XREF: LoadAudioDriver+C2w
					; LoadAudioDriver:loc_270D_8D2r ...
		align 2
word_2B77_A264	dw ?			; DATA XREF: RunGame+3B6r RunGame+3FAr ...
g_wVidConstCp2	dw ?			; DATA XREF: SetVideoValues+Cw
					; sub_14D6_1296+137r
g_cIniEng1Flag1	db ?			; DATA XREF: DoAudioCvx:loc_471_41A6r
					; DoAudioCvx:loc_471_4206w ...
		db    ?	;
g_ppTrakdata22	dd ?			; DATA XREF: _main+249w
					; Trakdata1_2_17_21_22+12Fr ...
		db    ?	;
		db    ?	;
unk_2B77_A270	db    ?	;		; DATA XREF: EnterHiscore+141o
					; EnterHiscore+14Do
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wVideoFlag5	db ?			; DATA XREF: RunGame:loc_11B7_3C8r
					; RplyMouseSpriteStuff:loc_11B7_2854r ...
g_wFontDef_0E	dw ?			; DATA XREF: RunCarMenu+774r
					; RunOpponentMenu+39Br	...
					; this value is	always read as 8 from the font file
g_dwFontLedRes	dd ?			; DATA XREF: UpdateFrame+2101r
					; SetupCarGameEtc+18Fw	...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wVidConstCp5	dw ?			; DATA XREF: SetVideoValues+1Ew
word_2B77_A28E	dw ?			; DATA XREF: TrkPlanSimd:loc_471_B47w
					; TrkPlanSimd+4C5r ...
g_wFpsMul1Eh	dw ?			; DATA XREF: InitGameState+67w
					; RestoreGameState+23r	...
g_pcUnk14ByteTable db	 ? ;		; DATA XREF: UpdateFrame+1E23r
					; UpdateFrame+1E58r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_dwCvxBytes	dd ?			; DATA XREF: _main+3B5w _main+520r ...
g_wResetOnCvxTr	dw ?			; DATA XREF: EndOfGameScores+3C8r
					; EndOfGameScores+3D1r	...
g_drvData2	db    ?	;		; DATA XREF: DrvFuncMany+7Co
					; DrvFuncMany+B7o ...
g_drvData	db    ?	;		; DATA XREF: DoSkidslctDrv+36o
					; AudioDrvFunc15+74o ...
g_drvData3	db    ?	;		; DATA XREF: DoSkidslctDrv+3Eo
					; AudioDrv1E+36o ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_drvData4	db    ?	;		; DATA XREF: DoSkidslctDrv+43o
					; AudioDrv1E+31o ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_A2CC	db    ?	;		; DATA XREF: AudioDrvFunc15+7Co
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_2B77_A2E0	db    ?	;		; DATA XREF: seg028:0DDFr seg028:0E09r
		db    ?	;
g_drvData5	db    ?	;		; DATA XREF: DoSkidslctDrv+48o
					; AudioDrvFunc24+1Cr
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wSomeTime	dw ?			; DATA XREF: ResetGameTime+6w
					; TimeAndMouse:loc_174B_2305r ...
g_dwSdgameRes	dd ?			; DATA XREF: SetupCarGameEtc+1C9w
					; UnloadGameResou+4Ar ...
g_arrKb_187Rel	db    ?	;		; DATA XREF: PushInputStatus+Aw
					; PopInputStatus+12r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_arrKbOrMouse	db    ?	;		; DATA XREF: PushInputStatus+11w
					; PopInputStatus+19r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_wGameTime	dw ?			; DATA XREF: ResetGameTimew
					; TimeAndMouse+Ew ...
g_wVidConstCp3	dw ?			; DATA XREF: SetVideoValues+12w
					; sub_14D6_1296+60r
		db    ?	;
		db    ?	;
unk_2B77_A5B2	db    ?	;		; DATA XREF: RunCarMenu+280r
					; RunCarMenu+2E3r ...
		db    ?	;
unk_2B77_A5B4	db    ?	;		; DATA XREF: RunCarMenu+284r
					; RunCarMenu+2DFr ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
byte_2B77_A5CE	db ?			; DATA XREF: ZXTrakdata14Shape+74r
					; ZXTrakdata14Shape+DAr ...
		db    ?	;
g_wTrackRows	dw 1Eh dup(?)		; DATA XREF: _main+35w
					; TrkPlanSimd+18B4r ...
					; bottom-top row lookup	offsets
m_wMouseBut	dw ?			; DATA XREF: InitMouse+3Dw
					; seg017:012Aw	...
g_cTransShpCounter db ?			; DATA XREF: UpdateFrame:loc_9F1_120Cw
					; UpdateFrame:loc_9F1_1F9Ar ...
		align 2
g_wManySkyboxRe	dd 4 dup(?)		; DATA XREF: SkyboxRect+B0r
					; SkyboxRect+124r ...
g_cStartCol	db ?			; DATA XREF: SetupTrack+85Fw
					; SetupTrack+10D0w ...
		align 2
g_wVidConstCp4	dw ?			; DATA XREF: SetVideoValues+18w
					; sub_14D6_1296+93r ...
word_2B77_A624	dw ?			; DATA XREF: RunGame+125w
word_2B77_A626	dw ?			; DATA XREF: TrkPlanSimd+545r
					; TrkPlanSimd+66Fr ...
g_wTrnsfrmOp2	dw ?			; DATA XREF: TransformedShapeOp+20Bw
					; sub_14D6_10C4+Er ...
g_arrAudio	db    ?	;		; DATA XREF: sub_270D_40E+Cw
					; AudioFuncIfFlag+71r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_cGameMode2	db ?			; DATA XREF: TrkPlanSimd+153Dr
					; UpdateGameState:loc_471_29A2r ...
		align 2
g_ppTrakdata8	dd ?			; DATA XREF: _main+179w
					; UpdateFrame+15FAr ...
word_2B77_A648	dw ?			; DATA XREF: RunGame+363w
					; RunGame:loc_11B7_3AFr ...
word_2B77_A64A	dw ?			; DATA XREF: RunGame+4B1r
					; SetupCarShapes+1A8w
g_pwManyExRes	dw 0Ah dup(?)		; DATA XREF: UpdateFrame+1FC0r
					; LoadSdgame2Shap+1Fo ...
word_2B77_A660	dw ?			; DATA XREF: Trakdata1_2_17_21_22:loc_471_319Er
					; SetupTrack+49w ...
g_wMoreTrkCenPo	dw 1Eh dup(?)		; DATA XREF: _main+A3w	OpponentOp+611r ...
g_dwEngRes	dd ?			; DATA XREF: SetupCarGameEtc+104w
					; SetupCarGameEtc+114r	...
g_dwSdtitlRes	dd ?			; DATA XREF: RunIntroInLoop+2Bw
					; RunIntroInLoop+67r ...
g_cStartRow	db ?			; DATA XREF: SetupTrack+865w
					; SetupTrack+10D7w ...
		db    ?	;
		db    ?	;
		db    ?	;
g_bPassedSecuri	db ?			; DATA XREF: _main+2A8w
					; _main:_lblSecCheck2r	...
		db    ?	;
g_pwUnk14WordTable db	 ? ;		; DATA XREF: UpdateFrame+1DC7o
					; UpdateFrame+1E54r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_ppTrakdata19	dd ?			; DATA XREF: _main+21Cw
					; TrkPlanSimd+18BCr ...
g_dwCopyOfSimd	CarInfoSimd <?>		; DATA XREF: RunCarMenu:loc_0_22CEo
					; OpponentOp+516o ...
g_ppTrakdata13	dd ?			; DATA XREF: _main+1C3w
					; LoadReplayFile+24r ...
byte_2B77_A9F6	db ?			; DATA XREF: sub_9F1_4:loc_9F1_7Bw
					; sub_9F1_4+80o ...
byte_2B77_A9F7	db ?			; DATA XREF: LoadSkybox+1Br
					; LoadSkybox+2Dw
g_pSkyboxRes	dd ?			; DATA XREF: LoadSkybox+4Cw
					; LoadSkybox+5Cr ...
g_wMouXPos	dw ?			; DATA XREF: RunGame+6E1o
					; RecordReplay+A9o ...
byte_2B77_A9FE	db ?			; DATA XREF: SetupTrack+2B2w
					; SetupTrack+87Dw ...
g_cGameFlag1	db ?			; DATA XREF: RunGame+2Fw RunGame+32Ar	...
word_2B77_AA00	dw ?			; DATA XREF: RunTracksMenu+12Cr
					; DoHighScore+1Aw ...
word_2B77_AA02	dw ?			; DATA XREF: EnterHiscore+6Aw
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_rc3		Rectangle <?>		; DATA XREF: DrawIngameText+9o
					; DrawIngameText+42o ...
g_wTrackCenPos	db 3Ch dup(?)		; DATA XREF: _main+5Fw	OpponentOp+5D7r ...
g_wDashBitmapY	dw ?			; DATA XREF: RunGame+4FBr RunGame+51Ar ...
g_pGame1Res	dd ?			; DATA XREF: LoadGame3dShpes+Cw
					; LoadGame3dShpes+3Aw ...
byte_2B77_AA58	db ?			; DATA XREF: RunGame+BDw
					; RunGame:loc_11B7_31Fr ...
		align 2
g_wFpsMul2	dw ?			; DATA XREF: PlayerOp+1B1w
					; PlayerOp+1BEr ...
g_wRoofBmpHeight dw ?			; DATA XREF: UpdateFrame+2120r
					; UpdateFrame+214Br ...
g_wMouYPos	dw ?			; DATA XREF: RunGame:loc_11B7_6E7o
					; RecordReplay+A5o ...
g_wVideoFlag3	dw ?			; DATA XREF: SetupCarGameEtc+256r
					; Trakdata12SpriteOp+Br ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_pGame2Res	dd ?			; DATA XREF: LoadGame3dShpes+12w
					; LoadGame3dShpes+4Dw ...
word_2B77_AC66	dw ?			; DATA XREF: sub_9F1_4+3Fr
					; sub_9F1_4:loc_9F1_49r ...
g_dwSgGameRes	dd ?			; DATA XREF: LoadSdgame2Shap+18w
					; LoadSdgame2Shap+28r ...
g_pTrakdata23	dd ?			; DATA XREF: _main+258w
					; UpdateFrame+1538r ...
byte_2B77_AC70	db ?			; DATA XREF: DoAudioCvx:loc_471_4342r
					; DoAudioCvx:loc_471_4432r ...
		align 2
word_2B77_AC72	dw ?			; DATA XREF: sub_9F1_3624+6Ar
					; LoadSkybox+104w
g_pTempByte	db ?			; DATA XREF: LoadIntroRes+73o
					; LoadIntroRes+8Eo ...
byte_2B77_AC75	db ?			; DATA XREF: SecurityCheck+CAw
					; SecurityCheck+ECw ...
byte_2B77_AC76	db ?			; DATA XREF: SecurityCheck+BAw
					; TrackEditRelate+1C6w	...
byte_2B77_AC77	db ?			; DATA XREF: TrackEditRelate+1CDw
					; TrackEditRelate+226w
		db    ?	;
		db    ?	;
unk_2B77_AC7A	db    ?	;		; DATA XREF: SecurityCheck+6Fo
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_pTransShp	dw ?			; DATA XREF: UpdateFrame+102Dw
					; UpdateFrame+1433r ...
g_wVideoFlag4	db ?			; DATA XREF: RunCarMenu+26Fr
					; RunCarMenu+A3Br ...
		db    ?	;
g_matTempMult	Matrix <?>		; DATA XREF: MatRotateZXY+B6o
					; MatRotateZXY:loc_14D6_155Co ...
byte_2B77_ACDA	db ?			; DATA XREF: RunGame+31Er RunGame+34Ew
		db    ?	;
g_matTemp	Matrix <?>		; DATA XREF: UpdateFrame+A4Do
					; UpdateFrame+BF5o ...
g_wVideoFlag6	db ?			; DATA XREF: LocateTextRes+6r
					; SetVideoMode+F2w
		align 2
g_dwWallRes	dd ?			; DATA XREF: TrkTerrainWall+184Fr
					; TrkTerrainWall+188Br	...
unk_2B77_ACF4	db    ?	;		; DATA XREF: EnterHiscore+ACo
					; SetupOppTrakdata+38o
		db    ?	;
		db    ?	;
g_cRplBufIsFull	db ?			; DATA XREF: RunGame+CCw
					; RunGame:loc_11B7_28Cr ...
word_2B77_ACF8	dw ?			; DATA XREF: UpdateFrame+3E9r
					; DoAddTimerFuncw ...
unk_2B77_ACFA	db    ?	;		; DATA XREF: Trakdata12SpriteOp+92w
					; DoTrakdata12+29r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
g_matTempRotX	Matrix <?>		; DATA XREF: MatRotateZXY+30o
					; MatRotateZXY+BAo ...
g_cGameMode3	db ?			; DATA XREF: RunGame:loc_11B7_39Aw
					; RunGame:loc_11B7_448r ...
		db    ?	;
unk_2B77_AD16	db    ?	;		; DATA XREF: Trakdata12SpriteOp+99w
					; DoTrakdata12+25r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
dseg		ends

; ===========================================================================

; Segment type:	Uninitialized
seg041		segment	byte stack 'STACK' use16
		assume cs:seg041
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing
byte_3649_0	db 1F40h dup(?)
seg041		ends


		end start
